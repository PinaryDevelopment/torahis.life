{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@aurelia/kernel/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/functions.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/metadata.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/resource.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/di.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/logger.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/path.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/profiler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/eventaggregator.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/index.js","webpack:///./node_modules/tslib/tslib.es6.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/proxy-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/subscriber-collection.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/setter-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/binding-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/signaler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/connectable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behavior.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converter.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ast.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-length-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/array-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/computed-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/scheduler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/dirty-checker.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-size-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/map-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/primitive-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/property-accessor.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/set-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/property-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/call-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/expression-parser.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/interpolation-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/let-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ref-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/bindable-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/binding-mode.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/debounce.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/signals.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/throttle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/bindable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attribute.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle-task.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/if.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/repeat.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/replaceable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/with.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/children.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-element.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/sanitize.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/renderer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/render-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/controller.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/activator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/aurelia.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/index.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/listener.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/attribute.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/attribute-ns-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/checked-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/class-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/data-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-property-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/event-manager.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/select-value-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/style-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/svg-analyzer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/value-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/attr.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/self.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/update-trigger.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-styles.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/projectors.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/blur.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/focus.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/portal.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/create-element.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-elements/compose.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/html-renderer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/index.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/ast.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-pattern.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-patterns.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-command.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/common.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/expression-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/resource-model.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/index.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/platform.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/binding/unparser.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/tracer.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-binder.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-element-factory.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-compiler.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/html-attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/browser-scheduler.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/index.js","webpack:///./node_modules/@aurelia/jit-html-browser/dist/esnext/index.js","webpack:///./node_modules/aurelia/dist/esnext/quick-start.js","webpack:///./node_modules/process/browser.js","webpack:///./src/my-app.css?d9e4","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./src/my-app.css","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/retry-interceptor.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client-configuration.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client.js","webpack:///./node_modules/@aurelia/router/dist/esnext/queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/link-handler.js","webpack:///./node_modules/@aurelia/router/dist/esnext/utils.js","webpack:///./node_modules/@aurelia/router/dist/esnext/parser.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-content.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/route-recognizer.js","webpack:///./node_modules/@aurelia/router/dist/esnext/found-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/collection.js","webpack:///./node_modules/@aurelia/router/dist/esnext/scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/type-resolvers.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-instruction.js","webpack:///./node_modules/@aurelia/router/dist/esnext/interfaces.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook-manager.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-viewer-store.js","webpack:///./node_modules/@aurelia/router/dist/esnext/router.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/instruction-resolver.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/goto.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/href.js","webpack:///./node_modules/@aurelia/router/dist/esnext/configuration.js","webpack:///./src/my-app.html","webpack:///./src/shiur.ts","webpack:///./src/my-app.ts","webpack:///./src/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","LogLevel","Reporter","level","code","params","error","Error","Tracer","enabled","liveLoggingEnabled","liveWriter","objName","methodName","args","writer","enableLiveLogging","optionsOrWriter","isNumericLookup","isArrayIndex","result","length","ch","charCodeAt","isNumberOrBigInt","isStringOrDate","Date","baseCase","CharKind","isDigit","assign","charToKind","char","toUpperCase","toLowerCase","input","cb","len","prevKind","sep","output","curChar","curKind","nextChar","charAt","nextKind","camelCase","cache","callback","pascalCase","slice","kebabCase","toArray","arr","Array","ids","nextId","context","compareNumber","a","b","emptyArray","mergeDistinct","arr1","arr2","lookup","arr3","item","len1","len2","push","bound","target","descriptor","configurable","boundFn","this","Reflect","writable","mergeArrays","arrays","k","arraysLen","array","arrayLen","j","firstDefined","values","getPrototypeChain","functionPrototype","Function","getPrototypeOf","WeakMap","proto","chain","Type","set","toLookup","objs","isObject","isNullOrUndefined","isNativeFunction","isNative","sourceText","fn","toString","metadataInternalSlot","$typeError","operation","paramName","actualValue","expectedType","TypeError","map","String","join","toPropertyKeyOrUndefined","propertyKey","GetOrCreateMetadataMap","O","P","Create","targetMetadata","Map","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","has","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","keys","keysObj","$define","metadataKey","metadataValue","$has","OrdinaryHasMetadata","parent","$hasOwn","$get","OrdinaryGetMetadata","$getOwn","$getKeys","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeysLen","parentKeysLen","Set","add","$getOwnKeys","$delete","delete","OrdinaryDeleteMetadata","Metadata","define","hasOwn","getOwn","getKeys","getOwnKeys","obj","hasMetadata","hasDecorate","hasDefineMetadata","hasHasMetadata","hasHasOwnMetadata","hasGetMetadata","hasGetOwnMetadata","hasGetMetadataKeys","hasGetOwnMetadataKeys","hasDeleteMetadata","console","warn","ensurePropertyKeyOrUndefined","decorators","attributes","isArray","decorated","decorator","DecorateProperty","toPropertyKey","DecorateConstructor","annotation","prop","keyFor","isKey","startsWith","resource","Protocol","fromAnnotationOrDefinitionOrTypeOrDefault","def","getDefault","fromAnnotationOrTypeOrDefault","fromDefinitionOrDefault","ResolverBuilder","container","registerResolver","destinationKey","strategy","state","cloneArrayWithPossibleProps","source","clone","DI","createContainer","register","getDesignParamtypes","annotationParamtypes","appendTo","dependencies","inject","designParamtypes","getAnnotationParamtypes","Proto","getDependencies","auAnnotationParamtype","friendlyName","Interface","index","getOrCreateAnnotationParamTypes","noDefault","withDefault","configure","dep","constructor","transient","Registration","singleton","IContainer","createInterface","IServiceLocator","createResolver","resolver","resolve","handler","requestor","getAll","instance","ResolverStrategy","factory","getFactory","construct","getResolver","Factory","invoker","transformers","dynamicDependencies","invokeWithDynamicDependencies","invoke","ii","transformer","createFactory","staticDependencies","concat","classInvokers","deps","fallbackInvoker","write","containerResolver","isRegistry","registerDepth","root","resolvers","resourceResolvers","current","jj","defs","validateKey","indexOf","isResourceKey","registerTransformer","autoRegister","jitRegister","searchAncestors","buildAllResponse","keyAsValue","registrationResolver","newResolver","ParameterizedRegistry","filter","x","alias","originalKey","aliasKey","defer","undefined","results","ColorOptions","ILogConfig","LogConfig","ISink","ILogEventFactory","DefaultLogEventFactory","format","DefaultLogger","red","str","green","yellow","blue","magenta","cyan","white","grey","colorOptions","getLogLevelString","logLevelString","TRC","DBG","INF","WRN","ERR","FTL","QQQ","getIsoString","timestamp","toISOString","DefaultLogEvent","severity","message","optionalParams","scope","getScopeString","config","logger","now","ConsoleSink","$console","emit","event","debug","info","sinks","scopedLoggers","sinksLen","msgOrGetMsg","createLogEvent","trace","messageOrGetMessage","fatal","scopedLogger","encode","encodeURIComponent","encodeKey","replace","buildParam","traditional","arrayKey","propertyName","buildQueryString","pairs","sort","processScalarParam","existedParam","parseComplexParam","queryParams","currentParams","keysLastIndex","prevValue","isNaN","parseQueryString","queryString","query","split","pair","decodeURIComponent","includes","endsWith","shift","Profiler","timers","profileMap","profiler","createTimer","depth","mark","enter","topLevelCount","totalCount","leave","duration","enable","timer","disable","report","forEach","Handler","messageType","invokeCallback","data","e","invokeHandler","handle","eventLookup","messageHandlers","channelOrInstance","subscribers","channel","channelOrType","idx","splice","sub","subscribe","dispose","__decorate","desc","arguments","getOwnPropertyDescriptor","decorate","__param","paramIndex","__metadata","metadata","ProxyObserver_1","subscriberCollection","_subscriberFlags","addSubscriber","removeSubscriber","hasSubscriber","hasSubscribers","callSubscribers","unsubscribe","collectionSubscriberCollection","_collectionSubscriberFlags","addCollectionSubscriber","removeCollectionSubscriber","hasCollectionSubscriber","hasCollectionSubscribers","callCollectionSubscribers","subscribeToCollection","unsubscribeFromCollection","subscriber","subscriberFlags","_subscriber0","_subscriber1","_subscriber2","_subscribersRest","addProxySubscriber","hasProxySubscriber","_proxySubscriberFlags","_proxySubscriber0","_proxySubscriber1","_proxySubscriber2","_proxySubscribersRest","_collectionSubscriber0","_collectionSubscriber1","_collectionSubscriber2","_collectionSubscribersRest","removeProxySubscriber","hasProxySubscribers","newValue","previousValue","flags","subscriber0","subscriber1","subscriber2","callSubscriber","id","ownFlags","handleChange","callProxySubscribers","handleProxyChange","indexMap","handleCollectionChange","ProxySubscriberCollection","proxy","raw","inBatch","getOrCreate","oldValue","Proxy","$raw","proxyObserver","$observer","getRawIfProxy","receiver","callPropertySubscribers","deleteProperty","thisArg","argArray","apply","ViewModelKind","subscribeToProxy","unsubscribeFromProxy","IController","MountStrategy","IViewFactory","ILifecycle","BoundQueue","lifecycle","head","tail","process","begin","end","controller","prevBound","nextBound","next","cur","afterBind","UnboundQueue","prevUnbound","nextUnbound","afterUnbind","AttachedQueue","mount","prevAttached","nextAttached","afterAttach","DetachedQueue","unmount","prevDetached","nextDetached","afterDetach","MountQueue","prevMount","nextMount","UnmountQueue","prevUnmount","nextUnmount","BatchQueue","queue","batch","flushBatch","currentValue","observing","persistentFlags","getValue","setValue","RuntimeError","Number","marker","freeze","keyOrObj","$synthetic","bc","ancestor","part","overrideContext","parentOverrideContext","bindingContext","parentScope","scopeParts","$observers","oc","OverrideContext","ps","poc","ISignaler","Signaler","signals","listeners","listener","TargetedInstructionType","parentPartsOwnPartsLookup","mergeParts","parentParts","ownParts","ownPartsLookup","mergedParts","ITargetedInstruction","HooksDefinition","hasCreate","hasBeforeCompile","hasAfterCompile","hasAfterCompileChildren","hasBeforeBind","hasAfterBind","hasBeforeUnbind","hasAfterUnbind","hasBeforeAttach","hasAfterAttach","hasBeforeDetach","hasAfterDetach","hasCaching","registerAliases","aliases","keyFrom","none","slotNames","versionSlotNames","lastSlot","ensureEnoughSlotNames","currentSlot","addObserver","observer","observerSlots","version","observeProperty","observerLocator","getObserver","unobserve","all","slots","slotName","connectableDecorator","connectable","BindingBehaviorStrategy","bindingBehavior","nameOrDef","BindingBehavior","assignIdTo","inheritsFromInterceptor","BindingInterceptor","getAnnotation","binding","expr","interceptor","locator","$scope","$state","updateTarget","updateSource","callSource","$bind","$unbind","isType","definition","valueConverter","ValueConverter","hasBind","$kind","hasUnbind","CustomExpression","expression","behaviorKey","evaluate","connect","behavior","evalList","unbind","visitor","visitBindingBehavior","converterKey","converter","toView","fromView","signaler","addSignalListener","removeSignalListener","visitValueConverter","AssignExpression","visitAssign","ConditionalExpression","condition","yes","no","visitConditional","visitAccessThis","$this","$parent","evaluatedValue","visitAccessScope","AccessMemberExpression","visitAccessMember","AccessKeyedExpression","visitAccessKeyed","func","getFunction","visitCallScope","CallMemberExpression","visitCallMember","visitCallFunction","left","right","f","visitBinary","visitUnary","PrimitiveLiteralExpression","visitPrimitiveLiteral","$undefined","$null","$true","$false","$empty","HtmlLiteralExpression","parts","elements","visitHtmlLiteral","ArrayLiteralExpression","visitArrayLiteral","ObjectLiteralExpression","visitObjectLiteral","cooked","expressions","visitTemplate","visitTaggedTemplate","ArrayBindingPattern","visitArrayBindingPattern","ObjectBindingPattern","visitObjectBindingPattern","BindingIdentifier","visitBindingIdentifier","declaration","iterable","size","$array","entry","entries","$map","$number","visitForOfStatement","isMulti","firstExpression","visitInterpolation","list","rawArray","BindingMode","BindingStrategy","State","LifecycleFlags","ExpressionKind","SubscriberFlags","DelegationStrategy","CollectionKind","createIndexMap","deletedItems","isIndexMap","CollectionLengthObserver","observerLookup","sortCompare","y","preSortCompare","insertionSort","from","to","compareFn","velement","ielement","vtmp","itmp","order","quickSort","v0","v1","v2","i0","i1","i2","c01","c02","c12","vpivot","ipivot","lowEnd","highStart","vtopElement","thirdIndex","partition","$push","$unshift","unshift","$pop","pop","$shift","$splice","$reverse","reverse","$sort","methods","observe","argCount","notify","inserts","element","start","deleteCount","relativeStart","actualStart","Math","max","min","actualDeleteCount","itemCount","deleted","middle","lower","upper","lowerValue","lowerIndex","upperValue","upperIndex","descriptorProps","method","enableArrayObservationCalled","enableArrayObservation","indexObservers","collection","lengthObserver","getOrCreateIndexObserver","indexObserver","ArrayIndexObserver","owner","subscriberCount","arrayObserver","currValue","addIndexObserver","removeIndexObserver","getArrayObserver","computedOverrideDefaults","static","volatile","CustomSetterObserver","convertProperty","overrides","propertyDeps","collectionDeps","isCollecting","createGetterTraps","subscribable","getValueAndCollectDependencies","unsubscribeAllDependencies","requireCollect","doNotCollect","addCollectionDep","proxyOrValue","getMapObserver","getSetObserver","addPropertyDep","defaultClockSettings","forceUpdateInterval","IClock","globalClock","opts","highRes","TaskQueuePriority","IScheduler","createPromise","$resolve","$reject","executor","reject","Promise","defaultQueueTaskOptions","delay","preempt","priority","persistent","reusable","TaskQueue","clock","scheduler","processingSize","processingHead","processingTail","pendingSize","pendingHead","pendingTail","delayedSize","delayedHead","delayedTail","flushRequested","yieldPromise","taskPool","taskPoolSize","lastRequest","microTaskRequestFlushTask","cancel","movePendingToProcessing","moveDelayedToProcessing","run","requestFlush","getTaskQueue","queueTask","noMoreFiniteWork","cancelFlush","time","task","reuse","Task","prev","status","taskQueue","remove","addToProcessing","queueTime","addToPending","addToDelayed","removeFromProcessing","removeFromDelayed","removeFromPending","reset","createdTime","finish","count","TaskAbortError","super","_result","_status","promise","ret","resetPersistentTask","err","returnToPool","isEmpty","IDirtyChecker","DirtyCheckSettings","framesPerCheck","disabled","throw","tracked","elapsedFrames","DirtyCheckProperty","queueRenderTask","check","delta","isDirty","flush","dirtyChecker","addProperty","removeProperty","CollectionSizeObserver","$clear","clear","oldSize","deleteResult","enableMapObservationCalled","enableMapObservation","noop","PrimitiveObserver","doNotCache","getStringLength","returnUndefined","PropertyAccessor","setValueDirect","$add","enableSetObservationCalled","observedSet","enableSetObservation","IObserverLocator","ITargetObserverLocator","ITargetAccessorLocator","targetObserverLocator","targetAccessorLocator","adapters","isBindingContext","getObservers","observersLookup","createPropertyObserver","getOrCreateObserversLookup","adapter","handles","overridesAccessor","getAccessor","observedArray","observedMap","createObserversLookup","isNode","getLengthObserver","getIndexObserver","subject","pd","getPropertyDescriptor","adapterObserver","getAdapterObserver","createProperty","computed","givenOverrides","createComputedObserver","oneTime","toViewOrOneTime","sourceExpression","targetProperty","targetObserver","$lifecycle","_previousValue","$args","IExpressionParser","expressionLookup","forOfLookup","interpolationLookup","bindingType","found","parseCore","firstPart","currentPart","BindingType","MultiInterpolationBinding","interpolation","isFirst","_newValue","Boolean","toBindingContext","cbName","$set","isProxy","propertyChangedCallback","propertyChanged","hasPropertyChangedCallback","shouldInterceptSet","createGetterSetter","is","BindingModeBehavior","originalModes","twoWay","firstArg","getPostRenderTaskQueue","signal","names","lastCall","nextDelay","configOrTarget","$target","$prop","Bindable","isBindableAnnotation","bindableLists","bindables","addName","maybeList","addDescription","builder","configOrProp","attribute","primary","setInterpreter","propStart","prototypeChain","keysLen","Class","iProto","iDefs","customAttribute","CustomAttribute","templateController","isTemplateController","defaultBindingMode","hooks","noMultiBindings","for","node","INode","IRenderLocation","IDOM","ni","niDOM","addEventListener","appendChild","cloneNode","convertToRenderLocation","createDocumentFragment","createNodeSequence","createElement","createCustomEvent","dispatchEvent","createNodeObserver","createTemplate","createTextNode","getEffectiveParentNode","setEffectiveParentNode","insertBefore","isMarker","isNodeInstance","isRenderLocation","makeTarget","registerElementResolver","removeEventListener","setAttribute","DOM","dom","isInitialized","descriptors","protos","getOwnPropertyDescriptors","location","view","hold","$controller","attach","detach","InfrequentMutations","FrequentMutations","ObserveShallow","LifecycleTask","done","canCancel","wait","TaskSlot","IStartTask","TaskType","IStartTaskManager","slot","tasks","startTask","resolveTask","AggregateTerminalTask","PromiseTask","hasStarted","isCancelled","then","nextResult","ProviderTask","maybePromiseOrTask","catch","ContinuationTask","antecedent","TerminalTask","AggregateContinuationTask","antecedents","hasAsyncWork","ifFactory","elseFactory","elseView","ifView","swap","attachView","release","ensureView","deactivate","updateView","activate","bindView","ifBehavior","viewModel","renderable","hasPendingInstanceMutation","views","normalizedItems","checkCollectionObserver","bindings","forOf","local","normalizeToArray","processViewsKeyed","attachViews","detachViewsByRange","unbindAndRemoveViewsByRange","oldLength","createAndBindAllViews","attachViewsKeyed","offset","applyMutationsToIndices","detachViewsByKey","unbindAndRemoveViewsByKey","createAndBindNewViewsByKey","sortViewsByKey","oldObserver","newObserver","rawCollection","getCollectionObserver","items","iterate","iStart","iEnd","adjustLength","deletedLen","viewScope","newLen","fromParent","setContextualProperties","mapLen","nodes","unlink","copy","synchronizeIndices","seq","maxLen","prevIndices","Int32Array","tailIndices","cursor","low","high","mid","longestIncreasingSubsequence","seqLen","link","isLast","isEven","$index","$first","$last","$middle","$even","$odd","$length","bindChild","isChildrenObserverAnnotation","Children","childrenObserverLists","childrenObservers","options","defaultChildQuery","defaultChildFilter","defaultChildMap","children","tryStartObserving","projector","filterChildren","subscribeToChildrenChange","onChildrenChanged","CustomElement","customElement","definitionLookup","template","instructions","injectable","needsCompile","surrogates","containerless","isStrictBinding","shadowOptions","hasSlots","generateName","generateType","partialDefinition","nameOrSearchParents","searchParents","$injectable","nameDescriptor","defaultProto","IProjectorLocator","SCRIPT_REGEX","ISanitizer","SanitizeValueConverter","sanitizer","untrustedMarkup","sanitize","ITemplateCompiler","IInstructionRenderer","IRenderer","instructionRenderer","instructionType","decoratedTarget","metadataKeys","ownProperties","instructionRenderers","record","render","targets","host","targetInstructions","renderInstructions","type","ensureExpression","parser","srcOrExpr","parse","getTarget","potentialTarget","SetPropertyRenderer","instruction","getComponentFactory","res","component","createComponent","childController","forCustomElement","addController","forCustomAttribute","parentContext","viewFactory","getRenderContext","getViewFactory","renderLocation","componentFactory","controllers","childInstructions","childInstruction","applyBindingBehavior","addBinding","refHost","refTargetName","caController","ceController","getRefTarget","behaviorExpressionIndex","behaviorExpressions","behaviorExpression","behaviorOrFactory","definitionContainerLookup","definitionContainerPartsLookup","fragmentCache","isRenderContext","parentContainer","containerLookup","containerPartsLookup","partsLookup","viewModelProvider","fragment","isCompiled","compiledDefinition","createChild","renderer","factoryProvider","parentControllerProvider","instructionProvider","renderLocationProvider","elementProvider","compiler","compile","prepare","parentController","resourceKey","templateDefinition","controllerLookup","vmKind","mountStrategy","getCached","getDefinition","getBindingContext","hydrateCustomElement","hydrateCustomAttribute","hydrateSynthetic","createObservers","childObserverNames","getOwnPropertyNames","observers","getLookup","childrenDescription","createChildrenObservers","beginChildComponentOperation","beforeCompile","compiledContext","projectorLocator","getElementProjector","createNodes","afterCompile","findTargets","afterCompileChildren","canReturnToCache","unmountSynthetic","bindCustomElement","bindCustomAttribute","bindSynthetic","unbindCustomElement","unbindCustomAttribute","unbindSynthetic","attachCustomElement","attachCustomAttribute","attachSynthetic","detachCustomElement","detachCustomAttribute","detachSynthetic","mountCustomElement","mountSynthetic","unmountCustomElement","cacheCustomElement","cacheCustomAttribute","cacheSynthetic","find","beforeBind","bindBindings","endBind","bindControllers","beforeUnbind","unbindControllers","endUnbind","unbindBindings","beforeAttach","attachControllers","beforeDetach","detachControllers","project","take","tryReturnToCache","caching","noProxy","observableNames","bindable","isCaching","cacheSize","doNotOverrideIfAlreadySet","maxCacheSize","parseInt","forSyntheticView","seenViews","WeakSet","notYetSeen","$view","toCustomElementDefinition","Views","definitions","$views","IViewLocator","ViewValueConverter","viewLocator","viewNameOrSelector","getViewComponentForObject","IActivator","taskManager","mgr","runBeforeRender","runBeforeBind","runBeforeAttach","getCachedOrThrow","initializer","IDOMInitializer","initialize","activator","beforeCreateTask","runBeforeCreate","createTask","combinedAntecedent","_isRunning","_isStarting","_isStopping","_root","isRunning","stop","onBeforeStart","onAfterStart","onBeforeStop","onAfterStop","detail","bubbles","cancelable","global","Aurelia","DefaultComponents","modelInstanceToBoundComponent","modelTypeToUnboundComponent","availableViews","resolvedViewName","getViewName","getOrCreateBoundComponent","BoundComponent","UnboundComponent","getOrCreateUnboundComponent","getView","vm","requestedName","v","DefaultResources","DefaultRenderers","RuntimeConfiguration","InterpolationInstruction","IteratorBindingInstruction","CallBindingInstruction","RefBindingInstruction","SetPropertyInstruction","HydrateElementInstruction","HydrateAttributeInstruction","HydrateTemplateController","LetElementInstruction","LetBindingInstruction","$StartTask","_slot","_promiseOrTask","_container","_key","_callback","_task","promiseOrTask","at","targetEvent","delegationStrategy","preventDefault","eventManager","$event","AttributeObserver","targetAttribute","hasChanges","flushChanges","classList","style","setProperty","mutationRecords","shouldProcess","attributeName","contains","getPropertyValue","getAttribute","startObservation","stopObservation","subscription","$eMObservers","$mObserver","handleMutation","disconnect","invokeHandleMutation","$scheduler","AttributeNSAccessor","namespace","removeAttributeNS","setAttributeNS","getAttributeNS","defaultMatcher","CheckedObserver","valueObserver","model","synchronizeElement","elementValue","isRadio","matcher","checked","findIndex","ClassAttributeAccessor","nameIndex","isActive","classesToAdd","getClassesToAdd","addClassesAndUpdateIndex","classes","className","splitClassString","classString","matches","match","DataAttributeAccessor","removeAttribute","ElementPropertyAccessor","findOriginalEventTarget","composedPath","deepPath","path","stopPropagation","standardStopPropagation","propagationStopped","handleCapturedEvent","orderedCallbacks","capturedCallbacks","parentNode","orderedCallback","handleEvent","handleDelegatedEvent","delegatedCallbacks","ListenerTracker","eventName","capture","DelegateOrCaptureSubscription","decrement","TriggerSubscription","EventSubscriber","events","callbackOrListener","IEventManager","delegatedHandlers","capturedHandlers","handlerEntry","bubbling","increment","capturing","childObserverOptions","childList","subtree","characterData","SelectValueObserver","nodeObserver","multiple","synchronizeOptions","synchronizeValue","option","optionValue","selected","handleNodeChange","styles","cssText","styleTuples","rx","exec","getStyleTuples","getStyleTuplesFromString","getStyleTuplesFromArray","getStyleTuplesFromObject","tuple","ISVGAnalyzer","ValueAttributeObserver","xlinkNS","xmlNS","xmlnsNS","nsAttributes","inputEvents","selectEvents","contentEvents","scrollEvents","overrideProps","svgAnalyzer","tagName","nsProps","isDataAttribute","IsDataAttribute","prefix","isStandardSvgAttribute","handleSelfEvent","selfEventCallSource","originalHandler","noopShadowDOMStyles","applyTo","IShadowDOMStyles","IShadowDOMGlobalStyles","defaultShadowOptions","shadowRoot","attachShadow","childNodes","getRootNode","NodeType","effectiveParentNodeOverrides","window","document","TNode","TElement","THTMLElement","TCustomEvent","TCSSStyleSheet","TShadowRoot","Node","Element","HTMLElement","CustomEvent","CSSStyleSheet","ShadowRoot","destroy","emptyNodes","FragmentNodeSequence","publisher","child","deep","locationEnd","createComment","locationStart","replaceChild","$start","$nodes","markupOrNode","content","init","fetch","eventType","evt","MutationObserver","takeRecords","markup","innerHTML","text","containerlessOffset","nextSibling","nodeType","textContent","childNodeOrNodeSequence","nodeToInsert","referenceNode","nodeName","potentialNode","removeChild","$DOM","isMounted","isLinked","refNode","targetNodeList","querySelectorAll","childNodeList","firstChild","lastChild","addToLinked","obtainRefNode","previousSibling","unset","defaultCaptureEventInit","passive","defaultBubbleEventInit","blurDocMap","BlurManager","blurs","createHandler","blur","addListeners","removeListeners","doc","win","navigator","pointerEnabled","linkedMultiple","searchSubTree","linkingContext","manager","createFor","unregister","triggerBlur","els","containsElementOrShadowRoot","linkedWith","links","contextNode","querySelector","body","el","onBlur","checkTargets","hasChecked","revertCheckage","markChecked","handleMousedown","composed","handleEventTarget","onpointerdown","ontouchstart","onmousedown","onfocus","onblur","Focus","needsApply","valueChanged","activeElement","focus","toTask","originalLoc","strict","currentTarget","callbackContext","targetChanged","oldTarget","newTarget","resolveTarget","activating","activated","deactivating","deactivated","$document","renderContext","queryContext","HTMLTargetedInstructionType","isHTMLTargetedInstruction","TextBindingInstruction","SetAttributeInstruction","SetClassAttributeInstruction","SetStyleAttributeInstruction","AttributeBindingInstruction","attr","tagOrType","props","allInstructions","hasInstructions","addChildren","createElementForTag","createElementForType","lazyDefinition","getContext","mergeInto","composing","lastSubject","properties","reduce","acc","compose","viewPromise","resolveView","onComposed","provideViewFor","lockScope","isController","createView","SetAttributeRenderer","SetClassAttributeRenderer","addClasses","SetStyleAttributeRenderer","$component","RuntimeHtmlConfiguration","AttrSyntax","rawName","rawValue","command","CharSpec","chars","repeat","isSymbol","isInverted","hasOfNoneInverse","hasOfSingleInverse","hasOfMultipleInverse","hasOfNone","hasOfSingle","hasOfMultiple","other","_pattern","currentRecord","partsRecord","pattern","charSpec","patterns","nextStates","types","isEndpoint","equals","findChild","interpretation","childLen","append","StaticSegment","specs","DynamicSegment","symbols","spec","SymbolSegment","SegmentTypes","statics","dynamics","ISyntaxInterpreter","SyntaxInterpreter","rootState","initialStates","defOrDefs","currentState","segments","eachChar","states","getNextStates","aTypes","bTypes","findMatches","IAttributePattern","attributePattern","patternDefs","AttributePattern","definitionAnnotationKey","validatePrototype","getPatternDefinitions","IAttributeParser","interpreter","attrPatterns","attrPattern","interpret","bindingCommand","nameOrDefinition","BindingCommand","makeCamelCase","propName","syntax","SymbolFlags","createMarker","TemplateControllerSymbol","partName","physicalNode","_bindings","_parts","ReplacePartSymbol","CustomAttributeSymbol","PlainAttributeSymbol","BindingSymbol","CustomElementSymbol","isTarget","_customAttributes","_plainAttributes","_childNodes","isContainerless","LetElementSymbol","PlainElementSymbol","TextSymbol","default","unescapeCode","Access","Precedence","Token","Char","startIndex","lastIndex","currentToken","tokenValue","assignable","currentChar","SyntaxError","SemanticError","parseExpression","access","minPrecedence","nextToken","fromCharCode","parseInterpolation","op","TokenValues","consumeOpt","consume","parseArrayLiteralExpression","parseObjectLiteralExpression","parseTemplate","statement","parseForOfStatement","strings","opToken","tokenRaw","tagged","scanTemplateTail","CharScanners","scanNumber","isFloat","parseFloat","scanTemplate","token","expected","KeywordLookup","true","null","false","in","instanceof","typeof","void","of","codes","decompress","compressed","rangeCount","fill","returnToken","unexpectedCharacter","notMapped","IdParts","Uint8Array","quote","unescaped","buffer","last","unescapedStr","scanString","DefaultBindingSyntax","DefaultBindingLanguage","BindableInfo","bindableInfo","hasPrimary","isPrimary","contextLookup","elementLookup","attributeLookup","commandLookup","rootContainer","rootResourceResolvers","optional","kind","$global","self","_a","isBrowserLike","isWebWorkerLike","isNodeLike","versions","$now","getNanoSeconds","hrtime","moduleLoadTime","nodeLoadTime","upTime","performance","$performance","hr","uptime","emptyObject","$PLATFORM","PLATFORM","getMessageInfoForCode","codeLookup","createInvalidCodeMessageInfo","0","1","2","3","4","5","6","7","8","9","10","11","12","14","15","16","17","18","19","20","21","22","30","31","100","101","102","103","104","105","106","107","108","109","110","111","150","151","401","402","800","801","2000","2001","2002","2003","2004","1001","10000","TraceInfo","stack","defaultOptions","rendering","observation","mounting","di","jit","flagsText","flagNames","stringifyLifecycleFlags","_ctorName","description","ctorName","scopeText","$ctorName","keyText","$key","primitive","RenderingArgsProcessor","$hydrate","addComponent","BindingArgsProcessor","lockedBind","lockedUnbind","InternalObserversLookup","ObservationArgsProcessor","valueText","AttachingArgsProcessor","$attach","$detach","$cache","MountingArgsProcessor","$mount","$unmount","DIArgsProcessor","LifecycleArgsProcessor","JitArgsProcessor","TemplateBinder","IAttrSyntaxTransformer","invalidSurrogateAttribute","attributesToIgnore","hasInlineBindings","isTemplateControllerOf","manifest","resources","attrParser","exprParser","attrSyntaxTransformer","surrogate","attrSyntax","getBindingCommand","attrInfo","getAttributeInfo","transform","bindPlainAttribute","bindChildNodes","parentManifest","manifestRoot","parentManifestRoot","bindLetElement","elementInfo","getElementInfo","bindAttributes","symbol","manifestProxy","previousController","currentController","declareTemplateController","ensureAttributeOrder","manifestNode","currentTemplate","processTemplateControllers","partOwner","replacePart","proxyNode","processReplacePart","plainAttributes","modelOrValueIndex","checkedIndex","childNode","nextChild","bindManifest","bindText","textNode","wholeText","processInterpolationText","attrRawValue","bindMultiAttribute","customAttributes","valueLength","attrName","attrValue","attrTarget","ITemplateElementFactory","markupCache","firstElementChild","nextElementSibling","attrSyntaxModifier","binder","compilation","customAttributeLength","plainAttributeLength","compileCustomAttribute","compilePlainAttribute","compileChildNodes","toDefinition","instructionRows","compileParentNode","instructionRow","compileAttributes","compileBindings","compileParts","compileCustomElement","compilePlainElement","compileTemplateController","controllerInstructionRows","controllerScopeParts","bindingInstructions","compileBinding","attributeInstructions","plainAttributesLength","isOnSurrogate","replaceParts","partScopeParts","partInstructionRows","hasAttribute","shouldDefaultToTwoWay","createMicrotaskFlushRequestor","called","wnd","queueMicrotask","$window","$flush","callFlush","createQueueMicrotaskFlushRequestor","createPromiseFlushRequestor","flip","val","createMutationObserverFlushRequestor","createSetTimeoutFlushRequestor","clearTimeout","request","setTimeout","createRequestAnimationFrameFlushRequestor","cancelAnimationFrame","requestAnimationFrame","createPostRequestAnimationFrameFlushRequestor","rafHandle","timeoutHandle","queueFlush","createRequestIdleCallbackFlushRequestor","hasNative","requestIdleCallback","timeout","cancelIdleCallback","BrowserScheduler","microTaskTaskQueue","renderTaskQueue","macroTaskTaskQueue","postRenderTaskQueue","idleTaskQueue","yield","yieldIdleTask","yieldPostRenderTask","yieldMacroTask","yieldRenderTask","yieldMicroTask","ownerDocument","RuntimeHtmlBrowserConfiguration","JitHtmlBrowserConfiguration","createAurelia","au","env","app","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","runClearTimeout","Item","nextTick","title","browser","argv","on","addListener","once","off","removeListener","removeAllListeners","prependListener","prependOnceListener","cwd","chdir","dir","umask","api","exported","locals","g","memo","isOldIE","atob","styleTarget","HTMLIFrameElement","contentDocument","stylesInDom","modulesToDom","css","media","sourceMap","addStyle","insertStyleElement","nonce","insert","textStore","replaceText","replacement","applyToSingletonTag","styleSheet","cssNode","applyToTag","btoa","unescape","JSON","stringify","singletonCounter","update","styleIndex","removeStyleElement","newObj","base","newList","___CSS_LOADER_API_IMPORT___","useSourceMap","cssMapping","sourceMapping","base64","sourceURLs","sources","sourceRoot","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","_i","retryStrategy","defaultRetryConfig","maxRetries","interval","retryConfig","counter","requestClone","response","httpClient","doRetry","minRandomInterval","maxRandomInterval","retryStrategies","calculateDelay","newRequest","beforeRetry","retryableRequest","retryCount","random","baseUrl","defaults","interceptors","credentials","rejectErrorResponses","withInterceptor","rejectOnError","ok","absoluteUrlRegexp","activeRequestCount","isRequesting","isConfigured","normalizedConfig","isPrototypeOf","Headers","headers","retryInterceptorIndex","trackRequestStart","buildRequest","processRequest","Response","Request","processResponse","trackRequestEnd","requestContentType","parsedDefaultHeaders","parsedHeaders","$headers","parseHeaderValues","bodyObj","requestInit","url","test","getRequestUrl","isJSON","defaultHeaders","$defaultHeaders","setDefaultHeaders","Blob","callFetch","applyInterceptors","successName","errorName","interceptorArgs","successHandler","errorHandler","identity","reason","thrower","Queue","pending","processing","allowedExecutionCostWithinTick","currentExecutionCostInCurrentTick","dequeue","itemOrItems","costOrCosts","costs","promises","qItem","cost","useUrlFragmentHash","forwardedState","handlePopstate","ev","enqueue","processCalls","qCall","parameters","suppressPopstate","history","pendingCalls","pathname","search","hash","currentEntry","viewerState","go","navigationEntry","firstEntry","pushNavigatorState","calls","_resolve","useHref","getEventInfo","shouldHandleEvent","anchor","targetIsThisWindow","altKey","ctrlKey","metaKey","shiftKey","gotoAttr","goto","href","leftButtonClicked","button","targetWindow","arrayRemove","removed","arrIndex","parseQuery","param","ContentStatus","fullStateInstruction","contentStatus","entered","fromCache","fromHistory","reentry","isComponentType","componentType","toComponentType","componentInstance","viewport","sameComponent","reentryBehavior","fallback","toComponentInstance","setParameters","componentName","setComponent","ee","previousInstruction","canEnter","typeParameters","toSpecifiedParameters","merged","router","createViewportInstruction","nextInstruction","canLeave","stateful","getElementsByTagName","top","scrollTo","scrollTop","scrollLeft","removeComponent","terminateComponent","unloadComponent","destroyComponent","owningScope","rootComponentType","catches","nextContent","available","sourceItem","sourceItemIndex","connectedScope","enabledChildren","isViewportScope","viewportScope","viewportInstruction","instructionResolver","parseViewportInstruction","isClearViewportInstruction","isClearAllViewportsInstruction","isAddViewportInstruction","removeSourceItem","segment","clearViewportInstruction","addViewportInstruction","getAvailableSourceItem","siblings","every","sibling","routes","HandlerEntry","RouteGenerator","handlers","TypesRecord","stars","RecognizeResult","isDynamic","invalidChars","validChars","escapeRegex","RegExp","caseSensitive","string","consumed","StarSegment","EpsilonSegment","route","skippableStates","regex","routeName","normalizedRoute","splitRoute","firstState","put","nextState","routeNames","nameOrRoute","getRoute","generationUsesHref","routeParams","segmentValue","generate","isSlashDropped","normalizedPath","queryStart","decodeURI","pathLen","solutions","solution","captures","currentCapture","FoundRoute","matching","remaining","currentIndex","hasScope","replacedChildren","childCollections","passThroughScope","isViewport","scopes","some","viewportScopes","viewports","includeDisabled","allViewports","allScopes","getOwnedScopes","alreadyFound","disregardViewports","foundViewports","remainingInstructions","ownedScopes","availableViewportScopes","availableViewports","getEnabledViewports","viewportName","viewportInstructions","foundViewportScope","removeCurrent","foundViewport","acceptSegment","addSourceItem","needsViewportDescribed","wantComponent","ownsScope","acceptComponent","remainingViewports","nextScopeInstructions","rem","withoutViewports","doesntNeedViewportDescribed","setViewport","getOwnedViewports","addChild","setElement","vp","includeReplaced","hoistedChildren","reparentViewportInstructions","findMatchingRouteInRoutes","getRoutes","findMatchingRoute","recognizableRoutes","ensureProperRoute","ilen","newRoute","recognizer","recognize","remainingPath","foundConfiguration","cloneViewportInstructions","addParameters","NavigationInstructionResolver","toViewportInstructions","forceRemove","elementResolve","previousViewportState","historyCache","navigation","back","forward","cached","isCacheEqual","clearReplacedChildren","equalComponent","refresh","disableReplacedChildren","equalParameters","clearState","usedBy","noLink","noHistory","parseViewportInstructions","freeContent","doForceRemove","statefulHistory","waitForElement","loadComponent","initializeComponent","unloadContent","reenableReplacedChildren","ComponentAppellationResolver","isName","isInstance","getName","getType","getInstance","ViewportHandleResolver","createViewportInstructions","navigationInstructions","findScope","rootScope","viewportComponent","newInstruction","ParametersType","ReentryBehavior","HookTypes","parametersString","parametersRecord","parametersList","parametersType","parseComponentParameters","typedParameters","stringifyComponentParameters","isComponentName","isComponentInstance","getViewport","specifications","specified","parameter","sorted","compareParameters","compareType","sameParameters","mine","others","Hook","hook","includeTargets","excludeTargets","include","exclude","navigationInstruction","arg","cvTarget","beforeNavigation","transformFromUrl","transformToUrl","lastIdentity","hookFunction","wantsMatch","outcome","nav","linkVisible","linkActive","visible","active","meta","parseRoute","computeLink","consideredActive","execute","computeVisible","computeActive","activeChild","components","activeComponents","flattenViewportInstructions","stringifyViewportInstructions","addRoute","updateRoutes","QueueTask","createQueueTask","eventTask","async","evTask","suppressPopstateEvent","popstate","doneTask","forwardState","steps","titleOrEmpty","pushState","replaceState","popState","ClosestScope","IRouter","linkHandler","navs","appendedInstructions","statefulHistoryLength","useDirectRoutes","useConfiguredRoutes","loadedFirst","processingNavigation","lastNavigation","staleChecks","linkCallback","origin","navigatorCallback","processNavigations","navigatorSerializeCallback","preservedEntries","excludeComponents","preservedEntry","serialized","alreadyDone","freeComponents","browserNavigatorCallback","browserNavigationEvent","fromBrowser","navigate","qInstruction","reportCallback","instructionNavigation","configuredRoute","findInstructions","configuredRoutePath","foundInstructions","unknownRoute","clearScopeOwners","clearViewportScopes","clearInstruction","instr","addInstruction","isAddAllViewportsInstruction","updatedScopeOwners","alreadyFoundInstructions","findViewports","guard","log","changedScopeOwners","hooked","hookManager","invokeBeforeNavigation","cancelNavigation","scopeOwner","setNextContent","abortContentChange","hasRemaining","configured","routeScopeOwners","appendInstructions","appendedInstruction","existingAlreadyFound","sameViewport","existingFound","existingRemaining","loadContent","replacePaths","new","first","repeating","untracked","finalizeContentChange","finalize","addHooks","separators","store","serializeCallback","ensureRootScope","replacing","getClosestScope","viewModelOrContainer","getContainer","viewModelOrElement","getClosestContainer","findParentScope","addViewport","setClosestScope","removeViewport","unsetClosestScope","addViewportScope","removeViewportScope","toOptions","matchScope","matchChildren","flat","findNav","addNav","addRoutes","addHook","instructionScope","transformUrl","invokeTransformFromUrl","hasSiblingInstructions","foundRoute","nextInstructions","staleCheck","activeRoute","invokeTransformToUrl","fullViewportStates","CustomElementFor","nodeResourceName","qEntry","navigationFlags","uninitializedEntry","loadState","refreshing","historyMovement","pendingNavigations","movement","newIndex","saveState","getState","storedEntry","toStoredEntry","toStoreableEntry","replaceNavigatorState","previous","storableEntry","popNavigatorState","indexPreserve","previousEntry","storeable","scopeStart","scopeEnd","noScope","parametersEnd","parameterSeparator","parameterKeySeparator","action","setInstructionResolver","parsedInstructions","parseViewportInstructionsWorker","excludeViewport","viewportContext","stringifyViewportInstruction","stringifyAViewportInstruction","excludeCurrentViewport","excludeCurrentComponent","forceDescription","stringified","nextStringified","stringifyScopedViewportInstructions","scopeContext","clearViewports","newPath","merge","keepInstances","clones","uriComponent","seps","grouped","parseAViewportInstruction","tokens","pos","specials","special","findNextToken","excludeComponent","instructionString","specification","toSortedParameters","NavCustomElement","ul","li","ulActive","liActive","aActive","ParentViewport","createInjectable","parentViewport","isBound","connectViewport","disconnectViewport","checkExists","ParentViewportScope","connectViewportScope","disconnectViewportScope","hasHref","activeClass","updateValue","created","checkActive","eventListener","hasGoto","configurationOptions","configurationCall","routerConfiguration","with","loadUrl","Shiur","shiur","normalize","toLocaleLowerCase","author","series","subseries","date","client","shiurim","selectedShiur","selectedVersion","json","currentYear","getFullYear","getVersionLocation"],"mappings":"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,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SA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","file":"entry-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","export var LogLevel;\n(function (LogLevel) {\n    /**\n     * The most detailed information about internal app state.\n     *\n     * Disabled by default and should never be enabled in a production environment.\n     */\n    LogLevel[LogLevel[\"trace\"] = 0] = \"trace\";\n    /**\n     * Information that is useful for debugging during development and has no long-term value.\n     */\n    LogLevel[LogLevel[\"debug\"] = 1] = \"debug\";\n    /**\n     * Information about the general flow of the application that has long-term value.\n     */\n    LogLevel[LogLevel[\"info\"] = 2] = \"info\";\n    /**\n     * Unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n     */\n    LogLevel[LogLevel[\"warn\"] = 3] = \"warn\";\n    /**\n     * Unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n     */\n    LogLevel[LogLevel[\"error\"] = 4] = \"error\";\n    /**\n     * Unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n     */\n    LogLevel[LogLevel[\"fatal\"] = 5] = \"fatal\";\n    /**\n     * No messages should be written.\n     */\n    LogLevel[LogLevel[\"none\"] = 6] = \"none\";\n})(LogLevel || (LogLevel = {}));\nexport const Reporter = {\n    level: 3 /* warn */,\n    write(code, ...params) { return; },\n    error(code, ...params) { return new Error(`Code ${code}`); }\n};\nexport const Tracer = {\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) { return; },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() { return; },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) { return; },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) { return; },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() { return; }\n};\nfunction enableLiveLogging(optionsOrWriter) { return; }\n//# sourceMappingURL=reporter.js.map","import { PLATFORM } from './platform';\nconst isNumericLookup = {};\n/**\n * Efficiently determine whether the provided property key is numeric\n * (and thus could be an array indexer) or not.\n *\n * Always returns true for values of type `'number'`.\n *\n * Otherwise, only returns true for strings that consist only of positive integers.\n *\n * Results are cached.\n */\nexport function isArrayIndex(value) {\n    switch (typeof value) {\n        case 'number':\n            return value >= 0 && (value | 0) === value;\n        case 'string': {\n            const result = isNumericLookup[value];\n            if (result !== void 0) {\n                return result;\n            }\n            const length = value.length;\n            if (length === 0) {\n                return isNumericLookup[value] = false;\n            }\n            let ch = 0;\n            for (let i = 0; i < length; ++i) {\n                ch = value.charCodeAt(i);\n                if (i === 0 && ch === 0x30 && length > 1 /* must not start with 0 */ || ch < 0x30 /* 0 */ || ch > 0x39 /* 9 */) {\n                    return isNumericLookup[value] = false;\n                }\n            }\n            return isNumericLookup[value] = true;\n        }\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isNumberOrBigInt(value) {\n    switch (typeof value) {\n        case 'number':\n        case 'bigint':\n            return true;\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isStringOrDate(value) {\n    switch (typeof value) {\n        case 'string':\n            return true;\n        case 'object':\n            return value instanceof Date;\n        default:\n            return false;\n    }\n}\n/**\n * Base implementation of camel and kebab cases\n */\nconst baseCase = (function () {\n    let CharKind;\n    (function (CharKind) {\n        CharKind[CharKind[\"none\"] = 0] = \"none\";\n        CharKind[CharKind[\"digit\"] = 1] = \"digit\";\n        CharKind[CharKind[\"upper\"] = 2] = \"upper\";\n        CharKind[CharKind[\"lower\"] = 3] = \"lower\";\n    })(CharKind || (CharKind = {}));\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const isDigit = Object.assign(Object.create(null), {\n        '0': true,\n        '1': true,\n        '2': true,\n        '3': true,\n        '4': true,\n        '5': true,\n        '6': true,\n        '7': true,\n        '8': true,\n        '9': true,\n    });\n    function charToKind(char) {\n        if (char === '') {\n            // We get this if we do charAt() with an index out of range\n            return 0 /* none */;\n        }\n        if (char !== char.toUpperCase()) {\n            return 3 /* lower */;\n        }\n        if (char !== char.toLowerCase()) {\n            return 2 /* upper */;\n        }\n        if (isDigit[char] === true) {\n            return 1 /* digit */;\n        }\n        return 0 /* none */;\n    }\n    return function (input, cb) {\n        const len = input.length;\n        if (len === 0) {\n            return input;\n        }\n        let sep = false;\n        let output = '';\n        let prevKind;\n        let curChar = '';\n        let curKind = 0 /* none */;\n        let nextChar = input.charAt(0);\n        let nextKind = charToKind(nextChar);\n        for (let i = 0; i < len; ++i) {\n            prevKind = curKind;\n            curChar = nextChar;\n            curKind = nextKind;\n            nextChar = input.charAt(i + 1);\n            nextKind = charToKind(nextChar);\n            if (curKind === 0 /* none */) {\n                if (output.length > 0) {\n                    // Only set sep to true if it's not at the beginning of output.\n                    sep = true;\n                }\n            }\n            else {\n                if (!sep && output.length > 0 && curKind === 2 /* upper */) {\n                    // Separate UAFoo into UA Foo.\n                    // Separate uaFOO into ua FOO.\n                    sep = prevKind === 3 /* lower */ || nextKind === 3 /* lower */;\n                }\n                output += cb(curChar, sep);\n                sep = false;\n            }\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to camelCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert DOM attribute names to ViewModel property names.\n *\n * Results are cached.\n */\nexport const camelCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? char.toUpperCase() : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to PascalCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert element names to class names for synthetic types.\n *\n * Results are cached.\n */\nexport const pascalCase = (function () {\n    const cache = Object.create(null);\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = camelCase(input);\n            if (output.length > 0) {\n                output = output[0].toUpperCase() + output.slice(1);\n            }\n            cache[input] = output;\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to kebab-case.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert ViewModel property names to DOM attribute names.\n *\n * Results are cached.\n */\nexport const kebabCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? `-${char.toLowerCase()}` : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently (up to 10x faster than `Array.from`) convert an `ArrayLike` to a real array.\n *\n * Primarily used by Aurelia to convert DOM node lists to arrays.\n */\nexport function toArray(input) {\n    // benchmark: http://jsben.ch/xjsyF\n    const { length } = input;\n    const arr = Array(length);\n    for (let i = 0; i < length; ++i) {\n        arr[i] = input[i];\n    }\n    return arr;\n}\nconst ids = {};\n/**\n * Retrieve the next ID in a sequence for a given string, starting with `1`.\n *\n * Used by Aurelia to assign unique ID's to controllers and resources.\n *\n * Aurelia will always prepend the context name with `au$`, so as long as you avoid\n * using that convention you should be safe from collisions.\n */\nexport function nextId(context) {\n    if (ids[context] === void 0) {\n        ids[context] = 0;\n    }\n    return ++ids[context];\n}\n/**\n * Reset the ID for the given string, so that `nextId` will return `1` again for the next call.\n *\n * Used by Aurelia to reset ID's in between unit tests.\n */\nexport function resetId(context) {\n    ids[context] = 0;\n}\n/**\n * A compare function to pass to `Array.prototype.sort` for sorting numbers.\n * This is needed for numeric sort, since the default sorts them as strings.\n */\nexport function compareNumber(a, b) {\n    return a - b;\n}\nconst emptyArray = PLATFORM.emptyArray;\n/**\n * Efficiently merge and deduplicate the (primitive) values in two arrays.\n *\n * Does not deduplicate existing values in the first array.\n *\n * Guards against null or undefined arrays.\n *\n * Returns `PLATFORM.emptyArray` if both arrays are either `null`, `undefined` or `PLATFORM.emptyArray`\n *\n * @param slice - If `true`, always returns a new array copy (unless neither array is/has a value)\n */\nexport function mergeDistinct(arr1, arr2, slice) {\n    if (arr1 === void 0 || arr1 === null || arr1 === emptyArray) {\n        if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n            return emptyArray;\n        }\n        else {\n            return slice ? arr2.slice(0) : arr2;\n        }\n    }\n    else if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n        return slice ? arr1.slice(0) : arr1;\n    }\n    const lookup = {};\n    const arr3 = slice ? arr1.slice(0) : arr1;\n    let len1 = arr1.length;\n    let len2 = arr2.length;\n    while (len1-- > 0) {\n        lookup[arr1[len1]] = true;\n    }\n    let item;\n    while (len2-- > 0) {\n        item = arr2[len2];\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (lookup[item] === void 0) {\n            arr3.push(item);\n            lookup[item] = true;\n        }\n    }\n    return arr3;\n}\n/**\n * Decorator. (lazily) bind the method to the class instance on first call.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bound(target, key, descriptor) {\n    return {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get() {\n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            const boundFn = descriptor.value.bind(this);\n            Reflect.defineProperty(this, key, {\n                value: boundFn,\n                writable: true,\n                configurable: true,\n                enumerable: descriptor.enumerable,\n            });\n            return boundFn;\n        },\n    };\n}\nexport function mergeArrays(...arrays) {\n    const result = [];\n    let k = 0;\n    const arraysLen = arrays.length;\n    let arrayLen = 0;\n    let array;\n    for (let i = 0; i < arraysLen; ++i) {\n        array = arrays[i];\n        if (array !== void 0) {\n            arrayLen = array.length;\n            for (let j = 0; j < arrayLen; ++j) {\n                result[k++] = array[j];\n            }\n        }\n    }\n    return result;\n}\nexport function mergeObjects(...objects) {\n    const result = {};\n    const objectsLen = objects.length;\n    let object;\n    let key;\n    for (let i = 0; i < objectsLen; ++i) {\n        object = objects[i];\n        if (object !== void 0) {\n            for (key in object) {\n                result[key] = object[key];\n            }\n        }\n    }\n    return result;\n}\nexport function firstDefined(...values) {\n    const len = values.length;\n    let value;\n    for (let i = 0; i < len; ++i) {\n        value = values[i];\n        if (value !== void 0) {\n            return value;\n        }\n    }\n    throw new Error(`No default value found`);\n}\nexport const getPrototypeChain = (function () {\n    const functionPrototype = Function.prototype;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const getPrototypeOf = Object.getPrototypeOf;\n    const cache = new WeakMap();\n    let proto = functionPrototype;\n    let i = 0;\n    let chain = void 0;\n    return function (Type) {\n        chain = cache.get(Type);\n        if (chain === void 0) {\n            cache.set(Type, chain = [proto = Type]);\n            i = 0;\n            while ((proto = getPrototypeOf(proto)) !== functionPrototype) {\n                chain[++i] = proto;\n            }\n        }\n        return chain;\n    };\n})();\nexport function toLookup(...objs) {\n    return Object.assign(Object.create(null), ...objs);\n}\n/**\n * Determine whether a value is an object.\n *\n * Uses `typeof` to guarantee this works cross-realm, which is where `instanceof Object` might fail.\n *\n * Some environments where these issues are known to arise:\n * - same-origin iframes (accessing the other realm via `window.top`)\n * - `jest`.\n *\n * The exact test is:\n * ```ts\n * typeof value === 'object' && value !== null || typeof value === 'function'\n * ```\n *\n * @param value - The value to test.\n * @returns `true` if the value is an object, otherwise `false`.\n * Also performs a type assertion that defaults to `value is Object | Function` which, if the input type is a union with an object type, will infer the correct type.\n * This can be overridden with the generic type argument.\n *\n * @example\n *\n * ```ts\n * class Foo {\n *   bar = 42;\n * }\n *\n * function doStuff(input?: Foo | null) {\n *   input.bar; // Object is possibly 'null' or 'undefined'\n *\n *   // input has an object type in its union (Foo) so that type will be extracted for the 'true' condition\n *   if (isObject(input)) {\n *     input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n *\n * function doOtherStuff(input: unknown) {\n *   input.bar; // Object is of type 'unknown'\n *\n *   // input is 'unknown' so there is no union type to match and it will default to 'Object | Function'\n *   if (isObject(input)) {\n *     input.bar; // Property 'bar' does not exist on type 'Object | Function'\n *   }\n *\n *   // if we know for sure that, if input is an object, it must be a specific type, we can explicitly tell the function to assert that for us\n *   if (isObject<Foo>(input)) {\n *    input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n * ```\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isObject(value) {\n    return typeof value === 'object' && value !== null || typeof value === 'function';\n}\n/**\n * Determine whether a value is `null` or `undefined`.\n *\n * @param value - The value to test.\n * @returns `true` if the value is `null` or `undefined`, otherwise `false`.\n * Also performs a type assertion that ensures TypeScript treats the value appropriately in the `if` and `else` branches after this check.\n */\nexport function isNullOrUndefined(value) {\n    return value === null || value === void 0;\n}\n/**\n * Determine whether the value is a native function.\n *\n * @param fn - The function to check.\n * @returns `true` is the function is a native function, otherwise `false`\n */\nexport const isNativeFunction = (function () {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    const lookup = new WeakMap();\n    let isNative = false;\n    let sourceText = '';\n    let i = 0;\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (fn) {\n        isNative = lookup.get(fn);\n        if (isNative === void 0) {\n            sourceText = fn.toString();\n            i = sourceText.length;\n            // http://www.ecma-international.org/ecma-262/#prod-NativeFunction\n            isNative = (\n            // 29 is the length of 'function () { [native code] }' which is the smallest length of a native function string\n            i >= 29 &&\n                // 100 seems to be a safe upper bound of the max length of a native function. In Chrome and FF it's 56, in Edge it's 61.\n                i <= 100 &&\n                // This whole heuristic *could* be tricked by a comment. Do we need to care about that?\n                sourceText.charCodeAt(i - 1) === 0x7D && // }\n                // TODO: the spec is a little vague about the precise constraints, so we do need to test this across various browsers to make sure just one whitespace is a safe assumption.\n                sourceText.charCodeAt(i - 2) <= 0x20 && // whitespace\n                sourceText.charCodeAt(i - 3) === 0x5D && // ]\n                sourceText.charCodeAt(i - 4) === 0x65 && // e\n                sourceText.charCodeAt(i - 5) === 0x64 && // d\n                sourceText.charCodeAt(i - 6) === 0x6F && // o\n                sourceText.charCodeAt(i - 7) === 0x63 && // c\n                sourceText.charCodeAt(i - 8) === 0x20 && //\n                sourceText.charCodeAt(i - 9) === 0x65 && // e\n                sourceText.charCodeAt(i - 10) === 0x76 && // v\n                sourceText.charCodeAt(i - 11) === 0x69 && // i\n                sourceText.charCodeAt(i - 12) === 0x74 && // t\n                sourceText.charCodeAt(i - 13) === 0x61 && // a\n                sourceText.charCodeAt(i - 14) === 0x6E && // n\n                sourceText.charCodeAt(i - 15) === 0x58 // [\n            );\n            lookup.set(fn, isNative);\n        }\n        return isNative;\n    };\n})();\n//# sourceMappingURL=functions.js.map","import { isObject, isNullOrUndefined } from './functions';\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nconst metadataInternalSlot = new WeakMap();\nfunction $typeError(operation, args, paramName, actualValue, expectedType) {\n    return new TypeError(`${operation}(${args.map(String).join(',')}) - Expected '${paramName}' to be of type ${expectedType}, but got: ${Object.prototype.toString.call(actualValue)} (${String(actualValue)})`);\n}\nfunction toPropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction toPropertyKey(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction ensurePropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            throw new TypeError(`Invalid metadata propertyKey: ${propertyKey}.`);\n    }\n}\nfunction GetOrCreateMetadataMap(O, P, Create) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let targetMetadata be the value of O's [[Metadata]] internal slot.\n    let targetMetadata = metadataInternalSlot.get(O);\n    // 3. If targetMetadata is undefined, then\n    if (targetMetadata === void 0) {\n        // 3. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 3. b. Set targetMetadata to be a newly created Map object.\n        targetMetadata = new Map();\n        // 3. c. Set the [[Metadata]] internal slot of O to targetMetadata.\n        metadataInternalSlot.set(O, targetMetadata);\n    }\n    // 4. Let metadataMap be ? Invoke(targetMetadata, \"get\", P).\n    let metadataMap = targetMetadata.get(P);\n    // 5. If metadataMap is undefined, then\n    if (metadataMap === void 0) {\n        // 5. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 5. b. Set metadataMap to be a newly created Map object.\n        metadataMap = new Map();\n        // 5. c. Perform ? Invoke(targetMetadata, \"set\", P, metadataMap).\n        targetMetadata.set(P, metadataMap);\n    }\n    // 6. Return metadataMap.\n    return metadataMap;\n}\n// 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\nfunction OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? ToBoolean(? Invoke(metadataMap, \"has\", MetadataKey)).\n    return metadataMap.has(MetadataKey);\n}\n// 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\nfunction OrdinaryHasMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return true.\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return true;\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, Return ? parent.[[HasMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryHasMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return false.\n    return false;\n}\n// 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\nfunction OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return undefined.\n    if (metadataMap === void 0) {\n        return void 0;\n    }\n    // 4. Return ? Invoke(metadataMap, \"get\", MetadataKey).\n    return metadataMap.get(MetadataKey);\n}\n// 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\nfunction OrdinaryGetMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return ? OrdinaryGetOwnMetadata(MetadataKey, O, P).\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, return ? parent.[[GetMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryGetMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return undefined.\n    return void 0;\n}\n// 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\nfunction OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, true).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ true);\n    // 3. Return ? Invoke(metadataMap, \"set\", MetadataKey, MetadataValue).\n    metadataMap.set(MetadataKey, MetadataValue);\n}\n// 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\nfunction OrdinaryOwnMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 3. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 4. If metadataMap is undefined, return keys.\n    if (metadataMap === void 0) {\n        return keys;\n    }\n    // 5. Let keysObj be ? Invoke(metadataMap, \"keys\").\n    const keysObj = metadataMap.keys();\n    // 6. Let iterator be ? GetIterator(keysObj).\n    // 7. Let k be 0.\n    let k = 0;\n    // 8. Repeat\n    for (const key of keysObj) {\n        // 8. a. Let Pk be ! ToString(k).\n        // 8. b. Let next be ? IteratorStep(iterator).\n        // 8. c. If next is false, then\n        // 8. c. i. Let setStatus be ? Set(keys, \"length\", k, true).\n        // 8. c. ii. Assert: setStatus is true.\n        // 8. c. iii. Return keys.\n        // 8. d. Let nextValue be ? IteratorValue(next).\n        // 8. e. Let defineStatus be CreateDataPropertyOrThrow(keys, Pk, nextValue).\n        keys[k] = key;\n        // 8. f. If defineStatus is an abrupt completion, return ? IteratorClose(iterator, defineStatus).\n        // 8. g. Increase k by 1.\n        ++k;\n    }\n    return keys;\n}\n// 3.1.6.1 OrdinaryMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\nfunction OrdinaryMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let ownKeys be ? OrdinaryOwnMetadataKeys(O, P).\n    const ownKeys = OrdinaryOwnMetadataKeys(O, P);\n    // 3. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 4. If parent is null, then return ownKeys.\n    if (parent === null) {\n        return ownKeys;\n    }\n    // 5. Let parentKeys be ? O.[[OrdinaryMetadataKeys]](P).\n    const parentKeys = OrdinaryMetadataKeys(parent, P);\n    // 6. Let ownKeysLen = ? Get(ownKeys, \"length\").\n    const ownKeysLen = ownKeys.length;\n    // 7. If ownKeysLen is 0, return parentKeys.\n    if (ownKeysLen === 0) {\n        return parentKeys;\n    }\n    // 8. Let parentKeysLen = ? Get(parentKeys, \"length\").\n    const parentKeysLen = parentKeys.length;\n    // 9. If parentKeysLen is 0, return ownKeys.\n    if (parentKeysLen === 0) {\n        return ownKeys;\n    }\n    // 10. Let set be a newly created Set object.\n    const set = new Set();\n    // 11. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 12. Let k be 0.\n    let k = 0;\n    // 13. For each element key of ownKeys\n    let key;\n    for (let i = 0; i < ownKeysLen; ++i) {\n        key = ownKeys[i];\n        // 13. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 13. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 13. b. i. Let Pk be ! ToString(k).\n            // 13. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 13. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 13. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 13. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 14. For each element key of parentKeys\n    for (let i = 0; i < parentKeysLen; ++i) {\n        key = parentKeys[i];\n        // 14. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 14. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 14. b. i. Let Pk be ! ToString(k).\n            // 14. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 14. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 14. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 14. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 15. Perform ? Set(keys, \"length\", k).\n    // 16. return keys.\n    return keys;\n}\n// 3.1.8 DeleteMetadata(MetadataKey, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots-deletemetadata\nfunction OrdinaryDeleteMetadata(O, MetadataKey, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? Invoke(metadataMap, \"delete\", MetadataKey).\n    return metadataMap.delete(MetadataKey);\n}\n// 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n// https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n/**\n * A default metadata decorator factory that can be used on a class, class member, or parameter.\n *\n * @param metadataKey - The key for the metadata entry.\n * If `metadataKey` is already defined for the target and target key, the\n * metadataValue for that key will be overwritten.\n * @param metadataValue - The value for the metadata entry.\n * @returns A decorator function.\n */\nfunction metadata(metadataKey, metadataValue) {\n    function decorator(target, propertyKey) {\n        // 1. Assert: F has a [[MetadataKey]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 2. Assert: F has a [[MetadataValue]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 3. If Type(target) is not Object, throw a TypeError exception.\n        if (!isObject(target)) {\n            throw $typeError('@metadata', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n        }\n        // 4. If key is not undefined and IsPropertyKey(key) is false, throw a TypeError exception.\n        // 5. Let metadataKey be the value of F's [[MetadataKey]] internal slot.\n        // 6. Let metadataValue be the value of F's [[MetadataValue]] internal slot.\n        // 7. Perform ? target.[[DefineMetadata]](metadataKey, metadataValue, target, key).\n        OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, ensurePropertyKeyOrUndefined(propertyKey));\n        // 8. Return undefined.\n    }\n    return decorator;\n}\nfunction decorate(decorators, target, propertyKey, attributes) {\n    if (propertyKey !== void 0) {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (!isObject(target)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Object or Function');\n        }\n        if (!isObject(attributes) && !isNullOrUndefined(attributes)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'attributes', attributes, 'Object, Function, null, or undefined');\n        }\n        if (attributes === null) {\n            attributes = void 0;\n        }\n        propertyKey = toPropertyKey(propertyKey);\n        return DecorateProperty(decorators, target, propertyKey, attributes);\n    }\n    else {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (typeof target !== 'function') {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Function');\n        }\n        return DecorateConstructor(decorators, target);\n    }\n}\nfunction DecorateConstructor(decorators, target) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target);\n        if (!isNullOrUndefined(decorated)) {\n            if (typeof decorated !== 'function') {\n                throw $typeError('DecorateConstructor', [decorators, target], 'decorated', decorated, 'Function, null, or undefined');\n            }\n            target = decorated;\n        }\n    }\n    return target;\n}\nfunction DecorateProperty(decorators, target, propertyKey, descriptor) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target, propertyKey, descriptor);\n        if (!isNullOrUndefined(decorated)) {\n            if (!isObject(decorated)) {\n                throw $typeError('DecorateProperty', [decorators, target, propertyKey, descriptor], 'decorated', decorated, 'Object, Function, null, or undefined');\n            }\n            descriptor = decorated;\n        }\n    }\n    return descriptor;\n}\nfunction $define(metadataKey, metadataValue, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.define', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DefineMetadata]](metadataKey, metadataValue, propertyKey).\n    return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $has(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.has', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasMetadata]](metadataKey, propertyKey).\n    return OrdinaryHasMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $hasOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.hasOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasOwn]](metadataKey, propertyKey).\n    return OrdinaryHasOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $get(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.get', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadataKeys]](propertyKey).\n    return OrdinaryMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwnKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwnKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadataKeys]](propertyKey).\n    return OrdinaryOwnMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $delete(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.delete', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DeleteMetadata]](metadataKey, propertyKey).\n    return OrdinaryDeleteMetadata(target, metadataKey, toPropertyKeyOrUndefined(propertyKey));\n}\nconst Metadata = {\n    define: $define,\n    has: $has,\n    hasOwn: $hasOwn,\n    get: $get,\n    getOwn: $getOwn,\n    getKeys: $getKeys,\n    getOwnKeys: $getOwnKeys,\n    delete: $delete,\n};\nfunction def(obj, key, value) {\n    Reflect.defineProperty(obj, key, {\n        writable: true,\n        enumerable: false,\n        configurable: true,\n        value,\n    });\n}\ndef(Metadata, '$Internal', metadataInternalSlot);\nconst hasMetadata = 'metadata' in Reflect;\nconst hasDecorate = 'decorate' in Reflect;\nconst hasDefineMetadata = 'defineMetadata' in Reflect;\nconst hasHasMetadata = 'hasMetadata' in Reflect;\nconst hasHasOwnMetadata = 'hasOwnMetadata' in Reflect;\nconst hasGetMetadata = 'getMetadata' in Reflect;\nconst hasGetOwnMetadata = 'getOwnMetadata' in Reflect;\nconst hasGetMetadataKeys = 'getMetadataKeys' in Reflect;\nconst hasGetOwnMetadataKeys = 'getOwnMetadataKeys' in Reflect;\nconst hasDeleteMetadata = 'deleteMetadata' in Reflect;\nconst hasSome = (hasMetadata ||\n    hasDecorate ||\n    hasDefineMetadata ||\n    hasHasMetadata ||\n    hasHasOwnMetadata ||\n    hasGetMetadata ||\n    hasGetOwnMetadata ||\n    hasGetMetadataKeys ||\n    hasGetOwnMetadataKeys ||\n    hasDeleteMetadata);\nconst hasAll = (hasMetadata &&\n    hasDecorate &&\n    hasDefineMetadata &&\n    hasHasMetadata &&\n    hasHasOwnMetadata &&\n    hasGetMetadata &&\n    hasGetOwnMetadata &&\n    hasGetMetadataKeys &&\n    hasGetOwnMetadataKeys &&\n    hasDeleteMetadata);\nif (hasSome && !hasAll) {\n    // This is temporary until we have the reporter / logging component working properly.\n    // We should kind of throw here, but it's a bit harsh to completely stop Aurelia from loading for something that's not guaranteed to fail,\n    // so just log a warning instead.\n    /* eslint-disable no-console, no-undef, @typescript-eslint/ban-ts-ignore */\n    // @ts-ignore\n    console.warn('Partial existing Reflect.metadata polyfill found. Working environment cannot be guaranteed. Please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario.');\n}\nif (!hasMetadata) {\n    def(Reflect, 'metadata', metadata);\n}\nif (!hasDecorate) {\n    def(Reflect, 'decorate', decorate);\n}\nif (!hasDefineMetadata) {\n    def(Reflect, 'defineMetadata', $define);\n}\nif (!hasHasMetadata) {\n    def(Reflect, 'hasMetadata', $has);\n}\nif (!hasHasOwnMetadata) {\n    def(Reflect, 'hasOwnMetadata', $hasOwn);\n}\nif (!hasGetMetadata) {\n    def(Reflect, 'getMetadata', $get);\n}\nif (!hasGetOwnMetadata) {\n    def(Reflect, 'getOwnMetadata', $getOwn);\n}\nif (!hasGetMetadataKeys) {\n    def(Reflect, 'getMetadataKeys', $getKeys);\n}\nif (!hasGetOwnMetadataKeys) {\n    def(Reflect, 'getOwnMetadataKeys', $getOwnKeys);\n}\nif (!hasDeleteMetadata) {\n    def(Reflect, 'deleteMetadata', $delete);\n}\nexport { Metadata, metadata };\n//# sourceMappingURL=metadata.js.map","import { Metadata } from './metadata';\nimport { PLATFORM } from './platform';\nconst annotation = {\n    name: 'au:annotation',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    set(target, prop, value) {\n        Metadata.define(annotation.keyFor(prop), value, target);\n    },\n    get(target, prop) {\n        return Metadata.getOwn(annotation.keyFor(prop), target);\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(annotation.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${annotation.name}:${name}`;\n        }\n        return `${annotation.name}:${name}:${context}`;\n    },\n};\nconst resource = {\n    name: 'au:resource',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    has(target) {\n        return Metadata.hasOwn(resource.name, target);\n    },\n    getAll(target) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            return PLATFORM.emptyArray;\n        }\n        else {\n            return keys.map(k => Metadata.getOwn(k, target));\n        }\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(resource.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${resource.name}:${name}`;\n        }\n        return `${resource.name}:${name}:${context}`;\n    },\n};\nexport const Protocol = {\n    annotation,\n    resource,\n};\n// eslint-disable-next-line @typescript-eslint/unbound-method\nconst hasOwn = Object.prototype.hasOwnProperty;\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override the definition as well as static properties on the type.\n * 2. Definition properties (usually set by the customElement decorator object literal) come next. They override static properties on the type.\n * 3. Static properties on the type come last. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 4. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrDefinitionOrTypeOrDefault(name, def, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = def[name];\n        if (value === void 0) {\n            value = Type[name];\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n            if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n                return getDefault();\n            }\n            return value;\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override static properties on the type.\n * 2. Static properties on the typ. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 3. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrTypeOrDefault(name, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = Type[name];\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n            return getDefault();\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Definition properties.\n * 2. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromDefinitionOrDefault(name, def, getDefault) {\n    const value = def[name];\n    if (value === void 0) {\n        return getDefault();\n    }\n    return value;\n}\n//# sourceMappingURL=resource.js.map","import { PLATFORM } from './platform';\nimport { Reporter } from './reporter';\nimport { Protocol } from './resource';\nimport { Metadata } from './metadata';\nimport { isArrayIndex, isNativeFunction, isObject } from './functions';\nexport class ResolverBuilder {\n    constructor(container, key) {\n        this.container = container;\n        this.key = key;\n    }\n    instance(value) {\n        return this.registerResolver(0 /* instance */, value);\n    }\n    singleton(value) {\n        return this.registerResolver(1 /* singleton */, value);\n    }\n    transient(value) {\n        return this.registerResolver(2 /* transient */, value);\n    }\n    callback(value) {\n        return this.registerResolver(3 /* callback */, value);\n    }\n    aliasTo(destinationKey) {\n        return this.registerResolver(5 /* alias */, destinationKey);\n    }\n    registerResolver(strategy, state) {\n        const { container, key } = this;\n        this.container = this.key = (void 0);\n        return container.registerResolver(key, new Resolver(key, strategy, state));\n    }\n}\nfunction cloneArrayWithPossibleProps(source) {\n    const clone = source.slice();\n    const keys = Object.keys(source);\n    const len = keys.length;\n    let key;\n    for (let i = 0; i < len; ++i) {\n        key = keys[i];\n        if (!isArrayIndex(key)) {\n            clone[key] = source[key];\n        }\n    }\n    return clone;\n}\nexport const DI = {\n    createContainer(...params) {\n        if (params.length === 0) {\n            return new Container(null);\n        }\n        else {\n            return new Container(null).register(...params);\n        }\n    },\n    getDesignParamtypes(Type) {\n        return Metadata.getOwn('design:paramtypes', Type);\n    },\n    getAnnotationParamtypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        return Metadata.getOwn(key, Type);\n    },\n    getOrCreateAnnotationParamTypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        let annotationParamtypes = Metadata.getOwn(key, Type);\n        if (annotationParamtypes === void 0) {\n            Metadata.define(key, annotationParamtypes = [], Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return annotationParamtypes;\n    },\n    getDependencies(Type) {\n        // Note: Every detail of this getDependencies method is pretty deliberate at the moment, and probably not yet 100% tested from every possible angle,\n        // so be careful with making changes here as it can have a huge impact on complex end user apps.\n        // Preferably, only make changes to the dependency resolution process via a RFC.\n        const key = Protocol.annotation.keyFor('di:dependencies');\n        let dependencies = Metadata.getOwn(key, Type);\n        if (dependencies === void 0) {\n            // Type.length is the number of constructor parameters. If this is 0, it could mean the class has an empty constructor\n            // but it could also mean the class has no constructor at all (in which case it inherits the constructor from the prototype).\n            // Non-zero constructor length + no paramtypes means emitDecoratorMetadata is off, or the class has no decorator.\n            // We're not doing anything with the above right now, but it's good to keep in mind for any future issues.\n            const inject = Type.inject;\n            if (inject === void 0) {\n                // design:paramtypes is set by tsc when emitDecoratorMetadata is enabled.\n                const designParamtypes = DI.getDesignParamtypes(Type);\n                // au:annotation:di:paramtypes is set by the parameter decorator from DI.createInterface or by @inject\n                const annotationParamtypes = DI.getAnnotationParamtypes(Type);\n                if (designParamtypes === void 0) {\n                    if (annotationParamtypes === void 0) {\n                        // Only go up the prototype if neither static inject nor any of the paramtypes is defined, as\n                        // there is no sound way to merge a type's deps with its prototype's deps\n                        const Proto = Object.getPrototypeOf(Type);\n                        if (typeof Proto === 'function' && Proto !== Function.prototype) {\n                            dependencies = cloneArrayWithPossibleProps(DI.getDependencies(Proto));\n                        }\n                        else {\n                            dependencies = [];\n                        }\n                    }\n                    else {\n                        // No design:paramtypes so just use the au:annotation:di:paramtypes\n                        dependencies = cloneArrayWithPossibleProps(annotationParamtypes);\n                    }\n                }\n                else if (annotationParamtypes === void 0) {\n                    // No au:annotation:di:paramtypes so just use the design:paramtypes\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                }\n                else {\n                    // We've got both, so merge them (in case of conflict on same index, au:annotation:di:paramtypes take precedence)\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                    let len = annotationParamtypes.length;\n                    let auAnnotationParamtype;\n                    for (let i = 0; i < len; ++i) {\n                        auAnnotationParamtype = annotationParamtypes[i];\n                        if (auAnnotationParamtype !== void 0) {\n                            dependencies[i] = auAnnotationParamtype;\n                        }\n                    }\n                    const keys = Object.keys(annotationParamtypes);\n                    len = keys.length;\n                    let key;\n                    for (let i = 0; i < len; ++i) {\n                        key = keys[i];\n                        if (!isArrayIndex(key)) {\n                            dependencies[key] = annotationParamtypes[key];\n                        }\n                    }\n                }\n            }\n            else {\n                // Ignore paramtypes if we have static inject\n                dependencies = cloneArrayWithPossibleProps(inject);\n            }\n            Metadata.define(key, dependencies, Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return dependencies;\n    },\n    createInterface(friendlyName) {\n        const Interface = function (target, property, index) {\n            if (target == null) {\n                throw Reporter.error(16, Interface.friendlyName, Interface); // TODO: add error (trying to resolve an InterfaceSymbol that has no registrations)\n            }\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = Interface;\n            return target;\n        };\n        Interface.friendlyName = friendlyName == null ? 'Interface' : friendlyName;\n        Interface.noDefault = function () {\n            return Interface;\n        };\n        Interface.withDefault = function (configure) {\n            Interface.withDefault = function () {\n                throw Reporter.error(17, Interface);\n            };\n            Interface.register = function (container, key) {\n                return configure(new ResolverBuilder(container, (key !== null && key !== void 0 ? key : Interface)));\n            };\n            return Interface;\n        };\n        return Interface;\n    },\n    inject(...dependencies) {\n        return function (target, key, descriptor) {\n            if (typeof descriptor === 'number') { // It's a parameter decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[descriptor] = dep;\n                }\n            }\n            else if (key) { // It's a property decorator. Not supported by the container without plugins.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target.constructor);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[key] = dep;\n                }\n            }\n            else if (descriptor) { // It's a function decorator (not a Class constructor)\n                const fn = descriptor.value;\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(fn);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n            else { // It's a class decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n        };\n    },\n    /**\n     * Registers the `target` class as a transient dependency; each time the dependency is resolved\n     * a new instance will be created.\n     *\n     * @param target - The class / constructor function to register as transient.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     *\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.transient(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.transient(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    transient(target) {\n        target.register = function register(container) {\n            const registration = Registration.transient(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    },\n    /**\n     * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n     * consecutive time the dependency is resolved, the same instance will be returned.\n     *\n     * @param target - The class / constructor function to register as a singleton.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.singleton(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.singleton(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    singleton(target) {\n        target.register = function register(container) {\n            const registration = Registration.singleton(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    },\n};\nexport const IContainer = DI.createInterface('IContainer').noDefault();\nexport const IServiceLocator = IContainer;\nfunction createResolver(getter) {\n    return function (key) {\n        const resolver = function (target, property, descriptor) {\n            DI.inject(resolver)(target, property, descriptor);\n        };\n        resolver.resolve = function (handler, requestor) {\n            return getter(key, handler, requestor);\n        };\n        return resolver;\n    };\n}\nexport const inject = DI.inject;\nfunction transientDecorator(target) {\n    return DI.transient(target);\n}\nexport function transient(target) {\n    return target == null ? transientDecorator : transientDecorator(target);\n}\nfunction singletonDecorator(target) {\n    return DI.singleton(target);\n}\nexport function singleton(target) {\n    return target == null ? singletonDecorator : singletonDecorator(target);\n}\nexport const all = createResolver((key, handler, requestor) => requestor.getAll(key));\nexport const lazy = createResolver((key, handler, requestor) => {\n    let instance = null; // cache locally so that lazy always returns the same instance once resolved\n    return () => {\n        if (instance == null) {\n            instance = requestor.get(key);\n        }\n        return instance;\n    };\n});\nexport const optional = createResolver((key, handler, requestor) => {\n    if (requestor.has(key, true)) {\n        return requestor.get(key);\n    }\n    else {\n        return null;\n    }\n});\n/** @internal */\nexport var ResolverStrategy;\n(function (ResolverStrategy) {\n    ResolverStrategy[ResolverStrategy[\"instance\"] = 0] = \"instance\";\n    ResolverStrategy[ResolverStrategy[\"singleton\"] = 1] = \"singleton\";\n    ResolverStrategy[ResolverStrategy[\"transient\"] = 2] = \"transient\";\n    ResolverStrategy[ResolverStrategy[\"callback\"] = 3] = \"callback\";\n    ResolverStrategy[ResolverStrategy[\"array\"] = 4] = \"array\";\n    ResolverStrategy[ResolverStrategy[\"alias\"] = 5] = \"alias\";\n})(ResolverStrategy || (ResolverStrategy = {}));\n/** @internal */\nexport class Resolver {\n    constructor(key, strategy, state) {\n        this.key = key;\n        this.strategy = strategy;\n        this.state = state;\n    }\n    register(container, key) {\n        return container.registerResolver(key || this.key, this);\n    }\n    resolve(handler, requestor) {\n        switch (this.strategy) {\n            case 0 /* instance */:\n                return this.state;\n            case 1 /* singleton */: {\n                this.strategy = 0 /* instance */;\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return this.state = factory.construct(requestor);\n            }\n            case 2 /* transient */: {\n                // Always create transients from the requesting container\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return factory.construct(requestor);\n            }\n            case 3 /* callback */:\n                return this.state(handler, requestor, this);\n            case 4 /* array */:\n                return this.state[0].resolve(handler, requestor);\n            case 5 /* alias */:\n                return handler.get(this.state);\n            default:\n                throw Reporter.error(6, this.strategy);\n        }\n    }\n    getFactory(container) {\n        let resolver;\n        switch (this.strategy) {\n            case 1 /* singleton */:\n            case 2 /* transient */:\n                return container.getFactory(this.state);\n            case 5 /* alias */:\n                resolver = container.getResolver(this.state);\n                if (resolver == null || resolver.getFactory === void 0) {\n                    return null;\n                }\n                return resolver.getFactory(container);\n            default:\n                return null;\n        }\n    }\n}\n/** @internal */\nexport class Factory {\n    constructor(Type, invoker, dependencies) {\n        this.Type = Type;\n        this.invoker = invoker;\n        this.dependencies = dependencies;\n        this.transformers = null;\n    }\n    construct(container, dynamicDependencies) {\n        const transformers = this.transformers;\n        let instance = dynamicDependencies !== void 0\n            ? this.invoker.invokeWithDynamicDependencies(container, this.Type, this.dependencies, dynamicDependencies)\n            : this.invoker.invoke(container, this.Type, this.dependencies);\n        if (transformers == null) {\n            return instance;\n        }\n        for (let i = 0, ii = transformers.length; i < ii; ++i) {\n            instance = transformers[i](instance);\n        }\n        return instance;\n    }\n    registerTransformer(transformer) {\n        if (this.transformers == null) {\n            this.transformers = [];\n        }\n        this.transformers.push(transformer);\n        return true;\n    }\n}\nconst createFactory = (function () {\n    function invokeWithDynamicDependencies(container, Type, staticDependencies, dynamicDependencies) {\n        let i = staticDependencies.length;\n        let args = new Array(i);\n        let lookup;\n        while (i-- > 0) {\n            lookup = staticDependencies[i];\n            if (lookup == null) {\n                throw Reporter.error(7, `Index ${i}.`);\n            }\n            else {\n                args[i] = container.get(lookup);\n            }\n        }\n        if (dynamicDependencies !== void 0) {\n            args = args.concat(dynamicDependencies);\n        }\n        return Reflect.construct(Type, args);\n    }\n    const classInvokers = [\n        {\n            invoke(container, Type) {\n                return new Type();\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));\n            },\n            invokeWithDynamicDependencies\n        }\n    ];\n    const fallbackInvoker = {\n        invoke: invokeWithDynamicDependencies,\n        invokeWithDynamicDependencies\n    };\n    return function (Type) {\n        if (isNativeFunction(Type)) {\n            Reporter.write(5, Type.name);\n        }\n        const dependencies = DI.getDependencies(Type);\n        const invoker = classInvokers.length > dependencies.length ? classInvokers[dependencies.length] : fallbackInvoker;\n        return new Factory(Type, invoker, dependencies);\n    };\n})();\nconst containerResolver = {\n    resolve(handler, requestor) {\n        return requestor;\n    }\n};\nfunction isRegistry(obj) {\n    return typeof obj.register === 'function';\n}\nfunction isClass(obj) {\n    return obj.prototype !== void 0;\n}\nfunction isResourceKey(key) {\n    return typeof key === 'string' && key.indexOf(':') > 0;\n}\n/** @internal */\nexport class Container {\n    constructor(parent) {\n        this.parent = parent;\n        this.registerDepth = 0;\n        if (parent === null) {\n            this.root = this;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.create(null);\n        }\n        else {\n            this.root = parent.root;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.assign(Object.create(null), this.root.resourceResolvers);\n        }\n        this.resolvers.set(IContainer, containerResolver);\n    }\n    register(...params) {\n        if (++this.registerDepth === 100) {\n            throw new Error('Unable to autoregister dependency');\n            // TODO: change to reporter.error and add various possible causes in description.\n            // Most likely cause is trying to register a plain object that does not have a\n            // register method and is not a class constructor\n        }\n        let current;\n        let keys;\n        let value;\n        let j;\n        let jj;\n        for (let i = 0, ii = params.length; i < ii; ++i) {\n            current = params[i];\n            if (!isObject(current)) {\n                continue;\n            }\n            if (isRegistry(current)) {\n                current.register(this);\n            }\n            else if (Protocol.resource.has(current)) {\n                const defs = Protocol.resource.getAll(current);\n                if (defs.length === 1) {\n                    // Fast path for the very common case\n                    defs[0].register(this);\n                }\n                else {\n                    const len = defs.length;\n                    for (let d = 0; d < len; ++d) {\n                        defs[d].register(this);\n                    }\n                }\n            }\n            else if (isClass(current)) {\n                Registration.singleton(current, current).register(this);\n            }\n            else {\n                keys = Object.keys(current);\n                j = 0;\n                jj = keys.length;\n                for (; j < jj; ++j) {\n                    value = current[keys[j]];\n                    if (!isObject(value)) {\n                        continue;\n                    }\n                    // note: we could remove this if-branch and call this.register directly\n                    // - the extra check is just a perf tweak to create fewer unnecessary arrays by the spread operator\n                    if (isRegistry(value)) {\n                        value.register(this);\n                    }\n                    else {\n                        this.register(value);\n                    }\n                }\n            }\n        }\n        --this.registerDepth;\n        return this;\n    }\n    registerResolver(key, resolver) {\n        validateKey(key);\n        const resolvers = this.resolvers;\n        const result = resolvers.get(key);\n        if (result == null) {\n            resolvers.set(key, resolver);\n            if (isResourceKey(key)) {\n                this.resourceResolvers[key] = resolver;\n            }\n        }\n        else if (result instanceof Resolver && result.strategy === 4 /* array */) {\n            result.state.push(resolver);\n        }\n        else {\n            resolvers.set(key, new Resolver(key, 4 /* array */, [result, resolver]));\n        }\n        return resolver;\n    }\n    registerTransformer(key, transformer) {\n        const resolver = this.getResolver(key);\n        if (resolver == null) {\n            return false;\n        }\n        if (resolver.getFactory) {\n            const factory = resolver.getFactory(this);\n            if (factory == null) {\n                return false;\n            }\n            // This type cast is a bit of a hacky one, necessary due to the duplicity of IResolverLike.\n            // Problem is that that interface's type arg can be of type Key, but the getFactory method only works on\n            // type Constructable. So the return type of that optional method has this additional constraint, which\n            // seems to confuse the type checker.\n            return factory.registerTransformer(transformer);\n        }\n        return false;\n    }\n    getResolver(key, autoRegister = true) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key;\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    return autoRegister ? this.jitRegister(key, current) : null;\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver;\n            }\n        }\n        return null;\n    }\n    has(key, searchAncestors = false) {\n        return this.resolvers.has(key)\n            ? true\n            : searchAncestors && this.parent != null\n                ? this.parent.has(key, true)\n                : false;\n    }\n    get(key) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key.resolve(this, this);\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    resolver = this.jitRegister(key, current);\n                    return resolver.resolve(current, this);\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver.resolve(current, this);\n            }\n        }\n        throw new Error(`Unable to resolve key: ${key}`);\n    }\n    getAll(key) {\n        validateKey(key);\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (this.parent == null) {\n                    return PLATFORM.emptyArray;\n                }\n                current = current.parent;\n            }\n            else {\n                return buildAllResponse(resolver, current, this);\n            }\n        }\n        return PLATFORM.emptyArray;\n    }\n    getFactory(Type) {\n        const key = Protocol.annotation.keyFor('di:factory');\n        let factory = Metadata.getOwn(key, Type);\n        if (factory === void 0) {\n            Metadata.define(key, factory = createFactory(Type), Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return factory;\n    }\n    createChild() {\n        return new Container(this);\n    }\n    jitRegister(keyAsValue, handler) {\n        if (typeof keyAsValue !== 'function') {\n            throw new Error(`Attempted to jitRegister something that is not a constructor: '${keyAsValue}'. Did you forget to register this resource?`);\n        }\n        if (isRegistry(keyAsValue)) {\n            const registrationResolver = keyAsValue.register(handler, keyAsValue);\n            if (!(registrationResolver instanceof Object) || registrationResolver.resolve == null) {\n                const newResolver = handler.resolvers.get(keyAsValue);\n                if (newResolver != void 0) {\n                    return newResolver;\n                }\n                throw Reporter.error(40); // did not return a valid resolver from the static register method\n            }\n            return registrationResolver;\n        }\n        else if (Protocol.resource.has(keyAsValue)) {\n            const defs = Protocol.resource.getAll(keyAsValue);\n            if (defs.length === 1) {\n                // Fast path for the very common case\n                defs[0].register(handler);\n            }\n            else {\n                const len = defs.length;\n                for (let d = 0; d < len; ++d) {\n                    defs[d].register(handler);\n                }\n            }\n            const newResolver = handler.resolvers.get(keyAsValue);\n            if (newResolver != void 0) {\n                return newResolver;\n            }\n            throw Reporter.error(40); // did not return a valid resolver from the static register method\n        }\n        else {\n            const resolver = new Resolver(keyAsValue, 1 /* singleton */, keyAsValue);\n            handler.resolvers.set(keyAsValue, resolver);\n            return resolver;\n        }\n    }\n}\n/**\n * An implementation of IRegistry that delegates registration to a\n * separately registered class. The ParameterizedRegistry facilitates the\n * passing of parameters to the final registry.\n */\nexport class ParameterizedRegistry {\n    constructor(key, params) {\n        this.key = key;\n        this.params = params;\n    }\n    register(container) {\n        if (container.has(this.key, true)) {\n            const registry = container.get(this.key);\n            registry.register(container, ...this.params);\n        }\n        else {\n            container.register(...this.params.filter(x => typeof x === 'object'));\n        }\n    }\n}\nexport const Registration = {\n    instance(key, value) {\n        return new Resolver(key, 0 /* instance */, value);\n    },\n    singleton(key, value) {\n        return new Resolver(key, 1 /* singleton */, value);\n    },\n    transient(key, value) {\n        return new Resolver(key, 2 /* transient */, value);\n    },\n    callback(key, callback) {\n        return new Resolver(key, 3 /* callback */, callback);\n    },\n    alias(originalKey, aliasKey) {\n        return new Resolver(aliasKey, 5 /* alias */, originalKey);\n    },\n    defer(key, ...params) {\n        return new ParameterizedRegistry(key, params);\n    }\n};\nexport class InstanceProvider {\n    constructor() {\n        this.instance = null;\n    }\n    prepare(instance) {\n        this.instance = instance;\n    }\n    resolve(handler, requestor) {\n        if (this.instance === undefined) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        return this.instance;\n    }\n    dispose() {\n        this.instance = null;\n    }\n}\n/** @internal */\nexport function validateKey(key) {\n    if (key === null || key === void 0) {\n        throw Reporter.error(5);\n    }\n}\nfunction buildAllResponse(resolver, handler, requestor) {\n    if (resolver instanceof Resolver && resolver.strategy === 4 /* array */) {\n        const state = resolver.state;\n        let i = state.length;\n        const results = new Array(i);\n        while (i--) {\n            results[i] = state[i].resolve(handler, requestor);\n        }\n        return results;\n    }\n    return [resolver.resolve(handler, requestor)];\n}\n//# sourceMappingURL=di.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { toLookup } from './functions';\nimport { DI, all, Registration } from './di';\n/**\n * Flags to enable/disable color usage in the logging output.\n */\nexport var ColorOptions;\n(function (ColorOptions) {\n    /**\n     * Do not use ASCII color codes in logging output.\n     */\n    ColorOptions[ColorOptions[\"noColors\"] = 0] = \"noColors\";\n    /**\n     * Use ASCII color codes in logging output. By default, timestamps and the TRC and DBG prefix are colored grey. INF white, WRN yellow, and ERR and FTL red.\n     */\n    ColorOptions[ColorOptions[\"colors\"] = 1] = \"colors\";\n})(ColorOptions || (ColorOptions = {}));\nexport const ILogConfig = DI.createInterface('ILogConfig').withDefault(x => x.instance(new LogConfig(0 /* noColors */, 3 /* warn */)));\nexport const ISink = DI.createInterface('ISink').noDefault();\nexport const ILogEventFactory = DI.createInterface('ILogEventFactory').withDefault(x => x.singleton(DefaultLogEventFactory));\nexport const ILogger = DI.createInterface('ILogger').withDefault(x => x.singleton(DefaultLogger));\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\nexport const format = toLookup({\n    red(str) {\n        return `\\u001b[31m${str}\\u001b[39m`;\n    },\n    green(str) {\n        return `\\u001b[32m${str}\\u001b[39m`;\n    },\n    yellow(str) {\n        return `\\u001b[33m${str}\\u001b[39m`;\n    },\n    blue(str) {\n        return `\\u001b[34m${str}\\u001b[39m`;\n    },\n    magenta(str) {\n        return `\\u001b[35m${str}\\u001b[39m`;\n    },\n    cyan(str) {\n        return `\\u001b[36m${str}\\u001b[39m`;\n    },\n    white(str) {\n        return `\\u001b[37m${str}\\u001b[39m`;\n    },\n    grey(str) {\n        return `\\u001b[90m${str}\\u001b[39m`;\n    },\n});\nexport class LogConfig {\n    constructor(colorOptions, level) {\n        this.colorOptions = colorOptions;\n        this.level = level;\n    }\n}\nconst getLogLevelString = (function () {\n    const logLevelString = [\n        toLookup({\n            TRC: 'TRC',\n            DBG: 'DBG',\n            INF: 'INF',\n            WRN: 'WRN',\n            ERR: 'ERR',\n            FTL: 'FTL',\n            QQQ: '???',\n        }),\n        toLookup({\n            TRC: format.grey('TRC'),\n            DBG: format.grey('DBG'),\n            INF: format.white('INF'),\n            WRN: format.yellow('WRN'),\n            ERR: format.red('ERR'),\n            FTL: format.red('FTL'),\n            QQQ: format.grey('???'),\n        }),\n    ];\n    return function (level, colorOptions) {\n        if (level <= 0 /* trace */) {\n            return logLevelString[colorOptions].TRC;\n        }\n        if (level <= 1 /* debug */) {\n            return logLevelString[colorOptions].DBG;\n        }\n        if (level <= 2 /* info */) {\n            return logLevelString[colorOptions].INF;\n        }\n        if (level <= 3 /* warn */) {\n            return logLevelString[colorOptions].WRN;\n        }\n        if (level <= 4 /* error */) {\n            return logLevelString[colorOptions].ERR;\n        }\n        if (level <= 5 /* fatal */) {\n            return logLevelString[colorOptions].FTL;\n        }\n        return logLevelString[colorOptions].QQQ;\n    };\n})();\nfunction getScopeString(scope, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return scope.join('.');\n    }\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    return scope.map(format.cyan).join('.');\n}\nfunction getIsoString(timestamp, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return new Date(timestamp).toISOString();\n    }\n    return format.grey(new Date(timestamp).toISOString());\n}\nexport class DefaultLogEvent {\n    constructor(severity, message, optionalParams, scope, colorOptions, timestamp) {\n        this.severity = severity;\n        this.message = message;\n        this.optionalParams = optionalParams;\n        this.scope = scope;\n        this.colorOptions = colorOptions;\n        this.timestamp = timestamp;\n    }\n    toString() {\n        const { severity, message, scope, colorOptions, timestamp } = this;\n        if (scope.length === 0) {\n            return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)}] ${message}`;\n        }\n        return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)} ${getScopeString(scope, colorOptions)}] ${message}`;\n    }\n}\nlet DefaultLogEventFactory = class DefaultLogEventFactory {\n    constructor(config) {\n        this.config = config;\n    }\n    createLogEvent(logger, level, message, optionalParams) {\n        return new DefaultLogEvent(level, message, optionalParams, logger.scope, this.config.colorOptions, Date.now());\n    }\n};\nDefaultLogEventFactory = __decorate([\n    __param(0, ILogConfig),\n    __metadata(\"design:paramtypes\", [Object])\n], DefaultLogEventFactory);\nexport { DefaultLogEventFactory };\nexport class ConsoleSink {\n    constructor($console) {\n        this.emit = function emit(event) {\n            const optionalParams = event.optionalParams;\n            if (optionalParams === void 0 || optionalParams.length === 0) {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString());\n                    case 2 /* info */:\n                        return $console.info(event.toString());\n                    case 3 /* warn */:\n                        return $console.warn(event.toString());\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString());\n                }\n            }\n            else {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString(), ...optionalParams);\n                    case 2 /* info */:\n                        return $console.info(event.toString(), ...optionalParams);\n                    case 3 /* warn */:\n                        return $console.warn(event.toString(), ...optionalParams);\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString(), ...optionalParams);\n                }\n            }\n        };\n    }\n}\nlet DefaultLogger = class DefaultLogger {\n    constructor(config, factory, sinks, scope = [], parent = null) {\n        this.config = config;\n        this.factory = factory;\n        this.sinks = sinks;\n        this.scope = scope;\n        this.scopedLoggers = Object.create(null);\n        if (parent === null) {\n            this.root = this;\n            this.parent = this;\n        }\n        else {\n            this.root = parent.root;\n            this.parent = parent;\n        }\n        const sinksLen = sinks.length;\n        let i = 0;\n        const emit = (level, msgOrGetMsg, optionalParams) => {\n            const message = typeof msgOrGetMsg === 'function' ? msgOrGetMsg() : msgOrGetMsg;\n            const event = factory.createLogEvent(this, level, message, optionalParams);\n            for (i = 0; i < sinksLen; ++i) {\n                sinks[i].emit(event);\n            }\n        };\n        this.trace = function trace(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 0 /* trace */) {\n                emit(0 /* trace */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.debug = function debug(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 1 /* debug */) {\n                emit(1 /* debug */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.info = function info(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 2 /* info */) {\n                emit(2 /* info */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.warn = function warn(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 3 /* warn */) {\n                emit(3 /* warn */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.error = function error(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 4 /* error */) {\n                emit(4 /* error */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.fatal = function fatal(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 5 /* fatal */) {\n                emit(5 /* fatal */, messageOrGetMessage, optionalParams);\n            }\n        };\n    }\n    scopeTo(name) {\n        const scopedLoggers = this.scopedLoggers;\n        let scopedLogger = scopedLoggers[name];\n        if (scopedLogger === void 0) {\n            scopedLogger = scopedLoggers[name] = new DefaultLogger(this.config, this.factory, this.sinks, this.scope.concat(name), this);\n        }\n        return scopedLogger;\n    }\n};\nDefaultLogger = __decorate([\n    __param(0, ILogConfig),\n    __param(1, ILogEventFactory),\n    __param(2, all(ISink)),\n    __metadata(\"design:paramtypes\", [Object, Object, Array, Array, Object])\n], DefaultLogger);\nexport { DefaultLogger };\n/**\n * A basic `ILogger` configuration that configures a single `console` sink based on provided options.\n *\n * NOTE: You *must* register the return value of `.create` with the container / au instance, not this `LoggerConfiguration` object itself.\n *\n * ```ts\n * // GOOD\n * container.register(LoggerConfiguration.create(console))\n * // GOOD\n * container.register(LoggerConfiguration.create(console, LogLevel.debug))\n * // GOOD\n * container.register(LoggerConfiguration.create({\n *   debug: PLATFORM.noop,\n *   info: PLATFORM.noop,\n *   warn: PLATFORM.noop,\n *   error: msg => {\n *     throw new Error(msg);\n *   }\n * }, LogLevel.debug))\n *\n * // BAD\n * container.register(LoggerConfiguration)\n * ```\n */\nexport const LoggerConfiguration = toLookup({\n    /**\n     * @param $console - The `console` object to use. Can be the native `window.console` / `global.console`, but can also be a wrapper or mock that implements the same interface.\n     * @param level - The global `LogLevel` to configure. Defaults to `warn` or higher.\n     * @param colorOptions - Whether to use colors or not. Defaults to `noColors`. Colors are especially nice in nodejs environments but don't necessarily work (well) in all environments, such as browsers.\n     */\n    create($console, level = 3 /* warn */, colorOptions = 0 /* noColors */) {\n        return toLookup({\n            register(container) {\n                return container.register(Registration.instance(ILogConfig, new LogConfig(colorOptions, level)), Registration.instance(ISink, new ConsoleSink($console)));\n            },\n        });\n    },\n});\n//# sourceMappingURL=logger.js.map","function trimDots(ary) {\n    const len = ary.length;\n    let i = 0;\n    let part;\n    for (; i < len; ++i) {\n        part = ary[i];\n        if (part === '.') {\n            ary.splice(i, 1);\n            i -= 1;\n        }\n        else if (part === '..') {\n            // If at the start, or previous value is still ..,\n            // keep them so that when converted to a path it may\n            // still work when converted to a path, even though\n            // as an ID it is less than ideal. In larger point\n            // releases, may be better to just kick out an error.\n            if (i === 0 || (i === 1 && ary[2] === '..') || ary[i - 1] === '..') {\n                continue;\n            }\n            if (i > 0) {\n                ary.splice(i - 1, 2);\n                i -= 2;\n            }\n        }\n    }\n}\n/**\n * Calculates a path relative to a file.\n *\n * @param name - The relative path.\n * @param file - The file path.\n * @returns The calculated path.\n */\nexport function relativeToFile(name, file) {\n    const fileParts = !file ? file : file.split('/');\n    const nameParts = name.trim().split('/');\n    if (nameParts[0].startsWith('.') && fileParts) {\n        // Convert file to array, and lop off the last part,\n        // so that . matches that 'directory' and not name of the file's\n        // module. For instance, file of 'one/two/three', maps to\n        // 'one/two/three.js', but we want the directory, 'one/two' for\n        // this normalization.\n        const normalizedBaseParts = fileParts.slice(0, fileParts.length - 1);\n        nameParts.unshift(...normalizedBaseParts);\n    }\n    trimDots(nameParts);\n    return nameParts.join('/');\n}\n/**\n * Joins two paths.\n *\n * @param path1 - The first path.\n * @param path2 - The second path.\n * @returns The joined path.\n */\nexport function join(path1, path2) {\n    if (!path1) {\n        return path2;\n    }\n    if (!path2) {\n        return path1;\n    }\n    const schemeMatch = /^([^/]*?:)\\//.exec(path1);\n    const scheme = (schemeMatch && schemeMatch.length > 0) ? schemeMatch[1] : '';\n    path1 = path1.slice(scheme.length);\n    let urlPrefix;\n    if (path1.startsWith('///') && scheme === 'file:') {\n        urlPrefix = '///';\n    }\n    else if (path1.startsWith('//')) {\n        urlPrefix = '//';\n    }\n    else if (path1.startsWith('/')) {\n        urlPrefix = '/';\n    }\n    else {\n        urlPrefix = '';\n    }\n    const trailingSlash = path2.endsWith('/') ? '/' : '';\n    const url1 = path1.split('/');\n    const url2 = path2.split('/');\n    const url3 = [];\n    for (let i = 0, ii = url1.length; i < ii; ++i) {\n        if (url1[i] === '..') {\n            url3.pop();\n        }\n        else if (url1[i] !== '.' && url1[i] !== '') {\n            url3.push(url1[i]);\n        }\n    }\n    for (let i = 0, ii = url2.length; i < ii; ++i) {\n        if (url2[i] === '..') {\n            url3.pop();\n        }\n        else if (url2[i] !== '.' && url2[i] !== '') {\n            url3.push(url2[i]);\n        }\n    }\n    return scheme + urlPrefix + url3.join('/') + trailingSlash;\n}\nconst encode = encodeURIComponent;\nconst encodeKey = (k) => encode(k).replace('%24', '$');\n/**\n * Recursively builds part of query string for parameter.\n *\n * @param key - Parameter name for query string.\n * @param value - Parameter value to deserialize.\n * @param traditional - Boolean Use the old URI template standard (RFC6570)\n * @returns Array with serialized parameter(s)\n */\nfunction buildParam(key, value, traditional) {\n    let result = [];\n    if (value == null) {\n        return result;\n    }\n    if (Array.isArray(value)) {\n        for (let i = 0, l = value.length; i < l; i++) {\n            if (traditional) {\n                result.push(`${encodeKey(key)}=${encode(value[i])}`);\n            }\n            else {\n                const arrayKey = `${key}[${(typeof value[i] === 'object' && value[i] != null ? i : '')}]`;\n                result = result.concat(buildParam(arrayKey, value[i]));\n            }\n        }\n    }\n    else if (typeof value === 'object' && !traditional) {\n        for (const propertyName in value) {\n            result = result.concat(buildParam(`${key}[${propertyName}]`, value[propertyName]));\n        }\n    }\n    else {\n        result.push(`${encodeKey(key)}=${encode(value)}`);\n    }\n    return result;\n}\n/**\n * Generate a query string from an object.\n *\n * @param params - Object containing the keys and values to be used.\n * @param traditional - Boolean Use the old URI template standard (RFC6570)\n * @returns The generated query string, excluding leading '?'.\n */\nexport function buildQueryString(params, traditional) {\n    if (params == null) {\n        return '';\n    }\n    const pairs = [];\n    const keys = Object.keys(params).sort();\n    let key;\n    for (let i = 0, len = keys.length; i < len; ++i) {\n        key = keys[i];\n        pairs.push(...buildParam(key, params[key], traditional));\n    }\n    if (pairs.length === 0) {\n        return '';\n    }\n    return pairs.join('&');\n}\n/**\n * Process parameter that was recognized as scalar param (primitive value or shallow array).\n *\n * @param existedParam - Object with previously parsed values for specified key.\n * @param value - Parameter value to append.\n * @returns Initial primitive value or transformed existedParam if parameter was recognized as an array.\n */\nfunction processScalarParam(existedParam, value) {\n    if (Array.isArray(existedParam)) {\n        // value is already an array, so push on the next value.\n        existedParam.push(value);\n        return existedParam;\n    }\n    if (existedParam !== undefined) {\n        // value isn't an array, but since a second value has been specified,\n        // convert value into an array.\n        return [existedParam, value];\n    }\n    // value is a scalar.\n    return value;\n}\n/**\n * Sequentially process parameter that was recognized as complex value (object or array).\n * For each keys part, if the current level is undefined create an\n * object or array based on the type of the next keys part.\n *\n * @param queryParams - root-level result object.\n * @param keys - Collection of keys related to this parameter.\n * @param value - Parameter value to append.\n */\nfunction parseComplexParam(queryParams, keys, value) {\n    let currentParams = queryParams;\n    const keysLastIndex = keys.length - 1;\n    let key;\n    let prevValue;\n    for (let j = 0; j <= keysLastIndex; ++j) {\n        key = (keys[j] === '' ? currentParams.length : keys[j]);\n        if (j < keysLastIndex) {\n            // The value has to be an array or a false value\n            // It can happen that the value is no array if the key was repeated with traditional style like `list=1&list[]=2`\n            if (!currentParams[key] || typeof currentParams[key] === 'object') {\n                prevValue = currentParams[key];\n            }\n            else {\n                prevValue = [currentParams[key]];\n            }\n            if (prevValue) {\n                currentParams = currentParams[key] = prevValue;\n            }\n            else if (isNaN(keys[j + 1])) {\n                // Kinda have no choice here\n                // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n                currentParams = currentParams[key] = {};\n            }\n            else {\n                currentParams = currentParams[key] = [];\n            }\n        }\n        else {\n            currentParams = currentParams[key] = value;\n        }\n    }\n}\n/**\n * Parse a query string into a queryParams object.\n *\n * @param queryString - The query string to parse.\n * @returns Object with keys and values mapped from the query string.\n */\nexport function parseQueryString(queryString) {\n    const queryParams = {};\n    if (!queryString || typeof queryString !== 'string') {\n        return queryParams;\n    }\n    let query = queryString;\n    if (query.startsWith('?')) {\n        query = query.slice(1);\n    }\n    const pairs = query.replace(/\\+/g, ' ').split('&');\n    for (let i = 0; i < pairs.length; i++) {\n        const pair = pairs[i].split('=');\n        const key = decodeURIComponent(pair[0]);\n        if (!key) {\n            continue;\n        }\n        // split object key into its parts\n        let keys = key.split('][');\n        let keysLastIndex = keys.length - 1;\n        // If the first keys part contains [ and the last ends with ], then []\n        // are correctly balanced, split key to parts\n        // Else it's basic key\n        if (keys[0].includes(\"[\") && keys[keysLastIndex].endsWith(\"]\")) {\n            keys[keysLastIndex] = keys[keysLastIndex].replace(/\\]$/, '');\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            keys = keys.shift().split('[').concat(keys); // outer condition already ensures not-null\n            keysLastIndex = keys.length - 1;\n        }\n        else {\n            keysLastIndex = 0;\n        }\n        if (pair.length >= 2) {\n            const value = pair[1] ? decodeURIComponent(pair[1]) : '';\n            if (keysLastIndex) {\n                parseComplexParam(queryParams, keys, value);\n            }\n            else {\n                queryParams[key] = processScalarParam(queryParams[key], value);\n            }\n        }\n        else {\n            queryParams[key] = true;\n        }\n    }\n    return queryParams;\n}\n//# sourceMappingURL=path.js.map","import { PLATFORM } from './platform';\nexport const Profiler = (function () {\n    const now = PLATFORM.now;\n    const timers = [];\n    let profileMap;\n    const profiler = {\n        createTimer,\n        enable,\n        disable,\n        report,\n        enabled: false\n    };\n    return profiler;\n    function createTimer(name) {\n        timers.push(name);\n        let depth = 0;\n        let mark = 0;\n        return {\n            enter,\n            leave\n        };\n        function enter() {\n            if (++depth === 1) {\n                mark = now();\n                ++profileMap[name].topLevelCount;\n            }\n            ++profileMap[name].totalCount;\n        }\n        function leave() {\n            if (--depth === 0) {\n                profileMap[name].duration += (now() - mark);\n            }\n        }\n    }\n    function enable() {\n        profileMap = {};\n        for (const timer of timers) {\n            profileMap[timer] = {\n                name: timer,\n                duration: 0,\n                topLevelCount: 0,\n                totalCount: 0\n            };\n        }\n        profiler.enabled = true;\n    }\n    function disable() {\n        profiler.enabled = false;\n    }\n    function report(cb) {\n        Object.keys(profileMap).map(key => profileMap[key]).sort((a, b) => b.duration - a.duration).forEach(p => {\n            cb(p.name, p.duration, p.topLevelCount, p.totalCount);\n        });\n    }\n})();\n//# sourceMappingURL=profiler.js.map","import { DI } from './di';\nimport { Reporter } from './reporter';\n/**\n * Represents a handler for an EventAggregator event.\n */\nclass Handler {\n    constructor(\n    /** @internal */\n    messageType, \n    /** @internal */\n    callback) {\n        this.messageType = messageType;\n        this.callback = callback;\n    }\n    handle(message) {\n        if (message instanceof this.messageType) {\n            this.callback.call(null, message);\n        }\n    }\n}\nfunction invokeCallback(callback, data, event) {\n    try {\n        callback(data, event);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nfunction invokeHandler(handler, data) {\n    try {\n        handler.handle(data);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nexport const IEventAggregator = DI.createInterface('IEventAggregator').withDefault(x => x.singleton(EventAggregator));\n/**\n * Enables loosely coupled publish/subscribe messaging.\n */\nexport class EventAggregator {\n    constructor() {\n        /** @internal */\n        this.eventLookup = {};\n        /** @internal */\n        this.messageHandlers = [];\n    }\n    publish(channelOrInstance, data) {\n        let subscribers;\n        let i;\n        if (!channelOrInstance) {\n            throw Reporter.error(0); // TODO: create error code for 'Event was invalid.'\n        }\n        if (typeof channelOrInstance === 'string') {\n            const channel = channelOrInstance;\n            subscribers = this.eventLookup[channel];\n            if (subscribers != null) {\n                subscribers = subscribers.slice();\n                i = subscribers.length;\n                while (i--) {\n                    invokeCallback(subscribers[i], data, channel);\n                }\n            }\n        }\n        else {\n            const instance = channelOrInstance;\n            subscribers = this.messageHandlers.slice();\n            i = subscribers.length;\n            while (i--) {\n                invokeHandler(subscribers[i], instance);\n            }\n        }\n    }\n    subscribe(channelOrType, callback) {\n        let handler;\n        let subscribers;\n        if (!channelOrType) {\n            throw Reporter.error(0); // TODO: create error code for 'Event channel/type was invalid.'\n        }\n        if (typeof channelOrType === 'string') {\n            const channel = channelOrType;\n            handler = callback;\n            if (this.eventLookup[channel] === void 0) {\n                this.eventLookup[channel] = [];\n            }\n            subscribers = this.eventLookup[channel];\n        }\n        else {\n            handler = new Handler(channelOrType, callback);\n            subscribers = this.messageHandlers;\n        }\n        subscribers.push(handler);\n        return {\n            dispose() {\n                const idx = subscribers.indexOf(handler);\n                if (idx !== -1) {\n                    subscribers.splice(idx, 1);\n                }\n            }\n        };\n    }\n    subscribeOnce(channelOrType, callback) {\n        const sub = this.subscribe(channelOrType, (data, event) => {\n            sub.dispose();\n            return callback(data, event);\n        });\n        return sub;\n    }\n}\n//# sourceMappingURL=eventaggregator.js.map","export { all, DI, IContainer, inject, IServiceLocator, lazy, optional, Registration, singleton, transient, InstanceProvider, } from './di';\nexport { metadata, Metadata, } from './metadata';\nexport { ColorOptions, ILogConfig, ILogEventFactory, ISink, ILogger, LogConfig, DefaultLogEvent, DefaultLogEventFactory, DefaultLogger, ConsoleSink, LoggerConfiguration, format, } from './logger';\nexport { relativeToFile, join, buildQueryString, parseQueryString } from './path';\nexport { PLATFORM } from './platform';\nexport { Reporter, Tracer, LogLevel, } from './reporter';\nexport { Profiler } from './profiler';\nexport { Protocol, fromAnnotationOrDefinitionOrTypeOrDefault, fromAnnotationOrTypeOrDefault, fromDefinitionOrDefault, } from './resource';\nexport { EventAggregator, IEventAggregator, } from './eventaggregator';\nexport { isArrayIndex, camelCase, kebabCase, pascalCase, toArray, nextId, resetId, compareNumber, mergeDistinct, isNumberOrBigInt, isStringOrDate, bound, mergeArrays, mergeObjects, firstDefined, getPrototypeChain, isObject, isNullOrUndefined, isNativeFunction, } from './functions';\n//# sourceMappingURL=index.js.map","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","var ProxyObserver_1;\nimport { __decorate, __metadata } from \"tslib\";\nimport { PLATFORM } from '@aurelia/kernel';\nimport { proxySubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst lookup = new WeakMap();\nlet ProxySubscriberCollection = class ProxySubscriberCollection {\n    constructor(proxy, raw, key) {\n        this.proxy = proxy;\n        this.raw = raw;\n        this.key = key;\n        this.inBatch = false;\n        this.subscribe = this.addSubscriber;\n        this.unsubscribe = this.removeSubscriber;\n        if (raw[key] instanceof Object) { // Ensure we observe array indices and newly created object properties\n            raw[key] = ProxyObserver.getOrCreate(raw[key]).proxy;\n        }\n    }\n    setValue(value, flags) {\n        const oldValue = this.raw[this.key];\n        if (oldValue !== value) {\n            this.raw[this.key] = value;\n            this.callSubscribers(value, oldValue, flags | 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n    getValue() {\n        return this.raw[this.key];\n    }\n    flushBatch(flags) {\n        return;\n    }\n};\nProxySubscriberCollection = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, Object])\n], ProxySubscriberCollection);\nexport { ProxySubscriberCollection };\nlet ProxyObserver = ProxyObserver_1 = class ProxyObserver {\n    constructor(obj) {\n        this.raw = obj;\n        this.proxy = new Proxy(obj, this);\n        lookup.set(obj, this.proxy);\n        this.subscribers = {};\n    }\n    static getProxyOrSelf(obj) {\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                return obj;\n            }\n            return proxy;\n        }\n        return obj;\n    }\n    static getRawIfProxy(obj) {\n        const raw = obj.$raw;\n        if (raw === void 0) {\n            return obj;\n        }\n        return raw;\n    }\n    static getOrCreate(obj, key) {\n        let proxyObserver;\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                proxyObserver = new ProxyObserver_1(obj);\n            }\n            else {\n                proxyObserver = proxy.$observer;\n            }\n        }\n        else {\n            proxyObserver = obj.$observer;\n        }\n        if (key === void 0) {\n            return proxyObserver;\n        }\n        let subscribers = proxyObserver.subscribers[key];\n        if (subscribers === void 0) {\n            const raw = this.getRawIfProxy(obj);\n            const proxy = proxyObserver.proxy;\n            subscribers = proxyObserver.subscribers[key] = new ProxySubscriberCollection(proxy, raw, key);\n        }\n        return subscribers;\n    }\n    static isProxy(obj) {\n        return obj.$raw !== void 0;\n    }\n    get(target, p, receiver) {\n        if (p === '$observer') {\n            return this;\n        }\n        if (p === '$raw') {\n            return target;\n        }\n        return target[p];\n    }\n    set(target, p, value, receiver) {\n        const oldValue = target[p];\n        if (oldValue !== value) {\n            target[p] = value;\n            this.callPropertySubscribers(value, oldValue, p);\n            this.callProxySubscribers(p, value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n        return true;\n    }\n    deleteProperty(target, p) {\n        const oldValue = target[p];\n        if (Reflect.deleteProperty(target, p)) {\n            if (oldValue !== void 0) {\n                this.callPropertySubscribers(undefined, oldValue, p);\n                this.callProxySubscribers(p, undefined, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    defineProperty(target, p, attributes) {\n        const oldValue = target[p];\n        if (Reflect.defineProperty(target, p, attributes)) {\n            if (attributes.value !== oldValue) {\n                this.callPropertySubscribers(attributes.value, oldValue, p);\n                this.callProxySubscribers(p, attributes.value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    apply(target, thisArg, argArray = PLATFORM.emptyArray) {\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        return Reflect.apply(target, target, argArray); // Reflect API dictates this\n    }\n    subscribe(subscriber, key) {\n        if (key === void 0) {\n            this.addProxySubscriber(subscriber);\n        }\n        else {\n            let subscribers = this.subscribers[key];\n            if (subscribers === void 0) {\n                subscribers = this.subscribers[key] = new ProxySubscriberCollection(this.proxy, this.raw, key);\n            }\n            subscribers.addSubscriber(subscriber);\n        }\n    }\n    unsubscribe(subscriber, key) {\n        if (key === void 0) {\n            this.removeProxySubscriber(subscriber);\n        }\n        else {\n            const subscribers = this.subscribers[key];\n            if (subscribers !== undefined) {\n                subscribers.removeSubscriber(subscriber);\n            }\n        }\n    }\n    callPropertySubscribers(newValue, oldValue, key) {\n        const subscribers = this.subscribers[key];\n        if (subscribers !== void 0) {\n            subscribers.callSubscribers(newValue, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n};\nProxyObserver = ProxyObserver_1 = __decorate([\n    proxySubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object])\n], ProxyObserver);\nexport { ProxyObserver };\n//# sourceMappingURL=proxy-observer.js.map","// TODO: see if we can de-duplicate these 3 decorators and their functions without killing performance or readability\nexport function subscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._subscriberFlags = 0 /* None */;\n        proto.addSubscriber = addSubscriber;\n        proto.removeSubscriber = removeSubscriber;\n        proto.hasSubscriber = hasSubscriber;\n        proto.hasSubscribers = hasSubscribers;\n        proto.callSubscribers = callSubscribers;\n        if (proto.subscribe === void 0)\n            proto.subscribe = addSubscriber;\n        if (proto.unsubscribe === void 0)\n            proto.unsubscribe = removeSubscriber;\n    };\n}\nexport function proxySubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._proxySubscriberFlags = 0 /* None */;\n        proto.addProxySubscriber = addProxySubscriber;\n        proto.removeProxySubscriber = removeProxySubscriber;\n        proto.hasProxySubscriber = hasProxySubscriber;\n        proto.hasProxySubscribers = hasProxySubscribers;\n        proto.callProxySubscribers = callProxySubscribers;\n        if (proto.subscribeToProxy === void 0)\n            proto.subscribeToProxy = addProxySubscriber;\n        if (proto.unsubscribeFromProxy === void 0)\n            proto.unsubscribeFromProxy = removeProxySubscriber;\n    };\n}\nexport function collectionSubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._collectionSubscriberFlags = 0 /* None */;\n        proto.addCollectionSubscriber = addCollectionSubscriber;\n        proto.removeCollectionSubscriber = removeCollectionSubscriber;\n        proto.hasCollectionSubscriber = hasCollectionSubscriber;\n        proto.hasCollectionSubscribers = hasCollectionSubscribers;\n        proto.callCollectionSubscribers = callCollectionSubscribers;\n        if (proto.subscribeToCollection === void 0)\n            proto.subscribeToCollection = addCollectionSubscriber;\n        if (proto.unsubscribeFromCollection === void 0)\n            proto.unsubscribeFromCollection = removeCollectionSubscriber;\n    };\n}\nfunction addSubscriber(subscriber) {\n    if (this.hasSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._subscriber0 = subscriber;\n        this._subscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._subscriber1 = subscriber;\n        this._subscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._subscriber2 = subscriber;\n        this._subscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._subscribersRest = [subscriber];\n        this._subscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._subscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addProxySubscriber(subscriber) {\n    if (this.hasProxySubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._proxySubscriber0 = subscriber;\n        this._proxySubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._proxySubscriber1 = subscriber;\n        this._proxySubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._proxySubscriber2 = subscriber;\n        this._proxySubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._proxySubscribersRest = [subscriber];\n        this._proxySubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._proxySubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addCollectionSubscriber(subscriber) {\n    if (this.hasCollectionSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._collectionSubscriber0 = subscriber;\n        this._collectionSubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._collectionSubscriber1 = subscriber;\n        this._collectionSubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._collectionSubscriber2 = subscriber;\n        this._collectionSubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._collectionSubscribersRest = [subscriber];\n        this._collectionSubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._collectionSubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction removeSubscriber(subscriber) {\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        this._subscriber0 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        this._subscriber1 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        this._subscriber2 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._subscriberFlags = (this._subscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        this._proxySubscriber0 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        this._proxySubscriber1 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        this._proxySubscriber2 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._proxySubscriberFlags = (this._proxySubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        this._collectionSubscriber0 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        this._collectionSubscriber1 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        this._collectionSubscriber2 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasSubscribers() {\n    return this._subscriberFlags !== 0 /* None */;\n}\nfunction hasProxySubscribers() {\n    return this._proxySubscriberFlags !== 0 /* None */;\n}\nfunction hasCollectionSubscribers() {\n    return this._collectionSubscriberFlags !== 0 /* None */;\n}\nfunction hasSubscriber(subscriber) {\n    // Flags here is just a perf tweak\n    // Compared to not using flags, it's a moderate speed-up when this collection does not have the subscriber;\n    // and minor slow-down when it does, and the former is more common than the latter.\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction callSubscribers(newValue, previousValue, flags) {\n    /**\n     * Note: change handlers may have the side-effect of adding/removing subscribers to this collection during this\n     * callSubscribers invocation, so we're caching them all before invoking any.\n     * Subscribers added during this invocation are not invoked (and they shouldn't be).\n     * Subscribers removed during this invocation will still be invoked (and they also shouldn't be,\n     * however this is accounted for via $isBound and similar flags on the subscriber objects)\n     */\n    const subscriber0 = this._subscriber0;\n    const subscriber1 = this._subscriber1;\n    const subscriber2 = this._subscriber2;\n    let subscribers = this._subscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        callSubscriber(subscriber0, newValue, previousValue, flags, subscriber0.id === void 0 ? 0 : this[subscriber0.id]);\n    }\n    if (subscriber1 !== void 0) {\n        callSubscriber(subscriber1, newValue, previousValue, flags, subscriber1.id === void 0 ? 0 : this[subscriber1.id]);\n    }\n    if (subscriber2 !== void 0) {\n        callSubscriber(subscriber2, newValue, previousValue, flags, subscriber2.id === void 0 ? 0 : this[subscriber2.id]);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                callSubscriber(subscriber, newValue, previousValue, flags, subscriber.id === void 0 ? 0 : this[subscriber.id]);\n            }\n        }\n    }\n}\nfunction callSubscriber(subscriber, newValue, previousValue, flags, ownFlags) {\n    subscriber.handleChange(newValue, previousValue, ((flags | 48 /* update */) ^ 48 /* update */) | ownFlags);\n}\nfunction callProxySubscribers(key, newValue, previousValue, flags) {\n    const subscriber0 = this._proxySubscriber0;\n    const subscriber1 = this._proxySubscriber1;\n    const subscriber2 = this._proxySubscriber2;\n    let subscribers = this._proxySubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleProxyChange(key, newValue, previousValue, flags);\n            }\n        }\n    }\n}\nfunction callCollectionSubscribers(indexMap, flags) {\n    const subscriber0 = this._collectionSubscriber0;\n    const subscriber1 = this._collectionSubscriber1;\n    const subscriber2 = this._collectionSubscriber2;\n    let subscribers = this._collectionSubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleCollectionChange(indexMap, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleCollectionChange(indexMap, flags);\n            }\n        }\n    }\n}\n//# sourceMappingURL=subscriber-collection.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI, Registration, } from '@aurelia/kernel';\nexport var ViewModelKind;\n(function (ViewModelKind) {\n    ViewModelKind[ViewModelKind[\"customElement\"] = 0] = \"customElement\";\n    ViewModelKind[ViewModelKind[\"customAttribute\"] = 1] = \"customAttribute\";\n    ViewModelKind[ViewModelKind[\"synthetic\"] = 2] = \"synthetic\";\n})(ViewModelKind || (ViewModelKind = {}));\nexport const IController = DI.createInterface('IController').noDefault();\n/**\n * Describing characteristics of a mounting operation a controller will perform\n */\nexport var MountStrategy;\n(function (MountStrategy) {\n    MountStrategy[MountStrategy[\"insertBefore\"] = 1] = \"insertBefore\";\n    MountStrategy[MountStrategy[\"append\"] = 2] = \"append\";\n})(MountStrategy || (MountStrategy = {}));\nexport const IViewFactory = DI.createInterface('IViewFactory').noDefault();\nexport const ILifecycle = DI.createInterface('ILifecycle').withDefault(x => x.singleton(Lifecycle));\nlet BoundQueue = class BoundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevBound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextBound = controller; // implied by boundHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevBound !== void 0) {\n            controller.prevBound.nextBound = controller.nextBound;\n        }\n        if (controller.nextBound !== void 0) {\n            controller.nextBound.prevBound = controller.prevBound;\n        }\n        controller.prevBound = void 0;\n        controller.nextBound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevBound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextBound;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterBind(flags);\n                next = cur.nextBound;\n                cur.nextBound = void 0;\n                cur.prevBound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nBoundQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], BoundQueue);\nexport { BoundQueue };\nlet UnboundQueue = class UnboundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnbound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnbound = controller; // implied by unboundHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevUnbound !== void 0) {\n            controller.prevUnbound.nextUnbound = controller.nextUnbound;\n        }\n        if (controller.nextUnbound !== void 0) {\n            controller.nextUnbound.prevUnbound = controller.prevUnbound;\n        }\n        controller.prevUnbound = void 0;\n        controller.nextUnbound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnbound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnbound;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterUnbind(flags);\n                next = cur.nextUnbound;\n                cur.nextUnbound = void 0;\n                cur.prevUnbound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnboundQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], UnboundQueue);\nexport { UnboundQueue };\nlet AttachedQueue = class AttachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.mount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevAttached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextAttached = controller; // implied by attachedHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevAttached !== void 0) {\n            controller.prevAttached.nextAttached = controller.nextAttached;\n        }\n        if (controller.nextAttached !== void 0) {\n            controller.nextAttached.prevAttached = controller.prevAttached;\n        }\n        controller.prevAttached = void 0;\n        controller.nextAttached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevAttached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextAttached;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterAttach(flags);\n                next = cur.nextAttached;\n                cur.nextAttached = void 0;\n                cur.prevAttached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nAttachedQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], AttachedQueue);\nexport { AttachedQueue };\nlet DetachedQueue = class DetachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.unmount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevDetached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextDetached = controller; // implied by detachedHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevDetached !== void 0) {\n            controller.prevDetached.nextDetached = controller.nextDetached;\n        }\n        if (controller.nextDetached !== void 0) {\n            controller.nextDetached.prevDetached = controller.prevDetached;\n        }\n        controller.prevDetached = void 0;\n        controller.nextDetached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevDetached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextDetached;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterDetach(flags);\n                next = cur.nextDetached;\n                cur.nextDetached = void 0;\n                cur.prevDetached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nDetachedQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], DetachedQueue);\nexport { DetachedQueue };\nlet MountQueue = class MountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevMount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextMount = controller; // implied by mountHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevMount !== void 0) {\n            controller.prevMount.nextMount = controller.nextMount;\n        }\n        if (controller.nextMount !== void 0) {\n            controller.nextMount.prevMount = controller.prevMount;\n        }\n        controller.prevMount = void 0;\n        controller.nextMount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevMount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextMount;\n        }\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                ++i;\n                cur.mount(flags);\n                next = cur.nextMount;\n                cur.nextMount = void 0;\n                cur.prevMount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nMountQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], MountQueue);\nexport { MountQueue };\nlet UnmountQueue = class UnmountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnmount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnmount = controller; // implied by unmountHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevUnmount !== void 0) {\n            controller.prevUnmount.nextUnmount = controller.nextUnmount;\n        }\n        if (controller.nextUnmount !== void 0) {\n            controller.nextUnmount.prevUnmount = controller.prevUnmount;\n        }\n        controller.prevUnmount = void 0;\n        controller.nextUnmount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnmount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnmount;\n        }\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                ++i;\n                cur.unmount(flags);\n                next = cur.nextUnmount;\n                cur.nextUnmount = void 0;\n                cur.prevUnmount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnmountQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], UnmountQueue);\nexport { UnmountQueue };\nlet BatchQueue = class BatchQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.queue = [];\n        this.depth = 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(requestor) {\n        this.queue.push(requestor);\n    }\n    remove(requestor) {\n        const index = this.queue.indexOf(requestor);\n        if (index > -1) {\n            this.queue.splice(index, 1);\n        }\n    }\n    process(flags) {\n        flags |= 512 /* fromBatch */;\n        while (this.queue.length > 0) {\n            const batch = this.queue.slice();\n            this.queue = [];\n            const { length } = batch;\n            for (let i = 0; i < length; ++i) {\n                batch[i].flushBatch(flags);\n            }\n        }\n    }\n};\nBatchQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], BatchQueue);\nexport { BatchQueue };\nexport class Lifecycle {\n    constructor() {\n        this.batch = new BatchQueue(this);\n        this.mount = new MountQueue(this);\n        this.unmount = new UnmountQueue(this);\n        this.afterBind = new BoundQueue(this);\n        this.afterUnbind = new UnboundQueue(this);\n        this.afterAttach = new AttachedQueue(this);\n        this.afterDetach = new DetachedQueue(this);\n    }\n    static register(container) {\n        return Registration.singleton(ILifecycle, this).register(container);\n    }\n}\n//# sourceMappingURL=lifecycle.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { subscriberCollection } from './subscriber-collection';\n/**\n * Observer for the mutation of object property value employing getter-setter strategy.\n * This is used for observing object properties that has no decorator.\n */\nlet SetterObserver = class SetterObserver {\n    constructor(lifecycle, flags, obj, propertyKey) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        this.observing = false;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // If subscribe() has been called, the target property descriptor is replaced by these getter/setter methods,\n            // so calling obj[propertyKey] will actually return this.currentValue.\n            // However, if subscribe() was not yet called (indicated by !this.observing), the target descriptor\n            // is unmodified and we need to explicitly set the property value.\n            // This will happen in one-time, to-view and two-way bindings during $bind, meaning that the $bind will not actually update the target value.\n            // This wasn't visible in vCurrent due to connect-queue always doing a delayed update, so in many cases it didn't matter whether $bind updated the target or not.\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const currentValue = this.currentValue;\n        const oldValue = this.oldValue;\n        this.oldValue = currentValue;\n        this.callSubscribers(currentValue, oldValue, this.persistentFlags | flags);\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            this.currentValue = this.obj[this.propertyKey];\n            if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                enumerable: true,\n                configurable: true,\n                get: () => {\n                    return this.getValue();\n                },\n                set: value => {\n                    this.setValue(value, 0 /* none */);\n                },\n            })) {\n                Reporter.write(1, this.propertyKey, this.obj);\n            }\n        }\n        this.addSubscriber(subscriber);\n    }\n};\nSetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, String])\n], SetterObserver);\nexport { SetterObserver };\n//# sourceMappingURL=setter-observer.js.map","import { PLATFORM, Reporter } from '@aurelia/kernel';\nimport { ProxyObserver } from './proxy-observer';\nimport { SetterObserver } from './setter-observer';\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n    RuntimeError[RuntimeError[\"NilOverrideContext\"] = 252] = \"NilOverrideContext\";\n    RuntimeError[RuntimeError[\"NilParentScope\"] = 253] = \"NilParentScope\";\n})(RuntimeError || (RuntimeError = {}));\nconst marker = Object.freeze({});\n/** @internal */\nexport class InternalObserversLookup {\n    getOrCreate(lifecycle, flags, obj, key) {\n        if (this[key] === void 0) {\n            this[key] = new SetterObserver(lifecycle, flags, obj, key);\n        }\n        return this[key];\n    }\n}\nexport class BindingContext {\n    constructor(keyOrObj, value) {\n        this.$synthetic = true;\n        if (keyOrObj !== void 0) {\n            if (value !== void 0) {\n                // if value is defined then it's just a property and a value to initialize with\n                this[keyOrObj] = value;\n            }\n            else {\n                // can either be some random object or another bindingContext to clone from\n                for (const prop in keyOrObj) {\n                    if (Object.prototype.hasOwnProperty.call(keyOrObj, prop)) {\n                        this[prop] = keyOrObj[prop];\n                    }\n                }\n            }\n        }\n    }\n    static create(flags, keyOrObj, value) {\n        const bc = new BindingContext(keyOrObj, value);\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(bc).proxy;\n        }\n        return bc;\n    }\n    static get(scope, name, ancestor, flags, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */);\n        }\n        let overrideContext = scope.overrideContext;\n        if (ancestor > 0) {\n            // jump up the required number of ancestor contexts (eg $parent.$parent requires two jumps)\n            while (ancestor > 0) {\n                if (overrideContext.parentOverrideContext == null) {\n                    return void 0;\n                }\n                ancestor--;\n                overrideContext = overrideContext.parentOverrideContext;\n            }\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // traverse the context and it's ancestors, searching for a context that has the name.\n        while (overrideContext && !(name in overrideContext) && !(overrideContext.bindingContext && name in overrideContext.bindingContext)) {\n            overrideContext = overrideContext.parentOverrideContext;\n        }\n        if (overrideContext) {\n            // we located a context with the property.  return it.\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // the name wasn't found. see if parent scope traversal is allowed and if so, try that\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (parent.scopeParts.includes(part)) {\n                    const result = this.get(parent, name, ancestor, flags\n                        // unset the flag; only allow one level of scope boundary traversal\n                        & ~67108864 /* allowParentScopeTraversal */\n                        // tell the scope to return null if the name could not be found\n                        | 4194304 /* isTraversingParentScope */);\n                    if (result === marker) {\n                        return scope.bindingContext || scope.overrideContext;\n                    }\n                    else {\n                        return result;\n                    }\n                }\n                else {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope could be found for part \"${part}\"`);\n            }\n        }\n        // still nothing found. return the root binding context (or null\n        // if this is a parent scope traversal, to ensure we fall back to the\n        // correct level)\n        if (flags & 4194304 /* isTraversingParentScope */) {\n            return marker;\n        }\n        return scope.bindingContext || scope.overrideContext;\n    }\n    getObservers(flags) {\n        if (this.$observers == null) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\nexport class Scope {\n    constructor(parentScope, bindingContext, overrideContext) {\n        this.parentScope = parentScope;\n        this.scopeParts = PLATFORM.emptyArray;\n        this.bindingContext = bindingContext;\n        this.overrideContext = overrideContext;\n    }\n    static create(flags, bc, oc) {\n        return new Scope(null, bc, oc == null ? OverrideContext.create(flags, bc, oc) : oc);\n    }\n    static fromOverride(flags, oc) {\n        if (oc == null) {\n            throw Reporter.error(252 /* NilOverrideContext */);\n        }\n        return new Scope(null, oc.bindingContext, oc);\n    }\n    static fromParent(flags, ps, bc) {\n        if (ps == null) {\n            throw Reporter.error(253 /* NilParentScope */);\n        }\n        return new Scope(ps, bc, OverrideContext.create(flags, bc, ps.overrideContext));\n    }\n}\nexport class OverrideContext {\n    constructor(bindingContext, parentOverrideContext) {\n        this.$synthetic = true;\n        this.bindingContext = bindingContext;\n        this.parentOverrideContext = parentOverrideContext;\n    }\n    static create(flags, bc, poc) {\n        return new OverrideContext(bc, poc === void 0 ? null : poc);\n    }\n    getObservers() {\n        if (this.$observers === void 0) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\n//# sourceMappingURL=binding-context.js.map","import { DI } from '@aurelia/kernel';\nexport const ISignaler = DI.createInterface('ISignaler').withDefault(x => x.singleton(Signaler));\n/** @internal */\nexport class Signaler {\n    constructor() {\n        this.signals = Object.create(null);\n    }\n    dispatchSignal(name, flags) {\n        const listeners = this.signals[name];\n        if (listeners === undefined) {\n            return;\n        }\n        for (const listener of listeners.keys()) {\n            listener.handleChange(undefined, undefined, flags | 16 /* updateTargetInstance */);\n        }\n    }\n    addSignalListener(name, listener) {\n        const signals = this.signals;\n        const listeners = signals[name];\n        if (listeners === undefined) {\n            signals[name] = new Set([listener]);\n        }\n        else {\n            listeners.add(listener);\n        }\n    }\n    removeSignalListener(name, listener) {\n        const listeners = this.signals[name];\n        if (listeners) {\n            listeners.delete(listener);\n        }\n    }\n}\n//# sourceMappingURL=signaler.js.map","import { DI, Registration, Metadata, Protocol, } from '@aurelia/kernel';\n/**\n * TargetedInstructionType enum values become the property names for the associated renderers when they are injected\n * into the `Renderer`.\n *\n * Additional instruction types can be added as long as they are 2 characters long and do not clash with existing ones.\n *\n * By convention, the instruction types for a particular runtime start with the same first letter, and the second letter\n * starts counting from letter `a`. The standard runtime instruction types all start with the letter `r`.\n */\nexport var TargetedInstructionType;\n(function (TargetedInstructionType) {\n    TargetedInstructionType[\"hydrateElement\"] = \"ra\";\n    TargetedInstructionType[\"hydrateAttribute\"] = \"rb\";\n    TargetedInstructionType[\"hydrateTemplateController\"] = \"rc\";\n    TargetedInstructionType[\"hydrateLetElement\"] = \"rd\";\n    TargetedInstructionType[\"setProperty\"] = \"re\";\n    TargetedInstructionType[\"interpolation\"] = \"rf\";\n    TargetedInstructionType[\"propertyBinding\"] = \"rg\";\n    TargetedInstructionType[\"callBinding\"] = \"rh\";\n    TargetedInstructionType[\"letBinding\"] = \"ri\";\n    TargetedInstructionType[\"refBinding\"] = \"rj\";\n    TargetedInstructionType[\"iteratorBinding\"] = \"rk\";\n})(TargetedInstructionType || (TargetedInstructionType = {}));\nconst parentPartsOwnPartsLookup = new WeakMap();\n/**\n * Efficiently merge parts, performing the minimal amount of work / using the minimal amount of memory.\n *\n * If either of the two part records is undefined, the other will simply be returned.\n *\n * If both are undefined, undefined will be returned.\n *\n * If neither are undefined, a new object will be returned where parts of the second value will be written last (and thus may overwrite duplicate named parts).\n *\n * This function is idempotent via a WeakMap cache: results are cached and if the same two variables are provided again, the same object will be returned.\n */\nexport function mergeParts(parentParts, ownParts) {\n    if (parentParts === ownParts) {\n        return parentParts;\n    }\n    if (parentParts === void 0) {\n        return ownParts;\n    }\n    if (ownParts === void 0) {\n        return parentParts;\n    }\n    let ownPartsLookup = parentPartsOwnPartsLookup.get(parentParts);\n    if (ownPartsLookup === void 0) {\n        parentPartsOwnPartsLookup.set(parentParts, ownPartsLookup = new WeakMap());\n    }\n    let mergedParts = ownPartsLookup.get(ownParts);\n    if (mergedParts === void 0) {\n        ownPartsLookup.set(ownParts, mergedParts = {\n            ...parentParts,\n            ...ownParts,\n        });\n    }\n    return mergedParts;\n}\nexport const ITargetedInstruction = DI.createInterface('ITargetedInstruction').noDefault();\nexport function isTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\nexport class HooksDefinition {\n    constructor(target) {\n        this.hasCreate = 'create' in target;\n        this.hasBeforeCompile = 'beforeCompile' in target;\n        this.hasAfterCompile = 'afterCompile' in target;\n        this.hasAfterCompileChildren = 'afterCompileChildren' in target;\n        this.hasBeforeBind = 'beforeBind' in target;\n        this.hasAfterBind = 'afterBind' in target;\n        this.hasBeforeUnbind = 'beforeUnbind' in target;\n        this.hasAfterUnbind = 'afterUnbind' in target;\n        this.hasBeforeAttach = 'beforeAttach' in target;\n        this.hasAfterAttach = 'afterAttach' in target;\n        this.hasBeforeDetach = 'beforeDetach' in target;\n        this.hasAfterDetach = 'afterDetach' in target;\n        this.hasCaching = 'caching' in target;\n    }\n}\nHooksDefinition.none = new HooksDefinition({});\nexport function alias(...aliases) {\n    return function (target) {\n        const key = Protocol.annotation.keyFor('aliases');\n        const existing = Metadata.getOwn(key, target);\n        if (existing === void 0) {\n            Metadata.define(key, aliases, target);\n        }\n        else {\n            existing.push(...aliases);\n        }\n    };\n}\nexport function registerAliases(aliases, resource, key, container) {\n    for (let i = 0, ii = aliases.length; i < ii; ++i) {\n        Registration.alias(key, resource.keyFrom(aliases[i])).register(container);\n    }\n}\n//# sourceMappingURL=definitions.js.map","// TODO: add connect-queue (or something similar) back in when everything else is working, to improve startup time\nconst slice = Array.prototype.slice;\nconst slotNames = [];\nconst versionSlotNames = [];\nlet lastSlot = -1;\nfunction ensureEnoughSlotNames(currentSlot) {\n    if (currentSlot === lastSlot) {\n        lastSlot += 5;\n        const ii = slotNames.length = versionSlotNames.length = lastSlot + 1;\n        for (let i = currentSlot + 1; i < ii; ++i) {\n            slotNames[i] = `_observer${i}`;\n            versionSlotNames[i] = `_observerVersion${i}`;\n        }\n    }\n}\nensureEnoughSlotNames(-1);\n/** @internal */\nexport function addObserver(observer) {\n    // find the observer.\n    const observerSlots = this.observerSlots == null ? 0 : this.observerSlots;\n    let i = observerSlots;\n    while (i-- && this[slotNames[i]] !== observer)\n        ;\n    // if we are not already observing, put the observer in an open slot and subscribe.\n    if (i === -1) {\n        i = 0;\n        while (this[slotNames[i]]) {\n            i++;\n        }\n        this[slotNames[i]] = observer;\n        observer.subscribe(this);\n        observer[this.id] |= 16 /* updateTargetInstance */;\n        // increment the slot count.\n        if (i === observerSlots) {\n            this.observerSlots = i + 1;\n        }\n    }\n    // set the \"version\" when the observer was used.\n    if (this.version == null) {\n        this.version = 0;\n    }\n    this[versionSlotNames[i]] = this.version;\n    ensureEnoughSlotNames(i);\n}\n/** @internal */\nexport function observeProperty(flags, obj, propertyName) {\n    const observer = this.observerLocator.getObserver(flags, obj, propertyName);\n    /* Note: we need to cast here because we can indeed get an accessor instead of an observer,\n     *  in which case the call to observer.subscribe will throw. It's not very clean and we can solve this in 2 ways:\n     *  1. Fail earlier: only let the locator resolve observers from .getObserver, and throw if no branches are left (e.g. it would otherwise return an accessor)\n     *  2. Fail silently (without throwing): give all accessors a no-op subscribe method\n     *\n     * We'll probably want to implement some global configuration (like a \"strict\" toggle) so users can pick between enforced correctness vs. ease-of-use\n     */\n    this.addObserver(observer);\n}\n/** @internal */\nexport function unobserve(all) {\n    const slots = this.observerSlots;\n    let slotName;\n    let observer;\n    if (all === true) {\n        for (let i = 0; i < slots; ++i) {\n            slotName = slotNames[i];\n            observer = this[slotName];\n            if (observer != null) {\n                this[slotName] = void 0;\n                observer.unsubscribe(this);\n                observer[this.id] &= ~16 /* updateTargetInstance */;\n            }\n        }\n    }\n    else {\n        const version = this.version;\n        for (let i = 0; i < slots; ++i) {\n            if (this[versionSlotNames[i]] !== version) {\n                slotName = slotNames[i];\n                observer = this[slotName];\n                if (observer != null) {\n                    this[slotName] = void 0;\n                    observer.unsubscribe(this);\n                    observer[this.id] &= ~16 /* updateTargetInstance */;\n                }\n            }\n        }\n    }\n}\nfunction connectableDecorator(target) {\n    const proto = target.prototype;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'observeProperty'))\n        proto.observeProperty = observeProperty;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'unobserve'))\n        proto.unobserve = unobserve;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'addObserver'))\n        proto.addObserver = addObserver;\n    return target;\n}\nexport function connectable(target) {\n    return target == null ? connectableDecorator : connectableDecorator(target);\n}\nlet value = 0;\nconnectable.assignIdTo = (instance) => {\n    instance.id = ++value;\n};\n//# sourceMappingURL=connectable.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { Registration, Metadata, Protocol, mergeArrays, firstDefined, DI, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nimport { connectable } from '../binding/connectable';\nexport var BindingBehaviorStrategy;\n(function (BindingBehaviorStrategy) {\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"singleton\"] = 1] = \"singleton\";\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"interceptor\"] = 2] = \"interceptor\";\n})(BindingBehaviorStrategy || (BindingBehaviorStrategy = {}));\nexport function bindingBehavior(nameOrDef) {\n    return function (target) {\n        return BindingBehavior.define(nameOrDef, target);\n    };\n}\nexport class BindingBehaviorDefinition {\n    constructor(Type, name, aliases, key, strategy) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.strategy = strategy;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        const inheritsFromInterceptor = Object.getPrototypeOf(Type) === BindingInterceptor;\n        return new BindingBehaviorDefinition(Type, firstDefined(BindingBehavior.getAnnotation(Type, 'name'), name), mergeArrays(BindingBehavior.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingBehavior.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', def, Type, () => inheritsFromInterceptor ? 2 /* interceptor */ : 1 /* singleton */));\n    }\n    register(container) {\n        const { Type, key, aliases, strategy } = this;\n        switch (strategy) {\n            case 1 /* singleton */:\n                Registration.singleton(key, Type).register(container);\n                break;\n            case 2 /* interceptor */:\n                Registration.instance(key, new BindingBehaviorFactory(container, Type)).register(container);\n                break;\n        }\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, BindingBehavior, key, container);\n    }\n}\nexport class BindingBehaviorFactory {\n    constructor(container, Type) {\n        this.container = container;\n        this.Type = Type;\n        this.deps = DI.getDependencies(Type);\n    }\n    construct(binding, expr) {\n        const container = this.container;\n        const deps = this.deps;\n        switch (deps.length) {\n            case 0:\n            case 1:\n            case 2:\n                return new this.Type(binding, expr);\n            case 3:\n                return new this.Type(container.get(deps[0]), binding, expr);\n            case 4:\n                return new this.Type(container.get(deps[0]), container.get(deps[1]), binding, expr);\n            default:\n                return new this.Type(...deps.map(d => container.get(d)), binding, expr);\n        }\n    }\n}\nlet BindingInterceptor = class BindingInterceptor {\n    constructor(binding, expr) {\n        this.binding = binding;\n        this.expr = expr;\n        this.interceptor = this;\n        let interceptor;\n        while (binding.interceptor !== this) {\n            interceptor = binding.interceptor;\n            binding.interceptor = this;\n            binding = interceptor;\n        }\n    }\n    get id() {\n        return this.binding.id;\n    }\n    get observerLocator() {\n        return this.binding.observerLocator;\n    }\n    get locator() {\n        return this.binding.locator;\n    }\n    get $scope() {\n        return this.binding.$scope;\n    }\n    get part() {\n        return this.binding.part;\n    }\n    get $state() {\n        return this.binding.$state;\n    }\n    updateTarget(value, flags) {\n        this.binding.updateTarget(value, flags);\n    }\n    updateSource(value, flags) {\n        this.binding.updateSource(value, flags);\n    }\n    callSource(args) {\n        return this.binding.callSource(args);\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.binding.handleChange(newValue, previousValue, flags);\n    }\n    $bind(flags, scope, part) {\n        this.binding.$bind(flags, scope, part);\n    }\n    $unbind(flags) {\n        this.binding.$unbind(flags);\n    }\n};\nBindingInterceptor = __decorate([\n    connectable,\n    __metadata(\"design:paramtypes\", [Object, Object])\n], BindingInterceptor);\nexport { BindingInterceptor };\nexport const BindingBehavior = {\n    name: Protocol.resource.keyFor('binding-behavior'),\n    keyFrom(name) {\n        return `${BindingBehavior.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingBehavior.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingBehaviorDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingBehavior.name, definition, definition.Type);\n        Metadata.define(BindingBehavior.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingBehavior.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingBehavior.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=binding-behavior.js.map","import { Registration, Metadata, Protocol, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nexport function valueConverter(nameOrDef) {\n    return function (target) {\n        return ValueConverter.define(nameOrDef, target);\n    };\n}\nexport class ValueConverterDefinition {\n    constructor(Type, name, aliases, key) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new ValueConverterDefinition(Type, firstDefined(ValueConverter.getAnnotation(Type, 'name'), name), mergeArrays(ValueConverter.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), ValueConverter.keyFrom(name));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, ValueConverter, key, container);\n    }\n}\nexport const ValueConverter = {\n    name: Protocol.resource.keyFor('value-converter'),\n    keyFrom(name) {\n        return `${ValueConverter.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(ValueConverter.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = ValueConverterDefinition.create(nameOrDef, Type);\n        Metadata.define(ValueConverter.name, definition, definition.Type);\n        Metadata.define(ValueConverter.name, definition, definition);\n        Protocol.resource.appendTo(Type, ValueConverter.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(ValueConverter.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=value-converter.js.map","import { PLATFORM, Reporter, isNumberOrBigInt, isStringOrDate, } from '@aurelia/kernel';\nimport { BindingContext } from '../observation/binding-context';\nimport { ProxyObserver } from '../observation/proxy-observer';\nimport { ISignaler } from '../observation/signaler';\nimport { BindingBehavior, BindingBehaviorFactory, } from '../resources/binding-behavior';\nimport { ValueConverter, } from '../resources/value-converter';\nexport function connects(expr) {\n    return (expr.$kind & 32 /* Connects */) === 32 /* Connects */;\n}\nexport function observes(expr) {\n    return (expr.$kind & 64 /* Observes */) === 64 /* Observes */;\n}\nexport function callsFunction(expr) {\n    return (expr.$kind & 128 /* CallsFunction */) === 128 /* CallsFunction */;\n}\nexport function hasAncestor(expr) {\n    return (expr.$kind & 256 /* HasAncestor */) === 256 /* HasAncestor */;\n}\nexport function isAssignable(expr) {\n    return (expr.$kind & 8192 /* IsAssignable */) === 8192 /* IsAssignable */;\n}\nexport function isLeftHandSide(expr) {\n    return (expr.$kind & 1024 /* IsLeftHandSide */) === 1024 /* IsLeftHandSide */;\n}\nexport function isPrimary(expr) {\n    return (expr.$kind & 512 /* IsPrimary */) === 512 /* IsPrimary */;\n}\nexport function isResource(expr) {\n    return (expr.$kind & 32768 /* IsResource */) === 32768 /* IsResource */;\n}\nexport function hasBind(expr) {\n    return (expr.$kind & 2048 /* HasBind */) === 2048 /* HasBind */;\n}\nexport function hasUnbind(expr) {\n    return (expr.$kind & 4096 /* HasUnbind */) === 4096 /* HasUnbind */;\n}\nexport function isLiteral(expr) {\n    return (expr.$kind & 16384 /* IsLiteral */) === 16384 /* IsLiteral */;\n}\nexport function arePureLiterals(expressions) {\n    if (expressions === void 0 || expressions.length === 0) {\n        return true;\n    }\n    for (let i = 0; i < expressions.length; ++i) {\n        if (!isPureLiteral(expressions[i])) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function isPureLiteral(expr) {\n    if (isLiteral(expr)) {\n        switch (expr.$kind) {\n            case 17955 /* ArrayLiteral */:\n                return arePureLiterals(expr.elements);\n            case 17956 /* ObjectLiteral */:\n                return arePureLiterals(expr.values);\n            case 17958 /* Template */:\n                return arePureLiterals(expr.expressions);\n            case 17925 /* PrimitiveLiteral */:\n                return true;\n        }\n    }\n    return false;\n}\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NoLocator\"] = 202] = \"NoLocator\";\n    RuntimeError[RuntimeError[\"NoBehaviorFound\"] = 203] = \"NoBehaviorFound\";\n    RuntimeError[RuntimeError[\"BehaviorAlreadyApplied\"] = 204] = \"BehaviorAlreadyApplied\";\n    RuntimeError[RuntimeError[\"NoConverterFound\"] = 205] = \"NoConverterFound\";\n    RuntimeError[RuntimeError[\"NoBinding\"] = 206] = \"NoBinding\";\n    RuntimeError[RuntimeError[\"NotAFunction\"] = 207] = \"NotAFunction\";\n    RuntimeError[RuntimeError[\"UnknownOperator\"] = 208] = \"UnknownOperator\";\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n})(RuntimeError || (RuntimeError = {}));\nexport class CustomExpression {\n    constructor(value) {\n        this.value = value;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n}\nexport class BindingBehaviorExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 38962 /* BindingBehavior */;\n        this.behaviorKey = BindingBehavior.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        if (hasBind(this.expression)) {\n            this.expression.bind(flags, scope, binding);\n        }\n        const behaviorKey = this.behaviorKey;\n        const behavior = locator.get(behaviorKey);\n        if (!behavior) {\n            throw Reporter.error(203 /* NoBehaviorFound */, this);\n        }\n        if (!(behavior instanceof BindingBehaviorFactory)) {\n            if (binding[behaviorKey] === void 0) {\n                binding[behaviorKey] = behavior;\n                behavior.bind.call(behavior, flags, scope, binding, ...evalList(flags, scope, locator, this.args));\n            }\n            else {\n                Reporter.write(204 /* BehaviorAlreadyApplied */, this);\n            }\n        }\n    }\n    unbind(flags, scope, binding) {\n        const behaviorKey = this.behaviorKey;\n        if (binding[behaviorKey] !== void 0) {\n            binding[behaviorKey].unbind(flags, scope, binding);\n            binding[behaviorKey] = void 0;\n        }\n        if (hasUnbind(this.expression)) {\n            this.expression.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitBindingBehavior(this);\n    }\n}\nexport class ValueConverterExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 36913 /* ValueConverter */;\n        this.converterKey = ValueConverter.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('toView' in converter) {\n            const args = this.args;\n            const len = args.length;\n            const result = Array(len + 1);\n            result[0] = this.expression.evaluate(flags, scope, locator, part);\n            for (let i = 0; i < len; ++i) {\n                result[i + 1] = args[i].evaluate(flags, scope, locator, part);\n            }\n            return converter.toView.call(converter, ...result);\n        }\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('fromView' in converter) {\n            value = converter.fromView.call(converter, value, ...(evalList(flags, scope, locator, this.args)));\n        }\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        this.expression.connect(flags, scope, binding, part);\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.addSignalListener(signals[i], binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const locator = binding.locator;\n        const converter = locator.get(this.converterKey);\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.removeSignalListener(signals[i], binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitValueConverter(this);\n    }\n}\nexport class AssignExpression {\n    constructor(target, value) {\n        this.target = target;\n        this.value = value;\n        this.$kind = 8208 /* Assign */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.target.assign(flags, scope, locator, this.value.evaluate(flags, scope, locator), part);\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    assign(flags, scope, locator, value, part) {\n        this.value.assign(flags, scope, locator, value, part);\n        return this.target.assign(flags, scope, locator, value, part);\n    }\n    accept(visitor) {\n        return visitor.visitAssign(this);\n    }\n}\nexport class ConditionalExpression {\n    constructor(condition, yes, no) {\n        this.condition = condition;\n        this.yes = yes;\n        this.no = no;\n        this.$kind = 63 /* Conditional */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return (!!this.condition.evaluate(flags, scope, locator, part))\n            ? this.yes.evaluate(flags, scope, locator, part)\n            : this.no.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const condition = this.condition;\n        if (condition.evaluate(flags, scope, null, part)) {\n            this.condition.connect(flags, scope, binding, part);\n            this.yes.connect(flags, scope, binding, part);\n        }\n        else {\n            this.condition.connect(flags, scope, binding, part);\n            this.no.connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitConditional(this);\n    }\n}\nexport class AccessThisExpression {\n    constructor(ancestor = 0) {\n        this.ancestor = ancestor;\n        this.$kind = 1793 /* AccessThis */;\n    }\n    evaluate(flags, scope, locator, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (!parent.scopeParts.includes(part)) {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope cold be found for part \"${part}\"`);\n            }\n        }\n        let oc = scope.overrideContext;\n        let i = this.ancestor;\n        while (i-- && oc) {\n            oc = oc.parentOverrideContext;\n        }\n        return i < 1 && oc ? oc.bindingContext : void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitAccessThis(this);\n    }\n}\nAccessThisExpression.$this = new AccessThisExpression(0);\nAccessThisExpression.$parent = new AccessThisExpression(1);\nexport class AccessScopeExpression {\n    constructor(name, ancestor = 0) {\n        this.name = name;\n        this.ancestor = ancestor;\n        this.$kind = 10082 /* AccessScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const evaluatedValue = obj[this.name];\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return evaluatedValue;\n        }\n        return evaluatedValue == null ? '' : evaluatedValue;\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n                return value;\n            }\n            else {\n                return obj[this.name] = value;\n            }\n        }\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        binding.observeProperty(flags, context, this.name);\n    }\n    accept(visitor) {\n        return visitor.visitAccessScope(this);\n    }\n}\nexport class AccessMemberExpression {\n    constructor(object, name) {\n        this.object = object;\n        this.name = name;\n        this.$kind = 9323 /* AccessMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return instance == null ? instance : instance[this.name];\n        }\n        return instance ? instance[this.name] : '';\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = this.object.evaluate(flags, scope, locator, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n            }\n            else {\n                obj[this.name] = value;\n            }\n        }\n        else {\n            this.object.assign(flags, scope, locator, { [this.name]: value });\n        }\n        return value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            binding.observeProperty(flags, obj, this.name);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessMember(this);\n    }\n}\nexport class AccessKeyedExpression {\n    constructor(object, key) {\n        this.object = object;\n        this.key = key;\n        this.$kind = 9324 /* AccessKeyed */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (instance instanceof Object) {\n            const key = this.key.evaluate(flags, scope, locator, part);\n            return instance[key];\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, value, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const key = this.key.evaluate(flags, scope, locator, part);\n        return instance[key] = value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            this.key.connect(flags, scope, binding, part);\n            const key = this.key.evaluate(flags, scope, null, part);\n            // (note: string indexers behave the same way as numeric indexers as long as they represent numbers)\n            binding.observeProperty(flags, obj, key);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessKeyed(this);\n    }\n}\nexport class CallScopeExpression {\n    constructor(name, args, ancestor = 0) {\n        this.name = name;\n        this.args = args;\n        this.ancestor = ancestor;\n        this.$kind = 1448 /* CallScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const args = evalList(flags, scope, locator, this.args, part);\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const func = getFunction(flags, context, this.name);\n        if (func) {\n            return func.apply(context, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallScope(this);\n    }\n}\nexport class CallMemberExpression {\n    constructor(object, name, args) {\n        this.object = object;\n        this.name = name;\n        this.args = args;\n        this.$kind = 1161 /* CallMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const args = evalList(flags, scope, locator, this.args, part);\n        const func = getFunction(flags, instance, this.name);\n        if (func) {\n            return func.apply(instance, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (getFunction(flags & ~2097152 /* mustEvaluate */, obj, this.name)) {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallMember(this);\n    }\n}\nexport class CallFunctionExpression {\n    constructor(func, args) {\n        this.func = func;\n        this.args = args;\n        this.$kind = 1162 /* CallFunction */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func === 'function') {\n            return func(...evalList(flags, scope, locator, this.args, part));\n        }\n        if (!(flags & 2097152 /* mustEvaluate */) && (func == null)) {\n            return void 0;\n        }\n        throw Reporter.error(207 /* NotAFunction */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const func = this.func.evaluate(flags, scope, null, part);\n        this.func.connect(flags, scope, binding, part);\n        if (typeof func === 'function') {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallFunction(this);\n    }\n}\nexport class BinaryExpression {\n    constructor(operation, left, right) {\n        this.operation = operation;\n        this.left = left;\n        this.right = right;\n        this.$kind = 46 /* Binary */;\n        // what we're doing here is effectively moving the large switch statement from evaluate to the constructor\n        // so that the check only needs to be done once, and evaluate (which is called many times) will have a lot less\n        // work to do; we can do this because the operation can't change after it's parsed\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.left.connect(flags, scope, binding, part);\n        this.right.connect(flags, scope, binding, part);\n    }\n    ['&&'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) && this.right.evaluate(f, s, l, p);\n    }\n    ['||'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) || this.right.evaluate(f, s, l, p);\n    }\n    ['=='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) == this.right.evaluate(f, s, l, p);\n    }\n    ['==='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) === this.right.evaluate(f, s, l, p);\n    }\n    ['!='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) != this.right.evaluate(f, s, l, p);\n    }\n    ['!=='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) !== this.right.evaluate(f, s, l, p);\n    }\n    ['instanceof'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (typeof right === 'function') {\n            return this.left.evaluate(f, s, l, p) instanceof right;\n        }\n        return false;\n    }\n    ['in'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (right instanceof Object) {\n            return this.left.evaluate(f, s, l, p) in right;\n        }\n        return false;\n    }\n    // note: autoConvertAdd (and the null check) is removed because the default spec behavior is already largely similar\n    // and where it isn't, you kind of want it to behave like the spec anyway (e.g. return NaN when adding a number to undefined)\n    // this makes bugs in user code easier to track down for end users\n    // also, skipping these checks and leaving it to the runtime is a nice little perf boost and simplifies our code\n    ['+'](f, s, l, p) {\n        const left = this.left.evaluate(f, s, l, p);\n        const right = this.right.evaluate(f, s, l, p);\n        if ((f & 4 /* isStrictBindingStrategy */) > 0) {\n            return left + right;\n        }\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (!left || !right) {\n            if (isNumberOrBigInt(left) || isNumberOrBigInt(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || 0) + (right || 0);\n            }\n            if (isStringOrDate(left) || isStringOrDate(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || '') + (right || '');\n            }\n        }\n        return left + right;\n    }\n    ['-'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) - this.right.evaluate(f, s, l, p);\n    }\n    ['*'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) * this.right.evaluate(f, s, l, p);\n    }\n    ['/'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) / this.right.evaluate(f, s, l, p);\n    }\n    ['%'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) % this.right.evaluate(f, s, l, p);\n    }\n    ['<'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) < this.right.evaluate(f, s, l, p);\n    }\n    ['>'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) > this.right.evaluate(f, s, l, p);\n    }\n    ['<='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) <= this.right.evaluate(f, s, l, p);\n    }\n    ['>='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) >= this.right.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitBinary(this);\n    }\n}\nexport class UnaryExpression {\n    constructor(operation, expression) {\n        this.operation = operation;\n        this.expression = expression;\n        this.$kind = 39 /* Unary */;\n        // see Binary (we're doing the same thing here)\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    ['void'](f, s, l, p) {\n        return void this.expression.evaluate(f, s, l, p);\n    }\n    ['typeof'](f, s, l, p) {\n        return typeof this.expression.evaluate(f | 4 /* isStrictBindingStrategy */, s, l, p);\n    }\n    ['!'](f, s, l, p) {\n        return !this.expression.evaluate(f, s, l, p);\n    }\n    ['-'](f, s, l, p) {\n        return -this.expression.evaluate(f, s, l, p);\n    }\n    ['+'](f, s, l, p) {\n        return +this.expression.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitUnary(this);\n    }\n}\nexport class PrimitiveLiteralExpression {\n    constructor(value) {\n        this.value = value;\n        this.$kind = 17925 /* PrimitiveLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitPrimitiveLiteral(this);\n    }\n}\nPrimitiveLiteralExpression.$undefined = new PrimitiveLiteralExpression(void 0);\nPrimitiveLiteralExpression.$null = new PrimitiveLiteralExpression(null);\nPrimitiveLiteralExpression.$true = new PrimitiveLiteralExpression(true);\nPrimitiveLiteralExpression.$false = new PrimitiveLiteralExpression(false);\nPrimitiveLiteralExpression.$empty = new PrimitiveLiteralExpression('');\nexport class HtmlLiteralExpression {\n    constructor(parts) {\n        this.parts = parts;\n        this.$kind = 51 /* HtmlLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.parts;\n        let result = '';\n        let value;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            value = elements[i].evaluate(flags, scope, locator, part);\n            if (value == null) {\n                continue;\n            }\n            result += value;\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        for (let i = 0, ii = this.parts.length; i < ii; ++i) {\n            this.parts[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitHtmlLiteral(this);\n    }\n}\nexport class ArrayLiteralExpression {\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 17955 /* ArrayLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.elements;\n        const length = elements.length;\n        const result = Array(length);\n        for (let i = 0; i < length; ++i) {\n            result[i] = elements[i].evaluate(flags, scope, locator, part);\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const elements = this.elements;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            elements[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitArrayLiteral(this);\n    }\n}\nArrayLiteralExpression.$empty = new ArrayLiteralExpression(PLATFORM.emptyArray);\nexport class ObjectLiteralExpression {\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 17956 /* ObjectLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = {};\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            instance[keys[i]] = values[i].evaluate(flags, scope, locator, part);\n        }\n        return instance;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            values[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitObjectLiteral(this);\n    }\n}\nObjectLiteralExpression.$empty = new ObjectLiteralExpression(PLATFORM.emptyArray, PLATFORM.emptyArray);\nexport class TemplateExpression {\n    constructor(cooked, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.expressions = expressions;\n        this.$kind = 17958 /* Template */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const cooked = this.cooked;\n        let result = cooked[0];\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            result += expressions[i].evaluate(flags, scope, locator, part);\n            result += cooked[i + 1];\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding, part);\n            i++;\n        }\n    }\n    accept(visitor) {\n        return visitor.visitTemplate(this);\n    }\n}\nTemplateExpression.$empty = new TemplateExpression(['']);\nexport class TaggedTemplateExpression {\n    constructor(cooked, raw, func, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.func = func;\n        this.expressions = expressions;\n        this.$kind = 1197 /* TaggedTemplate */;\n        cooked.raw = raw;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const len = expressions.length;\n        const results = Array(len);\n        for (let i = 0, ii = len; i < ii; ++i) {\n            results[i] = expressions[i].evaluate(flags, scope, locator, part);\n        }\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func !== 'function') {\n            throw Reporter.error(207 /* NotAFunction */, this);\n        }\n        return func(this.cooked, ...results);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding);\n        }\n        this.func.connect(flags, scope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitTaggedTemplate(this);\n    }\n}\nexport class ArrayBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 65556 /* ArrayBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitArrayBindingPattern(this);\n    }\n}\nexport class ObjectBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 65557 /* ObjectBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitObjectBindingPattern(this);\n    }\n}\nexport class BindingIdentifier {\n    constructor(name) {\n        this.name = name;\n        this.$kind = 65558 /* BindingIdentifier */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.name;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitBindingIdentifier(this);\n    }\n}\nconst toStringTag = Object.prototype.toString;\n// https://tc39.github.io/ecma262/#sec-iteration-statements\n// https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements\nexport class ForOfStatement {\n    constructor(declaration, iterable) {\n        this.declaration = declaration;\n        this.iterable = iterable;\n        this.$kind = 6199 /* ForOfStatement */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.iterable.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    count(flags, result) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return result.length;\n            case '[object Map]': return result.size;\n            case '[object Set]': return result.size;\n            case '[object Number]': return result;\n            case '[object Null]': return 0;\n            case '[object Undefined]': return 0;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    iterate(flags, result, func) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return $array(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Map]': return $map(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Set]': return $set(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Number]': return $number(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Null]': return;\n            case '[object Undefined]': return;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    connect(flags, scope, binding, part) {\n        this.declaration.connect(flags, scope, binding, part);\n        this.iterable.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (hasBind(this.iterable)) {\n            this.iterable.bind(flags, scope, binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        if (hasUnbind(this.iterable)) {\n            this.iterable.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitForOfStatement(this);\n    }\n}\n/*\n* Note: this implementation is far simpler than the one in vCurrent and might be missing important stuff (not sure yet)\n* so while this implementation is identical to Template and we could reuse that one, we don't want to lock outselves in to potentially the wrong abstraction\n* but this class might be a candidate for removal if it turns out it does provide all we need\n*/\nexport class Interpolation {\n    constructor(parts, expressions = PLATFORM.emptyArray) {\n        this.parts = parts;\n        this.expressions = expressions;\n        this.$kind = 24 /* Interpolation */;\n        this.isMulti = expressions.length > 1;\n        this.firstExpression = expressions[0];\n    }\n    evaluate(flags, scope, locator, part) {\n        if (this.isMulti) {\n            const expressions = this.expressions;\n            const parts = this.parts;\n            let result = parts[0];\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                result += expressions[i].evaluate(flags, scope, locator, part);\n                result += parts[i + 1];\n            }\n            return result;\n        }\n        else {\n            const parts = this.parts;\n            return `${parts[0]}${this.firstExpression.evaluate(flags, scope, locator, part)}${parts[1]}`;\n        }\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitInterpolation(this);\n    }\n}\n/// Evaluate the [list] in context of the [scope].\nfunction evalList(flags, scope, locator, list, part) {\n    const len = list.length;\n    const result = Array(len);\n    for (let i = 0; i < len; ++i) {\n        result[i] = list[i].evaluate(flags, scope, locator, part);\n    }\n    return result;\n}\nfunction getFunction(flags, obj, name) {\n    const func = obj == null ? null : obj[name];\n    if (typeof func === 'function') {\n        return func;\n    }\n    if (!(flags & 2097152 /* mustEvaluate */) && func == null) {\n        return null;\n    }\n    throw Reporter.error(207 /* NotAFunction */, obj, name, func);\n}\nconst proxyAndOriginalArray = 2 /* proxyStrategy */ | 8388608 /* isOriginalArray */;\nfunction $array(flags, result, func) {\n    if ((flags & proxyAndOriginalArray) === proxyAndOriginalArray) {\n        // If we're in proxy mode, and the array is the original \"items\" (and not an array we created here to iterate over e.g. a set)\n        // then replace all items (which are Objects) with proxies so their properties are observed in the source view model even if no\n        // observers are explicitly created\n        const rawArray = ProxyObserver.getRawIfProxy(result);\n        const len = rawArray.length;\n        let item;\n        let i = 0;\n        for (; i < len; ++i) {\n            item = rawArray[i];\n            if (item instanceof Object) {\n                item = rawArray[i] = ProxyObserver.getOrCreate(item).proxy;\n            }\n            func(rawArray, i, item);\n        }\n    }\n    else {\n        for (let i = 0, ii = result.length; i < ii; ++i) {\n            func(result, i, result[i]);\n        }\n    }\n}\nfunction $map(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const entry of result.entries()) {\n        arr[++i] = entry;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $set(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const key of result.keys()) {\n        arr[++i] = key;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $number(flags, result, func) {\n    const arr = Array(result);\n    for (let i = 0; i < result; ++i) {\n        arr[i] = i;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\n//# sourceMappingURL=ast.js.map","/*\n* Note: the oneTime binding now has a non-zero value for 2 reasons:\n*  - plays nicer with bitwise operations (more consistent code, more explicit settings)\n*  - allows for potentially having something like BindingMode.oneTime | BindingMode.fromView, where an initial value is set once to the view but updates from the view also propagate back to the view model\n*\n* Furthermore, the \"default\" mode would be for simple \".bind\" expressions to make it explicit for our logic that the default is being used.\n* This essentially adds extra information which binding could use to do smarter things and allows bindingBehaviors that add a mode instead of simply overwriting it\n*/\nexport var BindingMode;\n(function (BindingMode) {\n    BindingMode[BindingMode[\"oneTime\"] = 1] = \"oneTime\";\n    BindingMode[BindingMode[\"toView\"] = 2] = \"toView\";\n    BindingMode[BindingMode[\"fromView\"] = 4] = \"fromView\";\n    BindingMode[BindingMode[\"twoWay\"] = 6] = \"twoWay\";\n    BindingMode[BindingMode[\"default\"] = 8] = \"default\";\n})(BindingMode || (BindingMode = {}));\nexport var BindingStrategy;\n(function (BindingStrategy) {\n    /**\n     * Configures all components \"below\" this one to operate in getterSetter binding mode.\n     * This is the default; if no strategy is specified, this one is implied.\n     *\n     * This strategy is the most compatible, convenient and has the best performance on frequently updated bindings on components that are infrequently replaced.\n     * However, it also consumes the most resources on initialization.\n     */\n    BindingStrategy[BindingStrategy[\"getterSetter\"] = 1] = \"getterSetter\";\n    /**\n     * Configures all components \"below\" this one to operate in proxy binding mode.\n     * No getters/setters are created.\n     *\n     * This strategy consumes significantly fewer resources than `getterSetter` on initialization and has the best performance on infrequently updated bindings on\n     * components that are frequently replaced.\n     * However, it consumes more resources on updates.\n     */\n    BindingStrategy[BindingStrategy[\"proxies\"] = 2] = \"proxies\";\n})(BindingStrategy || (BindingStrategy = {}));\nconst mandatoryStrategy = 1 /* getterSetter */ | 2 /* proxies */;\nexport function ensureValidStrategy(strategy) {\n    if ((strategy & mandatoryStrategy) === 0) {\n        // TODO: probably want to validate that user isn't trying to mix getterSetter/proxy\n        // TODO: also need to make sure that strategy can be changed away from proxies inside the component tree (not here though, but just making a note)\n        return strategy | 1 /* getterSetter */;\n    }\n    return strategy;\n}\nexport var State;\n(function (State) {\n    State[State[\"none\"] = 0] = \"none\";\n    State[State[\"isBinding\"] = 1] = \"isBinding\";\n    State[State[\"isUnbinding\"] = 2] = \"isUnbinding\";\n    State[State[\"isBound\"] = 4] = \"isBound\";\n    State[State[\"isBoundOrBinding\"] = 5] = \"isBoundOrBinding\";\n    State[State[\"isBoundOrUnbinding\"] = 6] = \"isBoundOrUnbinding\";\n    State[State[\"isAttaching\"] = 8] = \"isAttaching\";\n    State[State[\"isDetaching\"] = 16] = \"isDetaching\";\n    State[State[\"isAttached\"] = 32] = \"isAttached\";\n    State[State[\"isAttachedOrAttaching\"] = 40] = \"isAttachedOrAttaching\";\n    State[State[\"isAttachedOrDetaching\"] = 48] = \"isAttachedOrDetaching\";\n    State[State[\"isMounted\"] = 64] = \"isMounted\";\n    State[State[\"hasLockedScope\"] = 256] = \"hasLockedScope\";\n    State[State[\"canBeCached\"] = 512] = \"canBeCached\";\n})(State || (State = {}));\nexport var LifecycleFlags;\n(function (LifecycleFlags) {\n    LifecycleFlags[LifecycleFlags[\"none\"] = 0] = \"none\";\n    // Bitmask for flags that need to be stored on a binding during $bind for mutation\n    // callbacks outside of $bind\n    LifecycleFlags[LifecycleFlags[\"persistentBindingFlags\"] = 2080374799] = \"persistentBindingFlags\";\n    LifecycleFlags[LifecycleFlags[\"allowParentScopeTraversal\"] = 67108864] = \"allowParentScopeTraversal\";\n    LifecycleFlags[LifecycleFlags[\"observeLeafPropertiesOnly\"] = 134217728] = \"observeLeafPropertiesOnly\";\n    LifecycleFlags[LifecycleFlags[\"targetObserverFlags\"] = 805306383] = \"targetObserverFlags\";\n    LifecycleFlags[LifecycleFlags[\"noTargetObserverQueue\"] = 268435456] = \"noTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"persistentTargetObserverQueue\"] = 536870912] = \"persistentTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"secondaryExpression\"] = 1073741824] = \"secondaryExpression\";\n    LifecycleFlags[LifecycleFlags[\"bindingStrategy\"] = 15] = \"bindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"getterSetterStrategy\"] = 1] = \"getterSetterStrategy\";\n    LifecycleFlags[LifecycleFlags[\"proxyStrategy\"] = 2] = \"proxyStrategy\";\n    LifecycleFlags[LifecycleFlags[\"isStrictBindingStrategy\"] = 4] = \"isStrictBindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"update\"] = 48] = \"update\";\n    LifecycleFlags[LifecycleFlags[\"updateTargetInstance\"] = 16] = \"updateTargetInstance\";\n    LifecycleFlags[LifecycleFlags[\"updateSourceExpression\"] = 32] = \"updateSourceExpression\";\n    LifecycleFlags[LifecycleFlags[\"from\"] = 524224] = \"from\";\n    LifecycleFlags[LifecycleFlags[\"fromFlush\"] = 960] = \"fromFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromAsyncFlush\"] = 64] = \"fromAsyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromSyncFlush\"] = 128] = \"fromSyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromTick\"] = 256] = \"fromTick\";\n    LifecycleFlags[LifecycleFlags[\"fromBatch\"] = 512] = \"fromBatch\";\n    LifecycleFlags[LifecycleFlags[\"fromStartTask\"] = 1024] = \"fromStartTask\";\n    LifecycleFlags[LifecycleFlags[\"fromStopTask\"] = 2048] = \"fromStopTask\";\n    LifecycleFlags[LifecycleFlags[\"fromBind\"] = 4096] = \"fromBind\";\n    LifecycleFlags[LifecycleFlags[\"fromUnbind\"] = 8192] = \"fromUnbind\";\n    LifecycleFlags[LifecycleFlags[\"fromAttach\"] = 16384] = \"fromAttach\";\n    LifecycleFlags[LifecycleFlags[\"fromDetach\"] = 32768] = \"fromDetach\";\n    LifecycleFlags[LifecycleFlags[\"fromCache\"] = 65536] = \"fromCache\";\n    LifecycleFlags[LifecycleFlags[\"fromDOMEvent\"] = 131072] = \"fromDOMEvent\";\n    LifecycleFlags[LifecycleFlags[\"fromLifecycleTask\"] = 262144] = \"fromLifecycleTask\";\n    LifecycleFlags[LifecycleFlags[\"allowPublishRoundtrip\"] = 524288] = \"allowPublishRoundtrip\";\n    LifecycleFlags[LifecycleFlags[\"isPublishing\"] = 1048576] = \"isPublishing\";\n    LifecycleFlags[LifecycleFlags[\"mustEvaluate\"] = 2097152] = \"mustEvaluate\";\n    LifecycleFlags[LifecycleFlags[\"isTraversingParentScope\"] = 4194304] = \"isTraversingParentScope\";\n    LifecycleFlags[LifecycleFlags[\"isOriginalArray\"] = 8388608] = \"isOriginalArray\";\n    LifecycleFlags[LifecycleFlags[\"isCollectionMutation\"] = 16777216] = \"isCollectionMutation\";\n    LifecycleFlags[LifecycleFlags[\"reorderNodes\"] = 33554432] = \"reorderNodes\";\n})(LifecycleFlags || (LifecycleFlags = {}));\nexport var ExpressionKind;\n(function (ExpressionKind) {\n    ExpressionKind[ExpressionKind[\"Connects\"] = 32] = \"Connects\";\n    ExpressionKind[ExpressionKind[\"Observes\"] = 64] = \"Observes\";\n    ExpressionKind[ExpressionKind[\"CallsFunction\"] = 128] = \"CallsFunction\";\n    ExpressionKind[ExpressionKind[\"HasAncestor\"] = 256] = \"HasAncestor\";\n    ExpressionKind[ExpressionKind[\"IsPrimary\"] = 512] = \"IsPrimary\";\n    ExpressionKind[ExpressionKind[\"IsLeftHandSide\"] = 1024] = \"IsLeftHandSide\";\n    ExpressionKind[ExpressionKind[\"HasBind\"] = 2048] = \"HasBind\";\n    ExpressionKind[ExpressionKind[\"HasUnbind\"] = 4096] = \"HasUnbind\";\n    ExpressionKind[ExpressionKind[\"IsAssignable\"] = 8192] = \"IsAssignable\";\n    ExpressionKind[ExpressionKind[\"IsLiteral\"] = 16384] = \"IsLiteral\";\n    ExpressionKind[ExpressionKind[\"IsResource\"] = 32768] = \"IsResource\";\n    ExpressionKind[ExpressionKind[\"IsForDeclaration\"] = 65536] = \"IsForDeclaration\";\n    ExpressionKind[ExpressionKind[\"Type\"] = 31] = \"Type\";\n    // ---------------------------------------------------------------------------------------------------------------------------\n    ExpressionKind[ExpressionKind[\"AccessThis\"] = 1793] = \"AccessThis\";\n    ExpressionKind[ExpressionKind[\"AccessScope\"] = 10082] = \"AccessScope\";\n    ExpressionKind[ExpressionKind[\"ArrayLiteral\"] = 17955] = \"ArrayLiteral\";\n    ExpressionKind[ExpressionKind[\"ObjectLiteral\"] = 17956] = \"ObjectLiteral\";\n    ExpressionKind[ExpressionKind[\"PrimitiveLiteral\"] = 17925] = \"PrimitiveLiteral\";\n    ExpressionKind[ExpressionKind[\"Template\"] = 17958] = \"Template\";\n    ExpressionKind[ExpressionKind[\"Unary\"] = 39] = \"Unary\";\n    ExpressionKind[ExpressionKind[\"CallScope\"] = 1448] = \"CallScope\";\n    ExpressionKind[ExpressionKind[\"CallMember\"] = 1161] = \"CallMember\";\n    ExpressionKind[ExpressionKind[\"CallFunction\"] = 1162] = \"CallFunction\";\n    ExpressionKind[ExpressionKind[\"AccessMember\"] = 9323] = \"AccessMember\";\n    ExpressionKind[ExpressionKind[\"AccessKeyed\"] = 9324] = \"AccessKeyed\";\n    ExpressionKind[ExpressionKind[\"TaggedTemplate\"] = 1197] = \"TaggedTemplate\";\n    ExpressionKind[ExpressionKind[\"Binary\"] = 46] = \"Binary\";\n    ExpressionKind[ExpressionKind[\"Conditional\"] = 63] = \"Conditional\";\n    ExpressionKind[ExpressionKind[\"Assign\"] = 8208] = \"Assign\";\n    ExpressionKind[ExpressionKind[\"ValueConverter\"] = 36913] = \"ValueConverter\";\n    ExpressionKind[ExpressionKind[\"BindingBehavior\"] = 38962] = \"BindingBehavior\";\n    ExpressionKind[ExpressionKind[\"HtmlLiteral\"] = 51] = \"HtmlLiteral\";\n    ExpressionKind[ExpressionKind[\"ArrayBindingPattern\"] = 65556] = \"ArrayBindingPattern\";\n    ExpressionKind[ExpressionKind[\"ObjectBindingPattern\"] = 65557] = \"ObjectBindingPattern\";\n    ExpressionKind[ExpressionKind[\"BindingIdentifier\"] = 65558] = \"BindingIdentifier\";\n    ExpressionKind[ExpressionKind[\"ForOfStatement\"] = 6199] = \"ForOfStatement\";\n    ExpressionKind[ExpressionKind[\"Interpolation\"] = 24] = \"Interpolation\"; //\n})(ExpressionKind || (ExpressionKind = {}));\n//# sourceMappingURL=flags.js.map","/** @internal */\nexport var SubscriberFlags;\n(function (SubscriberFlags) {\n    SubscriberFlags[SubscriberFlags[\"None\"] = 0] = \"None\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber0\"] = 1] = \"Subscriber0\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber1\"] = 2] = \"Subscriber1\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber2\"] = 4] = \"Subscriber2\";\n    SubscriberFlags[SubscriberFlags[\"SubscribersRest\"] = 8] = \"SubscribersRest\";\n    SubscriberFlags[SubscriberFlags[\"Any\"] = 15] = \"Any\";\n})(SubscriberFlags || (SubscriberFlags = {}));\nexport var DelegationStrategy;\n(function (DelegationStrategy) {\n    DelegationStrategy[DelegationStrategy[\"none\"] = 0] = \"none\";\n    DelegationStrategy[DelegationStrategy[\"capturing\"] = 1] = \"capturing\";\n    DelegationStrategy[DelegationStrategy[\"bubbling\"] = 2] = \"bubbling\";\n})(DelegationStrategy || (DelegationStrategy = {}));\nexport var CollectionKind;\n(function (CollectionKind) {\n    CollectionKind[CollectionKind[\"indexed\"] = 8] = \"indexed\";\n    CollectionKind[CollectionKind[\"keyed\"] = 4] = \"keyed\";\n    CollectionKind[CollectionKind[\"array\"] = 9] = \"array\";\n    CollectionKind[CollectionKind[\"map\"] = 6] = \"map\";\n    CollectionKind[CollectionKind[\"set\"] = 7] = \"set\";\n})(CollectionKind || (CollectionKind = {}));\nexport function copyIndexMap(existing, deletedItems) {\n    const { length } = existing;\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = existing[i];\n        ++i;\n    }\n    if (deletedItems !== void 0) {\n        arr.deletedItems = deletedItems.slice(0);\n    }\n    else if (existing.deletedItems !== void 0) {\n        arr.deletedItems = existing.deletedItems.slice(0);\n    }\n    else {\n        arr.deletedItems = [];\n    }\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function createIndexMap(length = 0) {\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = i++;\n    }\n    arr.deletedItems = [];\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function cloneIndexMap(indexMap) {\n    const clone = indexMap.slice();\n    clone.deletedItems = indexMap.deletedItems.slice();\n    clone.isIndexMap = true;\n    return clone;\n}\nexport function isIndexMap(value) {\n    return value instanceof Array && value.isIndexMap === true;\n}\n//# sourceMappingURL=observation.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionLengthObserver = class CollectionLengthObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.length;\n    }\n    getValue() {\n        return this.obj.length;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionLengthObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Array])\n], CollectionLengthObserver);\nexport { CollectionLengthObserver };\n//# sourceMappingURL=collection-length-observer.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionLengthObserver } from './collection-length-observer';\nimport { collectionSubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\n// https://tc39.github.io/ecma262/#sec-sortcompare\nfunction sortCompare(x, y) {\n    if (x === y) {\n        return 0;\n    }\n    x = x === null ? 'null' : x.toString();\n    y = y === null ? 'null' : y.toString();\n    return x < y ? -1 : 1;\n}\nfunction preSortCompare(x, y) {\n    if (x === void 0) {\n        if (y === void 0) {\n            return 0;\n        }\n        else {\n            return 1;\n        }\n    }\n    if (y === void 0) {\n        return -1;\n    }\n    return 0;\n}\nfunction insertionSort(arr, indexMap, from, to, compareFn) {\n    let velement, ielement, vtmp, itmp, order;\n    let i, j;\n    for (i = from + 1; i < to; i++) {\n        velement = arr[i];\n        ielement = indexMap[i];\n        for (j = i - 1; j >= from; j--) {\n            vtmp = arr[j];\n            itmp = indexMap[j];\n            order = compareFn(vtmp, velement);\n            if (order > 0) {\n                arr[j + 1] = vtmp;\n                indexMap[j + 1] = itmp;\n            }\n            else {\n                break;\n            }\n        }\n        arr[j + 1] = velement;\n        indexMap[j + 1] = ielement;\n    }\n}\nfunction quickSort(arr, indexMap, from, to, compareFn) {\n    let thirdIndex = 0, i = 0;\n    let v0, v1, v2;\n    let i0, i1, i2;\n    let c01, c02, c12;\n    let vtmp, itmp;\n    let vpivot, ipivot, lowEnd, highStart;\n    let velement, ielement, order, vtopElement;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        if (to - from <= 10) {\n            insertionSort(arr, indexMap, from, to, compareFn);\n            return;\n        }\n        thirdIndex = from + ((to - from) >> 1);\n        v0 = arr[from];\n        i0 = indexMap[from];\n        v1 = arr[to - 1];\n        i1 = indexMap[to - 1];\n        v2 = arr[thirdIndex];\n        i2 = indexMap[thirdIndex];\n        c01 = compareFn(v0, v1);\n        if (c01 > 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v1;\n            i0 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        c02 = compareFn(v0, v2);\n        if (c02 >= 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v2;\n            i0 = i2;\n            v2 = v1;\n            i2 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        else {\n            c12 = compareFn(v1, v2);\n            if (c12 > 0) {\n                vtmp = v1;\n                itmp = i1;\n                v1 = v2;\n                i1 = i2;\n                v2 = vtmp;\n                i2 = itmp;\n            }\n        }\n        arr[from] = v0;\n        indexMap[from] = i0;\n        arr[to - 1] = v2;\n        indexMap[to - 1] = i2;\n        vpivot = v1;\n        ipivot = i1;\n        lowEnd = from + 1;\n        highStart = to - 1;\n        arr[thirdIndex] = arr[lowEnd];\n        indexMap[thirdIndex] = indexMap[lowEnd];\n        arr[lowEnd] = vpivot;\n        indexMap[lowEnd] = ipivot;\n        partition: for (i = lowEnd + 1; i < highStart; i++) {\n            velement = arr[i];\n            ielement = indexMap[i];\n            order = compareFn(velement, vpivot);\n            if (order < 0) {\n                arr[i] = arr[lowEnd];\n                indexMap[i] = indexMap[lowEnd];\n                arr[lowEnd] = velement;\n                indexMap[lowEnd] = ielement;\n                lowEnd++;\n            }\n            else if (order > 0) {\n                do {\n                    highStart--;\n                    // eslint-disable-next-line eqeqeq\n                    if (highStart == i) {\n                        break partition;\n                    }\n                    vtopElement = arr[highStart];\n                    order = compareFn(vtopElement, vpivot);\n                } while (order > 0);\n                arr[i] = arr[highStart];\n                indexMap[i] = indexMap[highStart];\n                arr[highStart] = velement;\n                indexMap[highStart] = ielement;\n                if (order < 0) {\n                    velement = arr[i];\n                    ielement = indexMap[i];\n                    arr[i] = arr[lowEnd];\n                    indexMap[i] = indexMap[lowEnd];\n                    arr[lowEnd] = velement;\n                    indexMap[lowEnd] = ielement;\n                    lowEnd++;\n                }\n            }\n        }\n        if (to - highStart < lowEnd - from) {\n            quickSort(arr, indexMap, highStart, to, compareFn);\n            to = lowEnd;\n        }\n        else {\n            quickSort(arr, indexMap, from, lowEnd, compareFn);\n            from = highStart;\n        }\n    }\n}\nconst proto = Array.prototype;\nconst $push = proto.push;\nconst $unshift = proto.unshift;\nconst $pop = proto.pop;\nconst $shift = proto.shift;\nconst $splice = proto.splice;\nconst $reverse = proto.reverse;\nconst $sort = proto.sort;\nconst native = { push: $push, unshift: $unshift, pop: $pop, shift: $shift, splice: $splice, reverse: $reverse, sort: $sort };\nconst methods = ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'];\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-array.prototype.push\n    push: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $push.apply($this, args);\n        }\n        const len = $this.length;\n        const argCount = args.length;\n        if (argCount === 0) {\n            return len;\n        }\n        $this.length = o.indexMap.length = len + argCount;\n        let i = len;\n        while (i < $this.length) {\n            $this[i] = args[i - len];\n            o.indexMap[i] = -2;\n            i++;\n        }\n        o.notify();\n        return $this.length;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.unshift\n    unshift: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $unshift.apply($this, args);\n        }\n        const argCount = args.length;\n        const inserts = new Array(argCount);\n        let i = 0;\n        while (i < argCount) {\n            inserts[i++] = -2;\n        }\n        $unshift.apply(o.indexMap, inserts);\n        const len = $unshift.apply($this, args);\n        o.notify();\n        return len;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.pop\n    pop: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $pop.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $pop.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        const index = indexMap.length - 1;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        $pop.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.shift\n    shift: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $shift.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $shift.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        if (indexMap[0] > -1) {\n            indexMap.deletedItems.push(indexMap[0]);\n        }\n        $shift.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.splice\n    splice: function (...args) {\n        const start = args[0];\n        const deleteCount = args[1];\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $splice.apply($this, args);\n        }\n        const len = this.length;\n        const relativeStart = start | 0;\n        const actualStart = relativeStart < 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);\n        const indexMap = o.indexMap;\n        const argCount = args.length;\n        const actualDeleteCount = argCount === 0 ? 0 : argCount === 1 ? len - actualStart : deleteCount;\n        if (actualDeleteCount > 0) {\n            let i = actualStart;\n            const to = i + actualDeleteCount;\n            while (i < to) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n        }\n        if (argCount > 2) {\n            const itemCount = argCount - 2;\n            const inserts = new Array(itemCount);\n            let i = 0;\n            while (i < itemCount) {\n                inserts[i++] = -2;\n            }\n            $splice.call(indexMap, start, deleteCount, ...inserts);\n        }\n        else {\n            $splice.apply(indexMap, args);\n        }\n        const deleted = $splice.apply($this, args);\n        o.notify();\n        return deleted;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.reverse\n    reverse: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $reverse.call($this);\n            return this;\n        }\n        const len = $this.length;\n        const middle = (len / 2) | 0;\n        let lower = 0;\n        while (lower !== middle) {\n            const upper = len - lower - 1;\n            const lowerValue = $this[lower];\n            const lowerIndex = o.indexMap[lower];\n            const upperValue = $this[upper];\n            const upperIndex = o.indexMap[upper];\n            $this[lower] = upperValue;\n            o.indexMap[lower] = upperIndex;\n            $this[upper] = lowerValue;\n            o.indexMap[upper] = lowerIndex;\n            lower++;\n        }\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.sort\n    // https://github.com/v8/v8/blob/master/src/js/array.js\n    sort: function (compareFn) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $sort.call($this, compareFn);\n            return this;\n        }\n        const len = $this.length;\n        if (len < 2) {\n            return this;\n        }\n        quickSort($this, o.indexMap, 0, len, preSortCompare);\n        let i = 0;\n        while (i < len) {\n            if ($this[i] === void 0) {\n                break;\n            }\n            i++;\n        }\n        if (compareFn === void 0 || typeof compareFn !== 'function' /* spec says throw a TypeError, should we do that too? */) {\n            compareFn = sortCompare;\n        }\n        quickSort($this, o.indexMap, 0, i, compareFn);\n        o.notify();\n        return this;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableArrayObservationCalled = false;\nexport function enableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nlet ArrayObserver = class ArrayObserver {\n    constructor(flags, lifecycle, array) {\n        if (!enableArrayObservationCalled) {\n            enableArrayObservationCalled = true;\n            enableArrayObservation();\n        }\n        this.inBatch = false;\n        this.indexObservers = {};\n        this.collection = array;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(array.length);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(array, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionLengthObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        return this.getOrCreateIndexObserver(index);\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const indexMap = this.indexMap;\n        const length = this.collection.length;\n        this.indexMap = createIndexMap(length);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(length, 16 /* updateTargetInstance */);\n        }\n    }\n    /**\n     * @internal used by friend class ArrayIndexObserver only\n     */\n    addIndexObserver(indexObserver) {\n        this.addCollectionSubscriber(indexObserver);\n    }\n    /**\n     * @internal used by friend class ArrayIndexObserver only\n     */\n    removeIndexObserver(indexObserver) {\n        this.removeCollectionSubscriber(indexObserver);\n    }\n    /**\n     * @internal\n     */\n    getOrCreateIndexObserver(index) {\n        const indexObservers = this.indexObservers;\n        let observer = indexObservers[index];\n        if (observer === void 0) {\n            observer = indexObservers[index] = new ArrayIndexObserver(this, index);\n        }\n        return observer;\n    }\n};\nArrayObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], ArrayObserver);\nexport { ArrayObserver };\nlet ArrayIndexObserver = class ArrayIndexObserver {\n    constructor(owner, index) {\n        this.owner = owner;\n        this.index = index;\n        this.subscriberCount = 0;\n        this.currentValue = this.getValue();\n    }\n    getValue() {\n        return this.owner.collection[this.index];\n    }\n    setValue(newValue, flags) {\n        if (newValue === this.getValue()) {\n            return;\n        }\n        const arrayObserver = this.owner;\n        const index = this.index;\n        const indexMap = arrayObserver.indexMap;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        indexMap[index] = -2;\n        // do not need to update current value here\n        // as it will be updated inside handle collection change\n        arrayObserver.collection[index] = newValue;\n        arrayObserver.notify();\n    }\n    /**\n     * From interface `ICollectionSubscriber`\n     */\n    handleCollectionChange(indexMap, flags) {\n        const index = this.index;\n        const noChange = indexMap[index] === index;\n        if (noChange) {\n            return;\n        }\n        const prevValue = this.currentValue;\n        const currValue = this.currentValue = this.getValue();\n        // hmm\n        if (prevValue !== currValue) {\n            this.callSubscribers(currValue, prevValue, flags);\n        }\n    }\n    subscribe(subscriber) {\n        if (this.addSubscriber(subscriber) && ++this.subscriberCount === 1) {\n            this.owner.addIndexObserver(this);\n        }\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && --this.subscriberCount === 0) {\n            this.owner.removeIndexObserver(this);\n        }\n    }\n};\nArrayIndexObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [ArrayObserver, Number])\n], ArrayIndexObserver);\nexport { ArrayIndexObserver };\nexport function getArrayObserver(flags, lifecycle, array) {\n    const observer = observerLookup.get(array);\n    if (observer === void 0) {\n        return new ArrayObserver(flags, lifecycle, array);\n    }\n    return observer;\n}\n/**\n * Applies offsets to the non-negative indices in the IndexMap\n * based on added and deleted items relative to those indices.\n *\n * e.g. turn `[-2, 0, 1]` into `[-2, 1, 2]`, allowing the values at the indices to be\n * used for sorting/reordering items if needed\n */\nexport function applyMutationsToIndices(indexMap) {\n    let offset = 0;\n    let j = 0;\n    const len = indexMap.length;\n    for (let i = 0; i < len; ++i) {\n        while (indexMap.deletedItems[j] <= i - offset) {\n            ++j;\n            --offset;\n        }\n        if (indexMap[i] === -2) {\n            ++offset;\n        }\n        else {\n            indexMap[i] += offset;\n        }\n    }\n}\n/**\n * After `applyMutationsToIndices`, this function can be used to reorder items in a derived\n * array (e.g.  the items in the `views` in the repeater are derived from the `items` property)\n */\nexport function synchronizeIndices(items, indexMap) {\n    const copy = items.slice();\n    const len = indexMap.length;\n    let to = 0;\n    let from = 0;\n    while (to < len) {\n        from = indexMap[to];\n        if (from !== -2) {\n            items[to] = copy[from];\n        }\n        ++to;\n    }\n}\n//# sourceMappingURL=array-observer.js.map","import { __decorate, __metadata } from \"tslib\";\n/* eslint-disable eqeqeq, compat/compat */\nimport { PLATFORM, Reporter, isArrayIndex } from '@aurelia/kernel';\nimport { IObserverLocator } from './observer-locator';\nimport { subscriberCollection } from './subscriber-collection';\nexport function computed(config) {\n    return function (target, key) {\n        /**\n         * The 'computed' property defined on prototype needs to be non-enumerable to prevent getting this in loops,\n         * iterating over object properties, such as for..in.\n         *\n         * The 'value' of the property should not have any prototype. Otherwise if by mistake the target passed\n         * here is `Object`, then we are in soup. Because then every instance of `Object` will have the `computed`\n         * property, including the `value` (in the descriptor of the property), when assigned `{}`. This might\n         * lead to infinite recursion for the cases as mentioned above.\n         */\n        if (target.computed == null) {\n            Reflect.defineProperty(target, 'computed', {\n                writable: true,\n                configurable: true,\n                enumerable: false,\n                value: Object.create(null)\n            });\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        target.computed[key] = config;\n    };\n}\nconst computedOverrideDefaults = { static: false, volatile: false };\n/* @internal */\nexport function createComputedObserver(flags, observerLocator, dirtyChecker, lifecycle, instance, propertyName, descriptor) {\n    if (descriptor.configurable === false) {\n        return dirtyChecker.createProperty(instance, propertyName);\n    }\n    if (descriptor.get != null) {\n        const { constructor: { prototype: { computed: givenOverrides } } } = instance;\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-type-assertion\n        const overrides = givenOverrides && givenOverrides[propertyName] || computedOverrideDefaults;\n        if (descriptor.set != null) {\n            if (overrides.volatile) {\n                return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n            }\n            return new CustomSetterObserver(instance, propertyName, descriptor);\n        }\n        return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n    }\n    throw Reporter.error(18, propertyName);\n}\n// Used when the getter is dependent solely on changes that happen within the setter.\nlet CustomSetterObserver = class CustomSetterObserver {\n    constructor(obj, propertyKey, descriptor) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.observing = false;\n    }\n    setValue(newValue) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion, @typescript-eslint/no-unnecessary-type-assertion\n        this.descriptor.set.call(this.obj, newValue); // Non-null is implied because descriptors without setters won't end up here\n        if (this.currentValue !== newValue) {\n            this.oldValue = this.currentValue;\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, this.oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.observing) {\n            this.convertProperty();\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n    }\n    convertProperty() {\n        this.observing = true;\n        this.currentValue = this.obj[this.propertyKey];\n        const set = (newValue) => { this.setValue(newValue); };\n        Reflect.defineProperty(this.obj, this.propertyKey, { set, get: this.descriptor.get });\n    }\n};\nCustomSetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, String, Object])\n], CustomSetterObserver);\nexport { CustomSetterObserver };\n// Used when there is no setter, and the getter is dependent on other properties of the object;\n// Used when there is a setter but the value of the getter can change based on properties set outside of the setter.\nlet GetterObserver = class GetterObserver {\n    constructor(flags, overrides, obj, propertyKey, descriptor, observerLocator) {\n        this.overrides = overrides;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.propertyDeps = [];\n        this.collectionDeps = [];\n        this.subscriberCount = 0;\n        this.isCollecting = false;\n        this.proxy = new Proxy(obj, createGetterTraps(flags, observerLocator, this));\n        const get = () => this.getValue();\n        Reflect.defineProperty(obj, propertyKey, { get, set: descriptor.set });\n    }\n    addPropertyDep(subscribable) {\n        if (!this.propertyDeps.includes(subscribable)) {\n            this.propertyDeps.push(subscribable);\n        }\n    }\n    addCollectionDep(subscribable) {\n        if (!this.collectionDeps.includes(subscribable)) {\n            this.collectionDeps.push(subscribable);\n        }\n    }\n    getValue() {\n        if (this.subscriberCount > 0 || this.isCollecting) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.proxy, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.obj, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        return this.currentValue;\n    }\n    subscribe(subscriber) {\n        this.addSubscriber(subscriber);\n        if (++this.subscriberCount === 1) {\n            this.getValueAndCollectDependencies(true);\n        }\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (--this.subscriberCount === 0) {\n            this.unsubscribeAllDependencies();\n        }\n    }\n    handleChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    handleCollectionChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    getValueAndCollectDependencies(requireCollect) {\n        const dynamicDependencies = !this.overrides.static || requireCollect;\n        if (dynamicDependencies) {\n            this.unsubscribeAllDependencies();\n            this.isCollecting = true;\n        }\n        this.currentValue = this.getValue();\n        if (dynamicDependencies) {\n            this.propertyDeps.forEach(x => { x.subscribe(this); });\n            this.collectionDeps.forEach(x => { x.subscribeToCollection(this); });\n            this.isCollecting = false;\n        }\n        return this.currentValue;\n    }\n    doNotCollect(target, key, receiver) {\n        return !this.isCollecting\n            || key === '$observers'\n            || key === '$synthetic'\n            || key === 'constructor';\n    }\n    unsubscribeAllDependencies() {\n        this.propertyDeps.forEach(x => { x.unsubscribe(this); });\n        this.propertyDeps.length = 0;\n        this.collectionDeps.forEach(x => { x.unsubscribeFromCollection(this); });\n        this.collectionDeps.length = 0;\n    }\n};\nGetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object, String, Object, Object])\n], GetterObserver);\nexport { GetterObserver };\nconst toStringTag = Object.prototype.toString;\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction createGetterTraps(flags, observerLocator, observer) {\n    return {\n        get: function (target, key, receiver) {\n            if (observer.doNotCollect(target, key, receiver)) {\n                return Reflect.get(target, key, receiver);\n            }\n            // The length and iterator properties need to be invoked on the original object\n            // (for Map and Set at least) or they will throw.\n            switch (toStringTag.call(target)) {\n                case '[object Array]':\n                    if (key === 'length' || isArrayIndex(key)) {\n                        observer.addCollectionDep(observerLocator.getArrayObserver(flags, target));\n                        return proxyOrValue(flags, target, key, observerLocator, observer);\n                    }\n                    break;\n                case '[object Map]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getMapObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n                case '[object Set]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getSetObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n            }\n            observer.addPropertyDep(observerLocator.getObserver(flags, target, key));\n            return proxyOrValue(flags, target, key, observerLocator, observer);\n        }\n    };\n}\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction proxyOrValue(flags, target, key, observerLocator, observer) {\n    const value = Reflect.get(target, key, target);\n    if (typeof value !== 'object' || typeof value === 'function' || value === null) {\n        return value;\n    }\n    return new Proxy(value, createGetterTraps(flags, observerLocator, observer));\n}\n//# sourceMappingURL=computed-observer.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { PLATFORM, DI, bound, Registration } from '@aurelia/kernel';\nconst defaultClockSettings = {\n    forceUpdateInterval: 10,\n    now: PLATFORM.now,\n};\nconst { enter, leave, trace, } = (function () {\n    const enabled = false;\n    let depth = 0;\n    function round(num) {\n        return ((num * 10 + .5) | 0) / 10;\n    }\n    function log(prefix, obj, method) {\n        if (obj instanceof TaskQueue) {\n            const processing = obj['processingSize'];\n            const pending = obj['pendingSize'];\n            const delayed = obj['delayedSize'];\n            const flushReq = obj['flushRequested'];\n            const prio = obj['priority'];\n            const info = `processing=${processing} pending=${pending} delayed=${delayed} flushReq=${flushReq} prio=${prio}`;\n            console.log(`${prefix}[Q.${method}] ${info}`);\n        }\n        else {\n            const id = obj['id'];\n            const created = round(obj['createdTime']);\n            const queue = round(obj['queueTime']);\n            const preempt = obj['preempt'];\n            const reusable = obj['reusable'];\n            const persistent = obj['persistent'];\n            const status = obj['_status'];\n            const info = `id=${id} created=${created} queue=${queue} preempt=${preempt} persistent=${persistent} reusable=${reusable} status=${status}`;\n            console.log(`${prefix}[T.${method}] ${info}`);\n        }\n    }\n    function $enter(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(depth++)}> `, obj, method);\n        }\n    }\n    function $leave(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(--depth)}< `, obj, method);\n        }\n    }\n    function $trace(obj, method) {\n        if (enabled) {\n            log(`${'  '.repeat(depth)}- `, obj, method);\n        }\n    }\n    return {\n        enter: $enter,\n        leave: $leave,\n        trace: $trace,\n    };\n})();\nexport const IClock = DI.createInterface('IClock').withDefault(x => x.instance(globalClock));\nexport class Clock {\n    constructor(opts) {\n        const { now, forceUpdateInterval } = { ...defaultClockSettings, ...opts };\n        this.now = function (highRes = false) {\n            // if (++requests === forceUpdateInterval || highRes) {\n            //   requests = 0;\n            //   timestamp = now();\n            // }\n            // return timestamp;\n            return now();\n        };\n    }\n    static register(container) {\n        return Registration.singleton(IClock, this).register(container);\n    }\n}\nexport const globalClock = new Clock();\nexport var TaskQueuePriority;\n(function (TaskQueuePriority) {\n    TaskQueuePriority[TaskQueuePriority[\"microTask\"] = 0] = \"microTask\";\n    TaskQueuePriority[TaskQueuePriority[\"render\"] = 1] = \"render\";\n    TaskQueuePriority[TaskQueuePriority[\"macroTask\"] = 2] = \"macroTask\";\n    TaskQueuePriority[TaskQueuePriority[\"postRender\"] = 3] = \"postRender\";\n    TaskQueuePriority[TaskQueuePriority[\"idle\"] = 4] = \"idle\";\n})(TaskQueuePriority || (TaskQueuePriority = {}));\nexport const IScheduler = DI.createInterface('IScheduler').noDefault();\nconst createPromise = (function () {\n    let $resolve = void 0;\n    let $reject = void 0;\n    function executor(resolve, reject) {\n        $resolve = resolve;\n        $reject = reject;\n    }\n    return function () {\n        const p = new Promise(executor);\n        p.resolve = $resolve;\n        p.reject = $reject;\n        $resolve = void 0;\n        $reject = void 0;\n        return p;\n    };\n})();\nconst defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    persistent: false,\n    reusable: true,\n};\nexport class TaskQueue {\n    constructor({ clock, priority, scheduler }) {\n        this.processingSize = 0;\n        this.processingHead = void 0;\n        this.processingTail = void 0;\n        this.pendingSize = 0;\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.delayedSize = 0;\n        this.delayedHead = void 0;\n        this.delayedTail = void 0;\n        this.flushRequested = false;\n        this.yieldPromise = void 0;\n        this.taskPool = [];\n        this.taskPoolSize = 0;\n        this.lastRequest = 0;\n        this.microTaskRequestFlushTask = null;\n        this.priority = priority;\n        this.scheduler = scheduler;\n        this.clock = clock;\n    }\n    get isEmpty() {\n        return this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0;\n    }\n    flush() {\n        enter(this, 'flush');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.clock.now(true);\n        this.flushRequested = false;\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        while (this.processingSize > 0) {\n            this.processingHead.run();\n        }\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        if (this.processingSize > 0) {\n            this.requestFlush();\n        }\n        else if (this.delayedSize > 0) {\n            if (this.priority <= 0 /* microTask */) {\n                // MicroTasks are not clamped so we have to clamp them with setTimeout or they'll block forever\n                this.microTaskRequestFlushTask = this.scheduler.getTaskQueue(2 /* macroTask */).queueTask(this.requestFlush);\n            }\n            else {\n                // Otherwise just let this queue handle itself\n                this.requestFlush();\n            }\n        }\n        if (this.yieldPromise !== void 0) {\n            let noMoreFiniteWork = true;\n            let cur = this.processingHead;\n            while (cur !== void 0) {\n                if (!cur.persistent) {\n                    noMoreFiniteWork = false;\n                    break;\n                }\n                cur = cur.next;\n            }\n            if (noMoreFiniteWork) {\n                cur = this.pendingHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                cur = this.delayedHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                const p = this.yieldPromise;\n                this.yieldPromise = void 0;\n                p.resolve();\n            }\n        }\n        leave(this, 'flush');\n    }\n    cancel() {\n        enter(this, 'cancel');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.scheduler.cancelFlush(this);\n        this.flushRequested = false;\n        leave(this, 'cancel');\n    }\n    yield() {\n        enter(this, 'yield');\n        if (this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0) {\n            leave(this, 'yield empty');\n            return Promise.resolve();\n        }\n        if (this.yieldPromise === void 0) {\n            this.yieldPromise = createPromise();\n        }\n        leave(this, 'yield task');\n        return this.yieldPromise;\n    }\n    queueTask(callback, opts) {\n        enter(this, 'queueTask');\n        const { delay, preempt, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        if (preempt) {\n            if (delay > 0) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with a greater-than-zero delay`);\n            }\n            if (persistent) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with persistent`);\n            }\n        }\n        if (persistent && this.priority === 0 /* microTask */) {\n            throw new Error(`Invalid arguments: cannot queue persistent tasks on the micro task queue`);\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        const time = this.clock.now();\n        let task;\n        if (reusable) {\n            const taskPool = this.taskPool;\n            const index = this.taskPoolSize - 1;\n            if (index >= 0) {\n                task = taskPool[index];\n                taskPool[index] = (void 0);\n                this.taskPoolSize = index;\n                task.reuse(time, delay, preempt, persistent, callback);\n            }\n            else {\n                task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n            }\n        }\n        else {\n            task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n        }\n        if (preempt) {\n            if (this.processingSize++ === 0) {\n                this.processingHead = this.processingTail = task;\n            }\n            else {\n                this.processingTail = (task.prev = this.processingTail).next = task;\n            }\n        }\n        else if (delay === 0) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n            }\n        }\n        leave(this, 'queueTask');\n        return task;\n    }\n    take(task) {\n        enter(this, 'take');\n        if (task.status !== 'pending') {\n            leave(this, 'take error');\n            throw new Error('Can only take pending tasks.');\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        task.taskQueue.remove(task);\n        if (task.preempt) {\n            this.addToProcessing(task);\n        }\n        else if (task.queueTime <= this.clock.now()) {\n            this.addToPending(task);\n        }\n        else {\n            this.addToDelayed(task);\n        }\n        leave(this, 'take');\n    }\n    remove(task) {\n        enter(this, 'remove');\n        if (task.preempt) {\n            // Fast path - preempt task can only ever end up in the processing queue\n            this.removeFromProcessing(task);\n            leave(this, 'remove processing fast');\n            return;\n        }\n        if (task.queueTime > this.clock.now()) {\n            // Fast path - task with queueTime in the future can only ever be in the delayed queue\n            this.removeFromDelayed(task);\n            leave(this, 'remove delayed fast');\n            return;\n        }\n        // Scan everything (we can make this faster by using the queueTime property, but this is good enough for now)\n        let cur = this.processingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromProcessing(task);\n                leave(this, 'remove processing slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.pendingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromPending(task);\n                leave(this, 'remove pending slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.delayedHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromDelayed(task);\n                leave(this, 'remove delayed slow');\n                return;\n            }\n            cur = cur.next;\n        }\n        leave(this, 'remove error');\n        throw new Error(`Task #${task.id} could not be found`);\n    }\n    returnToPool(task) {\n        trace(this, 'returnToPool');\n        this.taskPool[this.taskPoolSize++] = task;\n    }\n    resetPersistentTask(task) {\n        enter(this, 'resetPersistentTask');\n        task.reset(this.clock.now());\n        if (task.createdTime === task.queueTime) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n                task.next = void 0;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n                task.next = void 0;\n            }\n        }\n        leave(this, 'resetPersistentTask');\n    }\n    finish(task) {\n        enter(this, 'finish');\n        if (task.next !== void 0) {\n            task.next.prev = task.prev;\n        }\n        if (task.prev !== void 0) {\n            task.prev.next = task.next;\n        }\n        leave(this, 'finish');\n    }\n    removeFromProcessing(task) {\n        enter(this, 'removeFromProcessing');\n        if (this.processingHead === task) {\n            this.processingHead = task.next;\n        }\n        if (this.processingTail === task) {\n            this.processingTail = task.prev;\n        }\n        --this.processingSize;\n        this.finish(task);\n        leave(this, 'removeFromProcessing');\n    }\n    removeFromPending(task) {\n        enter(this, 'removeFromPending');\n        if (this.pendingHead === task) {\n            this.pendingHead = task.next;\n        }\n        if (this.pendingTail === task) {\n            this.pendingTail = task.prev;\n        }\n        --this.pendingSize;\n        this.finish(task);\n        leave(this, 'removeFromPending');\n    }\n    removeFromDelayed(task) {\n        enter(this, 'removeFromDelayed');\n        if (this.delayedHead === task) {\n            this.delayedHead = task.next;\n        }\n        if (this.delayedTail === task) {\n            this.delayedTail = task.prev;\n        }\n        --this.delayedSize;\n        this.finish(task);\n        leave(this, 'removeFromDelayed');\n    }\n    addToProcessing(task) {\n        enter(this, 'addToProcessing');\n        if (this.processingSize++ === 0) {\n            this.processingHead = this.processingTail = task;\n        }\n        else {\n            this.processingTail = (task.prev = this.processingTail).next = task;\n        }\n        leave(this, 'addToProcessing');\n    }\n    addToPending(task) {\n        enter(this, 'addToPending');\n        if (this.pendingSize++ === 0) {\n            this.pendingHead = this.pendingTail = task;\n        }\n        else {\n            this.pendingTail = (task.prev = this.pendingTail).next = task;\n        }\n        leave(this, 'addToPending');\n    }\n    addToDelayed(task) {\n        enter(this, 'addToDelayed');\n        if (this.delayedSize++ === 0) {\n            this.delayedHead = this.delayedTail = task;\n        }\n        else {\n            this.delayedTail = (task.prev = this.delayedTail).next = task;\n        }\n        leave(this, 'addToDelayed');\n    }\n    movePendingToProcessing() {\n        enter(this, 'movePendingToProcessing');\n        // Add the previously pending tasks to the currently processing tasks\n        if (this.processingSize === 0) {\n            this.processingHead = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize = this.pendingSize;\n        }\n        else {\n            this.processingTail.next = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize += this.pendingSize;\n        }\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.pendingSize = 0;\n        leave(this, 'movePendingToProcessing');\n    }\n    moveDelayedToProcessing() {\n        enter(this, 'moveDelayedToProcessing');\n        const time = this.clock.now(true);\n        // Add any delayed tasks whose delay have expired to the currently processing tasks\n        const delayedHead = this.delayedHead;\n        if (delayedHead.queueTime <= time) {\n            let delayedTail = delayedHead;\n            let next = delayedTail.next;\n            let count = 1;\n            while (next !== void 0 && next.queueTime <= time) {\n                delayedTail = next;\n                next = delayedTail.next;\n                ++count;\n            }\n            if (this.processingSize === 0) {\n                this.processingHead = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize = count;\n            }\n            else {\n                this.processingTail.next = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize += count;\n            }\n            this.delayedHead = next;\n            this.delayedSize -= count;\n            if (this.delayedSize === 0) {\n                this.delayedTail = void 0;\n            }\n        }\n        leave(this, 'moveDelayedToProcessing');\n    }\n    requestFlush() {\n        enter(this, 'requestFlush');\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        if (!this.flushRequested) {\n            this.flushRequested = true;\n            this.lastRequest = this.clock.now(true);\n            this.scheduler.requestFlush(this);\n        }\n        leave(this, 'requestFlush');\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], TaskQueue.prototype, \"requestFlush\", null);\nexport class TaskAbortError extends Error {\n    constructor(task) {\n        super('Task was canceled.');\n        this.task = task;\n    }\n}\nlet id = 0;\nexport class Task {\n    constructor(taskQueue, createdTime, queueTime, preempt, persistent, reusable, callback) {\n        this.taskQueue = taskQueue;\n        this.createdTime = createdTime;\n        this.queueTime = queueTime;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.reusable = reusable;\n        this.callback = callback;\n        this.id = ++id;\n        this.next = void 0;\n        this.prev = void 0;\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        this._status = 'pending';\n        trace(this, 'constructor');\n        this.priority = taskQueue.priority;\n    }\n    get result() {\n        const result = this._result;\n        if (result === void 0) {\n            switch (this._status) {\n                case 'pending': {\n                    const promise = this._result = createPromise();\n                    this.resolve = promise.resolve;\n                    this.reject = promise.reject;\n                    return promise;\n                }\n                case 'running':\n                    throw new Error('Trying to await task from within task will cause a deadlock.');\n                case 'completed':\n                    return this._result = Promise.resolve();\n                case 'canceled':\n                    return this._result = Promise.reject(new TaskAbortError(this));\n            }\n        }\n        return result;\n    }\n    get status() {\n        return this._status;\n    }\n    run() {\n        enter(this, 'run');\n        if (this._status !== 'pending') {\n            leave(this, 'run error');\n            throw new Error(`Cannot run task in ${this._status} state`);\n        }\n        // this.persistent could be changed while the task is running (this can only be done by the task itself if canceled, and is a valid way of stopping a loop)\n        // so we deliberately reference this.persistent instead of the local variable, but we keep it around to know whether the task *was* persistent before running it,\n        // so we can set the correct cancelation state.\n        const persistent = this.persistent;\n        const reusable = this.reusable;\n        const taskQueue = this.taskQueue;\n        const callback = this.callback;\n        const resolve = this.resolve;\n        const reject = this.reject;\n        const createdTime = this.createdTime;\n        taskQueue.remove(this);\n        this._status = 'running';\n        try {\n            const ret = callback(globalClock.now() - createdTime);\n            if (this.persistent) {\n                taskQueue.resetPersistentTask(this);\n            }\n            else if (persistent) {\n                // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n                this._status = 'canceled';\n            }\n            else {\n                this._status = 'completed';\n            }\n            if (resolve !== void 0) {\n                resolve(ret);\n            }\n        }\n        catch (err) {\n            if (reject !== void 0) {\n                reject(err);\n            }\n            else {\n                throw err;\n            }\n        }\n        finally {\n            if (!this.persistent) {\n                this.dispose();\n                if (reusable) {\n                    taskQueue.returnToPool(this);\n                }\n            }\n            leave(this, 'run finally');\n        }\n    }\n    cancel() {\n        enter(this, 'cancel');\n        if (this._status === 'pending') {\n            const taskQueue = this.taskQueue;\n            const reusable = this.reusable;\n            const reject = this.reject;\n            taskQueue.remove(this);\n            if (taskQueue.isEmpty) {\n                taskQueue.cancel();\n            }\n            this._status = 'canceled';\n            if (reject !== void 0) {\n                reject(new TaskAbortError(this));\n            }\n            this.dispose();\n            if (reusable) {\n                taskQueue.returnToPool(this);\n            }\n            leave(this, 'cancel true =pending');\n            return true;\n        }\n        else if (this._status === 'running' && this.persistent) {\n            this.persistent = false;\n            leave(this, 'cancel true =running+persistent');\n            return true;\n        }\n        leave(this, 'cancel false');\n        return false;\n    }\n    reset(time) {\n        enter(this, 'reset');\n        const delay = this.queueTime - this.createdTime;\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this._status = 'pending';\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        leave(this, 'reset');\n    }\n    reuse(time, delay, preempt, persistent, callback) {\n        enter(this, 'reuse');\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.callback = callback;\n        this._status = 'pending';\n        leave(this, 'reuse');\n    }\n    dispose() {\n        trace(this, 'dispose');\n        this.prev = void 0;\n        this.next = void 0;\n        this.callback = (void 0);\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n}\n//# sourceMappingURL=scheduler.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI, Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\nimport { IScheduler } from '../scheduler';\nexport const IDirtyChecker = DI.createInterface('IDirtyChecker').withDefault(x => x.singleton(DirtyChecker));\nexport const DirtyCheckSettings = {\n    /**\n     * Default: `6`\n     *\n     * Adjust the global dirty check frequency.\n     * Measures in \"frames per check\", such that (given an FPS of 60):\n     * - A value of 1 will result in 60 dirty checks per second\n     * - A value of 6 will result in 10 dirty checks per second\n     */\n    framesPerCheck: 6,\n    /**\n     * Default: `false`\n     *\n     * Disable dirty-checking entirely. Properties that cannot be observed without dirty checking\n     * or an adapter, will simply not be observed.\n     */\n    disabled: false,\n    /**\n     * Default: `true`\n     *\n     * Log a warning message to the console if a property is being dirty-checked.\n     */\n    warn: true,\n    /**\n     * Default: `false`\n     *\n     * Throw an error if a property is being dirty-checked.\n     */\n    throw: false,\n    /**\n     * Resets all dirty checking settings to the framework's defaults.\n     */\n    resetToDefault() {\n        this.framesPerCheck = 6;\n        this.disabled = false;\n        this.warn = true;\n        this.throw = false;\n    }\n};\n/** @internal */\nlet DirtyChecker = class DirtyChecker {\n    constructor(scheduler) {\n        this.scheduler = scheduler;\n        this.tracked = [];\n        this.task = null;\n        this.elapsedFrames = 0;\n    }\n    createProperty(obj, propertyName) {\n        if (DirtyCheckSettings.throw) {\n            throw Reporter.error(800, propertyName); // TODO: create/organize error code\n        }\n        if (DirtyCheckSettings.warn) {\n            Reporter.write(801, propertyName);\n        }\n        return new DirtyCheckProperty(this, obj, propertyName);\n    }\n    addProperty(property) {\n        this.tracked.push(property);\n        if (this.tracked.length === 1) {\n            this.task = this.scheduler.queueRenderTask(() => this.check(), { persistent: true });\n        }\n    }\n    removeProperty(property) {\n        this.tracked.splice(this.tracked.indexOf(property), 1);\n        if (this.tracked.length === 0) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    check(delta) {\n        if (DirtyCheckSettings.disabled) {\n            return;\n        }\n        if (++this.elapsedFrames < DirtyCheckSettings.framesPerCheck) {\n            return;\n        }\n        this.elapsedFrames = 0;\n        const tracked = this.tracked;\n        const len = tracked.length;\n        let current;\n        let i = 0;\n        for (; i < len; ++i) {\n            current = tracked[i];\n            if (current.isDirty()) {\n                current.flush(256 /* fromTick */);\n            }\n        }\n    }\n};\nDirtyChecker = __decorate([\n    __param(0, IScheduler),\n    __metadata(\"design:paramtypes\", [Object])\n], DirtyChecker);\nexport { DirtyChecker };\nlet DirtyCheckProperty = class DirtyCheckProperty {\n    constructor(dirtyChecker, obj, propertyKey) {\n        this.dirtyChecker = dirtyChecker;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n    }\n    isDirty() {\n        return this.oldValue !== this.obj[this.propertyKey];\n    }\n    flush(flags) {\n        const oldValue = this.oldValue;\n        const newValue = this.obj[this.propertyKey];\n        this.callSubscribers(newValue, oldValue, flags | 16 /* updateTargetInstance */);\n        this.oldValue = newValue;\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.oldValue = this.obj[this.propertyKey];\n            this.dirtyChecker.addProperty(this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && !this.hasSubscribers()) {\n            this.dirtyChecker.removeProperty(this);\n        }\n    }\n};\nDirtyCheckProperty = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, String])\n], DirtyCheckProperty);\nexport { DirtyCheckProperty };\n//# sourceMappingURL=dirty-checker.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionSizeObserver = class CollectionSizeObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.size;\n    }\n    getValue() {\n        return this.obj.size;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionSizeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object])\n], CollectionSizeObserver);\nexport { CollectionSizeObserver };\n//# sourceMappingURL=collection-size-observer.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Map.prototype;\nconst $set = proto.set;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { set: $set, clear: $clear, delete: $delete };\nconst methods = ['set', 'clear', 'delete'];\n// note: we can't really do much with Map due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, map/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-map.prototype.map\n    set: function (key, value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $set.call($this, key, value);\n            return this;\n        }\n        const oldValue = $this.get(key);\n        const oldSize = $this.size;\n        $set.call($this, key, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            let i = 0;\n            for (const entry of $this.entries()) {\n                if (entry[0] === key) {\n                    if (entry[1] !== oldValue) {\n                        o.indexMap.deletedItems.push(o.indexMap[i]);\n                        o.indexMap[i] = -2;\n                        o.notify();\n                    }\n                    return this;\n                }\n                i++;\n            }\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            ++i;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableMapObservationCalled = false;\nexport function enableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet MapObserver = class MapObserver {\n    constructor(flags, lifecycle, map) {\n        if (!enableMapObservationCalled) {\n            enableMapObservationCalled = true;\n            enableMapObservation();\n        }\n        this.inBatch = false;\n        this.collection = map;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(map.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(map, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        throw new Error('Map index observation not supported');\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nMapObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], MapObserver);\nexport { MapObserver };\nexport function getMapObserver(flags, lifecycle, map) {\n    const observer = observerLookup.get(map);\n    if (observer === void 0) {\n        return new MapObserver(flags, lifecycle, map);\n    }\n    return observer;\n}\n//# sourceMappingURL=map-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nconst slice = Array.prototype.slice;\nconst noop = PLATFORM.noop;\n// note: string.length is the only property of any primitive that is not a function,\n// so we can hardwire it to that and simply return undefined for anything else\n// note#2: a modified primitive constructor prototype would not work (and really, it shouldn't..)\nexport class PrimitiveObserver {\n    constructor(obj, propertyKey) {\n        this.doNotCache = true;\n        // we don't need to store propertyName because only 'length' can return a useful value\n        if (propertyKey === 'length') {\n            // deliberately not checking for typeof string as users probably still want to know via an error that their string is undefined\n            this.obj = obj;\n            this.getValue = this.getStringLength;\n        }\n        else {\n            this.getValue = this.returnUndefined;\n        }\n    }\n    getStringLength() {\n        return this.obj.length;\n    }\n    returnUndefined() {\n        return undefined;\n    }\n}\nPrimitiveObserver.prototype.setValue = noop;\nPrimitiveObserver.prototype.subscribe = noop;\nPrimitiveObserver.prototype.unsubscribe = noop;\nPrimitiveObserver.prototype.dispose = noop;\n//# sourceMappingURL=primitive-observer.js.map","export class PropertyAccessor {\n    constructor(obj, propertyKey) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        if (obj.$observers !== void 0\n            && obj.$observers[propertyKey] !== void 0\n            && obj.$observers[propertyKey].setValue !== void 0) {\n            this.setValue = this.setValueDirect;\n        }\n    }\n    getValue() {\n        return this.obj[this.propertyKey];\n    }\n    setValue(value, flags) {\n        this.obj[this.propertyKey] = value;\n    }\n    setValueDirect(value, flags) {\n        this.obj.$observers[this.propertyKey].setValue(value, flags);\n    }\n}\n//# sourceMappingURL=property-accessor.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Set.prototype;\nconst $add = proto.add;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { add: $add, clear: $clear, delete: $delete };\nconst methods = ['add', 'clear', 'delete'];\n// note: we can't really do much with Set due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, add/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-set.prototype.add\n    add: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $add.call($this, value);\n            return this;\n        }\n        const oldSize = $this.size;\n        $add.call($this, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            i++;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableSetObservationCalled = false;\nexport function enableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet SetObserver = class SetObserver {\n    constructor(flags, lifecycle, observedSet) {\n        if (!enableSetObservationCalled) {\n            enableSetObservationCalled = true;\n            enableSetObservation();\n        }\n        this.inBatch = false;\n        this.collection = observedSet;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(observedSet.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(observedSet, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        throw new Error('Set index observation not supported');\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nSetObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], SetObserver);\nexport { SetObserver };\nexport function getSetObserver(flags, lifecycle, observedSet) {\n    const observer = observerLookup.get(observedSet);\n    if (observer === void 0) {\n        return new SetObserver(flags, lifecycle, observedSet);\n    }\n    return observer;\n}\n//# sourceMappingURL=set-observer.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI, Registration, Reporter, isArrayIndex, } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { getArrayObserver } from './array-observer';\nimport { createComputedObserver } from './computed-observer';\nimport { IDirtyChecker } from './dirty-checker';\nimport { getMapObserver } from './map-observer';\nimport { PrimitiveObserver } from './primitive-observer';\nimport { PropertyAccessor } from './property-accessor';\nimport { ProxyObserver } from './proxy-observer';\nimport { getSetObserver } from './set-observer';\nimport { SetterObserver } from './setter-observer';\nimport { IScheduler } from '../scheduler';\nconst toStringTag = Object.prototype.toString;\nexport const IObserverLocator = DI.createInterface('IObserverLocator').noDefault();\nexport const ITargetObserverLocator = DI.createInterface('ITargetObserverLocator').noDefault();\nexport const ITargetAccessorLocator = DI.createInterface('ITargetAccessorLocator').noDefault();\nfunction getPropertyDescriptor(subject, name) {\n    let pd = Object.getOwnPropertyDescriptor(subject, name);\n    let proto = Object.getPrototypeOf(subject);\n    while (pd == null && proto != null) {\n        pd = Object.getOwnPropertyDescriptor(proto, name);\n        proto = Object.getPrototypeOf(proto);\n    }\n    return pd;\n}\n/** @internal */\nlet ObserverLocator = class ObserverLocator {\n    constructor(lifecycle, scheduler, dirtyChecker, targetObserverLocator, targetAccessorLocator) {\n        this.lifecycle = lifecycle;\n        this.scheduler = scheduler;\n        this.dirtyChecker = dirtyChecker;\n        this.targetObserverLocator = targetObserverLocator;\n        this.targetAccessorLocator = targetAccessorLocator;\n        this.adapters = [];\n    }\n    static register(container) {\n        return Registration.singleton(IObserverLocator, this).register(container);\n    }\n    getObserver(flags, obj, propertyName) {\n        if (flags & 2 /* proxyStrategy */ && typeof obj === 'object') {\n            return ProxyObserver.getOrCreate(obj, propertyName); // TODO: fix typings (and ensure proper contracts ofc)\n        }\n        if (isBindingContext(obj)) {\n            return obj.getObservers(flags).getOrCreate(this.lifecycle, flags, obj, propertyName);\n        }\n        let observersLookup = obj.$observers;\n        if (observersLookup && propertyName in observersLookup) {\n            return observersLookup[propertyName];\n        }\n        const observer = this.createPropertyObserver(flags, obj, propertyName);\n        if (!observer.doNotCache) {\n            if (observersLookup === void 0) {\n                observersLookup = this.getOrCreateObserversLookup(obj);\n            }\n            observersLookup[propertyName] = observer;\n        }\n        return observer;\n    }\n    addAdapter(adapter) {\n        this.adapters.push(adapter);\n    }\n    getAccessor(flags, obj, propertyName) {\n        if (this.targetAccessorLocator.handles(flags, obj)) {\n            if (this.targetObserverLocator.overridesAccessor(flags, obj, propertyName)) {\n                return this.getObserver(flags, obj, propertyName);\n            }\n            return this.targetAccessorLocator.getAccessor(flags, this.scheduler, this.lifecycle, obj, propertyName);\n        }\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(obj, propertyName);\n        }\n        return new PropertyAccessor(obj, propertyName);\n    }\n    getArrayObserver(flags, observedArray) {\n        return getArrayObserver(flags, this.lifecycle, observedArray);\n    }\n    getMapObserver(flags, observedMap) {\n        return getMapObserver(flags, this.lifecycle, observedMap);\n    }\n    getSetObserver(flags, observedSet) {\n        return getSetObserver(flags, this.lifecycle, observedSet);\n    }\n    getOrCreateObserversLookup(obj) {\n        return obj.$observers || this.createObserversLookup(obj);\n    }\n    createObserversLookup(obj) {\n        const value = {};\n        if (!Reflect.defineProperty(obj, '$observers', {\n            enumerable: false,\n            configurable: false,\n            writable: false,\n            value: value\n        })) {\n            Reporter.write(0, obj);\n        }\n        return value;\n    }\n    getAdapterObserver(flags, obj, propertyName, descriptor) {\n        for (let i = 0, ii = this.adapters.length; i < ii; i++) {\n            const adapter = this.adapters[i];\n            const observer = adapter.getObserver(flags, obj, propertyName, descriptor);\n            if (observer != null) {\n                return observer;\n            }\n        }\n        return null;\n    }\n    createPropertyObserver(flags, obj, propertyName) {\n        if (!(obj instanceof Object)) {\n            return new PrimitiveObserver(obj, propertyName);\n        }\n        let isNode = false;\n        if (this.targetObserverLocator.handles(flags, obj)) {\n            const observer = this.targetObserverLocator.getObserver(flags, this.scheduler, this.lifecycle, this, obj, propertyName);\n            if (observer != null) {\n                return observer;\n            }\n            isNode = true;\n        }\n        const tag = toStringTag.call(obj);\n        switch (tag) {\n            case '[object Array]':\n                if (propertyName === 'length') {\n                    return this.getArrayObserver(flags, obj).getLengthObserver();\n                }\n                // is numer only returns true for integer\n                if (isArrayIndex(propertyName)) {\n                    return this.getArrayObserver(flags, obj).getIndexObserver(Number(propertyName));\n                }\n                break;\n            case '[object Map]':\n                if (propertyName === 'size') {\n                    return this.getMapObserver(flags, obj).getLengthObserver();\n                }\n                break;\n            case '[object Set]':\n                if (propertyName === 'size') {\n                    return this.getSetObserver(flags, obj).getLengthObserver();\n                }\n                break;\n        }\n        const descriptor = getPropertyDescriptor(obj, propertyName);\n        if (descriptor != null && (descriptor.get != null || descriptor.set != null)) {\n            if (descriptor.get != null && descriptor.get.getObserver != null) {\n                return descriptor.get.getObserver(obj);\n            }\n            // attempt to use an adapter before resorting to dirty checking.\n            const adapterObserver = this.getAdapterObserver(flags, obj, propertyName, descriptor);\n            if (adapterObserver != null) {\n                return adapterObserver;\n            }\n            if (isNode) {\n                // TODO: use MutationObserver\n                return this.dirtyChecker.createProperty(obj, propertyName);\n            }\n            return createComputedObserver(flags, this, this.dirtyChecker, this.lifecycle, obj, propertyName, descriptor);\n        }\n        return new SetterObserver(this.lifecycle, flags, obj, propertyName);\n    }\n};\nObserverLocator = __decorate([\n    __param(0, ILifecycle),\n    __param(1, IScheduler),\n    __param(2, IDirtyChecker),\n    __param(3, ITargetObserverLocator),\n    __param(4, ITargetAccessorLocator),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object, Object])\n], ObserverLocator);\nexport { ObserverLocator };\nexport function getCollectionObserver(flags, lifecycle, collection) {\n    // If the collection is wrapped by a proxy then `$observer` will return the proxy observer instead of the collection observer, which is not what we want\n    // when we ask for getCollectionObserver\n    const rawCollection = collection instanceof Object ? ProxyObserver.getRawIfProxy(collection) : collection;\n    switch (toStringTag.call(collection)) {\n        case '[object Array]':\n            return getArrayObserver(flags, lifecycle, rawCollection);\n        case '[object Map]':\n            return getMapObserver(flags, lifecycle, rawCollection);\n        case '[object Set]':\n            return getSetObserver(flags, lifecycle, rawCollection);\n    }\n    return void 0;\n}\nfunction isBindingContext(obj) {\n    return obj.$synthetic === true;\n}\n//# sourceMappingURL=observer-locator.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { ILifecycle } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { hasBind, hasUnbind, } from './ast';\nimport { connectable, } from './connectable';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nlet PropertyBinding = class PropertyBinding {\n    constructor(sourceExpression, target, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.targetObserver = void 0;\n        this.persistentFlags = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    ;\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags, this.$scope, this.locator, value, this.part);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if ((this.$state & 4 /* isBound */) === 0) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if ((flags & 16 /* updateTargetInstance */) > 0) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.interceptor.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n                this.interceptor.unobserve(false);\n            }\n            return;\n        }\n        if ((flags & 32 /* updateSourceExpression */) > 0) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.interceptor.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Force property binding to always be strict\n        flags |= 4 /* isStrictBindingStrategy */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            if (this.mode & fromView) {\n                targetObserver = this.targetObserver = this.observerLocator.getObserver(flags, this.target, this.targetProperty);\n            }\n            else {\n                targetObserver = this.targetObserver = this.observerLocator.getAccessor(flags, this.target, this.targetProperty);\n            }\n        }\n        if (this.mode !== BindingMode.oneTime && targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this.interceptor, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver.subscribe(this.interceptor);\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this.interceptor);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nPropertyBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, String, Number, Object, Object])\n], PropertyBinding);\nexport { PropertyBinding };\n//# sourceMappingURL=property-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class CallBinding {\n    constructor(sourceExpression, target, targetProperty, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.targetObserver = observerLocator.getObserver(0 /* none */, target, targetProperty);\n    }\n    callSource(args) {\n        const overrideContext = this.$scope.overrideContext;\n        Object.assign(overrideContext, args);\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        for (const prop in args) {\n            Reflect.deleteProperty(overrideContext, prop);\n        }\n        return result;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        this.targetObserver.setValue(($args) => this.interceptor.callSource($args), flags);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.targetObserver.setValue(null, flags);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=call-binding.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nimport { AccessMemberExpression, AccessScopeExpression, CallMemberExpression, CallScopeExpression, PrimitiveLiteralExpression, } from './ast';\nexport const IExpressionParser = DI.createInterface('IExpressionParser').withDefault(x => x.singleton(ExpressionParser));\n/** @internal */\nexport class ExpressionParser {\n    constructor() {\n        this.expressionLookup = Object.create(null);\n        this.forOfLookup = Object.create(null);\n        this.interpolationLookup = Object.create(null);\n    }\n    parse(expression, bindingType) {\n        switch (bindingType) {\n            case 2048 /* Interpolation */: {\n                let found = this.interpolationLookup[expression];\n                if (found === void 0) {\n                    found = this.interpolationLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            case 539 /* ForCommand */: {\n                let found = this.forOfLookup[expression];\n                if (found === void 0) {\n                    found = this.forOfLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            default: {\n                // Allow empty strings for normal bindings and those that are empty by default (such as a custom attribute without an equals sign)\n                // But don't cache it, because empty strings are always invalid for any other type of binding\n                if (expression.length === 0 && (bindingType & (53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */))) {\n                    return PrimitiveLiteralExpression.$empty;\n                }\n                let found = this.expressionLookup[expression];\n                if (found === void 0) {\n                    found = this.expressionLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n        }\n    }\n    cache(expressions) {\n        const { forOfLookup, expressionLookup, interpolationLookup } = this;\n        for (const expression in expressions) {\n            const expr = expressions[expression];\n            switch (expr.$kind) {\n                case 24 /* Interpolation */:\n                    interpolationLookup[expression] = expr;\n                    break;\n                case 6199 /* ForOfStatement */:\n                    forOfLookup[expression] = expr;\n                    break;\n                default:\n                    expressionLookup[expression] = expr;\n            }\n        }\n    }\n    parseCore(expression, bindingType) {\n        try {\n            const parts = expression.split('.');\n            const firstPart = parts[0];\n            let current;\n            if (firstPart.endsWith('()')) {\n                current = new CallScopeExpression(firstPart.replace('()', ''), PLATFORM.emptyArray);\n            }\n            else {\n                current = new AccessScopeExpression(parts[0]);\n            }\n            let index = 1;\n            while (index < parts.length) {\n                const currentPart = parts[index];\n                if (currentPart.endsWith('()')) {\n                    current = new CallMemberExpression(current, currentPart.replace('()', ''), PLATFORM.emptyArray);\n                }\n                else {\n                    current = new AccessMemberExpression(current, parts[index]);\n                }\n                index++;\n            }\n            return current;\n        }\n        catch (e) {\n            throw Reporter.error(3, e);\n        }\n    }\n}\n/* eslint-disable @typescript-eslint/indent */\nexport var BindingType;\n(function (BindingType) {\n    BindingType[BindingType[\"None\"] = 0] = \"None\";\n    BindingType[BindingType[\"IgnoreCustomAttr\"] = 4096] = \"IgnoreCustomAttr\";\n    BindingType[BindingType[\"Interpolation\"] = 2048] = \"Interpolation\";\n    BindingType[BindingType[\"IsRef\"] = 5376] = \"IsRef\";\n    BindingType[BindingType[\"IsIterator\"] = 512] = \"IsIterator\";\n    BindingType[BindingType[\"IsCustom\"] = 256] = \"IsCustom\";\n    BindingType[BindingType[\"IsFunction\"] = 128] = \"IsFunction\";\n    BindingType[BindingType[\"IsEvent\"] = 64] = \"IsEvent\";\n    BindingType[BindingType[\"IsProperty\"] = 32] = \"IsProperty\";\n    BindingType[BindingType[\"IsCommand\"] = 16] = \"IsCommand\";\n    BindingType[BindingType[\"IsPropertyCommand\"] = 48] = \"IsPropertyCommand\";\n    BindingType[BindingType[\"IsEventCommand\"] = 80] = \"IsEventCommand\";\n    BindingType[BindingType[\"DelegationStrategyDelta\"] = 6] = \"DelegationStrategyDelta\";\n    BindingType[BindingType[\"Command\"] = 15] = \"Command\";\n    BindingType[BindingType[\"OneTimeCommand\"] = 49] = \"OneTimeCommand\";\n    BindingType[BindingType[\"ToViewCommand\"] = 50] = \"ToViewCommand\";\n    BindingType[BindingType[\"FromViewCommand\"] = 51] = \"FromViewCommand\";\n    BindingType[BindingType[\"TwoWayCommand\"] = 52] = \"TwoWayCommand\";\n    BindingType[BindingType[\"BindCommand\"] = 53] = \"BindCommand\";\n    BindingType[BindingType[\"TriggerCommand\"] = 4182] = \"TriggerCommand\";\n    BindingType[BindingType[\"CaptureCommand\"] = 4183] = \"CaptureCommand\";\n    BindingType[BindingType[\"DelegateCommand\"] = 4184] = \"DelegateCommand\";\n    BindingType[BindingType[\"CallCommand\"] = 153] = \"CallCommand\";\n    BindingType[BindingType[\"OptionsCommand\"] = 26] = \"OptionsCommand\";\n    BindingType[BindingType[\"ForCommand\"] = 539] = \"ForCommand\";\n    BindingType[BindingType[\"CustomCommand\"] = 284] = \"CustomCommand\";\n})(BindingType || (BindingType = {}));\n/* eslint-enable @typescript-eslint/indent */\n//# sourceMappingURL=expression-parser.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { IServiceLocator } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nconst { toView, oneTime } = BindingMode;\nexport class MultiInterpolationBinding {\n    constructor(observerLocator, interpolation, target, targetProperty, mode, locator) {\n        this.observerLocator = observerLocator;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        // Note: the child expressions of an Interpolation expression are full Aurelia expressions, meaning they may include\n        // value converters and binding behaviors.\n        // Each expression represents one ${interpolation}, and for each we create a child TextBinding unless there is only one,\n        // in which case the renderer will create the TextBinding directly\n        const expressions = interpolation.expressions;\n        const parts = this.parts = Array(expressions.length);\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            parts[i] = new InterpolationBinding(expressions[i], interpolation, target, targetProperty, mode, observerLocator, locator, i === 0);\n        }\n    }\n    ;\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$bind(flags, scope, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        this.$scope = void 0;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$unbind(flags);\n        }\n    }\n}\nlet InterpolationBinding = class InterpolationBinding {\n    constructor(sourceExpression, interpolation, target, targetProperty, mode, observerLocator, locator, isFirst) {\n        this.sourceExpression = sourceExpression;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.isFirst = isFirst;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.targetObserver = observerLocator.getAccessor(0 /* none */, target, targetProperty);\n    }\n    updateTarget(value, flags) {\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        const previousValue = this.targetObserver.getValue();\n        const newValue = this.interpolation.evaluate(flags, this.$scope, this.locator, this.part);\n        if (newValue !== previousValue) {\n            this.interceptor.updateTarget(newValue, flags);\n        }\n        if ((this.mode & oneTime) === 0) {\n            this.version++;\n            this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n            this.interceptor.unobserve(false);\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        if (this.mode !== BindingMode.oneTime && this.targetObserver.bind) {\n            this.targetObserver.bind(flags);\n        }\n        // since the interpolation already gets the whole value, we only need to let the first\n        // text binding do the update if there are multiple\n        if (this.isFirst) {\n            this.interceptor.updateTarget(this.interpolation.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this.interceptor, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        this.$scope = void 0;\n        this.interceptor.unobserve(true);\n    }\n};\nInterpolationBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, String, Number, Object, Object, Boolean])\n], InterpolationBinding);\nexport { InterpolationBinding };\n//# sourceMappingURL=interpolation-binding.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { ILifecycle, } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nlet LetBinding = class LetBinding {\n    constructor(sourceExpression, targetProperty, observerLocator, locator, toBindingContext = false) {\n        this.sourceExpression = sourceExpression;\n        this.targetProperty = targetProperty;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.toBindingContext = toBindingContext;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.target = null;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const { target, targetProperty } = this;\n            const previousValue = target[targetProperty];\n            const newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            if (newValue !== previousValue) {\n                target[targetProperty] = newValue;\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        this.target = (this.toBindingContext ? scope.bindingContext : scope.overrideContext);\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        // sourceExpression might have been changed during bind\n        this.target[this.targetProperty] = this.sourceExpression.evaluate(flags | 4096 /* fromBind */, scope, this.locator, part);\n        this.sourceExpression.connect(flags, scope, this.interceptor, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nLetBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, String, Object, Object, Boolean])\n], LetBinding);\nexport { LetBinding };\n//# sourceMappingURL=let-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class RefBinding {\n    constructor(sourceExpression, target, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this);\n        }\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, this.target, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        let sourceExpression = this.sourceExpression;\n        if (sourceExpression.evaluate(flags, this.$scope, this.locator, this.part) === this.target) {\n            sourceExpression.assign(flags, this.$scope, this.locator, null, this.part);\n        }\n        // source expression might have been modified durring assign, via a BB\n        sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=ref-binding.js.map","var BindableObserver_1;\nimport { __decorate, __metadata } from \"tslib\";\nimport { Reporter, PLATFORM } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { ProxyObserver } from './proxy-observer';\nimport { subscriberCollection } from './subscriber-collection';\nlet BindableObserver = BindableObserver_1 = class BindableObserver {\n    constructor(lifecycle, flags, obj, propertyKey, cbName, $set) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.$set = $set;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        let isProxy = false;\n        if (ProxyObserver.isProxy(obj)) {\n            isProxy = true;\n            obj.$observer.subscribe(this, propertyKey);\n            this.obj = obj.$raw;\n        }\n        this.callback = this.obj[cbName];\n        const propertyChangedCallback = this.propertyChangedCallback = this.obj.propertyChanged;\n        const hasPropertyChangedCallback = this.hasPropertyChangedCallback = typeof propertyChangedCallback === 'function';\n        const shouldInterceptSet = this.shouldInterceptSet = $set !== PLATFORM.noop;\n        // when user declare @bindable({ set })\n        // it's expected to work from the start,\n        // regardless where the assignment comes from: either direct view model assignment or from binding during render\n        // so if either getter/setter config is present, alter the accessor straight await\n        if (this.callback === void 0 && !hasPropertyChangedCallback && !shouldInterceptSet) {\n            this.observing = false;\n        }\n        else {\n            this.observing = true;\n            const currentValue = obj[propertyKey];\n            this.currentValue = shouldInterceptSet\n                ? currentValue\n                : $set(currentValue);\n            if (!isProxy) {\n                this.createGetterSetter();\n            }\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    handleChange(newValue, oldValue, flags) {\n        this.setValue(newValue, flags);\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.shouldInterceptSet) {\n            newValue = this.$set(newValue);\n        }\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            // eslint-disable-next-line compat/compat\n            if (Object.is(newValue, currentValue)) {\n                return;\n            }\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n                if ((flags & 4096 /* fromBind */) === 0 || (flags & 32 /* updateSourceExpression */) > 0) {\n                    const callback = this.callback;\n                    if (callback !== void 0) {\n                        callback.call(this.obj, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                    if (this.hasPropertyChangedCallback) {\n                        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                        this.propertyChangedCallback.call(this.obj, this.propertyKey, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                }\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // See SetterObserver.setValue for explanation\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            const currentValue = this.obj[this.propertyKey];\n            this.currentValue = this.shouldInterceptSet\n                ? this.$set(currentValue)\n                : currentValue;\n            this.createGetterSetter();\n        }\n        this.addSubscriber(subscriber);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.currentValue,\n            set: (value) => {\n                this.setValue(value, 0 /* none */);\n            }\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nBindableObserver = BindableObserver_1 = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, String, String, Function])\n], BindableObserver);\nexport { BindableObserver };\n//# sourceMappingURL=bindable-observer.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { BindingMode } from '../../flags';\nimport { bindingBehavior } from '../binding-behavior';\nexport class BindingModeBehavior {\n    constructor(mode) {\n        this.mode = mode;\n        this.originalModes = new WeakMap();\n    }\n    bind(flags, scope, binding) {\n        this.originalModes.set(binding, binding.mode);\n        binding.mode = this.mode;\n    }\n    unbind(flags, scope, binding) {\n        binding.mode = this.originalModes.get(binding);\n    }\n}\nlet OneTimeBindingBehavior = class OneTimeBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.oneTime);\n    }\n};\nOneTimeBindingBehavior = __decorate([\n    bindingBehavior('oneTime'),\n    __metadata(\"design:paramtypes\", [])\n], OneTimeBindingBehavior);\nexport { OneTimeBindingBehavior };\nlet ToViewBindingBehavior = class ToViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.toView);\n    }\n};\nToViewBindingBehavior = __decorate([\n    bindingBehavior('toView'),\n    __metadata(\"design:paramtypes\", [])\n], ToViewBindingBehavior);\nexport { ToViewBindingBehavior };\nlet FromViewBindingBehavior = class FromViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.fromView);\n    }\n};\nFromViewBindingBehavior = __decorate([\n    bindingBehavior('fromView'),\n    __metadata(\"design:paramtypes\", [])\n], FromViewBindingBehavior);\nexport { FromViewBindingBehavior };\nlet TwoWayBindingBehavior = class TwoWayBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.twoWay);\n    }\n};\nTwoWayBindingBehavior = __decorate([\n    bindingBehavior('twoWay'),\n    __metadata(\"design:paramtypes\", [])\n], TwoWayBindingBehavior);\nexport { TwoWayBindingBehavior };\n//# sourceMappingURL=binding-mode.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler } from '../../scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet DebounceBindingBehavior = class DebounceBindingBehavior extends BindingInterceptor {\n    constructor(binding, expr) {\n        super(binding, expr);\n        this.opts = { delay: 0 };\n        this.firstArg = null;\n        this.task = null;\n        this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        if (expr.args.length > 0) {\n            this.firstArg = expr.args[0];\n        }\n    }\n    callSource(args) {\n        this.queueTask(() => this.binding.callSource(args));\n        return void 0;\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n    }\n    queueTask(callback) {\n        if (this.task !== null) {\n            this.task.cancel();\n        }\n        this.task = this.taskQueue.queueTask(callback, this.opts);\n    }\n    $bind(flags, scope, part) {\n        if (this.firstArg !== null) {\n            const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, part));\n            if (!isNaN(delay)) {\n                this.opts.delay = delay;\n            }\n        }\n        this.binding.$bind(flags, scope, part);\n    }\n};\nDebounceBindingBehavior = __decorate([\n    bindingBehavior('debounce'),\n    __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n], DebounceBindingBehavior);\nexport { DebounceBindingBehavior };\n//# sourceMappingURL=debounce.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { ISignaler } from '../../observation/signaler';\nimport { bindingBehavior } from '../binding-behavior';\nlet SignalBindingBehavior = class SignalBindingBehavior {\n    constructor(signaler) {\n        this.signaler = signaler;\n    }\n    bind(flags, scope, binding, ...args) {\n        if (!binding.updateTarget) {\n            throw Reporter.error(11);\n        }\n        if (arguments.length === 4) {\n            const name = args[0];\n            this.signaler.addSignalListener(name, binding);\n            binding.signal = name;\n        }\n        else if (arguments.length > 4) {\n            const names = Array.prototype.slice.call(args.length + 3, 3);\n            let i = names.length;\n            while (i--) {\n                const name = names[i];\n                this.signaler.addSignalListener(name, binding);\n            }\n            binding.signal = names;\n        }\n        else {\n            throw Reporter.error(12);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const name = binding.signal;\n        binding.signal = null;\n        if (Array.isArray(name)) {\n            const names = name;\n            let i = names.length;\n            while (i--) {\n                this.signaler.removeSignalListener(names[i], binding);\n            }\n        }\n        else {\n            this.signaler.removeSignalListener(name, binding);\n        }\n    }\n};\nSignalBindingBehavior = __decorate([\n    bindingBehavior('signal'),\n    __param(0, ISignaler),\n    __metadata(\"design:paramtypes\", [Object])\n], SignalBindingBehavior);\nexport { SignalBindingBehavior };\n//# sourceMappingURL=signals.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler, IClock } from '../../scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet ThrottleBindingBehavior = class ThrottleBindingBehavior extends BindingInterceptor {\n    constructor(binding, expr) {\n        super(binding, expr);\n        this.opts = { delay: 0 };\n        this.firstArg = null;\n        this.task = null;\n        this.lastCall = 0;\n        this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        this.clock = binding.locator.get(IClock);\n        if (expr.args.length > 0) {\n            this.firstArg = expr.args[0];\n        }\n    }\n    callSource(args) {\n        this.queueTask(() => this.binding.callSource(args));\n        return void 0;\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n    }\n    queueTask(callback) {\n        const opts = this.opts;\n        const clock = this.clock;\n        const nextDelay = this.lastCall + opts.delay - clock.now();\n        if (nextDelay > 0) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            opts.delay = nextDelay;\n            this.task = this.taskQueue.queueTask(() => {\n                this.lastCall = clock.now();\n                callback();\n            }, opts);\n        }\n        else {\n            this.lastCall = clock.now();\n            callback();\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.firstArg !== null) {\n            const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, part));\n            if (!isNaN(delay)) {\n                this.opts.delay = delay;\n            }\n        }\n        this.binding.$bind(flags, scope, part);\n    }\n};\nThrottleBindingBehavior = __decorate([\n    bindingBehavior('throttle'),\n    __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n], ThrottleBindingBehavior);\nexport { ThrottleBindingBehavior };\n//# sourceMappingURL=throttle.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { kebabCase, Metadata, Protocol, firstDefined, getPrototypeChain, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nexport function bindable(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @bindable\n            // Invocation with or w/o opts:\n            // - @bindable()\n            // - @bindable({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Bindable.name, BindableDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Bindable.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @bindable\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @bindable('bar')\n        // Direct call:\n        // - @bindable('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @bindable()\n    // - @bindable({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isBindableAnnotation(key) {\n    return key.startsWith(Bindable.name);\n}\nexport const Bindable = {\n    name: Protocol.annotation.keyFor('bindable'),\n    keyFrom(name) {\n        return `${Bindable.name}:${name}`;\n    },\n    from(...bindableLists) {\n        const bindables = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            bindables[name] = BindableDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            bindables[name] = def instanceof BindableDefinition ? def : BindableDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof BindableDefinition) {\n                bindables[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList[name]));\n            }\n        }\n        bindableLists.forEach(addList);\n        return bindables;\n    },\n    for(Type) {\n        let def;\n        const builder = {\n            add(configOrProp) {\n                let prop;\n                let config;\n                if (typeof configOrProp === 'string') {\n                    prop = configOrProp;\n                    config = { property: prop };\n                }\n                else {\n                    prop = configOrProp.property;\n                    config = configOrProp;\n                }\n                def = BindableDefinition.create(prop, config);\n                if (!Metadata.hasOwn(Bindable.name, Type, prop)) {\n                    Protocol.annotation.appendTo(Type, Bindable.keyFrom(prop));\n                }\n                Metadata.define(Bindable.name, def, Type, prop);\n                return builder;\n            },\n            mode(mode) {\n                def.mode = mode;\n                return builder;\n            },\n            callback(callback) {\n                def.callback = callback;\n                return builder;\n            },\n            attribute(attribute) {\n                def.attribute = attribute;\n                return builder;\n            },\n            primary() {\n                def.primary = true;\n                return builder;\n            },\n            set(setInterpreter) {\n                def.set = setInterpreter;\n                return builder;\n            }\n        };\n        return builder;\n    },\n    getAll(Type) {\n        const propStart = Bindable.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isBindableAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Bindable.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class BindableDefinition {\n    constructor(attribute, callback, mode, primary, property, set) {\n        this.attribute = attribute;\n        this.callback = callback;\n        this.mode = mode;\n        this.primary = primary;\n        this.property = property;\n        this.set = set;\n    }\n    static create(prop, def = {}) {\n        return new BindableDefinition(firstDefined(def.attribute, kebabCase(prop)), firstDefined(def.callback, `${prop}Changed`), firstDefined(def.mode, BindingMode.toView), firstDefined(def.primary, false), firstDefined(def.property, prop), firstDefined(def.set, PLATFORM.noop));\n    }\n}\n/* eslint-disable @typescript-eslint/no-unused-vars,spaced-comment */\n/**\n * This function serves two purposes:\n * - A playground for contributors to try their changes to the APIs.\n * - Cause the API surface to be properly type-checked and protected against accidental type regressions.\n *\n * It will be automatically removed by dead code elimination.\n */\nfunction apiTypeCheck() {\n    let Foo = \n    // > expected error - class decorator only accepts a string\n    //@bindable({})\n    class Foo {\n    };\n    __decorate([\n        bindable,\n        bindable(),\n        bindable({})\n        // > expected error - 'property' does not exist on decorator input object\n        //@bindable({ property: 'prop' })\n        ,\n        bindable({ mode: BindingMode.twoWay }),\n        bindable({ callback: 'propChanged' }),\n        bindable({ attribute: 'prop' }),\n        bindable({ primary: true }),\n        bindable({ set: value => String(value) }),\n        bindable({ set: value => Number(value) }),\n        bindable({\n            mode: BindingMode.twoWay,\n            callback: 'propChanged',\n            attribute: 'prop',\n            primary: true,\n            set: value => String(value)\n        }),\n        __metadata(\"design:type\", Object)\n    ], Foo.prototype, \"prop\", void 0);\n    Foo = __decorate([\n        bindable('prop')\n        // > expected error - class decorator only accepts a string\n        //@bindable({})\n    ], Foo);\n    Bindable.for(Foo)\n        // > expected error - there is no add() function with only optional params on the fluent api\n        //.add()\n        // > expected error - 'property' is a required property on the fluent api\n        //.add({})\n        .add({ property: 'prop' })\n        .add({ property: 'prop', mode: BindingMode.twoWay })\n        .add({ property: 'prop', callback: 'propChanged' })\n        .add({ property: 'prop', attribute: 'prop' })\n        .add({ property: 'prop', primary: true })\n        .add({ property: 'prop', mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n        .add('prop')\n        // > expected error - the add() method that accepts an object literal does not return a fluent api\n        //.add({ property: 'prop' }).mode(BindingMode.twoWay)\n        //.add({ property: 'prop' }).callback('propChanged')\n        //.add({ property: 'prop' }).attribute('prop')\n        //.add({ property: 'prop' }).primary()\n        // > expected error - fluent api methods can only be invoked once per bindable\n        //.add('prop').mode(BindingMode.twoWay).mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').callback('propChanged') // etc\n        // > expected error - wrong invocation order\n        //.add('prop').callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').primary().mode(BindingMode.twoWay)  // etc\n        .add('prop').mode(BindingMode.twoWay)\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop').primary()\n        .add('prop').mode(BindingMode.twoWay).set((value) => Number(value))\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').set(value => Number(value))\n        .add('prop').callback('propChanged')\n        .add('prop').callback('propChanged').attribute('prop')\n        .add('prop').callback('propChanged').attribute('prop').primary()\n        .add('prop').attribute('prop')\n        .add('prop').attribute('prop').primary()\n        .add('prop').primary();\n}\n/* eslint-enable @typescript-eslint/no-unused-vars,spaced-comment */\n//# sourceMappingURL=bindable.js.map","import { Registration, Protocol, Metadata, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { HooksDefinition, registerAliases, } from '../definitions';\nimport { BindingMode, } from '../flags';\nimport { Bindable } from '../templating/bindable';\nexport function customAttribute(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(nameOrDef, target);\n    };\n}\nexport function templateController(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(typeof nameOrDef === 'string'\n            ? { isTemplateController: true, name: nameOrDef }\n            : { isTemplateController: true, ...nameOrDef }, target);\n    };\n}\nexport class CustomAttributeDefinition {\n    constructor(Type, name, aliases, key, defaultBindingMode, isTemplateController, bindables, strategy, hooks, noMultiBindings) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.defaultBindingMode = defaultBindingMode;\n        this.isTemplateController = isTemplateController;\n        this.bindables = bindables;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.noMultiBindings = noMultiBindings;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new CustomAttributeDefinition(Type, firstDefined(CustomAttribute.getAnnotation(Type, 'name'), name), mergeArrays(CustomAttribute.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), CustomAttribute.keyFrom(name), firstDefined(CustomAttribute.getAnnotation(Type, 'defaultBindingMode'), def.defaultBindingMode, Type.defaultBindingMode, BindingMode.toView), firstDefined(CustomAttribute.getAnnotation(Type, 'isTemplateController'), def.isTemplateController, Type.isTemplateController, false), Bindable.from(...Bindable.getAll(Type), CustomAttribute.getAnnotation(Type, 'bindables'), Type.bindables, def.bindables), firstDefined(CustomAttribute.getAnnotation(Type, 'strategy'), def.strategy, Type.strategy, 1 /* getterSetter */), firstDefined(CustomAttribute.getAnnotation(Type, 'hooks'), def.hooks, Type.hooks, new HooksDefinition(Type.prototype)), firstDefined(CustomAttribute.getAnnotation(Type, 'noMultiBindings'), def.noMultiBindings, Type.noMultiBindings, false));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, CustomAttribute, key, container);\n    }\n}\nexport const CustomAttribute = {\n    name: Protocol.resource.keyFor('custom-attribute'),\n    keyFrom(name) {\n        return `${CustomAttribute.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomAttribute.name, value);\n    },\n    for(node, name) {\n        return Metadata.getOwn(CustomAttribute.keyFrom(name), node);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomAttributeDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomAttribute.name, definition, definition.Type);\n        Metadata.define(CustomAttribute.name, definition, definition);\n        Protocol.resource.appendTo(Type, CustomAttribute.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomAttribute.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=custom-attribute.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nexport const INode = DI.createInterface('INode').noDefault();\nexport const IRenderLocation = DI.createInterface('IRenderLocation').noDefault();\nexport const IDOM = DI.createInterface('IDOM').noDefault();\nconst ni = function (...args) {\n    throw Reporter.error(1000); // TODO: create error code (not implemented exception)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n}; // this function doesn't need typing because it is never directly called\nconst niDOM = {\n    addEventListener: ni,\n    appendChild: ni,\n    cloneNode: ni,\n    convertToRenderLocation: ni,\n    createDocumentFragment: ni,\n    createNodeSequence: ni,\n    createElement: ni,\n    createCustomEvent: ni,\n    dispatchEvent: ni,\n    createNodeObserver: ni,\n    createTemplate: ni,\n    createTextNode: ni,\n    getEffectiveParentNode: ni,\n    setEffectiveParentNode: ni,\n    insertBefore: ni,\n    isMarker: ni,\n    isNodeInstance: ni,\n    isRenderLocation: ni,\n    makeTarget: ni,\n    registerElementResolver: ni,\n    remove: ni,\n    removeEventListener: ni,\n    setAttribute: ni\n};\nexport const DOM = {\n    ...niDOM,\n    scheduler: (void 0),\n    get isInitialized() {\n        return Reflect.get(this, '$initialized') === true;\n    },\n    initialize(dom) {\n        if (this.isInitialized) {\n            throw Reporter.error(1001); // TODO: create error code (already initialized, check isInitialized property and call destroy() if you want to assign a different dom)\n        }\n        const descriptors = {};\n        const protos = [dom];\n        let proto = Object.getPrototypeOf(dom);\n        while (proto && proto !== Object.prototype) {\n            protos.unshift(proto);\n            proto = Object.getPrototypeOf(proto);\n        }\n        for (proto of protos) {\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(proto));\n        }\n        const keys = [];\n        let key;\n        let descriptor;\n        for (key in descriptors) {\n            descriptor = descriptors[key];\n            if (descriptor.configurable && descriptor.writable) {\n                Reflect.defineProperty(this, key, descriptor);\n                keys.push(key);\n            }\n        }\n        Reflect.set(this, '$domKeys', keys);\n        Reflect.set(this, '$initialized', true);\n    },\n    destroy() {\n        if (!this.isInitialized) {\n            throw Reporter.error(1002); // TODO: create error code (already destroyed)\n        }\n        const keys = Reflect.get(this, '$domKeys');\n        keys.forEach(key => {\n            Reflect.deleteProperty(this, key);\n        });\n        Object.assign(this, niDOM);\n        Reflect.set(this, '$domKeys', PLATFORM.emptyArray);\n        Reflect.set(this, '$initialized', false);\n    }\n};\n// This is an implementation of INodeSequence that represents \"no DOM\" to render.\n// It's used in various places to avoid null and to encode\n// the explicit idea of \"no view\".\nconst emptySequence = {\n    isMounted: false,\n    isLinked: false,\n    next: void 0,\n    childNodes: PLATFORM.emptyArray,\n    firstChild: null,\n    lastChild: null,\n    findTargets() { return PLATFORM.emptyArray; },\n    insertBefore(refNode) { },\n    appendTo(parent) { },\n    remove() { },\n    addToLinked() { },\n    unlink() { },\n    link(next) { },\n};\nexport const NodeSequence = {\n    empty: emptySequence\n};\n//# sourceMappingURL=dom.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nclass FlagsTemplateController {\n    constructor(factory, location, flags) {\n        this.factory = factory;\n        this.flags = flags;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | this.flags, this.$controller.scope);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n}\nlet InfrequentMutations = class InfrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 268435456 /* noTargetObserverQueue */);\n    }\n};\nInfrequentMutations = __decorate([\n    templateController('infrequent-mutations'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], InfrequentMutations);\nexport { InfrequentMutations };\nlet FrequentMutations = class FrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 536870912 /* persistentTargetObserverQueue */);\n    }\n};\nFrequentMutations = __decorate([\n    templateController('frequent-mutations'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], FrequentMutations);\nexport { FrequentMutations };\nlet ObserveShallow = class ObserveShallow extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 134217728 /* observeLeafPropertiesOnly */);\n    }\n};\nObserveShallow = __decorate([\n    templateController('observe-shallow'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], ObserveShallow);\nexport { ObserveShallow };\n//# sourceMappingURL=flags.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI, IServiceLocator, Registration, } from '@aurelia/kernel';\nexport const LifecycleTask = {\n    done: {\n        done: true,\n        canCancel() { return false; },\n        cancel() { return; },\n        wait() { return Promise.resolve(); }\n    }\n};\nexport var TaskSlot;\n(function (TaskSlot) {\n    TaskSlot[TaskSlot[\"beforeCreate\"] = 0] = \"beforeCreate\";\n    TaskSlot[TaskSlot[\"beforeRender\"] = 1] = \"beforeRender\";\n    TaskSlot[TaskSlot[\"beforeBind\"] = 2] = \"beforeBind\";\n    TaskSlot[TaskSlot[\"beforeAttach\"] = 3] = \"beforeAttach\";\n})(TaskSlot || (TaskSlot = {}));\nexport const IStartTask = DI.createInterface('IStartTask').noDefault();\nvar TaskType;\n(function (TaskType) {\n    TaskType[TaskType[\"with\"] = 0] = \"with\";\n    TaskType[TaskType[\"from\"] = 1] = \"from\";\n})(TaskType || (TaskType = {}));\n// eslint-disable-next-line @typescript-eslint/class-name-casing\nexport const StartTask = class $StartTask {\n    constructor(type) {\n        this.type = type;\n        this._slot = void 0;\n        this._promiseOrTask = void 0;\n        this._container = void 0;\n        this._key = void 0;\n        this._callback = void 0;\n        this._task = void 0;\n    }\n    get slot() {\n        if (this._slot === void 0) {\n            throw new Error('StartTask.slot is not set');\n        }\n        return this._slot;\n    }\n    get promiseOrTask() {\n        if (this._promiseOrTask === void 0) {\n            throw new Error('StartTask.promiseOrTask is not set');\n        }\n        return this._promiseOrTask;\n    }\n    get container() {\n        if (this._container === void 0) {\n            throw new Error('StartTask.container is not set');\n        }\n        return this._container;\n    }\n    get key() {\n        if (this._key === void 0) {\n            throw new Error('StartTask.key is not set');\n        }\n        return this._key;\n    }\n    get callback() {\n        if (this._callback === void 0) {\n            throw new Error('StartTask.callback is not set');\n        }\n        return this._callback;\n    }\n    get task() {\n        if (this._task === void 0) {\n            throw new Error('StartTask.task is not set');\n        }\n        return this._task;\n    }\n    static with(key) {\n        const task = new $StartTask(0 /* with */);\n        task._key = key;\n        return task;\n    }\n    static from(promiseOrTask) {\n        const task = new $StartTask(1 /* from */);\n        task._promiseOrTask = promiseOrTask;\n        return task;\n    }\n    beforeCreate() {\n        return this.at(0 /* beforeCreate */);\n    }\n    beforeRender() {\n        return this.at(1 /* beforeRender */);\n    }\n    beforeBind() {\n        return this.at(2 /* beforeBind */);\n    }\n    beforeAttach() {\n        return this.at(3 /* beforeAttach */);\n    }\n    at(slot) {\n        this._slot = slot;\n        return this;\n    }\n    call(fn) {\n        this._callback = fn;\n        return this;\n    }\n    register(container) {\n        return this._container = container.register(Registration.instance(IStartTask, this));\n    }\n    resolveTask() {\n        if (this._task === void 0) {\n            switch (this.type) {\n                case 0 /* with */:\n                    this._task = new ProviderTask(this.container, this.key, this.callback);\n                    break;\n                case 1 /* from */:\n                    this._task = new TerminalTask(this.promiseOrTask);\n                    break;\n            }\n        }\n        return this.task;\n    }\n};\nexport const IStartTaskManager = DI.createInterface('IStartTaskManager').noDefault();\nlet StartTaskManager = class StartTaskManager {\n    constructor(locator) {\n        this.locator = locator;\n    }\n    static register(container) {\n        return Registration.singleton(IStartTaskManager, this).register(container);\n    }\n    runBeforeCreate(locator = this.locator) {\n        return this.run(0 /* beforeCreate */, locator);\n    }\n    runBeforeRender(locator = this.locator) {\n        return this.run(1 /* beforeRender */, locator);\n    }\n    runBeforeBind(locator = this.locator) {\n        return this.run(2 /* beforeBind */, locator);\n    }\n    runBeforeAttach(locator = this.locator) {\n        return this.run(3 /* beforeAttach */, locator);\n    }\n    run(slot, locator = this.locator) {\n        const tasks = locator.getAll(IStartTask)\n            .filter(startTask => startTask.slot === slot)\n            .map(startTask => startTask.resolveTask())\n            .filter(task => !task.done);\n        if (tasks.length === 0) {\n            return LifecycleTask.done;\n        }\n        return new AggregateTerminalTask(tasks);\n    }\n};\nStartTaskManager = __decorate([\n    __param(0, IServiceLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], StartTaskManager);\nexport { StartTaskManager };\nexport class PromiseTask {\n    constructor(promise, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = promise.then(value => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            if (next !== null) {\n                const nextResult = next.call(context, value, ...args);\n                if (nextResult === void 0) {\n                    this.done = true;\n                }\n                else {\n                    const nextPromise = nextResult.then instanceof Function\n                        ? nextResult\n                        : nextResult.wait();\n                    return nextPromise.then(() => {\n                        this.done = true;\n                    });\n                }\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class ProviderTask {\n    constructor(container, key, callback) {\n        this.container = container;\n        this.key = key;\n        this.callback = callback;\n        this.done = false;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        if (this.promise === void 0) {\n            const instance = this.container.get(this.key);\n            const maybePromiseOrTask = this.callback.call(void 0, instance);\n            this.promise = maybePromiseOrTask === void 0\n                ? Promise.resolve()\n                : maybePromiseOrTask.then instanceof Function\n                    ? maybePromiseOrTask\n                    : maybePromiseOrTask.wait();\n            this.promise = this.promise.then(() => {\n                this.done = true;\n                this.container = (void 0);\n                this.key = (void 0);\n                this.callback = (void 0);\n            }).catch(e => { throw e; });\n        }\n        return this.promise;\n    }\n}\nexport class ContinuationTask {\n    constructor(antecedent, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        const promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise = promise.then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                const nextPromise = nextResult.then instanceof Function\n                    ? nextResult\n                    : nextResult.wait();\n                return nextPromise.then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class TerminalTask {\n    constructor(antecedent) {\n        this.done = false;\n        this.promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise.then(() => {\n            this.done = true;\n        }).catch(e => { throw e; });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateContinuationTask {\n    constructor(antecedents, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                return nextResult.wait().then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateTerminalTask {\n    constructor(antecedents) {\n        this.done = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            this.done = true;\n        });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport function hasAsyncWork(value) {\n    return !(value === void 0 || value.done === true);\n}\n//# sourceMappingURL=lifecycle-task.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { ContinuationTask, LifecycleTask, PromiseTask } from '../../lifecycle-task';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet If = class If {\n    constructor(ifFactory, location) {\n        this.ifFactory = ifFactory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.elseFactory = void 0;\n        this.elseView = void 0;\n        this.ifView = void 0;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.value = false;\n    }\n    ;\n    beforeBind(flags) {\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    beforeUnbind(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        if (this.ifView !== void 0 && this.ifView.release(flags)) {\n            this.ifView = void 0;\n        }\n        if (this.elseView !== void 0 && this.elseView.release(flags)) {\n            this.elseView = void 0;\n        }\n        this.view = void 0;\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n    }\n    /** @internal */\n    updateView(value, flags) {\n        let view;\n        if (value) {\n            view = this.ifView = this.ensureView(this.ifView, this.ifFactory, flags);\n        }\n        else if (this.elseFactory != void 0) {\n            view = this.elseView = this.ensureView(this.elseView, this.elseFactory, flags);\n        }\n        else {\n            view = void 0;\n        }\n        return view;\n    }\n    /** @internal */\n    ensureView(view, factory, flags) {\n        if (view === void 0) {\n            view = factory.create(flags);\n        }\n        view.hold(this.location, 1 /* insertBefore */);\n        return view;\n    }\n    swap(value, flags) {\n        let task = LifecycleTask.done;\n        if ((value === true && this.elseView !== void 0)\n            || (value !== true && this.ifView !== void 0)) {\n            task = this.deactivate(flags);\n        }\n        if (task.done) {\n            const view = this.updateView(value, flags);\n            task = this.activate(view, flags);\n        }\n        else {\n            task = new PromiseTask(task.wait().then(() => this.updateView(value, flags)), this.activate, this, flags);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags); // TODO: link this up with unbind\n        const task = view.unbind(flags);\n        view.parent = void 0;\n        return task;\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if ((this.$controller.state & 32 /* isAttached */) === 0) {\n            return task;\n        }\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.view.parent = this.$controller;\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n            this.view.attach(flags);\n        }\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], If.prototype, \"value\", void 0);\nIf = __decorate([\n    templateController('if'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], If);\nexport { If };\nlet Else = class Else {\n    constructor(factory) {\n        this.factory = factory;\n        this.id = nextId('au$component');\n    }\n    link(ifBehavior) {\n        if (ifBehavior instanceof If) {\n            ifBehavior.elseFactory = this.factory;\n        }\n        else if (ifBehavior.viewModel instanceof If) {\n            ifBehavior.viewModel.elseFactory = this.factory;\n        }\n        else {\n            throw new Error(`Unsupported IfBehavior`); // TODO: create error code\n        }\n    }\n};\nElse = __decorate([\n    templateController('else'),\n    __param(0, IViewFactory),\n    __metadata(\"design:paramtypes\", [Object])\n], Else);\nexport { Else };\n//# sourceMappingURL=if.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { compareNumber, nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory, IController } from '../../lifecycle';\nimport { AggregateContinuationTask, ContinuationTask, LifecycleTask, } from '../../lifecycle-task';\nimport { applyMutationsToIndices, synchronizeIndices } from '../../observation/array-observer';\nimport { BindingContext, Scope } from '../../observation/binding-context';\nimport { getCollectionObserver } from '../../observation/observer-locator';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet Repeat = class Repeat {\n    constructor(location, renderable, factory) {\n        this.location = location;\n        this.renderable = renderable;\n        this.factory = factory;\n        this.id = nextId('au$component');\n        this.hasPendingInstanceMutation = false;\n        this.observer = void 0;\n        this.views = [];\n        this.key = void 0;\n        this.task = LifecycleTask.done;\n        this.normalizedItems = void 0;\n    }\n    beforeBind(flags) {\n        this.checkCollectionObserver(flags);\n        const bindings = this.renderable.bindings;\n        const { length } = bindings;\n        let binding;\n        for (let i = 0; i < length; ++i) {\n            binding = bindings[i];\n            if (binding.target === this && binding.targetProperty === 'items') {\n                this.forOf = binding.sourceExpression;\n                break;\n            }\n        }\n        this.local = this.forOf.declaration.evaluate(flags, this.$controller.scope, null);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachViews(void 0, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachViews, this, void 0, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.task.done) {\n            this.detachViewsByRange(0, this.views.length, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.detachViewsByRange, this, 0, this.views.length, flags);\n        }\n    }\n    beforeUnbind(flags) {\n        this.checkCollectionObserver(flags);\n        if (this.task.done) {\n            this.task = this.unbindAndRemoveViewsByRange(0, this.views.length, flags, false);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, this.views.length, flags, false);\n        }\n        return this.task;\n    }\n    // called by SetterObserver\n    itemsChanged(flags) {\n        flags |= this.$controller.flags;\n        this.checkCollectionObserver(flags);\n        flags |= 16 /* updateTargetInstance */;\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n    }\n    // called by a CollectionObserver\n    handleCollectionChange(indexMap, flags) {\n        flags |= this.$controller.flags;\n        flags |= (960 /* fromFlush */ | 16 /* updateTargetInstance */);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(indexMap, flags);\n    }\n    processViewsKeyed(indexMap, flags) {\n        const oldLength = this.views.length;\n        if (indexMap === void 0) {\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                this.detachViewsByRange(0, oldLength, flags);\n                if (this.task.done) {\n                    this.task = this.unbindAndRemoveViewsByRange(0, oldLength, flags, false);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, oldLength, flags, false);\n                }\n                if (this.task.done) {\n                    this.task = this.createAndBindAllViews(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindAllViews, this, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.attachViewsKeyed(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.attachViewsKeyed, this, flags);\n                }\n            }\n        }\n        else {\n            applyMutationsToIndices(indexMap);\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                // first detach+unbind+(remove from array) the deleted view indices\n                if (indexMap.deletedItems.length > 0) {\n                    indexMap.deletedItems.sort(compareNumber);\n                    if (this.task.done) {\n                        this.detachViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.detachViewsByKey, this, indexMap, flags);\n                    }\n                    if (this.task.done) {\n                        this.task = this.unbindAndRemoveViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByKey, this, indexMap, flags);\n                    }\n                }\n                // then insert new views at the \"added\" indices to bring the views array in aligment with indexMap size\n                if (this.task.done) {\n                    this.task = this.createAndBindNewViewsByKey(indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindNewViewsByKey, this, indexMap, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.sortViewsByKey(oldLength, indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.sortViewsByKey, this, oldLength, indexMap, flags);\n                }\n            }\n        }\n    }\n    // todo: subscribe to collection from inner expression\n    checkCollectionObserver(flags) {\n        const oldObserver = this.observer;\n        if ((flags & 8192 /* fromUnbind */)) {\n            if (oldObserver !== void 0) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n        }\n        else if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            const newObserver = this.observer = getCollectionObserver(flags, this.$controller.lifecycle, this.items);\n            if (oldObserver !== newObserver && oldObserver) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n            if (newObserver) {\n                newObserver.subscribeToCollection(this);\n            }\n        }\n    }\n    normalizeToArray(flags) {\n        const items = this.items;\n        if (items instanceof Array) {\n            this.normalizedItems = items;\n            return;\n        }\n        const forOf = this.forOf;\n        if (forOf === void 0) {\n            return;\n        }\n        const normalizedItems = [];\n        this.forOf.iterate(flags, items, (arr, index, item) => {\n            normalizedItems[index] = item;\n        });\n        this.normalizedItems = normalizedItems;\n    }\n    detachViewsByRange(iStart, iEnd, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.afterDetach.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.afterDetach.end(flags);\n    }\n    unbindAndRemoveViewsByRange(iStart, iEnd, flags, adjustLength) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.afterUnbind.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        if (adjustLength) {\n            this.views.length = iStart;\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.afterUnbind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.afterUnbind.end, this.$controller.lifecycle.afterUnbind, flags);\n    }\n    detachViewsByKey(indexMap, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.afterDetach.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        for (let i = 0; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.afterDetach.end(flags);\n    }\n    unbindAndRemoveViewsByKey(indexMap, flags) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.afterUnbind.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        let i = 0;\n        for (; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        i = 0;\n        let j = 0;\n        for (; i < deletedLen; ++i) {\n            j = deleted[i] - i;\n            this.views.splice(j, 1);\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.afterUnbind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.afterUnbind.end, this.$controller.lifecycle.afterUnbind, flags);\n    }\n    createAndBindAllViews(flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.afterBind.begin();\n        const part = $controller.part;\n        const factory = this.factory;\n        const local = this.local;\n        const items = this.items;\n        const newLen = this.forOf.count(flags, items);\n        const views = this.views = Array(newLen);\n        this.forOf.iterate(flags, items, (arr, i, item) => {\n            view = views[i] = factory.create(flags);\n            view.parent = $controller;\n            viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, item));\n            setContextualProperties(viewScope.overrideContext, i, newLen);\n            task = view.bind(flags, viewScope, part);\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        });\n        if (tasks === undefined) {\n            lifecycle.afterBind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.afterBind.end, lifecycle.afterBind, flags);\n    }\n    createAndBindNewViewsByKey(indexMap, flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const factory = this.factory;\n        const views = this.views;\n        const local = this.local;\n        const normalizedItems = this.normalizedItems;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.afterBind.begin();\n        const part = $controller.part;\n        const mapLen = indexMap.length;\n        for (let i = 0; i < mapLen; ++i) {\n            if (indexMap[i] === -2) {\n                view = factory.create(flags);\n                // TODO: test with map/set/undefined/null, make sure we can use strong typing here as well, etc\n                view.parent = $controller;\n                viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, normalizedItems[i]));\n                setContextualProperties(viewScope.overrideContext, i, mapLen);\n                // update all the rest oc\n                task = view.bind(flags, viewScope, part);\n                views.splice(i, 0, view);\n                if (!task.done) {\n                    if (tasks === undefined) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (views.length !== mapLen) {\n            // TODO: create error code and use reporter with more informative message\n            throw new Error(`viewsLen=${views.length}, mapLen=${mapLen}`);\n        }\n        if (tasks === undefined) {\n            lifecycle.afterBind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.afterBind.end, lifecycle.afterBind, flags);\n    }\n    attachViews(indexMap, flags) {\n        let view;\n        const views = this.views;\n        const location = this.location;\n        const lifecycle = this.$controller.lifecycle;\n        lifecycle.afterAttach.begin();\n        if (indexMap === void 0) {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                view = views[i];\n                view.hold(location, 1 /* insertBefore */);\n                view.nodes.unlink();\n                view.attach(flags);\n            }\n        }\n        else {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                if (indexMap[i] !== i) {\n                    view = views[i];\n                    view.hold(location, 1 /* insertBefore */);\n                    view.nodes.unlink();\n                    view.attach(flags);\n                }\n            }\n        }\n        lifecycle.afterAttach.end(flags);\n    }\n    attachViewsKeyed(flags) {\n        let view;\n        const { views, location } = this;\n        this.$controller.lifecycle.afterAttach.begin();\n        for (let i = 0, ii = views.length; i < ii; ++i) {\n            view = views[i];\n            view.hold(location, 1 /* insertBefore */);\n            view.nodes.unlink();\n            view.attach(flags);\n        }\n        this.$controller.lifecycle.afterAttach.end(flags);\n    }\n    sortViewsByKey(oldLength, indexMap, flags) {\n        // TODO: integrate with tasks\n        const location = this.location;\n        const views = this.views;\n        const newLen = indexMap.length;\n        synchronizeIndices(views, indexMap);\n        // this algorithm retrieves the indices of the longest increasing subsequence of items in the repeater\n        // the items on those indices are not moved; this minimizes the number of DOM operations that need to be performed\n        const seq = longestIncreasingSubsequence(indexMap);\n        const seqLen = seq.length;\n        this.$controller.lifecycle.afterAttach.begin();\n        flags |= 33554432 /* reorderNodes */;\n        let next;\n        let j = seqLen - 1;\n        let i = newLen - 1;\n        let view;\n        for (; i >= 0; --i) {\n            view = views[i];\n            if (indexMap[i] === -2) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.hold(location, 1 /* insertBefore */);\n                view.attach(flags);\n            }\n            else if (j < 0 || seqLen === 1 || i !== seq[j]) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.attach(flags);\n            }\n            else {\n                if (oldLength !== newLen) {\n                    setContextualProperties(view.scope.overrideContext, i, newLen);\n                }\n                --j;\n            }\n            next = views[i + 1];\n            if (next !== void 0) {\n                view.nodes.link(next.nodes);\n            }\n            else {\n                view.nodes.link(location);\n            }\n        }\n        this.$controller.lifecycle.afterAttach.end(flags);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], Repeat.prototype, \"items\", void 0);\nRepeat = __decorate([\n    templateController('repeat'),\n    __param(0, IRenderLocation),\n    __param(1, IController),\n    __param(2, IViewFactory),\n    __metadata(\"design:paramtypes\", [Object, Object, Object])\n], Repeat);\nexport { Repeat };\nlet maxLen = 16;\nlet prevIndices = new Int32Array(maxLen);\nlet tailIndices = new Int32Array(maxLen);\n// Based on inferno's lis_algorithm @ https://github.com/infernojs/inferno/blob/master/packages/inferno/src/DOM/patching.ts#L732\n// with some tweaks to make it just a bit faster + account for IndexMap (and some names changes for readability)\n/** @internal */\nexport function longestIncreasingSubsequence(indexMap) {\n    const len = indexMap.length;\n    if (len > maxLen) {\n        maxLen = len;\n        prevIndices = new Int32Array(len);\n        tailIndices = new Int32Array(len);\n    }\n    let cursor = 0;\n    let cur = 0;\n    let prev = 0;\n    let i = 0;\n    let j = 0;\n    let low = 0;\n    let high = 0;\n    let mid = 0;\n    for (; i < len; i++) {\n        cur = indexMap[i];\n        if (cur !== -2) {\n            j = prevIndices[cursor];\n            prev = indexMap[j];\n            if (prev !== -2 && prev < cur) {\n                tailIndices[i] = j;\n                prevIndices[++cursor] = i;\n                continue;\n            }\n            low = 0;\n            high = cursor;\n            while (low < high) {\n                mid = (low + high) >> 1;\n                prev = indexMap[prevIndices[mid]];\n                if (prev !== -2 && prev < cur) {\n                    low = mid + 1;\n                }\n                else {\n                    high = mid;\n                }\n            }\n            prev = indexMap[prevIndices[low]];\n            if (cur < prev || prev === -2) {\n                if (low > 0) {\n                    tailIndices[i] = prevIndices[low - 1];\n                }\n                prevIndices[low] = i;\n            }\n        }\n    }\n    i = ++cursor;\n    const result = new Int32Array(i);\n    cur = prevIndices[cursor - 1];\n    while (cursor-- > 0) {\n        result[cursor] = cur;\n        cur = tailIndices[cur];\n    }\n    while (i-- > 0)\n        prevIndices[i] = 0;\n    return result;\n}\nfunction setContextualProperties(oc, index, length) {\n    const isFirst = index === 0;\n    const isLast = index === length - 1;\n    const isEven = index % 2 === 0;\n    oc.$index = index;\n    oc.$first = isFirst;\n    oc.$last = isLast;\n    oc.$middle = !isFirst && !isLast;\n    oc.$even = isEven;\n    oc.$odd = !isEven;\n    oc.$length = length;\n}\n//# sourceMappingURL=repeat.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nlet Replaceable = class Replaceable {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | 67108864 /* allowParentScopeTraversal */, this.$controller.scope, this.factory.name);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n};\nReplaceable = __decorate([\n    templateController('replaceable'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], Replaceable);\nexport { Replaceable };\n//# sourceMappingURL=replaceable.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nimport { bindable } from '../../templating/bindable';\nimport { Scope } from '../../observation/binding-context';\nlet With = class With {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.bindChild(4096 /* fromBind */);\n        }\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        this.bindChild(flags);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        this.view.unbind(flags);\n        this.view.parent = void 0;\n    }\n    bindChild(flags) {\n        const scope = Scope.fromParent(flags, this.$controller.scope, this.value === void 0 ? {} : this.value);\n        this.view.bind(flags, scope, this.$controller.part);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], With.prototype, \"value\", void 0);\nWith = __decorate([\n    templateController('with'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], With);\nexport { With };\n//# sourceMappingURL=with.js.map","var ChildrenObserver_1;\nimport { __decorate, __metadata } from \"tslib\";\n/* eslint-disable @typescript-eslint/no-use-before-define */\nimport { Protocol, Metadata, firstDefined, getPrototypeChain, Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '../resources/custom-element';\nimport { subscriberCollection } from '../observation/subscriber-collection';\nexport function children(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @children\n            // Invocation with or w/o opts:\n            // - @children()\n            // - @children({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Children.name, ChildrenDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Children.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @children\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @children('bar')\n        // Direct call:\n        // - @children('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @children()\n    // - @children({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isChildrenObserverAnnotation(key) {\n    return key.startsWith(Children.name);\n}\nexport const Children = {\n    name: Protocol.annotation.keyFor('children-observer'),\n    keyFrom(name) {\n        return `${Children.name}:${name}`;\n    },\n    from(...childrenObserverLists) {\n        const childrenObservers = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            childrenObservers[name] = ChildrenDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            childrenObservers[name] = ChildrenDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof ChildrenDefinition) {\n                childrenObservers[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList));\n            }\n        }\n        childrenObserverLists.forEach(addList);\n        return childrenObservers;\n    },\n    getAll(Type) {\n        const propStart = Children.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isChildrenObserverAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Children.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class ChildrenDefinition {\n    constructor(callback, property, options, query, filter, map) {\n        this.callback = callback;\n        this.property = property;\n        this.options = options;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n    }\n    static create(prop, def = {}) {\n        return new ChildrenDefinition(firstDefined(def.callback, `${prop}Changed`), firstDefined(def.property, prop), def.options, def.query, def.filter, def.map);\n    }\n}\n/** @internal */\nlet ChildrenObserver = ChildrenObserver_1 = class ChildrenObserver {\n    constructor(controller, obj, flags, propertyKey, cbName, query = defaultChildQuery, filter = defaultChildFilter, map = defaultChildMap, options) {\n        this.controller = controller;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n        this.options = options;\n        this.observing = false;\n        this.children = (void 0);\n        this.callback = obj[cbName];\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.createGetterSetter();\n    }\n    getValue() {\n        this.tryStartObserving();\n        return this.children;\n    }\n    setValue(newValue) { }\n    subscribe(subscriber) {\n        this.tryStartObserving();\n        this.addSubscriber(subscriber);\n    }\n    tryStartObserving() {\n        if (!this.observing) {\n            this.observing = true;\n            const projector = this.controller.projector;\n            this.children = filterChildren(projector, this.query, this.filter, this.map);\n            projector.subscribeToChildrenChange(() => { this.onChildrenChanged(); }, this.options);\n        }\n    }\n    onChildrenChanged() {\n        this.children = filterChildren(this.controller.projector, this.query, this.filter, this.map);\n        if (this.callback !== void 0) {\n            this.callback.call(this.obj);\n        }\n        this.callSubscribers(this.children, undefined, this.persistentFlags | 16 /* updateTargetInstance */);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.getValue(),\n            set: () => { return; },\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nChildrenObserver = ChildrenObserver_1 = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, Number, String, String, Object, Object, Object, Object])\n], ChildrenObserver);\nexport { ChildrenObserver };\nfunction defaultChildQuery(projector) {\n    return projector.children;\n}\nfunction defaultChildFilter(node, controller, viewModel) {\n    return !!viewModel;\n}\nfunction defaultChildMap(node, controller, viewModel) {\n    return viewModel;\n}\n/** @internal */\nexport function filterChildren(projector, query, filter, map) {\n    const nodes = query(projector);\n    const children = [];\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n        const node = nodes[i];\n        const controller = CustomElement.for(node);\n        const viewModel = controller ? controller.viewModel : null;\n        if (filter(node, controller, viewModel)) {\n            children.push(map(node, controller, viewModel));\n        }\n    }\n    return children;\n}\n//# sourceMappingURL=children.js.map","import { DI, Registration, Protocol, Metadata, mergeArrays, fromDefinitionOrDefault, pascalCase, fromAnnotationOrTypeOrDefault, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases, HooksDefinition, } from '../definitions';\nimport { DOM } from '../dom';\nimport { Bindable } from '../templating/bindable';\nimport { Children } from '../templating/children';\nexport function customElement(nameOrDef) {\n    return function (target) {\n        return CustomElement.define(nameOrDef, target);\n    };\n}\nexport function useShadowDOM(targetOrOptions) {\n    if (targetOrOptions === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', { mode: 'open' });\n        };\n    }\n    if (typeof targetOrOptions !== 'function') {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', targetOrOptions);\n        };\n    }\n    CustomElement.annotate(targetOrOptions, 'shadowOptions', { mode: 'open' });\n}\nexport function containerless(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'containerless', true);\n        };\n    }\n    CustomElement.annotate(target, 'containerless', true);\n}\nexport function strict(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'isStrictBinding', true);\n        };\n    }\n    CustomElement.annotate(target, 'isStrictBinding', true);\n}\nconst definitionLookup = new WeakMap();\nexport class CustomElementDefinition {\n    constructor(Type, name, aliases, key, cache, template, instructions, dependencies, injectable, needsCompile, surrogates, bindables, childrenObservers, containerless, isStrictBinding, shadowOptions, hasSlots, strategy, hooks, scopeParts) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.cache = cache;\n        this.template = template;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.injectable = injectable;\n        this.needsCompile = needsCompile;\n        this.surrogates = surrogates;\n        this.bindables = bindables;\n        this.childrenObservers = childrenObservers;\n        this.containerless = containerless;\n        this.isStrictBinding = isStrictBinding;\n        this.shadowOptions = shadowOptions;\n        this.hasSlots = hasSlots;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.scopeParts = scopeParts;\n    }\n    static create(nameOrDef, Type = null) {\n        if (Type === null) {\n            const def = nameOrDef;\n            if (typeof def === 'string') {\n                throw new Error(`Cannot create a custom element definition with only a name and no type: ${nameOrDef}`);\n            }\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const name = fromDefinitionOrDefault('name', def, CustomElement.generateName);\n            if (typeof def.Type === 'function') {\n                // This needs to be a clone (it will usually be the compiler calling this signature)\n                // TODO: we need to make sure it's documented that passing in the type via the definition (while passing in null\n                // as the \"Type\" parameter) effectively skips type analysis, so it should only be used this way for cloning purposes.\n                Type = def.Type;\n            }\n            else {\n                Type = CustomElement.generateType(pascalCase(name));\n            }\n            return new CustomElementDefinition(Type, name, mergeArrays(def.aliases), fromDefinitionOrDefault('key', def, () => CustomElement.keyFrom(name)), fromDefinitionOrDefault('cache', def, () => 0), fromDefinitionOrDefault('template', def, () => null), mergeArrays(def.instructions), mergeArrays(def.dependencies), fromDefinitionOrDefault('injectable', def, () => null), fromDefinitionOrDefault('needsCompile', def, () => true), mergeArrays(def.surrogates), Bindable.from(def.bindables), Children.from(def.childrenObservers), fromDefinitionOrDefault('containerless', def, () => false), fromDefinitionOrDefault('isStrictBinding', def, () => false), fromDefinitionOrDefault('shadowOptions', def, () => null), fromDefinitionOrDefault('hasSlots', def, () => false), fromDefinitionOrDefault('strategy', def, () => 1 /* getterSetter */), fromDefinitionOrDefault('hooks', def, () => HooksDefinition.none), mergeArrays(def.scopeParts));\n        }\n        // If a type is passed in, we ignore the Type property on the definition if it exists.\n        // TODO: document this behavior\n        if (typeof nameOrDef === 'string') {\n            return new CustomElementDefinition(Type, nameOrDef, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), Type.aliases), CustomElement.keyFrom(nameOrDef), fromAnnotationOrTypeOrDefault('cache', Type, () => 0), fromAnnotationOrTypeOrDefault('template', Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), Type.dependencies), fromAnnotationOrTypeOrDefault('injectable', Type, () => null), fromAnnotationOrTypeOrDefault('needsCompile', Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers), fromAnnotationOrTypeOrDefault('containerless', Type, () => false), fromAnnotationOrTypeOrDefault('isStrictBinding', Type, () => false), fromAnnotationOrTypeOrDefault('shadowOptions', Type, () => null), fromAnnotationOrTypeOrDefault('hasSlots', Type, () => false), fromAnnotationOrTypeOrDefault('strategy', Type, () => 1 /* getterSetter */), \n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), Type.scopeParts));\n        }\n        // This is the typical default behavior, e.g. from regular CustomElement.define invocations or from @customElement deco\n        // The ViewValueConverter also uses this signature and passes in a definition where everything except for the 'hooks'\n        // property needs to be copied. So we have that exception for 'hooks', but we may need to revisit that default behavior\n        // if this turns out to be too opinionated.\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const name = fromDefinitionOrDefault('name', nameOrDef, CustomElement.generateName);\n        return new CustomElementDefinition(Type, name, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), nameOrDef.aliases, Type.aliases), CustomElement.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('cache', nameOrDef, Type, () => 0), fromAnnotationOrDefinitionOrTypeOrDefault('template', nameOrDef, Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), nameOrDef.instructions, Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), nameOrDef.dependencies, Type.dependencies), fromAnnotationOrDefinitionOrTypeOrDefault('injectable', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('needsCompile', nameOrDef, Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), nameOrDef.surrogates, Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables, nameOrDef.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers, nameOrDef.childrenObservers), fromAnnotationOrDefinitionOrTypeOrDefault('containerless', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('isStrictBinding', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('shadowOptions', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('hasSlots', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', nameOrDef, Type, () => 1 /* getterSetter */), \n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), nameOrDef.scopeParts, Type.scopeParts));\n    }\n    static getOrCreate(partialDefinition) {\n        if (partialDefinition instanceof CustomElementDefinition) {\n            return partialDefinition;\n        }\n        if (definitionLookup.has(partialDefinition)) {\n            return definitionLookup.get(partialDefinition);\n        }\n        const definition = CustomElementDefinition.create(partialDefinition);\n        definitionLookup.set(partialDefinition, definition);\n        // Make sure the full definition can be retrieved from dynamically created classes as well\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        return definition;\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, CustomElement, key, container);\n    }\n}\nexport const CustomElement = {\n    name: Protocol.resource.keyFor('custom-element'),\n    keyFrom(name) {\n        return `${CustomElement.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomElement.name, value);\n    },\n    for(node, nameOrSearchParents, searchParents) {\n        if (nameOrSearchParents === void 0) {\n            return Metadata.getOwn(CustomElement.name, node);\n        }\n        if (typeof nameOrSearchParents === 'string') {\n            if (searchParents !== true) {\n                const controller = Metadata.getOwn(CustomElement.name, node);\n                if (controller === void 0) {\n                    return (void 0);\n                }\n                if (controller.is(nameOrSearchParents)) {\n                    return controller;\n                }\n                return (void 0);\n            }\n            let cur = node;\n            while (cur !== null) {\n                const controller = Metadata.getOwn(CustomElement.name, cur);\n                if (controller !== void 0 && controller.is(nameOrSearchParents)) {\n                    return controller;\n                }\n                cur = DOM.getEffectiveParentNode(cur);\n            }\n            return (void 0);\n        }\n        let cur = node;\n        while (cur !== null) {\n            const controller = Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        return (void 0);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomElementDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        Metadata.define(CustomElement.name, definition, definition);\n        Protocol.resource.appendTo(definition.Type, CustomElement.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomElement.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n    generateName: (function () {\n        let id = 0;\n        return function () {\n            return `unnamed-${++id}`;\n        };\n    })(),\n    createInjectable() {\n        const $injectable = function (target, property, index) {\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = $injectable;\n            return target;\n        };\n        $injectable.register = function (container) {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            return {\n                resolve(container, requestor) {\n                    if (requestor.has($injectable, true)) {\n                        return requestor.get($injectable);\n                    }\n                    else {\n                        return null;\n                    }\n                },\n            };\n        };\n        return $injectable;\n    },\n    generateType: (function () {\n        const nameDescriptor = {\n            value: '',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const defaultProto = {};\n        return function (name, proto = defaultProto) {\n            // Anonymous class ensures that minification cannot cause unintended side-effects, and keeps the class\n            // looking similarly from the outside (when inspected via debugger, etc).\n            const Type = class {\n            };\n            // Define the name property so that Type.name can be used by end users / plugin authors if they really need to,\n            // even when minified.\n            nameDescriptor.value = name;\n            Reflect.defineProperty(Type, 'name', nameDescriptor);\n            // Assign anything from the prototype that was passed in\n            if (proto !== defaultProto) {\n                Object.assign(Type.prototype, proto);\n            }\n            return Type;\n        };\n    })(),\n};\nexport const IProjectorLocator = DI.createInterface('IProjectorLocator').noDefault();\n//# sourceMappingURL=custom-element.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI } from '@aurelia/kernel';\nimport { valueConverter } from '../value-converter';\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\nexport const ISanitizer = DI.createInterface('ISanitizer').withDefault(x => x.singleton(class {\n    sanitize(input) {\n        return input.replace(SCRIPT_REGEX, '');\n    }\n}));\n/**\n * Simple html sanitization converter to preserve whitelisted elements and attributes on a bound property containing html.\n */\nlet SanitizeValueConverter = class SanitizeValueConverter {\n    constructor(sanitizer) {\n        this.sanitizer = sanitizer;\n    }\n    /**\n     * Process the provided markup that flows to the view.\n     *\n     * @param untrustedMarkup - The untrusted markup to be sanitized.\n     */\n    toView(untrustedMarkup) {\n        if (untrustedMarkup == null) {\n            return null;\n        }\n        return this.sanitizer.sanitize(untrustedMarkup);\n    }\n};\nSanitizeValueConverter = __decorate([\n    valueConverter('sanitize'),\n    __param(0, ISanitizer),\n    __metadata(\"design:paramtypes\", [Object])\n], SanitizeValueConverter);\nexport { SanitizeValueConverter };\n//# sourceMappingURL=sanitize.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { all, Registration, Metadata, DI, } from '@aurelia/kernel';\nimport { CallBinding } from './binding/call-binding';\nimport { IExpressionParser } from './binding/expression-parser';\nimport { InterpolationBinding, MultiInterpolationBinding } from './binding/interpolation-binding';\nimport { LetBinding } from './binding/let-binding';\nimport { PropertyBinding } from './binding/property-binding';\nimport { RefBinding } from './binding/ref-binding';\nimport { mergeParts } from './definitions';\nimport { BindingMode } from './flags';\nimport { ILifecycle, } from './lifecycle';\nimport { IObserverLocator } from './observation/observer-locator';\nimport { CustomAttribute, } from './resources/custom-attribute';\nimport { CustomElement, } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nimport { getRenderContext } from './templating/render-context';\nimport { BindingBehaviorExpression } from './binding/ast';\nimport { BindingBehaviorFactory } from './resources/binding-behavior';\nexport const ITemplateCompiler = DI.createInterface('ITemplateCompiler').noDefault();\nexport const IInstructionRenderer = DI.createInterface('IInstructionRenderer').noDefault();\nexport const IRenderer = DI.createInterface('IRenderer').noDefault();\nexport function instructionRenderer(instructionType) {\n    return function decorator(target) {\n        // wrap the constructor to set the instructionType to the instance (for better performance than when set on the prototype)\n        const decoratedTarget = function (...args) {\n            const instance = new target(...args);\n            instance.instructionType = instructionType;\n            return instance;\n        };\n        // make sure we register the decorated constructor with DI\n        decoratedTarget.register = function register(container) {\n            Registration.singleton(IInstructionRenderer, decoratedTarget).register(container);\n        };\n        // copy over any metadata such as annotations (set by preceding decorators) as well as static properties set by the user\n        // also copy the name, to be less confusing to users (so they can still use constructor.name for whatever reason)\n        // the length (number of ctor arguments) is copied for the same reason\n        const metadataKeys = Metadata.getOwnKeys(target);\n        for (const key of metadataKeys) {\n            Metadata.define(key, Metadata.getOwn(key, target), decoratedTarget);\n        }\n        const ownProperties = Object.getOwnPropertyDescriptors(target);\n        Object.keys(ownProperties).filter(prop => prop !== 'prototype').forEach(prop => {\n            Reflect.defineProperty(decoratedTarget, prop, ownProperties[prop]);\n        });\n        return decoratedTarget;\n    };\n}\n/* @internal */\nlet Renderer = class Renderer {\n    constructor(instructionRenderers) {\n        const record = this.instructionRenderers = {};\n        instructionRenderers.forEach(item => {\n            // Binding the functions to the renderer instances and calling the functions directly,\n            // prevents the `render` call sites from going megamorphic.\n            // Consumes slightly more memory but significantly less CPU.\n            record[item.instructionType] = item.render.bind(item);\n        });\n    }\n    static register(container) {\n        return Registration.singleton(IRenderer, this).register(container);\n    }\n    render(flags, context, controller, targets, definition, host, parts) {\n        const targetInstructions = definition.instructions;\n        if (targets.length !== targetInstructions.length) {\n            throw new Error(`The compiled template is not aligned with the render instructions. There are ${targets.length} targets and ${targetInstructions.length} instructions.`);\n        }\n        for (let i = 0, ii = targets.length; i < ii; ++i) {\n            this.renderInstructions(\n            /* flags        */ flags, \n            /* context      */ context, \n            /* instructions */ targetInstructions[i], \n            /* controller   */ controller, \n            /* target       */ targets[i], \n            /* parts        */ parts);\n        }\n        if (host !== void 0 && host !== null) {\n            this.renderInstructions(\n            /* flags        */ flags, \n            /* context      */ context, \n            /* instructions */ definition.surrogates, \n            /* controller   */ controller, \n            /* target       */ host, \n            /* parts        */ parts);\n        }\n    }\n    renderInstructions(flags, context, instructions, controller, target, parts) {\n        const instructionRenderers = this.instructionRenderers;\n        let current;\n        for (let i = 0, ii = instructions.length; i < ii; ++i) {\n            current = instructions[i];\n            instructionRenderers[current.type](flags, context, controller, target, current, parts);\n        }\n    }\n};\nRenderer = __decorate([\n    __param(0, all(IInstructionRenderer)),\n    __metadata(\"design:paramtypes\", [Array])\n], Renderer);\nexport { Renderer };\nexport function ensureExpression(parser, srcOrExpr, bindingType) {\n    if (typeof srcOrExpr === 'string') {\n        return parser.parse(srcOrExpr, bindingType);\n    }\n    return srcOrExpr;\n}\nexport function getTarget(potentialTarget) {\n    if (potentialTarget.bindingContext !== void 0) {\n        return potentialTarget.bindingContext;\n    }\n    return potentialTarget;\n}\nexport function getRefTarget(refHost, refTargetName) {\n    if (refTargetName === 'element') {\n        return refHost;\n    }\n    switch (refTargetName) {\n        case 'controller':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost);\n        case 'view':\n            // todo: returns node sequences for fun?\n            throw new Error('Not supported API');\n        case 'view-model':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost).viewModel;\n        default: {\n            const caController = CustomAttribute.for(refHost, refTargetName);\n            if (caController !== void 0) {\n                return caController.viewModel;\n            }\n            const ceController = CustomElement.for(refHost, refTargetName);\n            if (ceController === void 0) {\n                throw new Error(`Attempted to reference \"${refTargetName}\", but it was not found amongst the target's API.`);\n            }\n            return ceController.viewModel;\n        }\n    }\n}\nlet SetPropertyRenderer = \n/** @internal */\nclass SetPropertyRenderer {\n    render(flags, context, controller, target, instruction) {\n        const obj = getTarget(target);\n        if (obj.$observers !== void 0 && obj.$observers[instruction.to] !== void 0) {\n            obj.$observers[instruction.to].setValue(instruction.value, 4096 /* fromBind */);\n        }\n        else {\n            obj[instruction.to] = instruction.value;\n        }\n    }\n};\nSetPropertyRenderer = __decorate([\n    instructionRenderer(\"re\" /* setProperty */)\n    /** @internal */\n], SetPropertyRenderer);\nexport { SetPropertyRenderer };\nlet CustomElementRenderer = \n/** @internal */\nclass CustomElementRenderer {\n    render(flags, context, controller, target, instruction, parts) {\n        parts = mergeParts(parts, instruction.parts);\n        const factory = context.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ void 0, \n        /* location         */ target);\n        const key = CustomElement.keyFrom(instruction.res);\n        const component = factory.createComponent(key);\n        const lifecycle = context.get(ILifecycle);\n        const childController = Controller.forCustomElement(\n        /* viewModel       */ component, \n        /* lifecycle       */ lifecycle, \n        /* host            */ target, \n        /* parentContainer */ context, \n        /* parts           */ parts, \n        /* flags           */ flags);\n        flags = childController.flags;\n        Metadata.define(key, childController, target);\n        context.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        factory.dispose();\n    }\n};\nCustomElementRenderer = __decorate([\n    instructionRenderer(\"ra\" /* hydrateElement */)\n    /** @internal */\n], CustomElementRenderer);\nexport { CustomElementRenderer };\nlet CustomAttributeRenderer = \n/** @internal */\nclass CustomAttributeRenderer {\n    render(flags, context, controller, target, instruction, parts) {\n        const factory = context.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ void 0, \n        /* location         */ void 0);\n        const key = CustomAttribute.keyFrom(instruction.res);\n        const component = factory.createComponent(key);\n        const lifecycle = context.get(ILifecycle);\n        const childController = Controller.forCustomAttribute(\n        /* viewModel */ component, \n        /* lifecycle */ lifecycle, \n        /* flags     */ flags);\n        Metadata.define(key, childController, target);\n        context.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        factory.dispose();\n    }\n};\nCustomAttributeRenderer = __decorate([\n    instructionRenderer(\"rb\" /* hydrateAttribute */)\n    /** @internal */\n], CustomAttributeRenderer);\nexport { CustomAttributeRenderer };\nlet TemplateControllerRenderer = \n/** @internal */\nclass TemplateControllerRenderer {\n    render(flags, parentContext, controller, target, instruction, parts) {\n        parts = mergeParts(parts, instruction.parts);\n        const viewFactory = getRenderContext(instruction.def, parentContext, parts).getViewFactory();\n        const renderLocation = parentContext.dom.convertToRenderLocation(target);\n        const componentFactory = parentContext.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ viewFactory, \n        /* location         */ renderLocation);\n        const key = CustomAttribute.keyFrom(instruction.res);\n        const component = componentFactory.createComponent(key);\n        const lifecycle = parentContext.get(ILifecycle);\n        const childController = Controller.forCustomAttribute(\n        /* viewModel */ component, \n        /* lifecycle */ lifecycle, \n        /* flags     */ flags);\n        Metadata.define(key, childController, renderLocation);\n        if (instruction.link) {\n            const controllers = controller.controllers;\n            component.link(controllers[controllers.length - 1]);\n        }\n        parentContext.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        componentFactory.dispose();\n    }\n};\nTemplateControllerRenderer = __decorate([\n    instructionRenderer(\"rc\" /* hydrateTemplateController */)\n    /** @internal */\n], TemplateControllerRenderer);\nexport { TemplateControllerRenderer };\nlet LetElementRenderer = \n/** @internal */\nclass LetElementRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        context.dom.remove(target);\n        const childInstructions = instruction.instructions;\n        const toBindingContext = instruction.toBindingContext;\n        let childInstruction;\n        let expr;\n        let binding;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            childInstruction = childInstructions[i];\n            expr = ensureExpression(this.parser, childInstruction.from, 48 /* IsPropertyCommand */);\n            binding = applyBindingBehavior(new LetBinding(expr, childInstruction.to, this.observerLocator, context, toBindingContext), expr, context);\n            controller.addBinding(binding);\n        }\n    }\n};\nLetElementRenderer = __decorate([\n    instructionRenderer(\"rd\" /* hydrateLetElement */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], LetElementRenderer);\nexport { LetElementRenderer };\nlet CallBindingRenderer = \n/** @internal */\nclass CallBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 153 /* CallCommand */);\n        const binding = applyBindingBehavior(new CallBinding(expr, getTarget(target), instruction.to, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nCallBindingRenderer = __decorate([\n    instructionRenderer(\"rh\" /* callBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], CallBindingRenderer);\nexport { CallBindingRenderer };\nlet RefBindingRenderer = \n/** @internal */\nclass RefBindingRenderer {\n    constructor(parser) {\n        this.parser = parser;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 5376 /* IsRef */);\n        const binding = applyBindingBehavior(new RefBinding(expr, getRefTarget(target, instruction.to), context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nRefBindingRenderer = __decorate([\n    instructionRenderer(\"rj\" /* refBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __metadata(\"design:paramtypes\", [Object])\n], RefBindingRenderer);\nexport { RefBindingRenderer };\nlet InterpolationBindingRenderer = \n/** @internal */\nclass InterpolationBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, getTarget(target), instruction.to, BindingMode.toView, context), expr, context);\n        }\n        else {\n            binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context, true), expr, context);\n        }\n        controller.addBinding(binding);\n    }\n};\nInterpolationBindingRenderer = __decorate([\n    instructionRenderer(\"rf\" /* interpolation */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], InterpolationBindingRenderer);\nexport { InterpolationBindingRenderer };\nlet PropertyBindingRenderer = \n/** @internal */\nclass PropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | instruction.mode);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, instruction.mode, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nPropertyBindingRenderer = __decorate([\n    instructionRenderer(\"rg\" /* propertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], PropertyBindingRenderer);\nexport { PropertyBindingRenderer };\nlet IteratorBindingRenderer = \n/** @internal */\nclass IteratorBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 539 /* ForCommand */);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nIteratorBindingRenderer = __decorate([\n    instructionRenderer(\"rk\" /* iteratorBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], IteratorBindingRenderer);\nexport { IteratorBindingRenderer };\nlet behaviorExpressionIndex = 0;\nconst behaviorExpressions = [];\nexport function applyBindingBehavior(binding, expression, locator) {\n    while (expression instanceof BindingBehaviorExpression) {\n        behaviorExpressions[behaviorExpressionIndex++] = expression;\n        expression = expression.expression;\n    }\n    while (behaviorExpressionIndex > 0) {\n        const behaviorExpression = behaviorExpressions[--behaviorExpressionIndex];\n        const behaviorOrFactory = locator.get(behaviorExpression.behaviorKey);\n        if (behaviorOrFactory instanceof BindingBehaviorFactory) {\n            binding = behaviorOrFactory.construct(binding, behaviorExpression);\n        }\n    }\n    behaviorExpressions.length = 0;\n    return binding;\n}\n//# sourceMappingURL=renderer.js.map","import { CustomElementDefinition } from '../resources/custom-element';\nimport { ITargetedInstruction, mergeParts } from '../definitions';\nimport { InstanceProvider, Reporter } from '@aurelia/kernel';\nimport { IController, IViewFactory, ILifecycle } from '../lifecycle';\nimport { IDOM, IRenderLocation } from '../dom';\nimport { IRenderer, ITemplateCompiler } from '../renderer';\nimport { ViewFactory } from './view';\nconst definitionContainerLookup = new WeakMap();\nconst definitionContainerPartsLookup = new WeakMap();\nconst fragmentCache = new WeakMap();\nexport function isRenderContext(value) {\n    return value instanceof RenderContext;\n}\nexport function getRenderContext(partialDefinition, parentContainer, parts) {\n    const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n    if (isRenderContext(parentContainer)) {\n        parts = mergeParts(parentContainer.parts, parts);\n    }\n    // injectable completely prevents caching, ensuring that each instance gets a new render context\n    if (definition.injectable !== null) {\n        return new RenderContext(definition, parentContainer, parts);\n    }\n    if (parts === void 0) {\n        let containerLookup = definitionContainerLookup.get(definition);\n        if (containerLookup === void 0) {\n            definitionContainerLookup.set(definition, containerLookup = new WeakMap());\n        }\n        let context = containerLookup.get(parentContainer);\n        if (context === void 0) {\n            containerLookup.set(parentContainer, context = new RenderContext(definition, parentContainer, parts));\n        }\n        return context;\n    }\n    let containerPartsLookup = definitionContainerPartsLookup.get(definition);\n    if (containerPartsLookup === void 0) {\n        definitionContainerPartsLookup.set(definition, containerPartsLookup = new WeakMap());\n    }\n    let partsLookup = containerPartsLookup.get(parentContainer);\n    if (partsLookup === void 0) {\n        containerPartsLookup.set(parentContainer, partsLookup = new WeakMap());\n    }\n    let context = partsLookup.get(parts);\n    if (context === void 0) {\n        partsLookup.set(parts, context = new RenderContext(definition, parentContainer, parts));\n    }\n    return context;\n}\nexport class RenderContext {\n    constructor(definition, parentContainer, parts) {\n        this.definition = definition;\n        this.parentContainer = parentContainer;\n        this.parts = parts;\n        this.viewModelProvider = void 0;\n        this.fragment = null;\n        this.factory = void 0;\n        this.isCompiled = false;\n        this.compiledDefinition = (void 0);\n        const container = this.container = parentContainer.createChild();\n        this.renderer = container.get(IRenderer);\n        container.registerResolver(IViewFactory, this.factoryProvider = new ViewFactoryProvider());\n        container.registerResolver(IController, this.parentControllerProvider = new InstanceProvider());\n        container.registerResolver(ITargetedInstruction, this.instructionProvider = new InstanceProvider());\n        container.registerResolver(IRenderLocation, this.renderLocationProvider = new InstanceProvider());\n        (this.dom = container.get(IDOM)).registerElementResolver(container, this.elementProvider = new InstanceProvider());\n        container.register(...definition.dependencies);\n    }\n    // #region IServiceLocator api\n    has(key, searchAncestors) {\n        return this.container.has(key, searchAncestors);\n    }\n    get(key) {\n        return this.container.get(key);\n    }\n    getAll(key) {\n        return this.container.getAll(key);\n    }\n    // #endregion\n    // #region IContainer api\n    register(...params) {\n        return this.container.register(...params);\n    }\n    registerResolver(key, resolver) {\n        return this.container.registerResolver(key, resolver);\n    }\n    registerTransformer(key, transformer) {\n        return this.container.registerTransformer(key, transformer);\n    }\n    getResolver(key, autoRegister) {\n        return this.container.getResolver(key, autoRegister);\n    }\n    getFactory(key) {\n        return this.container.getFactory(key);\n    }\n    createChild() {\n        return this.container.createChild();\n    }\n    // #endregion\n    // #region IRenderContext api\n    compile() {\n        let compiledDefinition;\n        if (this.isCompiled) {\n            return this;\n        }\n        this.isCompiled = true;\n        const definition = this.definition;\n        if (definition.needsCompile) {\n            const container = this.container;\n            const compiler = container.get(ITemplateCompiler);\n            compiledDefinition = this.compiledDefinition = compiler.compile(definition, container);\n        }\n        else {\n            compiledDefinition = this.compiledDefinition = definition;\n        }\n        // Support Recursive Components by adding self to own context\n        compiledDefinition.register(this);\n        if (fragmentCache.has(compiledDefinition)) {\n            this.fragment = fragmentCache.get(compiledDefinition);\n        }\n        else {\n            const template = compiledDefinition.template;\n            if (template === null) {\n                fragmentCache.set(compiledDefinition, null);\n            }\n            else {\n                fragmentCache.set(compiledDefinition, this.fragment = this.dom.createDocumentFragment(template));\n            }\n        }\n        return this;\n    }\n    getViewFactory(name) {\n        let factory = this.factory;\n        if (factory === void 0) {\n            if (name === void 0) {\n                name = this.definition.name;\n            }\n            const lifecycle = this.parentContainer.get(ILifecycle);\n            factory = this.factory = new ViewFactory(name, this, lifecycle, this.parts);\n        }\n        return factory;\n    }\n    beginChildComponentOperation(instance) {\n        const definition = this.definition;\n        if (definition.injectable !== null) {\n            if (this.viewModelProvider === void 0) {\n                this.container.registerResolver(definition.injectable, this.viewModelProvider = new InstanceProvider());\n            }\n            this.viewModelProvider.prepare(instance);\n        }\n        return this;\n    }\n    // #endregion\n    // #region ICompiledRenderContext api\n    createNodes() {\n        return this.dom.createNodeSequence(this.fragment);\n    }\n    // TODO: split up into 2 methods? getComponentFactory + getSyntheticFactory or something\n    getComponentFactory(parentController, host, instruction, viewFactory, location) {\n        if (parentController !== void 0) {\n            this.parentControllerProvider.prepare(parentController);\n        }\n        if (host !== void 0) {\n            // TODO: fix provider input type, Key is probably not a good constraint\n            this.elementProvider.prepare(host);\n        }\n        if (instruction !== void 0) {\n            this.instructionProvider.prepare(instruction);\n        }\n        if (location !== void 0) {\n            this.renderLocationProvider.prepare(location);\n        }\n        if (viewFactory !== void 0) {\n            this.factoryProvider.prepare(viewFactory);\n        }\n        return this;\n    }\n    // #endregion\n    // #region IComponentFactory api\n    createComponent(resourceKey) {\n        return this.container.get(resourceKey);\n    }\n    render(flags, controller, targets, templateDefinition, host, parts) {\n        this.renderer.render(flags, this, controller, targets, templateDefinition, host, parts);\n    }\n    renderInstructions(flags, instructions, controller, target, parts) {\n        this.renderer.renderInstructions(flags, this, instructions, controller, target, parts);\n    }\n    dispose() {\n        this.factoryProvider.dispose();\n        this.parentControllerProvider.dispose();\n        this.instructionProvider.dispose();\n        this.elementProvider.dispose();\n        this.renderLocationProvider.dispose();\n    }\n}\n/** @internal */\nexport class ViewFactoryProvider {\n    constructor() {\n        this.factory = null;\n    }\n    prepare(factory) {\n        this.factory = factory;\n    }\n    resolve(handler, requestor) {\n        const factory = this.factory;\n        if (factory === null) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        if (typeof factory.name !== 'string' || factory.name.length === 0) { // unmet invariant: factory must have a name\n            throw Reporter.error(51); // TODO: organize error codes\n        }\n        return factory.resolve(requestor);\n    }\n    dispose() {\n        this.factory = null;\n    }\n}\n//# sourceMappingURL=render-context.js.map","import { mergeDistinct, nextId, } from '@aurelia/kernel';\nimport { HooksDefinition, } from '../definitions';\nimport { AggregateContinuationTask, ContinuationTask, hasAsyncWork, LifecycleTask, } from '../lifecycle-task';\nimport { Scope, } from '../observation/binding-context';\nimport { ProxyObserver, } from '../observation/proxy-observer';\nimport { BindableObserver, } from '../observation/bindable-observer';\nimport { IProjectorLocator, CustomElementDefinition, CustomElement, } from '../resources/custom-element';\nimport { CustomAttribute, } from '../resources/custom-attribute';\nimport { getRenderContext, } from './render-context';\nimport { ChildrenObserver } from './children';\nconst controllerLookup = new WeakMap();\nexport class Controller {\n    constructor(vmKind, flags, lifecycle, hooks, \n    /**\n     * The viewFactory. Only present for synthetic views.\n     */\n    viewFactory, \n    /**\n     * The backing viewModel. This is never a proxy. Only present for custom attributes and elements.\n     */\n    viewModel, \n    /**\n     * The binding context. This may be a proxy. If it is not, then it is the same instance as the viewModel. Only present for custom attributes and elements.\n     */\n    bindingContext, \n    /**\n     * The physical host dom node. Only present for custom elements.\n     */\n    host) {\n        this.vmKind = vmKind;\n        this.flags = flags;\n        this.lifecycle = lifecycle;\n        this.hooks = hooks;\n        this.viewFactory = viewFactory;\n        this.viewModel = viewModel;\n        this.bindingContext = bindingContext;\n        this.host = host;\n        this.id = nextId('au$component');\n        this.nextBound = void 0;\n        this.nextUnbound = void 0;\n        this.prevBound = void 0;\n        this.prevUnbound = void 0;\n        this.nextAttached = void 0;\n        this.nextDetached = void 0;\n        this.prevAttached = void 0;\n        this.prevDetached = void 0;\n        this.nextMount = void 0;\n        this.nextUnmount = void 0;\n        this.prevMount = void 0;\n        this.prevUnmount = void 0;\n        this.parent = void 0;\n        this.bindings = void 0;\n        this.controllers = void 0;\n        this.state = 0 /* none */;\n        this.scopeParts = void 0;\n        this.isStrictBinding = false;\n        this.scope = void 0;\n        this.part = void 0;\n        this.projector = void 0;\n        this.nodes = void 0;\n        this.context = void 0;\n        this.location = void 0;\n        this.mountStrategy = 1 /* insertBefore */;\n    }\n    static getCached(viewModel) {\n        return controllerLookup.get(viewModel);\n    }\n    static getCachedOrThrow(viewModel) {\n        const controller = Controller.getCached(viewModel);\n        if (controller === void 0) {\n            throw new Error(`There is no cached controller for the provided ViewModel: ${String(viewModel)}`);\n        }\n        return controller;\n    }\n    static forCustomElement(viewModel, lifecycle, host, parentContainer, parts, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomElement.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(0 /* customElement */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomElement(definition, parentContainer, parts);\n        return controller;\n    }\n    static forCustomAttribute(viewModel, lifecycle, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomAttribute.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(1 /* customAttribute */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ void 0);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomAttribute(definition);\n        return controller;\n    }\n    static forSyntheticView(viewFactory, lifecycle, context, flags = 0 /* none */) {\n        const controller = new Controller(2 /* synthetic */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ HooksDefinition.none, \n        /* viewFactory    */ viewFactory, \n        /* viewModel      */ void 0, \n        /* bindingContext */ void 0, \n        /* host           */ void 0);\n        controller.hydrateSynthetic(context, viewFactory.parts);\n        return controller;\n    }\n    hydrateCustomElement(definition, parentContainer, parts) {\n        const flags = this.flags |= definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        createChildrenObservers(this, definition, flags, instance);\n        this.scope = Scope.create(flags, this.bindingContext, null);\n        const hooks = this.hooks;\n        if (hooks.hasCreate) {\n            const result = instance.create(\n            /* controller      */ this, \n            /* parentContainer */ parentContainer, \n            /* definition      */ definition, \n            /* parts           */ parts);\n            if (result !== void 0 && result !== definition) {\n                definition = CustomElementDefinition.getOrCreate(result);\n            }\n        }\n        const context = this.context = getRenderContext(definition, parentContainer, parts);\n        // Support Recursive Components by adding self to own context\n        definition.register(context);\n        if (definition.injectable !== null) {\n            // If the element is registered as injectable, support injecting the instance into children\n            context.beginChildComponentOperation(instance);\n        }\n        if (hooks.hasBeforeCompile) {\n            instance.beforeCompile(this);\n        }\n        const compiledContext = context.compile();\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.scopeParts = compiledDefinition.scopeParts;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const projectorLocator = parentContainer.get(IProjectorLocator);\n        this.projector = projectorLocator.getElementProjector(context.dom, this, this.host, compiledDefinition);\n        instance.$controller = this;\n        const nodes = this.nodes = compiledContext.createNodes();\n        if (hooks.hasAfterCompile) {\n            instance.afterCompile(this);\n        }\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ this.host, \n        /* parts      */ parts);\n        if (hooks.hasAfterCompileChildren) {\n            instance.afterCompileChildren(this);\n        }\n    }\n    hydrateCustomAttribute(definition) {\n        const flags = this.flags | definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        instance.$controller = this;\n    }\n    hydrateSynthetic(context, parts) {\n        this.context = context;\n        const compiledContext = context.compile();\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.scopeParts = compiledDefinition.scopeParts;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const nodes = this.nodes = compiledContext.createNodes();\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ void 0, \n        /* parts      */ parts);\n    }\n    addBinding(binding) {\n        if (this.bindings === void 0) {\n            this.bindings = [binding];\n        }\n        else {\n            this.bindings[this.bindings.length] = binding;\n        }\n    }\n    addController(controller) {\n        if (this.controllers === void 0) {\n            this.controllers = [controller];\n        }\n        else {\n            this.controllers[this.controllers.length] = controller;\n        }\n    }\n    is(name) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */: {\n                const def = CustomAttribute.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 0 /* customElement */: {\n                const def = CustomElement.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 2 /* synthetic */:\n                return this.viewFactory.name === name;\n        }\n    }\n    lockScope(scope) {\n        this.scope = scope;\n        this.state |= 256 /* hasLockedScope */;\n    }\n    hold(location, mountStrategy) {\n        this.state = (this.state | 512 /* canBeCached */) ^ 512 /* canBeCached */;\n        this.location = location;\n        this.mountStrategy = mountStrategy;\n    }\n    release(flags) {\n        this.state |= 512 /* canBeCached */;\n        if ((this.state & 32 /* isAttached */) > 0) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            return this.viewFactory.canReturnToCache(this); // non-null is implied by the hook\n        }\n        return this.unmountSynthetic(flags);\n    }\n    bind(flags, scope, part) {\n        this.part = part;\n        // TODO: benchmark which of these techniques is fastest:\n        // - the current one (enum with switch)\n        // - set the name of the method in the constructor, e.g. this.bindMethod = 'bindCustomElement'\n        //    and then doing this[this.bindMethod](flags, scope) instead of switch (eliminates branching\n        //    but computed property access might be harmful to browser optimizations)\n        // - make bind() a property and set it to one of the 3 methods in the constructor,\n        //    e.g. this.bind = this.bindCustomElement (eliminates branching + reduces call stack depth by 1,\n        //    but might make the call site megamorphic)\n        flags |= 4096 /* fromBind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.bindCustomElement(flags, scope);\n            case 1 /* customAttribute */:\n                return this.bindCustomAttribute(flags, scope);\n            case 2 /* synthetic */:\n                return this.bindSynthetic(flags, scope);\n        }\n    }\n    unbind(flags) {\n        flags |= 8192 /* fromUnbind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.unbindCustomElement(flags);\n            case 1 /* customAttribute */:\n                return this.unbindCustomAttribute(flags);\n            case 2 /* synthetic */:\n                return this.unbindSynthetic(flags);\n        }\n    }\n    afterBind(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterBind(flags); // non-null is implied by the hook\n    }\n    afterUnbind(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterUnbind(flags); // non-null is implied by the hook\n    }\n    attach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) > 0 && (flags & 33554432 /* reorderNodes */) === 0) {\n            return;\n        }\n        flags |= 16384 /* fromAttach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.attachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.attachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.attachSynthetic(flags);\n        }\n    }\n    detach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return;\n        }\n        flags |= 32768 /* fromDetach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.detachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.detachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.detachSynthetic(flags);\n        }\n    }\n    afterAttach(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterAttach(flags); // non-null is implied by the hook\n    }\n    afterDetach(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterDetach(flags); // non-null is implied by the hook\n    }\n    mount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.mountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.mountSynthetic(flags);\n        }\n    }\n    unmount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.unmountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.unmountSynthetic(flags);\n        }\n    }\n    cache(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.cacheCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.cacheCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.cacheSynthetic(flags);\n        }\n    }\n    getTargetAccessor(propertyName) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const binding = bindings.find(b => b.targetProperty === propertyName);\n            if (binding !== void 0) {\n                return binding.targetObserver;\n            }\n        }\n        return void 0;\n    }\n    // #region bind/unbind\n    bindCustomElement(flags, scope) {\n        const $scope = this.scope;\n        $scope.parentScope = scope === void 0 ? null : scope;\n        $scope.scopeParts = this.scopeParts;\n        if ((this.state & 4 /* isBound */) > 0) {\n            return LifecycleTask.done;\n        }\n        flags |= 4096 /* fromBind */;\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.afterBind.begin();\n        if (this.hooks.hasBeforeBind) {\n            const ret = this.bindingContext.beforeBind(flags);\n            if (hasAsyncWork(ret)) {\n                // this.scope could be reassigned during beforeBind so reference that instead of $scope.\n                return new ContinuationTask(ret, this.bindBindings, this, flags, this.scope);\n            }\n        }\n        return this.bindBindings(flags, this.scope);\n    }\n    bindCustomAttribute(flags, scope) {\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        this.state |= 1 /* isBinding */;\n        this.scope = scope;\n        this.lifecycle.afterBind.begin();\n        if (this.hooks.hasBeforeBind) {\n            const ret = this.bindingContext.beforeBind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endBind, this, flags);\n            }\n        }\n        this.endBind(flags);\n        return LifecycleTask.done;\n    }\n    bindSynthetic(flags, scope) {\n        if (scope == void 0) {\n            throw new Error(`Scope is null or undefined`); // TODO: create error code\n        }\n        scope.scopeParts = mergeDistinct(scope.scopeParts, this.scopeParts, false);\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope || (this.state & 256 /* hasLockedScope */) > 0) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        if ((this.state & 256 /* hasLockedScope */) === 0) {\n            this.scope = scope;\n        }\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.afterBind.begin();\n        return this.bindBindings(flags, this.scope);\n    }\n    bindBindings(flags, scope) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const { length } = bindings;\n            if (this.isStrictBinding) {\n                flags |= 4 /* isStrictBindingStrategy */;\n            }\n            for (let i = 0; i < length; ++i) {\n                bindings[i].$bind(flags, scope, this.part);\n            }\n        }\n        return this.bindControllers(flags, this.scope);\n    }\n    bindControllers(flags, scope) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].parent = this;\n                task = controllers[i].bind(flags, scope, this.part);\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.endBind(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.endBind, this, flags);\n    }\n    endBind(flags) {\n        if (this.hooks.hasAfterBind) {\n            this.lifecycle.afterBind.add(this);\n        }\n        this.state = this.state ^ 1 /* isBinding */ | 4 /* isBound */;\n        this.lifecycle.afterBind.end(flags);\n    }\n    unbindCustomElement(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.scope.parentScope = null;\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        if (this.hooks.hasBeforeUnbind) {\n            const ret = this.bindingContext.beforeUnbind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.unbindControllers, this, flags);\n            }\n        }\n        return this.unbindControllers(flags);\n    }\n    unbindCustomAttribute(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        if (this.hooks.hasBeforeUnbind) {\n            const ret = this.bindingContext.beforeUnbind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endUnbind, this, flags);\n            }\n        }\n        this.endUnbind(flags);\n        return LifecycleTask.done;\n    }\n    unbindSynthetic(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        return this.unbindControllers(flags);\n    }\n    unbindBindings(flags) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            for (let i = bindings.length - 1; i >= 0; --i) {\n                bindings[i].$unbind(flags);\n            }\n        }\n        this.endUnbind(flags);\n    }\n    unbindControllers(flags) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                task = controllers[i].unbind(flags);\n                controllers[i].parent = void 0;\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.unbindBindings(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.unbindBindings, this, flags);\n    }\n    endUnbind(flags) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */:\n                this.scope = void 0;\n                break;\n            case 2 /* synthetic */:\n                if ((this.state & 256 /* hasLockedScope */) === 0) {\n                    this.scope = void 0;\n                }\n        }\n        if (this.hooks.hasAfterUnbind) {\n            this.lifecycle.afterUnbind.add(this);\n        }\n        this.state = (this.state | 6 /* isBoundOrUnbinding */) ^ 6 /* isBoundOrUnbinding */;\n        this.lifecycle.afterUnbind.end(flags);\n    }\n    // #endregion\n    // #region attach/detach\n    attachCustomElement(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.mount.add(this);\n        this.lifecycle.afterAttach.begin();\n        if (this.hooks.hasBeforeAttach) {\n            this.bindingContext.beforeAttach(flags);\n        }\n        this.attachControllers(flags);\n        if (this.hooks.hasAfterAttach) {\n            this.lifecycle.afterAttach.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.afterAttach.end(flags);\n    }\n    attachCustomAttribute(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.afterAttach.begin();\n        if (this.hooks.hasBeforeAttach) {\n            this.bindingContext.beforeAttach(flags);\n        }\n        if (this.hooks.hasAfterAttach) {\n            this.lifecycle.afterAttach.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.afterAttach.end(flags);\n    }\n    attachSynthetic(flags) {\n        if (((this.state & 32 /* isAttached */) > 0 && flags & 33554432 /* reorderNodes */) > 0) {\n            this.lifecycle.mount.add(this);\n        }\n        else {\n            flags |= 16384 /* fromAttach */;\n            this.state |= 8 /* isAttaching */;\n            this.lifecycle.mount.add(this);\n            this.lifecycle.afterAttach.begin();\n            this.attachControllers(flags);\n            this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n            this.lifecycle.afterAttach.end(flags);\n        }\n    }\n    detachCustomElement(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        this.lifecycle.unmount.add(this);\n        if (this.hooks.hasBeforeDetach) {\n            this.bindingContext.beforeDetach(flags);\n        }\n        this.detachControllers(flags);\n        if (this.hooks.hasAfterDetach) {\n            this.lifecycle.afterDetach.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    detachCustomAttribute(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        if (this.hooks.hasBeforeDetach) {\n            this.bindingContext.beforeDetach(flags);\n        }\n        if (this.hooks.hasAfterDetach) {\n            this.lifecycle.afterDetach.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    detachSynthetic(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        this.lifecycle.unmount.add(this);\n        this.detachControllers(flags);\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    attachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].attach(flags);\n            }\n        }\n    }\n    detachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                controllers[i].detach(flags);\n            }\n        }\n    }\n    // #endregion\n    // #region mount/unmount/cache\n    mountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) > 0) {\n            return;\n        }\n        this.state |= 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.project(this.nodes); // non-null is implied by the hook\n    }\n    mountSynthetic(flags) {\n        const nodes = this.nodes; // non null is implied by the hook\n        const location = this.location; // non null is implied by the hook\n        this.state |= 64 /* isMounted */;\n        switch (this.mountStrategy) {\n            case 2 /* append */:\n                nodes.appendTo(location);\n                break;\n            default:\n                nodes.insertBefore(location);\n        }\n    }\n    unmountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.take(this.nodes); // non-null is implied by the hook\n    }\n    unmountSynthetic(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return false;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.nodes.remove(); // non-null is implied by the hook\n        this.nodes.unlink();\n        if ((this.state & 512 /* canBeCached */) > 0) {\n            this.state = (this.state | 512 /* canBeCached */) ^ 512 /* canBeCached */;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            if (this.viewFactory.tryReturnToCache(this)) { // non-null is implied by the hook\n                return true;\n            }\n        }\n        return false;\n    }\n    cacheCustomElement(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n    }\n    cacheCustomAttribute(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n    cacheSynthetic(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n}\nfunction getBindingContext(flags, instance) {\n    if (instance.noProxy === true || (flags & 2 /* proxyStrategy */) === 0) {\n        return instance;\n    }\n    return ProxyObserver.getOrCreate(instance).proxy;\n}\nfunction getLookup(instance) {\n    let lookup = instance.$observers;\n    if (lookup === void 0) {\n        Reflect.defineProperty(instance, '$observers', {\n            enumerable: false,\n            value: lookup = {},\n        });\n    }\n    return lookup;\n}\nfunction createObservers(lifecycle, definition, flags, instance) {\n    const bindables = definition.bindables;\n    const observableNames = Object.getOwnPropertyNames(bindables);\n    const length = observableNames.length;\n    if (length > 0) {\n        let name;\n        let bindable;\n        if ((flags & 2 /* proxyStrategy */) > 0) {\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                bindable = bindables[name];\n                new BindableObserver(lifecycle, flags, ProxyObserver.getOrCreate(instance).proxy, name, bindable.callback, bindable.set);\n            }\n        }\n        else {\n            const observers = getLookup(instance);\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                if (observers[name] === void 0) {\n                    bindable = bindables[name];\n                    observers[name] = new BindableObserver(lifecycle, flags, instance, name, bindable.callback, bindable.set);\n                }\n            }\n        }\n    }\n}\nfunction createChildrenObservers(controller, definition, flags, instance) {\n    const childrenObservers = definition.childrenObservers;\n    const childObserverNames = Object.getOwnPropertyNames(childrenObservers);\n    const length = childObserverNames.length;\n    if (length > 0) {\n        const observers = getLookup(instance);\n        let name;\n        for (let i = 0; i < length; ++i) {\n            name = childObserverNames[i];\n            if (observers[name] == void 0) {\n                const childrenDescription = childrenObservers[name];\n                observers[name] = new ChildrenObserver(controller, instance, flags, name, childrenDescription.callback, childrenDescription.query, childrenDescription.filter, childrenDescription.map, childrenDescription.options);\n            }\n        }\n    }\n}\n//# sourceMappingURL=controller.js.map","import { DI, Registration, Metadata, Protocol } from '@aurelia/kernel';\nimport { Scope } from '../observation/binding-context';\nimport { CustomElement, CustomElementDefinition } from '../resources/custom-element';\nimport { Controller } from './controller';\nimport { mergeParts } from '../definitions';\nimport { getRenderContext } from './render-context';\nexport class ViewFactory {\n    constructor(name, context, lifecycle, parts) {\n        this.name = name;\n        this.context = context;\n        this.lifecycle = lifecycle;\n        this.parts = parts;\n        this.isCaching = false;\n        this.cache = null;\n        this.cacheSize = -1;\n    }\n    setCacheSize(size, doNotOverrideIfAlreadySet) {\n        if (size) {\n            if (size === '*') {\n                size = ViewFactory.maxCacheSize;\n            }\n            else if (typeof size === 'string') {\n                size = parseInt(size, 10);\n            }\n            if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n                this.cacheSize = size;\n            }\n        }\n        if (this.cacheSize > 0) {\n            this.cache = [];\n        }\n        else {\n            this.cache = null;\n        }\n        this.isCaching = this.cacheSize > 0;\n    }\n    canReturnToCache(controller) {\n        return this.cache != null && this.cache.length < this.cacheSize;\n    }\n    tryReturnToCache(controller) {\n        if (this.canReturnToCache(controller)) {\n            controller.cache(0 /* none */);\n            this.cache.push(controller);\n            return true;\n        }\n        return false;\n    }\n    create(flags) {\n        const cache = this.cache;\n        let controller;\n        if (cache != null && cache.length > 0) {\n            controller = cache.pop();\n            return controller;\n        }\n        controller = Controller.forSyntheticView(this, this.lifecycle, this.context, flags);\n        return controller;\n    }\n    resolve(requestor, parts) {\n        parts = mergeParts(this.parts, parts);\n        if (parts === void 0) {\n            return this;\n        }\n        const part = parts[this.name];\n        if (part === void 0) {\n            return this;\n        }\n        return getRenderContext(part, requestor, parts).getViewFactory(this.name);\n    }\n}\nViewFactory.maxCacheSize = 0xFFFF;\nconst seenViews = new WeakSet();\nfunction notYetSeen($view) {\n    return !seenViews.has($view);\n}\nfunction toCustomElementDefinition($view) {\n    seenViews.add($view);\n    return CustomElementDefinition.create($view);\n}\nexport const Views = {\n    name: Protocol.resource.keyFor('views'),\n    has(value) {\n        return typeof value === 'function' && (Metadata.hasOwn(Views.name, value) || '$views' in value);\n    },\n    get(value) {\n        if (typeof value === 'function' && '$views' in value) {\n            // TODO: a `get` operation with side effects is not a good thing. Should refactor this to a proper resource kind.\n            const $views = value.$views;\n            const definitions = $views.filter(notYetSeen).map(toCustomElementDefinition);\n            for (const def of definitions) {\n                Views.add(value, def);\n            }\n        }\n        let views = Metadata.getOwn(Views.name, value);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [], value);\n        }\n        return views;\n    },\n    add(Type, partialDefinition) {\n        const definition = CustomElementDefinition.create(partialDefinition);\n        let views = Metadata.getOwn(Views.name, Type);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [definition], Type);\n        }\n        else {\n            views.push(definition);\n        }\n        return views;\n    },\n};\nexport function view(v) {\n    return function (target) {\n        Views.add(target, v);\n    };\n}\nexport const IViewLocator = DI.createInterface('IViewLocator')\n    .noDefault();\nexport class ViewLocator {\n    constructor() {\n        this.modelInstanceToBoundComponent = new WeakMap();\n        this.modelTypeToUnboundComponent = new Map();\n    }\n    static register(container) {\n        return Registration.singleton(IViewLocator, this).register(container);\n    }\n    getViewComponentForObject(object, viewNameOrSelector) {\n        if (object) {\n            const availableViews = Views.has(object.constructor) ? Views.get(object.constructor) : [];\n            const resolvedViewName = typeof viewNameOrSelector === 'function'\n                ? viewNameOrSelector(object, availableViews)\n                : this.getViewName(availableViews, viewNameOrSelector);\n            return this.getOrCreateBoundComponent(object, availableViews, resolvedViewName);\n        }\n        return null;\n    }\n    getOrCreateBoundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelInstanceToBoundComponent.get(object);\n        let BoundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelInstanceToBoundComponent.set(object, lookup);\n        }\n        else {\n            BoundComponent = lookup[resolvedViewName];\n        }\n        if (BoundComponent === void 0) {\n            const UnboundComponent = this.getOrCreateUnboundComponent(object, availableViews, resolvedViewName);\n            BoundComponent = CustomElement.define(CustomElement.getDefinition(UnboundComponent), class extends UnboundComponent {\n                constructor() {\n                    super(object);\n                }\n            });\n            lookup[resolvedViewName] = BoundComponent;\n        }\n        return BoundComponent;\n    }\n    getOrCreateUnboundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelTypeToUnboundComponent.get(object.constructor);\n        let UnboundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelTypeToUnboundComponent.set(object.constructor, lookup);\n        }\n        else {\n            UnboundComponent = lookup[resolvedViewName];\n        }\n        if (UnboundComponent === void 0) {\n            UnboundComponent = CustomElement.define(this.getView(availableViews, resolvedViewName), class {\n                constructor(viewModel) {\n                    this.viewModel = viewModel;\n                }\n                create(controller, parentContainer, definition, parts) {\n                    const vm = this.viewModel;\n                    controller.scope = Scope.fromParent(controller.flags, controller.scope, vm);\n                    if (vm.create !== void 0) {\n                        return vm.create(controller, parentContainer, definition, parts);\n                    }\n                }\n            });\n            const proto = UnboundComponent.prototype;\n            if ('beforeCompile' in object) {\n                proto.beforeCompile = function beforeCompile(controller) {\n                    this.viewModel.beforeCompile(controller);\n                };\n            }\n            if ('afterCompile' in object) {\n                proto.afterCompile = function afterCompile(controller) {\n                    this.viewModel.afterCompile(controller);\n                };\n            }\n            if ('afterCompileChildren' in object) {\n                proto.afterCompileChildren = function afterCompileChildren(controller) {\n                    this.viewModel.afterCompileChildren(controller);\n                };\n            }\n            if ('beforeBind' in object) {\n                proto.beforeBind = function beforeBind(flags) {\n                    return this.viewModel.beforeBind(flags);\n                };\n            }\n            if ('afterBind' in object) {\n                proto.afterBind = function afterBind(flags) {\n                    this.viewModel.afterBind(flags);\n                };\n            }\n            if ('beforeUnbind' in object) {\n                proto.beforeUnbind = function beforeUnbind(flags) {\n                    return this.viewModel.beforeUnbind(flags);\n                };\n            }\n            if ('afterUnbind' in object) {\n                proto.afterUnbind = function afterUnbind(flags) {\n                    this.viewModel.afterUnbind(flags);\n                };\n            }\n            if ('beforeAttach' in object) {\n                proto.beforeAttach = function beforeAttach(flags) {\n                    this.viewModel.beforeAttach(flags);\n                };\n            }\n            if ('afterAttach' in object) {\n                proto.afterAttach = function afterAttach(flags) {\n                    this.viewModel.afterAttach(flags);\n                };\n            }\n            if ('beforeDetach' in object) {\n                proto.beforeDetach = function beforeDetach(flags) {\n                    this.viewModel.beforeDetach(flags);\n                };\n            }\n            if ('afterDetach' in object) {\n                proto.afterDetach = function afterDetach(flags) {\n                    this.viewModel.afterDetach(flags);\n                };\n            }\n            if ('caching' in object) {\n                proto.caching = function caching(flags) {\n                    this.viewModel.caching(flags);\n                };\n            }\n            lookup[resolvedViewName] = UnboundComponent;\n        }\n        return UnboundComponent;\n    }\n    getViewName(views, requestedName) {\n        if (requestedName) {\n            return requestedName;\n        }\n        if (views.length === 1) {\n            return views[0].name;\n        }\n        return 'default-view';\n    }\n    getView(views, name) {\n        const v = views.find(x => x.name === name);\n        if (v === void 0) {\n            // TODO: Use Reporter\n            throw new Error(`Could not find view: ${name}`);\n        }\n        return v;\n    }\n}\n//# sourceMappingURL=view.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { IViewLocator } from '../../templating/view';\nimport { valueConverter } from '../value-converter';\nlet ViewValueConverter = class ViewValueConverter {\n    constructor(viewLocator) {\n        this.viewLocator = viewLocator;\n    }\n    toView(object, viewNameOrSelector) {\n        return this.viewLocator.getViewComponentForObject(object, viewNameOrSelector);\n    }\n};\nViewValueConverter = __decorate([\n    valueConverter('view'),\n    __param(0, IViewLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], ViewValueConverter);\nexport { ViewValueConverter };\n//# sourceMappingURL=view.js.map","import { DI, Registration, } from '@aurelia/kernel';\nimport { ILifecycle } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, } from './lifecycle-task';\nimport { Controller } from './templating/controller';\nexport const IActivator = DI.createInterface('IActivator').withDefault(x => x.singleton(Activator));\n/** @internal */\nexport class Activator {\n    constructor(taskManager) {\n        this.taskManager = taskManager;\n    }\n    static register(container) {\n        return Registration.singleton(IActivator, this).register(container);\n    }\n    activate(host, component, container, flags = 1024 /* fromStartTask */, parentScope) {\n        flags = flags === void 0 ? 0 /* none */ : flags;\n        const mgr = this.taskManager;\n        let task = mgr.runBeforeRender();\n        if (task.done) {\n            this.render(host, component, container, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.render, this, host, component, container, flags);\n        }\n        if (task.done) {\n            task = mgr.runBeforeBind();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeBind, mgr);\n        }\n        if (task.done) {\n            task = this.bind(component, flags, parentScope);\n        }\n        else {\n            task = new ContinuationTask(task, this.bind, this, component, flags, parentScope);\n        }\n        if (task.done) {\n            task = mgr.runBeforeAttach();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeAttach, mgr);\n        }\n        if (task.done) {\n            this.attach(component, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attach, this, component, flags);\n        }\n        return task;\n    }\n    deactivate(component, flags = 2048 /* fromStopTask */) {\n        const controller = Controller.getCachedOrThrow(component);\n        controller.detach(flags | 32768 /* fromDetach */);\n        return controller.unbind(flags | 8192 /* fromUnbind */);\n    }\n    render(host, component, container, flags) {\n        const lifecycle = container.get(ILifecycle);\n        Controller.forCustomElement(component, lifecycle, host, container, void 0, flags);\n    }\n    bind(component, flags, parentScope) {\n        return Controller.getCachedOrThrow(component).bind(flags | 4096 /* fromBind */, parentScope);\n    }\n    attach(component, flags) {\n        Controller.getCachedOrThrow(component).attach(flags | 16384 /* fromAttach */);\n    }\n}\nActivator.inject = [IStartTaskManager];\n//# sourceMappingURL=activator.js.map","import { DI, PLATFORM, Registration } from '@aurelia/kernel';\nimport { IActivator } from './activator';\nimport { INode } from './dom';\nimport { ILifecycle, } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, LifecycleTask, } from './lifecycle-task';\nimport { CustomElement } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nexport class CompositionRoot {\n    constructor(config, container) {\n        this.config = config;\n        if (config.host != void 0) {\n            if (container.has(INode, false)) {\n                this.container = container.createChild();\n            }\n            else {\n                this.container = container;\n            }\n            Registration.instance(INode, config.host).register(this.container);\n            this.host = config.host;\n        }\n        else if (container.has(INode, true)) {\n            this.container = container;\n            this.host = container.get(INode);\n        }\n        else {\n            throw new Error(`No host element found.`);\n        }\n        this.strategy = config.strategy != void 0 ? config.strategy : 1 /* getterSetter */;\n        const initializer = this.container.get(IDOMInitializer);\n        this.dom = initializer.initialize(config);\n        this.lifecycle = this.container.get(ILifecycle);\n        this.activator = this.container.get(IActivator);\n        const taskManager = this.container.get(IStartTaskManager);\n        const beforeCreateTask = taskManager.runBeforeCreate();\n        if (beforeCreateTask.done) {\n            this.task = LifecycleTask.done;\n            this.create();\n        }\n        else {\n            this.task = new ContinuationTask(beforeCreateTask, this.create, this);\n        }\n    }\n    activate(antecedent) {\n        const { task, host, viewModel, container, activator, strategy } = this;\n        const flags = strategy | 1024 /* fromStartTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.activate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.activate(host, viewModel, container, flags, void 0);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        return this.task;\n    }\n    deactivate(antecedent) {\n        const { task, viewModel, activator, strategy } = this;\n        const flags = strategy | 2048 /* fromStopTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.deactivate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.deactivate(viewModel, flags);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.deactivate, activator, viewModel, flags);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        return this.task;\n    }\n    create() {\n        const config = this.config;\n        const instance = this.viewModel = CustomElement.isType(config.component)\n            ? this.container.get(config.component)\n            : config.component;\n        const container = this.container;\n        const lifecycle = container.get(ILifecycle);\n        this.controller = Controller.forCustomElement(instance, lifecycle, this.host, container, void 0, this.strategy);\n    }\n}\nexport class Aurelia {\n    constructor(container = DI.createContainer()) {\n        this.container = container;\n        this.task = LifecycleTask.done;\n        this._isRunning = false;\n        this._isStarting = false;\n        this._isStopping = false;\n        this._root = void 0;\n        this.next = (void 0);\n        Registration.instance(Aurelia, this).register(container);\n    }\n    get isRunning() {\n        return this._isRunning;\n    }\n    get isStarting() {\n        return this._isStarting;\n    }\n    get isStopping() {\n        return this._isStopping;\n    }\n    get root() {\n        if (this._root == void 0) {\n            if (this.next == void 0) {\n                throw new Error(`root is not defined`); // TODO: create error code\n            }\n            return this.next;\n        }\n        return this._root;\n    }\n    register(...params) {\n        this.container.register(...params);\n        return this;\n    }\n    app(config) {\n        this.next = new CompositionRoot(config, this.container);\n        if (this.isRunning) {\n            this.start();\n        }\n        return this;\n    }\n    start(root = this.next) {\n        if (root == void 0) {\n            throw new Error(`There is no composition root`); // TODO: create error code\n        }\n        this.stop(root);\n        if (this.task.done) {\n            this.onBeforeStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onBeforeStart, this, root);\n        }\n        this.task = this.root.activate(this.task);\n        if (this.task.done) {\n            this.task = this.onAfterStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onAfterStart, this, root);\n        }\n        return this.task;\n    }\n    stop(root = this._root) {\n        if (this._isRunning && root != void 0) {\n            if (this.task.done) {\n                this.onBeforeStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onBeforeStop, this, root);\n            }\n            this.task = root.deactivate(this.task);\n            if (this.task.done) {\n                this.task = this.onAfterStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onAfterStop, this, root);\n            }\n        }\n        return this.task;\n    }\n    wait() {\n        return this.task.wait();\n    }\n    onBeforeStart(root) {\n        Reflect.set(root.host, '$aurelia', this);\n        this._root = root;\n        this._isStarting = true;\n    }\n    onAfterStart(root) {\n        this._isRunning = true;\n        this._isStarting = false;\n        this.dispatchEvent(root, 'aurelia-composed', root.dom);\n        this.dispatchEvent(root, 'au-started', root.host);\n        return LifecycleTask.done;\n    }\n    onBeforeStop(root) {\n        this._isRunning = false;\n        this._isStopping = true;\n    }\n    onAfterStop(root) {\n        Reflect.deleteProperty(root.host, '$aurelia');\n        this._root = void 0;\n        this._isStopping = false;\n        this.dispatchEvent(root, 'au-stopped', root.host);\n        return LifecycleTask.done;\n    }\n    dispatchEvent(root, name, target) {\n        target = 'dispatchEvent' in target ? target : root.dom;\n        target.dispatchEvent(root.dom.createCustomEvent(name, { detail: this, bubbles: true, cancelable: true }));\n    }\n}\nPLATFORM.global.Aurelia = Aurelia;\nexport const IDOMInitializer = DI.createInterface('IDOMInitializer').noDefault();\n//# sourceMappingURL=aurelia.js.map","import { DI } from '@aurelia/kernel';\nimport { Lifecycle } from './lifecycle';\nimport { StartTaskManager } from './lifecycle-task';\nimport { ObserverLocator } from './observation/observer-locator';\nimport { CallBindingRenderer, CustomAttributeRenderer, CustomElementRenderer, InterpolationBindingRenderer, IteratorBindingRenderer, LetElementRenderer, PropertyBindingRenderer, RefBindingRenderer, Renderer, SetPropertyRenderer, TemplateControllerRenderer } from './renderer';\nimport { FromViewBindingBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nimport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nimport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nimport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nimport { FrequentMutations, InfrequentMutations, ObserveShallow } from './resources/custom-attributes/flags';\nimport { Else, If } from './resources/custom-attributes/if';\nimport { Repeat } from './resources/custom-attributes/repeat';\nimport { Replaceable } from './resources/custom-attributes/replaceable';\nimport { With } from './resources/custom-attributes/with';\nimport { SanitizeValueConverter } from './resources/value-converters/sanitize';\nimport { ViewValueConverter } from './resources/value-converters/view';\nimport { ViewLocator } from './templating/view';\nimport { Clock } from './scheduler';\nexport const IObserverLocatorRegistration = ObserverLocator;\nexport const ILifecycleRegistration = Lifecycle;\nexport const IRendererRegistration = Renderer;\nexport const IStartTaskManagerRegistration = StartTaskManager;\nexport const IViewLocatorRegistration = ViewLocator;\nexport const IClockRegistration = Clock;\n/**\n * Default implementations for the following interfaces:\n * - `IObserverLocator`\n * - `ILifecycle`\n * - `IRenderer`\n * - `IStartTaskManager`\n * - `IViewLocator`\n * - `IClockRegistration`\n * - `ISchedulerRegistration`\n */\nexport const DefaultComponents = [\n    IObserverLocatorRegistration,\n    ILifecycleRegistration,\n    IRendererRegistration,\n    IStartTaskManagerRegistration,\n    IViewLocatorRegistration,\n    IClockRegistration,\n];\nexport const FrequentMutationsRegistration = FrequentMutations;\nexport const InfrequentMutationsRegistration = InfrequentMutations;\nexport const ObserveShallowRegistration = ObserveShallow;\nexport const IfRegistration = If;\nexport const ElseRegistration = Else;\nexport const RepeatRegistration = Repeat;\nexport const ReplaceableRegistration = Replaceable;\nexport const WithRegistration = With;\nexport const SanitizeValueConverterRegistration = SanitizeValueConverter;\nexport const ViewValueConverterRegistration = ViewValueConverter;\nexport const DebounceBindingBehaviorRegistration = DebounceBindingBehavior;\nexport const OneTimeBindingBehaviorRegistration = OneTimeBindingBehavior;\nexport const ToViewBindingBehaviorRegistration = ToViewBindingBehavior;\nexport const FromViewBindingBehaviorRegistration = FromViewBindingBehavior;\nexport const SignalBindingBehaviorRegistration = SignalBindingBehavior;\nexport const ThrottleBindingBehaviorRegistration = ThrottleBindingBehavior;\nexport const TwoWayBindingBehaviorRegistration = TwoWayBindingBehavior;\n/**\n * Default resources:\n * - Template controllers (`if`/`else`, `repeat`, `replaceable`, `with`)\n * - Value Converters (`sanitize`)\n * - Binding Behaviors (`oneTime`, `toView`, `fromView`, `twoWay`, `signal`, `debounce`, `throttle`)\n */\nexport const DefaultResources = [\n    FrequentMutationsRegistration,\n    InfrequentMutationsRegistration,\n    ObserveShallowRegistration,\n    IfRegistration,\n    ElseRegistration,\n    RepeatRegistration,\n    ReplaceableRegistration,\n    WithRegistration,\n    SanitizeValueConverterRegistration,\n    ViewValueConverterRegistration,\n    DebounceBindingBehaviorRegistration,\n    OneTimeBindingBehaviorRegistration,\n    ToViewBindingBehaviorRegistration,\n    FromViewBindingBehaviorRegistration,\n    SignalBindingBehaviorRegistration,\n    ThrottleBindingBehaviorRegistration,\n    TwoWayBindingBehaviorRegistration\n];\nexport const CallBindingRendererRegistration = CallBindingRenderer;\nexport const CustomAttributeRendererRegistration = CustomAttributeRenderer;\nexport const CustomElementRendererRegistration = CustomElementRenderer;\nexport const InterpolationBindingRendererRegistration = InterpolationBindingRenderer;\nexport const IteratorBindingRendererRegistration = IteratorBindingRenderer;\nexport const LetElementRendererRegistration = LetElementRenderer;\nexport const PropertyBindingRendererRegistration = PropertyBindingRenderer;\nexport const RefBindingRendererRegistration = RefBindingRenderer;\nexport const SetPropertyRendererRegistration = SetPropertyRenderer;\nexport const TemplateControllerRendererRegistration = TemplateControllerRenderer;\n/**\n * Default renderers for:\n * - PropertyBinding: `bind`, `one-time`, `to-view`, `from-view`, `two-way`\n * - IteratorBinding: `for`\n * - CallBinding: `call`\n * - RefBinding: `ref`\n * - InterpolationBinding: `${}`\n * - SetProperty\n * - `customElement` hydration\n * - `customAttribute` hydration\n * - `templateController` hydration\n * - `let` element hydration\n */\nexport const DefaultRenderers = [\n    PropertyBindingRendererRegistration,\n    IteratorBindingRendererRegistration,\n    CallBindingRendererRegistration,\n    RefBindingRendererRegistration,\n    InterpolationBindingRendererRegistration,\n    SetPropertyRendererRegistration,\n    CustomElementRendererRegistration,\n    CustomAttributeRendererRegistration,\n    TemplateControllerRendererRegistration,\n    LetElementRendererRegistration\n];\n/**\n * A DI configuration object containing environment/runtime-agnostic registrations:\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { BindingMode } from './flags';\nexport class InterpolationInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rf\" /* interpolation */;\n    }\n}\nexport class OneTimeBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.oneTime;\n        this.oneTime = true;\n    }\n}\nexport class ToViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.toView;\n        this.oneTime = false;\n    }\n}\nexport class FromViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.fromView;\n        this.oneTime = false;\n    }\n}\nexport class TwoWayBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.twoWay;\n        this.oneTime = false;\n    }\n}\nexport class IteratorBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rk\" /* iteratorBinding */;\n    }\n}\nexport class CallBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rh\" /* callBinding */;\n    }\n}\nexport class RefBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rj\" /* refBinding */;\n        this.type = \"rj\" /* refBinding */;\n    }\n}\nexport class SetPropertyInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"re\" /* setProperty */;\n    }\n}\nexport class HydrateElementInstruction {\n    constructor(res, instructions, parts) {\n        this.res = res;\n        this.instructions = instructions;\n        this.parts = parts;\n        this.type = \"ra\" /* hydrateElement */;\n    }\n}\nexport class HydrateAttributeInstruction {\n    constructor(res, instructions) {\n        this.res = res;\n        this.instructions = instructions;\n        this.type = \"rb\" /* hydrateAttribute */;\n    }\n}\nexport class HydrateTemplateController {\n    constructor(def, res, instructions, link, parts) {\n        this.def = def;\n        this.res = res;\n        this.instructions = instructions;\n        this.link = link;\n        this.parts = parts;\n        this.type = \"rc\" /* hydrateTemplateController */;\n    }\n}\nexport class LetElementInstruction {\n    constructor(instructions, toBindingContext) {\n        this.instructions = instructions;\n        this.toBindingContext = toBindingContext;\n        this.type = \"rd\" /* hydrateLetElement */;\n    }\n}\nexport class LetBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"ri\" /* letBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","export { CallFunctionExpression, connects, observes, callsFunction, hasAncestor, isAssignable, isLeftHandSide, isPrimary, isResource, hasBind, hasUnbind, isLiteral, arePureLiterals, isPureLiteral, CustomExpression, BindingBehaviorExpression, ValueConverterExpression, AssignExpression, ConditionalExpression, AccessThisExpression, AccessScopeExpression, AccessMemberExpression, AccessKeyedExpression, CallScopeExpression, CallMemberExpression, BinaryExpression, UnaryExpression, PrimitiveLiteralExpression, HtmlLiteralExpression, ArrayLiteralExpression, ObjectLiteralExpression, TemplateExpression, TaggedTemplateExpression, ArrayBindingPattern, ObjectBindingPattern, BindingIdentifier, ForOfStatement, Interpolation } from './binding/ast';\nexport { PropertyBinding } from './binding/property-binding';\nexport { CallBinding } from './binding/call-binding';\nexport { connectable } from './binding/connectable';\nexport { IExpressionParser, BindingType } from './binding/expression-parser';\nexport { MultiInterpolationBinding, InterpolationBinding } from './binding/interpolation-binding';\nexport { LetBinding } from './binding/let-binding';\nexport { RefBinding } from './binding/ref-binding';\nexport { ArrayObserver, ArrayIndexObserver, enableArrayObservation, disableArrayObservation, applyMutationsToIndices, synchronizeIndices, } from './observation/array-observer';\nexport { MapObserver, enableMapObservation, disableMapObservation } from './observation/map-observer';\nexport { SetObserver, enableSetObservation, disableSetObservation } from './observation/set-observer';\nexport { BindingContext, Scope, OverrideContext } from './observation/binding-context';\nexport { CollectionLengthObserver, } from './observation/collection-length-observer';\nexport { CollectionSizeObserver, } from './observation/collection-size-observer';\nexport { computed, createComputedObserver, CustomSetterObserver, GetterObserver } from './observation/computed-observer';\nexport { IDirtyChecker, DirtyCheckProperty, DirtyCheckSettings } from './observation/dirty-checker';\nexport { IObserverLocator, ITargetObserverLocator, ITargetAccessorLocator, getCollectionObserver, ObserverLocator } from './observation/observer-locator';\nexport { PrimitiveObserver } from './observation/primitive-observer';\nexport { PropertyAccessor } from './observation/property-accessor';\nexport { ProxyObserver } from './observation/proxy-observer';\nexport { BindableObserver } from './observation/bindable-observer';\nexport { SetterObserver } from './observation/setter-observer';\nexport { ISignaler } from './observation/signaler';\nexport { subscriberCollection, collectionSubscriberCollection, proxySubscriberCollection, } from './observation/subscriber-collection';\nexport { bindingBehavior, BindingBehavior, BindingBehaviorDefinition, } from './resources/binding-behavior';\nexport { BindingModeBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, FromViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nexport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nexport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nexport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nexport { customAttribute, CustomAttribute, CustomAttributeDefinition, templateController, } from './resources/custom-attribute';\nexport { FrequentMutations, InfrequentMutations, ObserveShallow, } from './resources/custom-attributes/flags';\nexport { If, Else } from './resources/custom-attributes/if';\nexport { Repeat } from './resources/custom-attributes/repeat';\nexport { Replaceable } from './resources/custom-attributes/replaceable';\nexport { With } from './resources/custom-attributes/with';\nexport { containerless, customElement, CustomElement, CustomElementDefinition, IProjectorLocator, useShadowDOM } from './resources/custom-element';\nexport { ValueConverter, ValueConverterDefinition, valueConverter, } from './resources/value-converter';\nexport { ISanitizer, SanitizeValueConverter } from './resources/value-converters/sanitize';\nexport { ViewValueConverter } from './resources/value-converters/view';\nexport { Clock, IClock, IScheduler, Task, TaskAbortError, TaskQueue, TaskQueuePriority, } from './scheduler';\nexport { bindable, BindableDefinition, Bindable, } from './templating/bindable';\nexport { ChildrenDefinition, Children, children, ChildrenObserver, } from './templating/children';\n// These exports are temporary until we have a proper way to unit test them\nexport { Controller, } from './templating/controller';\nexport { ViewFactory, IViewLocator, ViewLocator, view, Views, } from './templating/view';\nexport { Aurelia, IDOMInitializer, CompositionRoot, } from './aurelia';\nexport { IfRegistration, ElseRegistration, RepeatRegistration, ReplaceableRegistration, WithRegistration, SanitizeValueConverterRegistration, DebounceBindingBehaviorRegistration, OneTimeBindingBehaviorRegistration, ToViewBindingBehaviorRegistration, FromViewBindingBehaviorRegistration, SignalBindingBehaviorRegistration, ThrottleBindingBehaviorRegistration, TwoWayBindingBehaviorRegistration, RefBindingRendererRegistration, CallBindingRendererRegistration, CustomAttributeRendererRegistration, CustomElementRendererRegistration, InterpolationBindingRendererRegistration, IteratorBindingRendererRegistration, LetElementRendererRegistration, PropertyBindingRendererRegistration, SetPropertyRendererRegistration, TemplateControllerRendererRegistration, DefaultResources, IObserverLocatorRegistration, ILifecycleRegistration, IRendererRegistration, RuntimeConfiguration } from './configuration';\nexport { HooksDefinition, isTargetedInstruction, ITargetedInstruction, TargetedInstructionType, alias, registerAliases } from './definitions';\nexport { DOM, INode, IRenderLocation, IDOM, NodeSequence } from './dom';\nexport { BindingMode, BindingStrategy, ExpressionKind, LifecycleFlags, State } from './flags';\nexport { CallBindingInstruction, FromViewBindingInstruction, HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, InterpolationInstruction, IteratorBindingInstruction, LetBindingInstruction, LetElementInstruction, OneTimeBindingInstruction, RefBindingInstruction, SetPropertyInstruction, ToViewBindingInstruction, TwoWayBindingInstruction } from './instructions';\nexport { ViewModelKind, ILifecycle, IController, IViewFactory, MountStrategy, } from './lifecycle';\nexport { getRenderContext, isRenderContext, } from './templating/render-context';\nexport { AggregateContinuationTask, TerminalTask, AggregateTerminalTask, ContinuationTask, LifecycleTask, PromiseTask, TaskSlot, StartTask, IStartTask, IStartTaskManager, ProviderTask, } from './lifecycle-task';\nexport { CollectionKind, DelegationStrategy, isIndexMap, copyIndexMap, cloneIndexMap, createIndexMap, } from './observation';\nexport { applyBindingBehavior, IInstructionRenderer, IRenderer, ITemplateCompiler, instructionRenderer, ensureExpression, } from './renderer';\n//# sourceMappingURL=index.js.map","import { hasBind, hasUnbind } from '@aurelia/runtime';\n/**\n * Listener binding. Handle event binding between view and view model\n */\nexport class Listener {\n    constructor(dom, targetEvent, delegationStrategy, sourceExpression, target, preventDefault, eventManager, locator) {\n        this.dom = dom;\n        this.targetEvent = targetEvent;\n        this.delegationStrategy = delegationStrategy;\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.preventDefault = preventDefault;\n        this.eventManager = eventManager;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n    }\n    callSource(event) {\n        const overrideContext = this.$scope.overrideContext;\n        overrideContext.$event = event;\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        Reflect.deleteProperty(overrideContext, '$event');\n        if (result !== true && this.preventDefault) {\n            event.preventDefault();\n        }\n        return result;\n    }\n    handleEvent(event) {\n        this.interceptor.callSource(event);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        this.handler = this.eventManager.addEventListener(this.dom, this.target, this.targetEvent, this.interceptor, this.delegationStrategy);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = null;\n        this.handler.dispose();\n        this.handler = null;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=listener.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { DOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\n/**\n * Observer for handling two-way binding with attributes\n * Has different strategy for class/style and normal attributes\n * TODO: handle SVG/attributes with namespace\n */\nlet AttributeObserver = class AttributeObserver {\n    constructor(scheduler, flags, observerLocator, obj, propertyKey, targetAttribute) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.targetAttribute = targetAttribute;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            switch (this.targetAttribute) {\n                case 'class': {\n                    // Why is class attribute observer setValue look different with class attribute accessor?\n                    // ==============\n                    // For class list\n                    // newValue is simply checked if truthy or falsy\n                    // and toggle the class accordingly\n                    // -- the rule of this is quite different to normal attribute\n                    //\n                    // for class attribute, observer is different in a way that it only observe a particular class at a time\n                    // this also comes from syntax, where it would typically be my-class.class=\"someProperty\"\n                    //\n                    // so there is no need for separating class by space and add all of them like class accessor\n                    if (!!currentValue) {\n                        this.obj.classList.add(this.propertyKey);\n                    }\n                    else {\n                        this.obj.classList.remove(this.propertyKey);\n                    }\n                    break;\n                }\n                case 'style': {\n                    let priority = '';\n                    let newValue = currentValue;\n                    if (typeof newValue === 'string' && newValue.includes('!important')) {\n                        priority = 'important';\n                        newValue = newValue.replace('!important', '');\n                    }\n                    this.obj.style.setProperty(this.propertyKey, newValue, priority);\n                }\n            }\n        }\n    }\n    handleMutation(mutationRecords) {\n        let shouldProcess = false;\n        for (let i = 0, ii = mutationRecords.length; ii > i; ++i) {\n            const record = mutationRecords[i];\n            if (record.type === 'attributes' && record.attributeName === this.propertyKey) {\n                shouldProcess = true;\n                break;\n            }\n        }\n        if (shouldProcess) {\n            let newValue;\n            switch (this.targetAttribute) {\n                case 'class':\n                    newValue = this.obj.classList.contains(this.propertyKey);\n                    break;\n                case 'style':\n                    newValue = this.obj.style.getPropertyValue(this.propertyKey);\n                    break;\n                default:\n                    throw new Error(`Unsupported targetAttribute: ${this.targetAttribute}`);\n            }\n            if (newValue !== this.currentValue) {\n                const { currentValue } = this;\n                this.currentValue = this.oldValue = newValue;\n                this.hasChanges = false;\n                this.callSubscribers(newValue, currentValue, 131072 /* fromDOMEvent */);\n            }\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n            startObservation(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            stopObservation(this.obj, this);\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nAttributeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String, String])\n], AttributeObserver);\nexport { AttributeObserver };\nconst startObservation = (element, subscription) => {\n    if (element.$eMObservers === undefined) {\n        element.$eMObservers = new Set();\n    }\n    if (element.$mObserver === undefined) {\n        element.$mObserver = DOM.createNodeObserver(element, handleMutation, { attributes: true });\n    }\n    element.$eMObservers.add(subscription);\n};\nconst stopObservation = (element, subscription) => {\n    const $eMObservers = element.$eMObservers;\n    if ($eMObservers && $eMObservers.delete(subscription)) {\n        if ($eMObservers.size === 0) {\n            element.$mObserver.disconnect();\n            element.$mObserver = undefined;\n        }\n        return true;\n    }\n    return false;\n};\nconst handleMutation = (mutationRecords) => {\n    mutationRecords[0].target.$eMObservers.forEach(invokeHandleMutation, mutationRecords);\n};\nfunction invokeHandleMutation(s) {\n    s.handleMutation(this);\n}\n//# sourceMappingURL=element-attribute-observer.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { BindingMode, connectable, hasBind, hasUnbind, IObserverLocator, IScheduler, INode, } from '@aurelia/runtime';\nimport { AttributeObserver, } from '../observation/element-attribute-observer';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\n/**\n * Attribute binding. Handle attribute binding betwen view/view model. Understand Html special attributes\n */\nlet AttributeBinding = class AttributeBinding {\n    constructor(sourceExpression, target, \n    // some attributes may have inner structure\n    // such as class -> collection of class names\n    // such as style -> collection of style rules\n    //\n    // for normal attributes, targetAttribute and targetProperty are the same and can be ignore\n    targetAttribute, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.targetAttribute = targetAttribute;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = null;\n        this.persistentFlags = 0 /* none */;\n        this.target = target;\n        connectable.assignIdTo(this);\n        this.$scheduler = locator.get(IScheduler);\n    }\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, value);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if (this.mode === BindingMode.fromView) {\n            flags &= ~16 /* updateTargetInstance */;\n            flags |= 32 /* updateSourceExpression */;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.interceptor.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n                this.interceptor.unobserve(false);\n            }\n            return;\n        }\n        if (flags & 32 /* updateSourceExpression */) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.interceptor.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            targetObserver = this.targetObserver = new AttributeObserver(this.$scheduler, flags, this.observerLocator, this.target, this.targetProperty, this.targetAttribute);\n        }\n        if (targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n            targetObserver.subscribe(this.interceptor);\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = null;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this.interceptor);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    connect(flags) {\n        if (this.$state & 4 /* isBound */) {\n            flags |= this.persistentFlags;\n            this.sourceExpression.connect(flags | 2097152 /* mustEvaluate */, this.$scope, this.interceptor, this.part); // why do we have a connect method here in the first place? will this be called after bind?\n        }\n    }\n};\nAttributeBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, String, String, Number, Object, Object])\n], AttributeBinding);\nexport { AttributeBinding };\n//# sourceMappingURL=attribute.js.map","/**\n * Attribute accessor in a XML document/element that can be accessed via a namespace.\n * Wraps [`getAttributeNS`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS).\n */\nexport class AttributeNSAccessor {\n    constructor(scheduler, flags, obj, propertyKey, namespace) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.namespace = namespace;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttributeNS(this.namespace, this.propertyKey);\n            }\n            else {\n                this.obj.setAttributeNS(this.namespace, this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttributeNS(this.namespace, this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=attribute-ns-accessor.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet CheckedObserver = class CheckedObserver {\n    constructor(scheduler, flags, observerLocator, handler, obj) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.arrayObserver = void 0;\n        this.valueObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.currentValue;\n            this.oldValue = currentValue;\n            if (this.valueObserver === void 0) {\n                if (this.obj.$observers !== void 0) {\n                    if (this.obj.$observers.model !== void 0) {\n                        this.valueObserver = this.obj.$observers.model;\n                    }\n                    else if (this.obj.$observers.value !== void 0) {\n                        this.valueObserver = this.obj.$observers.value;\n                    }\n                }\n                if (this.valueObserver !== void 0) {\n                    this.valueObserver.subscribe(this);\n                }\n            }\n            if (this.arrayObserver !== void 0) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = void 0;\n            }\n            if (this.obj.type === 'checkbox' && Array.isArray(currentValue)) {\n                this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                this.arrayObserver.subscribeToCollection(this);\n            }\n            this.synchronizeElement();\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        const { currentValue, oldValue } = this;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.oldValue = currentValue;\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(currentValue, oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags));\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    synchronizeElement() {\n        const currentValue = this.currentValue;\n        const obj = this.obj;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        const isRadio = obj.type === 'radio';\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (isRadio) {\n            obj.checked = !!matcher(currentValue, elementValue);\n        }\n        else if (currentValue === true) {\n            obj.checked = true;\n        }\n        else if (Array.isArray(currentValue)) {\n            obj.checked = currentValue.findIndex(item => !!matcher(item, elementValue)) !== -1;\n        }\n        else {\n            obj.checked = false;\n        }\n    }\n    handleEvent() {\n        this.oldValue = this.currentValue;\n        let { currentValue } = this;\n        const { obj } = this;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        let index;\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (obj.type === 'checkbox') {\n            if (Array.isArray(currentValue)) {\n                index = currentValue.findIndex(item => !!matcher(item, elementValue));\n                if (obj.checked && index === -1) {\n                    currentValue.push(elementValue);\n                }\n                else if (!obj.checked && index !== -1) {\n                    currentValue.splice(index, 1);\n                }\n                // when existing currentValue is array, do not invoke callback as only the array obj has changed\n                return;\n            }\n            currentValue = obj.checked;\n        }\n        else if (obj.checked) {\n            currentValue = elementValue;\n        }\n        else {\n            return;\n        }\n        this.currentValue = currentValue;\n        this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.obj.checked;\n    }\n    unbind(flags) {\n        if (this.arrayObserver !== void 0) {\n            this.arrayObserver.unsubscribeFromCollection(this);\n            this.arrayObserver = void 0;\n        }\n        if (this.valueObserver !== void 0) {\n            this.valueObserver.unsubscribe(this);\n        }\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\nCheckedObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object])\n], CheckedObserver);\nexport { CheckedObserver };\n//# sourceMappingURL=checked-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nexport class ClassAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.doNotCache = true;\n        this.nameIndex = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.isActive = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, nameIndex } = this;\n            let { version } = this;\n            this.oldValue = currentValue;\n            const classesToAdd = getClassesToAdd(currentValue);\n            // Get strings split on a space not including empties\n            if (classesToAdd.length > 0) {\n                this.addClassesAndUpdateIndex(classesToAdd);\n            }\n            this.version += 1;\n            // First call to setValue?  We're done.\n            if (version === 0) {\n                return;\n            }\n            // Remove classes from previous version.\n            version -= 1;\n            for (const name in nameIndex) {\n                if (!Object.prototype.hasOwnProperty.call(nameIndex, name) || nameIndex[name] !== version) {\n                    continue;\n                }\n                // TODO: this has the side-effect that classes already present which are added again,\n                // will be removed if they're not present in the next update.\n                // Better would be do have some configurability for this behavior, allowing the user to\n                // decide whether initial classes always need to be kept, always removed, or something in between\n                this.obj.classList.remove(name);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    addClassesAndUpdateIndex(classes) {\n        const node = this.obj;\n        for (let i = 0, ii = classes.length; i < ii; i++) {\n            const className = classes[i];\n            if (className.length === 0) {\n                continue;\n            }\n            this.nameIndex[className] = this.version;\n            node.classList.add(className);\n        }\n    }\n}\nexport function getClassesToAdd(object) {\n    function splitClassString(classString) {\n        const matches = classString.match(/\\S+/g);\n        if (matches === null) {\n            return PLATFORM.emptyArray;\n        }\n        return matches;\n    }\n    if (typeof object === 'string') {\n        return splitClassString(object);\n    }\n    if (object instanceof Array) {\n        const len = object.length;\n        if (len > 0) {\n            const classes = [];\n            for (let i = 0; i < len; ++i) {\n                classes.push(...getClassesToAdd(object[i]));\n            }\n            return classes;\n        }\n        else {\n            return PLATFORM.emptyArray;\n        }\n    }\n    else if (object instanceof Object) {\n        const classes = [];\n        for (const property in object) {\n            // Let non typical values also evaluate true so disable bool check\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, no-extra-boolean-cast\n            if (Boolean(object[property])) {\n                // We must do this in case object property has a space in the name which results in two classes\n                if (property.includes(' ')) {\n                    classes.push(...splitClassString(property));\n                }\n                else {\n                    classes.push(property);\n                }\n            }\n        }\n        return classes;\n    }\n    return PLATFORM.emptyArray;\n}\n//# sourceMappingURL=class-attribute-accessor.js.map","/**\n * Attribute accessor for HTML elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see ElementPropertyAccessor\n */\nexport class DataAttributeAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttribute(this.propertyKey);\n            }\n            else {\n                this.obj.setAttribute(this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=data-attribute-accessor.js.map","/**\n * Property accessor for HTML Elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see DataAttributeAccessor\n */\nexport class ElementPropertyAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            this.obj[this.propertyKey] = currentValue;\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj[this.propertyKey];\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=element-property-accessor.js.map","import { DI } from '@aurelia/kernel';\nimport { DelegationStrategy } from '@aurelia/runtime';\n// Note: path and deepPath are designed to handle v0 and v1 shadow dom specs respectively\n/** @internal */\nexport function findOriginalEventTarget(event) {\n    return (event.composedPath && event.composedPath()[0]) || (event.deepPath && event.deepPath()[0]) || (event.path && event.path[0]) || event.target;\n}\nfunction stopPropagation() {\n    this.standardStopPropagation();\n    this.propagationStopped = true;\n}\nfunction handleCapturedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    const orderedCallbacks = [];\n    /**\n     * During capturing phase, event 'bubbles' down from parent. Needs to reorder callback from root down to target\n     */\n    while (target) {\n        if (target.capturedCallbacks) {\n            const callback = target.capturedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                orderedCallbacks.push(callback);\n            }\n        }\n        target = target.parentNode;\n    }\n    for (let i = orderedCallbacks.length - 1; i >= 0 && !event.propagationStopped; i--) {\n        const orderedCallback = orderedCallbacks[i];\n        if ('handleEvent' in orderedCallback) {\n            orderedCallback.handleEvent(event);\n        }\n        else {\n            orderedCallback(event);\n        }\n    }\n}\nfunction handleDelegatedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    while (target && !event.propagationStopped) {\n        if (target.delegatedCallbacks) {\n            const callback = target.delegatedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                if ('handleEvent' in callback) {\n                    callback.handleEvent(event);\n                }\n                else {\n                    callback(event);\n                }\n            }\n        }\n        target = target.parentNode;\n    }\n}\nexport class ListenerTracker {\n    constructor(dom, eventName, listener, capture) {\n        this.dom = dom;\n        this.eventName = eventName;\n        this.listener = listener;\n        this.capture = capture;\n        this.count = 0;\n    }\n    increment() {\n        this.count++;\n        if (this.count === 1) {\n            this.dom.addEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    decrement() {\n        this.count--;\n        if (this.count === 0) {\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    /* @internal */\n    dispose() {\n        if (this.count > 0) {\n            this.count = 0;\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n}\n/**\n * Enable dispose() pattern for `delegate` & `capture` commands\n */\nexport class DelegateOrCaptureSubscription {\n    constructor(entry, lookup, targetEvent, callback) {\n        this.entry = entry;\n        this.lookup = lookup;\n        this.targetEvent = targetEvent;\n        lookup[targetEvent] = callback;\n    }\n    dispose() {\n        this.entry.decrement();\n        this.lookup[this.targetEvent] = null;\n    }\n}\n/**\n * Enable dispose() pattern for addEventListener for `trigger`\n */\nexport class TriggerSubscription {\n    constructor(dom, target, targetEvent, callback) {\n        this.dom = dom;\n        this.target = target;\n        this.targetEvent = targetEvent;\n        this.callback = callback;\n        dom.addEventListener(targetEvent, callback, target);\n    }\n    dispose() {\n        this.dom.removeEventListener(this.targetEvent, this.callback, this.target);\n    }\n}\nexport class EventSubscriber {\n    constructor(dom, events) {\n        this.dom = dom;\n        this.events = events;\n        this.target = null;\n        this.handler = null;\n    }\n    subscribe(node, callbackOrListener) {\n        this.target = node;\n        this.handler = callbackOrListener;\n        const add = this.dom.addEventListener;\n        const events = this.events;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            add(events[i], callbackOrListener, node);\n        }\n    }\n    dispose() {\n        const node = this.target;\n        const callbackOrListener = this.handler;\n        const events = this.events;\n        const dom = this.dom;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            dom.removeEventListener(events[i], callbackOrListener, node);\n        }\n        this.target = this.handler = null;\n    }\n}\nexport const IEventManager = DI.createInterface('IEventManager').withDefault(x => x.singleton(EventManager));\n/** @internal */\nexport class EventManager {\n    constructor() {\n        this.delegatedHandlers = {};\n        this.capturedHandlers = {};\n    }\n    addEventListener(dom, target, targetEvent, callbackOrListener, strategy) {\n        let delegatedHandlers;\n        let capturedHandlers;\n        let handlerEntry;\n        if (strategy === DelegationStrategy.bubbling) {\n            delegatedHandlers = this.delegatedHandlers;\n            handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleDelegatedEvent, false));\n            handlerEntry.increment();\n            const delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, delegatedCallbacks, targetEvent, callbackOrListener);\n        }\n        if (strategy === DelegationStrategy.capturing) {\n            capturedHandlers = this.capturedHandlers;\n            handlerEntry = capturedHandlers[targetEvent] || (capturedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleCapturedEvent, true));\n            handlerEntry.increment();\n            const capturedCallbacks = target.capturedCallbacks || (target.capturedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, capturedCallbacks, targetEvent, callbackOrListener);\n        }\n        return new TriggerSubscription(dom, target, targetEvent, callbackOrListener);\n    }\n    dispose() {\n        let key;\n        const { delegatedHandlers, capturedHandlers } = this;\n        for (key in delegatedHandlers) {\n            delegatedHandlers[key].dispose();\n        }\n        for (key in capturedHandlers) {\n            capturedHandlers[key].dispose();\n        }\n    }\n}\n//# sourceMappingURL=event-manager.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { IDOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\nimport { bound } from '@aurelia/kernel';\nconst childObserverOptions = {\n    childList: true,\n    subtree: true,\n    characterData: true\n};\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet SelectValueObserver = class SelectValueObserver {\n    constructor(scheduler, flags, observerLocator, dom, handler, obj) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.dom = dom;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.arrayObserver = void 0;\n        this.nodeObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const isArray = Array.isArray(currentValue);\n            if (!isArray && currentValue != void 0 && this.obj.multiple) {\n                throw new Error('Only null or Array instances can be bound to a multi-select.');\n            }\n            if (this.arrayObserver) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = void 0;\n            }\n            if (isArray) {\n                this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                this.arrayObserver.subscribeToCollection(this);\n            }\n            this.synchronizeOptions();\n            this.notify(flags);\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(this.currentValue, this.oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    notify(flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            return;\n        }\n        const oldValue = this.oldValue;\n        const newValue = this.currentValue;\n        if (newValue === oldValue) {\n            return;\n        }\n        this.callSubscribers(newValue, oldValue, flags);\n    }\n    handleEvent() {\n        // \"from-view\" changes are always synchronous now, so immediately sync the value and notify subscribers\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    synchronizeOptions(indexMap) {\n        const { currentValue, obj } = this;\n        const isArray = Array.isArray(currentValue);\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        const options = obj.options;\n        let i = options.length;\n        while (i-- > 0) {\n            const option = options[i];\n            const optionValue = Object.prototype.hasOwnProperty.call(option, 'model') ? option.model : option.value;\n            if (isArray) {\n                option.selected = currentValue.findIndex(item => !!matcher(optionValue, item)) !== -1;\n                continue;\n            }\n            option.selected = !!matcher(optionValue, currentValue);\n        }\n    }\n    synchronizeValue() {\n        // Spec for synchronizing value from `SelectObserver` to `<select/>`\n        // When synchronizing value to observed <select/> element, do the following steps:\n        // A. If `<select/>` is multiple\n        //    1. Check if current value, called `currentValue` is an array\n        //      a. If not an array, return true to signal value has changed\n        //      b. If is an array:\n        //        i. gather all current selected <option/>, in to array called `values`\n        //        ii. loop through the `currentValue` array and remove items that are nolonger selected based on matcher\n        //        iii. loop through the `values` array and add items that are selected based on matcher\n        //        iv. Return false to signal value hasn't changed\n        // B. If the select is single\n        //    1. Let `value` equal the first selected option, if no option selected, then `value` is `null`\n        //    2. assign `this.currentValue` to `this.oldValue`\n        //    3. assign `value` to `this.currentValue`\n        //    4. return `true` to signal value has changed\n        const obj = this.obj;\n        const options = obj.options;\n        const len = options.length;\n        const currentValue = this.currentValue;\n        let i = 0;\n        if (obj.multiple) {\n            // A.\n            if (!Array.isArray(currentValue)) {\n                // A.1.a\n                return true;\n            }\n            // A.1.b\n            // multi select\n            let option;\n            const matcher = obj.matcher || defaultMatcher;\n            // A.1.b.i\n            const values = [];\n            while (i < len) {\n                option = options[i];\n                if (option.selected) {\n                    values.push(Object.prototype.hasOwnProperty.call(option, 'model')\n                        ? option.model\n                        : option.value);\n                }\n                ++i;\n            }\n            // A.1.b.ii\n            i = 0;\n            while (i < currentValue.length) {\n                const a = currentValue[i];\n                // Todo: remove arrow fn\n                if (values.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.splice(i, 1);\n                }\n                else {\n                    ++i;\n                }\n            }\n            // A.1.b.iii\n            i = 0;\n            while (i < values.length) {\n                const a = values[i];\n                // Todo: remove arrow fn\n                if (currentValue.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.push(a);\n                }\n                ++i;\n            }\n            // A.1.b.iv\n            return false;\n        }\n        // B. single select\n        // B.1\n        let value = null;\n        while (i < len) {\n            const option = options[i];\n            if (option.selected) {\n                value = Object.prototype.hasOwnProperty.call(option, 'model')\n                    ? option.model\n                    : option.value;\n                break;\n            }\n            ++i;\n        }\n        // B.2\n        this.oldValue = this.currentValue;\n        // B.3\n        this.currentValue = value;\n        // B.4\n        return true;\n    }\n    bind(flags) {\n        this.nodeObserver = this.dom.createNodeObserver(this.obj, this.handleNodeChange, childObserverOptions);\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        this.nodeObserver.disconnect();\n        this.nodeObserver = null;\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n        if (this.arrayObserver) {\n            this.arrayObserver.unsubscribeFromCollection(this);\n            this.arrayObserver = null;\n        }\n    }\n    handleNodeChange() {\n        this.synchronizeOptions();\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.notify(131072 /* fromDOMEvent */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], SelectValueObserver.prototype, \"handleNodeChange\", null);\nSelectValueObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object, Object])\n], SelectValueObserver);\nexport { SelectValueObserver };\n//# sourceMappingURL=select-value-observer.js.map","import { PLATFORM, kebabCase } from '@aurelia/kernel';\nexport class StyleAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.styles = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.obj.style.cssText;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    getStyleTuplesFromString(currentValue) {\n        const styleTuples = [];\n        const rx = /\\s*([\\w-]+)\\s*:\\s*((?:(?:[\\w-]+\\(\\s*(?:\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[\\w-]+\\(\\s*(?:[^\"](?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^)]*)\\),?|[^)]*)\\),?|\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^;]*),?\\s*)+);?/g;\n        let pair;\n        let name;\n        while ((pair = rx.exec(currentValue)) !== null) {\n            name = pair[1];\n            if (name.length === 0) {\n                continue;\n            }\n            styleTuples.push([name, pair[2]]);\n        }\n        return styleTuples;\n    }\n    getStyleTuplesFromObject(currentValue) {\n        let value;\n        const styles = [];\n        for (const property in currentValue) {\n            value = currentValue[property];\n            if (value == null) {\n                continue;\n            }\n            if (typeof value === 'string') {\n                styles.push([kebabCase(property), value]);\n                continue;\n            }\n            styles.push(...this.getStyleTuples(value));\n        }\n        return styles;\n    }\n    getStyleTuplesFromArray(currentValue) {\n        const len = currentValue.length;\n        if (len > 0) {\n            const styles = [];\n            for (let i = 0; i < len; ++i) {\n                styles.push(...this.getStyleTuples(currentValue[i]));\n            }\n            return styles;\n        }\n        return PLATFORM.emptyArray;\n    }\n    getStyleTuples(currentValue) {\n        if (typeof currentValue === 'string') {\n            return this.getStyleTuplesFromString(currentValue);\n        }\n        if (currentValue instanceof Array) {\n            return this.getStyleTuplesFromArray(currentValue);\n        }\n        if (currentValue instanceof Object) {\n            return this.getStyleTuplesFromObject(currentValue);\n        }\n        return PLATFORM.emptyArray;\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const styles = this.styles;\n            let style;\n            let version = this.version;\n            const styleTuples = this.getStyleTuples(currentValue);\n            let tuple;\n            let name;\n            let value;\n            const len = styleTuples.length;\n            for (let i = 0; i < len; ++i) {\n                tuple = styleTuples[i];\n                name = tuple[0];\n                value = tuple[1];\n                this.setProperty(name, value);\n                styles[name] = version;\n            }\n            this.styles = styles;\n            this.version += 1;\n            if (version === 0) {\n                return;\n            }\n            version -= 1;\n            for (style in styles) {\n                if (!Object.prototype.hasOwnProperty.call(styles, style) || styles[style] !== version) {\n                    continue;\n                }\n                this.obj.style.removeProperty(style);\n            }\n        }\n    }\n    setProperty(style, value) {\n        let priority = '';\n        if (value != null && typeof value.indexOf === 'function' && value.includes('!important')) {\n            priority = 'important';\n            value = value.replace('!important', '');\n        }\n        this.obj.style.setProperty(style, value, priority);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.oldValue = this.currentValue = this.obj.style.cssText;\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=style-attribute-accessor.js.map","import { DI } from '@aurelia/kernel';\nexport const ISVGAnalyzer = DI.createInterface('ISVGAnalyzer').withDefault(x => x.singleton(class {\n    isStandardSvgAttribute(node, attributeName) {\n        return false;\n    }\n}));\n//# sourceMappingURL=svg-analyzer.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { subscriberCollection, IScheduler, } from '@aurelia/runtime';\n// TODO: handle file attribute properly again, etc\n/**\n * Observer for non-radio, non-checkbox input.\n */\nlet ValueAttributeObserver = class ValueAttributeObserver {\n    constructor(scheduler, flags, handler, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.handler = handler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, oldValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj[this.propertyKey] = '';\n            }\n            else {\n                this.obj[this.propertyKey] = currentValue;\n            }\n            if ((flags & 4096 /* fromBind */) === 0) {\n                this.callSubscribers(currentValue, oldValue, flags);\n            }\n        }\n    }\n    handleEvent() {\n        const oldValue = this.oldValue = this.currentValue;\n        const currentValue = this.currentValue = this.obj[this.propertyKey];\n        if (oldValue !== currentValue) {\n            this.oldValue = currentValue;\n            this.callSubscribers(currentValue, oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n            this.currentValue = this.oldValue = this.obj[this.propertyKey];\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nValueAttributeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String])\n], ValueAttributeObserver);\nexport { ValueAttributeObserver };\n//# sourceMappingURL=value-attribute-observer.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { Registration } from '@aurelia/kernel';\nimport { IDOM, ITargetAccessorLocator, ITargetObserverLocator, SetterObserver } from '@aurelia/runtime';\nimport { AttributeNSAccessor } from './attribute-ns-accessor';\nimport { CheckedObserver } from './checked-observer';\nimport { ClassAttributeAccessor } from './class-attribute-accessor';\nimport { DataAttributeAccessor } from './data-attribute-accessor';\nimport { ElementPropertyAccessor } from './element-property-accessor';\nimport { EventSubscriber } from './event-manager';\nimport { SelectValueObserver } from './select-value-observer';\nimport { StyleAttributeAccessor } from './style-attribute-accessor';\nimport { ISVGAnalyzer } from './svg-analyzer';\nimport { ValueAttributeObserver } from './value-attribute-observer';\n// https://infra.spec.whatwg.org/#namespaces\nconst htmlNS = 'http://www.w3.org/1999/xhtml';\nconst mathmlNS = 'http://www.w3.org/1998/Math/MathML';\nconst svgNS = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink';\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace';\nconst xmlnsNS = 'http://www.w3.org/2000/xmlns/';\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\nconst nsAttributes = Object.assign(Object.create(null), {\n    'xlink:actuate': ['actuate', xlinkNS],\n    'xlink:arcrole': ['arcrole', xlinkNS],\n    'xlink:href': ['href', xlinkNS],\n    'xlink:role': ['role', xlinkNS],\n    'xlink:show': ['show', xlinkNS],\n    'xlink:title': ['title', xlinkNS],\n    'xlink:type': ['type', xlinkNS],\n    'xml:lang': ['lang', xmlNS],\n    'xml:space': ['space', xmlNS],\n    'xmlns': ['xmlns', xmlnsNS],\n    'xmlns:xlink': ['xlink', xmlnsNS],\n});\nconst inputEvents = ['change', 'input'];\nconst selectEvents = ['change'];\nconst contentEvents = ['change', 'input', 'blur', 'keyup', 'paste'];\nconst scrollEvents = ['scroll'];\nconst overrideProps = Object.assign(Object.create(null), {\n    'class': true,\n    'style': true,\n    'css': true,\n    'checked': true,\n    'value': true,\n    'model': true,\n    'xlink:actuate': true,\n    'xlink:arcrole': true,\n    'xlink:href': true,\n    'xlink:role': true,\n    'xlink:show': true,\n    'xlink:title': true,\n    'xlink:type': true,\n    'xml:lang': true,\n    'xml:space': true,\n    'xmlns': true,\n    'xmlns:xlink': true,\n});\nlet TargetObserverLocator = class TargetObserverLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetObserverLocator, this).register(container);\n    }\n    getObserver(flags, scheduler, lifecycle, observerLocator, obj, propertyName) {\n        switch (propertyName) {\n            case 'checked':\n                return new CheckedObserver(scheduler, flags, observerLocator, new EventSubscriber(this.dom, inputEvents), obj);\n            case 'value':\n                if (obj.tagName === 'SELECT') {\n                    return new SelectValueObserver(scheduler, flags, observerLocator, this.dom, new EventSubscriber(this.dom, selectEvents), obj);\n                }\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'files':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'textContent':\n            case 'innerHTML':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, contentEvents), obj, propertyName);\n            case 'scrollTop':\n            case 'scrollLeft':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, scrollEvents), obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            case 'model':\n                return new SetterObserver(lifecycle, flags, obj, propertyName);\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n        }\n        return null;\n    }\n    overridesAccessor(flags, obj, propertyName) {\n        return overrideProps[propertyName] === true;\n    }\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetObserverLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TargetObserverLocator);\nexport { TargetObserverLocator };\nlet TargetAccessorLocator = class TargetAccessorLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetAccessorLocator, this).register(container);\n    }\n    getAccessor(flags, scheduler, lifecycle, obj, propertyName) {\n        switch (propertyName) {\n            case 'textContent':\n                // note: this case is just an optimization (textContent is the most often used property)\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            // TODO: there are (many) more situation where we want to default to DataAttributeAccessor,\n            // but for now stick to what vCurrent does\n            case 'src':\n            case 'href':\n            // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n        }\n    }\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetAccessorLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TargetAccessorLocator);\nexport { TargetAccessorLocator };\nconst IsDataAttribute = {};\nfunction isDataAttribute(obj, propertyName, svgAnalyzer) {\n    if (IsDataAttribute[propertyName] === true) {\n        return true;\n    }\n    const prefix = propertyName.slice(0, 5);\n    // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n    // https://html.spec.whatwg.org/multipage/dom.html#custom-data-attribute\n    return IsDataAttribute[propertyName] =\n        prefix === 'aria-' ||\n            prefix === 'data-' ||\n            svgAnalyzer.isStandardSvgAttribute(obj, propertyName);\n}\n//# sourceMappingURL=observer-locator.js.map","import { __decorate } from \"tslib\";\nimport { bindingBehavior, IScheduler } from '@aurelia/runtime';\nimport { DataAttributeAccessor } from '../../observation/data-attribute-accessor';\nlet AttrBindingBehavior = class AttrBindingBehavior {\n    bind(flags, scope, binding) {\n        binding.targetObserver = new DataAttributeAccessor(binding.locator.get(IScheduler), flags, binding.target, binding.targetProperty);\n    }\n    unbind(flags, scope, binding) {\n        return;\n    }\n};\nAttrBindingBehavior = __decorate([\n    bindingBehavior('attr')\n], AttrBindingBehavior);\nexport { AttrBindingBehavior };\n//# sourceMappingURL=attr.js.map","import { __decorate } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { bindingBehavior } from '@aurelia/runtime';\nimport { findOriginalEventTarget } from '../../observation/event-manager';\n/** @internal */\nexport function handleSelfEvent(event) {\n    const target = findOriginalEventTarget(event);\n    if (this.target !== target) {\n        return;\n    }\n    return this.selfEventCallSource(event);\n}\nlet SelfBindingBehavior = class SelfBindingBehavior {\n    bind(flags, scope, binding) {\n        if (!binding.callSource || !binding.targetEvent) {\n            throw Reporter.error(8);\n        }\n        binding.selfEventCallSource = binding.callSource;\n        binding.callSource = handleSelfEvent;\n    }\n    unbind(flags, scope, binding) {\n        binding.callSource = binding.selfEventCallSource;\n        binding.selfEventCallSource = null;\n    }\n};\nSelfBindingBehavior = __decorate([\n    bindingBehavior('self')\n], SelfBindingBehavior);\nexport { SelfBindingBehavior };\n//# sourceMappingURL=self.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { BindingMode, IDOM, IObserverLocator, bindingBehavior } from '@aurelia/runtime';\nimport { EventSubscriber } from '../../observation/event-manager';\nlet UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\n    constructor(observerLocator) {\n        this.observerLocator = observerLocator;\n    }\n    bind(flags, scope, binding, ...events) {\n        if (events.length === 0) {\n            throw Reporter.error(9);\n        }\n        if (binding.mode !== BindingMode.twoWay && binding.mode !== BindingMode.fromView) {\n            throw Reporter.error(10);\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        // ensure the binding's target observer has been set.\n        const targetObserver = this.observerLocator.getObserver(this.persistentFlags | flags, binding.target, binding.targetProperty);\n        if (!targetObserver.handler) {\n            throw Reporter.error(10);\n        }\n        binding.targetObserver = targetObserver;\n        // stash the original element subscribe function.\n        targetObserver.originalHandler = binding.targetObserver.handler;\n        // replace the element subscribe function with one that uses the correct events.\n        targetObserver.handler = new EventSubscriber(binding.locator.get(IDOM), events);\n    }\n    unbind(flags, scope, binding) {\n        // restore the state of the binding.\n        binding.targetObserver.handler.dispose();\n        binding.targetObserver.handler = binding.targetObserver.originalHandler;\n        binding.targetObserver.originalHandler = null;\n    }\n};\nUpdateTriggerBindingBehavior = __decorate([\n    bindingBehavior('updateTrigger'),\n    __param(0, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], UpdateTriggerBindingBehavior);\nexport { UpdateTriggerBindingBehavior };\n//# sourceMappingURL=update-trigger.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nexport const noopShadowDOMStyles = Object.freeze({\n    applyTo: PLATFORM.noop\n});\nexport const IShadowDOMStyles = DI.createInterface('IShadowDOMStyles').noDefault();\nexport const IShadowDOMGlobalStyles = DI.createInterface('IShadowDOMGlobalStyles')\n    .withDefault(x => x.instance(noopShadowDOMStyles));\nexport class AdoptedStyleSheetsStyles {\n    constructor(dom, localStyles, styleSheetCache, sharedStyles = null) {\n        this.sharedStyles = sharedStyles;\n        this.styleSheets = localStyles.map(x => {\n            let sheet;\n            if (x instanceof dom.CSSStyleSheet) {\n                sheet = x;\n            }\n            else {\n                sheet = styleSheetCache.get(x);\n                if (!sheet) {\n                    sheet = new dom.CSSStyleSheet();\n                    sheet.replaceSync(x);\n                    styleSheetCache.set(x, sheet);\n                }\n            }\n            return sheet;\n        });\n    }\n    static supported(dom) {\n        return 'adoptedStyleSheets' in dom.ShadowRoot.prototype;\n    }\n    applyTo(shadowRoot) {\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n        // https://wicg.github.io/construct-stylesheets/\n        // https://developers.google.com/web/updates/2019/02/constructable-stylesheets\n        shadowRoot.adoptedStyleSheets = [\n            ...shadowRoot.adoptedStyleSheets,\n            ...this.styleSheets\n        ];\n    }\n}\nexport class StyleElementStyles {\n    constructor(dom, localStyles, sharedStyles = null) {\n        this.dom = dom;\n        this.localStyles = localStyles;\n        this.sharedStyles = sharedStyles;\n    }\n    applyTo(shadowRoot) {\n        const styles = this.localStyles;\n        const dom = this.dom;\n        for (let i = styles.length - 1; i > -1; --i) {\n            const element = dom.createElement('style');\n            element.innerHTML = styles[i];\n            shadowRoot.prepend(element);\n        }\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n    }\n}\n//# sourceMappingURL=shadow-dom-styles.js.map","import { PLATFORM, Registration, Reporter, toArray, Metadata } from '@aurelia/kernel';\nimport { IProjectorLocator, CustomElement, } from '@aurelia/runtime';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\nconst defaultShadowOptions = {\n    mode: 'open'\n};\nexport class HTMLProjectorLocator {\n    static register(container) {\n        return Registration.singleton(IProjectorLocator, this).register(container);\n    }\n    getElementProjector(dom, $component, host, def) {\n        if (def.shadowOptions || def.hasSlots) {\n            if (def.containerless) {\n                throw Reporter.error(21);\n            }\n            return new ShadowDOMProjector(dom, $component, host, def);\n        }\n        if (def.containerless) {\n            return new ContainerlessProjector(dom, $component, host);\n        }\n        return new HostProjector($component, host);\n    }\n}\nconst childObserverOptions = { childList: true };\n/** @internal */\nexport class ShadowDOMProjector {\n    constructor(dom, \n    // eslint-disable-next-line @typescript-eslint/prefer-readonly\n    $controller, host, definition) {\n        this.dom = dom;\n        this.$controller = $controller;\n        this.host = host;\n        let shadowOptions;\n        if (definition.shadowOptions instanceof Object &&\n            'mode' in definition.shadowOptions) {\n            shadowOptions = definition.shadowOptions;\n        }\n        else {\n            shadowOptions = defaultShadowOptions;\n        }\n        this.shadowRoot = host.attachShadow(shadowOptions);\n        Metadata.define(CustomElement.name, $controller, this.host);\n        Metadata.define(CustomElement.name, $controller, this.shadowRoot);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback, options = childObserverOptions) {\n        // TODO: add a way to dispose/disconnect\n        this.dom.createNodeObserver(this.host, callback, options);\n    }\n    provideEncapsulationSource() {\n        return this.shadowRoot;\n    }\n    project(nodes) {\n        const context = this.$controller.context;\n        const styles = context.has(IShadowDOMStyles, false)\n            ? context.get(IShadowDOMStyles)\n            : context.get(IShadowDOMGlobalStyles);\n        styles.applyTo(this.shadowRoot);\n        nodes.appendTo(this.shadowRoot);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class ContainerlessProjector {\n    constructor(dom, $controller, host) {\n        if (host.childNodes.length) {\n            this.childNodes = toArray(host.childNodes);\n        }\n        else {\n            this.childNodes = PLATFORM.emptyArray;\n        }\n        this.host = dom.convertToRenderLocation(host);\n        Metadata.define(CustomElement.name, $controller, this.host);\n    }\n    get children() {\n        return this.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // TODO: turn this into an error\n        // Containerless does not have a container node to observe children on.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.insertBefore(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class HostProjector {\n    constructor($controller, host) {\n        this.host = host;\n        Metadata.define(CustomElement.name, $controller, host);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // Do nothing since this scenario will never have children.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.appendTo(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n//# sourceMappingURL=projectors.js.map","import { PLATFORM, Registration, Reporter } from '@aurelia/kernel';\nimport { DOM, IDOM, INode, CustomElement } from '@aurelia/runtime';\nimport { ShadowDOMProjector } from './projectors';\nexport var NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Element\"] = 1] = \"Element\";\n    NodeType[NodeType[\"Attr\"] = 2] = \"Attr\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATASection\"] = 4] = \"CDATASection\";\n    NodeType[NodeType[\"EntityReference\"] = 5] = \"EntityReference\";\n    NodeType[NodeType[\"Entity\"] = 6] = \"Entity\";\n    NodeType[NodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    NodeType[NodeType[\"Comment\"] = 8] = \"Comment\";\n    NodeType[NodeType[\"Document\"] = 9] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    NodeType[NodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n    NodeType[NodeType[\"Notation\"] = 12] = \"Notation\";\n})(NodeType || (NodeType = {}));\nconst effectiveParentNodeOverrides = new WeakMap();\n/**\n * IDOM implementation for Html.\n */\nexport class HTMLDOM {\n    constructor(window, document, TNode, TElement, THTMLElement, TCustomEvent, TCSSStyleSheet, TShadowRoot) {\n        this.window = window;\n        this.document = document;\n        this.Node = TNode;\n        this.Element = TElement;\n        this.HTMLElement = THTMLElement;\n        this.CustomEvent = TCustomEvent;\n        this.CSSStyleSheet = TCSSStyleSheet;\n        this.ShadowRoot = TShadowRoot;\n        if (DOM.isInitialized) {\n            Reporter.write(1001); // TODO: create reporters code // DOM already initialized (just info)\n            DOM.destroy();\n        }\n        DOM.initialize(this);\n        this.emptyNodes = new FragmentNodeSequence(this, document.createDocumentFragment());\n    }\n    static register(container) {\n        return Registration.alias(IDOM, this).register(container);\n    }\n    addEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).addEventListener(eventName, subscriber, options);\n    }\n    appendChild(parent, child) {\n        parent.appendChild(child);\n    }\n    cloneNode(node, deep) {\n        return node.cloneNode(deep !== false);\n    }\n    convertToRenderLocation(node) {\n        if (this.isRenderLocation(node)) {\n            return node; // it's already a IRenderLocation (converted by FragmentNodeSequence)\n        }\n        if (node.parentNode == null) {\n            throw Reporter.error(52);\n        }\n        const locationEnd = this.document.createComment('au-end');\n        const locationStart = this.document.createComment('au-start');\n        node.parentNode.replaceChild(locationEnd, node);\n        locationEnd.parentNode.insertBefore(locationStart, locationEnd);\n        locationEnd.$start = locationStart;\n        locationStart.$nodes = null;\n        return locationEnd;\n    }\n    createDocumentFragment(markupOrNode) {\n        if (markupOrNode == null) {\n            return this.document.createDocumentFragment();\n        }\n        if (this.isNodeInstance(markupOrNode)) {\n            if (markupOrNode.content !== undefined) {\n                return markupOrNode.content;\n            }\n            const fragment = this.document.createDocumentFragment();\n            fragment.appendChild(markupOrNode);\n            return fragment;\n        }\n        return this.createTemplate(markupOrNode).content;\n    }\n    createNodeSequence(fragment) {\n        if (fragment === null) {\n            return this.emptyNodes;\n        }\n        return new FragmentNodeSequence(this, fragment.cloneNode(true));\n    }\n    createElement(name) {\n        return this.document.createElement(name);\n    }\n    fetch(input, init) {\n        return this.window.fetch(input, init);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    createCustomEvent(eventType, options) {\n        return new this.CustomEvent(eventType, options);\n    }\n    dispatchEvent(evt) {\n        this.document.dispatchEvent(evt);\n    }\n    createNodeObserver(node, cb, init) {\n        if (typeof MutationObserver === 'undefined') {\n            // TODO: find a proper response for this scenario\n            return {\n                disconnect() { },\n                observe() { },\n                takeRecords() { return PLATFORM.emptyArray; }\n            };\n        }\n        const observer = new MutationObserver(cb);\n        observer.observe(node, init);\n        return observer;\n    }\n    createTemplate(markup) {\n        if (markup == null) {\n            return this.document.createElement('template');\n        }\n        const template = this.document.createElement('template');\n        template.innerHTML = markup.toString();\n        return template;\n    }\n    createTextNode(text) {\n        return this.document.createTextNode(text);\n    }\n    /**\n     * Returns the effective parentNode according to Aurelia's component hierarchy.\n     *\n     * Used by Aurelia to find the closest parent controller relative to a node.\n     *\n     * This method supports 3 additional scenarios that `node.parentNode` does not support:\n     * - Containerless elements. The parentNode in this case is a comment precending the element under specific conditions, rather than a node wrapping the element.\n     * - ShadowDOM. If a `ShadowRoot` is encountered, this method retrieves the associated controller via the metadata api to locate the original host.\n     * - Portals. If the provided node was moved to a different location in the DOM by a `portal` attribute, then the original parent of the node will be returned.\n     *\n     * @param node - The node to get the parent for.\n     * @returns Either the closest parent node, the closest `IRenderLocation` (comment node that is the containerless host), original portal host, or `null` if this is either the absolute document root or a disconnected node.\n     */\n    getEffectiveParentNode(node) {\n        // TODO: this method needs more tests!\n        // First look for any overrides\n        if (effectiveParentNodeOverrides.has(node)) {\n            return effectiveParentNodeOverrides.get(node);\n        }\n        // Then try to get the nearest au-start render location, which would be the containerless parent,\n        // again looking for any overrides along the way.\n        // otherwise return the normal parent node\n        let containerlessOffset = 0;\n        let next = node.nextSibling;\n        while (next !== null) {\n            if (next.nodeType === 8 /* Comment */) {\n                switch (next.textContent) {\n                    case 'au-start':\n                        // If we see an au-start before we see au-end, it will precede the host of a sibling containerless element rather than a parent.\n                        // So we use the offset to ignore the next au-end\n                        ++containerlessOffset;\n                        break;\n                    case 'au-end':\n                        if (containerlessOffset-- === 0) {\n                            return next;\n                        }\n                }\n            }\n            next = next.nextSibling;\n        }\n        if (node.parentNode === null && node.nodeType === 11 /* DocumentFragment */) {\n            // Could be a shadow root; see if there's a controller and if so, get the original host via the projector\n            const controller = CustomElement.for(node);\n            if (controller === void 0) {\n                // Not a shadow root (or at least, not one created by Aurelia)\n                // Nothing more we can try, just return null\n                return null;\n            }\n            const projector = controller.projector;\n            if (projector instanceof ShadowDOMProjector) {\n                // Now we can use the original host to traverse further up\n                return this.getEffectiveParentNode(projector.host);\n            }\n        }\n        return node.parentNode;\n    }\n    setEffectiveParentNode(childNodeOrNodeSequence, parentNode) {\n        if (this.isNodeInstance(childNodeOrNodeSequence)) {\n            effectiveParentNodeOverrides.set(childNodeOrNodeSequence, parentNode);\n        }\n        else {\n            const nodes = childNodeOrNodeSequence.childNodes;\n            for (let i = 0, ii = nodes.length; i < ii; ++i) {\n                effectiveParentNodeOverrides.set(nodes[i], parentNode);\n            }\n        }\n    }\n    insertBefore(nodeToInsert, referenceNode) {\n        referenceNode.parentNode.insertBefore(nodeToInsert, referenceNode);\n    }\n    isMarker(node) {\n        return node.nodeName === 'AU-M';\n    }\n    isNodeInstance(potentialNode) {\n        return potentialNode != null && potentialNode.nodeType > 0;\n    }\n    isRenderLocation(node) {\n        return node.textContent === 'au-end';\n    }\n    makeTarget(node) {\n        node.className = 'au';\n    }\n    registerElementResolver(container, resolver) {\n        container.registerResolver(INode, resolver);\n        container.registerResolver(this.Node, resolver);\n        container.registerResolver(this.Element, resolver);\n        container.registerResolver(this.HTMLElement, resolver);\n    }\n    remove(node) {\n        if (node.remove) {\n            node.remove();\n        }\n        else {\n            node.parentNode.removeChild(node);\n        }\n    }\n    removeEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).removeEventListener(eventName, subscriber, options);\n    }\n    setAttribute(node, name, value) {\n        node.setAttribute(name, value);\n    }\n}\nconst $DOM = DOM;\nexport { $DOM as DOM };\n/* eslint-enable @typescript-eslint/no-explicit-any */\n// This is the most common form of INodeSequence.\n// Every custom element or template controller whose node sequence is based on an HTML template\n// has an instance of this under the hood. Anyone who wants to create a node sequence from\n// a string of markup would also receive an instance of this.\n// CompiledTemplates create instances of FragmentNodeSequence.\n/**\n * This is the most common form of INodeSequence.\n *\n * @internal\n */\nexport class FragmentNodeSequence {\n    constructor(dom, fragment) {\n        this.dom = dom;\n        this.fragment = fragment;\n        this.isMounted = false;\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n        const targetNodeList = fragment.querySelectorAll('.au');\n        let i = 0;\n        let ii = targetNodeList.length;\n        const targets = this.targets = Array(ii);\n        while (i < ii) {\n            // eagerly convert all markers to RenderLocations (otherwise the renderer\n            // will do it anyway) and store them in the target list (since the comments\n            // can't be queried)\n            const target = targetNodeList[i];\n            if (target.nodeName === 'AU-M') {\n                // note the renderer will still call this method, but it will just return the\n                // location if it sees it's already a location\n                targets[i] = this.dom.convertToRenderLocation(target);\n            }\n            else {\n                // also store non-markers for consistent ordering\n                targets[i] = target;\n            }\n            ++i;\n        }\n        const childNodeList = fragment.childNodes;\n        i = 0;\n        ii = childNodeList.length;\n        const childNodes = this.childNodes = Array(ii);\n        while (i < ii) {\n            childNodes[i] = childNodeList[i];\n            ++i;\n        }\n        this.firstChild = fragment.firstChild;\n        this.lastChild = fragment.lastChild;\n    }\n    findTargets() {\n        return this.targets;\n    }\n    insertBefore(refNode) {\n        if (this.isLinked && !!this.refNode) {\n            this.addToLinked();\n        }\n        else {\n            const parent = refNode.parentNode;\n            if (this.isMounted) {\n                let current = this.firstChild;\n                const end = this.lastChild;\n                let next;\n                while (current != null) {\n                    next = current.nextSibling;\n                    parent.insertBefore(current, refNode);\n                    if (current === end) {\n                        break;\n                    }\n                    current = next;\n                }\n            }\n            else {\n                this.isMounted = true;\n                refNode.parentNode.insertBefore(this.fragment, refNode);\n            }\n        }\n    }\n    appendTo(parent) {\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.appendChild(this.fragment);\n        }\n    }\n    remove() {\n        if (this.isMounted) {\n            this.isMounted = false;\n            const fragment = this.fragment;\n            const end = this.lastChild;\n            let next;\n            let current = this.firstChild;\n            while (current !== null) {\n                next = current.nextSibling;\n                fragment.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n    }\n    addToLinked() {\n        const refNode = this.refNode;\n        const parent = refNode.parentNode;\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.insertBefore(current, refNode);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.insertBefore(this.fragment, refNode);\n        }\n    }\n    unlink() {\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n    }\n    link(next) {\n        this.isLinked = true;\n        if (this.dom.isRenderLocation(next)) {\n            this.refNode = next;\n        }\n        else {\n            this.next = next;\n            this.obtainRefNode();\n        }\n    }\n    obtainRefNode() {\n        if (this.next !== void 0) {\n            this.refNode = this.next.firstChild;\n        }\n        else {\n            this.refNode = void 0;\n        }\n    }\n}\n/** @internal */\nexport class AuMarker {\n    constructor(nextSibling) {\n        this.nextSibling = nextSibling;\n        this.textContent = '';\n    }\n    get parentNode() {\n        return this.nextSibling.parentNode;\n    }\n    remove() { }\n}\n(proto => {\n    proto.previousSibling = null;\n    proto.childNodes = PLATFORM.emptyArray;\n    proto.nodeName = 'AU-M';\n    proto.nodeType = 1 /* Element */;\n})(AuMarker.prototype);\n//# sourceMappingURL=dom.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { PLATFORM } from '@aurelia/kernel';\nimport { bindable, customAttribute, IDOM, INode, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\nconst unset = Symbol();\n// Using passive to help with performance\nconst defaultCaptureEventInit = {\n    passive: true,\n    capture: true\n};\n// Using passive to help with performance\nconst defaultBubbleEventInit = {\n    passive: true\n};\n// weakly connect a document to a blur manager\n// to avoid polluting the document properties\nconst blurDocMap = new WeakMap();\nexport class BlurManager {\n    constructor(dom, scheduler) {\n        this.dom = dom;\n        this.scheduler = scheduler;\n        this.blurs = [];\n        blurDocMap.set(dom.document, this);\n        this.handler = createHandler(this, this.blurs);\n    }\n    static createFor(dom, scheduler) {\n        return blurDocMap.get(dom.document) || new BlurManager(dom, scheduler);\n    }\n    register(blur) {\n        const blurs = this.blurs;\n        if (!blurs.includes(blur) && blurs.push(blur) === 1) {\n            this.addListeners();\n        }\n    }\n    unregister(blur) {\n        const blurs = this.blurs;\n        const index = blurs.indexOf(blur);\n        if (index > -1) {\n            blurs.splice(index, 1);\n        }\n        if (blurs.length === 0) {\n            this.removeListeners();\n        }\n    }\n    addListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.addEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.addEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.addEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.addEventListener('focus', handler, defaultCaptureEventInit);\n        win.addEventListener('blur', handler, defaultBubbleEventInit);\n    }\n    removeListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.removeEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.removeEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.removeEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.removeEventListener('focus', handler, defaultCaptureEventInit);\n        win.removeEventListener('blur', handler, defaultBubbleEventInit);\n    }\n}\nlet Blur = class Blur {\n    constructor(element, dom, scheduler) {\n        this.dom = dom;\n        this.element = element;\n        /**\n         * By default, the behavior should be least surprise possible, that:\n         *\n         * it searches for anything from root context,\n         * and root context is document body\n         */\n        this.linkedMultiple = true;\n        this.searchSubTree = true;\n        this.linkingContext = null;\n        this.value = unset;\n        this.manager = BlurManager.createFor(dom, scheduler);\n    }\n    afterAttach() {\n        this.manager.register(this);\n    }\n    beforeDetach() {\n        this.manager.unregister(this);\n    }\n    handleEventTarget(target) {\n        if (this.value === false) {\n            return;\n        }\n        const dom = this.dom;\n        if (target === dom.window || target === dom.document || !this.contains(target)) {\n            this.triggerBlur();\n        }\n    }\n    contains(target) {\n        if (!this.value) {\n            return false;\n        }\n        let els;\n        let i;\n        let j, jj;\n        let link;\n        const element = this.element;\n        if (containsElementOrShadowRoot(element, target)) {\n            return true;\n        }\n        if (!this.linkedWith) {\n            return false;\n        }\n        const doc = this.dom.document;\n        const linkedWith = this.linkedWith;\n        const linkingContext = this.linkingContext;\n        const searchSubTree = this.searchSubTree;\n        const linkedMultiple = this.linkedMultiple;\n        const links = Array.isArray(linkedWith) ? linkedWith : [linkedWith];\n        const contextNode = (typeof linkingContext === 'string'\n            ? doc.querySelector(linkingContext)\n            : linkingContext)\n            || doc.body;\n        const ii = links.length;\n        for (i = 0; ii > i; ++i) {\n            link = links[i];\n            // When user specify to link with something by a string, it acts as a CSS selector\n            // We need to do some querying stuff to determine if target above is contained.\n            if (typeof link === 'string') {\n                // Default behavior, search the whole tree, from context that user specified, which default to document body\n                if (searchSubTree) {\n                    // todo: are there too many knobs?? Consider remove \"linkedMultiple\"??\n                    if (!linkedMultiple) {\n                        const el = contextNode.querySelector(link);\n                        els = el !== null ? [el] : PLATFORM.emptyArray;\n                    }\n                    else {\n                        els = contextNode.querySelectorAll(link);\n                    }\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].contains(target)) {\n                            return true;\n                        }\n                    }\n                }\n                else {\n                    // default to document body, if user didn't define a linking context, and wanted to ignore subtree.\n                    // This is specifically performant and useful for dialogs, plugins\n                    // that usually generate contents to document body\n                    els = contextNode.children;\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].matches(link)) {\n                            return true;\n                        }\n                    }\n                }\n            }\n            else {\n                // When user passed in something that is not a string,\n                // simply check if has method `contains` (allow duck typing)\n                // and call it against target.\n                // This enables flexible usages\n                if (link && link.contains(target)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    triggerBlur() {\n        this.value = false;\n        if (typeof this.onBlur === 'function') {\n            this.onBlur.call(null);\n        }\n    }\n};\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"value\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Blur.prototype, \"onBlur\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"linkedWith\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Blur.prototype, \"linkedMultiple\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Blur.prototype, \"searchSubTree\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"linkingContext\", void 0);\nBlur = __decorate([\n    customAttribute('blur'),\n    __param(0, INode), __param(1, IDOM), __param(2, IScheduler),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM, Object])\n], Blur);\nexport { Blur };\nconst containsElementOrShadowRoot = (container, target) => {\n    if (container.contains(target)) {\n        return true;\n    }\n    let parentNode = null;\n    while (target != null) {\n        if (target === container) {\n            return true;\n        }\n        parentNode = target.parentNode;\n        if (parentNode === null && target.nodeType === 11 /* DocumentFragment */) {\n            target = target.host;\n            continue;\n        }\n        target = parentNode;\n    }\n    return false;\n};\nconst createHandler = (manager, checkTargets) => {\n    // *******************************\n    // EVENTS ORDER\n    // -----------------------------\n    // pointerdown\n    // touchstart\n    // pointerup\n    // touchend\n    // mousedown\n    // --------------\n    // BLUR\n    // FOCUS\n    // --------------\n    // mouseup\n    // click\n    //\n    // ******************************\n    //\n    // There are cases focus happens without mouse interaction (keyboard)\n    // So it needs to capture both mouse / focus movement\n    //\n    // ******************************\n    let hasChecked = false;\n    const revertCheckage = () => {\n        hasChecked = false;\n    };\n    const markChecked = () => {\n        hasChecked = true;\n        manager.scheduler.queueRenderTask(revertCheckage, { preempt: true });\n    };\n    const handleMousedown = (e) => {\n        if (!hasChecked) {\n            handleEvent(e);\n            markChecked();\n        }\n    };\n    /**\n     * Handle globally captured focus event\n     * This can happen via a few way:\n     * User clicks on a focusable element\n     * User uses keyboard to navigate to a focusable element\n     * User goes back to the window from another browser tab\n     * User clicks on a non-focusable element\n     * User clicks on the window, outside of the document\n     */\n    const handleFocus = (e) => {\n        if (hasChecked) {\n            return;\n        }\n        // there are two way a focus gets captured on window\n        // when the windows itself got focus\n        // and when an element in the document gets focus\n        // when the window itself got focus, reacting to it is quite unnecessary\n        // as it doesn't really affect element inside the document\n        // Do a simple check and bail immediately\n        const isWindow = e.target === manager.dom.window;\n        if (isWindow) {\n            for (let i = 0, ii = checkTargets.length; ii > i; ++i) {\n                checkTargets[i].triggerBlur();\n            }\n        }\n        else {\n            handleEvent(e);\n        }\n        markChecked();\n    };\n    const handleWindowBlur = () => {\n        hasChecked = false;\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].triggerBlur();\n        }\n    };\n    const handleEvent = (e) => {\n        const target = e.composed ? e.composedPath()[0] : e.target;\n        if (target === null) {\n            return;\n        }\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].handleEventTarget(target);\n        }\n    };\n    return {\n        onpointerdown: handleMousedown,\n        ontouchstart: handleMousedown,\n        onmousedown: handleMousedown,\n        onfocus: handleFocus,\n        onblur: handleWindowBlur,\n        handleEvent(e) {\n            this[`on${e.type}`](e);\n        }\n    };\n};\n//# sourceMappingURL=blur.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { bindable, BindingMode, customAttribute, IDOM, INode } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\n/**\n * Focus attribute for element focus binding\n */\nlet Focus = class Focus {\n    constructor(element, dom) {\n        this.dom = dom;\n        /**\n         * Indicates whether `apply` should be called when `afterAttach` callback is invoked\n         */\n        this.needsApply = false;\n        this.element = element;\n    }\n    beforeBind() {\n        this.valueChanged();\n    }\n    /**\n     * Invoked everytime the bound value changes.\n     *\n     * @param newValue - The new value.\n     */\n    valueChanged() {\n        // In theory, we could/should react immediately\n        // but focus state of an element cannot be achieved\n        // while it's disconnected from the document\n        // thus, there neesd to be a check if it's currently connected or not\n        // before applying the value to the element\n        if (this.$controller.state & 32 /* isAttached */) {\n            this.apply();\n        }\n        else {\n            // If the element is not currently connect\n            // toggle the flag to add pending work for later\n            // in afterAttach lifecycle\n            this.needsApply = true;\n        }\n    }\n    /**\n     * Invoked when the attribute is afterAttach to the DOM.\n     */\n    afterAttach() {\n        if (this.needsApply) {\n            this.needsApply = false;\n            this.apply();\n        }\n        const el = this.element;\n        el.addEventListener('focus', this);\n        el.addEventListener('blur', this);\n    }\n    /**\n     * Invoked when the attribute is afterDetach from the DOM.\n     */\n    afterDetach() {\n        const el = this.element;\n        el.removeEventListener('focus', this);\n        el.removeEventListener('blur', this);\n    }\n    /**\n     * EventTarget interface handler for better memory usage\n     */\n    handleEvent(e) {\n        // there are only two event listened to\n        // if the even is focus, it menans the element is focused\n        // only need to switch the value to true\n        if (e.type === 'focus') {\n            this.value = true;\n        }\n        else if (this.dom.document.activeElement !== this.element) {\n            // else, it's blur event\n            // when a blur event happens, there are two situations\n            // 1. the element itself lost the focus\n            // 2. window lost the focus\n            // To handle both (1) and (2), only need to check if\n            // current active element is still the same element of this focus custom attribute\n            // If it's not, it's a blur event happened on Window because the browser tab lost focus\n            this.value = false;\n        }\n    }\n    /**\n     * Focus/blur based on current value\n     */\n    apply() {\n        const el = this.element;\n        if (this.value) {\n            el.focus();\n        }\n        else {\n            el.blur();\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.twoWay }),\n    __metadata(\"design:type\", Object)\n], Focus.prototype, \"value\", void 0);\nFocus = __decorate([\n    customAttribute('focus'),\n    __param(0, INode), __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], Focus);\nexport { Focus };\n//# sourceMappingURL=focus.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { nextId, } from '@aurelia/kernel';\nimport { bindable, ContinuationTask, IDOM, IRenderLocation, IViewFactory, LifecycleTask, templateController, TerminalTask, } from '@aurelia/runtime';\nimport { HTMLDOM, } from '../../dom';\nfunction toTask(maybePromiseOrTask) {\n    if (maybePromiseOrTask == null) {\n        return LifecycleTask.done;\n    }\n    if (typeof maybePromiseOrTask.then === 'function') {\n        return new TerminalTask(maybePromiseOrTask);\n    }\n    return maybePromiseOrTask;\n}\nlet Portal = class Portal {\n    constructor(factory, originalLoc, dom) {\n        this.factory = factory;\n        this.originalLoc = originalLoc;\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.strict = false;\n        this.task = LifecycleTask.done;\n        // to make the shape of this object consistent.\n        // todo: is this necessary\n        this.currentTarget = dom.createElement('div');\n        this.view = this.factory.create();\n        dom.setEffectiveParentNode(this.view.nodes, originalLoc);\n        this.view.hold(originalLoc, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        if (this.callbackContext == null) {\n            this.callbackContext = this.$controller.scope.bindingContext;\n        }\n        return this.view.bind(flags, this.$controller.scope);\n    }\n    afterAttach(flags) {\n        this.targetChanged();\n    }\n    beforeDetach(flags) {\n        this.task = this.deactivate(flags);\n    }\n    beforeUnbind(flags) {\n        this.callbackContext = null;\n        return this.view.unbind(flags);\n    }\n    targetChanged() {\n        const $controller = this.$controller;\n        if (($controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        this.project($controller.flags);\n    }\n    project(flags) {\n        const oldTarget = this.currentTarget;\n        const newTarget = this.currentTarget = this.resolveTarget();\n        if (oldTarget === newTarget) {\n            return;\n        }\n        this.task = this.deactivate(flags);\n        this.task = this.activate(newTarget, flags);\n    }\n    activate(target, flags) {\n        const { activating, activated, callbackContext, view } = this;\n        let task = this.task;\n        view.hold(target, 2 /* append */);\n        if ((this.$controller.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return task;\n        }\n        if (typeof activating === 'function') {\n            if (task.done) {\n                task = toTask(activating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.attach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.attach, view, flags);\n        }\n        if (typeof activated === 'function') {\n            if (task.done) {\n                // TODO: chain this up with RAF queue mount callback so activated is called only when\n                // node is actually mounted (is this needed as per the spec of this resource?)\n                task = toTask(activated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const { deactivating, deactivated, callbackContext, view, target: target } = this;\n        let task = this.task;\n        if (typeof deactivating === 'function') {\n            if (task.done) {\n                task = toTask(deactivating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.detach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.detach, view, flags);\n        }\n        if (typeof deactivated === 'function') {\n            if (task.done) {\n                task = toTask(deactivated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    resolveTarget() {\n        const dom = this.dom;\n        // with a $ in front to make it less confusing/error prone\n        const $document = dom.document;\n        let target = this.target;\n        let context = this.renderContext;\n        if (typeof target === 'string') {\n            let queryContext = $document;\n            if (typeof context === 'string') {\n                context = $document.querySelector(context);\n            }\n            if (dom.isNodeInstance(context)) {\n                queryContext = context;\n            }\n            target = queryContext.querySelector(target);\n        }\n        if (dom.isNodeInstance(target)) {\n            return target;\n        }\n        if (target == null) {\n            if (this.strict) {\n                throw new Error('Render target not found');\n            }\n            else {\n                target = $document.body;\n            }\n        }\n        return target;\n    }\n};\n__decorate([\n    bindable({ primary: true }),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"target\", void 0);\n__decorate([\n    bindable({ callback: 'targetChanged' }),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"renderContext\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Portal.prototype, \"strict\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"deactivating\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"activating\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"deactivated\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"activated\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"callbackContext\", void 0);\nPortal = __decorate([\n    templateController('portal'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __param(2, IDOM),\n    __metadata(\"design:paramtypes\", [Object, Object, HTMLDOM])\n], Portal);\nexport { Portal };\n//# sourceMappingURL=portal.js.map","export var HTMLTargetedInstructionType;\n(function (HTMLTargetedInstructionType) {\n    HTMLTargetedInstructionType[\"textBinding\"] = \"ha\";\n    HTMLTargetedInstructionType[\"listenerBinding\"] = \"hb\";\n    HTMLTargetedInstructionType[\"attributeBinding\"] = \"hc\";\n    HTMLTargetedInstructionType[\"stylePropertyBinding\"] = \"hd\";\n    HTMLTargetedInstructionType[\"setAttribute\"] = \"he\";\n    HTMLTargetedInstructionType[\"setClassAttribute\"] = \"hf\";\n    HTMLTargetedInstructionType[\"setStyleAttribute\"] = \"hg\";\n})(HTMLTargetedInstructionType || (HTMLTargetedInstructionType = {}));\nexport function isHTMLTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\n//# sourceMappingURL=definitions.js.map","import { DelegationStrategy } from '@aurelia/runtime';\nexport class TextBindingInstruction {\n    constructor(from) {\n        this.from = from;\n        this.type = \"ha\" /* textBinding */;\n    }\n}\nexport class TriggerBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = true;\n        this.strategy = DelegationStrategy.none;\n    }\n}\nexport class DelegateBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.bubbling;\n    }\n}\nexport class CaptureBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.capturing;\n    }\n}\nexport class StylePropertyBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hd\" /* stylePropertyBinding */;\n    }\n}\nexport class SetAttributeInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"he\" /* setAttribute */;\n    }\n}\nexport class SetClassAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hf\" /* setClassAttribute */;\n    }\n}\nexport class SetStyleAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hg\" /* setStyleAttribute */;\n    }\n}\nexport class AttributeBindingInstruction {\n    constructor(\n    /**\n     * `attr` and `to` have the same value on a normal attribute\n     * Will be different on `class` and `style`\n     * on `class`: attr = `class` (from binding command), to = attribute name\n     * on `style`: attr = `style` (from binding command), to = attribute name\n     */\n    attr, from, to) {\n        this.attr = attr;\n        this.from = from;\n        this.to = to;\n        this.type = \"hc\" /* attributeBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","import { CustomElement, HydrateElementInstruction, CustomElementDefinition, getRenderContext, } from '@aurelia/runtime';\nimport { isHTMLTargetedInstruction } from './definitions';\nimport { SetAttributeInstruction } from './instructions';\nexport function createElement(dom, tagOrType, props, children) {\n    if (typeof tagOrType === 'string') {\n        return createElementForTag(dom, tagOrType, props, children);\n    }\n    else if (CustomElement.isType(tagOrType)) {\n        return createElementForType(dom, tagOrType, props, children);\n    }\n    else {\n        throw new Error(`Invalid tagOrType.`);\n    }\n}\n/**\n * RenderPlan. Todo: describe goal of this class\n */\nexport class RenderPlan {\n    constructor(dom, node, instructions, dependencies) {\n        this.dom = dom;\n        this.node = node;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.lazyDefinition = void 0;\n    }\n    get definition() {\n        if (this.lazyDefinition === void 0) {\n            this.lazyDefinition = CustomElementDefinition.create({\n                name: CustomElement.generateName(),\n                template: this.node,\n                needsCompile: typeof this.node === 'string',\n                instructions: this.instructions,\n                dependencies: this.dependencies,\n            });\n        }\n        return this.lazyDefinition;\n    }\n    getContext(parentContainer) {\n        return getRenderContext(this.definition, parentContainer, void 0);\n    }\n    createView(parentContainer) {\n        return this.getViewFactory(parentContainer).create();\n    }\n    getViewFactory(parentContainer) {\n        return this.getContext(parentContainer).getViewFactory();\n    }\n    /** @internal */\n    mergeInto(parent, instructions, dependencies) {\n        this.dom.appendChild(parent, this.node);\n        instructions.push(...this.instructions);\n        dependencies.push(...this.dependencies);\n    }\n}\nfunction createElementForTag(dom, tagName, props, children) {\n    const instructions = [];\n    const allInstructions = [];\n    const dependencies = [];\n    const element = dom.createElement(tagName);\n    let hasInstructions = false;\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                hasInstructions = true;\n                instructions.push(value);\n            }\n            else {\n                dom.setAttribute(element, to, value);\n            }\n        });\n    }\n    if (hasInstructions) {\n        dom.makeTarget(element);\n        allInstructions.push(instructions);\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction createElementForType(dom, Type, props, children) {\n    const definition = CustomElement.getDefinition(Type);\n    const tagName = definition.name;\n    const instructions = [];\n    const allInstructions = [instructions];\n    const dependencies = [];\n    const childInstructions = [];\n    const bindables = definition.bindables;\n    const element = dom.createElement(tagName);\n    dom.makeTarget(element);\n    if (!dependencies.includes(Type)) {\n        dependencies.push(Type);\n    }\n    instructions.push(new HydrateElementInstruction(tagName, childInstructions));\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                childInstructions.push(value);\n            }\n            else {\n                const bindable = bindables[to];\n                if (bindable !== void 0) {\n                    childInstructions.push({\n                        type: \"re\" /* setProperty */,\n                        to,\n                        value\n                    });\n                }\n                else {\n                    childInstructions.push(new SetAttributeInstruction(value, to));\n                }\n            }\n        });\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction addChildren(dom, parent, children, allInstructions, dependencies) {\n    for (let i = 0, ii = children.length; i < ii; ++i) {\n        const current = children[i];\n        switch (typeof current) {\n            case 'string':\n                dom.appendChild(parent, dom.createTextNode(current));\n                break;\n            case 'object':\n                if (dom.isNodeInstance(current)) {\n                    dom.appendChild(parent, current);\n                }\n                else if ('mergeInto' in current) {\n                    current.mergeInto(parent, allInstructions, dependencies);\n                }\n        }\n    }\n}\n//# sourceMappingURL=create-element.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { nextId, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, ContinuationTask, IDOM, ITargetedInstruction, LifecycleTask, PromiseTask, CustomElementDefinition, bindable, customElement, getRenderContext, } from '@aurelia/runtime';\nimport { createElement, } from '../../create-element';\nconst bindables = ['subject', 'composing'];\nlet Compose = class Compose {\n    constructor(dom, instruction) {\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.subject = void 0;\n        this.composing = false;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.lastSubject = void 0;\n        this.properties = instruction.instructions\n            .filter((x) => !bindables.includes(x.to))\n            .reduce((acc, item) => {\n            if (item.to) {\n                acc[item.to] = item;\n            }\n            return acc;\n        }, {});\n    }\n    beforeBind(flags) {\n        if (this.task.done) {\n            this.task = this.compose(this.subject, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, this.subject, flags);\n        }\n        if (this.task.done) {\n            this.task = this.bindView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.bindView, this, flags);\n        }\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n    }\n    beforeUnbind(flags) {\n        this.lastSubject = void 0;\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        this.view = void 0;\n    }\n    subjectChanged(newValue, previousValue, flags) {\n        flags |= this.$controller.flags;\n        if (this.task.done) {\n            this.task = this.compose(newValue, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, newValue, flags);\n        }\n    }\n    compose(subject, flags) {\n        if (this.lastSubject === subject) {\n            return LifecycleTask.done;\n        }\n        this.lastSubject = subject;\n        this.composing = true;\n        let task = this.deactivate(flags);\n        if (subject instanceof Promise) {\n            let viewPromise;\n            if (task.done) {\n                viewPromise = subject.then(s => this.resolveView(s, flags));\n            }\n            else {\n                viewPromise = task.wait().then(() => subject.then(s => this.resolveView(s, flags)));\n            }\n            task = new PromiseTask(viewPromise, this.activate, this, flags);\n        }\n        else {\n            const view = this.resolveView(subject, flags);\n            if (task.done) {\n                task = this.activate(view, flags);\n            }\n            else {\n                task = new ContinuationTask(task, this.activate, this, view, flags);\n            }\n        }\n        if (task.done) {\n            this.onComposed();\n        }\n        else {\n            task = new ContinuationTask(task, this.onComposed, this);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags);\n        return view.unbind(flags);\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (5 /* isBoundOrBinding */)) > 0) {\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (40 /* isAttachedOrAttaching */)) > 0) {\n            this.view.attach(flags);\n        }\n    }\n    onComposed() {\n        this.composing = false;\n    }\n    resolveView(subject, flags) {\n        const view = this.provideViewFor(subject, flags);\n        if (view) {\n            view.hold(this.$controller.projector.host, 1 /* insertBefore */);\n            view.lockScope(this.$controller.scope);\n            return view;\n        }\n        return void 0;\n    }\n    provideViewFor(subject, flags) {\n        if (!subject) {\n            return void 0;\n        }\n        if (isController(subject)) { // IController\n            return subject;\n        }\n        if ('createView' in subject) { // RenderPlan\n            return subject.createView(this.$controller.context);\n        }\n        if ('create' in subject) { // IViewFactory\n            return subject.create(flags);\n        }\n        if ('template' in subject) { // Raw Template Definition\n            const definition = CustomElementDefinition.getOrCreate(subject);\n            return getRenderContext(definition, this.$controller.context, void 0).getViewFactory().create(flags);\n        }\n        // Constructable (Custom Element Constructor)\n        return createElement(this.dom, subject, this.properties, this.$controller.projector === void 0\n            ? PLATFORM.emptyArray\n            : this.$controller.projector.children).createView(this.$controller.context);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], Compose.prototype, \"subject\", void 0);\n__decorate([\n    bindable({ mode: BindingMode.fromView }),\n    __metadata(\"design:type\", Boolean)\n], Compose.prototype, \"composing\", void 0);\nCompose = __decorate([\n    customElement({ name: 'au-compose', template: null, containerless: true }),\n    __param(0, IDOM),\n    __param(1, ITargetedInstruction),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], Compose);\nexport { Compose };\nfunction isController(subject) {\n    return 'lockScope' in subject;\n}\n//# sourceMappingURL=compose.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { BindingMode, ensureExpression, IExpressionParser, instructionRenderer, InterpolationBinding, IObserverLocator, MultiInterpolationBinding, PropertyBinding, applyBindingBehavior, } from '@aurelia/runtime';\nimport { AttributeBinding } from './binding/attribute';\nimport { Listener } from './binding/listener';\nimport { IEventManager } from './observation/event-manager';\nlet TextBindingRenderer = \n/** @internal */\nclass TextBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const next = target.nextSibling;\n        if (context.dom.isMarker(target)) {\n            context.dom.remove(target);\n        }\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, next, 'textContent', BindingMode.toView, context), expr, context);\n        }\n        else {\n            binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, next, 'textContent', BindingMode.toView, this.observerLocator, context, true), expr, context);\n        }\n        controller.addBinding(binding);\n    }\n};\nTextBindingRenderer = __decorate([\n    instructionRenderer(\"ha\" /* textBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TextBindingRenderer);\nexport { TextBindingRenderer };\nlet ListenerBindingRenderer = \n/** @internal */\nclass ListenerBindingRenderer {\n    constructor(parser, eventManager) {\n        this.parser = parser;\n        this.eventManager = eventManager;\n    }\n    render(flags, context, controller, target, instruction) {\n        // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n        const expr = ensureExpression(this.parser, instruction.from, 80 /* IsEventCommand */ | (instruction.strategy + 6 /* DelegationStrategyDelta */));\n        const binding = applyBindingBehavior(new Listener(context.dom, instruction.to, instruction.strategy, expr, target, instruction.preventDefault, this.eventManager, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nListenerBindingRenderer = __decorate([\n    instructionRenderer(\"hb\" /* listenerBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], ListenerBindingRenderer);\nexport { ListenerBindingRenderer };\nlet SetAttributeRenderer = \n/** @internal */\nclass SetAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        target.setAttribute(instruction.to, instruction.value);\n    }\n};\nSetAttributeRenderer = __decorate([\n    instructionRenderer(\"he\" /* setAttribute */)\n    /** @internal */\n], SetAttributeRenderer);\nexport { SetAttributeRenderer };\nlet SetClassAttributeRenderer = class SetClassAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        addClasses(target.classList, instruction.value);\n    }\n};\nSetClassAttributeRenderer = __decorate([\n    instructionRenderer(\"hf\" /* setClassAttribute */)\n], SetClassAttributeRenderer);\nexport { SetClassAttributeRenderer };\nlet SetStyleAttributeRenderer = class SetStyleAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        target.style.cssText += instruction.value;\n    }\n};\nSetStyleAttributeRenderer = __decorate([\n    instructionRenderer(\"hg\" /* setStyleAttribute */)\n], SetStyleAttributeRenderer);\nexport { SetStyleAttributeRenderer };\nlet StylePropertyBindingRenderer = \n/** @internal */\nclass StylePropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, target.style, instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nStylePropertyBindingRenderer = __decorate([\n    instructionRenderer(\"hd\" /* stylePropertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], StylePropertyBindingRenderer);\nexport { StylePropertyBindingRenderer };\nlet AttributeBindingRenderer = \n/** @internal */\nclass AttributeBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = applyBindingBehavior(new AttributeBinding(expr, target, instruction.attr /* targetAttribute */, instruction.to /* targetKey */, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nAttributeBindingRenderer = __decorate([\n    instructionRenderer(\"hc\" /* attributeBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], AttributeBindingRenderer);\nexport { AttributeBindingRenderer };\n// http://jsben.ch/7n5Kt\nfunction addClasses(classList, className) {\n    const len = className.length;\n    let start = 0;\n    for (let i = 0; i < len; ++i) {\n        if (className.charCodeAt(i) === 0x20) {\n            if (i !== start) {\n                classList.add(className.slice(start, i));\n            }\n            start = i + 1;\n        }\n        else if (i + 1 === len) {\n            classList.add(className.slice(start));\n        }\n    }\n}\n//# sourceMappingURL=html-renderer.js.map","import { DI } from '@aurelia/kernel';\nimport { RuntimeConfiguration } from '@aurelia/runtime';\nimport { AttributeBindingRenderer, ListenerBindingRenderer, SetAttributeRenderer, StylePropertyBindingRenderer, TextBindingRenderer, SetClassAttributeRenderer, SetStyleAttributeRenderer } from './html-renderer';\nimport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nimport { HTMLProjectorLocator } from './projectors';\nimport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nimport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nimport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nimport { Blur } from './resources/custom-attributes/blur';\nimport { Focus } from './resources/custom-attributes/focus';\nimport { Portal } from './resources/custom-attributes/portal';\nimport { Compose } from './resources/custom-elements/compose';\nexport const IProjectorLocatorRegistration = HTMLProjectorLocator;\nexport const ITargetAccessorLocatorRegistration = TargetAccessorLocator;\nexport const ITargetObserverLocatorRegistration = TargetObserverLocator;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `IProjectorLocator`\n * - `ITargetAccessorLocator`\n * - `ITargetObserverLocator`\n * - `ITemplateFactory`\n */\nexport const DefaultComponents = [\n    IProjectorLocatorRegistration,\n    ITargetAccessorLocatorRegistration,\n    ITargetObserverLocatorRegistration,\n];\nexport const AttrBindingBehaviorRegistration = AttrBindingBehavior;\nexport const SelfBindingBehaviorRegistration = SelfBindingBehavior;\nexport const UpdateTriggerBindingBehaviorRegistration = UpdateTriggerBindingBehavior;\nexport const ComposeRegistration = Compose;\nexport const PortalRegistration = Portal;\nexport const FocusRegistration = Focus;\nexport const BlurRegistration = Blur;\n/**\n * Default HTML-specific (but environment-agnostic) resources:\n * - Binding Behaviors: `attr`, `self`, `updateTrigger`\n * - Custom Elements: `au-compose`\n * - Custom Attributes: `blur`, `focus`, `portal`\n */\nexport const DefaultResources = [\n    AttrBindingBehaviorRegistration,\n    SelfBindingBehaviorRegistration,\n    UpdateTriggerBindingBehaviorRegistration,\n    ComposeRegistration,\n    PortalRegistration,\n    FocusRegistration,\n    BlurRegistration\n];\nexport const ListenerBindingRendererRegistration = ListenerBindingRenderer;\nexport const AttributeBindingRendererRegistration = AttributeBindingRenderer;\nexport const SetAttributeRendererRegistration = SetAttributeRenderer;\nexport const SetClassAttributeRendererRegistration = SetClassAttributeRenderer;\nexport const SetStyleAttributeRendererRegistration = SetStyleAttributeRenderer;\nexport const StylePropertyBindingRendererRegistration = StylePropertyBindingRenderer;\nexport const TextBindingRendererRegistration = TextBindingRenderer;\n/**\n * Default HTML-specfic (but environment-agnostic) renderers for:\n * - Listener Bindings: `trigger`, `capture`, `delegate`\n * - SetAttribute\n * - StyleProperty: `style`, `css`\n * - TextBinding: `${}`\n */\nexport const DefaultRenderers = [\n    ListenerBindingRendererRegistration,\n    AttributeBindingRendererRegistration,\n    SetAttributeRendererRegistration,\n    SetClassAttributeRendererRegistration,\n    SetStyleAttributeRendererRegistration,\n    StylePropertyBindingRendererRegistration,\n    TextBindingRendererRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","export { Listener } from './binding/listener';\nexport { AttributeBinding } from './binding/attribute';\nexport { AttributeNSAccessor } from './observation/attribute-ns-accessor';\nexport { CheckedObserver } from './observation/checked-observer';\nexport { ClassAttributeAccessor } from './observation/class-attribute-accessor';\nexport { DataAttributeAccessor } from './observation/data-attribute-accessor';\nexport { ElementPropertyAccessor } from './observation/element-property-accessor';\nexport { ListenerTracker, DelegateOrCaptureSubscription, TriggerSubscription, IEventManager, EventSubscriber, EventManager } from './observation/event-manager';\nexport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nexport { SelectValueObserver } from './observation/select-value-observer';\nexport { StyleAttributeAccessor } from './observation/style-attribute-accessor';\nexport { ISVGAnalyzer } from './observation/svg-analyzer';\nexport { ValueAttributeObserver } from './observation/value-attribute-observer';\nexport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nexport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nexport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nexport { Blur, BlurManager } from './resources/custom-attributes/blur';\nexport { Focus } from './resources/custom-attributes/focus';\nexport { Portal } from './resources/custom-attributes/portal';\nexport { Compose } from './resources/custom-elements/compose';\nexport { IProjectorLocatorRegistration, ITargetAccessorLocatorRegistration, ITargetObserverLocatorRegistration, DefaultComponents, AttrBindingBehaviorRegistration, SelfBindingBehaviorRegistration, UpdateTriggerBindingBehaviorRegistration, ComposeRegistration, DefaultResources, AttributeBindingRendererRegistration, ListenerBindingRendererRegistration, SetAttributeRendererRegistration, SetClassAttributeRendererRegistration, SetStyleAttributeRendererRegistration, StylePropertyBindingRendererRegistration, TextBindingRendererRegistration, DefaultRenderers, RuntimeHtmlConfiguration } from './configuration';\nexport { createElement, RenderPlan } from './create-element';\nexport { HTMLTargetedInstructionType, isHTMLTargetedInstruction } from './definitions';\nexport { NodeType, HTMLDOM, DOM, FragmentNodeSequence } from './dom';\nexport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, SetAttributeInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, StylePropertyBindingInstruction, TextBindingInstruction, TriggerBindingInstruction } from './instructions';\nexport { ContainerlessProjector, HostProjector, HTMLProjectorLocator, ShadowDOMProjector } from './projectors';\nexport { StyleConfiguration, styles } from './styles/style-configuration';\nexport { CSSModulesProcessorRegistry } from './styles/css-modules-registry';\nexport { ShadowDOMRegistry } from './styles/shadow-dom-registry';\nexport { AdoptedStyleSheetsStyles, StyleElementStyles, IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\n//# sourceMappingURL=index.js.map","export class AttrSyntax {\n    constructor(rawName, rawValue, target, command) {\n        this.rawName = rawName;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.command = command;\n    }\n}\n//# sourceMappingURL=ast.js.map","import { DI, Metadata, PLATFORM, Protocol, Registration, Reporter } from '@aurelia/kernel';\n/** @internal */\nexport class CharSpec {\n    constructor(chars, repeat, isSymbol, isInverted) {\n        this.chars = chars;\n        this.repeat = repeat;\n        this.isSymbol = isSymbol;\n        this.isInverted = isInverted;\n        if (isInverted) {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNoneInverse;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingleInverse;\n                    break;\n                default:\n                    this.has = this.hasOfMultipleInverse;\n            }\n        }\n        else {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNone;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingle;\n                    break;\n                default:\n                    this.has = this.hasOfMultiple;\n            }\n        }\n    }\n    equals(other) {\n        return this.chars === other.chars\n            && this.repeat === other.repeat\n            && this.isSymbol === other.isSymbol\n            && this.isInverted === other.isInverted;\n    }\n    hasOfMultiple(char) {\n        return this.chars.includes(char);\n    }\n    hasOfSingle(char) {\n        return this.chars === char;\n    }\n    hasOfNone(char) {\n        return false;\n    }\n    hasOfMultipleInverse(char) {\n        return !this.chars.includes(char);\n    }\n    hasOfSingleInverse(char) {\n        return this.chars !== char;\n    }\n    hasOfNoneInverse(char) {\n        return true;\n    }\n}\nexport class Interpretation {\n    constructor() {\n        this.parts = PLATFORM.emptyArray;\n        this._pattern = '';\n        this.currentRecord = {};\n        this.partsRecord = {};\n    }\n    get pattern() {\n        const value = this._pattern;\n        if (value === '') {\n            return null;\n        }\n        else {\n            return value;\n        }\n    }\n    set pattern(value) {\n        if (value == null) {\n            this._pattern = '';\n            this.parts = PLATFORM.emptyArray;\n        }\n        else {\n            this._pattern = value;\n            this.parts = this.partsRecord[value];\n        }\n    }\n    append(pattern, ch) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] === undefined) {\n            currentRecord[pattern] = ch;\n        }\n        else {\n            currentRecord[pattern] += ch;\n        }\n    }\n    next(pattern) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] !== undefined) {\n            const { partsRecord } = this;\n            if (partsRecord[pattern] === undefined) {\n                partsRecord[pattern] = [currentRecord[pattern]];\n            }\n            else {\n                partsRecord[pattern].push(currentRecord[pattern]);\n            }\n            currentRecord[pattern] = undefined;\n        }\n    }\n}\n/** @internal */\nexport class State {\n    constructor(charSpec, ...patterns) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n        this.types = null;\n        this.isEndpoint = false;\n        this.patterns = patterns;\n    }\n    get pattern() {\n        return this.isEndpoint ? this.patterns[0] : null;\n    }\n    findChild(charSpec) {\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let child = null;\n        for (let i = 0; i < len; ++i) {\n            child = nextStates[i];\n            if (charSpec.equals(child.charSpec)) {\n                return child;\n            }\n        }\n        return null;\n    }\n    append(charSpec, pattern) {\n        const { patterns } = this;\n        if (!patterns.includes(pattern)) {\n            patterns.push(pattern);\n        }\n        let state = this.findChild(charSpec);\n        if (state == null) {\n            state = new State(charSpec, pattern);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n    findMatches(ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const results = [];\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let childLen = 0;\n        let child = null;\n        let i = 0;\n        let j = 0;\n        for (; i < len; ++i) {\n            child = nextStates[i];\n            if (child.charSpec.has(ch)) {\n                results.push(child);\n                childLen = child.patterns.length;\n                j = 0;\n                if (child.charSpec.isSymbol) {\n                    for (; j < childLen; ++j) {\n                        interpretation.next(child.patterns[j]);\n                    }\n                }\n                else {\n                    for (; j < childLen; ++j) {\n                        interpretation.append(child.patterns[j], ch);\n                    }\n                }\n            }\n        }\n        return results;\n    }\n}\n/** @internal */\nexport class StaticSegment {\n    constructor(text) {\n        this.text = text;\n        this.text = text;\n        const len = this.len = text.length;\n        const specs = this.specs = [];\n        for (let i = 0; i < len; ++i) {\n            specs.push(new CharSpec(text[i], false, false, false));\n        }\n    }\n    eachChar(callback) {\n        const { len, specs } = this;\n        for (let i = 0; i < len; ++i) {\n            callback(specs[i]);\n        }\n    }\n}\n/** @internal */\nexport class DynamicSegment {\n    constructor(symbols) {\n        this.text = 'PART';\n        this.spec = new CharSpec(symbols, true, false, true);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SymbolSegment {\n    constructor(text) {\n        this.text = text;\n        this.spec = new CharSpec(text, false, true, false);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SegmentTypes {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.symbols = 0;\n    }\n}\nexport const ISyntaxInterpreter = DI.createInterface('ISyntaxInterpreter').withDefault(x => x.singleton(SyntaxInterpreter));\n/** @internal */\nexport class SyntaxInterpreter {\n    constructor() {\n        this.rootState = new State(null);\n        this.initialStates = [this.rootState];\n    }\n    add(defOrDefs) {\n        let i = 0;\n        if (Array.isArray(defOrDefs)) {\n            const ii = defOrDefs.length;\n            for (; i < ii; ++i) {\n                this.add(defOrDefs[i]);\n            }\n            return;\n        }\n        let currentState = this.rootState;\n        const def = defOrDefs;\n        const pattern = def.pattern;\n        const types = new SegmentTypes();\n        const segments = this.parse(def, types);\n        const len = segments.length;\n        const callback = (ch) => {\n            currentState = currentState.append(ch, pattern);\n        };\n        for (i = 0; i < len; ++i) {\n            segments[i].eachChar(callback);\n        }\n        currentState.types = types;\n        currentState.isEndpoint = true;\n    }\n    interpret(name) {\n        const interpretation = new Interpretation();\n        let states = this.initialStates;\n        const len = name.length;\n        for (let i = 0; i < len; ++i) {\n            states = this.getNextStates(states, name.charAt(i), interpretation);\n            if (states.length === 0) {\n                break;\n            }\n        }\n        states.sort((a, b) => {\n            if (a.isEndpoint) {\n                if (!b.isEndpoint) {\n                    return -1;\n                }\n            }\n            else if (b.isEndpoint) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n            const aTypes = a.types;\n            const bTypes = b.types;\n            if (aTypes.statics !== bTypes.statics) {\n                return bTypes.statics - aTypes.statics;\n            }\n            if (aTypes.dynamics !== bTypes.dynamics) {\n                return bTypes.dynamics - aTypes.dynamics;\n            }\n            if (aTypes.symbols !== bTypes.symbols) {\n                return bTypes.symbols - aTypes.symbols;\n            }\n            return 0;\n        });\n        if (states.length > 0) {\n            const state = states[0];\n            if (!state.charSpec.isSymbol) {\n                interpretation.next(state.pattern);\n            }\n            interpretation.pattern = state.pattern;\n        }\n        return interpretation;\n    }\n    getNextStates(states, ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const nextStates = [];\n        let state = null;\n        const len = states.length;\n        for (let i = 0; i < len; ++i) {\n            state = states[i];\n            nextStates.push(...state.findMatches(ch, interpretation));\n        }\n        return nextStates;\n    }\n    parse(def, types) {\n        const result = [];\n        const pattern = def.pattern;\n        const len = pattern.length;\n        let i = 0;\n        let start = 0;\n        let c = '';\n        while (i < len) {\n            c = pattern.charAt(i);\n            if (!def.symbols.includes(c)) {\n                if (i === start) {\n                    if (c === 'P' && pattern.slice(i, i + 4) === 'PART') {\n                        start = i = (i + 4);\n                        result.push(new DynamicSegment(def.symbols));\n                        ++types.dynamics;\n                    }\n                    else {\n                        ++i;\n                    }\n                }\n                else {\n                    ++i;\n                }\n            }\n            else if (i !== start) {\n                result.push(new StaticSegment(pattern.slice(start, i)));\n                ++types.statics;\n                start = i;\n            }\n            else {\n                result.push(new SymbolSegment(pattern.slice(start, i + 1)));\n                ++types.symbols;\n                start = ++i;\n            }\n        }\n        if (start !== i) {\n            result.push(new StaticSegment(pattern.slice(start, i)));\n            ++types.statics;\n        }\n        return result;\n    }\n}\nfunction validatePrototype(handler, patternDefs) {\n    for (const def of patternDefs) {\n        // note: we're intentionally not throwing here\n        if (!(def.pattern in handler)) {\n            Reporter.write(401, def.pattern); // TODO: organize error codes\n        }\n        else if (typeof handler[def.pattern] !== 'function') {\n            Reporter.write(402, def.pattern); // TODO: organize error codes\n        }\n    }\n}\nexport const IAttributePattern = DI.createInterface('IAttributePattern').noDefault();\nexport function attributePattern(...patternDefs) {\n    return function decorator(target) {\n        return AttributePattern.define(patternDefs, target);\n    };\n}\nexport class AttributePatternResourceDefinition {\n    constructor(Type) {\n        this.Type = Type;\n        this.name = (void 0);\n    }\n    register(container) {\n        Registration.singleton(IAttributePattern, this.Type).register(container);\n    }\n}\nexport const AttributePattern = Object.freeze({\n    name: Protocol.resource.keyFor('attribute-pattern'),\n    definitionAnnotationKey: 'attribute-pattern-definitions',\n    define(patternDefs, Type) {\n        validatePrototype(Type.prototype, patternDefs);\n        const definition = new AttributePatternResourceDefinition(Type);\n        const { name, definitionAnnotationKey } = AttributePattern;\n        Metadata.define(name, definition, Type);\n        Protocol.resource.appendTo(Type, name);\n        Protocol.annotation.set(Type, definitionAnnotationKey, patternDefs);\n        Protocol.annotation.appendTo(Type, definitionAnnotationKey);\n        return Type;\n    },\n    getPatternDefinitions(Type) {\n        return Protocol.annotation.get(Type, AttributePattern.definitionAnnotationKey);\n    }\n});\n//# sourceMappingURL=attribute-pattern.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { all, DI } from '@aurelia/kernel';\nimport { AttrSyntax } from './ast';\nimport { AttributePattern, IAttributePattern, ISyntaxInterpreter } from './attribute-pattern';\nexport const IAttributeParser = DI.createInterface('IAttributeParser').withDefault(x => x.singleton(AttributeParser));\n/** @internal */\nlet AttributeParser = class AttributeParser {\n    constructor(interpreter, attrPatterns) {\n        this.interpreter = interpreter;\n        this.cache = {};\n        this.interpreter = interpreter;\n        const patterns = this.patterns = {};\n        attrPatterns.forEach(attrPattern => {\n            const defs = AttributePattern.getPatternDefinitions(attrPattern.constructor);\n            interpreter.add(defs);\n            defs.forEach(def => {\n                patterns[def.pattern] = attrPattern;\n            });\n        });\n    }\n    parse(name, value) {\n        let interpretation = this.cache[name];\n        if (interpretation == null) {\n            interpretation = this.cache[name] = this.interpreter.interpret(name);\n        }\n        const pattern = interpretation.pattern;\n        if (pattern == null) {\n            return new AttrSyntax(name, value, name, null);\n        }\n        else {\n            return this.patterns[pattern][pattern](name, value, interpretation.parts);\n        }\n    }\n};\nAttributeParser = __decorate([\n    __param(0, ISyntaxInterpreter),\n    __param(1, all(IAttributePattern)),\n    __metadata(\"design:paramtypes\", [Object, Array])\n], AttributeParser);\nexport { AttributeParser };\n//# sourceMappingURL=attribute-parser.js.map","import { __decorate } from \"tslib\";\nimport { AttrSyntax } from './ast';\nimport { attributePattern } from './attribute-pattern';\nlet DotSeparatedAttributePattern = class DotSeparatedAttributePattern {\n    ['PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[1]);\n    }\n    ['PART.PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[2]);\n    }\n};\nDotSeparatedAttributePattern = __decorate([\n    attributePattern({ pattern: 'PART.PART', symbols: '.' }, { pattern: 'PART.PART.PART', symbols: '.' })\n], DotSeparatedAttributePattern);\nexport { DotSeparatedAttributePattern };\nlet RefAttributePattern = class RefAttributePattern {\n    ['ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, 'element', 'ref');\n    }\n    ['PART.ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'ref');\n    }\n};\nRefAttributePattern = __decorate([\n    attributePattern({ pattern: 'ref', symbols: '' }, { pattern: 'PART.ref', symbols: '.' })\n], RefAttributePattern);\nexport { RefAttributePattern };\nlet ColonPrefixedBindAttributePattern = class ColonPrefixedBindAttributePattern {\n    [':PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'bind');\n    }\n};\nColonPrefixedBindAttributePattern = __decorate([\n    attributePattern({ pattern: ':PART', symbols: ':' })\n], ColonPrefixedBindAttributePattern);\nexport { ColonPrefixedBindAttributePattern };\nlet AtPrefixedTriggerAttributePattern = class AtPrefixedTriggerAttributePattern {\n    ['@PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'trigger');\n    }\n};\nAtPrefixedTriggerAttributePattern = __decorate([\n    attributePattern({ pattern: '@PART', symbols: '@' })\n], AtPrefixedTriggerAttributePattern);\nexport { AtPrefixedTriggerAttributePattern };\n//# sourceMappingURL=attribute-patterns.js.map","import { camelCase, Registration, mergeArrays, Protocol, firstDefined, Metadata } from '@aurelia/kernel';\nimport { registerAliases } from '@aurelia/runtime';\nexport function bindingCommand(nameOrDefinition) {\n    return function (target) {\n        return BindingCommand.define(nameOrDefinition, target);\n    };\n}\nexport class BindingCommandDefinition {\n    constructor(Type, name, aliases, key, type) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.type = type;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new BindingCommandDefinition(Type, firstDefined(BindingCommand.getAnnotation(Type, 'name'), name), mergeArrays(BindingCommand.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingCommand.keyFrom(name), firstDefined(BindingCommand.getAnnotation(Type, 'type'), def.type, Type.type, null));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.alias(key, Type).register(container);\n        registerAliases(aliases, BindingCommand, key, container);\n    }\n}\nexport const BindingCommand = {\n    name: Protocol.resource.keyFor('binding-command'),\n    keyFrom(name) {\n        return `${BindingCommand.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingCommand.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingCommandDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingCommand.name, definition, definition.Type);\n        Metadata.define(BindingCommand.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingCommand.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingCommand.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\nexport function getTarget(binding, makeCamelCase) {\n    if (binding.flags & 256 /* isBinding */) {\n        return binding.bindable.propName;\n    }\n    else if (makeCamelCase) {\n        return camelCase(binding.syntax.target);\n    }\n    else {\n        return binding.syntax.target;\n    }\n}\n//# sourceMappingURL=binding-command.js.map","export var SymbolFlags;\n(function (SymbolFlags) {\n    SymbolFlags[SymbolFlags[\"type\"] = 511] = \"type\";\n    SymbolFlags[SymbolFlags[\"isTemplateController\"] = 1] = \"isTemplateController\";\n    SymbolFlags[SymbolFlags[\"isReplacePart\"] = 2] = \"isReplacePart\";\n    SymbolFlags[SymbolFlags[\"isCustomAttribute\"] = 4] = \"isCustomAttribute\";\n    SymbolFlags[SymbolFlags[\"isPlainAttribute\"] = 8] = \"isPlainAttribute\";\n    SymbolFlags[SymbolFlags[\"isCustomElement\"] = 16] = \"isCustomElement\";\n    SymbolFlags[SymbolFlags[\"isLetElement\"] = 32] = \"isLetElement\";\n    SymbolFlags[SymbolFlags[\"isPlainElement\"] = 64] = \"isPlainElement\";\n    SymbolFlags[SymbolFlags[\"isText\"] = 128] = \"isText\";\n    SymbolFlags[SymbolFlags[\"isBinding\"] = 256] = \"isBinding\";\n    SymbolFlags[SymbolFlags[\"hasMarker\"] = 512] = \"hasMarker\";\n    SymbolFlags[SymbolFlags[\"hasTemplate\"] = 1024] = \"hasTemplate\";\n    SymbolFlags[SymbolFlags[\"hasAttributes\"] = 2048] = \"hasAttributes\";\n    SymbolFlags[SymbolFlags[\"hasBindings\"] = 4096] = \"hasBindings\";\n    SymbolFlags[SymbolFlags[\"hasChildNodes\"] = 8192] = \"hasChildNodes\";\n    SymbolFlags[SymbolFlags[\"hasParts\"] = 16384] = \"hasParts\";\n})(SymbolFlags || (SymbolFlags = {}));\nfunction createMarker(dom) {\n    const marker = dom.createElement('au-m');\n    dom.makeTarget(marker);\n    return marker;\n}\n/**\n * A html attribute that is associated with a registered resource, specifically a template controller.\n */\nexport class TemplateControllerSymbol {\n    constructor(dom, syntax, info, partName, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 1 /* isTemplateController */ | 512 /* hasMarker */;\n        this.physicalNode = null;\n        this.template = null;\n        this.templateController = null;\n        this._bindings = null;\n        this._parts = null;\n        this.partName = info.name === 'replaceable' ? partName : null;\n        this.marker = createMarker(dom);\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\n/**\n * Wrapper for an element (with all of its attributes, regardless of the order in which they are declared)\n * that has a replace attribute on it.\n *\n * This element will be lifted from the DOM just like a template controller.\n */\nexport class ReplacePartSymbol {\n    constructor(name, physicalNode = null, parent = null, template = null) {\n        this.name = name;\n        this.physicalNode = physicalNode;\n        this.parent = parent;\n        this.template = template;\n        this.flags = 2 /* isReplacePart */;\n    }\n}\n/**\n * A html attribute that is associated with a registered resource, but not a template controller.\n */\nexport class CustomAttributeSymbol {\n    constructor(syntax, info, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 4 /* isCustomAttribute */;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * An attribute, with either a binding command or an interpolation, whose target is the html\n * attribute of the element.\n *\n * This will never target a bindable property of a custom attribute or element;\n */\nexport class PlainAttributeSymbol {\n    constructor(syntax, command, expression) {\n        this.syntax = syntax;\n        this.command = command;\n        this.expression = expression;\n        this.flags = 8 /* isPlainAttribute */;\n    }\n}\n/**\n * Either an attribute on an custom element that maps to a declared bindable property of that element,\n * a single-value bound custom attribute, or one of several bindables that were extracted from the attribute\n * value of a custom attribute with multiple bindings usage.\n *\n * This will always target a bindable property of a custom attribute or element;\n */\nexport class BindingSymbol {\n    constructor(command, bindable, expression, rawValue, target) {\n        this.command = command;\n        this.bindable = bindable;\n        this.expression = expression;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.flags = 256 /* isBinding */;\n    }\n}\n/**\n * A html element that is associated with a registered resource either via its (lowerCase) `nodeName`\n * or the value of its `as-element` attribute.\n */\nexport class CustomElementSymbol {\n    constructor(dom, physicalNode, info, res = info.name, bindables = info.bindables) {\n        this.physicalNode = physicalNode;\n        this.info = info;\n        this.res = res;\n        this.bindables = bindables;\n        this.flags = 16 /* isCustomElement */;\n        this.isTarget = true;\n        this.templateController = null;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._bindings = null;\n        this._childNodes = null;\n        this._parts = null;\n        if (info.containerless) {\n            this.isContainerless = true;\n            this.marker = createMarker(dom);\n            this.flags |= 512 /* hasMarker */;\n        }\n        else {\n            this.isContainerless = false;\n            this.marker = null;\n        }\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\nexport class LetElementSymbol {\n    constructor(dom, physicalNode, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.marker = marker;\n        this.flags = 32 /* isLetElement */ | 512 /* hasMarker */;\n        this.toBindingContext = false;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * A normal html element that may or may not have attribute behaviors and/or child node behaviors.\n *\n * It is possible for a PlainElementSymbol to not yield any instructions during compilation.\n */\nexport class PlainElementSymbol {\n    constructor(dom, physicalNode) {\n        this.physicalNode = physicalNode;\n        this.flags = 64 /* isPlainElement */;\n        this.isTarget = false;\n        this.templateController = null;\n        this.hasSlots = false;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._childNodes = null;\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n}\n/**\n * A standalone text node that has an interpolation.\n */\nexport class TextSymbol {\n    constructor(dom, physicalNode, interpolation, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.interpolation = interpolation;\n        this.marker = marker;\n        this.flags = 128 /* isText */ | 512 /* hasMarker */;\n    }\n}\n//# sourceMappingURL=semantic-model.js.map","import { __decorate } from \"tslib\";\nimport { BindingMode, CallBindingInstruction, FromViewBindingInstruction, IteratorBindingInstruction, OneTimeBindingInstruction, ToViewBindingInstruction, TwoWayBindingInstruction, } from '@aurelia/runtime';\nimport { bindingCommand, getTarget, } from './binding-command';\nimport { BindingSymbol, } from './semantic-model';\nlet OneTimeBindingCommand = class OneTimeBindingCommand {\n    constructor() {\n        this.bindingType = 49 /* OneTimeCommand */;\n    }\n    compile(binding) {\n        return new OneTimeBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nOneTimeBindingCommand = __decorate([\n    bindingCommand('one-time')\n], OneTimeBindingCommand);\nexport { OneTimeBindingCommand };\nlet ToViewBindingCommand = class ToViewBindingCommand {\n    constructor() {\n        this.bindingType = 50 /* ToViewCommand */;\n    }\n    compile(binding) {\n        return new ToViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nToViewBindingCommand = __decorate([\n    bindingCommand('to-view')\n], ToViewBindingCommand);\nexport { ToViewBindingCommand };\nlet FromViewBindingCommand = class FromViewBindingCommand {\n    constructor() {\n        this.bindingType = 51 /* FromViewCommand */;\n    }\n    compile(binding) {\n        return new FromViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nFromViewBindingCommand = __decorate([\n    bindingCommand('from-view')\n], FromViewBindingCommand);\nexport { FromViewBindingCommand };\nlet TwoWayBindingCommand = class TwoWayBindingCommand {\n    constructor() {\n        this.bindingType = 52 /* TwoWayCommand */;\n    }\n    compile(binding) {\n        return new TwoWayBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTwoWayBindingCommand = __decorate([\n    bindingCommand('two-way')\n], TwoWayBindingCommand);\nexport { TwoWayBindingCommand };\nlet DefaultBindingCommand = class DefaultBindingCommand {\n    constructor() {\n        this.bindingType = 53 /* BindCommand */;\n    }\n    compile(binding) {\n        let mode = BindingMode.default;\n        if (binding instanceof BindingSymbol) {\n            mode = binding.bindable.mode;\n        }\n        else {\n            const command = binding.syntax.command;\n            switch (command) {\n                case 'bind':\n                case 'to-view':\n                    mode = BindingMode.toView;\n                    break;\n                case 'one-time':\n                    mode = BindingMode.oneTime;\n                    break;\n                case 'from-view':\n                    mode = BindingMode.fromView;\n                    break;\n                case 'two-way':\n                    mode = BindingMode.twoWay;\n                    break;\n            }\n        }\n        switch (mode) {\n            case BindingMode.default:\n            case BindingMode.toView:\n                return ToViewBindingCommand.prototype.compile(binding);\n            case BindingMode.oneTime:\n                return OneTimeBindingCommand.prototype.compile(binding);\n            case BindingMode.fromView:\n                return FromViewBindingCommand.prototype.compile(binding);\n            case BindingMode.twoWay:\n                return TwoWayBindingCommand.prototype.compile(binding);\n        }\n    }\n};\nDefaultBindingCommand = __decorate([\n    bindingCommand('bind')\n], DefaultBindingCommand);\nexport { DefaultBindingCommand };\nlet CallBindingCommand = class CallBindingCommand {\n    constructor() {\n        this.bindingType = 153 /* CallCommand */;\n    }\n    compile(binding) {\n        return new CallBindingInstruction(binding.expression, getTarget(binding, true));\n    }\n};\nCallBindingCommand = __decorate([\n    bindingCommand('call')\n], CallBindingCommand);\nexport { CallBindingCommand };\nlet ForBindingCommand = class ForBindingCommand {\n    constructor() {\n        this.bindingType = 539 /* ForCommand */;\n    }\n    compile(binding) {\n        return new IteratorBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nForBindingCommand = __decorate([\n    bindingCommand('for')\n], ForBindingCommand);\nexport { ForBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","export function unescapeCode(code) {\n    switch (code) {\n        case 98 /* LowerB */: return 8 /* Backspace */;\n        case 116 /* LowerT */: return 9 /* Tab */;\n        case 110 /* LowerN */: return 10 /* LineFeed */;\n        case 118 /* LowerV */: return 11 /* VerticalTab */;\n        case 102 /* LowerF */: return 12 /* FormFeed */;\n        case 114 /* LowerR */: return 13 /* CarriageReturn */;\n        case 34 /* DoubleQuote */: return 34 /* DoubleQuote */;\n        case 39 /* SingleQuote */: return 39 /* SingleQuote */;\n        case 92 /* Backslash */: return 92 /* Backslash */;\n        default: return code;\n    }\n}\nexport var Access;\n(function (Access) {\n    Access[Access[\"Reset\"] = 0] = \"Reset\";\n    Access[Access[\"Ancestor\"] = 511] = \"Ancestor\";\n    Access[Access[\"This\"] = 512] = \"This\";\n    Access[Access[\"Scope\"] = 1024] = \"Scope\";\n    Access[Access[\"Member\"] = 2048] = \"Member\";\n    Access[Access[\"Keyed\"] = 4096] = \"Keyed\";\n})(Access || (Access = {}));\nexport var Precedence;\n(function (Precedence) {\n    Precedence[Precedence[\"Variadic\"] = 61] = \"Variadic\";\n    Precedence[Precedence[\"Assign\"] = 62] = \"Assign\";\n    Precedence[Precedence[\"Conditional\"] = 63] = \"Conditional\";\n    Precedence[Precedence[\"LogicalOR\"] = 64] = \"LogicalOR\";\n    Precedence[Precedence[\"LogicalAND\"] = 128] = \"LogicalAND\";\n    Precedence[Precedence[\"Equality\"] = 192] = \"Equality\";\n    Precedence[Precedence[\"Relational\"] = 256] = \"Relational\";\n    Precedence[Precedence[\"Additive\"] = 320] = \"Additive\";\n    Precedence[Precedence[\"Multiplicative\"] = 384] = \"Multiplicative\";\n    Precedence[Precedence[\"Binary\"] = 448] = \"Binary\";\n    Precedence[Precedence[\"LeftHandSide\"] = 449] = \"LeftHandSide\";\n    Precedence[Precedence[\"Primary\"] = 450] = \"Primary\";\n    Precedence[Precedence[\"Unary\"] = 451] = \"Unary\";\n})(Precedence || (Precedence = {}));\n/** @internal */\nexport var Token;\n(function (Token) {\n    Token[Token[\"EOF\"] = 1572864] = \"EOF\";\n    Token[Token[\"ExpressionTerminal\"] = 1048576] = \"ExpressionTerminal\";\n    Token[Token[\"AccessScopeTerminal\"] = 524288] = \"AccessScopeTerminal\";\n    Token[Token[\"ClosingToken\"] = 262144] = \"ClosingToken\";\n    Token[Token[\"OpeningToken\"] = 131072] = \"OpeningToken\";\n    Token[Token[\"BinaryOp\"] = 65536] = \"BinaryOp\";\n    Token[Token[\"UnaryOp\"] = 32768] = \"UnaryOp\";\n    Token[Token[\"LeftHandSide\"] = 16384] = \"LeftHandSide\";\n    Token[Token[\"StringOrNumericLiteral\"] = 12288] = \"StringOrNumericLiteral\";\n    Token[Token[\"NumericLiteral\"] = 8192] = \"NumericLiteral\";\n    Token[Token[\"StringLiteral\"] = 4096] = \"StringLiteral\";\n    Token[Token[\"IdentifierName\"] = 3072] = \"IdentifierName\";\n    Token[Token[\"Keyword\"] = 2048] = \"Keyword\";\n    Token[Token[\"Identifier\"] = 1024] = \"Identifier\";\n    Token[Token[\"Contextual\"] = 512] = \"Contextual\";\n    Token[Token[\"Precedence\"] = 448] = \"Precedence\";\n    Token[Token[\"Type\"] = 63] = \"Type\";\n    Token[Token[\"FalseKeyword\"] = 2048] = \"FalseKeyword\";\n    Token[Token[\"TrueKeyword\"] = 2049] = \"TrueKeyword\";\n    Token[Token[\"NullKeyword\"] = 2050] = \"NullKeyword\";\n    Token[Token[\"UndefinedKeyword\"] = 2051] = \"UndefinedKeyword\";\n    Token[Token[\"ThisScope\"] = 3076] = \"ThisScope\";\n    Token[Token[\"ParentScope\"] = 3077] = \"ParentScope\";\n    Token[Token[\"OpenParen\"] = 671750] = \"OpenParen\";\n    Token[Token[\"OpenBrace\"] = 131079] = \"OpenBrace\";\n    Token[Token[\"Dot\"] = 16392] = \"Dot\";\n    Token[Token[\"CloseBrace\"] = 1835017] = \"CloseBrace\";\n    Token[Token[\"CloseParen\"] = 1835018] = \"CloseParen\";\n    Token[Token[\"Comma\"] = 1572875] = \"Comma\";\n    Token[Token[\"OpenBracket\"] = 671756] = \"OpenBracket\";\n    Token[Token[\"CloseBracket\"] = 1835021] = \"CloseBracket\";\n    Token[Token[\"Colon\"] = 1572878] = \"Colon\";\n    Token[Token[\"Question\"] = 1572879] = \"Question\";\n    Token[Token[\"Ampersand\"] = 1572880] = \"Ampersand\";\n    Token[Token[\"Bar\"] = 1572883] = \"Bar\";\n    Token[Token[\"BarBar\"] = 1638548] = \"BarBar\";\n    Token[Token[\"AmpersandAmpersand\"] = 1638613] = \"AmpersandAmpersand\";\n    Token[Token[\"EqualsEquals\"] = 1638678] = \"EqualsEquals\";\n    Token[Token[\"ExclamationEquals\"] = 1638679] = \"ExclamationEquals\";\n    Token[Token[\"EqualsEqualsEquals\"] = 1638680] = \"EqualsEqualsEquals\";\n    Token[Token[\"ExclamationEqualsEquals\"] = 1638681] = \"ExclamationEqualsEquals\";\n    Token[Token[\"LessThan\"] = 1638746] = \"LessThan\";\n    Token[Token[\"GreaterThan\"] = 1638747] = \"GreaterThan\";\n    Token[Token[\"LessThanEquals\"] = 1638748] = \"LessThanEquals\";\n    Token[Token[\"GreaterThanEquals\"] = 1638749] = \"GreaterThanEquals\";\n    Token[Token[\"InKeyword\"] = 1640798] = \"InKeyword\";\n    Token[Token[\"InstanceOfKeyword\"] = 1640799] = \"InstanceOfKeyword\";\n    Token[Token[\"Plus\"] = 623008] = \"Plus\";\n    Token[Token[\"Minus\"] = 623009] = \"Minus\";\n    Token[Token[\"TypeofKeyword\"] = 34850] = \"TypeofKeyword\";\n    Token[Token[\"VoidKeyword\"] = 34851] = \"VoidKeyword\";\n    Token[Token[\"Asterisk\"] = 1638884] = \"Asterisk\";\n    Token[Token[\"Percent\"] = 1638885] = \"Percent\";\n    Token[Token[\"Slash\"] = 1638886] = \"Slash\";\n    Token[Token[\"Equals\"] = 1048615] = \"Equals\";\n    Token[Token[\"Exclamation\"] = 32808] = \"Exclamation\";\n    Token[Token[\"TemplateTail\"] = 540713] = \"TemplateTail\";\n    Token[Token[\"TemplateContinuation\"] = 540714] = \"TemplateContinuation\";\n    Token[Token[\"OfKeyword\"] = 1051179] = \"OfKeyword\";\n})(Token || (Token = {}));\nexport var Char;\n(function (Char) {\n    Char[Char[\"Null\"] = 0] = \"Null\";\n    Char[Char[\"Backspace\"] = 8] = \"Backspace\";\n    Char[Char[\"Tab\"] = 9] = \"Tab\";\n    Char[Char[\"LineFeed\"] = 10] = \"LineFeed\";\n    Char[Char[\"VerticalTab\"] = 11] = \"VerticalTab\";\n    Char[Char[\"FormFeed\"] = 12] = \"FormFeed\";\n    Char[Char[\"CarriageReturn\"] = 13] = \"CarriageReturn\";\n    Char[Char[\"Space\"] = 32] = \"Space\";\n    Char[Char[\"Exclamation\"] = 33] = \"Exclamation\";\n    Char[Char[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    Char[Char[\"Dollar\"] = 36] = \"Dollar\";\n    Char[Char[\"Percent\"] = 37] = \"Percent\";\n    Char[Char[\"Ampersand\"] = 38] = \"Ampersand\";\n    Char[Char[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    Char[Char[\"OpenParen\"] = 40] = \"OpenParen\";\n    Char[Char[\"CloseParen\"] = 41] = \"CloseParen\";\n    Char[Char[\"Asterisk\"] = 42] = \"Asterisk\";\n    Char[Char[\"Plus\"] = 43] = \"Plus\";\n    Char[Char[\"Comma\"] = 44] = \"Comma\";\n    Char[Char[\"Minus\"] = 45] = \"Minus\";\n    Char[Char[\"Dot\"] = 46] = \"Dot\";\n    Char[Char[\"Slash\"] = 47] = \"Slash\";\n    Char[Char[\"Semicolon\"] = 59] = \"Semicolon\";\n    Char[Char[\"Backtick\"] = 96] = \"Backtick\";\n    Char[Char[\"OpenBracket\"] = 91] = \"OpenBracket\";\n    Char[Char[\"Backslash\"] = 92] = \"Backslash\";\n    Char[Char[\"CloseBracket\"] = 93] = \"CloseBracket\";\n    Char[Char[\"Caret\"] = 94] = \"Caret\";\n    Char[Char[\"Underscore\"] = 95] = \"Underscore\";\n    Char[Char[\"OpenBrace\"] = 123] = \"OpenBrace\";\n    Char[Char[\"Bar\"] = 124] = \"Bar\";\n    Char[Char[\"CloseBrace\"] = 125] = \"CloseBrace\";\n    Char[Char[\"Colon\"] = 58] = \"Colon\";\n    Char[Char[\"LessThan\"] = 60] = \"LessThan\";\n    Char[Char[\"Equals\"] = 61] = \"Equals\";\n    Char[Char[\"GreaterThan\"] = 62] = \"GreaterThan\";\n    Char[Char[\"Question\"] = 63] = \"Question\";\n    Char[Char[\"Zero\"] = 48] = \"Zero\";\n    Char[Char[\"One\"] = 49] = \"One\";\n    Char[Char[\"Two\"] = 50] = \"Two\";\n    Char[Char[\"Three\"] = 51] = \"Three\";\n    Char[Char[\"Four\"] = 52] = \"Four\";\n    Char[Char[\"Five\"] = 53] = \"Five\";\n    Char[Char[\"Six\"] = 54] = \"Six\";\n    Char[Char[\"Seven\"] = 55] = \"Seven\";\n    Char[Char[\"Eight\"] = 56] = \"Eight\";\n    Char[Char[\"Nine\"] = 57] = \"Nine\";\n    Char[Char[\"UpperA\"] = 65] = \"UpperA\";\n    Char[Char[\"UpperB\"] = 66] = \"UpperB\";\n    Char[Char[\"UpperC\"] = 67] = \"UpperC\";\n    Char[Char[\"UpperD\"] = 68] = \"UpperD\";\n    Char[Char[\"UpperE\"] = 69] = \"UpperE\";\n    Char[Char[\"UpperF\"] = 70] = \"UpperF\";\n    Char[Char[\"UpperG\"] = 71] = \"UpperG\";\n    Char[Char[\"UpperH\"] = 72] = \"UpperH\";\n    Char[Char[\"UpperI\"] = 73] = \"UpperI\";\n    Char[Char[\"UpperJ\"] = 74] = \"UpperJ\";\n    Char[Char[\"UpperK\"] = 75] = \"UpperK\";\n    Char[Char[\"UpperL\"] = 76] = \"UpperL\";\n    Char[Char[\"UpperM\"] = 77] = \"UpperM\";\n    Char[Char[\"UpperN\"] = 78] = \"UpperN\";\n    Char[Char[\"UpperO\"] = 79] = \"UpperO\";\n    Char[Char[\"UpperP\"] = 80] = \"UpperP\";\n    Char[Char[\"UpperQ\"] = 81] = \"UpperQ\";\n    Char[Char[\"UpperR\"] = 82] = \"UpperR\";\n    Char[Char[\"UpperS\"] = 83] = \"UpperS\";\n    Char[Char[\"UpperT\"] = 84] = \"UpperT\";\n    Char[Char[\"UpperU\"] = 85] = \"UpperU\";\n    Char[Char[\"UpperV\"] = 86] = \"UpperV\";\n    Char[Char[\"UpperW\"] = 87] = \"UpperW\";\n    Char[Char[\"UpperX\"] = 88] = \"UpperX\";\n    Char[Char[\"UpperY\"] = 89] = \"UpperY\";\n    Char[Char[\"UpperZ\"] = 90] = \"UpperZ\";\n    Char[Char[\"LowerA\"] = 97] = \"LowerA\";\n    Char[Char[\"LowerB\"] = 98] = \"LowerB\";\n    Char[Char[\"LowerC\"] = 99] = \"LowerC\";\n    Char[Char[\"LowerD\"] = 100] = \"LowerD\";\n    Char[Char[\"LowerE\"] = 101] = \"LowerE\";\n    Char[Char[\"LowerF\"] = 102] = \"LowerF\";\n    Char[Char[\"LowerG\"] = 103] = \"LowerG\";\n    Char[Char[\"LowerH\"] = 104] = \"LowerH\";\n    Char[Char[\"LowerI\"] = 105] = \"LowerI\";\n    Char[Char[\"LowerJ\"] = 106] = \"LowerJ\";\n    Char[Char[\"LowerK\"] = 107] = \"LowerK\";\n    Char[Char[\"LowerL\"] = 108] = \"LowerL\";\n    Char[Char[\"LowerM\"] = 109] = \"LowerM\";\n    Char[Char[\"LowerN\"] = 110] = \"LowerN\";\n    Char[Char[\"LowerO\"] = 111] = \"LowerO\";\n    Char[Char[\"LowerP\"] = 112] = \"LowerP\";\n    Char[Char[\"LowerQ\"] = 113] = \"LowerQ\";\n    Char[Char[\"LowerR\"] = 114] = \"LowerR\";\n    Char[Char[\"LowerS\"] = 115] = \"LowerS\";\n    Char[Char[\"LowerT\"] = 116] = \"LowerT\";\n    Char[Char[\"LowerU\"] = 117] = \"LowerU\";\n    Char[Char[\"LowerV\"] = 118] = \"LowerV\";\n    Char[Char[\"LowerW\"] = 119] = \"LowerW\";\n    Char[Char[\"LowerX\"] = 120] = \"LowerX\";\n    Char[Char[\"LowerY\"] = 121] = \"LowerY\";\n    Char[Char[\"LowerZ\"] = 122] = \"LowerZ\";\n})(Char || (Char = {}));\n//# sourceMappingURL=common.js.map","import { Reporter } from '@aurelia/kernel';\nimport { AccessKeyedExpression, AccessMemberExpression, AccessScopeExpression, AccessThisExpression, ArrayBindingPattern, ArrayLiteralExpression, AssignExpression, BinaryExpression, BindingBehaviorExpression, BindingIdentifier, CallFunctionExpression, CallMemberExpression, CallScopeExpression, ConditionalExpression, CustomExpression, ForOfStatement, Interpolation, ObjectBindingPattern, ObjectLiteralExpression, PrimitiveLiteralExpression, TaggedTemplateExpression, TemplateExpression, UnaryExpression, ValueConverterExpression } from '@aurelia/runtime';\nimport { unescapeCode } from './common';\nconst $false = PrimitiveLiteralExpression.$false;\nconst $true = PrimitiveLiteralExpression.$true;\nconst $null = PrimitiveLiteralExpression.$null;\nconst $undefined = PrimitiveLiteralExpression.$undefined;\nconst $this = AccessThisExpression.$this;\nconst $parent = AccessThisExpression.$parent;\n/** @internal */\nexport class ParserState {\n    constructor(input) {\n        this.input = input;\n        this.index = 0;\n        this.startIndex = 0;\n        this.lastIndex = 0;\n        this.currentToken = 1572864 /* EOF */;\n        this.tokenValue = '';\n        this.assignable = true;\n        this.length = input.length;\n        this.currentChar = input.charCodeAt(0);\n    }\n    get tokenRaw() {\n        return this.input.slice(this.startIndex, this.index);\n    }\n}\nconst $state = new ParserState('');\nvar SyntaxError;\n(function (SyntaxError) {\n    SyntaxError[SyntaxError[\"InvalidExpressionStart\"] = 100] = \"InvalidExpressionStart\";\n    SyntaxError[SyntaxError[\"UnconsumedToken\"] = 101] = \"UnconsumedToken\";\n    SyntaxError[SyntaxError[\"DoubleDot\"] = 102] = \"DoubleDot\";\n    SyntaxError[SyntaxError[\"InvalidMemberExpression\"] = 103] = \"InvalidMemberExpression\";\n    SyntaxError[SyntaxError[\"UnexpectedEndOfExpression\"] = 104] = \"UnexpectedEndOfExpression\";\n    SyntaxError[SyntaxError[\"ExpectedIdentifier\"] = 105] = \"ExpectedIdentifier\";\n    SyntaxError[SyntaxError[\"InvalidForDeclaration\"] = 106] = \"InvalidForDeclaration\";\n    SyntaxError[SyntaxError[\"InvalidObjectLiteralPropertyDefinition\"] = 107] = \"InvalidObjectLiteralPropertyDefinition\";\n    SyntaxError[SyntaxError[\"UnterminatedQuote\"] = 108] = \"UnterminatedQuote\";\n    SyntaxError[SyntaxError[\"UnterminatedTemplate\"] = 109] = \"UnterminatedTemplate\";\n    SyntaxError[SyntaxError[\"MissingExpectedToken\"] = 110] = \"MissingExpectedToken\";\n    SyntaxError[SyntaxError[\"UnexpectedCharacter\"] = 111] = \"UnexpectedCharacter\";\n    SyntaxError[SyntaxError[\"MissingValueConverter\"] = 112] = \"MissingValueConverter\";\n    SyntaxError[SyntaxError[\"MissingBindingBehavior\"] = 113] = \"MissingBindingBehavior\";\n})(SyntaxError || (SyntaxError = {}));\nvar SemanticError;\n(function (SemanticError) {\n    SemanticError[SemanticError[\"NotAssignable\"] = 150] = \"NotAssignable\";\n    SemanticError[SemanticError[\"UnexpectedForOf\"] = 151] = \"UnexpectedForOf\";\n})(SemanticError || (SemanticError = {}));\nexport function parseExpression(input, bindingType) {\n    $state.input = input;\n    $state.length = input.length;\n    $state.index = 0;\n    $state.currentChar = input.charCodeAt(0);\n    return parse($state, 0 /* Reset */, 61 /* Variadic */, bindingType === void 0 ? 53 /* BindCommand */ : bindingType);\n}\n/** @internal */\n// JUSTIFICATION: This is performance-critical code which follows a subset of the well-known ES spec.\n// Knowing the spec, or parsers in general, will help with understanding this code and it is therefore not the\n// single source of information for being able to figure it out.\n// It generally does not need to change unless the spec changes or spec violations are found, or optimization\n// opportunities are found (which would likely not fix these warnings in any case).\n// It's therefore not considered to have any tangible impact on the maintainability of the code base.\n// For reference, most of the parsing logic is based on: https://tc39.github.io/ecma262/#sec-ecmascript-language-expressions\n// eslint-disable-next-line max-lines-per-function\nexport function parse(state, access, minPrecedence, bindingType) {\n    if (bindingType === 284 /* CustomCommand */) {\n        return new CustomExpression(state.input);\n    }\n    if (state.index === 0) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseInterpolation(state);\n        }\n        nextToken(state);\n        if (state.currentToken & 1048576 /* ExpressionTerminal */) {\n            throw Reporter.error(100 /* InvalidExpressionStart */, { state });\n        }\n    }\n    state.assignable = 448 /* Binary */ > minPrecedence;\n    let result = void 0;\n    if (state.currentToken & 32768 /* UnaryOp */) {\n        /** parseUnaryExpression\n         * https://tc39.github.io/ecma262/#sec-unary-operators\n         *\n         * UnaryExpression :\n         * 1. LeftHandSideExpression\n         * 2. void UnaryExpression\n         * 3. typeof UnaryExpression\n         * 4. + UnaryExpression\n         * 5. - UnaryExpression\n         * 6. ! UnaryExpression\n         *\n         * IsValidAssignmentTarget\n         * 2,3,4,5,6 = false\n         * 1 = see parseLeftHandSideExpression\n         *\n         * Note: technically we should throw on ++ / -- / +++ / ---, but there's nothing to gain from that\n         */\n        const op = TokenValues[state.currentToken & 63 /* Type */];\n        nextToken(state);\n        result = new UnaryExpression(op, parse(state, access, 449 /* LeftHandSide */, bindingType));\n        state.assignable = false;\n    }\n    else {\n        /** parsePrimaryExpression\n         * https://tc39.github.io/ecma262/#sec-primary-expression\n         *\n         * PrimaryExpression :\n         * 1. this\n         * 2. IdentifierName\n         * 3. Literal\n         * 4. ArrayLiteralExpression\n         * 5. ObjectLiteralExpression\n         * 6. TemplateLiteral\n         * 7. ParenthesizedExpression\n         *\n         * Literal :\n         * NullLiteral\n         * BooleanLiteral\n         * NumericLiteral\n         * StringLiteral\n         *\n         * ParenthesizedExpression :\n         * ( AssignmentExpression )\n         *\n         * IsValidAssignmentTarget\n         * 1,3,4,5,6,7 = false\n         * 2 = true\n         */\n        primary: switch (state.currentToken) {\n            case 3077 /* ParentScope */: // $parent\n                state.assignable = false;\n                do {\n                    nextToken(state);\n                    access++; // ancestor\n                    if (consumeOpt(state, 16392 /* Dot */)) {\n                        if (state.currentToken === 16392 /* Dot */) {\n                            throw Reporter.error(102 /* DoubleDot */, { state });\n                        }\n                        else if (state.currentToken === 1572864 /* EOF */) {\n                            throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                        }\n                    }\n                    else if (state.currentToken & 524288 /* AccessScopeTerminal */) {\n                        const ancestor = access & 511 /* Ancestor */;\n                        result = ancestor === 0 ? $this : ancestor === 1 ? $parent : new AccessThisExpression(ancestor);\n                        access = 512 /* This */;\n                        break primary;\n                    }\n                    else {\n                        throw Reporter.error(103 /* InvalidMemberExpression */, { state });\n                    }\n                } while (state.currentToken === 3077 /* ParentScope */);\n            // falls through\n            case 1024 /* Identifier */: // identifier\n                if (bindingType & 512 /* IsIterator */) {\n                    result = new BindingIdentifier(state.tokenValue);\n                }\n                else {\n                    result = new AccessScopeExpression(state.tokenValue, access & 511 /* Ancestor */);\n                    access = 1024 /* Scope */;\n                }\n                state.assignable = true;\n                nextToken(state);\n                break;\n            case 3076 /* ThisScope */: // $this\n                state.assignable = false;\n                nextToken(state);\n                result = $this;\n                access = 512 /* This */;\n                break;\n            case 671750 /* OpenParen */: // parenthesized expression\n                nextToken(state);\n                result = parse(state, 0 /* Reset */, 62 /* Assign */, bindingType);\n                consume(state, 1835018 /* CloseParen */);\n                access = 0 /* Reset */;\n                break;\n            case 671756 /* OpenBracket */:\n                result = parseArrayLiteralExpression(state, access, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 131079 /* OpenBrace */:\n                result = parseObjectLiteralExpression(state, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 540713 /* TemplateTail */:\n                result = new TemplateExpression([state.tokenValue]);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 540714 /* TemplateContinuation */:\n                result = parseTemplate(state, access, bindingType, result, false);\n                access = 0 /* Reset */;\n                break;\n            case 4096 /* StringLiteral */:\n            case 8192 /* NumericLiteral */:\n                result = new PrimitiveLiteralExpression(state.tokenValue);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 2050 /* NullKeyword */:\n            case 2051 /* UndefinedKeyword */:\n            case 2049 /* TrueKeyword */:\n            case 2048 /* FalseKeyword */:\n                result = TokenValues[state.currentToken & 63 /* Type */];\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            default:\n                if (state.index >= state.length) {\n                    throw Reporter.error(104 /* UnexpectedEndOfExpression */, { state });\n                }\n                else {\n                    throw Reporter.error(101 /* UnconsumedToken */, { state });\n                }\n        }\n        if (bindingType & 512 /* IsIterator */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseForOfStatement(state, result);\n        }\n        if (449 /* LeftHandSide */ < minPrecedence) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        /** parseMemberExpression (Token.Dot, Token.OpenBracket, Token.TemplateContinuation)\n         * MemberExpression :\n         * 1. PrimaryExpression\n         * 2. MemberExpression [ AssignmentExpression ]\n         * 3. MemberExpression . IdentifierName\n         * 4. MemberExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,4 = false\n         * 2,3 = true\n         *\n         *\n         * parseCallExpression (Token.OpenParen)\n         * CallExpression :\n         * 1. MemberExpression Arguments\n         * 2. CallExpression Arguments\n         * 3. CallExpression [ AssignmentExpression ]\n         * 4. CallExpression . IdentifierName\n         * 5. CallExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,2,5 = false\n         * 3,4 = true\n         */\n        let name = state.tokenValue;\n        while ((state.currentToken & 16384 /* LeftHandSide */) > 0) {\n            const args = [];\n            let strings;\n            switch (state.currentToken) {\n                case 16392 /* Dot */:\n                    state.assignable = true;\n                    nextToken(state);\n                    if ((state.currentToken & 3072 /* IdentifierName */) === 0) {\n                        throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                    }\n                    name = state.tokenValue;\n                    nextToken(state);\n                    // Change $This to $Scope, change $Scope to $Member, keep $Member as-is, change $Keyed to $Member, disregard other flags\n                    access = ((access & (512 /* This */ | 1024 /* Scope */)) << 1) | (access & 2048 /* Member */) | ((access & 4096 /* Keyed */) >> 1);\n                    if (state.currentToken === 671750 /* OpenParen */) {\n                        if (access === 0 /* Reset */) { // if the left hand side is a literal, make sure we parse a CallMemberExpression\n                            access = 2048 /* Member */;\n                        }\n                        continue;\n                    }\n                    if (access & 1024 /* Scope */) {\n                        result = new AccessScopeExpression(name, result.ancestor);\n                    }\n                    else { // if it's not $Scope, it's $Member\n                        result = new AccessMemberExpression(result, name);\n                    }\n                    continue;\n                case 671756 /* OpenBracket */:\n                    state.assignable = true;\n                    nextToken(state);\n                    access = 4096 /* Keyed */;\n                    result = new AccessKeyedExpression(result, parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                    consume(state, 1835021 /* CloseBracket */);\n                    break;\n                case 671750 /* OpenParen */:\n                    state.assignable = false;\n                    nextToken(state);\n                    while (state.currentToken !== 1835018 /* CloseParen */) {\n                        args.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                        if (!consumeOpt(state, 1572875 /* Comma */)) {\n                            break;\n                        }\n                    }\n                    consume(state, 1835018 /* CloseParen */);\n                    if (access & 1024 /* Scope */) {\n                        result = new CallScopeExpression(name, args, result.ancestor);\n                    }\n                    else if (access & 2048 /* Member */) {\n                        result = new CallMemberExpression(result, name, args);\n                    }\n                    else {\n                        result = new CallFunctionExpression(result, args);\n                    }\n                    access = 0;\n                    break;\n                case 540713 /* TemplateTail */:\n                    state.assignable = false;\n                    strings = [state.tokenValue];\n                    result = new TaggedTemplateExpression(strings, strings, result);\n                    nextToken(state);\n                    break;\n                case 540714 /* TemplateContinuation */:\n                    result = parseTemplate(state, access, bindingType, result, true);\n                default:\n            }\n        }\n    }\n    if (448 /* Binary */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseBinaryExpression\n     * https://tc39.github.io/ecma262/#sec-multiplicative-operators\n     *\n     * MultiplicativeExpression : (local precedence 6)\n     * UnaryExpression\n     * MultiplicativeExpression * / % UnaryExpression\n     *\n     * AdditiveExpression : (local precedence 5)\n     * MultiplicativeExpression\n     * AdditiveExpression + - MultiplicativeExpression\n     *\n     * RelationalExpression : (local precedence 4)\n     * AdditiveExpression\n     * RelationalExpression < > <= >= instanceof in AdditiveExpression\n     *\n     * EqualityExpression : (local precedence 3)\n     * RelationalExpression\n     * EqualityExpression == != === !== RelationalExpression\n     *\n     * LogicalANDExpression : (local precedence 2)\n     * EqualityExpression\n     * LogicalANDExpression && EqualityExpression\n     *\n     * LogicalORExpression : (local precedence 1)\n     * LogicalANDExpression\n     * LogicalORExpression || LogicalANDExpression\n     */\n    while ((state.currentToken & 65536 /* BinaryOp */) > 0) {\n        const opToken = state.currentToken;\n        if ((opToken & 448 /* Precedence */) <= minPrecedence) {\n            break;\n        }\n        nextToken(state);\n        result = new BinaryExpression(TokenValues[opToken & 63 /* Type */], result, parse(state, access, opToken & 448 /* Precedence */, bindingType));\n        state.assignable = false;\n    }\n    if (63 /* Conditional */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /**\n     * parseConditionalExpression\n     * https://tc39.github.io/ecma262/#prod-ConditionalExpression\n     *\n     * ConditionalExpression :\n     * 1. BinaryExpression\n     * 2. BinaryExpression ? AssignmentExpression : AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1572879 /* Question */)) {\n        const yes = parse(state, access, 62 /* Assign */, bindingType);\n        consume(state, 1572878 /* Colon */);\n        result = new ConditionalExpression(result, yes, parse(state, access, 62 /* Assign */, bindingType));\n        state.assignable = false;\n    }\n    if (62 /* Assign */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseAssignmentExpression\n     * https://tc39.github.io/ecma262/#prod-AssignmentExpression\n     * Note: AssignmentExpression here is equivalent to ES Expression because we don't parse the comma operator\n     *\n     * AssignmentExpression :\n     * 1. ConditionalExpression\n     * 2. LeftHandSideExpression = AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1048615 /* Equals */)) {\n        if (!state.assignable) {\n            throw Reporter.error(150 /* NotAssignable */, { state });\n        }\n        result = new AssignExpression(result, parse(state, access, 62 /* Assign */, bindingType));\n    }\n    if (61 /* Variadic */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseValueConverter\n     */\n    while (consumeOpt(state, 1572883 /* Bar */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(112);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new ValueConverterExpression(result, name, args);\n    }\n    /** parseBindingBehavior\n     */\n    while (consumeOpt(state, 1572880 /* Ampersand */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(113);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new BindingBehaviorExpression(result, name, args);\n    }\n    if (state.currentToken !== 1572864 /* EOF */) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        if (state.tokenRaw === 'of') {\n            throw Reporter.error(151 /* UnexpectedForOf */, { state });\n        }\n        throw Reporter.error(101 /* UnconsumedToken */, { state });\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return result;\n}\n/**\n * parseArrayLiteralExpression\n * https://tc39.github.io/ecma262/#prod-ArrayLiteralExpression\n *\n * ArrayLiteralExpression :\n * [ Elision(opt) ]\n * [ ElementList ]\n * [ ElementList, Elision(opt) ]\n *\n * ElementList :\n * Elision(opt) AssignmentExpression\n * ElementList, Elision(opt) AssignmentExpression\n *\n * Elision :\n * ,\n * Elision ,\n */\nfunction parseArrayLiteralExpression(state, access, bindingType) {\n    nextToken(state);\n    const elements = new Array();\n    while (state.currentToken !== 1835021 /* CloseBracket */) {\n        if (consumeOpt(state, 1572875 /* Comma */)) {\n            elements.push($undefined);\n            if (state.currentToken === 1835021 /* CloseBracket */) {\n                break;\n            }\n        }\n        else {\n            elements.push(parse(state, access, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            if (consumeOpt(state, 1572875 /* Comma */)) {\n                if (state.currentToken === 1835021 /* CloseBracket */) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n    }\n    consume(state, 1835021 /* CloseBracket */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ArrayBindingPattern(elements);\n    }\n    else {\n        state.assignable = false;\n        return new ArrayLiteralExpression(elements);\n    }\n}\nfunction parseForOfStatement(state, result) {\n    if ((result.$kind & 65536 /* IsForDeclaration */) === 0) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    if (state.currentToken !== 1051179 /* OfKeyword */) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    nextToken(state);\n    const declaration = result;\n    const statement = parse(state, 0 /* Reset */, 61 /* Variadic */, 0 /* None */);\n    return new ForOfStatement(declaration, statement);\n}\n/**\n * parseObjectLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * ObjectLiteralExpression :\n * { }\n * { PropertyDefinitionList }\n *\n * PropertyDefinitionList :\n * PropertyDefinition\n * PropertyDefinitionList, PropertyDefinition\n *\n * PropertyDefinition :\n * IdentifierName\n * PropertyName : AssignmentExpression\n *\n * PropertyName :\n * IdentifierName\n * StringLiteral\n * NumericLiteral\n */\nfunction parseObjectLiteralExpression(state, bindingType) {\n    const keys = new Array();\n    const values = new Array();\n    nextToken(state);\n    while (state.currentToken !== 1835017 /* CloseBrace */) {\n        keys.push(state.tokenValue);\n        // Literal = mandatory colon\n        if (state.currentToken & 12288 /* StringOrNumericLiteral */) {\n            nextToken(state);\n            consume(state, 1572878 /* Colon */);\n            values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n        }\n        else if (state.currentToken & 3072 /* IdentifierName */) {\n            // IdentifierName = optional colon\n            const { currentChar, currentToken, index } = state;\n            nextToken(state);\n            if (consumeOpt(state, 1572878 /* Colon */)) {\n                values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            }\n            else {\n                // Shorthand\n                state.currentChar = currentChar;\n                state.currentToken = currentToken;\n                state.index = index;\n                values.push(parse(state, 0 /* Reset */, 450 /* Primary */, bindingType & ~512 /* IsIterator */));\n            }\n        }\n        else {\n            throw Reporter.error(107 /* InvalidObjectLiteralPropertyDefinition */, { state });\n        }\n        if (state.currentToken !== 1835017 /* CloseBrace */) {\n            consume(state, 1572875 /* Comma */);\n        }\n    }\n    consume(state, 1835017 /* CloseBrace */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ObjectBindingPattern(keys, values);\n    }\n    else {\n        state.assignable = false;\n        return new ObjectLiteralExpression(keys, values);\n    }\n}\nfunction parseInterpolation(state) {\n    const parts = [];\n    const expressions = [];\n    const length = state.length;\n    let result = '';\n    while (state.index < length) {\n        switch (state.currentChar) {\n            case 36 /* Dollar */:\n                if (state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                    parts.push(result);\n                    result = '';\n                    state.index += 2;\n                    state.currentChar = state.input.charCodeAt(state.index);\n                    nextToken(state);\n                    const expression = parse(state, 0 /* Reset */, 61 /* Variadic */, 2048 /* Interpolation */);\n                    expressions.push(expression);\n                    continue;\n                }\n                else {\n                    result += '$';\n                }\n                break;\n            case 92 /* Backslash */:\n                result += String.fromCharCode(unescapeCode(nextChar(state)));\n                break;\n            default:\n                result += String.fromCharCode(state.currentChar);\n        }\n        nextChar(state);\n    }\n    if (expressions.length) {\n        parts.push(result);\n        return new Interpolation(parts, expressions);\n    }\n    return null;\n}\n/**\n * parseTemplateLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * TemplateExpression :\n * NoSubstitutionTemplate\n * TemplateHead\n *\n * NoSubstitutionTemplate :\n * ` TemplateCharacters(opt) `\n *\n * TemplateHead :\n * ` TemplateCharacters(opt) ${\n *\n * TemplateSubstitutionTail :\n * TemplateMiddle\n * TemplateTail\n *\n * TemplateMiddle :\n * } TemplateCharacters(opt) ${\n *\n * TemplateTail :\n * } TemplateCharacters(opt) `\n *\n * TemplateCharacters :\n * TemplateCharacter TemplateCharacters(opt)\n *\n * TemplateCharacter :\n * $ [lookahead  {]\n * \\ EscapeSequence\n * SourceCharacter (but not one of ` or \\ or $)\n */\nfunction parseTemplate(state, access, bindingType, result, tagged) {\n    const cooked = [state.tokenValue];\n    // TODO: properly implement raw parts / decide whether we want this\n    consume(state, 540714 /* TemplateContinuation */);\n    const expressions = [parse(state, access, 62 /* Assign */, bindingType)];\n    while ((state.currentToken = scanTemplateTail(state)) !== 540713 /* TemplateTail */) {\n        cooked.push(state.tokenValue);\n        consume(state, 540714 /* TemplateContinuation */);\n        expressions.push(parse(state, access, 62 /* Assign */, bindingType));\n    }\n    cooked.push(state.tokenValue);\n    state.assignable = false;\n    if (tagged) {\n        nextToken(state);\n        return new TaggedTemplateExpression(cooked, cooked, result, expressions);\n    }\n    else {\n        nextToken(state);\n        return new TemplateExpression(cooked, expressions);\n    }\n}\nfunction nextToken(state) {\n    while (state.index < state.length) {\n        state.startIndex = state.index;\n        if ((state.currentToken = (CharScanners[state.currentChar](state))) != null) { // a null token means the character must be skipped\n            return;\n        }\n    }\n    state.currentToken = 1572864 /* EOF */;\n}\nfunction nextChar(state) {\n    return state.currentChar = state.input.charCodeAt(++state.index);\n}\nfunction scanIdentifier(state) {\n    // run to the next non-idPart\n    while (IdParts[nextChar(state)])\n        ;\n    const token = KeywordLookup[state.tokenValue = state.tokenRaw];\n    return token === undefined ? 1024 /* Identifier */ : token;\n}\nfunction scanNumber(state, isFloat) {\n    let char = state.currentChar;\n    if (isFloat === false) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n        if (char !== 46 /* Dot */) {\n            state.tokenValue = parseInt(state.tokenRaw, 10);\n            return 8192 /* NumericLiteral */;\n        }\n        // past this point it's always a float\n        char = nextChar(state);\n        if (state.index >= state.length) {\n            // unless the number ends with a dot - that behaves a little different in native ES expressions\n            // but in our AST that behavior has no effect because numbers are always stored in variables\n            state.tokenValue = parseInt(state.tokenRaw.slice(0, -1), 10);\n            return 8192 /* NumericLiteral */;\n        }\n    }\n    if (char <= 57 /* Nine */ && char >= 48 /* Zero */) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n    }\n    else {\n        state.currentChar = state.input.charCodeAt(--state.index);\n    }\n    state.tokenValue = parseFloat(state.tokenRaw);\n    return 8192 /* NumericLiteral */;\n}\nfunction scanString(state) {\n    const quote = state.currentChar;\n    nextChar(state); // Skip initial quote.\n    let unescaped = 0;\n    const buffer = new Array();\n    let marker = state.index;\n    while (state.currentChar !== quote) {\n        if (state.currentChar === 92 /* Backslash */) {\n            buffer.push(state.input.slice(marker, state.index));\n            nextChar(state);\n            unescaped = unescapeCode(state.currentChar);\n            nextChar(state);\n            buffer.push(String.fromCharCode(unescaped));\n            marker = state.index;\n        }\n        else if (state.index >= state.length) {\n            throw Reporter.error(108 /* UnterminatedQuote */, { state });\n        }\n        else {\n            nextChar(state);\n        }\n    }\n    const last = state.input.slice(marker, state.index);\n    nextChar(state); // Skip terminating quote.\n    // Compute the unescaped string value.\n    buffer.push(last);\n    const unescapedStr = buffer.join('');\n    state.tokenValue = unescapedStr;\n    return 4096 /* StringLiteral */;\n}\nfunction scanTemplate(state) {\n    let tail = true;\n    let result = '';\n    while (nextChar(state) !== 96 /* Backtick */) {\n        if (state.currentChar === 36 /* Dollar */) {\n            if ((state.index + 1) < state.length && state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                state.index++;\n                tail = false;\n                break;\n            }\n            else {\n                result += '$';\n            }\n        }\n        else if (state.currentChar === 92 /* Backslash */) {\n            result += String.fromCharCode(unescapeCode(nextChar(state)));\n        }\n        else {\n            if (state.index >= state.length) {\n                throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n            }\n            result += String.fromCharCode(state.currentChar);\n        }\n    }\n    nextChar(state);\n    state.tokenValue = result;\n    if (tail) {\n        return 540713 /* TemplateTail */;\n    }\n    return 540714 /* TemplateContinuation */;\n}\nfunction scanTemplateTail(state) {\n    if (state.index >= state.length) {\n        throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n    }\n    state.index--;\n    return scanTemplate(state);\n}\nfunction consumeOpt(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n        return true;\n    }\n    return false;\n}\nfunction consume(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n    }\n    else {\n        throw Reporter.error(110 /* MissingExpectedToken */, { state, expected: token });\n    }\n}\n/**\n * Array for mapping tokens to token values. The indices of the values\n * correspond to the token bits 0-38.\n * For this to work properly, the values in the array must be kept in\n * the same order as the token bits.\n * Usage: TokenValues[token & Token.Type]\n */\nconst TokenValues = [\n    $false, $true, $null, $undefined, '$this', '$parent',\n    '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"',\n    '&', '|', '||', '&&', '==', '!=', '===', '!==', '<', '>',\n    '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!',\n    540713 /* TemplateTail */, 540714 /* TemplateContinuation */,\n    'of'\n];\nconst KeywordLookup = Object.create(null);\nKeywordLookup.true = 2049 /* TrueKeyword */;\nKeywordLookup.null = 2050 /* NullKeyword */;\nKeywordLookup.false = 2048 /* FalseKeyword */;\nKeywordLookup.undefined = 2051 /* UndefinedKeyword */;\nKeywordLookup.$this = 3076 /* ThisScope */;\nKeywordLookup.$parent = 3077 /* ParentScope */;\nKeywordLookup.in = 1640798 /* InKeyword */;\nKeywordLookup.instanceof = 1640799 /* InstanceOfKeyword */;\nKeywordLookup.typeof = 34850 /* TypeofKeyword */;\nKeywordLookup.void = 34851 /* VoidKeyword */;\nKeywordLookup.of = 1051179 /* OfKeyword */;\n/**\n * Ranges of code points in pairs of 2 (eg 0x41-0x5B, 0x61-0x7B, ...) where the second value is not inclusive (5-7 means 5 and 6)\n * Single values are denoted by the second value being a 0\n *\n * Copied from output generated with \"node build/generate-unicode.js\"\n *\n * See also: https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF\n */\nconst codes = {\n    /* [$0-9A-Za_a-z] */\n    AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n    IdStart: /* IdentifierStart */ [0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n    Digit: /* DecimalNumber */ [0x30, 0x3A],\n    Skip: /* Skippable */ [0, 0x21, 0x7F, 0xA1]\n};\n/**\n * Decompress the ranges into an array of numbers so that the char code\n * can be used as an index to the lookup\n */\nfunction decompress(lookup, $set, compressed, value) {\n    const rangeCount = compressed.length;\n    for (let i = 0; i < rangeCount; i += 2) {\n        const start = compressed[i];\n        let end = compressed[i + 1];\n        end = end > 0 ? end : start + 1;\n        if (lookup) {\n            lookup.fill(value, start, end);\n        }\n        if ($set) {\n            for (let ch = start; ch < end; ch++) {\n                $set.add(ch);\n            }\n        }\n    }\n}\n// CharFuncLookup functions\nfunction returnToken(token) {\n    return s => {\n        nextChar(s);\n        return token;\n    };\n}\nconst unexpectedCharacter = s => {\n    throw Reporter.error(111 /* UnexpectedCharacter */, { state: s });\n};\nunexpectedCharacter.notMapped = true;\n// ASCII IdentifierPart lookup\nconst AsciiIdParts = new Set();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n// IdentifierPart lookup\nconst IdParts = new Uint8Array(0xFFFF);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.IdStart, 1);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.Digit, 1);\n// Character scanning function lookup\nconst CharScanners = new Array(0xFFFF);\nCharScanners.fill(unexpectedCharacter, 0, 0xFFFF);\ndecompress(CharScanners, null, codes.Skip, s => {\n    nextChar(s);\n    return null;\n});\ndecompress(CharScanners, null, codes.IdStart, scanIdentifier);\ndecompress(CharScanners, null, codes.Digit, s => scanNumber(s, false));\nCharScanners[34 /* DoubleQuote */] =\n    CharScanners[39 /* SingleQuote */] = s => {\n        return scanString(s);\n    };\nCharScanners[96 /* Backtick */] = s => {\n    return scanTemplate(s);\n};\n// !, !=, !==\nCharScanners[33 /* Exclamation */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 32808 /* Exclamation */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638679 /* ExclamationEquals */;\n    }\n    nextChar(s);\n    return 1638681 /* ExclamationEqualsEquals */;\n};\n// =, ==, ===\nCharScanners[61 /* Equals */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1048615 /* Equals */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638678 /* EqualsEquals */;\n    }\n    nextChar(s);\n    return 1638680 /* EqualsEqualsEquals */;\n};\n// &, &&\nCharScanners[38 /* Ampersand */] = s => {\n    if (nextChar(s) !== 38 /* Ampersand */) {\n        return 1572880 /* Ampersand */;\n    }\n    nextChar(s);\n    return 1638613 /* AmpersandAmpersand */;\n};\n// |, ||\nCharScanners[124 /* Bar */] = s => {\n    if (nextChar(s) !== 124 /* Bar */) {\n        return 1572883 /* Bar */;\n    }\n    nextChar(s);\n    return 1638548 /* BarBar */;\n};\n// .\nCharScanners[46 /* Dot */] = s => {\n    if (nextChar(s) <= 57 /* Nine */ && s.currentChar >= 48 /* Zero */) {\n        return scanNumber(s, true);\n    }\n    return 16392 /* Dot */;\n};\n// <, <=\nCharScanners[60 /* LessThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638746 /* LessThan */;\n    }\n    nextChar(s);\n    return 1638748 /* LessThanEquals */;\n};\n// >, >=\nCharScanners[62 /* GreaterThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638747 /* GreaterThan */;\n    }\n    nextChar(s);\n    return 1638749 /* GreaterThanEquals */;\n};\nCharScanners[37 /* Percent */] = returnToken(1638885 /* Percent */);\nCharScanners[40 /* OpenParen */] = returnToken(671750 /* OpenParen */);\nCharScanners[41 /* CloseParen */] = returnToken(1835018 /* CloseParen */);\nCharScanners[42 /* Asterisk */] = returnToken(1638884 /* Asterisk */);\nCharScanners[43 /* Plus */] = returnToken(623008 /* Plus */);\nCharScanners[44 /* Comma */] = returnToken(1572875 /* Comma */);\nCharScanners[45 /* Minus */] = returnToken(623009 /* Minus */);\nCharScanners[47 /* Slash */] = returnToken(1638886 /* Slash */);\nCharScanners[58 /* Colon */] = returnToken(1572878 /* Colon */);\nCharScanners[63 /* Question */] = returnToken(1572879 /* Question */);\nCharScanners[91 /* OpenBracket */] = returnToken(671756 /* OpenBracket */);\nCharScanners[93 /* CloseBracket */] = returnToken(1835021 /* CloseBracket */);\nCharScanners[123 /* OpenBrace */] = returnToken(131079 /* OpenBrace */);\nCharScanners[125 /* CloseBrace */] = returnToken(1835017 /* CloseBrace */);\n//# sourceMappingURL=expression-parser.js.map","import { DI } from '@aurelia/kernel';\nimport { IExpressionParser, RuntimeConfiguration } from '@aurelia/runtime';\nimport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern } from './attribute-patterns';\nimport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nimport { parseExpression } from './expression-parser';\nexport const IExpressionParserRegistration = {\n    register(container) {\n        container.registerTransformer(IExpressionParser, parser => {\n            Reflect.set(parser, 'parseCore', parseExpression);\n            return parser;\n        });\n    }\n};\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IExpressionParser`\n */\nexport const DefaultComponents = [\n    IExpressionParserRegistration\n];\nexport const AtPrefixedTriggerAttributePatternRegistration = AtPrefixedTriggerAttributePattern;\nexport const ColonPrefixedBindAttributePatternRegistration = ColonPrefixedBindAttributePattern;\nexport const RefAttributePatternRegistration = RefAttributePattern;\nexport const DotSeparatedAttributePatternRegistration = DotSeparatedAttributePattern;\n/**\n * Default binding syntax for the following attribute name patterns:\n * - `ref`\n * - `target.command` (dot-separated)\n */\nexport const DefaultBindingSyntax = [\n    RefAttributePatternRegistration,\n    DotSeparatedAttributePatternRegistration\n];\n/**\n * Binding syntax for short-hand attribute name patterns:\n * - `@target` (short-hand for `target.trigger`)\n * - `:target` (short-hand for `target.bind`)\n */\nexport const ShortHandBindingSyntax = [\n    AtPrefixedTriggerAttributePatternRegistration,\n    ColonPrefixedBindAttributePatternRegistration\n];\nexport const CallBindingCommandRegistration = CallBindingCommand;\nexport const DefaultBindingCommandRegistration = DefaultBindingCommand;\nexport const ForBindingCommandRegistration = ForBindingCommand;\nexport const FromViewBindingCommandRegistration = FromViewBindingCommand;\nexport const OneTimeBindingCommandRegistration = OneTimeBindingCommand;\nexport const ToViewBindingCommandRegistration = ToViewBindingCommand;\nexport const TwoWayBindingCommandRegistration = TwoWayBindingCommand;\n/**\n * Default runtime/environment-agnostic binding commands:\n * - Property observation: `.bind`, `.one-time`, `.from-view`, `.to-view`, `.two-way`\n * - Function call: `.call`\n * - Collection observation: `.for`\n */\nexport const DefaultBindingLanguage = [\n    DefaultBindingCommandRegistration,\n    OneTimeBindingCommandRegistration,\n    FromViewBindingCommandRegistration,\n    ToViewBindingCommandRegistration,\n    TwoWayBindingCommandRegistration,\n    CallBindingCommandRegistration,\n    ForBindingCommandRegistration\n];\n/**\n * A DI configuration object containing runtime/environment-agnostic registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultBindingSyntax`\n * - `DefaultBindingLanguage`\n */\nexport const JitConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultBindingSyntax, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { kebabCase, Metadata, } from '@aurelia/kernel';\nimport { BindingMode, CustomAttribute, CustomElement, } from '@aurelia/runtime';\nimport { BindingCommand } from './binding-command';\n/**\n * A pre-processed piece of information about a defined bindable property on a custom\n * element or attribute, optimized for consumption by the template compiler.\n */\nexport class BindableInfo {\n    constructor(\n    /**\n     * The pre-processed *property* (not attribute) name of the bindable, which is\n     * (in order of priority):\n     *\n     * 1. The `property` from the description (if defined)\n     * 2. The name of the property of the bindable itself\n     */\n    propName, \n    /**\n     * The pre-processed (default) bindingMode of the bindable, which is (in order of priority):\n     *\n     * 1. The `mode` from the bindable (if defined and not bindingMode.default)\n     * 2. The `defaultBindingMode` (if it's an attribute, defined, and not bindingMode.default)\n     * 3. `bindingMode.toView`\n     */\n    mode) {\n        this.propName = propName;\n        this.mode = mode;\n    }\n}\n/**\n * Pre-processed information about a custom element resource, optimized\n * for consumption by the template compiler.\n */\nexport class ElementInfo {\n    constructor(name, containerless) {\n        this.name = name;\n        this.containerless = containerless;\n        /**\n         * A lookup of the bindables of this element, indexed by the (pre-processed)\n         * attribute names as they would be found in parsed markup.\n         */\n        this.bindables = Object.create(null);\n    }\n    static from(def) {\n        const info = new ElementInfo(def.name, def.containerless);\n        const bindables = def.bindables;\n        const defaultBindingMode = BindingMode.toView;\n        let bindable;\n        let prop;\n        let attr;\n        let mode;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            // explicitly provided attribute name has priority over the derived implicit attribute name\n            if (bindable.attribute !== void 0) {\n                attr = bindable.attribute;\n            }\n            else {\n                // derive the attribute name from the resolved property name\n                attr = kebabCase(prop);\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            info.bindables[attr] = new BindableInfo(prop, mode);\n        }\n        return info;\n    }\n}\n/**\n * Pre-processed information about a custom attribute resource, optimized\n * for consumption by the template compiler.\n */\nexport class AttrInfo {\n    constructor(name, isTemplateController, noMultiBindings) {\n        this.name = name;\n        this.isTemplateController = isTemplateController;\n        this.noMultiBindings = noMultiBindings;\n        /**\n         * A lookup of the bindables of this attribute, indexed by the (pre-processed)\n         * bindable names as they would be found in the attribute value.\n         *\n         * Only applicable to multi attribute bindings (semicolon-separated).\n         */\n        this.bindables = Object.create(null);\n        /**\n         * The single or first bindable of this attribute, or a default 'value'\n         * bindable if no bindables were defined on the attribute.\n         *\n         * Only applicable to single attribute bindings (where the attribute value\n         * contains no semicolons)\n         */\n        this.bindable = null;\n    }\n    static from(def) {\n        const info = new AttrInfo(def.name, def.isTemplateController, def.noMultiBindings);\n        const bindables = def.bindables;\n        const defaultBindingMode = def.defaultBindingMode !== void 0 && def.defaultBindingMode !== BindingMode.default\n            ? def.defaultBindingMode\n            : BindingMode.toView;\n        let bindable;\n        let prop;\n        let mode;\n        let hasPrimary = false;\n        let isPrimary = false;\n        let bindableInfo;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            isPrimary = bindable.primary === true;\n            bindableInfo = info.bindables[prop] = new BindableInfo(prop, mode);\n            if (isPrimary) {\n                if (hasPrimary) {\n                    throw new Error('primary already exists');\n                }\n                hasPrimary = true;\n                info.bindable = bindableInfo;\n            }\n            // set to first bindable by convention\n            if (info.bindable === null) {\n                info.bindable = bindableInfo;\n            }\n        }\n        // if no bindables are present, default to \"value\"\n        if (info.bindable === null) {\n            info.bindable = new BindableInfo('value', defaultBindingMode);\n        }\n        return info;\n    }\n}\nconst contextLookup = new WeakMap();\n/**\n * A pre-processed piece of information about declared custom elements, attributes and\n * binding commands, optimized for consumption by the template compiler.\n */\nexport class ResourceModel {\n    constructor(container) {\n        this.elementLookup = Object.create(null);\n        this.attributeLookup = Object.create(null);\n        this.commandLookup = Object.create(null);\n        // Note: don't do this sort of thing elsewhere, this is purely for perf reasons\n        this.container = container;\n        const rootContainer = container.root;\n        this.resourceResolvers = container.resourceResolvers;\n        this.rootResourceResolvers = rootContainer.resourceResolvers;\n    }\n    static getOrCreate(context) {\n        let model = contextLookup.get(context);\n        if (model === void 0) {\n            contextLookup.set(context, model = new ResourceModel(context));\n        }\n        return model;\n    }\n    /**\n     * Retrieve information about a custom element resource.\n     *\n     * @param element - The original DOM element.\n     *\n     * @returns The resource information if the element exists, or `null` if it does not exist.\n     */\n    getElementInfo(name) {\n        let result = this.elementLookup[name];\n        if (result === void 0) {\n            const def = this.find(CustomElement, name);\n            this.elementLookup[name] = result = def === null ? null : ElementInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve information about a custom attribute resource.\n     *\n     * @param syntax - The parsed `AttrSyntax`\n     *\n     * @returns The resource information if the attribute exists, or `null` if it does not exist.\n     */\n    getAttributeInfo(syntax) {\n        let result = this.attributeLookup[syntax.target];\n        if (result === void 0) {\n            const def = this.find(CustomAttribute, syntax.target);\n            this.attributeLookup[syntax.target] = result = def === null ? null : AttrInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve a binding command resource.\n     *\n     * @param name - The parsed `AttrSyntax`\n     *\n     * @returns An instance of the command if it exists, or `null` if it does not exist.\n     */\n    getBindingCommand(syntax, optional) {\n        const name = syntax.command;\n        if (name === null) {\n            return null;\n        }\n        let result = this.commandLookup[name];\n        if (result === void 0) {\n            result = this.create(BindingCommand, name);\n            if (result === null) {\n                if (optional) {\n                    return null;\n                }\n                throw new Error(`Unknown binding command: ${name}`);\n            }\n            this.commandLookup[name] = result;\n        }\n        return result;\n    }\n    find(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        if (typeof resolver.getFactory === 'function') {\n            const factory = resolver.getFactory(this.container);\n            if (factory === null || factory === void 0) {\n                return null;\n            }\n            const definition = Metadata.getOwn(kind.name, factory.Type);\n            if (definition === void 0) {\n                // TODO: we may want to log a warning here, or even throw. This would happen if a dependency is registered with a resource-like key\n                // but does not actually have a definition associated via the type's metadata. That *should* generally not happen.\n                return null;\n            }\n            return definition;\n        }\n        return null;\n    }\n    create(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        const instance = resolver.resolve(this.container, this.container);\n        if (instance === void 0) {\n            return null;\n        }\n        return instance;\n    }\n}\n//# sourceMappingURL=resource-model.js.map","export { AttrSyntax } from './ast';\nexport { IAttributeParser } from './attribute-parser';\nexport { attributePattern, IAttributePattern, AttributePattern, Interpretation, ISyntaxInterpreter, } from './attribute-pattern';\nexport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern, } from './attribute-patterns';\nexport { bindingCommand, BindingCommand, BindingCommandDefinition, getTarget, } from './binding-command';\nexport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nexport { IExpressionParserRegistration, DefaultComponents, RefAttributePatternRegistration, DotSeparatedAttributePatternRegistration, DefaultBindingSyntax, AtPrefixedTriggerAttributePatternRegistration, ColonPrefixedBindAttributePatternRegistration, ShortHandBindingSyntax, CallBindingCommandRegistration, DefaultBindingCommandRegistration, ForBindingCommandRegistration, FromViewBindingCommandRegistration, OneTimeBindingCommandRegistration, ToViewBindingCommandRegistration, TwoWayBindingCommandRegistration, DefaultBindingLanguage, JitConfiguration } from './configuration';\nexport { Access, Precedence, Char, } from './common';\nexport { parseExpression, parse, ParserState, } from './expression-parser';\nexport { ResourceModel, BindableInfo, ElementInfo, AttrInfo } from './resource-model';\nexport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, ReplacePartSymbol, SymbolFlags, TemplateControllerSymbol, TextSymbol, } from './semantic-model';\n//# sourceMappingURL=index.js.map","function $noop() { return; }\nconst $global = (function () {\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    try {\n        // Not all environments allow eval and Function. Use only as a last resort:\n        // eslint-disable-next-line no-new-func\n        return new Function('return this')();\n    }\n    catch (_a) {\n        // If all fails, give up and create an object.\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return {};\n    }\n})();\nconst isBrowserLike = (typeof window !== 'undefined'\n    && typeof window.document !== 'undefined');\nconst isWebWorkerLike = (typeof self === 'object'\n    && self.constructor != null\n    && self.constructor.name === 'DedicatedWorkerGlobalScope');\nconst isNodeLike = (typeof process !== 'undefined'\n    && process.versions != null\n    && process.versions.node != null);\n// performance.now polyfill for non-browser envs based on https://github.com/myrne/performance-now\nconst $now = (function () {\n    let getNanoSeconds;\n    let hrtime;\n    let moduleLoadTime;\n    let nodeLoadTime;\n    let upTime;\n    if ($global.performance != null && $global.performance.now != null) {\n        const $performance = $global.performance;\n        return function () {\n            return $performance.now();\n        };\n    }\n    else if ($global.process != null && $global.process.hrtime != null) {\n        const now = function () {\n            return (getNanoSeconds() - nodeLoadTime) / 1e6;\n        };\n        hrtime = $global.process.hrtime;\n        getNanoSeconds = function () {\n            const hr = hrtime();\n            return hr[0] * 1e9 + hr[1];\n        };\n        moduleLoadTime = getNanoSeconds();\n        upTime = $global.process.uptime() * 1e9;\n        nodeLoadTime = moduleLoadTime - upTime;\n        return now;\n    }\n    else {\n        const now = function () {\n            return Date.now() - nodeLoadTime;\n        };\n        nodeLoadTime = Date.now();\n        return now;\n    }\n})();\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst emptyArray = Object.freeze([]);\nconst emptyObject = Object.freeze({});\nconst $PLATFORM = {\n    /**\n     * `true` if there is a `window` variable in the global scope with a `document` property.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a browser, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `window` global is available and likely behaves similar to how it would in a browser.\n     */\n    isBrowserLike,\n    /**\n     * `true` if there is a `self` variable (of type `object`) in the global scope with constructor name `'DedicatedWorkerGlobalScope'`.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a web worker, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `self` global is available and likely behaves similar to how it would in a web worker.\n     */\n    isWebWorkerLike,\n    /**\n     * `true` if there is a `process` variable in the global scope with a `versions` property which has a `node` property.\n     *\n     * NOTE: this is not a guarantee that the code is actually running in nodejs, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `process` global is available and likely behaves similar to how it would in nodejs.\n     */\n    isNodeLike,\n    global: $global,\n    emptyArray,\n    emptyObject,\n    noop: $noop,\n    now: $now,\n    hasOwnProperty,\n    restore() {\n        Object.assign(PLATFORM, $PLATFORM);\n    },\n};\nexport const PLATFORM = { ...$PLATFORM };\n//# sourceMappingURL=platform.js.map","import * as AST from '@aurelia/runtime';\nconst astTypeMap = [\n    { type: AST.AccessKeyedExpression, name: 'AccessKeyedExpression' },\n    { type: AST.AccessMemberExpression, name: 'AccessMemberExpression' },\n    { type: AST.AccessScopeExpression, name: 'AccessScopeExpression' },\n    { type: AST.AccessThisExpression, name: 'AccessThisExpression' },\n    { type: AST.ArrayBindingPattern, name: 'ArrayBindingPattern' },\n    { type: AST.ArrayLiteralExpression, name: 'ArrayLiteralExpression' },\n    { type: AST.AssignExpression, name: 'AssignExpression' },\n    { type: AST.BinaryExpression, name: 'BinaryExpression' },\n    { type: AST.BindingBehaviorExpression, name: 'BindingBehaviorExpression' },\n    { type: AST.BindingIdentifier, name: 'BindingIdentifier' },\n    { type: AST.CallFunctionExpression, name: 'CallFunctionExpression' },\n    { type: AST.CallMemberExpression, name: 'CallMemberExpression' },\n    { type: AST.CallScopeExpression, name: 'CallScopeExpression' },\n    { type: AST.ConditionalExpression, name: 'ConditionalExpression' },\n    { type: AST.ForOfStatement, name: 'ForOfStatement' },\n    { type: AST.HtmlLiteralExpression, name: 'HtmlLiteralExpression' },\n    { type: AST.Interpolation, name: 'Interpolation' },\n    { type: AST.ObjectBindingPattern, name: 'ObjectBindingPattern' },\n    { type: AST.ObjectLiteralExpression, name: 'ObjectLiteralExpression' },\n    { type: AST.PrimitiveLiteralExpression, name: 'PrimitiveLiteralExpression' },\n    { type: AST.TaggedTemplateExpression, name: 'TaggedTemplateExpression' },\n    { type: AST.TemplateExpression, name: 'TemplateExpression' },\n    { type: AST.UnaryExpression, name: 'UnaryExpression' },\n    { type: AST.ValueConverterExpression, name: 'ValueConverterExpression' }\n];\nexport function enableImprovedExpressionDebugging() {\n    astTypeMap.forEach(x => { adoptDebugMethods(x.type, x.name); });\n}\n/** @internal */\nexport function adoptDebugMethods($type, name) {\n    $type.prototype.toString = function () { return Unparser.unparse(this); };\n}\nexport class Unparser {\n    constructor() {\n        this.text = '';\n    }\n    static unparse(expr) {\n        const visitor = new Unparser();\n        expr.accept(visitor);\n        return visitor.text;\n    }\n    visitAccessMember(expr) {\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n    }\n    visitAccessKeyed(expr) {\n        expr.object.accept(this);\n        this.text += '[';\n        expr.key.accept(this);\n        this.text += ']';\n    }\n    visitAccessThis(expr) {\n        if (expr.ancestor === 0) {\n            this.text += '$this';\n            return;\n        }\n        this.text += '$parent';\n        let i = expr.ancestor - 1;\n        while (i--) {\n            this.text += '.$parent';\n        }\n    }\n    visitAccessScope(expr) {\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n    }\n    visitArrayLiteral(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectLiteral(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitPrimitiveLiteral(expr) {\n        this.text += '(';\n        if (typeof expr.value === 'string') {\n            const escaped = expr.value.replace(/'/g, '\\\\\\'');\n            this.text += `'${escaped}'`;\n        }\n        else {\n            this.text += `${expr.value}`;\n        }\n        this.text += ')';\n    }\n    visitCallFunction(expr) {\n        this.text += '(';\n        expr.func.accept(this);\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallMember(expr) {\n        this.text += '(';\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallScope(expr) {\n        this.text += '(';\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitTaggedTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        expr.func.accept(this);\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitUnary(expr) {\n        this.text += `(${expr.operation}`;\n        if (expr.operation.charCodeAt(0) >= /* a */ 97) {\n            this.text += ' ';\n        }\n        expr.expression.accept(this);\n        this.text += ')';\n    }\n    visitBinary(expr) {\n        this.text += '(';\n        expr.left.accept(this);\n        if (expr.operation.charCodeAt(0) === /* i */ 105) {\n            this.text += ` ${expr.operation} `;\n        }\n        else {\n            this.text += expr.operation;\n        }\n        expr.right.accept(this);\n        this.text += ')';\n    }\n    visitConditional(expr) {\n        this.text += '(';\n        expr.condition.accept(this);\n        this.text += '?';\n        expr.yes.accept(this);\n        this.text += ':';\n        expr.no.accept(this);\n        this.text += ')';\n    }\n    visitAssign(expr) {\n        this.text += '(';\n        expr.target.accept(this);\n        this.text += '=';\n        expr.value.accept(this);\n        this.text += ')';\n    }\n    visitValueConverter(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `|${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitBindingBehavior(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `&${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitArrayBindingPattern(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectBindingPattern(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitBindingIdentifier(expr) {\n        this.text += expr.name;\n    }\n    visitHtmlLiteral(expr) { throw new Error('visitHtmlLiteral'); }\n    visitForOfStatement(expr) {\n        expr.declaration.accept(this);\n        this.text += ' of ';\n        expr.iterable.accept(this);\n    }\n    visitInterpolation(expr) {\n        const { parts, expressions } = expr;\n        const length = expressions.length;\n        this.text += '${';\n        this.text += parts[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += parts[i + 1];\n        }\n        this.text += '}';\n    }\n    writeArgs(args) {\n        this.text += '(';\n        for (let i = 0, length = args.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            args[i].accept(this);\n        }\n        this.text += ')';\n    }\n}\nexport class Serializer {\n    static serialize(expr) {\n        const visitor = new Serializer();\n        if (expr == null || typeof expr.accept !== 'function') {\n            return `${expr}`;\n        }\n        return expr.accept(visitor);\n    }\n    visitAccessMember(expr) {\n        return `{\"type\":\"AccessMemberExpression\",\"name\":${expr.name},\"object\":${expr.object.accept(this)}}`;\n    }\n    visitAccessKeyed(expr) {\n        return `{\"type\":\"AccessKeyedExpression\",\"object\":${expr.object.accept(this)},\"key\":${expr.key.accept(this)}}`;\n    }\n    visitAccessThis(expr) {\n        return `{\"type\":\"AccessThisExpression\",\"ancestor\":${expr.ancestor}}`;\n    }\n    visitAccessScope(expr) {\n        return `{\"type\":\"AccessScopeExpression\",\"name\":\"${expr.name}\",\"ancestor\":${expr.ancestor}}`;\n    }\n    visitArrayLiteral(expr) {\n        return `{\"type\":\"ArrayLiteralExpression\",\"elements\":${this.serializeExpressions(expr.elements)}}`;\n    }\n    visitObjectLiteral(expr) {\n        return `{\"type\":\"ObjectLiteralExpression\",\"keys\":${serializePrimitives(expr.keys)},\"values\":${this.serializeExpressions(expr.values)}}`;\n    }\n    visitPrimitiveLiteral(expr) {\n        return `{\"type\":\"PrimitiveLiteralExpression\",\"value\":${serializePrimitive(expr.value)}}`;\n    }\n    visitCallFunction(expr) {\n        return `{\"type\":\"CallFunctionExpression\",\"func\":${expr.func.accept(this)},\"args\":${this.serializeExpressions(expr.args)}}`;\n    }\n    visitCallMember(expr) {\n        return `{\"type\":\"CallMemberExpression\",\"name\":\"${expr.name}\",\"object\":${expr.object.accept(this)},\"args\":${this.serializeExpressions(expr.args)}}`;\n    }\n    visitCallScope(expr) {\n        return `{\"type\":\"CallScopeExpression\",\"name\":\"${expr.name}\",\"ancestor\":${expr.ancestor},\"args\":${this.serializeExpressions(expr.args)}}`;\n    }\n    visitTemplate(expr) {\n        return `{\"type\":\"TemplateExpression\",\"cooked\":${serializePrimitives(expr.cooked)},\"expressions\":${this.serializeExpressions(expr.expressions)}}`;\n    }\n    visitTaggedTemplate(expr) {\n        return `{\"type\":\"TaggedTemplateExpression\",\"cooked\":${serializePrimitives(expr.cooked)},\"raw\":${serializePrimitives(expr.cooked.raw)},\"expressions\":${this.serializeExpressions(expr.expressions)}}`;\n    }\n    visitUnary(expr) {\n        return `{\"type\":\"UnaryExpression\",\"operation\":\"${expr.operation}\",\"expression\":${expr.expression.accept(this)}}`;\n    }\n    visitBinary(expr) {\n        return `{\"type\":\"BinaryExpression\",\"operation\":\"${expr.operation}\",\"left\":${expr.left.accept(this)},\"right\":${expr.right.accept(this)}}`;\n    }\n    visitConditional(expr) {\n        return `{\"type\":\"ConditionalExpression\",\"condition\":${expr.condition.accept(this)},\"yes\":${expr.yes.accept(this)},\"no\":${expr.no.accept(this)}}`;\n    }\n    visitAssign(expr) {\n        return `{\"type\":\"AssignExpression\",\"target\":${expr.target.accept(this)},\"value\":${expr.value.accept(this)}}`;\n    }\n    visitValueConverter(expr) {\n        return `{\"type\":\"ValueConverterExpression\",\"name\":\"${expr.name}\",\"expression\":${expr.expression.accept(this)},\"args\":${this.serializeExpressions(expr.args)}}`;\n    }\n    visitBindingBehavior(expr) {\n        return `{\"type\":\"BindingBehaviorExpression\",\"name\":\"${expr.name}\",\"expression\":${expr.expression.accept(this)},\"args\":${this.serializeExpressions(expr.args)}}`;\n    }\n    visitArrayBindingPattern(expr) {\n        return `{\"type\":\"ArrayBindingPattern\",\"elements\":${this.serializeExpressions(expr.elements)}}`;\n    }\n    visitObjectBindingPattern(expr) {\n        return `{\"type\":\"ObjectBindingPattern\",\"keys\":${serializePrimitives(expr.keys)},\"values\":${this.serializeExpressions(expr.values)}}`;\n    }\n    visitBindingIdentifier(expr) {\n        return `{\"type\":\"BindingIdentifier\",\"name\":\"${expr.name}\"}`;\n    }\n    visitHtmlLiteral(expr) { throw new Error('visitHtmlLiteral'); }\n    visitForOfStatement(expr) {\n        return `{\"type\":\"ForOfStatement\",\"declaration\":${expr.declaration.accept(this)},\"iterable\":${expr.iterable.accept(this)}}`;\n    }\n    visitInterpolation(expr) {\n        return `{\"type\":\"Interpolation\",\"cooked\":${serializePrimitives(expr.parts)},\"expressions\":${this.serializeExpressions(expr.expressions)}}`;\n    }\n    serializeExpressions(args) {\n        let text = '[';\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            if (i !== 0) {\n                text += ',';\n            }\n            text += args[i].accept(this);\n        }\n        text += ']';\n        return text;\n    }\n}\nfunction serializePrimitives(values) {\n    let text = '[';\n    for (let i = 0, ii = values.length; i < ii; ++i) {\n        if (i !== 0) {\n            text += ',';\n        }\n        text += serializePrimitive(values[i]);\n    }\n    text += ']';\n    return text;\n}\nfunction serializePrimitive(value) {\n    if (typeof value === 'string') {\n        return `\"\\\\\"${escapeString(value)}\\\\\"\"`;\n    }\n    else if (value == null) {\n        return `\"${value}\"`;\n    }\n    else {\n        return `${value}`;\n    }\n}\nfunction escapeString(str) {\n    let ret = '';\n    for (let i = 0, ii = str.length; i < ii; ++i) {\n        ret += escape(str.charAt(i));\n    }\n    return ret;\n}\nfunction escape(ch) {\n    switch (ch) {\n        case '\\b': return '\\\\b';\n        case '\\t': return '\\\\t';\n        case '\\n': return '\\\\n';\n        case '\\v': return '\\\\v';\n        case '\\f': return '\\\\f';\n        case '\\r': return '\\\\r';\n        case '\"': return '\\\\\"';\n        case '\\'': return '\\\\\\'';\n        case '\\\\': return '\\\\\\\\';\n        default: return ch;\n    }\n}\n//# sourceMappingURL=unparser.js.map","import { Reporter as RuntimeReporter } from '@aurelia/kernel';\nfunction applyFormat(message, ...params) {\n    while (message.includes('%s')) {\n        message = message.replace('%s', String(params.shift()));\n    }\n    return message;\n}\nexport const Reporter = {\n    ...RuntimeReporter,\n    get level() {\n        return RuntimeReporter.level;\n    },\n    write(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const message = `Code ${code}: ${info.message}`;\n        switch (info.level) {\n            case 1 /* debug */:\n                if (this.level <= 1 /* debug */) {\n                    console.debug(message, ...params);\n                }\n                break;\n            case 2 /* info */:\n                if (this.level <= 2 /* info */) {\n                    console.info(message, ...params);\n                }\n                break;\n            case 3 /* warn */:\n                if (this.level <= 3 /* warn */) {\n                    console.warn(message, ...params);\n                }\n                break;\n            case 4 /* error */: {\n                throw this.error(code, ...params);\n            }\n        }\n    },\n    error(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const error = new Error(`Code ${code}: ${applyFormat(info.message, ...params)}`);\n        error.data = params;\n        return error;\n    }\n};\nfunction getMessageInfoForCode(code) {\n    const info = codeLookup[code];\n    return info !== undefined ? info : createInvalidCodeMessageInfo(code);\n}\nfunction createInvalidCodeMessageInfo(code) {\n    return {\n        level: 4 /* error */,\n        message: `Attempted to report with unknown code ${code}.`\n    };\n}\nconst codeLookup = {\n    0: {\n        level: 3 /* warn */,\n        message: 'Cannot add observers to object.'\n    },\n    1: {\n        level: 3 /* warn */,\n        message: 'Cannot observe property of object.'\n    },\n    2: {\n        level: 2 /* info */,\n        message: 'Starting application in debug mode.'\n    },\n    3: {\n        level: 4 /* error */,\n        message: 'Runtime expression compilation is only available when including JIT support.'\n    },\n    4: {\n        level: 4 /* error */,\n        message: 'Invalid animation direction.'\n    },\n    5: {\n        level: 4 /* error */,\n        message: 'key/value cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    6: {\n        level: 4 /* error */,\n        message: 'Invalid resolver strategy specified.'\n    },\n    7: {\n        level: 4 /* error */,\n        message: 'Constructor Parameter with index cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    8: {\n        level: 4 /* error */,\n        message: 'Self binding behavior only supports events.'\n    },\n    9: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">'\n    },\n    10: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.'\n    },\n    11: {\n        level: 4 /* error */,\n        message: 'Only property bindings and string interpolation bindings can be signaled. Trigger, delegate and call bindings cannot be signaled.'\n    },\n    12: {\n        level: 4 /* error */,\n        message: 'Signal name is required.'\n    },\n    14: {\n        level: 4 /* error */,\n        message: 'Property cannot be assigned.'\n    },\n    15: {\n        level: 4 /* error */,\n        message: 'Unexpected call context.'\n    },\n    16: {\n        level: 4 /* error */,\n        message: 'A dependency registration is missing for the interface %s.'\n    },\n    17: {\n        level: 4 /* error */,\n        message: 'You can only define one default implementation for an interface.'\n    },\n    18: {\n        level: 4 /* error */,\n        message: 'You cannot observe a setter only property.'\n    },\n    19: {\n        level: 4 /* error */,\n        message: 'Value for expression is non-repeatable.'\n    },\n    20: {\n        level: 4 /* error */,\n        message: 'No template compiler found with the specified name. JIT support or a custom compiler is required.'\n    },\n    21: {\n        level: 4 /* error */,\n        message: 'You cannot combine the containerless custom element option with Shadow DOM.'\n    },\n    22: {\n        level: 4 /* error */,\n        message: 'A containerless custom element cannot be the root component of an application.'\n    },\n    30: {\n        level: 4 /* error */,\n        message: 'There are more targets than there are target instructions.'\n    },\n    31: {\n        level: 4 /* error */,\n        message: 'There are more target instructions than there are targets.'\n    },\n    100: {\n        level: 4 /* error */,\n        message: 'Invalid start of expression.'\n    },\n    101: {\n        level: 4 /* error */,\n        message: 'Unconsumed token.'\n    },\n    102: {\n        level: 4 /* error */,\n        message: 'Double dot and spread operators are not supported.'\n    },\n    103: {\n        level: 4 /* error */,\n        message: 'Invalid member expression.'\n    },\n    104: {\n        level: 4 /* error */,\n        message: 'Unexpected end of expression.'\n    },\n    105: {\n        level: 4 /* error */,\n        message: 'Expected identifier.'\n    },\n    106: {\n        level: 4 /* error */,\n        message: 'Invalid BindingIdentifier at left hand side of \"of\".'\n    },\n    107: {\n        level: 4 /* error */,\n        message: 'Invalid or unsupported property definition in object literal.'\n    },\n    108: {\n        level: 4 /* error */,\n        message: 'Unterminated quote in string literal.'\n    },\n    109: {\n        level: 4 /* error */,\n        message: 'Unterminated template string.'\n    },\n    110: {\n        level: 4 /* error */,\n        message: 'Missing expected token.'\n    },\n    111: {\n        level: 4 /* error */,\n        message: 'Unexpected character.'\n    },\n    150: {\n        level: 4 /* error */,\n        message: 'Left hand side of expression is not assignable.'\n    },\n    151: {\n        level: 4 /* error */,\n        message: 'Unexpected keyword \"of\"'\n    },\n    401: {\n        level: 3 /* warn */,\n        message: `AttributePattern is missing a handler for '%s'.`\n    },\n    402: {\n        level: 3 /* warn */,\n        message: `AttributePattern handler for '%s' is not a function.`\n    },\n    800: {\n        level: 4 /* error */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    801: {\n        level: 3 /* warn */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    2000: {\n        level: 4 /* error */,\n        message: 'Router has not been activated.'\n    },\n    2001: {\n        level: 4 /* error */,\n        message: 'Router has already been activated.'\n    },\n    2002: {\n        level: 4 /* error */,\n        message: 'Failed to resolve all viewports.'\n    },\n    2003: {\n        level: 4 /* error */,\n        message: 'Browser navigation has already been activated.'\n    },\n    2004: {\n        level: 4 /* error */,\n        message: 'LinkHandler has already been activated.'\n    },\n    1001: {\n        level: 2 /* info */,\n        message: 'DOM already initialized. Destroying and re-initializing..'\n    },\n    10000: {\n        level: 1 /* debug */,\n        message: '%s'\n    }\n};\n//# sourceMappingURL=reporter.js.map","import { PLATFORM, Reporter, Tracer } from '@aurelia/kernel';\nconst marker = {\n    objName: 'marker',\n    methodName: 'noop',\n    params: PLATFORM.emptyArray,\n    depth: -1,\n    prev: null,\n    next: null\n};\nclass TraceInfo {\n    constructor(objName, methodName, params) {\n        this.objName = objName;\n        this.methodName = methodName;\n        this.params = params;\n        this.objName = objName;\n        this.methodName = methodName;\n        this.depth = TraceInfo.stack.length;\n        this.params = params;\n        this.next = marker;\n        this.prev = TraceInfo.tail;\n        TraceInfo.tail.next = this;\n        TraceInfo.tail = this;\n        TraceInfo.stack.push(this);\n    }\n    static reset() {\n        let current = TraceInfo.head;\n        let next = null;\n        while (current != null) {\n            next = current.next;\n            current.next = null;\n            current.prev = null;\n            current.params = null;\n            current = next;\n        }\n        TraceInfo.head = marker;\n        TraceInfo.tail = marker;\n        TraceInfo.stack = [];\n    }\n    static enter(objName, methodName, params) {\n        return new TraceInfo(objName, methodName, params);\n    }\n    static leave() {\n        return TraceInfo.stack.pop();\n    }\n}\nTraceInfo.head = marker;\nTraceInfo.tail = marker;\nTraceInfo.stack = [];\nexport const DebugTracer = {\n    ...Tracer,\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) {\n        if (this.enabled) {\n            const info = TraceInfo.enter(objName, methodName, args);\n            if (this.liveLoggingEnabled) {\n                this.liveWriter.write(info);\n            }\n        }\n    },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() {\n        if (this.enabled) {\n            TraceInfo.leave();\n        }\n    },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) {\n        let i = 0;\n        const stack = TraceInfo.stack;\n        const len = stack.length;\n        while (i < len) {\n            writer.write(stack[i]);\n            ++i;\n        }\n    },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) {\n        if (writer != null) {\n            let current = TraceInfo.head.next; // skip the marker\n            while (current != null && current !== marker) {\n                writer.write(current);\n                current = current.next;\n            }\n        }\n        TraceInfo.reset();\n    },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() {\n        this.liveLoggingEnabled = false;\n        this.liveWriter = null;\n    }\n};\nconst defaultOptions = {\n    rendering: true,\n    binding: true,\n    observation: true,\n    beforeAttach: true,\n    mounting: true,\n    di: true,\n    lifecycle: true,\n    jit: true\n};\nfunction enableLiveLogging(optionsOrWriter) {\n    this.liveLoggingEnabled = true;\n    if (optionsOrWriter && 'write' in optionsOrWriter) {\n        this.liveWriter = optionsOrWriter;\n    }\n    else {\n        const options = optionsOrWriter !== undefined ? optionsOrWriter : defaultOptions;\n        this.liveWriter = createLiveTraceWriter(options);\n    }\n}\nconst toString = Object.prototype.toString;\nfunction flagsText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return stringifyLifecycleFlags(info.params[i]);\n    }\n    return 'none';\n}\nfunction _ctorName(obj) {\n    let name;\n    if (obj === undefined) {\n        name = 'undefined';\n    }\n    else if (obj === null) {\n        name = 'null';\n    }\n    else if (obj.constructor !== undefined) {\n        if (obj.constructor.description) {\n            name = `Resource{'${obj.constructor.description.name}'}`;\n        }\n        else {\n            name = obj.constructor.name;\n        }\n    }\n    else if (typeof obj === 'string') {\n        name = `'${obj}'`;\n    }\n    else {\n        name = toString.call(obj);\n    }\n    return name;\n}\nfunction ctorName(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return _ctorName(info.params[i]);\n    }\n    return 'undefined';\n}\nfunction scopeText(info, i = 0) {\n    let $ctorName;\n    if (info.params != null && info.params.length > i) {\n        const $scope = info.params[i];\n        if ($scope != null && $scope.bindingContext != null) {\n            $ctorName = _ctorName($scope.bindingContext);\n        }\n        else {\n            $ctorName = 'undefined';\n        }\n        return `Scope{${$ctorName}}`;\n    }\n    return 'undefined';\n}\nfunction keyText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        if ($key !== undefined && Reflect.has($key, 'friendlyName')) {\n            return $key['friendlyName'];\n        }\n        return _ctorName($key);\n    }\n    return 'undefined';\n}\nfunction primitive(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        return $key.toString();\n    }\n    return 'undefined';\n}\nconst RenderingArgsProcessor = {\n    $hydrate(info) {\n        return flagsText(info);\n    },\n    render(info) {\n        return `${flagsText(info)},IDOM,IContainer,${ctorName(info, 3)}`;\n    },\n    addBinding(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    },\n    addComponent(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    }\n};\nconst BindingArgsProcessor = {\n    $bind(info) {\n        return flagsText(info);\n    },\n    $unbind(info) {\n        return flagsText(info);\n    },\n    connect(info) {\n        return flagsText(info);\n    },\n    // currently only observers trace constructor calls but keep an eye on this if others are added, then we'd need additional filtering\n    constructor(info) {\n        switch (info.objName) {\n            case 'ArrayObserver':\n            case 'MapObserver':\n            case 'SetObserver':\n                return flagsText(info);\n            case 'SetterObserver':\n            case 'BindableObserver':\n                return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'ProxyObserver':\n                return ctorName(info);\n            case 'ProxySubscriberCollection':\n            case 'DirtyCheckProperty':\n                return `${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'PrimitiveObserver':\n            case 'PropertyAccessor':\n                return `${ctorName(info)},${primitive(info, 1)}`;\n            default:\n                return '';\n        }\n    },\n    lockedBind(info) {\n        return flagsText(info);\n    },\n    lockedUnbind(info) {\n        return flagsText(info);\n    },\n    InternalObserversLookup(info) {\n        return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n    },\n    BindingContext(info) {\n        switch (info.methodName) {\n            case 'get':\n                return `${scopeText(info)},${primitive(info, 1)},${primitive(info, 2)},${flagsText(info, 3)}`;\n            case 'getObservers':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    Scope(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'fromOverride':\n                return `${flagsText(info)},${ctorName(info, 1)}`;\n            case 'fromParent':\n                return `${flagsText(info)},${scopeText(info, 1)},${ctorName(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    },\n    OverrideContext(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'getObservers':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst ObservationArgsProcessor = {\n    callSource(info) {\n        const names = [];\n        switch (info.objName) {\n            case 'Listener':\n                return (info.params[0]).type;\n            case 'CallBinding':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(ctorName(info, i));\n                    }\n                }\n                return names.join(',');\n            default:\n                return 'unknown';\n        }\n    },\n    setValue(info) {\n        let valueText;\n        const value = info.params[0];\n        switch (typeof value) {\n            case 'undefined':\n                valueText = 'undefined';\n                break;\n            case 'object':\n                if (value === null) {\n                    valueText = 'null';\n                }\n                else {\n                    valueText = _ctorName(value);\n                }\n                break;\n            case 'string':\n                valueText = `'${value}'`;\n                break;\n            case 'number':\n                valueText = value.toString();\n                break;\n            default:\n                valueText = _ctorName(value);\n        }\n        return `${valueText},${flagsText(info, 1)}`;\n    },\n    flush(info) {\n        return flagsText(info);\n    },\n    handleChange(info) {\n        return `${primitive(info)},${primitive(info, 1)},${flagsText(info, 2)}`;\n    },\n    lockScope(info) {\n        return scopeText(info);\n    }\n};\nconst AttachingArgsProcessor = {\n    $attach(info) {\n        return flagsText(info);\n    },\n    $detach(info) {\n        return flagsText(info);\n    },\n    $cache(info) {\n        return flagsText(info);\n    },\n    hold(info) {\n        return `Node{'${(info.params[0]).textContent}'}`;\n    },\n    release(info) {\n        return flagsText(info);\n    }\n};\nconst MountingArgsProcessor = {\n    $mount(info) {\n        return flagsText(info);\n    },\n    $unmount(info) {\n        return flagsText(info);\n    },\n    project(info) {\n        return ctorName(info);\n    },\n    take(info) {\n        return ctorName(info);\n    }\n};\nconst DIArgsProcessor = {\n    construct(info) {\n        return ctorName(info);\n    },\n    Container(info) {\n        const names = [];\n        switch (info.methodName) {\n            case 'get':\n            case 'getAll':\n                return keyText(info);\n            case 'register':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(keyText(info, i));\n                    }\n                }\n                return names.join(',');\n            case 'createChild':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst LifecycleArgsProcessor = {\n    Lifecycle(info) {\n        switch (info.methodName.slice(0, 3)) {\n            case 'beg':\n                return '';\n            case 'enq':\n                return ctorName(info);\n            case 'end':\n            case 'pro':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    CompositionCoordinator(info) {\n        switch (info.methodName) {\n            case 'enqueue':\n                return 'IController';\n            case 'swap':\n                return `IController,${flagsText(info, 1)}`;\n            case 'processNext':\n                return '';\n            default:\n                return 'unknown';\n        }\n    },\n    AggregateLifecycleTask(info) {\n        switch (info.methodName) {\n            case 'addTask':\n            case 'removeTask':\n                return ctorName(info);\n            case 'complete':\n                return `${primitive(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst JitArgsProcessor = {\n    TemplateBinder(info) {\n        return ''; // TODO\n    }\n};\nfunction createLiveTraceWriter(options) {\n    const Processors = {};\n    if (options.rendering) {\n        Object.assign(Processors, RenderingArgsProcessor);\n    }\n    if (options.binding) {\n        Object.assign(Processors, BindingArgsProcessor);\n    }\n    if (options.observation) {\n        Object.assign(Processors, ObservationArgsProcessor);\n    }\n    if (options.beforeAttach) {\n        Object.assign(Processors, AttachingArgsProcessor);\n    }\n    if (options.mounting) {\n        Object.assign(Processors, MountingArgsProcessor);\n    }\n    if (options.di) {\n        Object.assign(Processors, DIArgsProcessor);\n    }\n    if (options.lifecycle) {\n        Object.assign(Processors, LifecycleArgsProcessor);\n    }\n    if (options.jit) {\n        Object.assign(Processors, JitArgsProcessor);\n    }\n    return {\n        write(info) {\n            let output;\n            if (Processors[info.methodName] !== undefined) {\n                output = Processors[info.methodName](info);\n            }\n            else if (Processors[info.objName] !== undefined) {\n                output = Processors[info.objName](info);\n            }\n            else {\n                return;\n            }\n            Reporter.write(10000, `${'-'.repeat(info.depth)}${info.objName}.${info.methodName}(${output})`);\n        }\n    };\n}\nexport function stringifyLifecycleFlags(flags) {\n    const flagNames = [];\n    if (flags & 2097152 /* mustEvaluate */) {\n        flagNames.push('mustEvaluate');\n    }\n    if (flags & 16777216 /* isCollectionMutation */) {\n        flagNames.push('isCollectionMutation');\n    }\n    if (flags & 16 /* updateTargetInstance */) {\n        flagNames.push('updateTargetInstance');\n    }\n    if (flags & 32 /* updateSourceExpression */) {\n        flagNames.push('updateSourceExpression');\n    }\n    if (flags & 64 /* fromAsyncFlush */) {\n        flagNames.push('fromAsyncFlush');\n    }\n    if (flags & 128 /* fromSyncFlush */) {\n        flagNames.push('fromSyncFlush');\n    }\n    if (flags & 256 /* fromTick */) {\n        flagNames.push('fromTick');\n    }\n    if (flags & 1024 /* fromStartTask */) {\n        flagNames.push('fromStartTask');\n    }\n    if (flags & 2048 /* fromStopTask */) {\n        flagNames.push('fromStopTask');\n    }\n    if (flags & 4096 /* fromBind */) {\n        flagNames.push('fromBind');\n    }\n    if (flags & 8192 /* fromUnbind */) {\n        flagNames.push('fromUnbind');\n    }\n    if (flags & 16384 /* fromAttach */) {\n        flagNames.push('fromAttach');\n    }\n    if (flags & 32768 /* fromDetach */) {\n        flagNames.push('fromDetach');\n    }\n    if (flags & 65536 /* fromCache */) {\n        flagNames.push('fromCache');\n    }\n    if (flags & 131072 /* fromDOMEvent */) {\n        flagNames.push('fromDOMEvent');\n    }\n    if (flags & 262144 /* fromLifecycleTask */) {\n        flagNames.push('fromLifecycleTask');\n    }\n    if (flags & 4194304 /* isTraversingParentScope */) {\n        flagNames.push('isTraversingParentScope');\n    }\n    if (flags & 67108864 /* allowParentScopeTraversal */) {\n        flagNames.push('allowParentScopeTraversal');\n    }\n    if (flags & 1 /* getterSetterStrategy */) {\n        flagNames.push('getterSetterStrategy');\n    }\n    if (flags & 2 /* proxyStrategy */) {\n        flagNames.push('proxyStrategy');\n    }\n    if (flags & 1073741824 /* secondaryExpression */) {\n        flagNames.push('secondaryExpression');\n    }\n    if (flagNames.length === 0) {\n        return 'none';\n    }\n    return flagNames.join('|');\n}\n//# sourceMappingURL=tracer.js.map","import { DI } from '@aurelia/kernel';\nexport const IAttrSyntaxTransformer = DI\n    .createInterface('IAttrSyntaxTransformer')\n    .noDefault();\n//# sourceMappingURL=attribute-syntax-transformer.js.map","import { __decorate } from \"tslib\";\nimport { bindingCommand, getTarget, } from '@aurelia/jit';\nimport { RefBindingInstruction } from '@aurelia/runtime';\nimport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, TriggerBindingInstruction } from '@aurelia/runtime-html';\n/**\n * Trigger binding command. Compile attr with binding symbol with command `trigger` to `TriggerBindingInstruction`\n */\nlet TriggerBindingCommand = class TriggerBindingCommand {\n    constructor() {\n        this.bindingType = 4182 /* TriggerCommand */;\n    }\n    compile(binding) {\n        return new TriggerBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTriggerBindingCommand = __decorate([\n    bindingCommand('trigger')\n], TriggerBindingCommand);\nexport { TriggerBindingCommand };\n/**\n * Delegate binding command. Compile attr with binding symbol with command `delegate` to `DelegateBindingInstruction`\n */\nlet DelegateBindingCommand = class DelegateBindingCommand {\n    constructor() {\n        this.bindingType = 4184 /* DelegateCommand */;\n    }\n    compile(binding) {\n        return new DelegateBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nDelegateBindingCommand = __decorate([\n    bindingCommand('delegate')\n], DelegateBindingCommand);\nexport { DelegateBindingCommand };\n/**\n * Capture binding command. Compile attr with binding symbol with command `capture` to `CaptureBindingInstruction`\n */\nlet CaptureBindingCommand = class CaptureBindingCommand {\n    constructor() {\n        this.bindingType = 4183 /* CaptureCommand */;\n    }\n    compile(binding) {\n        return new CaptureBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nCaptureBindingCommand = __decorate([\n    bindingCommand('capture')\n], CaptureBindingCommand);\nexport { CaptureBindingCommand };\n/**\n * Attr binding command. Compile attr with binding symbol with command `attr` to `AttributeBindingInstruction`\n */\nlet AttrBindingCommand = class AttrBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        const target = getTarget(binding, false);\n        return new AttributeBindingInstruction(target, binding.expression, target);\n    }\n};\nAttrBindingCommand = __decorate([\n    bindingCommand('attr')\n], AttrBindingCommand);\nexport { AttrBindingCommand };\n/**\n * Style binding command. Compile attr with binding symbol with command `style` to `AttributeBindingInstruction`\n */\nlet StyleBindingCommand = class StyleBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('style', binding.expression, getTarget(binding, false));\n    }\n};\nStyleBindingCommand = __decorate([\n    bindingCommand('style')\n], StyleBindingCommand);\nexport { StyleBindingCommand };\n/**\n * Class binding command. Compile attr with binding symbol with command `class` to `AttributeBindingInstruction`\n */\nlet ClassBindingCommand = class ClassBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('class', binding.expression, getTarget(binding, false));\n    }\n};\nClassBindingCommand = __decorate([\n    bindingCommand('class')\n], ClassBindingCommand);\nexport { ClassBindingCommand };\n/**\n * Binding command to refer different targets (element, custom element/attribute view models, controller) afterAttach to an element\n */\nlet RefBindingCommand = class RefBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */ | 4096 /* IgnoreCustomAttr */;\n    }\n    compile(binding) {\n        return new RefBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nRefBindingCommand = __decorate([\n    bindingCommand('ref')\n], RefBindingCommand);\nexport { RefBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","import { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol as $CustomElementSymbol, LetElementSymbol as $LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol as $PlainElementSymbol, ReplacePartSymbol as $ReplacePartSymbol, TemplateControllerSymbol as $TemplateControllerSymbol, TextSymbol as $TextSymbol, } from '@aurelia/jit';\nexport const CustomElementSymbol = $CustomElementSymbol;\nexport const LetElementSymbol = $LetElementSymbol;\nexport const PlainElementSymbol = $PlainElementSymbol;\nexport const ReplacePartSymbol = $ReplacePartSymbol;\nexport const TemplateControllerSymbol = $TemplateControllerSymbol;\nexport const TextSymbol = $TextSymbol;\nexport { BindingSymbol, CustomAttributeSymbol, PlainAttributeSymbol, };\n//# sourceMappingURL=semantic-model.js.map","/* eslint-disable compat/compat */\nimport { BindableInfo, } from '@aurelia/jit';\nimport { camelCase, } from '@aurelia/kernel';\nimport { BindingMode } from '@aurelia/runtime';\nimport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, ReplacePartSymbol, TemplateControllerSymbol, TextSymbol, } from './semantic-model';\nconst invalidSurrogateAttribute = Object.assign(Object.create(null), {\n    'id': true,\n    'replace': true\n});\nconst attributesToIgnore = Object.assign(Object.create(null), {\n    'as-element': true,\n    'replace': true\n});\nfunction hasInlineBindings(rawValue) {\n    const len = rawValue.length;\n    let ch = 0;\n    for (let i = 0; i < len; ++i) {\n        ch = rawValue.charCodeAt(i);\n        if (ch === 92 /* Backslash */) {\n            ++i;\n            // Ignore whatever comes next because it's escaped\n        }\n        else if (ch === 58 /* Colon */) {\n            return true;\n        }\n        else if (ch === 36 /* Dollar */ && rawValue.charCodeAt(i + 1) === 123 /* OpenBrace */) {\n            return false;\n        }\n    }\n    return false;\n}\nfunction processInterpolationText(symbol) {\n    const node = symbol.physicalNode;\n    const parentNode = node.parentNode;\n    while (node.nextSibling !== null && node.nextSibling.nodeType === 3 /* Text */) {\n        parentNode.removeChild(node.nextSibling);\n    }\n    node.textContent = '';\n    parentNode.insertBefore(symbol.marker, node);\n}\nfunction isTemplateControllerOf(proxy, manifest) {\n    return proxy !== manifest;\n}\n/**\n * A (temporary) standalone function that purely does the DOM processing (lifting) related to template controllers.\n * It's a first refactoring step towards separating DOM parsing/binding from mutations.\n */\nfunction processTemplateControllers(dom, manifestProxy, manifest) {\n    const manifestNode = manifest.physicalNode;\n    let current = manifestProxy;\n    let currentTemplate;\n    while (isTemplateControllerOf(current, manifest)) {\n        if (current.template === manifest) {\n            // the DOM linkage is still in its original state here so we can safely assume the parentNode is non-null\n            manifestNode.parentNode.replaceChild(current.marker, manifestNode);\n            // if the manifest is a template element (e.g. <template repeat.for=\"...\">) then we can skip one lift operation\n            // and simply use the template directly, saving a bit of work\n            if (manifestNode.nodeName === 'TEMPLATE') {\n                current.physicalNode = manifestNode;\n                // the template could safely stay without affecting anything visible, but let's keep the DOM tidy\n                manifestNode.remove();\n            }\n            else {\n                // the manifest is not a template element so we need to wrap it in one\n                currentTemplate = current.physicalNode = dom.createTemplate();\n                currentTemplate.content.appendChild(manifestNode);\n            }\n        }\n        else {\n            currentTemplate = current.physicalNode = dom.createTemplate();\n            currentTemplate.content.appendChild(current.marker);\n        }\n        manifestNode.removeAttribute(current.syntax.rawName);\n        current = current.template;\n    }\n}\nfunction processReplacePart(dom, replacePart, manifestProxy) {\n    let proxyNode;\n    let currentTemplate;\n    if ((manifestProxy.flags & 512 /* hasMarker */) > 0) {\n        proxyNode = manifestProxy.marker;\n    }\n    else {\n        proxyNode = manifestProxy.physicalNode;\n    }\n    if (proxyNode.nodeName === 'TEMPLATE') {\n        // if it's a template element, no need to do anything special, just assign it to the replacePart\n        replacePart.physicalNode = proxyNode;\n    }\n    else {\n        // otherwise wrap the replace in a template\n        currentTemplate = replacePart.physicalNode = dom.createTemplate();\n        currentTemplate.content.appendChild(proxyNode);\n    }\n}\n/**\n * TemplateBinder. Todo: describe goal of this class\n */\nexport class TemplateBinder {\n    constructor(dom, resources, attrParser, exprParser, attrSyntaxTransformer) {\n        this.dom = dom;\n        this.resources = resources;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxTransformer = attrSyntaxTransformer;\n    }\n    bind(node) {\n        const surrogate = new PlainElementSymbol(this.dom, node);\n        const resources = this.resources;\n        const attrSyntaxTransformer = this.attrSyntaxTransformer;\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            if (invalidSurrogateAttribute[attrSyntax.target] === true) {\n                throw new Error(`Invalid surrogate attribute: ${attrSyntax.target}`);\n                // TODO: use reporter\n            }\n            const bindingCommand = resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ surrogate);\n                }\n                else if (attrInfo.isTemplateController) {\n                    throw new Error('Cannot have template controller on surrogate element.');\n                    // TODO: use reporter\n                }\n                else {\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ surrogate);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ surrogate);\n            }\n            ++i;\n        }\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ surrogate, \n        /* manifestRoot       */ null, \n        /* parentManifestRoot */ null, \n        /* partName           */ null);\n        return surrogate;\n    }\n    bindManifest(parentManifest, node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        switch (node.nodeName) {\n            case 'LET':\n                // let cannot have children and has some different processing rules, so return early\n                this.bindLetElement(\n                /* parentManifest */ parentManifest, \n                /* node           */ node);\n                return;\n            case 'SLOT':\n                surrogate.hasSlots = true;\n        }\n        // get the part name to override the name of the compiled definition\n        partName = node.getAttribute('replaceable');\n        if (partName === '') {\n            partName = 'default';\n        }\n        let name = node.getAttribute('as-element');\n        if (name === null) {\n            name = node.nodeName.toLowerCase();\n        }\n        const elementInfo = this.resources.getElementInfo(name);\n        if (elementInfo === null) {\n            // there is no registered custom element with this name\n            manifest = new PlainElementSymbol(this.dom, node);\n        }\n        else {\n            // it's a custom element so we set the manifestRoot as well (for storing replaces)\n            parentManifestRoot = manifestRoot;\n            manifestRoot = manifest = new CustomElementSymbol(this.dom, node, elementInfo);\n        }\n        // lifting operations done by template controllers and replaces effectively unlink the nodes, so start at the bottom\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        // the parentManifest will receive either the direct child nodes, or the template controllers / replaces\n        // wrapping them\n        this.bindAttributes(\n        /* node               */ node, \n        /* parentManifest     */ parentManifest, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        if (manifestRoot === manifest && manifest.isContainerless) {\n            node.parentNode.replaceChild(manifest.marker, node);\n        }\n        else if (manifest.isTarget) {\n            node.classList.add('au');\n        }\n    }\n    bindLetElement(parentManifest, node) {\n        const symbol = new LetElementSymbol(this.dom, node);\n        parentManifest.childNodes.push(symbol);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            if (attr.name === 'to-binding-context') {\n                node.removeAttribute('to-binding-context');\n                symbol.toBindingContext = true;\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const command = this.resources.getBindingCommand(attrSyntax, false);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrSyntax.rawValue, bindingType);\n            const to = camelCase(attrSyntax.target);\n            const info = new BindableInfo(to, BindingMode.toView);\n            symbol.bindings.push(new BindingSymbol(command, info, expr, attrSyntax.rawValue, to));\n            ++i;\n        }\n        node.parentNode.replaceChild(symbol.marker, node);\n    }\n    bindAttributes(node, parentManifest, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        // This is the top-level symbol for the current depth.\n        // If there are no template controllers or replaces, it is always the manifest itself.\n        // If there are template controllers, then this will be the outer-most TemplateControllerSymbol.\n        let manifestProxy = manifest;\n        let previousController = (void 0);\n        let currentController = (void 0);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            ++i;\n            if (attributesToIgnore[attr.name] === true) {\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const bindingCommand = this.resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = this.resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    this.attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ manifest);\n                }\n                else if (attrInfo.isTemplateController) {\n                    // the manifest is wrapped by the inner-most template controller (if there are multiple on the same element)\n                    // so keep setting manifest.templateController to the latest template controller we find\n                    currentController = manifest.templateController = this.declareTemplateController(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* partName   */ partName);\n                    // the proxy and the manifest are only identical when we're at the first template controller (since the controller\n                    // is assigned to the proxy), so this evaluates to true at most once per node\n                    if (manifestProxy === manifest) {\n                        currentController.template = manifest;\n                        manifestProxy = currentController;\n                    }\n                    else {\n                        currentController.templateController = previousController;\n                        currentController.template = previousController.template;\n                        previousController.template = currentController;\n                    }\n                    previousController = currentController;\n                }\n                else {\n                    // a regular custom attribute\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ manifest);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                this.attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ manifest);\n            }\n        }\n        if (node.tagName === 'INPUT') {\n            const type = node.type;\n            if (type === 'checkbox' || type === 'radio') {\n                this.ensureAttributeOrder(manifest);\n            }\n        }\n        processTemplateControllers(this.dom, manifestProxy, manifest);\n        let replace = node.getAttribute('replace');\n        if (replace === '' || (replace === null && manifestRoot !== null && manifestRoot.isContainerless && ((parentManifest.flags & 16 /* isCustomElement */) > 0))) {\n            replace = 'default';\n        }\n        const partOwner = manifest === manifestRoot ? parentManifestRoot : manifestRoot;\n        if (replace === null || partOwner === null) {\n            // the proxy is either the manifest itself or the outer-most controller; add it directly to the parent\n            parentManifest.childNodes.push(manifestProxy);\n        }\n        else {\n            // there is a replace attribute on this node, so add it to the parts collection of the manifestRoot\n            // instead of to the childNodes\n            const replacePart = new ReplacePartSymbol(replace);\n            replacePart.parent = parentManifest;\n            replacePart.template = manifestProxy;\n            partOwner.parts.push(replacePart);\n            if (parentManifest.templateController != null) {\n                parentManifest.templateController.parts.push(replacePart);\n            }\n            processReplacePart(this.dom, replacePart, manifestProxy);\n        }\n    }\n    // TODO: refactor to use render priority slots (this logic shouldn't be in the template binder)\n    ensureAttributeOrder(manifest) {\n        // swap the order of checked and model/value attribute, so that the required observers are prepared for checked-observer\n        const attributes = manifest.plainAttributes;\n        let modelOrValueIndex = void 0;\n        let checkedIndex = void 0;\n        let found = 0;\n        for (let i = 0; i < attributes.length && found < 3; i++) {\n            switch (attributes[i].syntax.target) {\n                case 'model':\n                case 'value':\n                case 'matcher':\n                    modelOrValueIndex = i;\n                    found++;\n                    break;\n                case 'checked':\n                    checkedIndex = i;\n                    found++;\n                    break;\n            }\n        }\n        if (checkedIndex !== void 0 && modelOrValueIndex !== void 0 && checkedIndex < modelOrValueIndex) {\n            [attributes[modelOrValueIndex], attributes[checkedIndex]] = [attributes[checkedIndex], attributes[modelOrValueIndex]];\n        }\n    }\n    bindChildNodes(node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        let childNode;\n        if (node.nodeName === 'TEMPLATE') {\n            childNode = node.content.firstChild;\n        }\n        else {\n            childNode = node.firstChild;\n        }\n        let nextChild;\n        while (childNode !== null) {\n            switch (childNode.nodeType) {\n                case 1 /* Element */:\n                    nextChild = childNode.nextSibling;\n                    this.bindManifest(\n                    /* parentManifest     */ manifest, \n                    /* node               */ childNode, \n                    /* surrogate          */ surrogate, \n                    /* manifest           */ manifest, \n                    /* manifestRoot       */ manifestRoot, \n                    /* parentManifestRoot */ parentManifestRoot, \n                    /* partName           */ partName);\n                    childNode = nextChild;\n                    break;\n                case 3 /* Text */:\n                    childNode = this.bindText(\n                    /* textNode */ childNode, \n                    /* manifest */ manifest).nextSibling;\n                    break;\n                case 4 /* CDATASection */:\n                case 7 /* ProcessingInstruction */:\n                case 8 /* Comment */:\n                case 10 /* DocumentType */:\n                    childNode = childNode.nextSibling;\n                    break;\n                case 9 /* Document */:\n                case 11 /* DocumentFragment */:\n                    childNode = childNode.firstChild;\n            }\n        }\n    }\n    bindText(textNode, manifest) {\n        const interpolation = this.exprParser.parse(textNode.wholeText, 2048 /* Interpolation */);\n        if (interpolation !== null) {\n            const symbol = new TextSymbol(this.dom, textNode, interpolation);\n            manifest.childNodes.push(symbol);\n            processInterpolationText(symbol);\n        }\n        let next = textNode;\n        while (next.nextSibling !== null && next.nextSibling.nodeType === 3 /* Text */) {\n            next = next.nextSibling;\n        }\n        return next;\n    }\n    declareTemplateController(attrSyntax, attrInfo, partName) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        // multi-bindings logic here is similar to (and explained in) bindCustomAttribute\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        return symbol;\n    }\n    bindCustomAttribute(attrSyntax, attrInfo, command, manifest) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax. Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            // a multiple-bindings attribute usage (semicolon separated binding) is only valid without a binding command;\n            // the binding commands must be declared in each of the property bindings\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        manifest.customAttributes.push(symbol);\n        manifest.isTarget = true;\n    }\n    bindMultiAttribute(symbol, attrInfo, value) {\n        const bindables = attrInfo.bindables;\n        const valueLength = value.length;\n        let attrName = void 0;\n        let attrValue = void 0;\n        let start = 0;\n        let ch = 0;\n        for (let i = 0; i < valueLength; ++i) {\n            ch = value.charCodeAt(i);\n            if (ch === 92 /* Backslash */) {\n                ++i;\n                // Ignore whatever comes next because it's escaped\n            }\n            else if (ch === 58 /* Colon */) {\n                attrName = value.slice(start, i);\n                // Skip whitespace after colon\n                while (value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                for (; i < valueLength; ++i) {\n                    ch = value.charCodeAt(i);\n                    if (ch === 92 /* Backslash */) {\n                        ++i;\n                        // Ignore whatever comes next because it's escaped\n                    }\n                    else if (ch === 59 /* Semicolon */) {\n                        attrValue = value.slice(start, i);\n                        break;\n                    }\n                }\n                if (attrValue === void 0) {\n                    // No semicolon found, so just grab the rest of the value\n                    attrValue = value.slice(start);\n                }\n                const attrSyntax = this.attrParser.parse(attrName, attrValue);\n                const attrTarget = camelCase(attrSyntax.target);\n                const command = this.resources.getBindingCommand(attrSyntax, false);\n                const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n                const expr = this.exprParser.parse(attrValue, bindingType);\n                let bindable = bindables[attrTarget];\n                if (bindable === undefined) {\n                    // everything in a multi-bindings expression must be used,\n                    // so if it's not a bindable then we create one on the spot\n                    bindable = bindables[attrTarget] = new BindableInfo(attrTarget, BindingMode.toView);\n                }\n                symbol.bindings.push(new BindingSymbol(command, bindable, expr, attrValue, attrTarget));\n                // Skip whitespace after semicolon\n                while (i < valueLength && value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                attrName = void 0;\n                attrValue = void 0;\n            }\n        }\n    }\n    bindPlainAttribute(attrSyntax, attr, surrogate, manifest) {\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n        const attrTarget = attrSyntax.target;\n        const attrRawValue = attrSyntax.rawValue;\n        let expr;\n        if (attrRawValue.length === 0\n            && (bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n            if ((bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n                // Default to the name of the attr for empty binding commands\n                expr = this.exprParser.parse(camelCase(attrTarget), bindingType);\n            }\n            else {\n                return;\n            }\n        }\n        else {\n            expr = this.exprParser.parse(attrRawValue, bindingType);\n        }\n        if ((manifest.flags & 16 /* isCustomElement */) > 0) {\n            const bindable = manifest.bindables[attrTarget];\n            if (bindable != null) {\n                // if the attribute name matches a bindable property name, add it regardless of whether it's a command, interpolation, or just a plain string;\n                // the template compiler will translate it to the correct instruction\n                manifest.bindings.push(new BindingSymbol(command, bindable, expr, attrRawValue, attrTarget));\n                manifest.isTarget = true;\n            }\n            else if (expr != null) {\n                // if it does not map to a bindable, only add it if we were able to parse an expression (either a command or interpolation)\n                manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n                manifest.isTarget = true;\n            }\n        }\n        else if (expr != null) {\n            // either a binding command, an interpolation, or a ref\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n            manifest.isTarget = true;\n        }\n        else if (manifest === surrogate) {\n            // any attributes, even if they are plain (no command/interpolation etc), should be added if they\n            // are on the surrogate element\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n        }\n        if (command == null && expr != null) {\n            // if it's an interpolation, clear the attribute value\n            attr.value = '';\n        }\n    }\n}\n//# sourceMappingURL=template-binder.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI, Registration } from '@aurelia/kernel';\nimport { IDOM } from '@aurelia/runtime';\n// For some reason rollup complains about `DI.createInterface<ITemplateElementFactory>().noDefault()` with this message:\n// \"semantic error TS2742 The inferred type of 'ITemplateElementFactory' cannot be named without a reference to '@aurelia/jit/node_modules/@aurelia/kernel'. This is likely not portable. A type annotation is necessary\"\n// So.. investigate why that happens (or rather, why it *only* happens here and not for the other 50)\nexport const ITemplateElementFactory = DI.createInterface('ITemplateElementFactory').noDefault();\nconst markupCache = {};\n/**\n * Default implementation for `ITemplateFactory` for use in an HTML based runtime.\n *\n * @internal\n */\nlet HTMLTemplateElementFactory = class HTMLTemplateElementFactory {\n    constructor(dom) {\n        this.dom = dom;\n        this.template = dom.createTemplate();\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateElementFactory, this).register(container);\n    }\n    createTemplate(input) {\n        if (typeof input === 'string') {\n            let result = markupCache[input];\n            if (result === void 0) {\n                const template = this.template;\n                template.innerHTML = input;\n                const node = template.content.firstElementChild;\n                // if the input is either not wrapped in a template or there is more than one node,\n                // return the whole template that wraps it/them (and create a new one for the next input)\n                if (node == null || node.nodeName !== 'TEMPLATE' || node.nextElementSibling != null) {\n                    this.template = this.dom.createTemplate();\n                    result = template;\n                }\n                else {\n                    // the node to return is both a template and the only node, so return just the node\n                    // and clean up the template for the next input\n                    template.content.removeChild(node);\n                    result = node;\n                }\n                markupCache[input] = result;\n            }\n            return result.cloneNode(true);\n        }\n        if (input.nodeName !== 'TEMPLATE') {\n            // if we get one node that is not a template, wrap it in one\n            const template = this.dom.createTemplate();\n            template.content.appendChild(input);\n            return template;\n        }\n        // we got a template element, remove it from the DOM if it's present there and don't\n        // do any other processing\n        if (input.parentNode != null) {\n            input.parentNode.removeChild(input);\n        }\n        return input;\n    }\n};\nHTMLTemplateElementFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [Object])\n], HTMLTemplateElementFactory);\nexport { HTMLTemplateElementFactory };\n//# sourceMappingURL=template-element-factory.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { IAttributeParser, ResourceModel, } from '@aurelia/jit';\nimport { mergeDistinct, PLATFORM, Registration, mergeArrays, } from '@aurelia/kernel';\nimport { HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, IExpressionParser, InterpolationInstruction, ITemplateCompiler, LetBindingInstruction, LetElementInstruction, SetPropertyInstruction, CustomElementDefinition, IDOM } from '@aurelia/runtime';\nimport { SetAttributeInstruction, TextBindingInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, } from '@aurelia/runtime-html';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nimport { TemplateBinder } from './template-binder';\nimport { ITemplateElementFactory } from './template-element-factory';\nclass CustomElementCompilationUnit {\n    constructor(partialDefinition, surrogate, template) {\n        this.partialDefinition = partialDefinition;\n        this.surrogate = surrogate;\n        this.template = template;\n        this.instructions = [];\n        this.surrogates = [];\n        this.scopeParts = [];\n        this.parts = {};\n    }\n    toDefinition() {\n        const def = this.partialDefinition;\n        return CustomElementDefinition.create({\n            ...def,\n            instructions: mergeArrays(def.instructions, this.instructions),\n            surrogates: mergeArrays(def.surrogates, this.surrogates),\n            scopeParts: mergeArrays(def.scopeParts, this.scopeParts),\n            template: this.template,\n            needsCompile: false,\n            hasSlots: this.surrogate.hasSlots,\n        });\n    }\n}\n/**\n * Default (runtime-agnostic) implementation for `ITemplateCompiler`.\n *\n * @internal\n */\nlet TemplateCompiler = class TemplateCompiler {\n    constructor(factory, attrParser, exprParser, attrSyntaxModifier) {\n        this.factory = factory;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxModifier = attrSyntaxModifier;\n    }\n    get name() {\n        return 'default';\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateCompiler, this).register(container);\n    }\n    compile(partialDefinition, context) {\n        const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n        if (definition.template === null || definition.template === void 0) {\n            return definition;\n        }\n        const resources = ResourceModel.getOrCreate(context);\n        const { attrParser, exprParser, attrSyntaxModifier, factory } = this;\n        const binder = new TemplateBinder(context.get(IDOM), resources, attrParser, exprParser, attrSyntaxModifier);\n        const template = factory.createTemplate(definition.template);\n        const surrogate = binder.bind(template);\n        const compilation = this.compilation = new CustomElementCompilationUnit(definition, surrogate, template);\n        const customAttributes = surrogate.customAttributes;\n        const plainAttributes = surrogate.plainAttributes;\n        const customAttributeLength = customAttributes.length;\n        const plainAttributeLength = plainAttributes.length;\n        if (customAttributeLength + plainAttributeLength > 0) {\n            let offset = 0;\n            for (let i = 0; customAttributeLength > i; ++i) {\n                compilation.surrogates[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; i < plainAttributeLength; ++i) {\n                compilation.surrogates[offset] = this.compilePlainAttribute(plainAttributes[i], true);\n                offset++;\n            }\n        }\n        this.compileChildNodes(surrogate, compilation.instructions, compilation.scopeParts);\n        const compiledDefinition = compilation.toDefinition();\n        this.compilation = null;\n        return compiledDefinition;\n    }\n    compileChildNodes(parent, instructionRows, scopeParts) {\n        if ((parent.flags & 8192 /* hasChildNodes */) > 0) {\n            const childNodes = parent.childNodes;\n            const ii = childNodes.length;\n            let childNode;\n            for (let i = 0; i < ii; ++i) {\n                childNode = childNodes[i];\n                if ((childNode.flags & 128 /* isText */) > 0) {\n                    instructionRows.push([new TextBindingInstruction(childNode.interpolation)]);\n                }\n                else if ((childNode.flags & 32 /* isLetElement */) > 0) {\n                    const bindings = childNode.bindings;\n                    const instructions = [];\n                    let binding;\n                    const jj = bindings.length;\n                    for (let j = 0; j < jj; ++j) {\n                        binding = bindings[j];\n                        instructions[j] = new LetBindingInstruction(binding.expression, binding.target);\n                    }\n                    instructionRows.push([new LetElementInstruction(instructions, childNode.toBindingContext)]);\n                }\n                else {\n                    this.compileParentNode(childNode, instructionRows, scopeParts);\n                }\n            }\n        }\n    }\n    compileCustomElement(symbol, instructionRows, scopeParts) {\n        // offset 1 to leave a spot for the hydrate instruction so we don't need to create 2 arrays with a spread etc\n        const instructionRow = this.compileAttributes(symbol, 1);\n        instructionRow[0] = new HydrateElementInstruction(symbol.res, this.compileBindings(symbol), this.compileParts(symbol, scopeParts));\n        instructionRows.push(instructionRow);\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compilePlainElement(symbol, instructionRows, scopeParts) {\n        const attributes = this.compileAttributes(symbol, 0);\n        if (attributes.length > 0) {\n            instructionRows.push(attributes);\n        }\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compileParentNode(symbol, instructionRows, scopeParts) {\n        switch (symbol.flags & 511 /* type */) {\n            case 16 /* isCustomElement */:\n                this.compileCustomElement(symbol, instructionRows, scopeParts);\n                break;\n            case 64 /* isPlainElement */:\n                this.compilePlainElement(symbol, instructionRows, scopeParts);\n                break;\n            case 1 /* isTemplateController */:\n                this.compileTemplateController(symbol, instructionRows, scopeParts);\n        }\n    }\n    compileTemplateController(symbol, instructionRows, scopeParts) {\n        const bindings = this.compileBindings(symbol);\n        const controllerInstructionRows = [];\n        const controllerScopeParts = [];\n        this.compileParentNode(symbol.template, controllerInstructionRows, controllerScopeParts);\n        mergeDistinct(scopeParts, controllerScopeParts, false);\n        const def = CustomElementDefinition.create({\n            name: symbol.partName === null ? symbol.res : symbol.partName,\n            scopeParts: controllerScopeParts,\n            template: symbol.physicalNode,\n            instructions: controllerInstructionRows,\n            needsCompile: false,\n        });\n        let parts = void 0;\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            parts = {};\n            for (const part of symbol.parts) {\n                parts[part.name] = this.compilation.parts[part.name];\n            }\n        }\n        instructionRows.push([new HydrateTemplateController(def, symbol.res, bindings, symbol.res === 'else', parts)]);\n    }\n    compileBindings(symbol) {\n        let bindingInstructions;\n        if ((symbol.flags & 4096 /* hasBindings */) > 0) {\n            // either a custom element with bindings, a custom attribute / template controller with dynamic options,\n            // or a single value custom attribute binding\n            const { bindings } = symbol;\n            const len = bindings.length;\n            bindingInstructions = Array(len);\n            let i = 0;\n            for (; i < len; ++i) {\n                bindingInstructions[i] = this.compileBinding(bindings[i]);\n            }\n        }\n        else {\n            bindingInstructions = PLATFORM.emptyArray;\n        }\n        return bindingInstructions;\n    }\n    compileBinding(symbol) {\n        if (symbol.command === null) {\n            // either an interpolation or a normal string value assigned to an element or attribute binding\n            if (symbol.expression === null) {\n                // the template binder already filtered out non-bindables, so we know we need a setProperty here\n                return new SetPropertyInstruction(symbol.rawValue, symbol.bindable.propName);\n            }\n            else {\n                // either an element binding interpolation or a dynamic options attribute binding interpolation\n                return new InterpolationInstruction(symbol.expression, symbol.bindable.propName);\n            }\n        }\n        else {\n            // either an element binding command, dynamic options attribute binding command,\n            // or custom attribute / template controller (single value) binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    compileAttributes(symbol, offset) {\n        let attributeInstructions;\n        if ((symbol.flags & 2048 /* hasAttributes */) > 0) {\n            // any attributes on a custom element (which are not bindables) or a plain element\n            const customAttributes = symbol.customAttributes;\n            const plainAttributes = symbol.plainAttributes;\n            const customAttributeLength = customAttributes.length;\n            const plainAttributesLength = plainAttributes.length;\n            attributeInstructions = Array(offset + customAttributeLength + plainAttributesLength);\n            for (let i = 0; customAttributeLength > i; ++i) {\n                attributeInstructions[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; plainAttributesLength > i; ++i) {\n                attributeInstructions[offset] = this.compilePlainAttribute(plainAttributes[i], false);\n                offset++;\n            }\n        }\n        else if (offset > 0) {\n            attributeInstructions = Array(offset);\n        }\n        else {\n            attributeInstructions = PLATFORM.emptyArray;\n        }\n        return attributeInstructions;\n    }\n    compileCustomAttribute(symbol) {\n        // a normal custom attribute (not template controller)\n        const bindings = this.compileBindings(symbol);\n        return new HydrateAttributeInstruction(symbol.res, bindings);\n    }\n    compilePlainAttribute(symbol, isOnSurrogate) {\n        if (symbol.command === null) {\n            const syntax = symbol.syntax;\n            if (symbol.expression === null) {\n                const attrRawValue = syntax.rawValue;\n                if (isOnSurrogate) {\n                    switch (syntax.target) {\n                        case 'class':\n                            return new SetClassAttributeInstruction(attrRawValue);\n                        case 'style':\n                            return new SetStyleAttributeInstruction(attrRawValue);\n                        // todo:  define how to merge other attribute peacefully\n                        //        this is an existing feature request\n                    }\n                }\n                // a plain attribute on a surrogate\n                return new SetAttributeInstruction(attrRawValue, syntax.target);\n            }\n            else {\n                // a plain attribute with an interpolation\n                return new InterpolationInstruction(symbol.expression, syntax.target);\n            }\n        }\n        else {\n            // a plain attribute with a binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    // private compileAttribute(symbol: IAttributeSymbol): HTMLAttributeInstruction {\n    //   // any attribute on a custom element (which is not a bindable) or a plain element\n    //   if (symbol.flags & SymbolFlags.isCustomAttribute) {\n    //     return this.compileCustomAttribute(symbol as CustomAttributeSymbol);\n    //   } else {\n    //     return this.compilePlainAttribute(symbol as PlainAttributeSymbol);\n    //   }\n    // }\n    compileParts(symbol, scopeParts) {\n        const parts = {};\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            const replaceParts = symbol.parts;\n            const len = replaceParts.length;\n            let s = scopeParts.length;\n            for (let i = 0; i < len; ++i) {\n                const replacePart = replaceParts[i];\n                if (!scopeParts.includes(replacePart.name)) {\n                    scopeParts[s++] = replacePart.name;\n                }\n                const partScopeParts = [];\n                const partInstructionRows = [];\n                this.compileParentNode(replacePart.template, partInstructionRows, partScopeParts);\n                // TODO: the assignment to `this.compilation.parts[replacePart.name]` might be the cause of replaceable bug reported by rluba\n                // need to verify this\n                this.compilation.parts[replacePart.name] = parts[replacePart.name] = CustomElementDefinition.create({\n                    name: replacePart.name,\n                    scopeParts: partScopeParts,\n                    template: replacePart.physicalNode,\n                    instructions: partInstructionRows,\n                    needsCompile: false,\n                });\n            }\n        }\n        return parts;\n    }\n};\nTemplateCompiler = __decorate([\n    __param(0, ITemplateElementFactory),\n    __param(1, IAttributeParser),\n    __param(2, IExpressionParser),\n    __param(3, IAttrSyntaxTransformer),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], TemplateCompiler);\nexport { TemplateCompiler };\n//# sourceMappingURL=template-compiler.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DI } from '@aurelia/kernel';\nimport { RuntimeHtmlConfiguration } from '@aurelia/runtime-html';\nimport { AttrBindingCommand, CaptureBindingCommand, ClassBindingCommand, DelegateBindingCommand, RefBindingCommand, StyleBindingCommand, TriggerBindingCommand } from './binding-commands';\nimport { HtmlAttrSyntaxTransformer } from './html-attribute-syntax-transformer';\nimport { TemplateCompiler } from './template-compiler';\nimport { HTMLTemplateElementFactory } from './template-element-factory';\nexport const ITemplateCompilerRegistration = TemplateCompiler;\nexport const ITemplateElementFactoryRegistration = HTMLTemplateElementFactory;\nexport const IAttrSyntaxTransformerRegistation = HtmlAttrSyntaxTransformer;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `ITemplateCompiler`\n * - `ITemplateElementFactory`\n */\nexport const DefaultComponents = [\n    ITemplateCompilerRegistration,\n    ITemplateElementFactoryRegistration,\n    IAttrSyntaxTransformerRegistation\n];\nexport const RefBindingCommandRegistration = RefBindingCommand;\nexport const TriggerBindingCommandRegistration = TriggerBindingCommand;\nexport const DelegateBindingCommandRegistration = DelegateBindingCommand;\nexport const CaptureBindingCommandRegistration = CaptureBindingCommand;\nexport const AttrBindingCommandRegistration = AttrBindingCommand;\nexport const ClassBindingCommandRegistration = ClassBindingCommand;\nexport const StyleBindingCommandRegistration = StyleBindingCommand;\n/**\n * Default HTML-specific (but environment-agnostic) binding commands:\n * - Event listeners: `.trigger`, `.delegate`, `.capture`\n */\nexport const DefaultBindingLanguage = [\n    RefBindingCommandRegistration,\n    TriggerBindingCommandRegistration,\n    DelegateBindingCommandRegistration,\n    CaptureBindingCommandRegistration,\n    ClassBindingCommandRegistration,\n    StyleBindingCommandRegistration,\n    AttrBindingCommandRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents`\n * - `DefaultBindingLanguage`\n */\nexport const JitHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...JitDefaultComponents, ...JitDefaultBindingSyntax, ...JitDefaultBindingLanguage, ...DefaultComponents, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { Registration } from '@aurelia/kernel';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nexport class HtmlAttrSyntaxTransformer {\n    static register(container) {\n        return Registration.singleton(IAttrSyntaxTransformer, this).register(container);\n    }\n    transform(node, attrSyntax) {\n        if (attrSyntax.command === 'bind' && shouldDefaultToTwoWay(node, attrSyntax)) {\n            attrSyntax.command = 'two-way';\n        }\n        attrSyntax.target = this.map(node.tagName, attrSyntax.target);\n    }\n    map(tagName, attr) {\n        switch (tagName) {\n            case 'LABEL':\n                switch (attr) {\n                    case 'for':\n                        return 'htmlFor';\n                    default:\n                        return attr;\n                }\n            case 'IMG':\n                switch (attr) {\n                    case 'usemap':\n                        return 'useMap';\n                    default:\n                        return attr;\n                }\n            case 'INPUT':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    case 'minlength':\n                        return 'minLength';\n                    case 'formaction':\n                        return 'formAction';\n                    case 'formenctype':\n                        return 'formEncType';\n                    case 'formmethod':\n                        return 'formMethod';\n                    case 'formnovalidate':\n                        return 'formNoValidate';\n                    case 'formtarget':\n                        return 'formTarget';\n                    case 'inputmode':\n                        return 'inputMode';\n                    default:\n                        return attr;\n                }\n            case 'TEXTAREA':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    default:\n                        return attr;\n                }\n            case 'TD':\n            case 'TH':\n                switch (attr) {\n                    case 'rowspan':\n                        return 'rowSpan';\n                    case 'colspan':\n                        return 'colSpan';\n                    default:\n                        return attr;\n                }\n            default:\n                switch (attr) {\n                    case 'accesskey':\n                        return 'accessKey';\n                    case 'contenteditable':\n                        return 'contentEditable';\n                    case 'tabindex':\n                        return 'tabIndex';\n                    case 'textcontent':\n                        return 'textContent';\n                    case 'innerhtml':\n                        return 'innerHTML';\n                    case 'scrolltop':\n                        return 'scrollTop';\n                    case 'scrollleft':\n                        return 'scrollLeft';\n                    case 'readonly':\n                        return 'readOnly';\n                    default:\n                        return attr;\n                }\n        }\n    }\n}\nfunction shouldDefaultToTwoWay(element, attr) {\n    switch (element.tagName) {\n        case 'INPUT':\n            switch (element.type) {\n                case 'checkbox':\n                case 'radio':\n                    return attr.target === 'checked';\n                default:\n                    return attr.target === 'value' || attr.target === 'files';\n            }\n        case 'TEXTAREA':\n        case 'SELECT':\n            return attr.target === 'value';\n        default:\n            switch (attr.target) {\n                case 'textcontent':\n                case 'innerhtml':\n                    return element.hasAttribute('contenteditable');\n                case 'scrolltop':\n                case 'scrollleft':\n                    return true;\n                default:\n                    return false;\n            }\n    }\n}\n//# sourceMappingURL=html-attribute-syntax-transformer.js.map","import { __decorate, __metadata, __param } from \"tslib\";\n/* eslint-disable no-await-in-loop */\nimport { bound } from '@aurelia/kernel';\nimport { IDOM, IScheduler, TaskQueue, IClock, DOM } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\n// Note on the flush requestors: we're probably overdoing it here with the binds and all the wrapping.\n// Just want to start off with something as robust as possible, add many tests first so that we're sure it all works, etc.\n// Once all the proper tests are in place, we can then start simplifying and rely on those tests to tell us precisely which things are necessary and which aren't.\n// Besides looking at test results, we also need to look at benchmark results, memory usage, memory leaks, etc.\nfunction createQueueMicrotaskFlushRequestor(window, flush) {\n    return (function ($window, $flush) {\n        const callFlush = function () {\n            $flush();\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n        return function () {\n            $window.queueMicrotask(callFlush);\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n    })(window, flush);\n}\nfunction createPromiseFlushRequestor(flush) {\n    return (function ($flush) {\n        const callFlush = function () {\n            $flush();\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n        // eslint-disable-next-line compat/compat\n        const p = Promise.resolve();\n        return function () {\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            p.then(callFlush);\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n    })(flush);\n}\nfunction createMutationObserverFlushRequestor(window, flush) {\n    return (function ($window, $flush) {\n        const callFlush = function () {\n            $flush();\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n        const observer = new $window.MutationObserver(callFlush);\n        const node = $window.document.createTextNode('a');\n        // eslint-disable-next-line compat/compat\n        const flip = Object.assign(Object.create(null), { a: 'b', b: 'a' });\n        let val = 'a';\n        observer.observe(node, { characterData: true });\n        return function () {\n            node.data = val = flip[val];\n            // eslint-disable-next-line no-extra-bind\n        }.bind(void 0);\n    })(window, flush);\n}\n// Create a microtask queue, trying the available options starting with the most performant\nconst createMicrotaskFlushRequestor = (function () {\n    // Ensure we only ever create one requestor (at least, per loaded bundle..).\n    let called = false;\n    return function (wnd, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global MicrotaskFlushRequestor');\n        }\n        called = true;\n        if (wnd.queueMicrotask !== void 0 && wnd.queueMicrotask.toString().includes('[native code]')) {\n            return createQueueMicrotaskFlushRequestor(wnd, flush);\n        }\n        else if (Promise.toString().includes('[native code]')) {\n            return createPromiseFlushRequestor(flush);\n        }\n        else {\n            return createMutationObserverFlushRequestor(wnd, flush);\n        }\n    };\n})();\nconst createPostMessageFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global PostMessageFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            const handleMessage = function (event) {\n                if (event.data === 'au-message' && event.source === $window) {\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            $window.addEventListener('message', handleMessage);\n            return function () {\n                $window.postMessage('au-message', $window.origin);\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n        })(window, flush);\n    };\n})();\nconst createSetTimeoutFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global SetTimeoutFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            let handle = -1;\n            const callFlush = function () {\n                if (handle > -1) {\n                    handle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = function () {\n                if (handle > -1) {\n                    $window.clearTimeout(handle);\n                    handle = -1;\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const request = function () {\n                if (handle === -1) {\n                    handle = $window.setTimeout(callFlush, 0);\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst createRequestAnimationFrameFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global RequestAnimationFrameFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            let handle = -1;\n            const callFlush = function () {\n                if (handle > -1) {\n                    handle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = function () {\n                if (handle > -1) {\n                    $window.cancelAnimationFrame(handle);\n                    handle = -1;\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const request = function () {\n                if (handle === -1) {\n                    handle = $window.requestAnimationFrame(callFlush);\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst createPostRequestAnimationFrameFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global PostRequestAnimationFrameFlushRequestor');\n        }\n        called = true;\n        return (function ($window, $flush) {\n            let rafHandle = -1;\n            let timeoutHandle = -1;\n            const callFlush = function () {\n                if (timeoutHandle > -1) {\n                    timeoutHandle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const queueFlush = function () {\n                if (rafHandle > -1) {\n                    rafHandle = -1;\n                    if (timeoutHandle === -1) {\n                        timeoutHandle = $window.setTimeout(callFlush, 0);\n                    }\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = function () {\n                if (rafHandle > -1) {\n                    $window.cancelAnimationFrame(rafHandle);\n                    rafHandle = -1;\n                }\n                if (timeoutHandle > -1) {\n                    $window.clearTimeout(timeoutHandle);\n                    timeoutHandle = -1;\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const request = function () {\n                if (rafHandle === -1) {\n                    rafHandle = $window.requestAnimationFrame(queueFlush);\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst createRequestIdleCallbackFlushRequestor = (function () {\n    let called = false;\n    return function (window, flush) {\n        if (called) {\n            throw new Error('Cannot have more than one global RequestIdleCallbackFlushRequestor');\n        }\n        called = true;\n        const hasNative = window.requestIdleCallback !== void 0 && window.requestIdleCallback.toString().includes('[native code]');\n        return (function ($window, $flush) {\n            let handle = -1;\n            const options = { timeout: 1000 }; // TODO: make this configurable\n            const callFlush = function () {\n                if (handle > -1) {\n                    handle = -1;\n                    $flush();\n                }\n                // eslint-disable-next-line no-extra-bind\n            }.bind(void 0);\n            const cancel = hasNative\n                ? function () {\n                    if (handle > -1) {\n                        $window.cancelIdleCallback(handle);\n                        handle = -1;\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0)\n                : function () {\n                    if (handle > -1) {\n                        $window.clearTimeout(handle);\n                        handle = -1;\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0);\n            const request = hasNative\n                ? function () {\n                    if (handle === -1) {\n                        handle = $window.requestIdleCallback(callFlush, options);\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0)\n                : function () {\n                    if (handle === -1) {\n                        // Instead of trying anything fancy with event handler debouncers (we could do that if there was a request for it),\n                        // we just wait 45ms which is approximately the interval in a native idleCallback loop in chrome, to at least make it look\n                        // the same from a timing perspective\n                        handle = $window.setTimeout(callFlush, 45);\n                    }\n                    // eslint-disable-next-line no-extra-bind\n                }.bind(void 0);\n            return {\n                cancel,\n                request,\n            };\n        })(window, flush);\n    };\n})();\nconst defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    reusable: true,\n    persistent: false,\n};\nlet BrowserScheduler = class BrowserScheduler {\n    constructor(clock, dom) {\n        const microTaskTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 0 /* microTask */ });\n        const renderTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 1 /* render */ });\n        const macroTaskTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 2 /* macroTask */ });\n        const postRenderTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 3 /* postRender */ });\n        const idleTaskQueue = new TaskQueue({ clock, scheduler: this, priority: 4 /* idle */ });\n        this.taskQueue = [\n            microTaskTaskQueue,\n            renderTaskQueue,\n            macroTaskTaskQueue,\n            postRenderTaskQueue,\n            idleTaskQueue,\n        ];\n        const wnd = dom.window;\n        this.flush = [\n            createMicrotaskFlushRequestor(wnd, microTaskTaskQueue.flush.bind(microTaskTaskQueue)),\n            createRequestAnimationFrameFlushRequestor(wnd, renderTaskQueue.flush.bind(renderTaskQueue)),\n            createSetTimeoutFlushRequestor(wnd, macroTaskTaskQueue.flush.bind(macroTaskTaskQueue)),\n            createPostRequestAnimationFrameFlushRequestor(wnd, postRenderTaskQueue.flush.bind(postRenderTaskQueue)),\n            createRequestIdleCallbackFlushRequestor(wnd, idleTaskQueue.flush.bind(idleTaskQueue)),\n        ];\n    }\n    static register(container) {\n        container.registerResolver(IScheduler, {\n            resolve() {\n                if (DOM.scheduler === void 0) {\n                    const clock = container.get(IClock);\n                    const dom = container.get(IDOM);\n                    const scheduler = new BrowserScheduler(clock, dom);\n                    Reflect.defineProperty(DOM, 'scheduler', {\n                        value: scheduler,\n                        writable: false,\n                        enumerable: false,\n                        configurable: false,\n                    });\n                }\n                return DOM.scheduler;\n            }\n        });\n    }\n    getTaskQueue(priority) {\n        return this.taskQueue[priority];\n    }\n    yield(priority) {\n        return this.taskQueue[priority].yield();\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, priority, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        return this.taskQueue[priority].queueTask(callback, { delay, preempt, persistent, reusable });\n    }\n    getMicroTaskQueue() {\n        return this.taskQueue[0 /* microTask */];\n    }\n    getRenderTaskQueue() {\n        return this.taskQueue[1 /* render */];\n    }\n    getMacroTaskQueue() {\n        return this.taskQueue[2 /* macroTask */];\n    }\n    getPostRenderTaskQueue() {\n        return this.taskQueue[3 /* postRender */];\n    }\n    getIdleTaskQueue() {\n        return this.taskQueue[4 /* idle */];\n    }\n    yieldMicroTask() {\n        return this.taskQueue[0 /* microTask */].yield();\n    }\n    yieldRenderTask() {\n        return this.taskQueue[1 /* render */].yield();\n    }\n    yieldMacroTask() {\n        return this.taskQueue[2 /* macroTask */].yield();\n    }\n    yieldPostRenderTask() {\n        return this.taskQueue[3 /* postRender */].yield();\n    }\n    yieldIdleTask() {\n        return this.taskQueue[4 /* idle */].yield();\n    }\n    async yieldAll(repeat = 1) {\n        // Yield sequentially from \"large\" to \"small\" so that any smaller tasks initiated by larger tasks are also still awaited,\n        // as well as guaranteeing a single round of persistent tasks from each queue.\n        // Don't change the order or into parallel, without thoroughly testing the ramifications on persistent and recursively queued tasks.\n        // These aspects are currently relatively poorly tested.\n        while (repeat-- > 0) {\n            await this.yieldIdleTask();\n            await this.yieldPostRenderTask();\n            await this.yieldMacroTask();\n            await this.yieldRenderTask();\n            await this.yieldMicroTask();\n        }\n    }\n    queueMicroTask(callback, opts) {\n        return this.taskQueue[0 /* microTask */].queueTask(callback, opts);\n    }\n    queueRenderTask(callback, opts) {\n        return this.taskQueue[1 /* render */].queueTask(callback, opts);\n    }\n    queueMacroTask(callback, opts) {\n        return this.taskQueue[2 /* macroTask */].queueTask(callback, opts);\n    }\n    queuePostRenderTask(callback, opts) {\n        return this.taskQueue[3 /* postRender */].queueTask(callback, opts);\n    }\n    queueIdleTask(callback, opts) {\n        return this.taskQueue[4 /* idle */].queueTask(callback, opts);\n    }\n    requestFlush(taskQueue) {\n        switch (taskQueue.priority) {\n            case 0 /* microTask */:\n                return this.flush[taskQueue.priority]();\n            case 1 /* render */:\n            case 2 /* macroTask */:\n            case 3 /* postRender */:\n            case 4 /* idle */:\n                return this.flush[taskQueue.priority].request();\n        }\n    }\n    cancelFlush(taskQueue) {\n        switch (taskQueue.priority) {\n            case 0 /* microTask */:\n                return;\n            case 1 /* render */:\n            case 2 /* macroTask */:\n            case 3 /* postRender */:\n            case 4 /* idle */:\n                return this.flush[taskQueue.priority].cancel();\n        }\n    }\n};\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", Promise)\n], BrowserScheduler.prototype, \"yieldMicroTask\", null);\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", Promise)\n], BrowserScheduler.prototype, \"yieldRenderTask\", null);\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", Promise)\n], BrowserScheduler.prototype, \"yieldMacroTask\", null);\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", Promise)\n], BrowserScheduler.prototype, \"yieldPostRenderTask\", null);\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", Promise)\n], BrowserScheduler.prototype, \"yieldIdleTask\", null);\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", Promise)\n], BrowserScheduler.prototype, \"yieldAll\", null);\nBrowserScheduler = __decorate([\n    __param(0, IClock), __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserScheduler);\nexport { BrowserScheduler };\n//# sourceMappingURL=browser-scheduler.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { DI, IContainer, Registration } from '@aurelia/kernel';\nimport { IDOM, IDOMInitializer, IScheduler, DOM } from '@aurelia/runtime';\nimport { RuntimeHtmlConfiguration, HTMLDOM } from '@aurelia/runtime-html';\nimport { BrowserScheduler } from './browser-scheduler';\nlet BrowserDOMInitializer = class BrowserDOMInitializer {\n    constructor(container) {\n        this.container = container;\n    }\n    static register(container) {\n        return Registration.singleton(IDOMInitializer, this).register(container);\n    }\n    initialize(config) {\n        if (this.container.has(IDOM, false)) {\n            return this.container.get(IDOM);\n        }\n        let dom;\n        if (config !== undefined) {\n            if (config.dom !== undefined) {\n                dom = config.dom;\n            }\n            else if (config.host.ownerDocument !== null) {\n                dom = new HTMLDOM(window, config.host.ownerDocument, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n            else {\n                dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n        }\n        else {\n            dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n        }\n        Registration.instance(IDOM, dom).register(this.container);\n        if (DOM.scheduler === void 0) {\n            this.container.register(BrowserScheduler);\n        }\n        else {\n            Registration.instance(IScheduler, DOM.scheduler).register(this.container);\n        }\n        return dom;\n    }\n};\nBrowserDOMInitializer = __decorate([\n    __param(0, IContainer),\n    __metadata(\"design:paramtypes\", [Object])\n], BrowserDOMInitializer);\nexport const IDOMInitializerRegistration = BrowserDOMInitializer;\nexport const IBrowserSchedulerRegistration = BrowserScheduler;\n/**\n * Default HTML-specific, browser-specific implementations for the following interfaces:\n * - `IDOMInitializer`\n */\nexport const DefaultComponents = [\n    IDOMInitializerRegistration,\n    IBrowserSchedulerRegistration,\n];\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents`\n */\nexport const RuntimeHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...DefaultComponents);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport { BrowserDOMInitializer, BrowserScheduler, };\n//# sourceMappingURL=index.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DefaultBindingLanguage as JitHtmlDefaultBindingLanguage, DefaultComponents as JitHtmlDefaultComponents } from '@aurelia/jit-html';\nimport { DI, Profiler } from '@aurelia/kernel';\nimport { RuntimeHtmlBrowserConfiguration } from '@aurelia/runtime-html-browser';\nconst { enter, leave } = Profiler.createTimer('JitHtmlBrowserConfiguration');\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlBrowserConfiguration` from `@aurelia/runtime-html-browser`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents` from `@aurelia/jit-html`\n * - `DefaultBindingLanguage` from `@aurelia/jit-html`\n */\nexport const JitHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        RuntimeHtmlBrowserConfiguration\n            .register(container)\n            .register(...JitDefaultBindingLanguage, ...JitDefaultBindingSyntax, ...JitDefaultComponents, ...JitHtmlDefaultBindingLanguage, ...JitHtmlDefaultComponents);\n        return container;\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=index.js.map","import { DebugConfiguration } from '@aurelia/debug';\nimport { JitHtmlBrowserConfiguration } from '@aurelia/jit-html-browser';\nimport { DI } from '@aurelia/kernel';\nimport { Aurelia as $Aurelia, CustomElement } from '@aurelia/runtime';\n// TODO: SSR?? abstract HTMLElement and document.\nfunction createAurelia() {\n    const au = new Aurelia();\n    au.register(JitHtmlBrowserConfiguration);\n    // eslint-disable-next-line sonarjs/no-collapsible-if\n    if (typeof process !== 'undefined' && typeof process.env === 'object') {\n        // Just use NODE_ENV to control build process.\n        // Bundlers (at least webpack/dumber/parcel) have feature to remove this branch in production.\n        // Then tree-shaking/minifier will remove unused DebugConfiguration import.\n        if (process.env.NODE_ENV !== 'production') {\n            au.register(DebugConfiguration);\n        }\n    }\n    return au;\n}\nexport class Aurelia extends $Aurelia {\n    constructor(container = DI.createContainer()) {\n        super(container);\n    }\n    static start(root) {\n        return createAurelia().start(root);\n    }\n    static app(config) {\n        return createAurelia().app(config);\n    }\n    static register(...params) {\n        return createAurelia().register(...params);\n    }\n    app(config) {\n        if (CustomElement.isType(config)) {\n            // Default to custom element element name\n            const definition = CustomElement.getDefinition(config);\n            let host = document.querySelector(definition.name);\n            if (host === null) {\n                // When no target is found, default to body.\n                // For example, when user forgot to write <my-app></my-app> in html.\n                host = document.body;\n            }\n            return super.app({\n                host: host,\n                component: config\n            });\n        }\n        return super.app(config);\n    }\n}\n//# sourceMappingURL=quick-start.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var api = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../node_modules/css-loader/dist/cjs.js!../node_modules/postcss-loader/src/index.js??ref--4-2!./my-app.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(module.id, content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = {};\n\nfunction modulesToDom(moduleId, list, options) {\n  for (var i = 0; i < list.length; i++) {\n    var part = {\n      css: list[i][1],\n      media: list[i][2],\n      sourceMap: list[i][3]\n    };\n\n    if (stylesInDom[moduleId][i]) {\n      stylesInDom[moduleId][i](part);\n    } else {\n      stylesInDom[moduleId].push(addStyle(part, options));\n    }\n  }\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (moduleId, list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  moduleId = options.base ? moduleId + options.base : moduleId;\n  list = list || [];\n\n  if (!stylesInDom[moduleId]) {\n    stylesInDom[moduleId] = [];\n  }\n\n  modulesToDom(moduleId, list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    if (!stylesInDom[moduleId]) {\n      stylesInDom[moduleId] = [];\n    }\n\n    modulesToDom(moduleId, newList, options);\n\n    for (var j = newList.length; j < stylesInDom[moduleId].length; j++) {\n      stylesInDom[moduleId][j]();\n    }\n\n    stylesInDom[moduleId].length = newList.length;\n\n    if (stylesInDom[moduleId].length === 0) {\n      delete stylesInDom[moduleId];\n    }\n  };\n};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \":root {\\n  /* --main-bg-color: #382901; */\\n  --main-bg-color-rgb: 31, 23, 1;\\n  --main-bg-color: rgb(var(--main-bg-color-rgb));\\n  --inverse-txt-color: #dad8d0;\\n\\n  --base-fnt-size: 16px;\\n}\\n\\n* {\\n  box-sizing: border-box;\\n  font-family: 'Ubuntu', serif;\\n}\\n\\nbody {\\n  font-size: var(--base-fnt-size);\\n  height: 100vh;\\n  margin: 0;\\n}\\n\\nmy-app {\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n          flex-direction: column;\\n  height: 100vh;\\n  margin: 0;\\n}\\n\\nheader {\\n  background-color: var(--main-bg-color);\\n  color: var(--inverse-txt-color);\\n  padding: .75em 1em;\\n}\\n\\nheader>h1 {\\n  margin: 0;\\n}\\n\\nfooter {\\n  background-color: var(--main-bg-color);\\n  color: var(--inverse-txt-color);\\n  font-size: .75em;\\n  padding: .75em 1em;\\n  text-align: center;\\n}\\n\\nmain {\\n  -webkit-box-flex: 1;\\n          flex-grow: 1;\\n  margin: 0;\\n  overflow-x: auto;\\n  padding: 1.75em 1em .75em 0;\\n  width: 100vw;\\n}\\n\\n.card:not(:last-of-type) {\\n  margin-left: calc(var(--card-width) * -.5);\\n}\\n\\n.card:hover:not(:last-of-type) {\\n  margin-left: 0;\\n}\\n\\n.card>.inner-border {\\n  bottom: initial;\\n  border-radius: 5px;\\n  border: 1px solid var(--inverse-txt-color);\\n  height: calc(var(--card-height) - 1.25em);\\n  pointer-events: none;\\n  position: absolute;\\n  right: initial;\\n  width: calc(var(--card-width) - 1.25em);\\n}\\n\\n.card {\\n  --card-height: 200px;\\n  --card-width: 250px;\\n\\n  -webkit-box-align: center;\\n\\n          align-items: center;\\n  background: -webkit-gradient(linear, left top, left bottom, from(rgba(179, 156, 95, 0.5)), to(rgba(150, 117, 24, 0.75))), no-repeat center url('/assets/img/talmud_scroll.jpg');\\n  background: linear-gradient(rgba(179, 156, 95, 0.5), rgba(150, 117, 24, 0.75)), no-repeat center url('/assets/img/talmud_scroll.jpg');\\n  border-radius: 5px;\\n  box-shadow: 1.5rem 0 2rem #222;\\n  color: #000;\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n          flex-direction: column;\\n  height: var(--card-height);\\n  -webkit-box-pack: center;\\n          justify-content: center;\\n  min-width: var(--card-width);\\n  position: relative;\\n  text-align: center;\\n  -webkit-transition: all .15s ease-in-out;\\n  transition: all .15s ease-in-out;\\n  -webkit-transition: margin .3s ease-in-out;\\n  transition: margin .3s ease-in-out;\\n  width: var(--card-width);\\n}\\n\\n.card>h3,\\n.card>h5,\\n.card>div {\\n  margin: 0;\\n}\\n\\n.card>h3 {\\n  font-size: 26px;\\n  font-weight: 900;\\n}\\n\\n.card>h5 {\\n  font-size: 12px;\\n  font-style: italic;\\n  margin-bottom: .75em;\\n  margin-top: -30px;\\n  -webkit-transition: all .15s ease-in-out;\\n  transition: all .15s ease-in-out;\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n          flex-direction: column;\\n}\\n\\n.card>h5 a {\\n  color: #000;\\n}\\n\\n.card>h5 a:hover {\\n  color: #38362f;\\n}\\n\\n.card>h5 button {\\n  font-weight: 900;\\n  border: 0;\\n  border-radius: 5px;\\n  background-color: white;\\n  color: black;\\n  cursor: pointer;\\n}\\n\\n.card:hover>h5 {\\n  margin-top: -20px;\\n}\\n\\n.card>div {\\n  font-weight: 900;\\n}\\n\\n.card>span {\\n  bottom: 5px;\\n  font-size: .75em;\\n  padding-bottom: 5px;\\n  padding-right: 5px;\\n  position: absolute;\\n  right: 5px;\\n}\\n\\n.card>h3:after {\\n  content: \\\"\\\";\\n  background-color: #38362f;\\n  display: inline-block;\\n  height: 5px;\\n  opacity: .01;\\n  margin-bottom: 20px;\\n  -webkit-transition: all 0.2s ease-in-out;\\n  transition: all 0.2s ease-in-out;\\n  -webkit-transition-duration: 0.75s;\\n          transition-duration: 0.75s;\\n  width: 5%;\\n}\\n\\n.card:hover>h3:after {\\n  opacity: 1;\\n  width: 100%;\\n}\\n\\nmain>h4 {\\n  background-color: var(--main-bg-color);\\n  border-radius: 5px;\\n  color: var(--inverse-txt-color);\\n  height: 200px;\\n  margin: 0;\\n  padding: 1em .5em;\\n  -webkit-text-orientation: upright;\\n          text-orientation: upright;\\n  -webkit-writing-mode: sideways-lr;\\n      -ms-writing-mode: sideways-lr;\\n          writing-mode: sideways-lr;\\n}\\n\\n.wrapper {\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: horizontal;\\n  -webkit-box-direction: reverse;\\n          flex-direction: row-reverse;\\n  -webkit-box-pack: end;\\n          justify-content: flex-end;\\n}\\n\\n\\n\\n\\n\\n\\n\\n.faux-dialog {\\n  -webkit-box-align: center;\\n          align-items: center;\\n  background-color: rgba(var(--main-bg-color-rgb), .9);\\n  bottom: 50%;\\n  color: var(--inverse-txt-color);\\n  display: -webkit-box;\\n  display: flex;\\n  height: 0;\\n  -webkit-box-pack: center;\\n          justify-content: center;\\n  left: 50%;\\n  position: absolute;\\n  right: 50%;\\n  top: 50%;\\n  -webkit-transition: all 0.5s ease-in-out;\\n  transition: all 0.5s ease-in-out;\\n  width: 0;\\n}\\n\\n.faux-dialog.full {\\n  height: calc(100vh - 60px - 4em);\\n  left: 1em;\\n  right: 0;\\n  top: calc(60px + 1em);\\n  width: calc(100vw - 2em);\\n  bottom: 0;\\n  border-radius: 5px;\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","import { DOM } from '@aurelia/runtime-html';\nexport const retryStrategy = {\n    fixed: 0,\n    incremental: 1,\n    exponential: 2,\n    random: 3\n};\nconst defaultRetryConfig = {\n    maxRetries: 3,\n    interval: 1000,\n    strategy: retryStrategy.fixed\n};\n/**\n * Interceptor that retries requests on error, based on a given RetryConfiguration.\n */\nexport class RetryInterceptor {\n    /**\n     * Creates an instance of RetryInterceptor.\n     */\n    constructor(retryConfig) {\n        this.retryConfig = { ...defaultRetryConfig, ...(retryConfig !== undefined ? retryConfig : {}) };\n        if (this.retryConfig.strategy === retryStrategy.exponential &&\n            this.retryConfig.interval <= 1000) {\n            throw new Error('An interval less than or equal to 1 second is not allowed when using the exponential retry strategy');\n        }\n    }\n    /**\n     * Called with the request before it is sent. It remembers the request so it can be retried on error.\n     *\n     * @param request - The request to be sent.\n     * @returns The existing request, a new request or a response; or a Promise for any of these.\n     */\n    request(request) {\n        if (!request.retryConfig) {\n            request.retryConfig = { ...this.retryConfig };\n            request.retryConfig.counter = 0;\n        }\n        // do this on every request\n        request.retryConfig.requestClone = request.clone();\n        return request;\n    }\n    /**\n     * Called with the response after it is received. Clears the remembered request, as it was succesfull.\n     *\n     * @param response - The response.\n     * @returns The response; or a Promise for one.\n     */\n    response(response, request) {\n        // retry was successful, so clean up after ourselves\n        Reflect.deleteProperty(request, 'retryConfig');\n        return response;\n    }\n    /**\n     * Handles fetch errors and errors generated by previous interceptors. This\n     * function acts as a Promise rejection handler. It wil retry the remembered request based on the\n     * configured RetryConfiguration.\n     *\n     * @param error - The rejection value from the fetch request or from a\n     * previous interceptor.\n     * @returns The response of the retry; or a Promise for one.\n     */\n    responseError(error, request, httpClient) {\n        const { retryConfig } = request;\n        const { requestClone } = retryConfig;\n        return Promise.resolve().then(() => {\n            if (retryConfig.counter < retryConfig.maxRetries) {\n                const result = retryConfig.doRetry !== undefined ? retryConfig.doRetry(error, request) : true;\n                return Promise.resolve(result).then(doRetry => {\n                    if (doRetry) {\n                        retryConfig.counter++;\n                        const delay = calculateDelay(retryConfig);\n                        return new Promise((resolve) => DOM.window.setTimeout(resolve, !isNaN(delay) ? delay : 0))\n                            .then(() => {\n                            const newRequest = requestClone.clone();\n                            if (typeof (retryConfig.beforeRetry) === 'function') {\n                                return retryConfig.beforeRetry(newRequest, httpClient);\n                            }\n                            return newRequest;\n                        })\n                            .then(newRequest => {\n                            const retryableRequest = { ...newRequest, retryConfig };\n                            return httpClient.fetch(retryableRequest);\n                        });\n                    }\n                    // no more retries, so clean up\n                    Reflect.deleteProperty(request, 'retryConfig');\n                    throw error;\n                });\n            }\n            // no more retries, so clean up\n            Reflect.deleteProperty(request, 'retryConfig');\n            throw error;\n        });\n    }\n}\nfunction calculateDelay(retryConfig) {\n    const { interval, strategy, minRandomInterval, maxRandomInterval, counter } = retryConfig;\n    if (typeof (strategy) === 'function') {\n        return retryConfig.strategy(counter);\n    }\n    switch (strategy) {\n        case (retryStrategy.fixed):\n            return retryStrategies[retryStrategy.fixed](interval);\n        case (retryStrategy.incremental):\n            return retryStrategies[retryStrategy.incremental](counter, interval);\n        case (retryStrategy.exponential):\n            return retryStrategies[retryStrategy.exponential](counter, interval);\n        case (retryStrategy.random):\n            return retryStrategies[retryStrategy.random](counter, interval, minRandomInterval, maxRandomInterval);\n        default:\n            throw new Error('Unrecognized retry strategy');\n    }\n}\nconst retryStrategies = [\n    // fixed\n    interval => interval,\n    // incremental\n    (retryCount, interval) => interval * retryCount,\n    // exponential\n    (retryCount, interval) => retryCount === 1 ? interval : interval ** retryCount / 1000,\n    // random\n    (retryCount, interval, minRandomInterval = 0, maxRandomInterval = 60000) => {\n        return Math.random() * (maxRandomInterval - minRandomInterval) + minRandomInterval;\n    }\n];\n//# sourceMappingURL=retry-interceptor.js.map","import { RetryInterceptor } from './retry-interceptor';\n/**\n * A class for configuring HttpClients.\n */\nexport class HttpClientConfiguration {\n    constructor() {\n        /**\n         * The base URL to be prepended to each Request's url before sending.\n         */\n        this.baseUrl = '';\n        /**\n         * Default values to apply to init objects when creating Requests. Note that\n         * defaults cannot be applied when Request objects are manually created because\n         * Request provides its own defaults and discards the original init object.\n         * See also https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n         */\n        this.defaults = {};\n        /**\n         * Interceptors to be added to the HttpClient.\n         */\n        this.interceptors = [];\n    }\n    /**\n     * Sets the baseUrl.\n     *\n     * @param baseUrl - The base URL.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withBaseUrl(baseUrl) {\n        this.baseUrl = baseUrl;\n        return this;\n    }\n    /**\n     * Sets the defaults.\n     *\n     * @param defaults - The defaults.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withDefaults(defaults) {\n        this.defaults = defaults;\n        return this;\n    }\n    /**\n     * Adds an interceptor to be run on all requests or responses.\n     *\n     * @param interceptor - An object with request, requestError,\n     * response, or responseError methods. request and requestError act as\n     * resolve and reject handlers for the Request before it is sent.\n     * response and responseError act as resolve and reject handlers for\n     * the Response after it has been received.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withInterceptor(interceptor) {\n        this.interceptors.push(interceptor);\n        return this;\n    }\n    /**\n     * Applies a configuration that addresses common application needs, including\n     * configuring same-origin credentials, and using rejectErrorResponses.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    useStandardConfiguration() {\n        const standardConfig = { credentials: 'same-origin' };\n        Object.assign(this.defaults, standardConfig, this.defaults);\n        return this.rejectErrorResponses();\n    }\n    /**\n     * Causes Responses whose status codes fall outside the range 200-299 to reject.\n     * The fetch API only rejects on network errors or other conditions that prevent\n     * the request from completing, meaning consumers must inspect Response.ok in the\n     * Promise continuation to determine if the server responded with a success code.\n     * This method adds a response interceptor that causes Responses with error codes\n     * to be rejected, which is common behavior in HTTP client libraries.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    rejectErrorResponses() {\n        return this.withInterceptor({ response: rejectOnError });\n    }\n    withRetry(config) {\n        const interceptor = new RetryInterceptor(config);\n        return this.withInterceptor(interceptor);\n    }\n}\nfunction rejectOnError(response) {\n    if (!response.ok) {\n        throw response;\n    }\n    return response;\n}\n//# sourceMappingURL=http-client-configuration.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { IDOM } from '@aurelia/runtime';\nimport { DOM, HTMLDOM } from '@aurelia/runtime-html';\nimport { HttpClientConfiguration } from './http-client-configuration';\nimport { RetryInterceptor } from './retry-interceptor';\nconst absoluteUrlRegexp = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n/**\n * An HTTP client based on the Fetch API.\n */\nlet HttpClient = class HttpClient {\n    /**\n     * Creates an instance of HttpClient.\n     */\n    constructor(dom) {\n        this.dom = dom;\n        if (dom.window.fetch === undefined) {\n            throw new Error('HttpClient requires a Fetch API implementation, but the current environment doesn\\'t support it. You may need to load a polyfill such as https://github.com/github/fetch');\n        }\n        this.dom = dom;\n        this.activeRequestCount = 0;\n        this.isRequesting = false;\n        this.isConfigured = false;\n        this.baseUrl = '';\n        this.defaults = null;\n        this.interceptors = [];\n    }\n    /**\n     * Configure this client with default settings to be used by all requests.\n     *\n     * @param config - A configuration object, or a function that takes a config\n     * object and configures it.\n     * @returns The chainable instance of this HttpClient.\n     * @chainable\n     */\n    configure(config) {\n        let normalizedConfig;\n        if (typeof config === 'object') {\n            const requestInitConfiguration = { defaults: config };\n            normalizedConfig = requestInitConfiguration;\n        }\n        else if (typeof config === 'function') {\n            normalizedConfig = new HttpClientConfiguration();\n            normalizedConfig.baseUrl = this.baseUrl;\n            normalizedConfig.defaults = { ...this.defaults };\n            normalizedConfig.interceptors = this.interceptors;\n            const c = config(normalizedConfig);\n            if (Object.prototype.isPrototypeOf.call(HttpClientConfiguration.prototype, c)) {\n                normalizedConfig = c;\n            }\n        }\n        else {\n            throw new Error('invalid config');\n        }\n        const defaults = normalizedConfig.defaults;\n        if (defaults !== undefined && Object.prototype.isPrototypeOf.call(Headers.prototype, defaults.headers)) {\n            // Headers instances are not iterable in all browsers. Require a plain\n            // object here to allow default headers to be merged into request headers.\n            throw new Error('Default headers must be a plain object.');\n        }\n        const interceptors = normalizedConfig.interceptors;\n        if (interceptors !== undefined && interceptors.length) {\n            // find if there is a RetryInterceptor\n            if (interceptors.filter(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x)).length > 1) {\n                throw new Error('Only one RetryInterceptor is allowed.');\n            }\n            const retryInterceptorIndex = interceptors.findIndex(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x));\n            if (retryInterceptorIndex >= 0 && retryInterceptorIndex !== interceptors.length - 1) {\n                throw new Error('The retry interceptor must be the last interceptor defined.');\n            }\n        }\n        this.baseUrl = normalizedConfig.baseUrl;\n        this.defaults = defaults;\n        this.interceptors = normalizedConfig.interceptors !== undefined ? normalizedConfig.interceptors : [];\n        this.isConfigured = true;\n        return this;\n    }\n    /**\n     * Starts the process of fetching a resource. Default configuration parameters\n     * will be applied to the Request. The constructed Request will be passed to\n     * registered request interceptors before being sent. The Response will be passed\n     * to registered Response interceptors before it is returned.\n     *\n     * See also https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    fetch(input, init) {\n        this.trackRequestStart();\n        let request = this.buildRequest(input, init);\n        return this.processRequest(request, this.interceptors).then(result => {\n            let response;\n            if (Object.prototype.isPrototypeOf.call(Response.prototype, result)) {\n                response = Promise.resolve(result);\n            }\n            else if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                request = result;\n                response = fetch(request);\n            }\n            else {\n                throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${result}]`);\n            }\n            return this.processResponse(response, this.interceptors, request);\n        })\n            .then(result => {\n            if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                return this.fetch(result);\n            }\n            return result;\n        })\n            .then(result => {\n            this.trackRequestEnd();\n            return result;\n        }, error => {\n            this.trackRequestEnd();\n            throw error;\n        });\n    }\n    buildRequest(input, init) {\n        const defaults = this.defaults !== null ? this.defaults : {};\n        let request;\n        let body;\n        let requestContentType;\n        const parsedDefaultHeaders = parseHeaderValues(defaults.headers);\n        if (Object.prototype.isPrototypeOf.call(Request.prototype, input)) {\n            request = input;\n            requestContentType = new Headers(request.headers).get('Content-Type');\n        }\n        else {\n            if (!init) {\n                init = {};\n            }\n            body = init.body;\n            const bodyObj = body !== undefined ? { body: body } : null;\n            const requestInit = { ...defaults, headers: {}, ...init, ...bodyObj };\n            requestContentType = new Headers(requestInit.headers).get('Content-Type');\n            request = new Request(getRequestUrl(this.baseUrl, input), requestInit);\n        }\n        if (!requestContentType) {\n            if (new Headers(parsedDefaultHeaders).has('content-type')) {\n                request.headers.set('Content-Type', new Headers(parsedDefaultHeaders).get('content-type'));\n            }\n            else if (body !== undefined && isJSON(body)) {\n                request.headers.set('Content-Type', 'application/json');\n            }\n        }\n        setDefaultHeaders(request.headers, parsedDefaultHeaders);\n        if (body !== undefined && Object.prototype.isPrototypeOf.call(Blob.prototype, body) && body.type) {\n            // work around bug in IE & Edge where the Blob type is ignored in the request\n            // https://connect.microsoft.com/IE/feedback/details/2136163\n            request.headers.set('Content-Type', body.type);\n        }\n        return request;\n    }\n    /**\n     * Calls fetch as a GET request.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    get(input, init) {\n        return this.fetch(input, init);\n    }\n    /**\n     * Calls fetch with request method set to POST.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    post(input, body, init) {\n        return this.callFetch(input, body, init, 'POST');\n    }\n    /**\n     * Calls fetch with request method set to PUT.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    put(input, body, init) {\n        return this.callFetch(input, body, init, 'PUT');\n    }\n    /**\n     * Calls fetch with request method set to PATCH.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    patch(input, body, init) {\n        return this.callFetch(input, body, init, 'PATCH');\n    }\n    /**\n     * Calls fetch with request method set to DELETE.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    delete(input, body, init) {\n        return this.callFetch(input, body, init, 'DELETE');\n    }\n    trackRequestStart() {\n        this.isRequesting = !!(++this.activeRequestCount);\n        if (this.isRequesting) {\n            const evt = DOM.createCustomEvent('aurelia-fetch-client-request-started', { bubbles: true, cancelable: true });\n            DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n        }\n    }\n    trackRequestEnd() {\n        this.isRequesting = !!(--this.activeRequestCount);\n        if (!this.isRequesting) {\n            const evt = DOM.createCustomEvent('aurelia-fetch-client-requests-drained', { bubbles: true, cancelable: true });\n            DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n        }\n    }\n    processRequest(request, interceptors) {\n        return this.applyInterceptors(request, interceptors, 'request', 'requestError', this);\n    }\n    processResponse(response, interceptors, request) {\n        return this.applyInterceptors(response, interceptors, 'response', 'responseError', request, this);\n    }\n    applyInterceptors(input, interceptors, successName, errorName, ...interceptorArgs) {\n        return (interceptors !== undefined ? interceptors : [])\n            .reduce((chain, interceptor) => {\n            const successHandler = interceptor[successName];\n            const errorHandler = interceptor[errorName];\n            // TODO: Fix this, as it violates `strictBindCallApply`.\n            return chain.then(successHandler ? (value => successHandler.call(interceptor, value, ...interceptorArgs)) : identity, errorHandler ? (reason => errorHandler.call(interceptor, reason, ...interceptorArgs)) : thrower);\n        }, Promise.resolve(input));\n    }\n    callFetch(input, body, init, method) {\n        if (!init) {\n            init = {};\n        }\n        init.method = method;\n        if (body) {\n            init.body = body;\n        }\n        return this.fetch(input, init);\n    }\n};\nHttpClient = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], HttpClient);\nexport { HttpClient };\nfunction parseHeaderValues(headers) {\n    const parsedHeaders = {};\n    const $headers = headers !== undefined ? headers : {};\n    for (const name in $headers) {\n        if (Object.prototype.hasOwnProperty.call($headers, name)) {\n            parsedHeaders[name] = (typeof $headers[name] === 'function')\n                ? $headers[name]()\n                : $headers[name];\n        }\n    }\n    return parsedHeaders;\n}\nfunction getRequestUrl(baseUrl, url) {\n    if (absoluteUrlRegexp.test(url)) {\n        return url;\n    }\n    return (baseUrl !== undefined ? baseUrl : '') + url;\n}\nfunction setDefaultHeaders(headers, defaultHeaders) {\n    const $defaultHeaders = defaultHeaders !== undefined ? defaultHeaders : {};\n    for (const name in $defaultHeaders) {\n        if (Object.prototype.hasOwnProperty.call($defaultHeaders, name) && !headers.has(name)) {\n            headers.set(name, $defaultHeaders[name]);\n        }\n    }\n}\nfunction isJSON(str) {\n    try {\n        JSON.parse(str);\n    }\n    catch (err) {\n        return false;\n    }\n    return true;\n}\nfunction identity(x) {\n    return x;\n}\nfunction thrower(x) {\n    throw x;\n}\n//# sourceMappingURL=http-client.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { bound } from '@aurelia/kernel';\n/**\n * A first-in-first-out queue that only processes the next queued item\n * when the current one has been resolved or rejected. Sends queued items\n * one at a time to a specified callback function. The callback function\n * should resolve or reject the queued item when processing is done.\n * Enqueued items can be awaited. Enqueued items can specify an (arbitrary)\n * execution cost and the queue can be set up (activated) to only process\n * a specific amount of execution cost per RAF/tick.\n */\nexport class Queue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Queue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Queue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = list ? itemOrItems : [itemOrItems];\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map(value => value !== undefined ? value : 1);\n        const promises = [];\n        for (const item of items) {\n            const qItem = { ...item };\n            qItem.cost = costs.shift();\n            promises.push(new Promise((resolve, reject) => {\n                qItem.resolve = () => {\n                    resolve();\n                    this.processing = null;\n                    this.dequeue();\n                };\n                qItem.reject = (reason) => {\n                    reject(reason);\n                    this.processing = null;\n                    this.dequeue();\n                };\n            }));\n            this.pending.push(qItem);\n        }\n        this.dequeue();\n        return list ? promises : promises[0];\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            this.callback(this.processing);\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", void 0)\n], Queue.prototype, \"dequeue\", null);\n//# sourceMappingURL=queue.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { Reporter } from '@aurelia/kernel';\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { Queue } from './queue';\nlet BrowserNavigator = class BrowserNavigator {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { return; },\n        };\n        this.forwardedState = {};\n        this.handlePopstate = (ev) => {\n            return this.enqueue(this, 'popstate', [ev]);\n        };\n        this.processCalls = (qCall) => {\n            const call = qCall;\n            if (call.target === this && call.methodName !== 'forwardState') {\n                call.parameters.push(this.forwardedState.resolve);\n                this.forwardedState.resolve = null;\n                // Should we suppress this popstate event?\n                if (call.methodName === 'popstate' && this.forwardedState.suppressPopstate) {\n                    call.parameters.push(true);\n                    this.forwardedState.suppressPopstate = false;\n                }\n            }\n            // eslint-disable-next-line @typescript-eslint/ban-types\n            const method = call.target[call.methodName];\n            Reporter.write(10000, 'DEQUEUE', call.methodName, call.parameters);\n            if (method) {\n                method.apply(call.target, call.parameters);\n            }\n            qCall.resolve();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new Queue(this.processCalls);\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstate = false) {\n        return this.enqueue(this.history, 'go', [delta], suppressPopstate);\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'pushState', [state, title, `${fragment}${path}`]);\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'replaceState', [state, title, `${fragment}${path}`]);\n    }\n    popNavigatorState() {\n        return this.enqueue(this, 'popState', []);\n    }\n    popstate(ev, resolve, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (resolve !== null && resolve !== void 0) {\n            resolve();\n        }\n    }\n    async popState(resolve) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            return this.pushNavigatorState(state);\n        }\n        resolve();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    // Everything that wants to await a browser event should pass suppressPopstate param\n    // Events NOT resulting in popstate events should NOT pass suppressPopstate param\n    enqueue(target, methodName, parameters, suppressPopstate) {\n        const calls = [];\n        const costs = [];\n        const promises = [];\n        if (suppressPopstate !== undefined) {\n            // Due to (browser) events not having a promise, we create and propagate one\n            let resolve = null;\n            promises.push(new Promise(_resolve => {\n                resolve = _resolve;\n            }));\n            calls.push({\n                target: this,\n                methodName: 'forwardState',\n                parameters: [\n                    {\n                        resolve,\n                        suppressPopstate,\n                    }\n                ],\n            });\n            costs.push(0);\n        }\n        calls.push({\n            target: target,\n            methodName: methodName,\n            parameters: parameters,\n        });\n        costs.push(1);\n        // The first promise is the relevant one since it's either a) the propagated one (in\n        // case of a browser action), or b) the only one since there's only one call\n        promises.push(this.pendingCalls.enqueue(calls, costs)[0]);\n        return promises[0];\n    }\n};\nBrowserNavigator = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserNavigator);\nexport { BrowserNavigator };\n//# sourceMappingURL=browser-navigator.js.map","import { IDOM, CustomAttribute } from '@aurelia/runtime';\n/**\n * Class responsible for handling interactions that should trigger navigation.\n */\nexport class LinkHandler {\n    constructor(dom) {\n        this.options = {\n            useHref: true,\n            callback: () => { return; }\n        };\n        this.isActive = false;\n        this.handler = (e) => {\n            const info = LinkHandler.getEventInfo(e, this.window, this.options);\n            if (info.shouldHandleEvent) {\n                e.preventDefault();\n                this.options.callback(info);\n            }\n        };\n        this.window = dom.window;\n        this.document = dom.document;\n    }\n    /**\n     * Gets the href and a \"should handle\" recommendation, given an Event.\n     *\n     * @param event - The Event to inspect for target anchor and href.\n     */\n    static getEventInfo(event, win, options) {\n        const info = {\n            shouldHandleEvent: false,\n            instruction: null,\n            anchor: null\n        };\n        const target = info.anchor = event.currentTarget;\n        // Switch to this for delegation:\n        // const target = info.anchor = LinkHandler.closestAnchor(event.target as Element);\n        if (!target || !LinkHandler.targetIsThisWindow(target, win)) {\n            return info;\n        }\n        if (target.hasAttribute('external')) {\n            return info;\n        }\n        if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\n            return info;\n        }\n        const gotoAttr = CustomAttribute.for(target, 'goto');\n        const goto = gotoAttr !== void 0 ? gotoAttr.viewModel.value : null;\n        const href = options.useHref && target.hasAttribute('href') ? target.getAttribute('href') : null;\n        if ((goto === null || goto.length === 0) && (href === null || href.length === 0)) {\n            return info;\n        }\n        info.anchor = target;\n        info.instruction = goto || href;\n        const leftButtonClicked = event.button === 0;\n        info.shouldHandleEvent = leftButtonClicked;\n        return info;\n    }\n    /**\n     * Finds the closest ancestor that's an anchor element.\n     *\n     * @param el - The element to search upward from.\n     * @returns The link element that is the closest ancestor.\n     */\n    // private static closestAnchor(el: Element): Element | null {\n    //   while (el !== null && el !== void 0) {\n    //     if (el.tagName === 'A') {\n    //       return el;\n    //     }\n    //     el = el.parentNode as Element;\n    //   }\n    //   return null;\n    // }\n    /**\n     * Gets a value indicating whether or not an anchor targets the current window.\n     *\n     * @param target - The anchor element whose target should be inspected.\n     * @returns True if the target of the link element is this window; false otherwise.\n     */\n    static targetIsThisWindow(target, win) {\n        const targetWindow = target.getAttribute('target');\n        return !targetWindow ||\n            targetWindow === win.name ||\n            targetWindow === '_self';\n    }\n    /**\n     * Activate the instance.\n     *\n     */\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Link handler has already been activated');\n        }\n        this.isActive = true;\n        this.options = { ...options };\n    }\n    /**\n     * Deactivate the instance. Event handlers and other resources should be cleaned up here.\n     */\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Link handler has not been activated');\n        }\n        this.isActive = false;\n    }\n}\nLinkHandler.inject = [IDOM];\n//# sourceMappingURL=link-handler.js.map","export function arrayRemove(arr, func) {\n    const removed = [];\n    let arrIndex = arr.findIndex(func);\n    while (arrIndex >= 0) {\n        removed.push(arr.splice(arrIndex, 1)[0]);\n        arrIndex = arr.findIndex(func);\n    }\n    return removed;\n}\n//# sourceMappingURL=utils.js.map","export function parseQuery(query) {\n    if (!query || !query.length) {\n        return {};\n    }\n    const parameters = {};\n    // TODO: Deal with complex parameters such as lists and objects\n    const params = query.replace('+', ' ').split('&');\n    for (const param of params) {\n        const [key, value] = param.split('=');\n        parameters[decodeURIComponent(key)] = decodeURIComponent(value !== void 0 ? value : key);\n    }\n    return parameters;\n}\n//# sourceMappingURL=parser.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Controller, ILifecycle, CustomElement } from '@aurelia/runtime';\nimport { parseQuery } from './parser';\nimport { ViewportInstruction } from './viewport-instruction';\nexport var ContentStatus;\n(function (ContentStatus) {\n    ContentStatus[ContentStatus[\"none\"] = 0] = \"none\";\n    ContentStatus[ContentStatus[\"created\"] = 1] = \"created\";\n    ContentStatus[ContentStatus[\"loaded\"] = 2] = \"loaded\";\n    ContentStatus[ContentStatus[\"initialized\"] = 3] = \"initialized\";\n    ContentStatus[ContentStatus[\"added\"] = 4] = \"added\";\n})(ContentStatus || (ContentStatus = {}));\nexport class ViewportContent {\n    constructor(\n    // Can (and wants) be a (resolved) type or a string (to be resolved later)\n    content = new ViewportInstruction(''), instruction = {\n        instruction: '',\n        fullStateInstruction: '',\n    }, container = null) {\n        this.content = content;\n        this.instruction = instruction;\n        this.contentStatus = 0 /* none */;\n        this.entered = false;\n        this.fromCache = false;\n        this.fromHistory = false;\n        this.reentry = false;\n        // If we've got a container, we're good to resolve type\n        if (!this.content.isComponentType() && container !== null) {\n            this.content.componentType = this.toComponentType(container);\n        }\n    }\n    get componentInstance() {\n        return this.content.componentInstance;\n    }\n    get viewport() {\n        return this.content.viewport;\n    }\n    equalComponent(other) {\n        return this.content.sameComponent(other.content);\n    }\n    equalParameters(other) {\n        return this.content.sameComponent(other.content, true) &&\n            // TODO: Review whether query is relevant\n            this.instruction.query === other.instruction.query;\n    }\n    reentryBehavior() {\n        return (this.content.componentInstance !== null &&\n            'reentryBehavior' in this.content.componentInstance &&\n            this.content.componentInstance.reentryBehavior !== void 0)\n            ? this.content.componentInstance.reentryBehavior\n            : \"default\" /* default */;\n    }\n    isCacheEqual(other) {\n        return this.content.sameComponent(other.content, true);\n    }\n    createComponent(container, fallback) {\n        if (this.contentStatus !== 0 /* none */) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache && !this.fromHistory) {\n            try {\n                this.content.componentInstance = this.toComponentInstance(container);\n            }\n            catch (e) {\n                if (fallback !== void 0) {\n                    this.content.setParameters({ id: this.content.componentName });\n                    this.content.setComponent(fallback);\n                    try {\n                        this.content.componentInstance = this.toComponentInstance(container);\n                    }\n                    catch (ee) {\n                        throw e;\n                    }\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        this.contentStatus = 1 /* created */;\n    }\n    destroyComponent() {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 1 /* created */) {\n            return;\n        }\n        // Don't destroy components when stateful\n        this.contentStatus = 0 /* none */;\n    }\n    async canEnter(viewport, previousInstruction) {\n        if (!this.content.componentInstance) {\n            return false;\n        }\n        if (!this.content.componentInstance.canEnter) {\n            return true;\n        }\n        const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n        this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n        const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n        const result = this.content.componentInstance.canEnter(merged, this.instruction, previousInstruction);\n        Reporter.write(10000, 'viewport canEnter', result);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        if (typeof result === 'string') {\n            return [viewport.router.createViewportInstruction(result, viewport)];\n        }\n        return result;\n    }\n    async canLeave(nextInstruction) {\n        if (!this.content.componentInstance || !this.content.componentInstance.canLeave) {\n            return true;\n        }\n        const result = this.content.componentInstance.canLeave(nextInstruction, this.instruction);\n        Reporter.write(10000, 'viewport canLeave', result);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        return result;\n    }\n    async enter(previousInstruction) {\n        // if (!this.reentry && (this.contentStatus !== ContentStatus.created || this.entered)) {\n        if (!this.reentry && (this.contentStatus !== 2 /* loaded */ || this.entered)) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.enter) {\n            const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n            this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n            const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n            await this.content.componentInstance.enter(merged, this.instruction, previousInstruction);\n        }\n        this.entered = true;\n    }\n    async leave(nextInstruction) {\n        if (this.contentStatus !== 4 /* added */ || !this.entered) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.leave) {\n            await this.content.componentInstance.leave(nextInstruction, this.instruction);\n        }\n        this.entered = false;\n    }\n    // eslint-disable-next-line @typescript-eslint/require-await\n    async loadComponent(container, element, viewport) {\n        // if (this.contentStatus !== ContentStatus.created || !this.entered || !this.content.componentInstance) {\n        if (this.contentStatus !== 1 /* created */ || this.entered || !this.content.componentInstance) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache || !this.fromHistory) {\n            const host = element;\n            const controller = Controller.forCustomElement(this.content.componentInstance, container.get(ILifecycle), host, container, void 0, void 0);\n            controller.parent = CustomElement.for(element);\n        }\n        this.contentStatus = 2 /* loaded */;\n    }\n    unloadComponent(cache, stateful = false) {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't unload components when stateful\n        if (!stateful) {\n            this.contentStatus = 1 /* created */;\n        }\n        else {\n            cache.push(this);\n        }\n    }\n    initializeComponent(parent) {\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't initialize cached content or instantiated history content\n        // if (!this.fromCache || !this.fromHistory) {\n        // ((this.content.componentInstance as IRouteableComponent).$controller as IController).parent = parent;\n        this.content.componentInstance.$controller.bind(1024 /* fromStartTask */ | 4096 /* fromBind */);\n        // }\n        this.contentStatus = 3 /* initialized */;\n    }\n    async terminateComponent(stateful = false) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        // Don't terminate cached content\n        // if (!stateful) {\n        await this.content.componentInstance.$controller.unbind(2048 /* fromStopTask */ | 8192 /* fromUnbind */).wait();\n        // ((this.content.componentInstance as IRouteableComponent).$controller as IController).parent = void 0;\n        // }\n        this.contentStatus = 2 /* loaded */;\n    }\n    addComponent(element) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        this.content.componentInstance.$controller.attach(1024 /* fromStartTask */);\n        if (this.fromCache || this.fromHistory) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                const attr = el.getAttribute('au-element-scroll');\n                if (attr) {\n                    const [top, left] = attr.split(',');\n                    el.removeAttribute('au-element-scroll');\n                    el.scrollTo(+left, +top);\n                }\n            }\n        }\n        this.contentStatus = 4 /* added */;\n    }\n    removeComponent(element, stateful = false) {\n        if (this.contentStatus !== 4 /* added */ || this.entered) {\n            return;\n        }\n        if (stateful && element !== null) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                if (el.scrollTop > 0 || el.scrollLeft) {\n                    el.setAttribute('au-element-scroll', `${el.scrollTop},${el.scrollLeft}`);\n                }\n            }\n        }\n        this.content.componentInstance.$controller.detach(2048 /* fromStopTask */);\n        this.contentStatus = 3 /* initialized */;\n    }\n    async freeContent(element, nextInstruction, cache, stateful = false) {\n        switch (this.contentStatus) {\n            case 4 /* added */:\n                await this.leave(nextInstruction);\n                this.removeComponent(element, stateful);\n            case 3 /* initialized */:\n                await this.terminateComponent(stateful);\n            case 2 /* loaded */:\n                this.unloadComponent(cache, stateful);\n            case 1 /* created */:\n                this.destroyComponent();\n        }\n    }\n    toComponentName() {\n        return this.content.componentName;\n    }\n    toComponentType(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentType(container);\n    }\n    toComponentInstance(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentInstance(container);\n    }\n}\n//# sourceMappingURL=viewport-content.js.map","import { ViewportInstruction } from './viewport-instruction';\nimport { Scope } from './scope';\nimport { arrayRemove } from './utils';\nexport class ViewportScope {\n    constructor(name, router, element, owningScope, scope, rootComponentType = null, // temporary. Metadata will probably eliminate it\n    options = {\n        catches: [],\n        source: null,\n    }) {\n        this.name = name;\n        this.router = router;\n        this.element = element;\n        this.rootComponentType = rootComponentType;\n        this.options = options;\n        this.path = null;\n        this.content = null;\n        this.nextContent = null;\n        this.available = true;\n        this.sourceItem = null;\n        this.sourceItemIndex = -1;\n        this.remove = false;\n        this.add = false;\n        this.connectedScope = new Scope(router, scope, owningScope, null, this);\n        if (this.catches.length > 0) {\n            this.content = router.createViewportInstruction(this.catches[0], this.name);\n        }\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return false;\n    }\n    get isViewportScope() {\n        return true;\n    }\n    get isEmpty() {\n        return this.content === null;\n    }\n    get passThroughScope() {\n        return this.rootComponentType === null && this.catches.length === 0;\n    }\n    get siblings() {\n        const parent = this.connectedScope.parent;\n        if (parent === null) {\n            return [this];\n        }\n        return parent.enabledChildren\n            .filter(child => child.isViewportScope && child.viewportScope.name === this.name)\n            .map(child => child.viewportScope);\n    }\n    get source() {\n        return this.options.source || null;\n    }\n    get catches() {\n        let catches = this.options.catches || [];\n        if (typeof catches === 'string') {\n            catches = catches.split(',');\n        }\n        return catches;\n    }\n    get default() {\n        if (this.catches.length > 0) {\n            return this.catches[0];\n        }\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = this.router.createViewportInstruction(content);\n            }\n        }\n        viewportInstruction.viewportScope = this;\n        this.remove = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction)\n            || this.router.instructionResolver.isClearAllViewportsInstruction(viewportInstruction);\n        this.add = this.router.instructionResolver.isAddViewportInstruction(viewportInstruction)\n            && Array.isArray(this.source);\n        if (this.add) {\n            viewportInstruction.componentName = null;\n        }\n        if (this.default !== void 0 && viewportInstruction.componentName === null) {\n            viewportInstruction.componentName = this.default;\n        }\n        this.nextContent = viewportInstruction;\n        return true;\n    }\n    canLeave() {\n        return Promise.resolve(true);\n    }\n    canEnter() {\n        return Promise.resolve(true);\n    }\n    enter() {\n        return Promise.resolve(true);\n    }\n    loadContent() {\n        this.content = !this.remove ? this.nextContent : null;\n        this.nextContent = null;\n        return Promise.resolve(true);\n    }\n    finalizeContentChange() {\n        // console.log('ViewportScope finalizing', this.content);\n        if (this.remove && Array.isArray(this.source)) {\n            this.removeSourceItem();\n        }\n    }\n    abortContentChange() {\n        this.nextContent = null;\n        if (this.add) {\n            const index = this.source.indexOf(this.sourceItem);\n            this.source.splice(index, 1);\n            this.sourceItem = null;\n        }\n        return Promise.resolve();\n    }\n    acceptSegment(segment) {\n        if (segment === null && segment === void 0 || segment.length === 0) {\n            return true;\n        }\n        if (segment === this.router.instructionResolver.clearViewportInstruction\n            || segment === this.router.instructionResolver.addViewportInstruction\n            || segment === this.name) {\n            return true;\n        }\n        if (this.catches.length === 0) {\n            return true;\n        }\n        if (this.catches.includes(segment)) {\n            return true;\n        }\n        if (this.catches.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind() {\n        const source = this.source || [];\n        if (source.length > 0 && this.sourceItem === null) {\n            this.sourceItem = this.getAvailableSourceItem();\n        }\n    }\n    beforeUnbind() {\n        if (this.sourceItem !== null && this.source !== null) {\n            arrayRemove(this.source, (item) => item === this.sourceItem);\n        }\n        this.sourceItem = null;\n    }\n    getAvailableSourceItem() {\n        if (this.source === null) {\n            return null;\n        }\n        const siblings = this.siblings;\n        for (const item of this.source) {\n            if (siblings.every(sibling => sibling.sourceItem !== item)) {\n                return item;\n            }\n        }\n        return null;\n    }\n    addSourceItem() {\n        const item = {};\n        this.source.push(item);\n        return item;\n    }\n    removeSourceItem() {\n        this.sourceItemIndex = this.source.indexOf(this.sourceItem);\n        if (this.sourceItemIndex >= 0) {\n            this.source.splice(this.sourceItemIndex, 1);\n        }\n    }\n    getRoutes() {\n        if (this.rootComponentType !== null) {\n            return this.rootComponentType.routes;\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=viewport-scope.js.map","import { buildQueryString, parseQueryString } from '@aurelia/kernel';\nexport class HandlerEntry {\n    constructor(handler, names) {\n        this.handler = handler;\n        this.names = names;\n    }\n}\n/*\n* An object that is indexed and used for route generation, particularly for dynamic routes.\n*/\nexport class RouteGenerator {\n    constructor(segments, handlers) {\n        this.segments = segments;\n        this.handlers = handlers;\n    }\n}\nexport class TypesRecord {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.stars = 0;\n    }\n}\nexport class RecognizeResult {\n    constructor(handler, params, isDynamic) {\n        this.handler = handler;\n        this.params = params;\n        this.isDynamic = isDynamic;\n    }\n}\nexport class CharSpec {\n    constructor(invalidChars, validChars, repeat) {\n        this.invalidChars = invalidChars;\n        this.validChars = validChars;\n        this.repeat = repeat;\n    }\n    equals(other) {\n        return this.validChars === other.validChars && this.invalidChars === other.invalidChars;\n    }\n}\nexport class State {\n    constructor(charSpec) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n    }\n    put(charSpec) {\n        let state = this.nextStates.find(s => s.charSpec.equals(charSpec));\n        if (state === undefined) {\n            state = new State(charSpec);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n}\nconst specials = [\n    '/', '.', '*', '+', '?', '|',\n    '(', ')', '[', ']', '{', '}', '\\\\'\n];\nconst escapeRegex = new RegExp(`(\\\\${specials.join('|\\\\')})`, 'g');\n// A Segment represents a segment in the original route description.\n// Each Segment type provides an `eachChar` and `regex` method.\n//\n// The `eachChar` method invokes the callback with one or more character\n// specifications. A character specification consumes one or more input\n// characters.\n//\n// The `regex` method returns a regex fragment for the segment. If the\n// segment is a dynamic or star segment, the regex fragment also includes\n// a capture.\n//\n// A character specification contains:\n//\n// * `validChars`: a String with a list of all valid characters, or\n// * `invalidChars`: a String with a list of all invalid characters\n// * `repeat`: true if the character specification can repeat\nexport class StaticSegment {\n    constructor(str, caseSensitive) {\n        this.caseSensitive = caseSensitive;\n        this.optional = false;\n        this.name = str;\n        this.string = str;\n    }\n    eachChar(callback) {\n        const s = this.string;\n        const len = s.length;\n        let i = 0;\n        let ch = '';\n        if (this.caseSensitive) {\n            for (; i < len; ++i) {\n                ch = s.charAt(i);\n                callback(new CharSpec(null, ch, false));\n            }\n        }\n        else {\n            for (; i < len; ++i) {\n                ch = s.charAt(i);\n                callback(new CharSpec(null, ch.toUpperCase() + ch.toLowerCase(), false));\n            }\n        }\n    }\n    regex() {\n        return this.string.replace(escapeRegex, '\\\\$1');\n    }\n    generate(params, consumed) {\n        return this.string;\n    }\n}\nexport class DynamicSegment {\n    constructor(name, optional) {\n        this.name = name;\n        this.optional = optional;\n    }\n    eachChar(callback) {\n        callback(new CharSpec('/', null, true));\n    }\n    regex() {\n        return '([^/]+)';\n    }\n    generate(params, consumed) {\n        consumed[this.name] = true;\n        return params[this.name];\n    }\n}\nexport class StarSegment {\n    constructor(name) {\n        this.name = name;\n        this.optional = false;\n    }\n    eachChar(callback) {\n        callback(new CharSpec('', null, true));\n    }\n    regex() {\n        return '(.+)';\n    }\n    generate(params, consumed) {\n        consumed[this.name] = true;\n        return params[this.name];\n    }\n}\nexport class EpsilonSegment {\n    eachChar(callback) {\n        return;\n    }\n    regex() {\n        return '';\n    }\n    generate(params, consumed) {\n        return '';\n    }\n}\n/**\n * Class that parses route patterns and matches path strings.\n */\nexport class RouteRecognizer {\n    constructor() {\n        this.rootState = new State();\n        this.names = {};\n        this.routes = new Map();\n    }\n    /**\n     * Parse a route pattern and add it to the collection of recognized routes.\n     *\n     * @param route - The route to add.\n     */\n    add(route) {\n        if (Array.isArray(route)) {\n            route.forEach(r => {\n                this.add(r);\n            });\n            return;\n        }\n        let currentState = this.rootState;\n        const skippableStates = [];\n        let regex = '^';\n        const types = new TypesRecord();\n        const names = [];\n        const routeName = route.handler.name;\n        let isEmpty = true;\n        let normalizedRoute = route.path;\n        if (normalizedRoute.startsWith('/')) {\n            normalizedRoute = normalizedRoute.slice(1);\n        }\n        const segments = [];\n        const splitRoute = normalizedRoute.split('/');\n        let part;\n        let segment;\n        for (let i = 0, ii = splitRoute.length; i < ii; ++i) {\n            part = splitRoute[i];\n            // Try to parse a parameter :param?\n            let match = /^:([^?]+)(\\?)?$/.exec(part);\n            if (match) {\n                const [, name, optional] = match;\n                if (name.includes('=')) {\n                    throw new Error(`Parameter ${name} in route ${route} has a default value, which is not supported.`);\n                }\n                segments.push(segment = new DynamicSegment(name, !!optional));\n                names.push(name);\n                types.dynamics++;\n            }\n            else {\n                // Try to parse a star segment *whatever\n                match = /^\\*(.+)$/.exec(part);\n                if (match) {\n                    segments.push(segment = new StarSegment(match[1]));\n                    names.push(match[1]);\n                    types.stars++;\n                }\n                else if (part === '') {\n                    segments.push(new EpsilonSegment());\n                    continue;\n                }\n                else {\n                    segments.push(segment = new StaticSegment(part, route.caseSensitive === true));\n                    types.statics++;\n                }\n            }\n            // Add a representation of the segment to the NFA and regex\n            const firstState = currentState.put(new CharSpec(null, '/', false));\n            let nextState = firstState;\n            segment.eachChar(ch => {\n                nextState = nextState.put(ch);\n            });\n            // add the first part of the next segment to the end of any skipped states\n            for (let j = 0, jj = skippableStates.length; j < jj; j++) {\n                skippableStates[j].nextStates.push(firstState);\n            }\n            // If the segment was optional we don't fast forward to the end of the\n            // segment, but we do hold on to a reference to the end of the segment\n            // for adding future segments. Multiple consecutive optional segments\n            // will accumulate.\n            if (segment.optional) {\n                skippableStates.push(nextState);\n                regex += `(?:/${segment.regex()})?`;\n                // Otherwise, we fast forward to the end of the segment and remove any\n                // references to skipped segments since we don't need them anymore.\n            }\n            else {\n                currentState = nextState;\n                regex += `/${segment.regex()}`;\n                skippableStates.length = 0;\n                isEmpty = false;\n            }\n        }\n        // An \"all optional\" path is technically empty since currentState is this.rootState\n        if (isEmpty) {\n            currentState = currentState.put(new CharSpec(null, '/', false));\n            regex += '/?';\n        }\n        const handlers = [new HandlerEntry(route.handler, names)];\n        this.routes.set(route.handler, new RouteGenerator(segments, handlers));\n        if (routeName) {\n            const routeNames = Array.isArray(routeName) ? routeName : [routeName];\n            for (let i = 0; i < routeNames.length; i++) {\n                if (!(routeNames[i] in this.names)) {\n                    this.names[routeNames[i]] = new RouteGenerator(segments, handlers);\n                }\n            }\n        }\n        // Any trailing skipped states need to be endpoints and need to have\n        // handlers afterAttach.\n        for (let i = 0; i < skippableStates.length; i++) {\n            const state = skippableStates[i];\n            state.handlers = handlers;\n            state.regex = new RegExp(`${regex}$`, route.caseSensitive ? '' : 'i');\n            state.types = types;\n        }\n        currentState.handlers = handlers;\n        currentState.regex = new RegExp(`${regex}$`, route.caseSensitive ? '' : 'i');\n        currentState.types = types;\n        return currentState;\n    }\n    /**\n     * Retrieve a RouteGenerator for a route by name or RouteConfig (RouteHandler).\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @returns The RouteGenerator for that route.\n     */\n    getRoute(nameOrRoute) {\n        return typeof nameOrRoute === 'string' ? this.names[nameOrRoute] : this.routes.get(nameOrRoute);\n    }\n    /**\n     * Retrieve the handlers registered for the route by name or RouteConfig (RouteHandler).\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @returns The handlers.\n     */\n    handlersFor(nameOrRoute) {\n        const route = this.getRoute(nameOrRoute);\n        if (!route) {\n            throw new Error(`There is no route named ${nameOrRoute}`);\n        }\n        return [...route.handlers];\n    }\n    /**\n     * Check if this RouteRecognizer recognizes a route by name or RouteConfig (RouteHandler).\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @returns True if the named route is recognized.\n     */\n    hasRoute(nameOrRoute) {\n        return !!this.getRoute(nameOrRoute);\n    }\n    /**\n     * Generate a path and query string from a route name or RouteConfig (RouteHandler) and params object.\n     *\n     * @param nameOrRoute - The name of the route or RouteConfig object.\n     * @param params - The route params to use when populating the pattern.\n     * Properties not required by the pattern will be appended to the query string.\n     * @returns The generated absolute path and query string.\n     */\n    generate(nameOrRoute, params) {\n        const route = this.getRoute(nameOrRoute);\n        if (!route) {\n            throw new Error(`There is no route named ${nameOrRoute}`);\n        }\n        const handler = route.handlers[0].handler;\n        if (handler.generationUsesHref) {\n            return handler.href;\n        }\n        const routeParams = { ...params };\n        const segments = route.segments;\n        const consumed = {};\n        let output = '';\n        for (let i = 0, l = segments.length; i < l; i++) {\n            const segment = segments[i];\n            if (segment instanceof EpsilonSegment) {\n                continue;\n            }\n            const segmentValue = segment.generate(routeParams, consumed);\n            if (segmentValue == null) {\n                if (!segment.optional) {\n                    throw new Error(`A value is required for route parameter '${segment.name}' in route '${nameOrRoute}'.`);\n                }\n            }\n            else {\n                output += '/';\n                output += segmentValue;\n            }\n        }\n        if (!output.startsWith('/')) {\n            output = `/${output}`;\n        }\n        // remove params used in the path and add the rest to the querystring\n        for (const param in consumed) {\n            Reflect.deleteProperty(routeParams, param);\n        }\n        const queryString = buildQueryString(routeParams);\n        output += queryString ? `?${queryString}` : '';\n        return output;\n    }\n    /**\n     * Match a path string against registered route patterns.\n     *\n     * @param path - The path to attempt to match.\n     * @returns Array of objects containing `handler`, `params`, and\n     * `isDynamic` values for the matched route(s), or undefined if no match\n     * was found.\n     */\n    recognize(path) {\n        let states = [this.rootState];\n        let queryParams = {};\n        let isSlashDropped = false;\n        let normalizedPath = path;\n        const queryStart = normalizedPath.indexOf('?');\n        if (queryStart !== -1) {\n            const queryString = normalizedPath.slice(queryStart + 1);\n            normalizedPath = normalizedPath.slice(0, queryStart);\n            queryParams = parseQueryString(queryString);\n        }\n        normalizedPath = decodeURI(normalizedPath);\n        if (!normalizedPath.startsWith('/')) {\n            normalizedPath = `/${normalizedPath}`;\n        }\n        let pathLen = normalizedPath.length;\n        if (pathLen > 1 && normalizedPath.charAt(pathLen - 1) === '/') {\n            normalizedPath = normalizedPath.slice(0, -1);\n            isSlashDropped = true;\n            --pathLen;\n        }\n        for (let i = 0; i < pathLen; ++i) {\n            const nextStates = [];\n            const ch = normalizedPath.charAt(i);\n            states.forEach(state => {\n                state.nextStates.forEach(nextState => {\n                    if (nextState.charSpec.validChars !== null) {\n                        if (nextState.charSpec.validChars.includes(ch)) {\n                            nextStates.push(nextState);\n                        }\n                    }\n                    else if (nextState.charSpec.invalidChars !== null\n                        && !nextState.charSpec.invalidChars.includes(ch)) {\n                        nextStates.push(nextState);\n                    }\n                });\n            });\n            states = nextStates;\n            if (states.length === 0) {\n                break;\n            }\n        }\n        const solutions = [];\n        for (let i = 0, l = states.length; i < l; i++) {\n            if (states[i].handlers) {\n                solutions.push(states[i]);\n            }\n        }\n        // This is a somewhat naive strategy, but should work in a lot of cases\n        // A better strategy would properly resolve /posts/:id/new and /posts/edit/:id.\n        //\n        // This strategy generally prefers more static and less dynamic matching.\n        // Specifically, it\n        //\n        //  * prefers fewer stars to more, then\n        //  * prefers using stars for less of the match to more, then\n        //  * prefers fewer dynamic segments to more, then\n        //  * prefers more static segments to more\n        solutions.sort((a, b) => {\n            if (a.types.stars !== b.types.stars) {\n                return a.types.stars - b.types.stars;\n            }\n            if (a.types.stars) {\n                if (a.types.statics !== b.types.statics) {\n                    return b.types.statics - a.types.statics;\n                }\n                if (a.types.dynamics !== b.types.dynamics) {\n                    return b.types.dynamics - a.types.dynamics;\n                }\n            }\n            if (a.types.dynamics !== b.types.dynamics) {\n                return a.types.dynamics - b.types.dynamics;\n            }\n            if (a.types.statics !== b.types.statics) {\n                return b.types.statics - a.types.statics;\n            }\n            return 0;\n        });\n        const solution = solutions[0];\n        if (solution && solution.handlers) {\n            // if a trailing slash was dropped and a star segment is the last segment\n            // specified, put the trailing slash back\n            if (isSlashDropped && solution.regex.source.endsWith('(.+)$')) {\n                normalizedPath = `${normalizedPath}/`;\n            }\n            // eslint-disable-next-line @typescript-eslint/prefer-regexp-exec\n            const captures = normalizedPath.match(solution.regex);\n            let currentCapture = 1;\n            const result = [];\n            result.queryParams = queryParams;\n            solution.handlers.forEach(handler => {\n                const params = {};\n                handler.names.forEach(name => {\n                    params[name] = captures[currentCapture++];\n                });\n                result.push(new RecognizeResult(handler.handler, params, handler.names.length > 0));\n            });\n            return result;\n        }\n        return void 0;\n    }\n}\n//# sourceMappingURL=route-recognizer.js.map","export class FoundRoute {\n    constructor(match = null, matching = '', instructions = [], remaining = '') {\n        this.match = match;\n        this.matching = matching;\n        this.instructions = instructions;\n        this.remaining = remaining;\n    }\n    get foundConfiguration() {\n        return this.match !== null;\n    }\n    get foundInstructions() {\n        return this.instructions.length > 0;\n    }\n    get hasRemaining() {\n        return this.remaining !== null && this.remaining.length > 0;\n    }\n}\n//# sourceMappingURL=found-route.js.map","import { arrayRemove } from './utils';\nexport class Collection extends Array {\n    constructor() {\n        super(...arguments);\n        this.currentIndex = -1;\n    }\n    next() {\n        if (this.length > this.currentIndex + 1) {\n            return this[++this.currentIndex];\n        }\n        else {\n            this.currentIndex = -1;\n            return null;\n        }\n    }\n    removeCurrent() {\n        this.splice(this.currentIndex--, 1);\n    }\n    remove(instruction) {\n        arrayRemove(this, value => value === instruction);\n    }\n}\n//# sourceMappingURL=collection.js.map","import { ViewportScope } from './viewport-scope';\nimport { RouteRecognizer } from './route-recognizer';\nimport { FoundRoute } from './found-route';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { Viewport } from './viewport';\nimport { arrayRemove } from './utils';\nimport { Collection } from './collection';\nexport class Scope {\n    constructor(router, hasScope, owningScope, viewport = null, viewportScope = null, rootComponentType = null) {\n        this.router = router;\n        this.hasScope = hasScope;\n        this.owningScope = owningScope;\n        this.viewport = viewport;\n        this.viewportScope = viewportScope;\n        this.rootComponentType = rootComponentType;\n        this.id = '.';\n        this.parent = null;\n        this.children = [];\n        this.replacedChildren = [];\n        this.path = null;\n        this.enabled = true;\n        // Support collection feature in viewport scopes\n        this.childCollections = {};\n        this.owningScope = owningScope || this;\n        this.scope = this.hasScope ? this : this.owningScope;\n    }\n    get isViewport() {\n        return this.viewport !== null;\n    }\n    get isViewportScope() {\n        return this.viewportScope !== null;\n    }\n    get passThroughScope() {\n        return this.isViewportScope && this.viewportScope.passThroughScope;\n    }\n    get owner() {\n        if (this.isViewport) {\n            return this.viewport;\n        }\n        if (this.isViewportScope) {\n            return this.viewportScope;\n        }\n        return null;\n    }\n    get enabledChildren() {\n        return this.children.filter(scope => scope.enabled);\n    }\n    get hoistedChildren() {\n        const scopes = this.enabledChildren;\n        while (scopes.some(scope => scope.passThroughScope)) {\n            for (const scope of scopes.slice()) {\n                if (scope.passThroughScope) {\n                    const index = scopes.indexOf(scope);\n                    scopes.splice(index, 1, ...scope.enabledChildren);\n                }\n            }\n        }\n        return scopes;\n    }\n    get enabledViewports() {\n        return this.children.filter(scope => scope.isViewport && scope.enabled)\n            .map(scope => scope.viewport);\n    }\n    get viewportInstruction() {\n        if (this.isViewportScope) {\n            return this.viewportScope.content;\n        }\n        if (this.isViewport) {\n            return this.viewport.content.content;\n        }\n        return null;\n    }\n    getEnabledViewports(viewportScopes) {\n        return viewportScopes.filter(scope => !scope.isViewportScope).map(scope => scope.viewport).reduce((viewports, viewport) => {\n            viewports[viewport.name] = viewport;\n            return viewports;\n        }, {});\n    }\n    getOwnedViewports(includeDisabled = false) {\n        return this.allViewports(includeDisabled).filter(viewport => viewport.owningScope === this);\n    }\n    getOwnedScopes(includeDisabled = false) {\n        const scopes = this.allScopes(includeDisabled).filter(scope => scope.owningScope === this);\n        // Hoist children to pass through scopes\n        for (const scope of scopes.slice()) {\n            if (scope.passThroughScope) {\n                const index = scopes.indexOf(scope);\n                scopes.splice(index, 1, ...scope.getOwnedScopes());\n            }\n        }\n        return scopes;\n    }\n    // Note: This can't change state other than the instructions!\n    findViewports(instructions, alreadyFound, disregardViewports = false) {\n        const foundViewports = [];\n        let remainingInstructions = [];\n        const ownedScopes = this.getOwnedScopes();\n        // Get a shallow copy of all available manual viewport scopes\n        const viewportScopes = ownedScopes.filter(scope => scope.isViewportScope).map(scope => scope.viewportScope);\n        const availableViewportScopes = viewportScopes.filter(viewportScope => alreadyFound.every(found => found.viewportScope !== viewportScope));\n        // Get a shallow copy of all available viewports\n        const availableViewports = { ...this.getEnabledViewports(ownedScopes) };\n        for (const instruction of alreadyFound.filter(found => found.scope === this)) {\n            availableViewports[instruction.viewportName] = null;\n        }\n        const viewportInstructions = new Collection(...instructions.slice());\n        let instruction = null;\n        // The viewport scope is already known\n        while ((instruction = viewportInstructions.next()) !== null) {\n            if (instruction.viewportScope !== null && !this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                remainingInstructions.push(...this.foundViewportScope(instruction, instruction.viewportScope));\n                foundViewports.push(instruction);\n                arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // The viewport is already known\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                if (instruction.viewport) {\n                    remainingInstructions.push(...this.foundViewport(instruction, instruction.viewport, disregardViewports));\n                    foundViewports.push(instruction);\n                    availableViewports[instruction.viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Viewport scopes have priority\n        while ((instruction = viewportInstructions.next()) !== null) {\n            for (let viewportScope of viewportScopes) {\n                if (viewportScope.acceptSegment(instruction.componentName)) {\n                    if (Array.isArray(viewportScope.source)) {\n                        // console.log('available', viewportScope.available, source);\n                        let available = availableViewportScopes.find(available => available.name === viewportScope.name);\n                        if (available === void 0 || this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                            const item = viewportScope.addSourceItem();\n                            available = this.getOwnedScopes()\n                                .filter(scope => scope.isViewportScope)\n                                .map(scope => scope.viewportScope)\n                                .find(viewportScope => viewportScope.sourceItem === item);\n                        }\n                        viewportScope = available;\n                    }\n                    remainingInstructions.push(...this.foundViewportScope(instruction, viewportScope));\n                    foundViewports.push(instruction);\n                    arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                    viewportInstructions.removeCurrent();\n                    break;\n                }\n            }\n        }\n        // Configured viewport is ruling\n        while ((instruction = viewportInstructions.next()) !== null) {\n            instruction.needsViewportDescribed = true;\n            for (const name in availableViewports) {\n                if (Object.prototype.hasOwnProperty.call(availableViewports, name)) {\n                    const viewport = availableViewports[name];\n                    // TODO: Also check if (resolved) component wants a specific viewport\n                    if (viewport && viewport.wantComponent(instruction.componentName)) {\n                        const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                        foundViewports.push(instruction);\n                        remainingInstructions.push(...remaining);\n                        availableViewports[name] = null;\n                        viewportInstructions.removeCurrent();\n                        break;\n                    }\n                }\n            }\n        }\n        // Next in line is specified viewport (but not if we're disregarding viewports)\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                const name = instruction.viewportName;\n                if (!name || !name.length) {\n                    continue;\n                }\n                const newScope = instruction.ownsScope;\n                if (!this.getEnabledViewports(ownedScopes)[name]) {\n                    continue;\n                    // TODO: No longer pre-creating viewports. Evaluate!\n                    this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                    availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                }\n                const viewport = availableViewports[name];\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Finally, only one accepting viewport left?\n        while ((instruction = viewportInstructions.next()) !== null) {\n            const remainingViewports = [];\n            for (const name in availableViewports) {\n                if (Object.prototype.hasOwnProperty.call(availableViewports, name)) {\n                    const viewport = availableViewports[name];\n                    if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                        remainingViewports.push(viewport);\n                    }\n                }\n            }\n            if (remainingViewports.length === 1) {\n                const viewport = remainingViewports.shift();\n                const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                foundViewports.push(instruction);\n                remainingInstructions.push(...remaining);\n                availableViewports[viewport.name] = null;\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // If we're ignoring viewports, we now match them anyway\n        if (disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                let viewport = instruction.viewport;\n                if (!viewport) {\n                    const name = instruction.viewportName;\n                    if (!name || !name.length) {\n                        continue;\n                    }\n                    const newScope = instruction.ownsScope;\n                    if (!this.getEnabledViewports(ownedScopes)[name]) {\n                        continue;\n                        // TODO: No longer pre-creating viewports. Evaluate!\n                        this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                        availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                    }\n                    viewport = availableViewports[name];\n                }\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        remainingInstructions = [...viewportInstructions, ...remainingInstructions];\n        return {\n            foundViewports,\n            remainingInstructions,\n        };\n    }\n    foundViewportScope(instruction, viewportScope) {\n        instruction.viewportScope = viewportScope;\n        instruction.needsViewportDescribed = false;\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewportScope.scope.scope;\n            }\n        }\n        return remaining;\n    }\n    foundViewport(instruction, viewport, withoutViewports, doesntNeedViewportDescribed = false) {\n        instruction.setViewport(viewport);\n        if (doesntNeedViewportDescribed) {\n            instruction.needsViewportDescribed = false;\n        }\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewport.scope;\n            }\n        }\n        return remaining;\n    }\n    addViewport(name, element, container, options = {}) {\n        let viewport = this.getEnabledViewports(this.getOwnedScopes())[name];\n        // Each au-viewport element has its own Viewport\n        if (element && viewport && viewport.element !== null && viewport.element !== element) {\n            viewport.enabled = false;\n            viewport = this.getOwnedViewports(true).find(child => child.name === name && child.element === element) || null;\n            if (viewport) {\n                viewport.enabled = true;\n            }\n        }\n        if (!viewport) {\n            viewport = new Viewport(this.router, name, null, null, this.scope, !!options.scope, options);\n            this.addChild(viewport.connectedScope);\n        }\n        // TODO: Either explain why || instead of && here (might only need one) or change it to && if that should turn out to not be relevant\n        if (element || container) {\n            viewport.setElement(element, container, options);\n        }\n        return viewport;\n    }\n    removeViewport(viewport, element, container) {\n        if ((!element && !container) || viewport.remove(element, container)) {\n            this.removeChild(viewport.connectedScope);\n            return true;\n        }\n        return false;\n    }\n    addViewportScope(name, element, options = {}) {\n        const viewportScope = new ViewportScope(name, this.router, element, this.scope, true, null, options);\n        this.addChild(viewportScope.connectedScope);\n        return viewportScope;\n    }\n    removeViewportScope(viewportScope) {\n        // viewportScope.remove();\n        this.removeChild(viewportScope.connectedScope);\n        return true;\n    }\n    addChild(scope) {\n        if (!this.children.some(vp => vp === scope)) {\n            if (scope.parent !== null) {\n                scope.parent.removeChild(scope);\n            }\n            this.children.push(scope);\n            scope.parent = this;\n        }\n    }\n    removeChild(scope) {\n        const index = this.children.indexOf(scope);\n        if (index >= 0) {\n            this.children.splice(index, 1);\n            scope.parent = null;\n        }\n    }\n    clearReplacedChildren() {\n        this.replacedChildren = [];\n    }\n    disableReplacedChildren() {\n        this.replacedChildren = this.enabledChildren;\n        for (const scope of this.replacedChildren) {\n            scope.enabled = false;\n        }\n    }\n    reenableReplacedChildren() {\n        for (const scope of this.replacedChildren) {\n            scope.enabled = true;\n        }\n    }\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        return this.allScopes(includeDisabled, includeReplaced).filter(scope => scope.isViewport).map(scope => scope.viewport);\n    }\n    allScopes(includeDisabled = false, includeReplaced = false) {\n        const scopes = includeDisabled ? this.children.slice() : this.enabledChildren;\n        for (const scope of scopes.slice()) {\n            scopes.push(...scope.allScopes(includeDisabled, includeReplaced));\n        }\n        return scopes;\n    }\n    reparentViewportInstructions() {\n        const scopes = this.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && scope.viewportInstruction.componentName);\n        if (!scopes.length) {\n            return null;\n        }\n        for (const scope of scopes) {\n            const childInstructions = scope.reparentViewportInstructions();\n            scope.viewportInstruction.nextScopeInstructions =\n                childInstructions !== null && childInstructions.length > 0 ? childInstructions : null;\n        }\n        return scopes.map(scope => scope.viewportInstruction);\n    }\n    findMatchingRoute(path) {\n        if (this.isViewportScope && !this.passThroughScope) {\n            return this.findMatchingRouteInRoutes(path, this.viewportScope.getRoutes());\n        }\n        if (this.isViewport) {\n            return this.findMatchingRouteInRoutes(path, this.viewport.getRoutes());\n        }\n        // TODO: Match specified names here\n        for (const child of this.enabledChildren) {\n            const found = child.findMatchingRoute(path);\n            if (found !== null) {\n                return found;\n            }\n        }\n        return null;\n    }\n    async canLeave() {\n        const results = await Promise.all(this.children.map(child => child.viewport !== null\n            ? child.viewport.canLeave()\n            : child.canLeave()));\n        return !results.some(result => result === false);\n    }\n    findMatchingRouteInRoutes(path, routes) {\n        if (!Array.isArray(routes)) {\n            return null;\n        }\n        routes = routes.map(route => this.ensureProperRoute(route));\n        const recognizableRoutes = routes.map(route => ({ path: route.path, handler: { name: route.id, route } }));\n        for (let i = 0, ilen = recognizableRoutes.length; i < ilen; i++) {\n            const newRoute = { ...recognizableRoutes[i] };\n            newRoute.path += '/*remainingPath';\n            recognizableRoutes.push(newRoute);\n        }\n        const found = new FoundRoute();\n        let params = {};\n        if (path.startsWith('/') || path.startsWith('+')) {\n            path = path.slice(1);\n        }\n        const recognizer = new RouteRecognizer();\n        recognizer.add(recognizableRoutes);\n        const result = recognizer.recognize(path);\n        if (result !== void 0 && result.length > 0) {\n            found.match = result[0].handler.route;\n            found.matching = path;\n            params = result[0].params;\n            if (params.remainingPath !== void 0 && params.remainingPath.length > 0) {\n                found.remaining = params.remainingPath;\n                Reflect.deleteProperty(params, 'remainingPath');\n                found.matching = found.matching.slice(0, found.matching.indexOf(found.remaining));\n            }\n        }\n        if (found.foundConfiguration) {\n            // clone it so config doesn't get modified\n            found.instructions = this.router.instructionResolver.cloneViewportInstructions(found.match.instructions, false, true);\n            const instructions = found.instructions.slice();\n            while (instructions.length > 0) {\n                const instruction = instructions.shift();\n                instruction.addParameters(params);\n                instruction.route = '';\n                if (instruction.nextScopeInstructions !== null) {\n                    instructions.unshift(...instruction.nextScopeInstructions);\n                }\n            }\n            if (found.instructions.length > 0) {\n                found.instructions[0].route = found.matching;\n            }\n        }\n        return found;\n    }\n    ensureProperRoute(route) {\n        if (route.id === void 0) {\n            route.id = route.path;\n        }\n        route.instructions = NavigationInstructionResolver.toViewportInstructions(this.router, route.instructions);\n        return route;\n    }\n}\n//# sourceMappingURL=scope.js.map","import { Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '@aurelia/runtime';\nimport { arrayRemove } from './utils';\nimport { ViewportContent } from './viewport-content';\nimport { ViewportInstruction } from './viewport-instruction';\nimport { Scope } from './scope';\nexport class Viewport {\n    constructor(router, name, element, container, owningScope, scope, options = {}) {\n        this.router = router;\n        this.name = name;\n        this.element = element;\n        this.container = container;\n        this.options = options;\n        this.nextContent = null;\n        this.forceRemove = false;\n        this.path = null;\n        this.clear = false;\n        this.elementResolve = null;\n        this.previousViewportState = null;\n        this.cache = [];\n        this.historyCache = [];\n        this.content = new ViewportContent();\n        this.connectedScope = new Scope(router, scope, owningScope, this);\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return true;\n    }\n    get isViewportScope() {\n        return false;\n    }\n    get isEmpty() {\n        return this.content.componentInstance === null;\n    }\n    get doForceRemove() {\n        let scope = this.connectedScope;\n        while (scope !== null) {\n            if (scope.viewport !== null && scope.viewport.forceRemove) {\n                return true;\n            }\n            scope = scope.parent;\n        }\n        return false;\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = this.router.createViewportInstruction(content);\n            }\n        }\n        viewportInstruction.setViewport(this);\n        this.clear = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction);\n        // Can have a (resolved) type or a string (to be resolved later)\n        this.nextContent = new ViewportContent(!this.clear ? viewportInstruction : void 0, instruction, this.container);\n        this.nextContent.fromHistory = this.nextContent.componentInstance && instruction.navigation\n            ? !!instruction.navigation.back || !!instruction.navigation.forward\n            : false;\n        if (this.options.stateful) {\n            // TODO: Add a parameter here to decide required equality\n            const cached = this.cache.find((item) => this.nextContent.isCacheEqual(item));\n            if (cached) {\n                this.nextContent = cached;\n                this.nextContent.fromCache = true;\n            }\n            else {\n                this.cache.push(this.nextContent);\n            }\n        }\n        // Children that will be replaced (unless added again) by next content. Will\n        // be re-enabled on cancel\n        this.connectedScope.clearReplacedChildren();\n        // If we get the same _instance_, don't do anything (happens with cached and history)\n        if (this.nextContent.componentInstance !== null && this.content.componentInstance === this.nextContent.componentInstance) {\n            this.nextContent = null;\n            return false;\n        }\n        // ReentryBehavior 'refresh' takes precedence\n        if (!this.content.equalComponent(this.nextContent) ||\n            instruction.navigation.refresh ||\n            this.content.reentryBehavior() === \"refresh\" /* refresh */) {\n            this.connectedScope.disableReplacedChildren();\n            return true;\n        }\n        // Explicitly don't allow navigation back to the same component again\n        if (this.content.reentryBehavior() === \"disallow\" /* disallow */) {\n            this.nextContent = null;\n            return false;\n        }\n        // Explicitly re-enter same component again\n        if (this.content.reentryBehavior() === \"enter\" /* enter */) {\n            this.content.reentry = true;\n            this.nextContent.content.setComponent(this.content.componentInstance);\n            this.nextContent.contentStatus = this.content.contentStatus;\n            this.nextContent.reentry = this.content.reentry;\n            return true;\n        }\n        // ReentryBehavior is now 'default'\n        // Requires updated parameters if viewport stateful\n        if (this.options.stateful &&\n            this.content.equalParameters(this.nextContent)) {\n            this.nextContent = null;\n            return false;\n        }\n        // Default is to trigger a refresh (without a check of parameters)\n        this.connectedScope.disableReplacedChildren();\n        return true;\n    }\n    setElement(element, container, options) {\n        options = options || {};\n        if (this.element !== element) {\n            // TODO: Restore this state on navigation cancel\n            this.previousViewportState = { ...this };\n            this.clearState();\n            this.element = element;\n            if (options.usedBy) {\n                this.options.usedBy = options.usedBy;\n            }\n            if (options.default) {\n                this.options.default = options.default;\n            }\n            if (options.fallback) {\n                this.options.fallback = options.fallback;\n            }\n            if (options.noLink) {\n                this.options.noLink = options.noLink;\n            }\n            if (options.noHistory) {\n                this.options.noHistory = options.noHistory;\n            }\n            if (options.stateful) {\n                this.options.stateful = options.stateful;\n            }\n            if (this.elementResolve) {\n                this.elementResolve();\n            }\n        }\n        // TODO: Might not need this? Figure it out\n        // if (container) {\n        //   container['viewportName'] = this.name;\n        // }\n        if (this.container !== container) {\n            this.container = container;\n        }\n        if (!this.content.componentInstance && (!this.nextContent || !this.nextContent.componentInstance) && this.options.default) {\n            const instructions = this.router.instructionResolver.parseViewportInstructions(this.options.default);\n            for (const instruction of instructions) {\n                // Set to name to be delayed one turn\n                instruction.setViewport(this.name);\n                instruction.scope = this.owningScope;\n                instruction.default = true;\n            }\n            this.router.goto(instructions, { append: true }).catch(error => { throw error; });\n        }\n    }\n    async remove(element, container) {\n        if (this.element === element && this.container === container) {\n            if (this.content.componentInstance) {\n                await this.content.freeContent(this.element, (this.nextContent ? this.nextContent.instruction : null), this.historyCache, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful); // .catch(error => { throw error; });\n            }\n            if (this.doForceRemove) {\n                await Promise.all(this.historyCache.map(content => content.freeContent(null, null, this.historyCache, false)));\n                this.historyCache = [];\n            }\n            return true;\n        }\n        return false;\n    }\n    async canLeave() {\n        const canLeaveChildren = await this.connectedScope.canLeave();\n        if (!canLeaveChildren) {\n            return false;\n        }\n        return this.content.canLeave(this.nextContent ? this.nextContent.instruction : null);\n    }\n    async canEnter() {\n        if (this.clear) {\n            return true;\n        }\n        if ((this.nextContent.content || null) === null) {\n            return false;\n        }\n        await this.waitForElement();\n        this.nextContent.createComponent(this.container, this.options.fallback);\n        await this.nextContent.loadComponent(this.container, this.element, this);\n        return this.nextContent.canEnter(this, this.content.instruction);\n    }\n    async enter() {\n        Reporter.write(10000, 'Viewport enter', this.name);\n        if (this.clear) {\n            return true;\n        }\n        if (!this.nextContent || !this.nextContent.componentInstance) {\n            return false;\n        }\n        await this.nextContent.enter(this.content.instruction);\n        // await this.nextContent.loadComponent(this.container as IContainer, this.element as Element, this);\n        this.nextContent.initializeComponent(CustomElement.for(this.element));\n        return true;\n    }\n    async loadContent() {\n        Reporter.write(10000, 'Viewport loadContent', this.name);\n        // No need to wait for next component activation\n        if (this.content.componentInstance && !this.nextContent.componentInstance) {\n            await this.content.leave(this.nextContent.instruction);\n            await this.unloadContent();\n        }\n        if (this.nextContent.componentInstance) {\n            if (this.content.componentInstance !== this.nextContent.componentInstance) {\n                this.nextContent.addComponent(this.element);\n            }\n            else {\n                this.connectedScope.reenableReplacedChildren();\n            }\n            // Only when next component activation is done\n            if (this.content.componentInstance) {\n                await this.content.leave(this.nextContent.instruction);\n                if (!this.content.reentry && this.content.componentInstance !== this.nextContent.componentInstance) {\n                    await this.unloadContent();\n                }\n            }\n            this.content = this.nextContent;\n            this.content.reentry = false;\n        }\n        if (this.clear) {\n            this.content = new ViewportContent(void 0, this.nextContent.instruction);\n        }\n        this.nextContent = null;\n        return true;\n    }\n    finalizeContentChange() {\n        this.previousViewportState = null;\n        this.connectedScope.clearReplacedChildren();\n    }\n    async abortContentChange() {\n        this.connectedScope.reenableReplacedChildren();\n        await this.nextContent.freeContent(this.element, this.nextContent.instruction, this.historyCache, this.router.statefulHistory || this.options.stateful);\n        if (this.previousViewportState) {\n            Object.assign(this, this.previousViewportState);\n        }\n    }\n    // TODO: Deal with non-string components\n    wantComponent(component) {\n        let usedBy = this.options.usedBy || [];\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        return usedBy.includes(component);\n    }\n    // TODO: Deal with non-string components\n    acceptComponent(component) {\n        if (component === '-' || component === null) {\n            return true;\n        }\n        let usedBy = this.options.usedBy;\n        if (!usedBy || !usedBy.length) {\n            return true;\n        }\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        if (usedBy.includes(component)) {\n            return true;\n        }\n        if (usedBy.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind(flags) {\n        if (this.content.componentInstance) {\n            this.content.initializeComponent(CustomElement.for(this.element));\n        }\n    }\n    async beforeAttach(flags) {\n        this.enabled = true;\n        if (this.content.componentInstance) {\n            // Only acts if not already entered\n            await this.content.enter(this.content.instruction);\n            this.content.addComponent(this.element);\n        }\n    }\n    async beforeDetach(flags) {\n        if (this.content.componentInstance) {\n            // Only acts if not already left\n            await this.content.leave(this.content.instruction);\n            this.content.removeComponent(this.element, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n        this.enabled = false;\n    }\n    async beforeUnbind(flags) {\n        if (this.content.componentInstance) {\n            await this.content.terminateComponent(this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n    }\n    async freeContent(component) {\n        const content = this.historyCache.find(cached => cached.componentInstance === component);\n        if (content !== void 0) {\n            this.forceRemove = true;\n            await content.freeContent(null, null, this.historyCache, false);\n            this.forceRemove = false;\n            arrayRemove(this.historyCache, (cached => cached === content));\n        }\n    }\n    getRoutes() {\n        let componentType = this.nextContent !== null\n            && this.nextContent.content !== null\n            ? this.nextContent.content.componentType\n            : this.content.content.componentType;\n        // TODO: This is going away once Metadata is in!\n        if (componentType === null || componentType === void 0) {\n            const controller = CustomElement.for(this.element);\n            componentType = controller.context.componentType;\n        }\n        if (componentType === null || componentType === void 0) {\n            return null;\n        }\n        const routes = componentType.routes;\n        return Array.isArray(routes) ? routes : null;\n    }\n    async unloadContent() {\n        this.content.removeComponent(this.element, this.router.statefulHistory || this.options.stateful);\n        await this.content.terminateComponent(this.router.statefulHistory || this.options.stateful);\n        this.content.unloadComponent(this.historyCache, this.router.statefulHistory || this.options.stateful);\n        this.content.destroyComponent();\n    }\n    clearState() {\n        this.options = {};\n        this.content = new ViewportContent();\n        this.cache = [];\n    }\n    async waitForElement() {\n        if (this.element) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n            this.elementResolve = resolve;\n        });\n    }\n}\n//# sourceMappingURL=viewport.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nexport const ComponentAppellationResolver = {\n    isName: function (component) {\n        return typeof component === 'string';\n    },\n    isType: function (component) {\n        return CustomElement.isType(component);\n    },\n    isInstance: function (component) {\n        return !ComponentAppellationResolver.isName(component) && !ComponentAppellationResolver.isType(component);\n    },\n    getName: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return component;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return CustomElement.getDefinition(component).name;\n        }\n        else {\n            return ComponentAppellationResolver.getName(component.constructor);\n        }\n    },\n    getType: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return component;\n        }\n        else {\n            return component.constructor;\n        }\n    },\n    getInstance: function (component) {\n        if (ComponentAppellationResolver.isName(component) || ComponentAppellationResolver.isType(component)) {\n            return null;\n        }\n        else {\n            return component;\n        }\n    },\n};\nexport const ViewportHandleResolver = {\n    isName: function (viewport) {\n        return typeof viewport === 'string';\n    },\n    isInstance: function (viewport) {\n        return viewport instanceof Viewport;\n    },\n    getName: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return viewport;\n        }\n        else {\n            return viewport ? (viewport).name : null;\n        }\n    },\n    getInstance: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return null;\n        }\n        else {\n            return viewport;\n        }\n    },\n};\nexport const NavigationInstructionResolver = {\n    createViewportInstructions: function (router, navigationInstructions, options) {\n        options = options || {};\n        let scope = null;\n        if (options.context) {\n            scope = router.findScope(options.context);\n            if (typeof navigationInstructions === 'string') {\n                // If it's not from scope root, figure out which scope\n                if (!navigationInstructions.startsWith('/')) {\n                    // Scope modifications\n                    if (navigationInstructions.startsWith('.')) {\n                        // The same as no scope modification\n                        if (navigationInstructions.startsWith('./')) {\n                            navigationInstructions = navigationInstructions.slice(2);\n                        }\n                        // Find out how many scopes upwards we should move\n                        while (navigationInstructions.startsWith('../')) {\n                            scope = scope.parent || scope;\n                            navigationInstructions = navigationInstructions.slice(3);\n                        }\n                    }\n                    if (scope.path !== null) {\n                        navigationInstructions = `${scope.path}/${navigationInstructions}`;\n                        scope = router.rootScope.scope;\n                    }\n                }\n                else { // Specified root scope with /\n                    scope = router.rootScope.scope;\n                }\n            }\n            else {\n                navigationInstructions = NavigationInstructionResolver.toViewportInstructions(router, navigationInstructions);\n                for (const instruction of navigationInstructions) {\n                    if (instruction.scope === null) {\n                        instruction.scope = scope;\n                    }\n                }\n            }\n        }\n        return {\n            instructions: navigationInstructions,\n            scope,\n        };\n    },\n    toViewportInstructions: function (router, navigationInstructions) {\n        if (!Array.isArray(navigationInstructions)) {\n            return NavigationInstructionResolver.toViewportInstructions(router, [navigationInstructions]);\n        }\n        const instructions = [];\n        for (const instruction of navigationInstructions) {\n            if (typeof instruction === 'string') {\n                instructions.push(...router.instructionResolver.parseViewportInstructions(instruction));\n            }\n            else if (instruction instanceof ViewportInstruction) {\n                instructions.push(instruction);\n            }\n            else if (instruction.component) {\n                const viewportComponent = instruction;\n                const newInstruction = router.createViewportInstruction(viewportComponent.component, viewportComponent.viewport, viewportComponent.parameters);\n                if (viewportComponent.children !== void 0 && viewportComponent.children !== null) {\n                    newInstruction.nextScopeInstructions = NavigationInstructionResolver.toViewportInstructions(router, viewportComponent.children);\n                }\n                instructions.push(newInstruction);\n            }\n            else {\n                instructions.push(router.createViewportInstruction(instruction));\n            }\n        }\n        return instructions;\n    },\n};\n//# sourceMappingURL=type-resolvers.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { ComponentAppellationResolver } from './type-resolvers';\nexport var ParametersType;\n(function (ParametersType) {\n    ParametersType[\"none\"] = \"none\";\n    ParametersType[\"string\"] = \"string\";\n    ParametersType[\"array\"] = \"array\";\n    ParametersType[\"object\"] = \"object\";\n})(ParametersType || (ParametersType = {}));\nexport class ViewportInstruction {\n    constructor(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        this.ownsScope = ownsScope;\n        this.nextScopeInstructions = nextScopeInstructions;\n        this.componentName = null;\n        this.componentType = null;\n        this.componentInstance = null;\n        this.viewportName = null;\n        this.viewport = null;\n        this.parametersString = null;\n        this.parametersRecord = null;\n        this.parametersList = null;\n        this.parametersType = \"none\" /* none */;\n        this.scope = null;\n        this.context = '';\n        this.viewportScope = null;\n        this.needsViewportDescribed = false;\n        this.route = null;\n        this.default = false;\n        this.instructionResolver = null;\n        this.setComponent(component);\n        this.setViewport(viewport);\n        this.setParameters(parameters);\n    }\n    get owner() {\n        return this.viewport || this.viewportScope || null;\n    }\n    get typedParameters() {\n        switch (this.parametersType) {\n            case \"string\" /* string */:\n                return this.parametersString;\n            case \"array\" /* array */:\n                return this.parametersList;\n            case \"object\" /* object */:\n                return this.parametersRecord;\n            default:\n                return null;\n        }\n    }\n    get parameters() {\n        if (this.instructionResolver !== null) {\n            return this.instructionResolver.parseComponentParameters(this.typedParameters);\n        }\n        return [];\n    }\n    get normalizedParameters() {\n        if (this.instructionResolver !== null && this.typedParameters !== null) {\n            return this.instructionResolver.stringifyComponentParameters(this.parameters);\n        }\n        return '';\n    }\n    setComponent(component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = null;\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isInstance(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = ComponentAppellationResolver.getInstance(component);\n        }\n    }\n    setViewport(viewport) {\n        if (viewport === undefined || viewport === '') {\n            viewport = null;\n        }\n        if (typeof viewport === 'string') {\n            this.viewportName = viewport;\n            this.viewport = null;\n        }\n        else {\n            this.viewport = viewport;\n            if (viewport !== null) {\n                this.viewportName = viewport.name;\n                this.scope = viewport.owningScope;\n            }\n        }\n    }\n    setParameters(parameters) {\n        if (parameters === undefined || parameters === null || parameters === '') {\n            this.parametersType = \"none\" /* none */;\n            parameters = null;\n        }\n        else if (typeof parameters === 'string') {\n            this.parametersType = \"string\" /* string */;\n            this.parametersString = parameters;\n        }\n        else if (Array.isArray(parameters)) {\n            this.parametersType = \"array\" /* array */;\n            this.parametersList = parameters;\n        }\n        else {\n            this.parametersType = \"object\" /* object */;\n            this.parametersRecord = parameters;\n        }\n    }\n    // This only works with objects added to objects!\n    addParameters(parameters) {\n        if (this.parametersType === \"none\" /* none */) {\n            return this.setParameters(parameters);\n        }\n        if (this.parametersType !== \"object\" /* object */) {\n            throw new Error('Can\\'t add object parameters to existing non-object parameters!');\n        }\n        this.setParameters({ ...this.parametersRecord, ...parameters });\n    }\n    setInstructionResolver(instructionResolver) {\n        this.instructionResolver = instructionResolver;\n    }\n    isEmpty() {\n        return !this.isComponentName() && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentName() {\n        return !!this.componentName && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentType() {\n        return this.componentType !== null && !this.isComponentInstance();\n    }\n    isComponentInstance() {\n        return this.componentInstance !== null;\n    }\n    toComponentType(container) {\n        if (this.componentType !== null) {\n            return this.componentType;\n        }\n        if (this.componentName !== null\n            && typeof this.componentName === 'string'\n            && container !== null\n            && container.has(CustomElement.keyFrom(this.componentName), true)) {\n            const resolver = container.getResolver(CustomElement.keyFrom(this.componentName));\n            if (resolver !== null && resolver.getFactory !== void 0) {\n                const factory = resolver.getFactory(container);\n                if (factory) {\n                    return factory.Type;\n                }\n            }\n        }\n        return null;\n    }\n    toComponentInstance(container) {\n        if (this.componentInstance !== null) {\n            return this.componentInstance;\n        }\n        if (container !== void 0 && container !== null) {\n            if (this.isComponentType()) {\n                return container.get(this.componentType);\n            }\n            else {\n                return container.get(CustomElement.keyFrom(this.componentName));\n            }\n        }\n        return null;\n    }\n    toViewportInstance(router) {\n        if (this.viewport !== null) {\n            return this.viewport;\n        }\n        return router.getViewport(this.viewportName);\n    }\n    toSpecifiedParameters(specifications) {\n        specifications = specifications || [];\n        const parameters = this.parameters;\n        const specified = {};\n        for (const spec of specifications) {\n            // First get named if it exists\n            let index = parameters.findIndex(param => param.key === spec);\n            if (index >= 0) {\n                const [parameter] = parameters.splice(index, 1);\n                specified[spec] = parameter.value;\n            }\n            else {\n                // Otherwise get first unnamed\n                index = parameters.findIndex(param => param.key === void 0);\n                if (index >= 0) {\n                    const [parameter] = parameters.splice(index, 1);\n                    specified[spec] = parameter.value;\n                }\n            }\n        }\n        // Add all remaining named\n        for (const parameter of parameters.filter(param => param.key !== void 0)) {\n            specified[parameter.key] = parameter.value;\n        }\n        let index = specifications.length;\n        // Add all remaining unnamed...\n        for (const parameter of parameters.filter(param => param.key === void 0)) {\n            // ..with an index\n            specified[index++] = parameter.value;\n        }\n        return specified;\n    }\n    toSortedParameters(specifications) {\n        specifications = specifications || [];\n        const parameters = this.parameters;\n        const sorted = [];\n        for (const spec of specifications) {\n            // First get named if it exists\n            let index = parameters.findIndex(param => param.key === spec);\n            if (index >= 0) {\n                const parameter = { ...parameters.splice(index, 1)[0] };\n                parameter.key = void 0;\n                sorted.push(parameter);\n            }\n            else {\n                // Otherwise get first unnamed\n                index = parameters.findIndex(param => param.key === void 0);\n                if (index >= 0) {\n                    const parameter = { ...parameters.splice(index, 1)[0] };\n                    sorted.push(parameter);\n                }\n                else {\n                    // Or an empty\n                    sorted.push({ value: void 0 });\n                }\n            }\n        }\n        // Add all remaining named\n        const params = parameters.filter(param => param.key !== void 0);\n        params.sort((a, b) => (a.key || '') < (b.key || '') ? 1 : (b.key || '') < (a.key || '') ? -1 : 0);\n        sorted.push(...params);\n        // Add all remaining unnamed...\n        sorted.push(...parameters.filter(param => param.key === void 0));\n        return sorted;\n    }\n    sameComponent(other, compareParameters = false, compareType = false) {\n        if (compareParameters && !this.sameParameters(other, compareType)) {\n            return false;\n        }\n        return compareType ? this.componentType === other.componentType : this.componentName === other.componentName;\n    }\n    // TODO: Somewhere we need to check for format such as spaces etc\n    sameParameters(other, compareType = false) {\n        if (!this.sameComponent(other, false, compareType)) {\n            return false;\n        }\n        const typeParameters = this.componentType ? this.componentType.parameters : [];\n        const mine = this.toSpecifiedParameters(typeParameters);\n        const others = other.toSpecifiedParameters(typeParameters);\n        return Object.keys(mine).every(key => mine[key] === others[key])\n            && Object.keys(others).every(key => others[key] === mine[key]);\n    }\n    sameViewport(other) {\n        if (this.viewport !== null && other.viewport !== null) {\n            return this.viewport === other.viewport;\n        }\n        return this.scope === other.scope &&\n            (this.viewport ? this.viewport.name : this.viewportName) === (other.viewport ? other.viewport.name : other.viewportName);\n    }\n}\n//# sourceMappingURL=viewport-instruction.js.map","export var ReentryBehavior;\n(function (ReentryBehavior) {\n    ReentryBehavior[\"default\"] = \"default\";\n    ReentryBehavior[\"disallow\"] = \"disallow\";\n    ReentryBehavior[\"enter\"] = \"enter\";\n    ReentryBehavior[\"refresh\"] = \"refresh\";\n})(ReentryBehavior || (ReentryBehavior = {}));\n//# sourceMappingURL=interfaces.js.map","import { Hook } from './hook';\nexport var HookTypes;\n(function (HookTypes) {\n    HookTypes[\"BeforeNavigation\"] = \"beforeNavigation\";\n    HookTypes[\"TransformFromUrl\"] = \"transformFromUrl\";\n    HookTypes[\"TransformToUrl\"] = \"transformToUrl\";\n})(HookTypes || (HookTypes = {}));\nexport class HookManager {\n    constructor() {\n        this.hooks = {\n            beforeNavigation: [],\n            transformFromUrl: [],\n            transformToUrl: [],\n        };\n        this.lastIdentity = 0;\n    }\n    addHook(hookFunction, options) {\n        const hook = new Hook(hookFunction, options || {}, ++this.lastIdentity);\n        this.hooks[hook.type].push(hook);\n        return this.lastIdentity;\n    }\n    removeHook(id) {\n        for (const type in this.hooks) {\n            if (Object.prototype.hasOwnProperty.call(this.hooks, type)) {\n                const index = this.hooks[type].findIndex(hook => hook.id === id);\n                if (index >= 0) {\n                    this.hooks[type].splice(index, 1);\n                }\n            }\n        }\n    }\n    invokeBeforeNavigation(viewportInstructions, navigationInstruction) {\n        return this.invoke(\"beforeNavigation\" /* BeforeNavigation */, navigationInstruction, viewportInstructions);\n    }\n    invokeTransformFromUrl(url, navigationInstruction) {\n        return this.invoke(\"transformFromUrl\" /* TransformFromUrl */, navigationInstruction, url);\n    }\n    invokeTransformToUrl(state, navigationInstruction) {\n        return this.invoke(\"transformToUrl\" /* TransformToUrl */, navigationInstruction, state);\n    }\n    async invoke(type, navigationInstruction, arg) {\n        for (const hook of this.hooks[type]) {\n            if (!hook.wantsMatch || hook.matches(arg)) {\n                const outcome = await hook.invoke(navigationInstruction, arg);\n                if (typeof outcome === 'boolean') {\n                    if (!outcome) {\n                        return false;\n                    }\n                }\n                else {\n                    arg = outcome;\n                }\n            }\n        }\n        return arg;\n    }\n}\n//# sourceMappingURL=hook-manager.js.map","import { ComponentAppellationResolver, ViewportHandleResolver } from './type-resolvers';\nimport { ViewportInstruction } from './viewport-instruction';\nexport class Hook {\n    constructor(hook, options, id) {\n        this.hook = hook;\n        this.id = id;\n        this.type = \"beforeNavigation\" /* BeforeNavigation */;\n        this.includeTargets = [];\n        this.excludeTargets = [];\n        if (options.type !== void 0) {\n            this.type = options.type;\n        }\n        for (const target of options.include || []) {\n            this.includeTargets.push(new Target(target));\n        }\n        for (const target of options.exclude || []) {\n            this.excludeTargets.push(new Target(target));\n        }\n    }\n    get wantsMatch() {\n        return this.includeTargets.length > 0 || this.excludeTargets.length > 0;\n    }\n    matches(viewportInstructions) {\n        if (this.includeTargets.length && !this.includeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        if (this.excludeTargets.length && this.excludeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        return true;\n    }\n    invoke(navigationInstruction, arg) {\n        // TODO: Fix the type here\n        return this.hook(arg, navigationInstruction);\n    }\n}\nclass Target {\n    constructor(target) {\n        this.componentType = null;\n        this.componentName = null;\n        this.viewport = null;\n        this.viewportName = null;\n        if (typeof target === 'string') {\n            this.componentName = target;\n        }\n        else if (ComponentAppellationResolver.isType(target)) {\n            this.componentType = target;\n            this.componentName = ComponentAppellationResolver.getName(target);\n        }\n        else {\n            const cvTarget = target;\n            if (cvTarget.component) {\n                this.componentType = ComponentAppellationResolver.isType(cvTarget.component)\n                    ? ComponentAppellationResolver.getType(cvTarget.component)\n                    : null;\n                this.componentName = ComponentAppellationResolver.getName(cvTarget.component);\n            }\n            if (cvTarget.viewport) {\n                this.viewport = ViewportHandleResolver.isInstance(cvTarget.viewport) ? cvTarget.viewport : null;\n                this.viewportName = ViewportHandleResolver.getName(cvTarget.viewport);\n            }\n        }\n    }\n    matches(viewportInstructions) {\n        const instructions = viewportInstructions.slice();\n        if (!instructions.length) {\n            instructions.push(new ViewportInstruction(''));\n        }\n        for (const instruction of instructions) {\n            if ((this.componentName !== null && this.componentName === instruction.componentName) ||\n                (this.componentType !== null && this.componentType === instruction.componentType) ||\n                (this.viewportName !== null && this.viewportName === instruction.viewportName) ||\n                (this.viewport !== null && this.viewport === instruction.viewport)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=hook.js.map","import { ComponentAppellationResolver, NavigationInstructionResolver } from './type-resolvers';\nexport class NavRoute {\n    constructor(nav, route) {\n        this.nav = nav;\n        this.instructions = [];\n        this.link = null;\n        this.linkVisible = null;\n        this.linkActive = null;\n        this.compareParameters = false;\n        this.children = null;\n        this.visible = true;\n        this.active = '';\n        this.title = route.title;\n        this.meta = route.meta;\n        if (route.route) {\n            this.instructions = this.parseRoute(route.route);\n            this.link = this.computeLink(this.instructions);\n        }\n        this.linkActive = route.consideredActive !== null && route.consideredActive !== void 0 ? route.consideredActive : this.link;\n        if (this.linkActive !== null && (!(this.linkActive instanceof Function) || ComponentAppellationResolver.isType(this.linkActive))) {\n            this.linkActive = NavigationInstructionResolver.toViewportInstructions(this.nav.router, this.linkActive);\n        }\n        this.execute = route.execute;\n        this.compareParameters = !!route.compareParameters;\n        this.linkVisible = route.condition === undefined ? true : route.condition;\n        this.update();\n    }\n    get hasChildren() {\n        return (this.children && this.children.length ? 'nav-has-children' : '');\n    }\n    update() {\n        this.visible = this.computeVisible();\n        if ((this.link && this.link.length) || this.execute) {\n            this.active = this.computeActive();\n        }\n        else {\n            this.active = (this.active === 'nav-active' ? 'nav-active' : (this.activeChild() ? 'nav-active-child' : ''));\n        }\n    }\n    executeAction(event) {\n        if (this.execute) {\n            this.execute(this);\n        }\n        event.stopPropagation();\n    }\n    toggleActive() {\n        this.active = (this.active.startsWith('nav-active') ? '' : 'nav-active');\n    }\n    parseRoute(routes) {\n        return NavigationInstructionResolver.toViewportInstructions(this.nav.router, routes);\n    }\n    computeVisible() {\n        if (this.linkVisible instanceof Function) {\n            return this.linkVisible(this);\n        }\n        return !!this.linkVisible;\n    }\n    computeActive() {\n        if (!Array.isArray(this.linkActive)) {\n            return this.linkActive(this) ? 'nav-active' : '';\n        }\n        const components = this.linkActive;\n        const activeComponents = this.nav.router.instructionResolver.flattenViewportInstructions(this.nav.router.activeComponents);\n        for (const component of components) {\n            if (activeComponents.every((active) => !active.sameComponent(component, this.compareParameters && component.typedParameters !== null))) {\n                return '';\n            }\n        }\n        return 'nav-active';\n    }\n    computeLink(instructions) {\n        return this.nav.router.instructionResolver.stringifyViewportInstructions(instructions);\n    }\n    activeChild() {\n        if (this.children) {\n            for (const child of this.children) {\n                if (child.active.startsWith('nav-active') || child.activeChild()) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=nav-route.js.map","import { NavRoute } from './nav-route';\nexport class Nav {\n    constructor(router, name, routes = [], classes = {}) {\n        this.router = router;\n        this.name = name;\n        this.routes = routes;\n        this.classes = classes;\n        this.update();\n    }\n    addRoutes(routes) {\n        for (const route of routes) {\n            this.addRoute(this.routes, route);\n        }\n        this.update();\n    }\n    update() {\n        this.updateRoutes(this.routes);\n        this.routes = this.routes.slice();\n    }\n    addRoute(routes, route) {\n        const newRoute = new NavRoute(this, route);\n        routes.push(newRoute);\n        if (route.children) {\n            newRoute.children = [];\n            for (const child of route.children) {\n                this.addRoute(newRoute.children, child);\n            }\n        }\n    }\n    updateRoutes(routes) {\n        for (const route of routes) {\n            route.update();\n            if (route.children && route.children.length) {\n                this.updateRoutes(route.children);\n            }\n        }\n    }\n}\n//# sourceMappingURL=nav.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { bound } from '@aurelia/kernel';\nexport class QueueTask {\n    constructor(taskQueue, item, cost = 0) {\n        this.taskQueue = taskQueue;\n        this.item = item;\n        this.cost = cost;\n        this.done = false;\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve = () => {\n                this.taskQueue.resolve(this, resolve);\n            };\n            this.reject = (reason) => {\n                this.taskQueue.reject(this, reject, reason);\n            };\n        });\n    }\n    async execute() {\n        if ('execute' in this.item) {\n            await this.item.execute(this);\n        }\n        else {\n            await this.item(this);\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() { return; }\n}\n/**\n * A first-in-first-out task queue that only processes the next queued item\n * when the current one has been resolved or rejected. If a callback function\n * is specified, it receives the queued items as tasks one at a time. If no\n * callback is specified, the tasks themselves are either executed (if a\n * function) or the execute method in them are run. The executed function\n * should resolve or reject the task when processing is done.\n * Enqueued items' tasks can be awaited. Enqueued items can specify an\n * (arbitrary) execution cost and the queue can be set up (activated) to\n * only process a specific amount of execution cost per RAF/tick.\n */\nexport class TaskQueue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('TaskQueue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('TaskQueue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = (list ? itemOrItems : [itemOrItems]);\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map((value) => value !== undefined ? value : 1);\n        const tasks = [];\n        for (const item of items) {\n            tasks.push(item instanceof QueueTask\n                ? item\n                : this.createQueueTask(item, costs.shift())); // TODO: Get cancellable in as well\n        }\n        this.pending.push(...tasks);\n        this.dequeue();\n        return list ? tasks : tasks[0];\n    }\n    createQueueTask(item, cost) {\n        return new QueueTask(this, item, cost);\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            if (this.callback !== void 0) {\n                this.callback(this.processing);\n            }\n            else {\n                // Don't need to await this since next task won't be dequeued until\n                // executed function is resolved\n                this.processing.execute().catch(error => { throw error; });\n            }\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n    resolve(task, resolve) {\n        resolve();\n        this.processing = null;\n        this.dequeue();\n    }\n    reject(task, reject, reason) {\n        reject(reason);\n        this.processing = null;\n        this.dequeue();\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", void 0)\n], TaskQueue.prototype, \"dequeue\", null);\n//# sourceMappingURL=task-queue.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { TaskQueue } from './task-queue';\nlet BrowserViewerStore = class BrowserViewerStore {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { return; },\n        };\n        this.forwardedState = { eventTask: null, suppressPopstate: false };\n        this.handlePopstate = (event) => {\n            const { eventTask, suppressPopstate } = this.forwardedState;\n            this.forwardedState = { eventTask: null, suppressPopstate: false };\n            return this.pendingCalls.enqueue(async (task) => {\n                const store = this;\n                const ev = event;\n                const evTask = eventTask;\n                const suppressPopstateEvent = suppressPopstate;\n                await store.popstate(ev, evTask, suppressPopstateEvent);\n                task.resolve();\n            }, 1).wait();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new TaskQueue();\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstateEvent = false) {\n        const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n        this.pendingCalls.enqueue([\n            (task) => {\n                const store = this;\n                const eventTask = doneTask;\n                const suppressPopstate = suppressPopstateEvent;\n                store.forwardState({ eventTask, suppressPopstate });\n                task.resolve();\n            },\n            (task) => {\n                const history = this.history;\n                const steps = delta;\n                history.go(steps);\n                task.resolve();\n            },\n        ], [0, 1]);\n        return doneTask.wait();\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.pendingCalls.enqueue((task) => {\n            const history = this.history;\n            const data = state;\n            const titleOrEmpty = title || '';\n            const url = `${fragment}${path}`;\n            history.pushState(data, titleOrEmpty, url);\n            task.resolve();\n        }, 1).wait();\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.pendingCalls.enqueue((task) => {\n            const history = this.history;\n            const data = state;\n            const titleOrEmpty = title || '';\n            const url = `${fragment}${path}`;\n            history.replaceState(data, titleOrEmpty, url);\n            task.resolve();\n        }, 1).wait();\n    }\n    popNavigatorState() {\n        const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n        this.pendingCalls.enqueue(async (task) => {\n            const store = this;\n            const eventTask = doneTask;\n            await store.popState(eventTask);\n            task.resolve();\n        }, 1);\n        return doneTask.wait();\n    }\n    async popState(doneTask) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            await this.pushNavigatorState(state);\n        }\n        await doneTask.execute();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    async popstate(ev, eventTask, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (eventTask !== null) {\n            await eventTask.execute();\n        }\n    }\n};\nBrowserViewerStore = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserViewerStore);\nexport { BrowserViewerStore };\n//# sourceMappingURL=browser-viewer-store.js.map","/* eslint-disable max-lines-per-function */\nimport { DI, IContainer, Reporter, Registration, Metadata } from '@aurelia/kernel';\nimport { Aurelia, CustomElement, DOM, isRenderContext } from '@aurelia/runtime';\nimport { InstructionResolver } from './instruction-resolver';\nimport { LinkHandler } from './link-handler';\nimport { Nav } from './nav';\nimport { Navigator } from './navigator';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { arrayRemove } from './utils';\nimport { Viewport } from './viewport';\nimport { FoundRoute } from './found-route';\nimport { HookManager } from './hook-manager';\nimport { Scope } from './scope';\nimport { ViewportScope } from './viewport-scope';\nimport { BrowserViewerStore } from './browser-viewer-store';\nclass ClosestViewportCustomElement {\n}\nclass ClosestScope {\n}\nexport const IRouter = DI.createInterface('IRouter').withDefault(x => x.singleton(Router));\nexport class Router {\n    constructor(container, navigator, navigation, linkHandler, instructionResolver) {\n        this.container = container;\n        this.navigator = navigator;\n        this.navigation = navigation;\n        this.linkHandler = linkHandler;\n        this.instructionResolver = instructionResolver;\n        this.rootScope = null;\n        this.navs = {};\n        this.activeComponents = [];\n        this.appendedInstructions = [];\n        this.options = {\n            useHref: true,\n            statefulHistoryLength: 0,\n            useDirectRoutes: true,\n            useConfiguredRoutes: true,\n        };\n        this.isActive = false;\n        this.loadedFirst = false;\n        this.processingNavigation = null;\n        this.lastNavigation = null;\n        this.staleChecks = {};\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.linkCallback = (info) => {\n            let instruction = info.instruction || '';\n            if (typeof instruction === 'string' && instruction.startsWith('#')) {\n                instruction = instruction.slice(1);\n                // '#' === '/' === '#/'\n                if (!instruction.startsWith('/')) {\n                    instruction = `/${instruction}`;\n                }\n            }\n            // Adds to Navigator's Queue, which makes sure it's serial\n            this.goto(instruction, { origin: info.anchor }).catch(error => { throw error; });\n        };\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.navigatorCallback = (instruction) => {\n            // Instructions extracted from queue, one at a time\n            this.processNavigations(instruction).catch(error => { throw error; });\n        };\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.navigatorSerializeCallback = async (entry, preservedEntries) => {\n            let excludeComponents = [];\n            for (const preservedEntry of preservedEntries) {\n                if (typeof preservedEntry.instruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.instruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n                if (typeof preservedEntry.fullStateInstruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.fullStateInstruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n            }\n            excludeComponents = excludeComponents.filter((component, i, arr) => component !== null && arr.indexOf(component) === i);\n            const serialized = { ...entry };\n            let instructions = [];\n            if (serialized.fullStateInstruction && typeof serialized.fullStateInstruction !== 'string') {\n                instructions.push(...serialized.fullStateInstruction);\n                serialized.fullStateInstruction = this.instructionResolver.stringifyViewportInstructions(serialized.fullStateInstruction);\n            }\n            if (serialized.instruction && typeof serialized.instruction !== 'string') {\n                instructions.push(...serialized.instruction);\n                serialized.instruction = this.instructionResolver.stringifyViewportInstructions(serialized.instruction);\n            }\n            instructions = instructions.filter((instruction, i, arr) => instruction !== null\n                && instruction.componentInstance !== null\n                && arr.indexOf(instruction) === i);\n            const alreadyDone = [];\n            for (const instruction of instructions) {\n                await this.freeComponents(instruction, excludeComponents, alreadyDone);\n            }\n            return serialized;\n        };\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.browserNavigatorCallback = (browserNavigationEvent) => {\n            const entry = (browserNavigationEvent.state && browserNavigationEvent.state.currentEntry\n                ? browserNavigationEvent.state.currentEntry\n                : { instruction: '', fullStateInstruction: '' });\n            entry.instruction = browserNavigationEvent.instruction;\n            entry.fromBrowser = true;\n            this.navigator.navigate(entry).catch(error => { throw error; });\n        };\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.processNavigations = async (qInstruction) => {\n            const instruction = this.processingNavigation = qInstruction;\n            if (this.options.reportCallback) {\n                this.options.reportCallback(instruction);\n            }\n            let fullStateInstruction = false;\n            const instructionNavigation = instruction.navigation;\n            if ((instructionNavigation.back || instructionNavigation.forward) && instruction.fullStateInstruction) {\n                fullStateInstruction = true;\n                // if (!confirm('Perform history navigation?')) { this.navigator.cancel(instruction); this.processingNavigation = null; return Promise.resolve(); }\n            }\n            let configuredRoute = await this.findInstructions(this.rootScope.scope, instruction.instruction, instruction.scope || this.rootScope.scope, !fullStateInstruction);\n            let instructions = configuredRoute.instructions;\n            let configuredRoutePath = null;\n            if (instruction.instruction.length > 0 && !configuredRoute.foundConfiguration && !configuredRoute.foundInstructions) {\n                // TODO: Do something here!\n                this.unknownRoute(configuredRoute.remaining);\n            }\n            if (configuredRoute.foundConfiguration) {\n                instruction.path = instruction.instruction.startsWith('/')\n                    ? instruction.instruction.slice(1) : instruction.instruction;\n                configuredRoutePath = `${configuredRoutePath || ''}${configuredRoute.matching}`;\n                this.rootScope.path = configuredRoutePath;\n            }\n            // TODO: Used to have an early exit if no instructions. Restore it?\n            const clearScopeOwners = [];\n            let clearViewportScopes = [];\n            for (const clearInstruction of instructions.filter(instr => this.instructionResolver.isClearAllViewportsInstruction(instr))) {\n                const scope = clearInstruction.scope || this.rootScope.scope;\n                clearScopeOwners.push(...scope.children.filter(scope => !scope.owner.isEmpty).map(scope => scope.owner));\n                if (scope.viewportScope !== null) {\n                    clearViewportScopes.push(scope.viewportScope);\n                }\n            }\n            instructions = instructions.filter(instr => !this.instructionResolver.isClearAllViewportsInstruction(instr));\n            for (const addInstruction of instructions.filter(instr => this.instructionResolver.isAddAllViewportsInstruction(instr))) {\n                addInstruction.setViewport((addInstruction.scope || this.rootScope.scope).viewportScope.name);\n                addInstruction.scope = addInstruction.scope.owningScope;\n            }\n            const updatedScopeOwners = [];\n            const alreadyFoundInstructions = [];\n            // TODO: Take care of cancellations down in subsets/iterations\n            let { found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(instructions, alreadyFoundInstructions);\n            let guard = 100;\n            do {\n                if (!guard--) { // Guard against endless loop\n                    console.log('remainingInstructions', remainingInstructions);\n                    throw Reporter.error(2002);\n                }\n                const changedScopeOwners = [];\n                const hooked = await this.hookManager.invokeBeforeNavigation(viewportInstructions, instruction);\n                if (hooked === false) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                }\n                else {\n                    viewportInstructions = hooked;\n                }\n                for (const viewportInstruction of viewportInstructions) {\n                    const scopeOwner = viewportInstruction.owner;\n                    if (scopeOwner !== null) {\n                        scopeOwner.path = configuredRoutePath;\n                        if (scopeOwner.setNextContent(viewportInstruction, instruction)) {\n                            changedScopeOwners.push(scopeOwner);\n                        }\n                        arrayRemove(clearScopeOwners, value => value === scopeOwner);\n                        if (!this.instructionResolver.isClearViewportInstruction(viewportInstruction)\n                            && viewportInstruction.scope !== null\n                            && viewportInstruction.scope.parent !== null\n                            && viewportInstruction.scope.parent.isViewportScope) {\n                            arrayRemove(clearViewportScopes, value => value === viewportInstruction.scope.parent.viewportScope);\n                        }\n                    }\n                }\n                let results = await Promise.all(changedScopeOwners.map((value) => value.canLeave()));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                }\n                results = await Promise.all(changedScopeOwners.map(async (value) => {\n                    const canEnter = await value.canEnter();\n                    if (typeof canEnter === 'boolean') {\n                        if (canEnter) {\n                            return value.enter();\n                        }\n                        else {\n                            return false;\n                        }\n                    }\n                    await this.goto(canEnter, { append: true });\n                    await value.abortContentChange();\n                    // TODO: Abort content change in the viewports\n                    return true;\n                }));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], qInstruction);\n                }\n                for (const viewport of changedScopeOwners) {\n                    if (updatedScopeOwners.every(value => value !== viewport)) {\n                        updatedScopeOwners.push(viewport);\n                    }\n                }\n                // TODO: Fix multi level recursiveness!\n                alreadyFoundInstructions.push(...viewportInstructions);\n                ({ found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(remainingInstructions, alreadyFoundInstructions));\n                // Look for configured child routes (once we've loaded everything so far?)\n                if (configuredRoute.hasRemaining &&\n                    viewportInstructions.length === 0 &&\n                    remainingInstructions.length === 0) {\n                    let configured = new FoundRoute();\n                    const routeScopeOwners = alreadyFoundInstructions\n                        .filter(instr => instr.owner !== null && instr.owner.path === configuredRoutePath)\n                        .map(instr => instr.owner)\n                        .filter((value, index, arr) => arr.indexOf(value) === index);\n                    for (const owner of routeScopeOwners) {\n                        configured = await this.findInstructions(owner.scope, configuredRoute.remaining, owner.scope);\n                        if (configured.foundConfiguration) {\n                            break;\n                        }\n                    }\n                    if (configured.foundInstructions) {\n                        configuredRoute = configured;\n                        configuredRoutePath = `${configuredRoutePath || ''}/${configuredRoute.matching}`;\n                    }\n                    else {\n                        // TODO: Do something here!\n                        this.unknownRoute(configured.remaining);\n                    }\n                    this.appendInstructions(configured.instructions);\n                }\n                // Don't use defaults when it's a full state navigation\n                if (fullStateInstruction) {\n                    this.appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                }\n                // Process non-defaults first\n                let appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                this.appendedInstructions = this.appendedInstructions.filter(instruction => instruction.default);\n                if (appendedInstructions.length === 0) {\n                    const index = this.appendedInstructions.findIndex(instruction => instruction.default);\n                    if (index >= 0) {\n                        appendedInstructions = this.appendedInstructions.splice(index, 1);\n                    }\n                }\n                while (appendedInstructions.length > 0) {\n                    const appendedInstruction = appendedInstructions.shift();\n                    const existingAlreadyFound = alreadyFoundInstructions.some(instruction => instruction.sameViewport(appendedInstruction));\n                    const existingFound = viewportInstructions.find(value => value.sameViewport(appendedInstruction));\n                    const existingRemaining = remainingInstructions.find(value => value.sameViewport(appendedInstruction));\n                    if (appendedInstruction.default &&\n                        (existingAlreadyFound ||\n                            (existingFound !== void 0 && !existingFound.default) ||\n                            (existingRemaining !== void 0 && !existingRemaining.default))) {\n                        continue;\n                    }\n                    if (existingFound !== void 0) {\n                        arrayRemove(viewportInstructions, value => value === existingFound);\n                    }\n                    if (existingRemaining !== void 0) {\n                        arrayRemove(remainingInstructions, value => value === existingRemaining);\n                    }\n                    if (appendedInstruction.viewport !== null) {\n                        viewportInstructions.push(appendedInstruction);\n                    }\n                    else {\n                        remainingInstructions.push(appendedInstruction);\n                    }\n                }\n                if (viewportInstructions.length === 0 && remainingInstructions.length === 0) {\n                    viewportInstructions = clearScopeOwners.map(owner => {\n                        const instruction = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction, owner.isViewport ? owner : void 0);\n                        if (owner.isViewportScope) {\n                            instruction.viewportScope = owner;\n                        }\n                        return instruction;\n                    });\n                    viewportInstructions.push(...clearViewportScopes.map(viewportScope => {\n                        const instr = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction);\n                        instr.viewportScope = viewportScope;\n                        return instr;\n                    }));\n                    clearViewportScopes = [];\n                }\n            } while (viewportInstructions.length > 0 || remainingInstructions.length > 0);\n            await Promise.all(updatedScopeOwners.map((value) => value.loadContent()));\n            await this.replacePaths(instruction);\n            // this.updateNav();\n            // Remove history entry if no history viewports updated\n            if (instructionNavigation.new && !instructionNavigation.first && !instruction.repeating && updatedScopeOwners.every(viewport => viewport.options.noHistory)) {\n                instruction.untracked = true;\n            }\n            updatedScopeOwners.forEach((viewport) => {\n                viewport.finalizeContentChange();\n            });\n            this.lastNavigation = this.processingNavigation;\n            if (this.lastNavigation.repeating) {\n                this.lastNavigation.repeating = false;\n            }\n            this.processingNavigation = null;\n            await this.navigator.finalize(instruction);\n        };\n        this.hookManager = new HookManager();\n    }\n    get isNavigating() {\n        return this.processingNavigation !== null;\n    }\n    get statefulHistory() {\n        return this.options.statefulHistoryLength !== void 0 && this.options.statefulHistoryLength > 0;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Router has already been activated');\n        }\n        this.isActive = true;\n        this.options = {\n            ...this.options,\n            ...options\n        };\n        if (this.options.hooks !== void 0) {\n            this.addHooks(this.options.hooks);\n        }\n        this.instructionResolver.activate({ separators: this.options.separators });\n        this.navigator.activate(this, {\n            callback: this.navigatorCallback,\n            store: this.navigation,\n            statefulHistoryLength: this.options.statefulHistoryLength,\n            serializeCallback: this.statefulHistory ? this.navigatorSerializeCallback : void 0,\n        });\n        this.linkHandler.activate({ callback: this.linkCallback, useHref: this.options.useHref });\n        this.navigation.activate({\n            callback: this.browserNavigatorCallback,\n            useUrlFragmentHash: this.options.useUrlFragmentHash\n        });\n        this.ensureRootScope();\n    }\n    async loadUrl() {\n        const entry = {\n            ...this.navigation.viewerState,\n            ...{\n                fullStateInstruction: '',\n                replacing: true,\n                fromBrowser: false,\n            }\n        };\n        const result = this.navigator.navigate(entry);\n        this.loadedFirst = true;\n        return result;\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Router has not been activated');\n        }\n        this.linkHandler.deactivate();\n        this.navigator.deactivate();\n        this.navigation.deactivate();\n    }\n    findScope(origin) {\n        // this.ensureRootScope();\n        if (origin === void 0 || origin === null) {\n            return this.rootScope.scope;\n        }\n        if (origin instanceof Scope || origin instanceof Viewport) {\n            return origin.scope;\n        }\n        return this.getClosestScope(origin) || this.rootScope.scope;\n    }\n    findParentScope(container) {\n        if (container === null) {\n            return this.rootScope.scope;\n        }\n        // Already (prematurely) set on this view model so get it from container's parent instead\n        if (container.has(ClosestScope, false)) {\n            container = container.parent;\n            if (container === null) {\n                return this.rootScope.scope;\n            }\n        }\n        if (container.has(ClosestScope, true)) {\n            return container.get(ClosestScope);\n        }\n        return this.rootScope.scope;\n    }\n    // External API to get viewport by name\n    getViewport(name) {\n        return this.allViewports().find(viewport => viewport.name === name) || null;\n    }\n    // Called from the viewport scope custom element in created()\n    setClosestScope(viewModelOrContainer, scope) {\n        const container = this.getContainer(viewModelOrContainer);\n        Registration.instance(ClosestScope, scope).register(container);\n    }\n    getClosestScope(viewModelOrElement) {\n        const container = 'resourceResolvers' in viewModelOrElement\n            ? viewModelOrElement\n            : this.getClosestContainer(viewModelOrElement);\n        if (container === null) {\n            return null;\n        }\n        if (!container.has(ClosestScope, true)) {\n            return null;\n        }\n        return container.get(ClosestScope) || null;\n    }\n    unsetClosestScope(viewModelOrContainer) {\n        const container = this.getContainer(viewModelOrContainer);\n        // TODO: Get an 'unregister' on container\n        container.resolvers.delete(ClosestScope);\n    }\n    // Called from the viewport custom element in attached()\n    connectViewport(viewport, container, name, element, options) {\n        const parentScope = this.findParentScope(container);\n        if (viewport === null) {\n            viewport = parentScope.addViewport(name, element, container, options);\n            this.setClosestScope(container, viewport.connectedScope);\n        }\n        return viewport;\n    }\n    // Called from the viewport custom element\n    disconnectViewport(viewport, container, element) {\n        if (!viewport.connectedScope.parent.removeViewport(viewport, element, container)) {\n            throw new Error(`Failed to remove viewport: ${viewport.name}`);\n        }\n        this.unsetClosestScope(container);\n    }\n    // Called from the viewport scope custom element in attached()\n    connectViewportScope(viewportScope, name, container, element, options) {\n        const parentScope = this.findParentScope(container);\n        if (viewportScope === null) {\n            viewportScope = parentScope.addViewportScope(name, element, options);\n            this.setClosestScope(container, viewportScope.connectedScope);\n        }\n        return viewportScope;\n    }\n    // Called from the viewport scope custom element\n    disconnectViewportScope(viewportScope, container) {\n        if (!viewportScope.connectedScope.parent.removeViewportScope(viewportScope)) {\n            throw new Error(`Failed to remove viewport scope: ${viewportScope.path}`);\n        }\n        this.unsetClosestScope(container);\n    }\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        // this.ensureRootScope();\n        return this.rootScope.scope.allViewports(includeDisabled, includeReplaced);\n    }\n    goto(instructions, options) {\n        options = options || {};\n        // TODO: Review query extraction; different pos for path and fragment!\n        if (typeof instructions === 'string' && !options.query) {\n            const [path, search] = instructions.split('?');\n            instructions = path;\n            options.query = search;\n        }\n        const toOptions = {};\n        if (options.origin) {\n            toOptions.context = options.origin;\n        }\n        let scope = null;\n        ({ instructions, scope } = NavigationInstructionResolver.createViewportInstructions(this, instructions, toOptions));\n        if (options.append && this.processingNavigation) {\n            instructions = NavigationInstructionResolver.toViewportInstructions(this, instructions);\n            this.appendInstructions(instructions, scope);\n            // Can't return current navigation promise since it can lead to deadlock in enter\n            return Promise.resolve();\n        }\n        const entry = {\n            instruction: instructions,\n            fullStateInstruction: '',\n            scope: scope,\n            title: options.title,\n            data: options.data,\n            query: options.query,\n            replacing: options.replace,\n            repeating: options.append,\n            fromBrowser: false,\n        };\n        return this.navigator.navigate(entry);\n    }\n    refresh() {\n        return this.navigator.refresh();\n    }\n    back() {\n        return this.navigator.go(-1);\n    }\n    forward() {\n        return this.navigator.go(1);\n    }\n    checkActive(instructions) {\n        for (const instruction of instructions) {\n            const scopeInstructions = this.instructionResolver.matchScope(this.activeComponents, instruction.scope);\n            const matching = scopeInstructions.filter(instr => instr.sameComponent(instruction));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.instructionResolver.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    setNav(name, routes, classes) {\n        const nav = this.findNav(name);\n        if (nav !== void 0 && nav !== null) {\n            nav.routes = [];\n        }\n        this.addNav(name, routes, classes);\n    }\n    addNav(name, routes, classes) {\n        let nav = this.navs[name];\n        if (nav === void 0 || nav === null) {\n            nav = this.navs[name] = new Nav(this, name, [], classes);\n        }\n        nav.addRoutes(routes);\n        nav.update();\n    }\n    updateNav(name) {\n        const navs = name\n            ? [name]\n            : Object.keys(this.navs);\n        for (const nav of navs) {\n            if (this.navs[nav] !== void 0 && this.navs[nav] !== null) {\n                this.navs[nav].update();\n            }\n        }\n    }\n    findNav(name) {\n        return this.navs[name];\n    }\n    addRoutes(routes, context) {\n        // TODO: This should add to the context instead\n        // TODO: Add routes without context to rootScope content (which needs to be created)?\n        return [];\n        // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n        // return viewport.addRoutes(routes);\n    }\n    removeRoutes(routes, context) {\n        // TODO: This should remove from the context instead\n        // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n        // return viewport.removeRoutes(routes);\n    }\n    addHooks(hooks) {\n        return hooks.map(hook => this.addHook(hook.hook, hook.options));\n    }\n    addHook(hook, options) {\n        return this.hookManager.addHook(hook, options);\n    }\n    removeHooks(hooks) {\n        return;\n    }\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        return this.instructionResolver.createViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n    }\n    async findInstructions(scope, instruction, instructionScope, transformUrl = false) {\n        let route = new FoundRoute();\n        if (typeof instruction === 'string') {\n            instruction = transformUrl\n                ? await this.hookManager.invokeTransformFromUrl(instruction, this.processingNavigation)\n                : instruction;\n            if (Array.isArray(instruction)) {\n                route.instructions = instruction;\n            }\n            else {\n                // TODO: Review this\n                if (instruction === '/') {\n                    instruction = '';\n                }\n                const instructions = this.instructionResolver.parseViewportInstructions(instruction);\n                if (this.options.useConfiguredRoutes && !this.hasSiblingInstructions(instructions)) {\n                    const foundRoute = scope.findMatchingRoute(instruction);\n                    if (foundRoute !== null && foundRoute.foundConfiguration) {\n                        route = foundRoute;\n                    }\n                    else {\n                        if (this.options.useDirectRoutes) {\n                            route.instructions = instructions;\n                            if (route.instructions.length > 0) {\n                                const nextInstructions = route.instructions[0].nextScopeInstructions || [];\n                                route.remaining = this.instructionResolver.stringifyViewportInstructions(nextInstructions);\n                                route.instructions[0].nextScopeInstructions = null;\n                            }\n                        }\n                    }\n                }\n                else if (this.options.useDirectRoutes) {\n                    route.instructions = instructions;\n                }\n            }\n        }\n        else {\n            route.instructions = instruction;\n        }\n        for (const instr of route.instructions) {\n            if (instr.scope === null) {\n                instr.scope = instructionScope;\n            }\n        }\n        return route;\n    }\n    hasSiblingInstructions(instructions) {\n        if (instructions === null) {\n            return false;\n        }\n        if (instructions.length > 1) {\n            return true;\n        }\n        return instructions.some(instruction => this.hasSiblingInstructions(instruction.nextScopeInstructions));\n    }\n    appendInstructions(instructions, scope = null) {\n        if (scope === null) {\n            scope = this.rootScope.scope;\n        }\n        for (const instruction of instructions) {\n            if (instruction.scope === null) {\n                instruction.scope = scope;\n            }\n        }\n        this.appendedInstructions.push(...instructions);\n    }\n    checkStale(name, instructions) {\n        const staleCheck = this.staleChecks[name];\n        if (staleCheck === void 0) {\n            this.staleChecks[name] = instructions.slice();\n            return false;\n        }\n        if (staleCheck.length !== instructions.length) {\n            this.staleChecks[name] = instructions.slice();\n            return false;\n        }\n        for (let i = 0, ii = instructions.length; i < ii; i++) {\n            if (staleCheck[i] !== instructions[i]) {\n                this.staleChecks[name] = instructions.slice();\n                return false;\n            }\n        }\n        return true;\n    }\n    unknownRoute(route) {\n        if (typeof route !== 'string' || route.length === 0) {\n            return;\n        }\n        if (this.options.useConfiguredRoutes && this.options.useDirectRoutes) {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching configured route or component found for '${route}'`);\n        }\n        else if (this.options.useConfiguredRoutes) {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching configured route found for '${route}'`);\n        }\n        else {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching route/component found for '${route}'`);\n        }\n    }\n    findViewports(instructions, alreadyFound, withoutViewports = false) {\n        const found = [];\n        const remaining = [];\n        while (instructions.length) {\n            if (instructions[0].scope === null) {\n                instructions[0].scope = this.rootScope.scope;\n            }\n            const scope = instructions[0].scope;\n            const { foundViewports, remainingInstructions } = scope.findViewports(instructions.filter(instruction => instruction.scope === scope), alreadyFound, withoutViewports);\n            found.push(...foundViewports);\n            remaining.push(...remainingInstructions);\n            instructions = instructions.filter(instruction => instruction.scope !== scope);\n        }\n        return { found: found.slice(), remaining };\n    }\n    async cancelNavigation(updatedScopeOwners, qInstruction) {\n        // TODO: Take care of disabling viewports when cancelling and stateful!\n        updatedScopeOwners.forEach((viewport) => {\n            viewport.abortContentChange().catch(error => { throw error; });\n        });\n        await this.navigator.cancel(qInstruction);\n        this.processingNavigation = null;\n        qInstruction.resolve();\n    }\n    ensureRootScope() {\n        if (!this.rootScope) {\n            const root = this.container.get(Aurelia).root;\n            // root.config.component shouldn't be used in the end. Metadata will probably eliminate it\n            this.rootScope = new ViewportScope('rootScope', this, root.config.host, null, true, root.config.component);\n        }\n        return this.rootScope;\n    }\n    async replacePaths(instruction) {\n        this.rootScope.scope.reparentViewportInstructions();\n        let instructions = this.rootScope.scope.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && !scope.viewportInstruction.isEmpty())\n            .map(scope => scope.viewportInstruction);\n        instructions = this.instructionResolver.cloneViewportInstructions(instructions, true);\n        // The following makes sure right viewport/viewport scopes are set and update\n        // whether viewport name is necessary or not\n        const alreadyFound = [];\n        let { found, remaining } = this.findViewports(instructions, alreadyFound, true);\n        let guard = 100;\n        while (remaining.length) {\n            // Guard against endless loop\n            if (!guard--) {\n                throw new Error('Failed to find viewport when updating viewer paths.');\n            }\n            alreadyFound.push(...found);\n            ({ found, remaining } = this.findViewports(remaining, alreadyFound, true));\n        }\n        this.activeComponents = instructions;\n        this.activeRoute = instruction.route;\n        // First invoke with viewport instructions (should it perhaps get full state?)\n        let state = await this.hookManager.invokeTransformToUrl(instructions, instruction);\n        if (typeof state !== 'string') {\n            // Convert to string if necessary\n            state = this.instructionResolver.stringifyViewportInstructions(state, false, true);\n        }\n        // Invoke again with string\n        state = await this.hookManager.invokeTransformToUrl(state, instruction);\n        const query = (instruction.query && instruction.query.length ? `?${instruction.query}` : '');\n        // if (instruction.path === void 0 || instruction.path.length === 0 || instruction.path === '/') {\n        instruction.path = state + query;\n        // }\n        const fullViewportStates = [this.createViewportInstruction(this.instructionResolver.clearViewportInstruction)];\n        fullViewportStates.push(...this.instructionResolver.cloneViewportInstructions(instructions, this.statefulHistory));\n        instruction.fullStateInstruction = fullViewportStates;\n        // TODO: Fetch and update title\n        return Promise.resolve();\n    }\n    async freeComponents(instruction, excludeComponents, alreadyDone) {\n        const component = instruction.componentInstance;\n        const viewport = instruction.viewport;\n        if (component === null || viewport === null || alreadyDone.some(done => done === component)) {\n            return;\n        }\n        if (!excludeComponents.some(exclude => exclude === component)) {\n            await viewport.freeContent(component);\n            alreadyDone.push(component);\n            return;\n        }\n        if (instruction.nextScopeInstructions !== null) {\n            for (const nextInstruction of instruction.nextScopeInstructions) {\n                await this.freeComponents(nextInstruction, excludeComponents, alreadyDone);\n            }\n        }\n    }\n    getClosestContainer(viewModelOrElement) {\n        if ('context' in viewModelOrElement) {\n            return viewModelOrElement.context;\n        }\n        if ('$controller' in viewModelOrElement) {\n            return viewModelOrElement.$controller.context;\n        }\n        const controller = this.CustomElementFor(viewModelOrElement);\n        if (controller === void 0) {\n            return null;\n        }\n        return controller.context;\n    }\n    getContainer(viewModelOrContainer) {\n        if ('resourceResolvers' in viewModelOrContainer) {\n            return viewModelOrContainer;\n        }\n        if (isRenderContext(viewModelOrContainer)) {\n            return viewModelOrContainer.get(IContainer);\n        }\n        if ('$controller' in viewModelOrContainer) {\n            return viewModelOrContainer.$controller.context.get(IContainer);\n        }\n        return null;\n    }\n    // TODO: This is probably wrong since it caused test fails when in CustomElement.for\n    // Fred probably knows and will need to look at it\n    // This can most likely also be changed so that the node traversal isn't necessary\n    CustomElementFor(node) {\n        let cur = node;\n        while (cur !== null) {\n            const nodeResourceName = cur.nodeName.toLowerCase();\n            const controller = Metadata.getOwn(`${CustomElement.name}:${nodeResourceName}`, cur)\n                || Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        return (void 0);\n    }\n}\nRouter.inject = [IContainer, Navigator, BrowserViewerStore, LinkHandler, InstructionResolver];\n//# sourceMappingURL=router.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Queue } from './queue';\nexport class Navigator {\n    constructor() {\n        this.entries = [];\n        this.options = {\n            statefulHistoryLength: 0,\n        };\n        this.isActive = false;\n        this.processNavigations = (qEntry) => {\n            const entry = qEntry;\n            const navigationFlags = {};\n            if (this.currentEntry === this.uninitializedEntry) { // Refresh or first entry\n                this.loadState();\n                if (this.currentEntry !== this.uninitializedEntry) {\n                    navigationFlags.refresh = true;\n                }\n                else {\n                    navigationFlags.first = true;\n                    navigationFlags.new = true;\n                    // TODO: Should this really be created here? Shouldn't it be in the viewer?\n                    this.currentEntry = {\n                        index: 0,\n                        instruction: '',\n                        fullStateInstruction: '',\n                    };\n                    this.entries = [];\n                }\n            }\n            if (entry.index !== void 0 && !entry.replacing && !entry.refreshing) { // History navigation\n                entry.historyMovement = entry.index - (this.currentEntry.index !== void 0 ? this.currentEntry.index : 0);\n                entry.instruction = this.entries[entry.index] !== void 0 && this.entries[entry.index] !== null ? this.entries[entry.index].fullStateInstruction : entry.fullStateInstruction;\n                entry.replacing = true;\n                if (entry.historyMovement > 0) {\n                    navigationFlags.forward = true;\n                }\n                else if (entry.historyMovement < 0) {\n                    navigationFlags.back = true;\n                }\n            }\n            else if (entry.refreshing || navigationFlags.refresh) { // Refreshing\n                entry.index = this.currentEntry.index;\n            }\n            else if (entry.replacing) { // Replacing\n                navigationFlags.replace = true;\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index;\n            }\n            else { // New entry\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index !== void 0 ? this.currentEntry.index + 1 : this.entries.length;\n            }\n            this.invokeCallback(entry, navigationFlags, this.currentEntry);\n        };\n        this.uninitializedEntry = {\n            instruction: 'NAVIGATOR UNINITIALIZED',\n            fullStateInstruction: '',\n        };\n        this.currentEntry = this.uninitializedEntry;\n        this.pendingNavigations = new Queue(this.processNavigations);\n    }\n    get queued() {\n        return this.pendingNavigations.length;\n    }\n    activate(router, options) {\n        if (this.isActive) {\n            throw new Error('Navigator has already been activated');\n        }\n        this.isActive = true;\n        this.router = router;\n        this.options = { ...options };\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Navigator has not been activated');\n        }\n        this.pendingNavigations.clear();\n        this.isActive = false;\n    }\n    navigate(entry) {\n        return this.pendingNavigations.enqueue(entry);\n    }\n    refresh() {\n        const entry = this.currentEntry;\n        if (entry === this.uninitializedEntry) {\n            return Promise.reject();\n        }\n        entry.replacing = true;\n        entry.refreshing = true;\n        return this.navigate(entry);\n    }\n    go(movement) {\n        const newIndex = (this.currentEntry.index !== undefined ? this.currentEntry.index : 0) + movement;\n        if (newIndex >= this.entries.length) {\n            return Promise.reject();\n        }\n        const entry = this.entries[newIndex];\n        return this.navigate(entry);\n    }\n    setEntryTitle(title) {\n        this.currentEntry.title = title;\n        return this.saveState();\n    }\n    get titles() {\n        if (this.currentEntry == this.uninitializedEntry) {\n            return [];\n        }\n        const index = this.currentEntry.index !== void 0 ? this.currentEntry.index : 0;\n        return this.entries.slice(0, index + 1).filter((value) => !!value.title).map((value) => value.title ? value.title : '');\n    }\n    getState() {\n        const state = this.options.store ? { ...this.options.store.state } : {};\n        const entries = (state.entries || []);\n        const currentEntry = (state.currentEntry || this.uninitializedEntry);\n        return { state, entries, currentEntry };\n    }\n    loadState() {\n        const state = this.getState();\n        this.entries = state.entries;\n        this.currentEntry = state.currentEntry;\n    }\n    async saveState(push = false) {\n        if (this.currentEntry === this.uninitializedEntry) {\n            return Promise.resolve();\n        }\n        const storedEntry = this.toStoredEntry(this.currentEntry);\n        this.entries[storedEntry.index !== undefined ? storedEntry.index : 0] = storedEntry;\n        if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n            const index = this.entries.length - this.options.statefulHistoryLength;\n            for (let i = 0; i < index; i++) {\n                const entry = this.entries[i];\n                if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                    this.entries[i] = await this.options.serializeCallback(entry, this.entries.slice(index));\n                }\n            }\n        }\n        if (!this.options.store) {\n            return Promise.resolve();\n        }\n        const state = {\n            entries: [],\n            currentEntry: { ...this.toStoreableEntry(storedEntry) },\n        };\n        for (const entry of this.entries) {\n            state.entries.push(this.toStoreableEntry(entry));\n        }\n        if (push) {\n            return this.options.store.pushNavigatorState(state);\n        }\n        else {\n            return this.options.store.replaceNavigatorState(state);\n        }\n    }\n    toStoredEntry(entry) {\n        const { previous, fromBrowser, replacing, refreshing, untracked, historyMovement, navigation, scope, resolve, reject, ...storableEntry } = entry;\n        return storableEntry;\n    }\n    async finalize(instruction) {\n        this.currentEntry = instruction;\n        let index = this.currentEntry.index !== undefined ? this.currentEntry.index : 0;\n        if (this.currentEntry.untracked) {\n            if (instruction.fromBrowser && this.options.store) {\n                await this.options.store.popNavigatorState();\n            }\n            index--;\n            this.currentEntry.index = index;\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else if (this.currentEntry.replacing) {\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else { // New entry (add and discard later entries)\n            if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n                // Need to clear the instructions we discard!\n                const indexPreserve = this.entries.length - this.options.statefulHistoryLength;\n                for (const entry of this.entries.slice(index)) {\n                    if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                        await this.options.serializeCallback(entry, this.entries.slice(indexPreserve, index));\n                    }\n                }\n            }\n            this.entries = this.entries.slice(0, index);\n            this.entries.push(this.toStoredEntry(this.currentEntry));\n            await this.saveState(true);\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    async cancel(instruction) {\n        if (instruction.fromBrowser && this.options.store) {\n            if (instruction.navigation && instruction.navigation.new) {\n                await this.options.store.popNavigatorState();\n            }\n            else {\n                await this.options.store.go(-(instruction.historyMovement || 0), true);\n            }\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    invokeCallback(entry, navigationFlags, previousEntry) {\n        const instruction = { ...entry };\n        instruction.navigation = navigationFlags;\n        instruction.previous = this.toStoredEntry(previousEntry);\n        Reporter.write(10000, 'callback', instruction, instruction.previous, this.entries);\n        if (this.options.callback) {\n            this.options.callback(instruction);\n        }\n    }\n    toStoreableEntry(entry) {\n        const storeable = { ...entry };\n        if (storeable.instruction && typeof storeable.instruction !== 'string') {\n            storeable.instruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.instruction);\n        }\n        if (storeable.fullStateInstruction && typeof storeable.fullStateInstruction !== 'string') {\n            storeable.fullStateInstruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.fullStateInstruction);\n        }\n        return storeable;\n    }\n}\n//# sourceMappingURL=navigator.js.map","import { ViewportInstruction } from './viewport-instruction';\nexport class InstructionResolver {\n    constructor() {\n        this.separators = {\n            viewport: '@',\n            sibling: '+',\n            scope: '/',\n            scopeStart: '(',\n            scopeEnd: ')',\n            noScope: '!',\n            parameters: '(',\n            parametersEnd: ')',\n            parameterSeparator: ',',\n            parameterKeySeparator: '=',\n            parameter: '&',\n            add: '+',\n            clear: '-',\n            action: '.',\n        };\n    }\n    activate(options) {\n        options = options || {};\n        this.separators = { ...this.separators, ...options.separators };\n    }\n    get clearViewportInstruction() {\n        return this.separators.clear;\n    }\n    get addViewportInstruction() {\n        return this.separators.add;\n    }\n    isClearViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportName\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isAddViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction\n            : (instruction === this.addViewportInstruction\n                || instruction.startsWith(`${this.separators.add}${this.separators.viewport}`));\n    }\n    isClearViewportScopeInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportScope\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isClearAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !instruction.viewportName\n            : instruction === this.clearViewportInstruction;\n    }\n    isAddAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction && !instruction.viewportName\n            : instruction === this.addViewportInstruction;\n    }\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        const instruction = new ViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n        instruction.setInstructionResolver(this);\n        return instruction;\n    }\n    parseViewportInstructions(instructions) {\n        const match = /^[./]+/.exec(instructions);\n        let context = '';\n        if (Array.isArray(match) && match.length > 0) {\n            context = match[0];\n            instructions = instructions.slice(context.length);\n        }\n        const parsedInstructions = this.parseViewportInstructionsWorker(instructions, true).instructions;\n        for (const instruction of parsedInstructions) {\n            instruction.context = context;\n        }\n        return parsedInstructions;\n    }\n    parseViewportInstruction(instruction) {\n        const instructions = this.parseViewportInstructions(instruction);\n        if (instructions.length) {\n            return instructions[0];\n        }\n        return this.createViewportInstruction('');\n    }\n    stringifyViewportInstructions(instructions, excludeViewport = false, viewportContext = false) {\n        return instructions\n            .map(instruction => this.stringifyViewportInstruction(instruction, excludeViewport, viewportContext))\n            .filter(instruction => instruction && instruction.length)\n            .join(this.separators.sibling);\n    }\n    stringifyViewportInstruction(instruction, excludeViewport = false, viewportContext = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyAViewportInstruction(instruction, excludeViewport);\n        }\n        else {\n            let excludeCurrentViewport = excludeViewport;\n            let excludeCurrentComponent = false;\n            if (viewportContext) {\n                if (instruction.viewport && instruction.viewport.options.noLink) {\n                    return '';\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewport && !instruction.viewport.options.forceDescription) {\n                    excludeCurrentViewport = true;\n                }\n                if (instruction.viewport && instruction.viewport.options.fallback === instruction.componentName) {\n                    excludeCurrentComponent = true;\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewportScope) {\n                    excludeCurrentViewport = true;\n                }\n            }\n            const route = instruction.route;\n            const nextInstructions = instruction.nextScopeInstructions;\n            let stringified = instruction.context;\n            // It's a configured route\n            if (route !== null) {\n                // Already added as part of a configuration, skip to next scope\n                if (route === '') {\n                    return Array.isArray(nextInstructions)\n                        ? this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext)\n                        : '';\n                }\n                stringified += route.endsWith(this.separators.scope) ? route.slice(0, -this.separators.scope.length) : route;\n            }\n            else {\n                stringified += this.stringifyAViewportInstruction(instruction, excludeCurrentViewport, excludeCurrentComponent);\n            }\n            if (Array.isArray(nextInstructions) && nextInstructions.length) {\n                const nextStringified = this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext);\n                if (nextStringified.length > 0) {\n                    stringified += nextInstructions.length === 1 // TODO: This should really also check that the instructions have value\n                        ? `${this.separators.scope}${nextStringified}`\n                        : `${this.separators.scope}${this.separators.scopeStart}${nextStringified}${this.separators.scopeEnd}`;\n                }\n            }\n            return stringified;\n        }\n    }\n    stringifyScopedViewportInstructions(instructions) {\n        if (!Array.isArray(instructions)) {\n            return this.stringifyScopedViewportInstructions([instructions]);\n        }\n        return instructions.map((instruction) => this.stringifyViewportInstruction(instruction)).join(this.separators.scope);\n    }\n    encodeViewportInstructions(instructions) {\n        return encodeURIComponent(this.stringifyViewportInstructions(instructions)).replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n    }\n    decodeViewportInstructions(instructions) {\n        return this.parseViewportInstructions(decodeURIComponent(instructions));\n    }\n    buildScopedLink(scopeContext, href) {\n        if (scopeContext) {\n            href = `/${scopeContext}${this.separators.scope}${href}`;\n        }\n        return href;\n    }\n    shouldClearViewports(path) {\n        const clearViewports = (path === this.separators.clear || path.startsWith(this.separators.clear + this.separators.add));\n        const newPath = path.startsWith(this.separators.clear) ? path.slice(2) : path;\n        return { clearViewports, newPath };\n    }\n    mergeViewportInstructions(instructions) {\n        const merged = [];\n        for (let instruction of instructions) {\n            if (typeof instruction === 'string') {\n                instruction = this.parseViewportInstruction(instruction);\n            }\n            const index = merged.findIndex(merge => merge.sameViewport(instruction));\n            if (index >= 0) {\n                merged.splice(index, 1, instruction);\n            }\n            else {\n                merged.push(instruction);\n            }\n        }\n        return merged;\n    }\n    flattenViewportInstructions(instructions) {\n        const flat = [];\n        for (const instruction of instructions) {\n            flat.push(instruction);\n            if (instruction.nextScopeInstructions) {\n                flat.push(...this.flattenViewportInstructions(instruction.nextScopeInstructions));\n            }\n        }\n        return flat;\n    }\n    cloneViewportInstructions(instructions, keepInstances = false, context = false) {\n        const clones = [];\n        for (const instruction of instructions) {\n            const clone = this.createViewportInstruction((keepInstances ? instruction.componentInstance : null) || instruction.componentType || instruction.componentName, keepInstances ? instruction.viewport || instruction.viewportName : instruction.viewportName, instruction.typedParameters !== null ? instruction.typedParameters : void 0);\n            clone.needsViewportDescribed = instruction.needsViewportDescribed;\n            clone.route = instruction.route;\n            if (context) {\n                clone.context = instruction.context;\n            }\n            clone.viewportScope = keepInstances ? instruction.viewportScope : null;\n            clone.scope = keepInstances ? instruction.scope : null;\n            if (instruction.nextScopeInstructions) {\n                clone.nextScopeInstructions = this.cloneViewportInstructions(instruction.nextScopeInstructions, keepInstances, context);\n            }\n            clones.push(clone);\n        }\n        return clones;\n    }\n    // TODO: Deal with separators in data and complex types\n    parseComponentParameters(parameters, uriComponent = false) {\n        if (parameters === undefined || parameters === null || parameters.length === 0) {\n            return [];\n        }\n        if (typeof parameters === 'string') {\n            const list = [];\n            const params = parameters.split(this.separators.parameterSeparator);\n            for (const param of params) {\n                let key;\n                let value;\n                [key, value] = param.split(this.separators.parameterKeySeparator);\n                if (value === void 0) {\n                    value = uriComponent ? decodeURIComponent(key) : key;\n                    key = void 0;\n                }\n                else if (uriComponent) {\n                    key = decodeURIComponent(key);\n                    value = decodeURIComponent(value);\n                }\n                list.push({ key, value });\n            }\n            return list;\n        }\n        if (Array.isArray(parameters)) {\n            return parameters.map(param => ({ key: void 0, value: param }));\n        }\n        const keys = Object.keys(parameters);\n        keys.sort();\n        return keys.map(key => ({ key, value: parameters[key] }));\n    }\n    // TODO: Deal with separators in data and complex types\n    stringifyComponentParameters(parameters, uriComponent = false) {\n        if (!Array.isArray(parameters) || parameters.length === 0) {\n            return '';\n        }\n        const seps = this.separators;\n        return parameters\n            .map(param => {\n            const key = param.key !== void 0 && uriComponent ? encodeURIComponent(param.key) : param.key;\n            const value = uriComponent ? encodeURIComponent(param.value) : param.value;\n            return key !== void 0 && key !== value ? key + seps.parameterKeySeparator + value : value;\n        })\n            .join(seps.parameterSeparator);\n    }\n    matchScope(instructions, scope) {\n        const matching = [];\n        matching.push(...instructions.filter(instruction => instruction.scope === scope));\n        matching.push(...instructions\n            .filter(instr => instr.scope !== scope)\n            .map(instr => Array.isArray(instr.nextScopeInstructions) ? this.matchScope(instr.nextScopeInstructions, scope) : [])\n            .flat());\n        return matching;\n    }\n    matchChildren(instructions, active) {\n        for (const instruction of instructions) {\n            const matching = active.filter(instr => instr.sameComponent(instruction));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    parseViewportInstructionsWorker(instructions, grouped = false) {\n        if (!instructions) {\n            return { instructions: [], remaining: '' };\n        }\n        if (instructions.startsWith(this.separators.scopeStart)) {\n            instructions = `${this.separators.scope}${instructions}`;\n        }\n        const viewportInstructions = [];\n        let guard = 1000;\n        while (instructions.length && guard) {\n            guard--;\n            if (instructions.startsWith(this.separators.scope)) {\n                instructions = instructions.slice(this.separators.scope.length);\n                const scopeStart = instructions.startsWith(this.separators.scopeStart);\n                if (scopeStart) {\n                    instructions = instructions.slice(this.separators.scopeStart.length);\n                }\n                const { instructions: found, remaining } = this.parseViewportInstructionsWorker(instructions, scopeStart);\n                if (viewportInstructions.length) {\n                    viewportInstructions[viewportInstructions.length - 1].nextScopeInstructions = found;\n                }\n                else {\n                    viewportInstructions.push(...found);\n                }\n                instructions = remaining;\n            }\n            else if (instructions.startsWith(this.separators.scopeEnd)) {\n                if (grouped) {\n                    instructions = instructions.slice(this.separators.scopeEnd.length);\n                }\n                return { instructions: viewportInstructions, remaining: instructions };\n            }\n            else if (instructions.startsWith(this.separators.sibling) && !this.isAddViewportInstruction(instructions)) {\n                if (!grouped) {\n                    return { instructions: viewportInstructions, remaining: instructions };\n                }\n                instructions = instructions.slice(this.separators.sibling.length);\n            }\n            else {\n                const { instruction: viewportInstruction, remaining } = this.parseAViewportInstruction(instructions);\n                viewportInstructions.push(viewportInstruction);\n                instructions = remaining;\n            }\n        }\n        return { instructions: viewportInstructions, remaining: instructions };\n    }\n    findNextToken(instruction, tokens) {\n        const matches = {};\n        // Tokens can have length > 1\n        for (const token of tokens) {\n            const tokenPos = instruction.indexOf(token);\n            if (tokenPos > -1) {\n                matches[token] = instruction.indexOf(token);\n            }\n        }\n        const pos = Math.min(...Object.values(matches));\n        for (const token in matches) {\n            if (matches[token] === pos) {\n                return { token, pos };\n            }\n        }\n        return { token: '', pos: -1 };\n    }\n    parseAViewportInstruction(instruction) {\n        const seps = this.separators;\n        const tokens = [seps.parameters, seps.viewport, seps.noScope, seps.scopeEnd, seps.scope, seps.sibling];\n        let component = void 0;\n        let parametersString = void 0;\n        let viewport = void 0;\n        let scope = true;\n        let token;\n        let pos;\n        const specials = [seps.add, seps.clear];\n        for (const special of specials) {\n            if (instruction === special) {\n                component = instruction;\n                instruction = '';\n                tokens.shift(); // parameters\n                tokens.shift(); // viewport\n                token = seps.viewport;\n                break;\n            }\n        }\n        if (component === void 0) {\n            for (const special of specials) {\n                if (instruction.startsWith(`${special}${seps.viewport}`)) {\n                    component = special;\n                    instruction = instruction.slice(`${special}${seps.viewport}`.length);\n                    tokens.shift(); // parameters\n                    tokens.shift(); // viewport\n                    token = seps.viewport;\n                    break;\n                }\n            }\n        }\n        if (component === void 0) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            component = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n            tokens.shift(); // parameters\n            if (token === seps.parameters) {\n                ({ token, pos } = this.findNextToken(instruction, [seps.parametersEnd]));\n                parametersString = instruction.slice(0, pos);\n                instruction = instruction.slice(pos + token.length);\n                ({ token } = this.findNextToken(instruction, tokens));\n                instruction = instruction.slice(token.length);\n            }\n            tokens.shift(); // viewport\n        }\n        if (token === seps.viewport) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            viewport = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n        }\n        tokens.shift(); // noScope\n        if (token === seps.noScope) {\n            scope = false;\n        }\n        // Restore token that belongs to next instruction\n        if (token === seps.scopeEnd || token === seps.scope || token === seps.sibling) {\n            instruction = `${token}${instruction}`;\n        }\n        const viewportInstruction = this.createViewportInstruction(component, viewport, parametersString, scope);\n        return { instruction: viewportInstruction, remaining: instruction };\n    }\n    stringifyAViewportInstruction(instruction, excludeViewport = false, excludeComponent = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyViewportInstruction(this.parseViewportInstruction(instruction), excludeViewport, excludeComponent);\n        }\n        else {\n            let instructionString = !excludeComponent ? instruction.componentName : '';\n            const specification = instruction.componentType ? instruction.componentType.parameters : null;\n            const parameters = this.stringifyComponentParameters(instruction.toSortedParameters(specification));\n            if (parameters.length > 0) {\n                instructionString += !excludeComponent\n                    ? `${this.separators.parameters}${parameters}${this.separators.parametersEnd}`\n                    : parameters;\n            }\n            if (instruction.viewportName !== null && !excludeViewport) {\n                instructionString += this.separators.viewport + instruction.viewportName;\n            }\n            if (!instruction.ownsScope) {\n                instructionString += this.separators.noScope;\n            }\n            return instructionString || '';\n        }\n    }\n}\n//# sourceMappingURL=instruction-resolver.js.map","import { __decorate, __metadata } from \"tslib\";\nimport { inject } from '@aurelia/kernel';\nimport { bindable, customElement, INode } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nlet NavCustomElement = class NavCustomElement {\n    constructor(router) {\n        this.router = router;\n        this.name = null;\n        this.routes = null;\n        this.level = 0;\n        this.classes = {};\n    }\n    get navRoutes() {\n        const nav = this.router.navs[this.name];\n        return (nav !== void 0 && nav !== null ? nav.routes : []);\n    }\n    get navClasses() {\n        const nav = this.router.navs[this.name];\n        const navClasses = (nav !== void 0 && nav !== null ? nav.classes : {});\n        return {\n            ...{\n                nav: '',\n                ul: '',\n                li: '',\n                a: '',\n                ulActive: '',\n                liActive: 'nav-active',\n                aActive: '',\n            }, ...navClasses\n        };\n    }\n    active(route) {\n        return 'Active';\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"routes\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Number)\n], NavCustomElement.prototype, \"level\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"classes\", void 0);\nNavCustomElement = __decorate([\n    inject(IRouter, INode),\n    customElement({\n        name: 'au-nav', template: `<template>\n  <nav if.bind=\"name\" class=\"\\${name} \\${navClasses.nav}\">\n    <au-nav routes.bind=\"navRoutes\" classes.bind=\"navClasses\" containerless></au-nav>\n  </nav>\n  <ul if.bind=\"routes\" class=\"nav-level-\\${level} \\${classes.ul}\">\n    <li repeat.for=\"route of routes\" if.bind=\"route.visible\" class=\"\\${route.active ? classes.liActive : ''} \\${route.hasChildren} \\${classes.li}\">\n      <a if.bind=\"route.link && route.link.length\" goto=\"\\${route.link}\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <a if.bind=\"route.execute\" click.trigger=\"route.executeAction($event)\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <span if.bind=\"(!route.link || !route.link.length) && !route.execute && !route.children\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.span} nav-separator\" innerhtml.bind=\"route.title\"></span>\n      <a if.bind=\"(!route.link || !route.link.length) && !route.execute && route.children\" click.delegate=\"route.toggleActive()\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <au-nav if.bind=\"route.children\" routes.bind=\"route.children\" level.bind=\"level + 1\" classes.bind=\"classes\" containerless></au-nav>\n    </li>\n  </ul>\n</template>`\n    }),\n    __metadata(\"design:paramtypes\", [Object])\n], NavCustomElement);\nexport { NavCustomElement };\n//# sourceMappingURL=nav.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { IContainer } from '@aurelia/kernel';\nimport { bindable, INode, customElement, CustomElement, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nexport const ParentViewport = CustomElement.createInjectable();\nlet ViewportCustomElement = class ViewportCustomElement {\n    constructor(router, element, container, parentViewport) {\n        this.router = router;\n        this.container = container;\n        this.parentViewport = parentViewport;\n        this.name = 'default';\n        this.usedBy = '';\n        this.default = '';\n        this.fallback = '';\n        this.noScope = false;\n        this.noLink = false;\n        this.noHistory = false;\n        this.stateful = false;\n        this.viewport = null;\n        this.isBound = false;\n        this.element = element;\n    }\n    afterCompile(controller) {\n        this.container = controller.context.get(IContainer);\n        // console.log('Viewport creating', this.getAttribute('name', this.name), this.container, this.parentViewport, controller, this);\n        // this.connect();\n    }\n    afterUnbind() {\n        this.isBound = false;\n    }\n    connect() {\n        if (this.router.rootScope === null) {\n            return;\n        }\n        const name = this.getAttribute('name', this.name);\n        let value = this.getAttribute('no-scope', this.noScope);\n        const options = { scope: value === void 0 || !value ? true : false };\n        value = this.getAttribute('used-by', this.usedBy);\n        if (value !== void 0) {\n            options.usedBy = value;\n        }\n        value = this.getAttribute('default', this.default);\n        if (value !== void 0) {\n            options.default = value;\n        }\n        value = this.getAttribute('fallback', this.fallback);\n        if (value !== void 0) {\n            options.fallback = value;\n        }\n        value = this.getAttribute('no-link', this.noLink, true);\n        if (value !== void 0) {\n            options.noLink = value;\n        }\n        value = this.getAttribute('no-history', this.noHistory, true);\n        if (value !== void 0) {\n            options.noHistory = value;\n        }\n        value = this.getAttribute('stateful', this.stateful, true);\n        if (value !== void 0) {\n            options.stateful = value;\n        }\n        this.viewport = this.router.connectViewport(this.viewport, this.container, name, this.element, options);\n    }\n    disconnect() {\n        if (this.viewport) {\n            this.router.disconnectViewport(this.viewport, this.container, this.element);\n        }\n        this.viewport = null;\n    }\n    beforeBind(flags) {\n        this.isBound = true;\n        this.connect();\n        if (this.viewport) {\n            this.viewport.beforeBind(flags);\n        }\n    }\n    beforeAttach(flags) {\n        if (this.viewport) {\n            return this.viewport.beforeAttach(flags);\n        }\n        return Promise.resolve();\n    }\n    beforeDetach(flags) {\n        if (this.viewport) {\n            return this.viewport.beforeDetach(flags);\n        }\n        return Promise.resolve();\n    }\n    async beforeUnbind(flags) {\n        if (this.viewport) {\n            await this.viewport.beforeUnbind(flags);\n            this.disconnect();\n        }\n    }\n    getAttribute(key, value, checkExists = false) {\n        const result = {};\n        if (this.isBound) {\n            return value;\n        }\n        else {\n            if (this.element.hasAttribute(key)) {\n                if (checkExists) {\n                    return true;\n                }\n                else {\n                    value = this.element.getAttribute(key);\n                    if (value.length > 0) {\n                        return value;\n                    }\n                }\n            }\n        }\n        return void 0;\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"usedBy\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"default\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"fallback\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noScope\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noLink\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noHistory\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"stateful\", void 0);\nViewportCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport',\n        injectable: ParentViewport\n    }),\n    __param(0, IRouter),\n    __param(1, INode),\n    __param(2, IContainer),\n    __param(3, ParentViewport),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportCustomElement])\n], ViewportCustomElement);\nexport { ViewportCustomElement };\n//# sourceMappingURL=viewport.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { bindable, INode, customElement, CustomElement, CustomElementDefinition, IController, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { IContainer } from '@aurelia/kernel';\nexport const ParentViewportScope = CustomElement.createInjectable();\nlet ViewportScopeCustomElement = class ViewportScopeCustomElement {\n    constructor(router, element, container, parent, parentController) {\n        this.router = router;\n        this.container = container;\n        this.parent = parent;\n        this.parentController = parentController;\n        this.name = 'default';\n        this.catches = '';\n        this.collection = false;\n        this.source = null;\n        this.viewportScope = null;\n        this.isBound = false;\n        this.element = element;\n    }\n    create(controller, parentContainer, definition, parts) {\n        // TODO(fkleuver): describe this somewhere in the docs instead\n        // Under the condition that there is no `replace` attribute on this custom element's declaration,\n        // and this custom element is containerless, its content will be placed in a part named 'default'\n        // See packages/jit-html/src/template-binder.ts line 411 (`replace = 'default';`) for the logic that governs this.\n        // We could tidy this up into a formal api in the future. For now, there are two ways to do this:\n        // 1. inject the `@ITargetedInstruction` (IHydrateElementInstruction) and grab .parts['default'] from there, manually creating a view factory from that, etc.\n        // 2. what we're doing right here: grab the 'default' part from the create hook and return it as the definition, telling the render context to use that part to compile this element instead\n        // This effectively causes this element to render its declared content as if it was its own template.\n        // We do need to set `containerless` to true on the part definition so that the correct projector is used since parts default to non-containerless.\n        // Otherwise, the controller will try to do `appendChild` on a comment node when it has to do `insertBefore`.\n        // Also, in this particular scenario (specific to viewport-scope) we need to clone the part so as to prevent the resulting compiled definition\n        // from ever being cached. That's the only reason why we're spreading the part into a new object for `getOrCreate`. If we didn't clone the object, this specific element wouldn't work correctly.\n        const part = parts['default'];\n        return CustomElementDefinition.getOrCreate({ ...part, containerless: true });\n    }\n    afterCompile(controller) {\n        this.container = controller.context.get(IContainer);\n        // console.log('ViewportScope creating', this.getAttribute('name', this.name), this.container, this.parent, controller, this);\n        // this.connect();\n    }\n    afterUnbound() {\n        this.isBound = false;\n    }\n    connect() {\n        if (this.router.rootScope === null) {\n            return;\n        }\n        const name = this.getAttribute('name', this.name);\n        const options = {};\n        let value = this.getAttribute('catches', this.catches);\n        if (value !== void 0) {\n            options.catches = value;\n        }\n        value = this.getAttribute('collection', this.collection, true);\n        if (value !== void 0) {\n            options.collection = value;\n        }\n        // TODO: Needs to be bound? How to solve?\n        options.source = this.source || null;\n        this.viewportScope = this.router.connectViewportScope(this.viewportScope, name, this.container, this.element, options);\n    }\n    disconnect() {\n        if (this.viewportScope) {\n            this.router.disconnectViewportScope(this.viewportScope, this.container);\n        }\n        this.viewportScope = null;\n    }\n    beforeBind(flags) {\n        this.isBound = true;\n        this.$controller.scope = this.parentController.scope;\n        this.connect();\n        if (this.viewportScope !== null) {\n            this.viewportScope.beforeBind();\n        }\n    }\n    async beforeUnbind(flags) {\n        if (this.viewportScope !== null) {\n            this.viewportScope.beforeUnbind();\n        }\n        this.disconnect();\n        return Promise.resolve();\n    }\n    getAttribute(key, value, checkExists = false) {\n        const result = {};\n        if (this.isBound) {\n            return value;\n        }\n        else {\n            if (this.element.hasAttribute(key)) {\n                if (checkExists) {\n                    return true;\n                }\n                else {\n                    value = this.element.getAttribute(key);\n                    if (value.length > 0) {\n                        return value;\n                    }\n                }\n            }\n        }\n        return void 0;\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportScopeCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportScopeCustomElement.prototype, \"catches\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportScopeCustomElement.prototype, \"collection\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], ViewportScopeCustomElement.prototype, \"source\", void 0);\nViewportScopeCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport-scope',\n        template: '<template></template>',\n        containerless: true,\n        injectable: ParentViewportScope\n    }),\n    __param(0, IRouter),\n    __param(1, INode),\n    __param(2, IContainer),\n    __param(3, ParentViewportScope),\n    __param(4, IController),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportScopeCustomElement, Object])\n], ViewportScopeCustomElement);\nexport { ViewportScopeCustomElement };\n//# sourceMappingURL=viewport-scope.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { NavigationInstructionResolver } from '../type-resolvers';\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy, IObserverLocator, CustomAttribute } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet GotoCustomAttribute = class GotoCustomAttribute {\n    constructor(dom, element, router, eventManager) {\n        this.dom = dom;\n        this.router = router;\n        this.eventManager = eventManager;\n        this.listener = null;\n        this.hasHref = null;\n        this.activeClass = 'goto-active';\n        this.element = element;\n    }\n    beforeBind() {\n        this.listener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n        this.updateValue();\n        const observerLocator = this.router.container.get(IObserverLocator);\n        this.observer = observerLocator.getObserver(0 /* none */, this.router, 'activeComponents');\n        this.observer.subscribe(this);\n    }\n    beforeUnbind() {\n        if (this.listener !== null) {\n            this.listener.dispose();\n        }\n        this.observer.unsubscribe(this);\n    }\n    valueChanged(newValue) {\n        this.updateValue();\n    }\n    updateValue() {\n        if (this.hasHref === null) {\n            this.hasHref = this.element.hasAttribute('href');\n        }\n        if (!this.hasHref) {\n            // TODO: Figure out a better value here for non-strings (using InstructionResolver?)\n            const value = typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n            this.element.setAttribute('href', value);\n        }\n    }\n    handleChange() {\n        const controller = CustomAttribute.for(this.element, 'goto').parent;\n        const created = NavigationInstructionResolver.createViewportInstructions(this.router, this.value, { context: controller });\n        const instructions = NavigationInstructionResolver.toViewportInstructions(this.router, created.instructions);\n        for (const instruction of instructions) {\n            if (instruction.scope === null) {\n                instruction.scope = created.scope;\n            }\n        }\n        // TODO: Use router configuration for class name and update target\n        if (this.router.checkActive(instructions)) {\n            this.element.classList.add(this.activeClass);\n        }\n        else {\n            this.element.classList.remove(this.activeClass);\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView }),\n    __metadata(\"design:type\", Object)\n], GotoCustomAttribute.prototype, \"value\", void 0);\nGotoCustomAttribute = __decorate([\n    customAttribute('goto'),\n    __param(0, IDOM),\n    __param(1, INode),\n    __param(2, IRouter),\n    __param(3, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], GotoCustomAttribute);\nexport { GotoCustomAttribute };\n//# sourceMappingURL=goto.js.map","import { __decorate, __metadata, __param } from \"tslib\";\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { GotoCustomAttribute } from '../configuration';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet HrefCustomAttribute = class HrefCustomAttribute {\n    constructor(dom, element, router, eventManager) {\n        this.dom = dom;\n        this.router = router;\n        this.eventManager = eventManager;\n        this.eventListener = null;\n        this.element = element;\n    }\n    beforeBind() {\n        if (this.router.options.useHref && !this.hasGoto()) {\n            this.eventListener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n        }\n        this.updateValue();\n    }\n    beforeUnbind() {\n        if (this.eventListener !== null) {\n            this.eventListener.dispose();\n        }\n    }\n    valueChanged() {\n        this.updateValue();\n    }\n    updateValue() {\n        this.element.setAttribute('href', this.value);\n    }\n    hasGoto() {\n        const parent = this.$controller.parent;\n        const siblings = parent.vmKind !== 1 /* customAttribute */ ? parent.controllers : void 0;\n        return siblings !== void 0\n            && siblings.some(c => c.vmKind === 1 /* customAttribute */ && c.viewModel instanceof GotoCustomAttribute);\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView }),\n    __metadata(\"design:type\", Object)\n], HrefCustomAttribute.prototype, \"value\", void 0);\nHrefCustomAttribute = __decorate([\n    customAttribute('href'),\n    __param(0, IDOM),\n    __param(1, INode),\n    __param(2, IRouter),\n    __param(3, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], HrefCustomAttribute);\nexport { HrefCustomAttribute };\n//# sourceMappingURL=href.js.map","import { DI } from '@aurelia/kernel';\nimport { StartTask } from '@aurelia/runtime';\nimport { NavCustomElement } from './resources/nav';\nimport { ViewportCustomElement } from './resources/viewport';\nimport { ViewportScopeCustomElement } from './resources/viewport-scope';\nimport { GotoCustomAttribute } from './resources/goto';\nimport { HrefCustomAttribute } from './resources/href';\nimport { IRouter } from './router';\nexport const RouterRegistration = IRouter;\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IRouter`\n */\nexport const DefaultComponents = [\n    RouterRegistration,\n];\nexport { ViewportCustomElement, ViewportScopeCustomElement, NavCustomElement, GotoCustomAttribute, HrefCustomAttribute, };\nexport const ViewportCustomElementRegistration = ViewportCustomElement;\nexport const ViewportScopeCustomElementRegistration = ViewportScopeCustomElement;\nexport const NavCustomElementRegistration = NavCustomElement;\nexport const GotoCustomAttributeRegistration = GotoCustomAttribute;\nexport const HrefCustomAttributeRegistration = HrefCustomAttribute;\n/**\n * Default router resources:\n * - Custom Elements: `au-viewport`, `au-nav`\n * - Custom Attributes: `goto`, `href`\n */\nexport const DefaultResources = [\n    ViewportCustomElement,\n    ViewportScopeCustomElement,\n    NavCustomElement,\n    GotoCustomAttribute,\n    HrefCustomAttribute,\n];\nlet configurationOptions = {};\nlet configurationCall = (router) => {\n    router.activate(configurationOptions);\n};\n/**\n * A DI configuration object containing router resource registrations.\n */\nconst routerConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, StartTask.with(IRouter).beforeBind().call(configurationCall), StartTask.with(IRouter).beforeAttach().call(router => router.loadUrl()));\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport const RouterConfiguration = {\n    /**\n     * Make it possible to specify options to Router activation.\n     * Parameter is either a config object that's passed to Router's activate\n     * or a config function that's called instead of Router's activate.\n     */\n    customize(config) {\n        if (config === undefined) {\n            configurationOptions = {};\n            configurationCall = (router) => {\n                router.activate(configurationOptions);\n            };\n        }\n        else if (config instanceof Function) {\n            configurationCall = config;\n        }\n        else {\n            configurationOptions = config;\n        }\n        return { ...routerConfiguration };\n    },\n    ...routerConfiguration,\n};\n//# sourceMappingURL=configuration.js.map","<header>\n    <h1>TorahIs.Life</h1>\n</header>\n\n<main>\n    <div class=\"wrapper\">\n        <div class=\"card\" repeat.for=\"shiur of shiurim\">\n            <span class=\"inner-border\"></span>\n            <h3>${shiur.subseries} - ${shiur.title}</h3>\n            <h5>\n                <div repeat.for=\"version of shiur.versions\">\n                    <a click.delegate=\"openDialog(shiur, version)\" href=\"javascript:void(0)\">${version.name} (${version.duration})</a>\n                    <button type=\"button\" title=\"Download the shiur\" click.delegate=\"downloadShiur(shiur, version)\">&#x21A7;</button>\n                </div>\n            </h5>\n            <div>${shiur.author}</div>\n        </div>\n    </div>\n</main>\n\n<div class=\"faux-dialog\" if.bind=\"selectedShiur\">\n    <div click.delegate=\"closeDialog()\">X</div>\n    <figure>\n        <figcaption>${selectedShiur.subseries} - ${selectedShiur.title} ${selectedVersion.name}. Given by ${selectedShiur.author}.</figcaption>\n        <audio controls src=\"https://torahislife.azurewebsites.net/api/ShiurRetriever?name=${selectedShiur.getVersionLocation(selectedVersion)}\">\n                Your browser does not support the<code>audio</code> element.\n        </audio>\n        <!-- <audio controls src=\"http://localhost:7071/api/ShiurRetriever?name=${selectedShiur.getVersionLocation(selectedVersion)}\">\n            Your browser does not support the<code>audio</code> element.\n        </audio> -->\n    </figure>\n</div>\n\n<footer>Powered by Pinary Development LLC  ${copyrightYears}</footer>","export class Shiur {\r\n    constructor(shiur) {\r\n        this.normalize = (str) => str.replace(/\\s/g, '').toLocaleLowerCase();\r\n        Object.assign(this, shiur);\r\n        this.versions = shiur.versions.slice(0);\r\n    }\r\n    getVersionLocation(version) {\r\n        return encodeURIComponent(`dist/${this.normalize(this.author)}/${this.normalize(this.series)}/${this.normalize(this.subseries)}/${this.title} - ${this.versions.find(v => v.name === version.name).name} (${this.date}).mp3`);\r\n    }\r\n}\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport * as __au2ViewDef from './my-app.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nimport { Shiur } from './shiur';\r\nimport { HttpClient } from 'aurelia';\r\nlet MyApp = class MyApp {\r\n    constructor(client) {\r\n        this.shiurim = [];\r\n        this.selectedShiur = undefined;\r\n        this.selectedVersion = undefined;\r\n        client.get('/data/data.json')\r\n            // client.get('https://raw.githubusercontent.com/PinaryDevelopment/torahis.life/master/docs/data/data.json')\r\n            .then(response => response.json())\r\n            .then(data => {\r\n            data.shiurim.forEach((shiur) => this.shiurim.push(new Shiur(shiur)));\r\n        });\r\n    }\r\n    openDialog(shiur, version) {\r\n        this.selectedVersion = version;\r\n        this.selectedShiur = shiur;\r\n        document.querySelector('.faux-dialog').classList.add('full');\r\n    }\r\n    closeDialog() {\r\n        document.querySelector('.faux-dialog').classList.remove('full');\r\n        setTimeout(() => {\r\n            this.selectedShiur = undefined;\r\n            this.selectedVersion = undefined;\r\n        }, 250);\r\n    }\r\n    get copyrightYears() {\r\n        const firstYear = 2020;\r\n        const currentYear = new Date(Date.now()).getFullYear();\r\n        if (currentYear === firstYear) {\r\n            return firstYear.toString();\r\n        }\r\n        return `${firstYear} - ${currentYear}`;\r\n    }\r\n    downloadShiur(shiur, version) {\r\n        window.location.href = `https://torahislife.azurewebsites.net/api/ShiurRetriever?name=${shiur.getVersionLocation(version)}`;\r\n    }\r\n};\r\nMyApp = __decorate([\r\n    customElement(__au2ViewDef),\r\n    __metadata(\"design:paramtypes\", [HttpClient])\r\n], MyApp);\r\nexport { MyApp };\r\n","import Aurelia from 'aurelia';\r\nimport { MyApp } from './my-app';\r\n// import * as globalComponents from './registry';\r\nAurelia\r\n    // .register(globalComponents)\r\n    .app(MyApp)\r\n    .start();\r\n"],"sourceRoot":""}