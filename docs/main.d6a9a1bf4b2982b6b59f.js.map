{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@aurelia/metadata/dist/esnext/index.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/functions.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/resource.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/di.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/logger.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/profiler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/eventaggregator.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/index.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/subscriber-collection.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/proxy-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/setter-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/binding-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/signaler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/connectable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behavior.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converter.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ast.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-length-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/array-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/computed-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/dirty-checker.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-size-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/map-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/primitive-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/property-accessor.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/set-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/property-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/call-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/expression-parser.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/interpolation-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/let-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ref-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/bindable-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/binding-mode.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/debounce.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/signals.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/throttle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/bindable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attribute.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle-task.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/if.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/repeat.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/replaceable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/with.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/children.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-element.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/sanitize.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/renderer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/render-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/controller.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/activator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/aurelia.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/index.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/listener.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/attribute.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/attribute-ns-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/checked-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/class-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/data-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-property-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/event-manager.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/select-value-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/style-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/svg-analyzer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/value-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/attr.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/self.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/update-trigger.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-styles.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/projectors.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/blur.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/focus.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/portal.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/create-element.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-elements/compose.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/html-renderer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-registry.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/css-modules-registry.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/index.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/ast.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-pattern.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-patterns.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-command.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/common.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/expression-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/resource-model.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/index.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/now.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/types.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/task.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/scheduler.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/index.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/platform.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-binder.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-element-factory.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-compiler.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/html-attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/scheduler-dom/dist/esnext/index.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/index.js","webpack:///./node_modules/@aurelia/jit-html-browser/dist/esnext/index.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/binding/unparser.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/tracer.js","webpack:///./node_modules/aurelia/dist/esnext/quick-start.js","webpack:///./node_modules/process/browser.js","webpack:///./src/app.scss?de5f","webpack:///./src/components/audio-player.scss?3727","webpack:///./src/components/shiurim.scss?c45b","webpack:///./src/components/shiur-details.scss?a36d","webpack:///(webpack)/buildin/global.js","webpack:///./src/app.scss","webpack:///./src/components/audio-player.scss","webpack:///./src/components/shiurim.scss","webpack:///./src/components/shiur-details.scss","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/retry-interceptor.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client-configuration.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client.js","webpack:///./node_modules/@aurelia/router/dist/esnext/queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/link-handler.js","webpack:///./node_modules/@aurelia/router/dist/esnext/utils.js","webpack:///./node_modules/@aurelia/router/dist/esnext/parser.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-content.js","webpack:///./node_modules/@aurelia/route-recognizer/dist/esnext/index.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/found-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/collection.js","webpack:///./node_modules/@aurelia/router/dist/esnext/route-recognizer.js","webpack:///./node_modules/@aurelia/router/dist/esnext/scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/type-resolvers.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-instruction.js","webpack:///./node_modules/@aurelia/router/dist/esnext/interfaces.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook-manager.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-viewer-store.js","webpack:///./node_modules/@aurelia/router/dist/esnext/router.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/instruction-resolver.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/goto.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/href.js","webpack:///./node_modules/@aurelia/router/dist/esnext/configuration.js","webpack:///./src/app.html","webpack:///./src/app.ts","webpack:///./src/components/audio-player.html","webpack:///./src/components/audio-player.ts","webpack:///./src/components/shiurim.html","webpack:///./src/models/shiur.ts","webpack:///./src/models/tag-type.enum.ts","webpack:///./src/services/shiurim.service.ts","webpack:///./src/components/shiurim.ts","webpack:///./src/components/shiur-details.html","webpack:///./src/components/shiur-details.ts","webpack:///./src/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isObject","isNullOrUndefined","metadataInternalSlot","WeakMap","$typeError","operation","args","paramName","actualValue","expectedType","TypeError","map","String","join","toString","toPropertyKeyOrUndefined","propertyKey","GetOrCreateMetadataMap","O","P","Create","targetMetadata","Map","set","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","has","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","keys","keysObj","k","metadata","metadataKey","metadataValue","target","ensurePropertyKeyOrUndefined","decorate","decorators","attributes","Array","isArray","descriptor","length","decorated","decorator","DecorateProperty","toPropertyKey","DecorateConstructor","$define","$has","OrdinaryHasMetadata","parent","getPrototypeOf","$hasOwn","$get","OrdinaryGetMetadata","$getOwn","$getKeys","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeysLen","parentKeysLen","Set","add","$getOwnKeys","$delete","delete","OrdinaryDeleteMetadata","Metadata","define","hasOwn","getOwn","getKeys","getOwnKeys","obj","Reflect","writable","configurable","isNumericLookup","isArrayIndex","result","ch","charCodeAt","isNumberOrBigInt","isStringOrDate","Date","baseCase","CharKind","isDigit","assign","charToKind","char","toUpperCase","toLowerCase","input","cb","len","prevKind","sep","output","curChar","curKind","nextChar","charAt","nextKind","camelCase","cache","callback","pascalCase","slice","kebabCase","toArray","arr","ids","nextId","context","compareNumber","a","b","emptyArray","mergeDistinct","arr1","arr2","lookup","arr3","item","len1","len2","push","bound","boundFn","this","mergeArrays","arrays","arraysLen","array","arrayLen","j","firstDefined","values","Error","getPrototypeChain","functionPrototype","Function","proto","chain","Type","toLookup","objs","isNativeFunction","isNative","sourceText","fn","LogLevel","Reporter","level","code","params","error","Tracer","enabled","liveLoggingEnabled","liveWriter","objName","methodName","writer","enableLiveLogging","optionsOrWriter","annotation","prop","keyFor","isKey","startsWith","resource","Protocol","fromAnnotationOrDefinitionOrTypeOrDefault","def","getDefault","fromAnnotationOrTypeOrDefault","fromDefinitionOrDefault","reflect","hasInternalSlot","applyMetadataPolyfill","ResolverBuilder","container","registerResolver","cacheCallbackResult","destinationKey","strategy","state","cloneArrayWithPossibleProps","source","clone","DefaultContainerConfiguration","jitRegisterInRoot","defaultResolver","singleton","transient","DI","createContainer","config","getDesignParamtypes","annotationParamtypes","appendTo","dependencies","inject","designParamtypes","getAnnotationParamtypes","Proto","getDependencies","auAnnotationParamtype","friendlyName","Interface","index","undefined","getOrCreateAnnotationParamTypes","$isInterface","noDefault","withDefault","configure","register","dep","constructor","Registration","IContainer","createInterface","IServiceLocator","createResolver","resolver","$isResolver","resolve","handler","requestor","getAll","optional","ignore","instance","createNewInstance","instanceProvider","prepare","_requestor","factory","getFactory","construct","ResolverStrategy","resolving","getResolver","Factory","invoker","transformers","dynamicDependencies","invokeWithDynamicDependencies","invoke","ii","transformer","createFactory","staticDependencies","concat","classInvokers","deps","fallbackInvoker","write","containerResolver","isRegistry","InstrinsicTypeNames","factoryAnnotationKey","registerDepth","disposableResolvers","root","resolvers","resourceResolvers","current","jj","defs","isDisposable","validateKey","indexOf","isResourceKey","registerTransformer","autoRegister","jitRegister","searchAncestors","buildAllResponse","_a","disposables","from","pop","dispose","keyAsValue","registrationResolver","newResolver","ParameterizedRegistry","filter","x","fun","cachedCallback","aliasTo","originalKey","aliasKey","defer","results","ColorOptions","__decorate","desc","arguments","getOwnPropertyDescriptor","__metadata","v","__param","paramIndex","ILogConfig","LogConfig","ISink","ILogEventFactory","DefaultLogEventFactory","ILogScopes","DefaultLogger","LoggerSink","freeze","definition","handles","format","red","str","green","yellow","blue","magenta","cyan","white","grey","colorOptions","getLogLevelString","logLevelString","TRC","DBG","INF","WRN","ERR","FTL","QQQ","getIsoString","timestamp","toISOString","DefaultLogEvent","severity","message","optionalParams","scope","getScopeString","logger","now","ConsoleSink","$console","handleEvent","event","debug","info","warn","sinks","_b","_c","_d","_e","_f","traceSinks","debugSinks","infoSinks","warnSinks","errorSinks","fatalSinks","scopedLoggers","$sink","getHandles","includes","emit","$sinks","msgOrGetMsg","createLogEvent","trace","messageOrGetMessage","fatal","scopedLogger","Profiler","timers","profileMap","profiler","createTimer","depth","mark","enter","topLevelCount","totalCount","leave","duration","enable","timer","disable","report","sort","forEach","Handler","messageType","invokeCallback","data","e","invokeHandler","handle","eventLookup","messageHandlers","channelOrInstance","subscribers","channel","channelOrType","idx","splice","sub","subscribe","subscriberCollection","_subscriberFlags","addSubscriber","removeSubscriber","hasSubscriber","hasSubscribers","callSubscribers","unsubscribe","collectionSubscriberCollection","_collectionSubscriberFlags","addCollectionSubscriber","removeCollectionSubscriber","hasCollectionSubscriber","hasCollectionSubscribers","callCollectionSubscribers","subscribeToCollection","unsubscribeFromCollection","subscriber","subscriberFlags","_subscriber0","_subscriber1","_subscriber2","_subscribersRest","addProxySubscriber","hasProxySubscriber","_proxySubscriberFlags","_proxySubscriber0","_proxySubscriber1","_proxySubscriber2","_proxySubscribersRest","_collectionSubscriber0","_collectionSubscriber1","_collectionSubscriber2","_collectionSubscribersRest","removeProxySubscriber","hasProxySubscribers","newValue","previousValue","flags","subscriber0","subscriber1","subscriber2","callSubscriber","id","ownFlags","handleChange","callProxySubscribers","handleProxyChange","indexMap","handleCollectionChange","ProxyObserver_1","ProxySubscriberCollection","proxy","raw","inBatch","getOrCreate","oldValue","Proxy","$raw","proxyObserver","$observer","getRawIfProxy","receiver","callPropertySubscribers","deleteProperty","thisArg","argArray","apply","subscribeToProxy","unsubscribeFromProxy","ViewModelKind","IController","MountStrategy","IViewFactory","ILifecycle","BoundQueue","lifecycle","head","tail","process","begin","end","controller","prevBound","nextBound","next","cur","afterBind","UnboundQueue","prevUnbound","nextUnbound","afterUnbind","AttachedQueue","mount","prevAttached","nextAttached","afterAttach","DetachedQueue","unmount","prevDetached","nextDetached","afterDetach","MountQueue","prevMount","nextMount","UnmountQueue","prevUnmount","nextUnmount","BatchQueue","queue","batch","flushBatch","currentValue","observing","persistentFlags","getValue","setValue","RuntimeError","Number","marker","keyOrObj","$synthetic","bc","ancestor","part","overrideContext","parentOverrideContext","bindingContext","parentScope","scopeParts","$observers","oc","OverrideContext","ps","poc","ISignaler","Signaler","signals","listeners","listener","TargetedInstructionType","parentPartsOwnPartsLookup","mergeParts","parentParts","ownParts","ownPartsLookup","mergedParts","ITargetedInstruction","HooksDefinition","hasCreate","hasBeforeCompile","hasAfterCompile","hasAfterCompileChildren","hasBeforeBind","hasAfterBind","hasBeforeUnbind","hasAfterUnbind","hasBeforeAttach","hasAfterAttach","hasBeforeDetach","hasAfterDetach","hasCaching","registerAliases","aliases","keyFrom","none","slotNames","versionSlotNames","lastSlot","ensureEnoughSlotNames","currentSlot","addObserver","observer","observerSlots","version","observeProperty","propertyName","observerLocator","getObserver","unobserve","all","slots","slotName","connectableDecorator","connectable","assignIdTo","BindingBehaviorStrategy","bindingBehavior","nameOrDef","BindingBehavior","inheritsFromInterceptor","BindingInterceptor","getAnnotation","binding","expr","interceptor","locator","$scope","$state","updateTarget","updateSource","callSource","$bind","$unbind","isType","valueConverter","ValueConverter","hasBind","$kind","hasUnbind","CustomExpression","expression","behaviorKey","evaluate","connect","behavior","evalList","unbind","visitor","visitBindingBehavior","converterKey","converter","toView","fromView","signaler","addSignalListener","removeSignalListener","visitValueConverter","AssignExpression","visitAssign","ConditionalExpression","condition","yes","no","visitConditional","visitAccessThis","$this","$parent","evaluatedValue","visitAccessScope","AccessMemberExpression","visitAccessMember","AccessKeyedExpression","visitAccessKeyed","func","getFunction","visitCallScope","CallMemberExpression","visitCallMember","visitCallFunction","left","right","f","visitBinary","visitUnary","PrimitiveLiteralExpression","visitPrimitiveLiteral","$undefined","$null","$true","$false","$empty","HtmlLiteralExpression","parts","elements","visitHtmlLiteral","ArrayLiteralExpression","visitArrayLiteral","ObjectLiteralExpression","visitObjectLiteral","cooked","expressions","visitTemplate","visitTaggedTemplate","ArrayBindingPattern","visitArrayBindingPattern","ObjectBindingPattern","visitObjectBindingPattern","BindingIdentifier","visitBindingIdentifier","declaration","iterable","size","$array","entry","entries","$map","$number","visitForOfStatement","isMulti","firstExpression","visitInterpolation","list","rawArray","BindingMode","BindingStrategy","State","LifecycleFlags","ExpressionKind","SubscriberFlags","DelegationStrategy","CollectionKind","createIndexMap","deletedItems","isIndexMap","CollectionLengthObserver","observerLookup","sortCompare","y","preSortCompare","insertionSort","to","compareFn","velement","ielement","vtmp","itmp","order","quickSort","v0","v1","v2","i0","i1","i2","c01","c02","c12","vpivot","ipivot","lowEnd","highStart","vtopElement","thirdIndex","partition","$push","$unshift","unshift","$pop","$shift","shift","$splice","$reverse","reverse","$sort","methods","observe","argCount","notify","inserts","element","start","deleteCount","relativeStart","actualStart","Math","max","min","actualDeleteCount","itemCount","deleted","middle","lower","upper","lowerValue","lowerIndex","upperValue","upperIndex","descriptorProps","method","enableArrayObservationCalled","enableArrayObservation","indexObservers","collection","lengthObserver","getOrCreateIndexObserver","indexObserver","ArrayIndexObserver","owner","subscriberCount","arrayObserver","prevValue","currValue","addIndexObserver","removeIndexObserver","getArrayObserver","computedOverrideDefaults","static","volatile","CustomSetterObserver","convertProperty","overrides","propertyDeps","collectionDeps","isCollecting","createGetterTraps","subscribable","getValueAndCollectDependencies","unsubscribeAllDependencies","requireCollect","doNotCollect","addCollectionDep","proxyOrValue","getMapObserver","getSetObserver","addPropertyDep","IDirtyChecker","DirtyCheckSettings","framesPerCheck","disabled","throw","scheduler","tracked","task","elapsedFrames","DirtyCheckProperty","queueRenderTask","check","persistent","cancel","delta","isDirty","flush","dirtyChecker","addProperty","removeProperty","CollectionSizeObserver","$clear","clear","oldSize","deleteResult","enableMapObservationCalled","enableMapObservation","noop","PrimitiveObserver","doNotCache","getStringLength","returnUndefined","PropertyAccessor","setValueDirect","$add","enableSetObservationCalled","observedSet","enableSetObservation","IObserverLocator","ITargetObserverLocator","ITargetAccessorLocator","targetObserverLocator","targetAccessorLocator","adapters","isBindingContext","getObservers","observersLookup","createPropertyObserver","getOrCreateObserversLookup","adapter","overridesAccessor","getAccessor","observedArray","observedMap","createObserversLookup","isNode","getLengthObserver","getIndexObserver","subject","pd","getPropertyDescriptor","adapterObserver","getAdapterObserver","createProperty","computed","givenOverrides","createComputedObserver","getCollectionObserver","rawCollection","oneTime","toViewOrOneTime","sourceExpression","targetProperty","targetObserver","$lifecycle","_previousValue","$args","IExpressionParser","expressionLookup","forOfLookup","interpolationLookup","bindingType","found","parseCore","split","firstPart","endsWith","replace","currentPart","BindingType","MultiInterpolationBinding","interpolation","isFirst","_newValue","Boolean","toBindingContext","cbName","$set","isProxy","propertyChangedCallback","propertyChanged","hasPropertyChangedCallback","shouldInterceptSet","createGetterSetter","is","BindingModeBehavior","originalModes","super","twoWay","opts","delay","firstArg","taskQueue","getPostRenderTaskQueue","queueTask","isNaN","signal","names","lastCall","nextDelay","configOrTarget","$target","$prop","Bindable","isBindableAnnotation","bindableLists","bindables","addName","maybeList","addDescription","builder","configOrProp","attribute","primary","setInterpreter","propStart","prototypeChain","keysLen","Class","iProto","iDefs","customAttribute","CustomAttribute","templateController","isTemplateController","defaultBindingMode","hooks","noMultiBindings","for","node","INode","IRenderLocation","IDOM","ni","niDOM","addEventListener","appendChild","cloneNode","convertToRenderLocation","createDocumentFragment","createNodeSequence","createElement","createCustomEvent","dispatchEvent","createNodeObserver","createTemplate","createTextNode","getEffectiveParentNode","setEffectiveParentNode","insertBefore","isMarker","isNodeInstance","isRenderLocation","makeTarget","registerElementResolver","remove","removeEventListener","setAttribute","DOM","dom","isInitialized","descriptors","protos","getOwnPropertyDescriptors","location","view","hold","$controller","attach","detach","InfrequentMutations","FrequentMutations","ObserveShallow","LifecycleTask","done","canCancel","wait","Promise","TaskSlot","IStartTask","TaskType","IStartTaskManager","run","slot","tasks","startTask","resolveTask","AggregateTerminalTask","PromiseTask","promise","hasStarted","isCancelled","then","nextResult","ProviderTask","maybePromiseOrTask","catch","ContinuationTask","antecedent","TerminalTask","AggregateContinuationTask","antecedents","hasAsyncWork","ifFactory","elseFactory","elseView","ifView","swap","attachView","release","ensureView","deactivate","updateView","activate","bindView","ifBehavior","viewModel","renderable","hasPendingInstanceMutation","views","normalizedItems","checkCollectionObserver","bindings","forOf","local","normalizeToArray","processViewsKeyed","attachViews","detachViewsByRange","unbindAndRemoveViewsByRange","oldLength","createAndBindAllViews","attachViewsKeyed","offset","applyMutationsToIndices","detachViewsByKey","unbindAndRemoveViewsByKey","createAndBindNewViewsByKey","sortViewsByKey","oldObserver","newObserver","items","iterate","iStart","iEnd","adjustLength","deletedLen","viewScope","newLen","count","fromParent","setContextualProperties","mapLen","nodes","unlink","copy","synchronizeIndices","seq","maxLen","prevIndices","Int32Array","tailIndices","cursor","prev","low","high","mid","longestIncreasingSubsequence","seqLen","link","isLast","isEven","$index","$first","$last","$middle","$even","$odd","$length","bindChild","isChildrenObserverAnnotation","Children","childrenObserverLists","childrenObservers","options","query","defaultChildQuery","defaultChildFilter","defaultChildMap","children","tryStartObserving","projector","filterChildren","subscribeToChildrenChange","onChildrenChanged","CustomElement","customElement","definitionLookup","template","instructions","injectable","needsCompile","surrogates","containerless","isStrictBinding","shadowOptions","hasSlots","generateName","generateType","partialDefinition","nameOrSearchParents","searchParents","$injectable","nameDescriptor","defaultProto","IProjectorLocator","SCRIPT_REGEX","ISanitizer","SanitizeValueConverter","sanitizer","untrustedMarkup","sanitize","ITemplateCompiler","IInstructionRenderer","IRenderer","instructionRenderer","instructionType","decoratedTarget","metadataKeys","ownProperties","instructionRenderers","record","render","targets","host","targetInstructions","renderInstructions","type","ensureExpression","parser","srcOrExpr","parse","getTarget","potentialTarget","SetPropertyRenderer","instruction","getComponentFactory","res","component","createComponent","childController","forCustomElement","addController","forCustomAttribute","parentContext","viewFactory","getRenderContext","getViewFactory","renderLocation","componentFactory","controllers","childInstructions","childInstruction","applyBindingBehavior","addBinding","refHost","refTargetName","caController","ceController","getRefTarget","behaviorExpressionIndex","behaviorExpressions","behaviorExpression","behaviorOrFactory","definitionContainerLookup","definitionContainerPartsLookup","fragmentCache","isRenderContext","parentContainer","containerLookup","containerPartsLookup","partsLookup","viewModelProvider","fragment","isCompiled","compiledDefinition","createChild","renderer","factoryProvider","parentControllerProvider","instructionProvider","renderLocationProvider","elementProvider","registerFactory","disposeResolvers","compiler","compile","parentController","resourceKey","templateDefinition","controllerLookup","vmKind","mountStrategy","getCached","getDefinition","getBindingContext","hydrateCustomElement","hydrateCustomAttribute","hydrateSynthetic","createObservers","childObserverNames","getOwnPropertyNames","observers","getLookup","childrenDescription","createChildrenObservers","beginChildComponentOperation","beforeCompile","compiledContext","projectorLocator","getElementProjector","createNodes","afterCompile","findTargets","afterCompileChildren","canReturnToCache","unmountSynthetic","bindCustomElement","bindCustomAttribute","bindSynthetic","unbindCustomElement","unbindCustomAttribute","unbindSynthetic","attachCustomElement","attachCustomAttribute","attachSynthetic","detachCustomElement","detachCustomAttribute","detachSynthetic","mountCustomElement","mountSynthetic","unmountCustomElement","cacheCustomElement","cacheCustomAttribute","cacheSynthetic","find","ret","beforeBind","bindBindings","endBind","bindControllers","beforeUnbind","unbindControllers","endUnbind","unbindBindings","beforeAttach","attachControllers","beforeDetach","detachControllers","project","take","tryReturnToCache","caching","noProxy","observableNames","bindable","isCaching","cacheSize","doNotOverrideIfAlreadySet","maxCacheSize","parseInt","forSyntheticView","seenViews","WeakSet","notYetSeen","$view","toCustomElementDefinition","Views","definitions","$views","IViewLocator","ViewValueConverter","viewLocator","viewNameOrSelector","getViewComponentForObject","IActivator","taskManager","mgr","runBeforeRender","runBeforeBind","runBeforeAttach","getCachedOrThrow","initializer","IDOMInitializer","initialize","activator","beforeCreateTask","runBeforeCreate","createTask","combinedAntecedent","_isRunning","_isStarting","_isStopping","_root","isRunning","stop","onBeforeStart","onAfterStart","onBeforeStop","onAfterStop","detail","bubbles","cancelable","global","Aurelia","DefaultComponents","modelInstanceToBoundComponent","modelTypeToUnboundComponent","availableViews","resolvedViewName","getViewName","getOrCreateBoundComponent","BoundComponent","UnboundComponent","getOrCreateUnboundComponent","getView","vm","requestedName","DefaultResources","DefaultRenderers","RuntimeConfiguration","InterpolationInstruction","IteratorBindingInstruction","CallBindingInstruction","RefBindingInstruction","SetPropertyInstruction","HydrateElementInstruction","HydrateAttributeInstruction","HydrateTemplateController","LetElementInstruction","LetBindingInstruction","$StartTask","_slot","_promiseOrTask","_container","_key","_callback","_task","promiseOrTask","at","targetEvent","delegationStrategy","preventDefault","eventManager","$event","AttributeObserver","targetAttribute","hasChanges","flushChanges","classList","priority","style","setProperty","mutationRecords","shouldProcess","attributeName","contains","getPropertyValue","getAttribute","startObservation","stopObservation","subscription","$eMObservers","$mObserver","handleMutation","disconnect","invokeHandleMutation","$scheduler","AttributeNSAccessor","namespace","removeAttributeNS","setAttributeNS","getAttributeNS","defaultMatcher","collectionObserver","valueObserver","model","synchronizeElement","elementValue","isRadio","matcher","checked","hasMatch","findIndex","pair","existingItem","$isChecked","isChecked","toStringRet","unset","currItem","ClassAttributeAccessor","nameIndex","isActive","classesToAdd","getClassesToAdd","addClassesAndUpdateIndex","classes","className","splitClassString","classString","matches","match","DataAttributeAccessor","removeAttribute","ElementPropertyAccessor","findOriginalEventTarget","composedPath","deepPath","path","stopPropagation","standardStopPropagation","propagationStopped","handleCapturedEvent","orderedCallbacks","capturedCallbacks","parentNode","orderedCallback","handleDelegatedEvent","delegatedCallbacks","ListenerTracker","eventName","capture","DelegateOrCaptureSubscription","decrement","TriggerSubscription","EventSubscriber","events","callbackOrListener","IEventManager","delegatedHandlers","capturedHandlers","handlerEntry","bubbling","increment","capturing","childObserverOptions","childList","subtree","characterData","SelectValueObserver","nodeObserver","multiple","synchronizeOptions","synchronizeValue","option","optionValue","selected","handleNodeChange","styles","cssText","styleTuples","rx","exec","getStyleTuples","getStyleTuplesFromString","getStyleTuplesFromArray","getStyleTuplesFromObject","tuple","ISVGAnalyzer","ValueAttributeObserver","xlinkNS","xmlNS","xmlnsNS","nsAttributes","inputEvents","selectEvents","contentEvents","scrollEvents","overrideProps","svgAnalyzer","tagName","nsProps","isDataAttribute","IsDataAttribute","prefix","isStandardSvgAttribute","handleSelfEvent","selfEventCallSource","originalHandler","noopShadowDOMStyles","applyTo","IShadowDOMStyles","IShadowDOMGlobalStyles","AdoptedStyleSheetsStyles","localStyles","styleSheetCache","sharedStyles","styleSheets","sheet","CSSStyleSheet","replaceSync","ShadowRoot","shadowRoot","adoptedStyleSheets","StyleElementStyles","innerHTML","prepend","defaultShadowOptions","attachShadow","childNodes","getRootNode","NodeType","effectiveParentNodeOverrides","window","document","TNode","TElement","THTMLElement","TCustomEvent","TCSSStyleSheet","TShadowRoot","Node","Element","HTMLElement","CustomEvent","destroy","emptyNodes","FragmentNodeSequence","publisher","child","deep","locationEnd","createComment","locationStart","replaceChild","$start","$nodes","markupOrNode","content","init","fetch","eventType","evt","MutationObserver","takeRecords","markup","text","containerlessOffset","nextSibling","nodeType","textContent","childNodeOrNodeSequence","nodeToInsert","referenceNode","nodeName","potentialNode","removeChild","$DOM","isMounted","isLinked","refNode","targetNodeList","querySelectorAll","childNodeList","firstChild","lastChild","addToLinked","obtainRefNode","previousSibling","defaultCaptureEventInit","passive","defaultBubbleEventInit","blurDocMap","BlurManager","blurs","createHandler","blur","addListeners","removeListeners","doc","win","navigator","pointerEnabled","linkedMultiple","searchSubTree","linkingContext","manager","createFor","unregister","triggerBlur","els","containsElementOrShadowRoot","linkedWith","links","contextNode","querySelector","body","el","onBlur","checkTargets","hasChecked","revertCheckage","markChecked","preempt","handleMousedown","composed","handleEventTarget","onpointerdown","ontouchstart","onmousedown","onfocus","onblur","Focus","needsApply","valueChanged","activeElement","focus","toTask","originalLoc","strict","currentTarget","callbackContext","targetChanged","oldTarget","newTarget","resolveTarget","activating","activated","deactivating","deactivated","$document","renderContext","queryContext","HTMLTargetedInstructionType","isHTMLTargetedInstruction","TextBindingInstruction","SetAttributeInstruction","SetClassAttributeInstruction","SetStyleAttributeInstruction","AttributeBindingInstruction","attr","tagOrType","props","allInstructions","hasInstructions","addChildren","createElementForTag","createElementForType","lazyDefinition","getContext","mergeInto","composing","lastSubject","properties","reduce","acc","compose","viewPromise","resolveView","onComposed","provideViewFor","lockScope","isController","createView","SetAttributeRenderer","SetClassAttributeRenderer","addClasses","SetStyleAttributeRenderer","$component","RuntimeHtmlConfiguration","factoryCache","IShadowDOMStyleFactory","createStyleFactory","css","createStyles","supported","some","cssModules","classLookup","ClassCustomAttribute","AttrSyntax","rawName","rawValue","command","CharSpec","chars","repeat","isSymbol","isInverted","hasOfNoneInverse","hasOfSingleInverse","hasOfMultipleInverse","hasOfNone","hasOfSingle","hasOfMultiple","other","_pattern","currentRecord","partsRecord","pattern","charSpec","patterns","nextStates","types","isEndpoint","equals","findChild","interpretation","childLen","append","StaticSegment","specs","DynamicSegment","symbols","spec","SymbolSegment","SegmentTypes","statics","dynamics","ISyntaxInterpreter","SyntaxInterpreter","rootState","initialStates","defOrDefs","currentState","segments","eachChar","states","getNextStates","aTypes","bTypes","findMatches","IAttributePattern","attributePattern","patternDefs","AttributePattern","definitionAnnotationKey","validatePrototype","getPatternDefinitions","IAttributeParser","interpreter","attrPatterns","attrPattern","interpret","bindingCommand","nameOrDefinition","BindingCommand","makeCamelCase","propName","syntax","SymbolFlags","createMarker","TemplateControllerSymbol","partName","physicalNode","_bindings","_parts","ReplacePartSymbol","CustomAttributeSymbol","PlainAttributeSymbol","BindingSymbol","CustomElementSymbol","isTarget","_customAttributes","_plainAttributes","_childNodes","isContainerless","LetElementSymbol","PlainElementSymbol","TextSymbol","default","unescapeCode","Access","Precedence","Token","Char","startIndex","lastIndex","currentToken","tokenValue","assignable","currentChar","SyntaxError","SemanticError","parseExpression","access","minPrecedence","nextToken","fromCharCode","parseInterpolation","op","TokenValues","consumeOpt","consume","parseArrayLiteralExpression","parseObjectLiteralExpression","parseTemplate","statement","parseForOfStatement","strings","opToken","tokenRaw","tagged","scanTemplateTail","CharScanners","scanNumber","isFloat","parseFloat","scanTemplate","token","expected","KeywordLookup","true","null","false","in","instanceof","typeof","void","of","codes","decompress","compressed","rangeCount","fill","returnToken","unexpectedCharacter","notMapped","IdParts","Uint8Array","quote","unescaped","buffer","last","unescapedStr","scanString","DefaultBindingSyntax","DefaultBindingLanguage","BindableInfo","bindableInfo","hasPrimary","isPrimary","contextLookup","elementLookup","attributeLookup","commandLookup","rootContainer","rootResourceResolvers","kind","defaultNow","Now","TaskQueuePriority","defaultQueueTaskOptions","reusable","$resolve","$reject","executor","reject","createExposedPromise","TaskAbortError","createdTime","queueTime","_result","_status","resetPersistentTask","err","returnToPool","isEmpty","time","flushRequestorFactory","processingSize","processingHead","processingTail","pendingSize","pendingHead","pendingTail","delayedSize","delayedHead","delayedTail","flushRequested","yieldPromise","taskPool","taskPoolSize","lastRequest","microTaskRequestFlushTask","flushRequestor","requestFlush","movePendingToProcessing","moveDelayedToProcessing","getTaskQueue","noMoreFiniteWork","reuse","status","addToProcessing","addToPending","addToDelayed","removeFromProcessing","removeFromDelayed","removeFromPending","reset","finish","request","store","IScheduler","microtaskFactory","renderFactory","macroTaskFactory","postRenderFactory","idleFactory","taskQueues","microtask","macroTask","postRender","idle","yieldMicroTask","yieldRenderTask","yieldMacroTask","yieldPostRenderTask","yieldIdleTask","yieldAll","yield","$global","self","isBrowserLike","isWebWorkerLike","isNodeLike","versions","$now","getNanoSeconds","hrtime","moduleLoadTime","nodeLoadTime","upTime","performance","$performance","hr","uptime","emptyObject","$PLATFORM","PLATFORM","IAttrSyntaxTransformer","invalidSurrogateAttribute","attributesToIgnore","hasInlineBindings","isTemplateControllerOf","manifest","resources","attrParser","exprParser","attrSyntaxTransformer","surrogate","attrSyntax","getBindingCommand","attrInfo","getAttributeInfo","transform","bindPlainAttribute","bindChildNodes","parentManifest","manifestRoot","parentManifestRoot","bindLetElement","elementInfo","getElementInfo","bindAttributes","symbol","manifestProxy","previousController","currentController","declareTemplateController","ensureAttributeOrder","manifestNode","currentTemplate","processTemplateControllers","partOwner","replacePart","proxyNode","processReplacePart","plainAttributes","modelOrValueIndex","checkedIndex","childNode","nextChild","bindManifest","bindText","textNode","wholeText","processInterpolationText","attrRawValue","bindMultiAttribute","customAttributes","valueLength","attrName","attrValue","attrTarget","ITemplateElementFactory","markupCache","firstElementChild","nextElementSibling","attrSyntaxModifier","binder","compilation","customAttributeLength","plainAttributeLength","compileCustomAttribute","compilePlainAttribute","compileChildNodes","toDefinition","instructionRows","compileParentNode","instructionRow","compileAttributes","compileBindings","compileParts","compileCustomElement","compilePlainElement","compileTemplateController","controllerInstructionRows","controllerScopeParts","bindingInstructions","compileBinding","attributeInstructions","plainAttributesLength","isOnSurrogate","replaceParts","partScopeParts","partInstructionRows","hasAttribute","shouldDefaultToTwoWay","createDOMScheduler","w","requested","canceled","cancelAnimationFrame","requestAnimationFrame","createRequestAnimationFrameFlushRequestor","clearTimeout","setTimeout","createSetTimeoutFlushRequestorFactory","rafHandle","timeoutHandle","queueFlush","createPostRequestAnimationFrameFlushRequestor","requestIdleCallback","cancelIdleCallback","createRequestIdleCallbackFlushRequestor","ownerDocument","RuntimeHtmlBrowserConfiguration","JitHtmlBrowserConfiguration","memo","isOldIE","atob","styleTarget","HTMLIFrameElement","contentDocument","stylesInDom","getIndexByIdentifier","identifier","modulesToDom","idCountMap","identifiers","base","media","sourceMap","references","updater","addStyle","insertStyleElement","nonce","insert","textStore","replaceText","replacement","applyToSingletonTag","styleSheet","cssNode","applyToTag","btoa","unescape","encodeURIComponent","JSON","stringify","singletonCounter","update","styleIndex","removeStyleElement","newObj","lastIdentifiers","newList","newLastIdentifiers","_i","_index","useSourceMap","cssMapping","sourceMapping","base64","sourceURLs","sources","sourceRoot","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","getMessageInfoForCode","codeLookup","createInvalidCodeMessageInfo","0","1","2","3","4","5","6","7","8","9","10","11","12","14","15","16","17","18","19","20","21","22","30","31","100","101","102","103","104","105","106","107","108","109","110","111","150","151","401","402","800","801","2000","2001","2002","2003","2004","1001","10000","TraceInfo","stack","defaultOptions","rendering","observation","mounting","di","jit","flagsText","flagNames","stringifyLifecycleFlags","_ctorName","description","ctorName","scopeText","$ctorName","keyText","$key","primitive","RenderingArgsProcessor","$hydrate","addComponent","BindingArgsProcessor","lockedBind","lockedUnbind","InternalObserversLookup","ObservationArgsProcessor","valueText","AttachingArgsProcessor","$attach","$detach","$cache","MountingArgsProcessor","$mount","$unmount","DIArgsProcessor","LifecycleArgsProcessor","JitArgsProcessor","TemplateBinder","createAurelia","au","env","app","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","runClearTimeout","Item","nextTick","title","browser","argv","on","addListener","once","off","removeListener","removeAllListeners","prependListener","prependOnceListener","cwd","chdir","dir","umask","api","exported","locals","g","___CSS_LOADER_API_IMPORT___","retryStrategy","defaultRetryConfig","maxRetries","interval","retryConfig","counter","requestClone","response","httpClient","doRetry","minRandomInterval","maxRandomInterval","retryStrategies","calculateDelay","newRequest","beforeRetry","retryableRequest","retryCount","random","baseUrl","defaults","interceptors","credentials","rejectErrorResponses","withInterceptor","rejectOnError","ok","absoluteUrlRegexp","activeRequestCount","isRequesting","isConfigured","normalizedConfig","isPrototypeOf","Headers","headers","retryInterceptorIndex","trackRequestStart","buildRequest","processRequest","Response","Request","processResponse","trackRequestEnd","requestContentType","parsedDefaultHeaders","parsedHeaders","$headers","parseHeaderValues","bodyObj","requestInit","url","test","getRequestUrl","isJSON","defaultHeaders","$defaultHeaders","setDefaultHeaders","Blob","callFetch","applyInterceptors","successName","errorName","interceptorArgs","successHandler","errorHandler","identity","reason","thrower","Queue","pending","processing","allowedExecutionCostWithinTick","currentExecutionCostInCurrentTick","dequeue","itemOrItems","costOrCosts","costs","promises","qItem","cost","useUrlFragmentHash","forwardedState","handlePopstate","ev","enqueue","processCalls","qCall","parameters","suppressPopstate","history","pendingCalls","pathname","search","hash","currentEntry","viewerState","go","navigationEntry","firstEntry","pushNavigatorState","calls","_resolve","useHref","getEventInfo","shouldHandleEvent","anchor","targetIsThisWindow","altKey","ctrlKey","metaKey","shiftKey","gotoAttr","goto","href","leftButtonClicked","button","targetWindow","arrayRemove","removed","arrIndex","parseQuery","param","decodeURIComponent","ContentStatus","SegmentKind","fullStateInstruction","contentStatus","entered","fromCache","fromHistory","reentry","isComponentType","componentType","toComponentType","componentInstance","viewport","sameComponent","reentryBehavior","fallback","toComponentInstance","setParameters","componentName","setComponent","ee","previousInstruction","canEnter","typeParameters","toSpecifiedParameters","merged","router","createViewportInstruction","nextInstruction","canLeave","stateful","getElementsByTagName","top","scrollTo","scrollTop","scrollLeft","removeComponent","terminateComponent","unloadComponent","destroyComponent","owningScope","rootComponentType","catches","nextContent","available","sourceItem","sourceItemIndex","connectedScope","enabledChildren","isViewportScope","viewportScope","viewportInstruction","instructionResolver","parseViewportInstruction","isClearViewportInstruction","isClearAllViewportsInstruction","isAddViewportInstruction","removeSourceItem","segment","clearViewportInstruction","addViewportInstruction","getAvailableSourceItem","siblings","every","sibling","routes","FoundRoute","matching","remaining","currentIndex","ConfigurableRoute","caseSensitive","Endpoint","route","paramNames","RecognizedRoute","endpoint","searchParams","isDynamic","queryString","Candidate","skippedStates","stateToAdd","matchCount","$process","nextState","skippedState","isMatch","isOptional","separator","isSeparator","$nextState","collectSkippedStates","statesA","statesB","iA","iB","stateA","stateB","segmentA","segmentB","skippedStatesA","skippedStatesB","skippedStatesALen","skippedStatesBLen","skippedStateA","skippedStateB","hasEndpoint","candidate","compareChains","compareTo","RecognizeResult","candidates","finalize","advance","prevState","setEndpoint","isNotEmpty","StarSegment","routeOrRoutes","$route","queryStart","URLSearchParams","decodeURI","getSolution","getParams","hasScope","replacedChildren","childCollections","passThroughScope","isViewport","scopes","viewportScopes","viewports","includeDisabled","allViewports","allScopes","getOwnedScopes","alreadyFound","disregardViewports","foundViewports","remainingInstructions","ownedScopes","availableViewportScopes","availableViewports","getEnabledViewports","viewportName","viewportInstructions","foundViewportScope","removeCurrent","foundViewport","acceptSegment","addSourceItem","needsViewportDescribed","wantComponent","ownsScope","acceptComponent","remainingViewports","nextScopeInstructions","rem","withoutViewports","doesntNeedViewportDescribed","setViewport","getOwnedViewports","addChild","setElement","vp","includeReplaced","hoistedChildren","reparentViewportInstructions","findMatchingRouteInRoutes","getRoutes","findMatchingRoute","cRoutes","ensureProperRoute","cRoute","recognizer","recognize","$params","remainingPath","foundConfiguration","cloneViewportInstructions","addParameters","NavigationInstructionResolver","toViewportInstructions","forceRemove","elementResolve","previousViewportState","historyCache","navigation","back","forward","cached","isCacheEqual","clearReplacedChildren","equalComponent","refresh","disableReplacedChildren","equalParameters","clearState","usedBy","noLink","noHistory","parseViewportInstructions","freeContent","doForceRemove","statefulHistory","waitForElement","loadComponent","initializeComponent","unloadContent","reenableReplacedChildren","ComponentAppellationResolver","isName","isInstance","getName","getType","getInstance","ViewportHandleResolver","createViewportInstructions","navigationInstructions","findScope","rootScope","viewportComponent","newInstruction","ParametersType","ReentryBehavior","HookTypes","parametersString","parametersRecord","parametersList","parametersType","parseComponentParameters","typedParameters","stringifyComponentParameters","isComponentName","isComponentInstance","getViewport","specifications","specified","parameter","sorted","compareParameters","compareType","sameParameters","mine","others","Hook","hook","includeTargets","excludeTargets","include","exclude","navigationInstruction","arg","cvTarget","beforeNavigation","transformFromUrl","transformToUrl","lastIdentity","hookFunction","wantsMatch","outcome","nav","linkVisible","linkActive","visible","active","meta","parseRoute","computeLink","consideredActive","execute","computeVisible","computeActive","activeChild","components","activeComponents","flattenViewportInstructions","stringifyViewportInstructions","addRoute","updateRoutes","newRoute","QueueTask","TaskQueue","createQueueTask","eventTask","async","evTask","suppressPopstateEvent","popstate","doneTask","forwardState","steps","titleOrEmpty","pushState","replaceState","popState","ClosestScope","IRouter","linkHandler","navs","appendedInstructions","statefulHistoryLength","useDirectRoutes","useConfiguredRoutes","loadedFirst","processingNavigation","lastNavigation","staleChecks","linkCallback","origin","navigatorCallback","processNavigations","navigatorSerializeCallback","preservedEntries","excludeComponents","preservedEntry","serialized","alreadyDone","freeComponents","browserNavigatorCallback","browserNavigationEvent","fromBrowser","navigate","qInstruction","reportCallback","instructionNavigation","configuredRoute","findInstructions","configuredRoutePath","foundInstructions","unknownRoute","clearScopeOwners","clearViewportScopes","clearInstruction","instr","addInstruction","isAddAllViewportsInstruction","updatedScopeOwners","alreadyFoundInstructions","findViewports","guard","console","log","changedScopeOwners","hooked","hookManager","invokeBeforeNavigation","cancelNavigation","scopeOwner","setNextContent","abortContentChange","hasRemaining","configured","routeScopeOwners","appendInstructions","appendedInstruction","existingAlreadyFound","sameViewport","existingFound","existingRemaining","loadContent","replacePaths","new","first","repeating","untracked","finalizeContentChange","addHooks","separators","serializeCallback","ensureRootScope","replacing","getClosestScope","viewModelOrContainer","getContainer","viewModelOrElement","getClosestContainer","findParentScope","addViewport","setClosestScope","removeViewport","unsetClosestScope","addViewportScope","removeViewportScope","toOptions","matchScope","matchChildren","flat","findNav","addNav","addRoutes","addHook","instructionScope","transformUrl","invokeTransformFromUrl","hasSiblingInstructions","foundRoute","nextInstructions","staleCheck","activeRoute","invokeTransformToUrl","fullViewportStates","CustomElementFor","nodeResourceName","qEntry","navigationFlags","uninitializedEntry","loadState","refreshing","historyMovement","pendingNavigations","movement","newIndex","saveState","getState","storedEntry","toStoredEntry","toStoreableEntry","replaceNavigatorState","previous","storableEntry","popNavigatorState","indexPreserve","previousEntry","storeable","scopeStart","scopeEnd","noScope","parametersEnd","parameterSeparator","parameterKeySeparator","action","setInstructionResolver","parsedInstructions","parseViewportInstructionsWorker","excludeViewport","viewportContext","stringifyViewportInstruction","stringifyAViewportInstruction","excludeCurrentViewport","excludeCurrentComponent","forceDescription","stringified","nextStringified","stringifyScopedViewportInstructions","scopeContext","clearViewports","newPath","merge","keepInstances","clones","uriComponent","seps","grouped","parseAViewportInstruction","tokens","pos","specials","special","findNextToken","excludeComponent","instructionString","specification","toSortedParameters","NavCustomElement","ul","li","ulActive","liActive","aActive","ParentViewport","createInjectable","parentViewport","isBound","connectViewport","disconnectViewport","checkExists","ParentViewportScope","connectViewportScope","disconnectViewportScope","hasHref","activeClass","updateValue","created","checkActive","eventListener","hasGoto","configurationOptions","configurationCall","routerConfiguration","with","loadUrl","RouterConfiguration","customize","App","currentMasechta","AudioPlayer","totalLength","currentLocation","volume","fastForwardAmount","rewindAmount","isLoading","currentTime","currentTimeElement","audioElement","createTimeSpan","percent","paused","play","pause","previousVolume","timeInSeconds","minutes","floor","seconds","hours","toFixedTimeString","timeUnit","timeUnitString","toFixed","Shiur","tags","date","previousId","author","tag","TagType","client","json","shiurim","tagId","authors","authorId","dataShiur","Shiurim","shiurimService","getShiurim","series","pv","cv","seriesTitle","shiur","key2","dateDescending","s1","s2","ShiurDetails","getShiur"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,I,+BC/B9C,SAASC,EAASf,GACrB,MAAwB,iBAAVA,GAAgC,OAAVA,GAAmC,mBAAVA,EAS1D,SAASgB,EAAkBhB,GAC9B,OAAOA,QAIX,MAAMiB,EAAuB,IAAIC,QACjC,SAASC,EAAWC,EAAWC,EAAMC,EAAWC,EAAaC,GACzD,OAAO,IAAIC,UAAU,GAAGL,KAAaC,EAAKK,IAAIC,QAAQC,KAAK,qBAAqBN,oBAA4BE,eAA0B/B,OAAOkB,UAAUkB,SAAS3C,KAAKqC,OAAiBI,OAAOJ,OAEjM,SAASO,EAAyBC,GAC9B,cAAeA,GACX,IAAK,YACL,IAAK,SACL,IAAK,SACD,OAAOA,EACX,QACI,MAAO,GAAGA,KAsBtB,SAASC,EAAuBC,EAAGC,EAAGC,GAGlC,IAAIC,EAAiBnB,EAAqBrB,IAAIqC,GAE9C,QAAuB,IAAnBG,EAA2B,CAE3B,IAAKD,EACD,OAGJC,EAAiB,IAAIC,IAErBpB,EAAqBqB,IAAIL,EAAGG,GAGhC,IAAIG,EAAcH,EAAexC,IAAIsC,GAErC,QAAoB,IAAhBK,EAAwB,CAExB,IAAKJ,EACD,OAGJI,EAAc,IAAIF,IAElBD,EAAeE,IAAIJ,EAAGK,GAG1B,OAAOA,EAIX,SAASC,EAAuBC,EAAaR,EAAGC,GAG5C,MAAMK,EAAcP,EAAuBC,EAAGC,GAAgB,GAE9D,YAAoB,IAAhBK,GAIGA,EAAYG,IAAID,GAsB3B,SAASE,EAAuBF,EAAaR,EAAGC,GAG5C,MAAMK,EAAcP,EAAuBC,EAAGC,GAAgB,GAE9D,QAAoB,IAAhBK,EAIJ,OAAOA,EAAY3C,IAAI6C,GAsB3B,SAASG,EAA0BH,EAAaI,EAAeZ,EAAGC,GAG1CF,EAAuBC,EAAGC,GAAgB,GAElDI,IAAIG,EAAaI,GAIjC,SAASC,EAAwBb,EAAGC,GAGhC,MAAMa,EAAO,GAEPR,EAAcP,EAAuBC,EAAGC,GAAgB,GAE9D,QAAoB,IAAhBK,EACA,OAAOQ,EAGX,MAAMC,EAAUT,EAAYQ,OAG5B,IAAIE,EAAI,EAER,IAAK,MAAM3C,KAAO0C,EASdD,EAAKE,GAAK3C,IAGR2C,EAEN,OAAOF,EA+FJ,SAASG,EAASC,EAAaC,GAelC,OAdA,SAAmBC,EAAQtB,GAIvB,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,YAAa,CAACgC,EAAaC,EAAeC,EAAQtB,GAAc,SAAUsB,EAAQ,sBAMvGT,EAA0BO,EAAaC,EAAeC,EA3P9D,SAAsCtB,GAClC,cAAeA,GACX,IAAK,YACL,IAAK,SACL,IAAK,SACD,OAAOA,EACX,QACI,MAAM,IAAIN,UAAU,iCAAiCM,OAoPKuB,CAA6BvB,KAKnG,SAASwB,EAASC,EAAYH,EAAQtB,EAAa0B,GAC/C,QAAoB,IAAhB1B,EAAwB,CACxB,IAAK2B,MAAMC,QAAQH,GACf,MAAMrC,EAAW,oBAAqB,CAACqC,EAAYH,EAAQtB,EAAa0B,GAAa,aAAcD,EAAY,SAEnH,IAAKzC,EAASsC,GACV,MAAMlC,EAAW,oBAAqB,CAACqC,EAAYH,EAAQtB,EAAa0B,GAAa,SAAUJ,EAAQ,sBAE3G,IAAKtC,EAAS0C,KAAgBzC,EAAkByC,GAC5C,MAAMtC,EAAW,oBAAqB,CAACqC,EAAYH,EAAQtB,EAAa0B,GAAa,aAAcA,EAAY,wCAMnH,OAJmB,OAAfA,IACAA,OAAa,GA4BzB,SAA0BD,EAAYH,EAAQtB,EAAa6B,GACvD,IAAK,IAAI7E,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,IAAKA,EAAG,CAC7C,MACM+E,GAAYC,EADAP,EAAWzE,IACDsE,EAAQtB,EAAa6B,GACjD,IAAK5C,EAAkB8C,GAAY,CAC/B,IAAK/C,EAAS+C,GACV,MAAM3C,EAAW,mBAAoB,CAACqC,EAAYH,EAAQtB,EAAa6B,GAAa,YAAaE,EAAW,wCAEhHF,EAAaE,GAGrB,OAAOF,EApCII,CAAiBR,EAAYH,EADpCtB,EAvRR,SAAuBA,GACnB,cAAeA,GACX,IAAK,SACL,IAAK,SACD,OAAOA,EACX,QACI,MAAO,GAAGA,KAiRAkC,CAAclC,GAC6B0B,GAGzD,IAAKC,MAAMC,QAAQH,GACf,MAAMrC,EAAW,oBAAqB,CAACqC,EAAYH,EAAQtB,EAAa0B,GAAa,aAAcD,EAAY,SAEnH,GAAsB,mBAAXH,EACP,MAAMlC,EAAW,oBAAqB,CAACqC,EAAYH,EAAQtB,EAAa0B,GAAa,SAAUJ,EAAQ,YAE3G,OAGR,SAA6BG,EAAYH,GACrC,IAAK,IAAItE,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,IAAKA,EAAG,CAC7C,MACM+E,GAAYC,EADAP,EAAWzE,IACDsE,GAC5B,IAAKrC,EAAkB8C,GAAY,CAC/B,GAAyB,mBAAdA,EACP,MAAM3C,EAAW,sBAAuB,CAACqC,EAAYH,GAAS,YAAaS,EAAW,gCAE1FT,EAASS,GAGjB,OAAOT,EAdIa,CAAoBV,EAAYH,GA6B/C,SAASc,EAAQhB,EAAaC,EAAeC,EAAQtB,GAEjD,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,kBAAmB,CAACgC,EAAaC,EAAeC,EAAQtB,GAAc,SAAUsB,EAAQ,sBAG7G,OAAOT,EAA0BO,EAAaC,EAAeC,EAAQvB,EAAyBC,IAElG,SAASqC,EAAKjB,EAAaE,EAAQtB,GAE/B,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,eAAgB,CAACgC,EAAaE,EAAQtB,GAAc,SAAUsB,EAAQ,sBAG3F,OA3QJ,SAASgB,EAAoB5B,EAAaR,EAAGC,GAIzC,GAAIM,EAAuBC,EAAaR,EAAGC,GACvC,OAAO,EAGX,MAAMoC,EAAS7E,OAAO8E,eAAetC,GAErC,OAAe,OAAXqC,GACOD,EAAoB5B,EAAa6B,EAAQpC,GAgQ7CmC,CAAoBlB,EAAaE,EAAQvB,EAAyBC,IAE7E,SAASyC,EAAQrB,EAAaE,EAAQtB,GAElC,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,kBAAmB,CAACgC,EAAaE,EAAQtB,GAAc,SAAUsB,EAAQ,sBAG9F,OAAOb,EAAuBW,EAAaE,EAAQvB,EAAyBC,IAEhF,SAAS0C,EAAKtB,EAAaE,EAAQtB,GAE/B,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,eAAgB,CAACgC,EAAaE,EAAQtB,GAAc,SAAUsB,EAAQ,sBAG3F,OA5PJ,SAASqB,EAAoBjC,EAAaR,EAAGC,GAIzC,GAAIM,EAAuBC,EAAaR,EAAGC,GACvC,OAAOS,EAAuBF,EAAaR,EAAGC,GAGlD,MAAMoC,EAAS7E,OAAO8E,eAAetC,GAErC,OAAe,OAAXqC,EACOI,EAAoBjC,EAAa6B,EAAQpC,QADpD,EAkPOwC,CAAoBvB,EAAaE,EAAQvB,EAAyBC,IAE7E,SAAS4C,EAAQxB,EAAaE,EAAQtB,GAElC,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,kBAAmB,CAACgC,EAAaE,EAAQtB,GAAc,SAAUsB,EAAQ,sBAG9F,OAAOV,EAAuBQ,EAAaE,EAAQvB,EAAyBC,IAEhF,SAAS6C,EAASvB,EAAQtB,GAEtB,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,mBAAoB,CAACkC,EAAQtB,GAAc,SAAUsB,EAAQ,sBAGlF,OA/MJ,SAASwB,EAAqB5C,EAAGC,GAG7B,MAAM4C,EAAUhC,EAAwBb,EAAGC,GAErCoC,EAAS7E,OAAO8E,eAAetC,GAErC,GAAe,OAAXqC,EACA,OAAOQ,EAGX,MAAMC,EAAaF,EAAqBP,EAAQpC,GAE1C8C,EAAaF,EAAQjB,OAE3B,GAAmB,IAAfmB,EACA,OAAOD,EAGX,MAAME,EAAgBF,EAAWlB,OAEjC,GAAsB,IAAlBoB,EACA,OAAOH,EAGX,MAAMxC,EAAM,IAAI4C,IAEVnC,EAAO,GAEb,IAEIzC,EAFA2C,EAAI,EAGR,IAAK,IAAIlE,EAAI,EAAGA,EAAIiG,IAAcjG,EAC9BuB,EAAMwE,EAAQ/F,GAGTuD,EAAII,IAAIpC,KAGTgC,EAAI6C,IAAI7E,GAGRyC,EAAKE,GAAK3C,IAER2C,GAIV,IAAK,IAAIlE,EAAI,EAAGA,EAAIkG,IAAiBlG,EACjCuB,EAAMyE,EAAWhG,GAGZuD,EAAII,IAAIpC,KAGTgC,EAAI6C,IAAI7E,GAGRyC,EAAKE,GAAK3C,IAER2C,GAKV,OAAOF,EA8IA8B,CAAqBxB,EAAQvB,EAAyBC,IAEjE,SAASqD,EAAY/B,EAAQtB,GAEzB,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,sBAAuB,CAACkC,EAAQtB,GAAc,SAAUsB,EAAQ,sBAGrF,OAAOP,EAAwBO,EAAQvB,EAAyBC,IAEpE,SAASsD,EAAQlC,EAAaE,EAAQtB,GAElC,IAAKhB,EAASsC,GACV,MAAMlC,EAAW,kBAAmB,CAACgC,EAAaE,EAAQtB,GAAc,SAAUsB,EAAQ,sBAG9F,OA1JJ,SAAgCpB,EAAGQ,EAAaP,GAG5C,MAAMK,EAAcP,EAAuBC,EAAGC,GAAG,GAEjD,YAAoB,IAAhBK,GAIGA,EAAY+C,OAAO7C,GAiJnB8C,CAAuBlC,EAAQF,EAAarB,EAAyBC,IAEzE,MAAMyD,EAAW,CACpBC,OAAQtB,EACRzB,IAAK0B,EACLsB,OAAQlB,EACR5E,IAAK6E,EACLkB,OAAQhB,EACRiB,QAAShB,EACTiB,WAAYT,EACZE,OAAQD,GAEZ,SAAS,EAAIS,EAAKxF,EAAKN,GACnB+F,QAAQrG,eAAeoG,EAAKxF,EAAK,CAC7B0F,UAAU,EACVrG,YAAY,EACZsG,cAAc,EACdjG,U,WC5dR,MAAMkG,EAAkB,GAWjB,SAASC,EAAanG,GACzB,cAAeA,GACX,IAAK,SACD,OAAOA,GAAS,IAAc,EAARA,KAAeA,EACzC,IAAK,SAAU,CACX,MAAMoG,EAASF,EAAgBlG,GAC/B,QAAe,IAAXoG,EACA,OAAOA,EAEX,MAAMvC,EAAS7D,EAAM6D,OACrB,GAAe,IAAXA,EACA,OAAOqC,EAAgBlG,IAAS,EAEpC,IAAIqG,EAAK,EACT,IAAK,IAAItH,EAAI,EAAGA,EAAI8E,IAAU9E,EAE1B,GADAsH,EAAKrG,EAAMsG,WAAWvH,GACZ,IAANA,GAAkB,KAAPsH,GAAexC,EAAS,GAAiCwC,EAAK,IAAgBA,EAAK,GAC9F,OAAOH,EAAgBlG,IAAS,EAGxC,OAAOkG,EAAgBlG,IAAS,EAEpC,QACI,OAAO,GAQZ,SAASuG,EAAiBvG,GAC7B,cAAeA,GACX,IAAK,SACL,IAAK,SACD,OAAO,EACX,QACI,OAAO,GAQZ,SAASwG,EAAexG,GAC3B,cAAeA,GACX,IAAK,SACD,OAAO,EACX,IAAK,SACD,OAAOA,aAAiByG,KAC5B,QACI,OAAO,GAMnB,MAAMC,EAAW,WACb,IAAIC,GACJ,SAAWA,GACPA,EAASA,EAAe,KAAI,GAAK,OACjCA,EAASA,EAAgB,MAAI,GAAK,QAClCA,EAASA,EAAgB,MAAI,GAAK,QAClCA,EAASA,EAAgB,MAAI,GAAK,QAJtC,CAKGA,IAAaA,EAAW,KAE3B,MAAMC,EAAUnH,OAAOoH,OAAOpH,OAAOY,OAAO,MAAO,CAC/C,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,EACL,GAAK,IAET,SAASyG,EAAWC,GAChB,MAAa,KAATA,EAEO,EAEPA,IAASA,EAAKC,cACP,EAEPD,IAASA,EAAKE,cACP,GAEW,IAAlBL,EAAQG,GACD,EAEJ,EAEX,OAAO,SAAUG,EAAOC,GACpB,MAAMC,EAAMF,EAAMrD,OAClB,GAAY,IAARuD,EACA,OAAOF,EAEX,IAEIG,EAFAC,GAAM,EACNC,EAAS,GAETC,EAAU,GACVC,EAAU,EACVC,EAAWR,EAAMS,OAAO,GACxBC,EAAWd,EAAWY,GAC1B,IAAK,IAAI3I,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBsI,EAAWI,EACXD,EAAUE,EACVD,EAAUG,EACVF,EAAWR,EAAMS,OAAO5I,EAAI,GAC5B6I,EAAWd,EAAWY,GACN,IAAZD,EACIF,EAAO1D,OAAS,IAEhByD,GAAM,KAILA,GAAOC,EAAO1D,OAAS,GAAiB,IAAZ4D,IAG7BH,EAAmB,IAAbD,GAA2C,IAAbO,GAExCL,GAAUJ,EAAGK,EAASF,GACtBA,GAAM,GAGd,OAAOC,GAvEE,GAmFJM,EAAY,WACrB,MAAMC,EAAQrI,OAAOY,OAAO,MAC5B,SAAS0H,EAAShB,EAAMO,GACpB,OAAOA,EAAMP,EAAKC,cAAgBD,EAAKE,cAE3C,OAAO,SAAUC,GACb,IAAIK,EAASO,EAAMZ,GAInB,YAHe,IAAXK,IACAA,EAASO,EAAMZ,GAASR,EAASQ,EAAOa,IAErCR,GAVU,GAsBZS,EAAa,WACtB,MAAMF,EAAQrI,OAAOY,OAAO,MAC5B,OAAO,SAAU6G,GACb,IAAIK,EAASO,EAAMZ,GAQnB,YAPe,IAAXK,IACAA,EAASM,EAAUX,GACfK,EAAO1D,OAAS,IAChB0D,EAASA,EAAO,GAAGP,cAAgBO,EAAOU,MAAM,IAEpDH,EAAMZ,GAASK,GAEZA,GAXW,GAuBbW,EAAY,WACrB,MAAMJ,EAAQrI,OAAOY,OAAO,MAC5B,SAAS0H,EAAShB,EAAMO,GACpB,OAAOA,EAAM,IAAIP,EAAKE,gBAAkBF,EAAKE,cAEjD,OAAO,SAAUC,GACb,IAAIK,EAASO,EAAMZ,GAInB,YAHe,IAAXK,IACAA,EAASO,EAAMZ,GAASR,EAASQ,EAAOa,IAErCR,GAVU,GAkBlB,SAASY,EAAQjB,GAEpB,MAAM,OAAErD,GAAWqD,EACbkB,EAAM1E,MAAMG,GAClB,IAAK,IAAI9E,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BqJ,EAAIrJ,GAAKmI,EAAMnI,GAEnB,OAAOqJ,EAEX,MAAMC,EAAM,GASL,SAASC,EAAOC,GAInB,YAHqB,IAAjBF,EAAIE,KACJF,EAAIE,GAAW,KAEVF,EAAIE,GAcV,SAASC,EAAcC,EAAGC,GAC7B,OAAOD,EAAIC,EAEf,MAAMC,EAAa,IAASA,WAYrB,SAASC,EAAcC,EAAMC,EAAMb,GACtC,GAAIY,SAAoCA,IAASF,EAC7C,OAAIG,SAAoCA,IAASH,EACtCA,EAGAV,EAAQa,EAAKb,MAAM,GAAKa,EAGlC,GAAIA,SAAoCA,IAASH,EAClD,OAAOV,EAAQY,EAAKZ,MAAM,GAAKY,EAEnC,MAAME,EAAS,GACTC,EAAOf,EAAQY,EAAKZ,MAAM,GAAKY,EACrC,IAKII,EALAC,EAAOL,EAAKhF,OACZsF,EAAOL,EAAKjF,OAChB,KAAOqF,KAAS,GACZH,EAAOF,EAAKK,KAAS,EAGzB,KAAOC,KAAS,GACZF,EAAOH,EAAKK,QAES,IAAjBJ,EAAOE,KACPD,EAAKI,KAAKH,GACVF,EAAOE,IAAQ,GAGvB,OAAOD,EAMJ,SAASK,EAAMhG,EAAQ/C,EAAKsD,GAC/B,MAAO,CACHqC,cAAc,EACdtG,WAAYiE,EAAWjE,WACvB,MAEI,MAAM2J,EAAU1F,EAAW5D,MAAMO,KAAKgJ,MAOtC,OANAxD,QAAQrG,eAAe6J,KAAMjJ,EAAK,CAC9BN,MAAOsJ,EACPtD,UAAU,EACVC,cAAc,EACdtG,WAAYiE,EAAWjE,aAEpB2J,IAIZ,SAASE,KAAeC,GAC3B,MAAMrD,EAAS,GACf,IAAInD,EAAI,EACR,MAAMyG,EAAYD,EAAO5F,OACzB,IACI8F,EADAC,EAAW,EAEf,IAAK,IAAI7K,EAAI,EAAGA,EAAI2K,IAAa3K,EAE7B,GADA4K,EAAQF,EAAO1K,QACD,IAAV4K,EAAkB,CAClBC,EAAWD,EAAM9F,OACjB,IAAK,IAAIgG,EAAI,EAAGA,EAAID,IAAYC,EAC5BzD,EAAOnD,KAAO0G,EAAME,GAIhC,OAAOzD,EAiBJ,SAAS0D,KAAgBC,GAC5B,MAAM3C,EAAM2C,EAAOlG,OACnB,IAAI7D,EACJ,IAAK,IAAIjB,EAAI,EAAGA,EAAIqI,IAAOrI,EAEvB,GADAiB,EAAQ+J,EAAOhL,QACD,IAAViB,EACA,OAAOA,EAGf,MAAM,IAAIgK,MAAM,0BAEb,MAAMC,EAAoB,WAC7B,MAAMC,EAAoBC,SAASxJ,UAE7B4D,EAAiB9E,OAAO8E,eACxBuD,EAAQ,IAAI5G,QAClB,IAAIkJ,EAAQF,EACRnL,EAAI,EACJsL,OAAQ,EACZ,OAAO,SAAUC,GAEb,GADAD,EAAQvC,EAAMlI,IAAI0K,QACJ,IAAVD,EAGA,IAFAvC,EAAMxF,IAAIgI,EAAMD,EAAQ,CAACD,EAAQE,IACjCvL,EAAI,GACIqL,EAAQ7F,EAAe6F,MAAYF,GACvCG,IAAQtL,GAAKqL,EAGrB,OAAOC,GAjBkB,GAoB1B,SAASE,KAAYC,GACxB,OAAO/K,OAAOoH,OAAOpH,OAAOY,OAAO,SAAUmK,GAQ1C,MAAMC,EAAmB,WAE5B,MAAM1B,EAAS,IAAI7H,QACnB,IAAIwJ,GAAW,EACXC,EAAa,GACb5L,EAAI,EAER,OAAO,SAAU6L,GA+Bb,OA9BAF,EAAW3B,EAAOnJ,IAAIgL,QACL,IAAbF,IACAC,EAAaC,EAAG/I,WAChB9C,EAAI4L,EAAW9G,OAEf6G,EAEA3L,GAAK,IAEDA,GAAK,KAE4B,MAAjC4L,EAAWrE,WAAWvH,EAAI,IAE1B4L,EAAWrE,WAAWvH,EAAI,IAAM,IACC,KAAjC4L,EAAWrE,WAAWvH,EAAI,IACO,MAAjC4L,EAAWrE,WAAWvH,EAAI,IACO,MAAjC4L,EAAWrE,WAAWvH,EAAI,IACO,MAAjC4L,EAAWrE,WAAWvH,EAAI,IACO,KAAjC4L,EAAWrE,WAAWvH,EAAI,IACO,KAAjC4L,EAAWrE,WAAWvH,EAAI,IACO,MAAjC4L,EAAWrE,WAAWvH,EAAI,IACQ,MAAlC4L,EAAWrE,WAAWvH,EAAI,KACQ,MAAlC4L,EAAWrE,WAAWvH,EAAI,KACQ,MAAlC4L,EAAWrE,WAAWvH,EAAI,KACQ,KAAlC4L,EAAWrE,WAAWvH,EAAI,KACQ,MAAlC4L,EAAWrE,WAAWvH,EAAI,KACQ,KAAlC4L,EAAWrE,WAAWvH,EAAI,IAE9BgK,EAAOzG,IAAIsI,EAAIF,IAEZA,GAtCiB,GCtYzB,IAAIG,GACX,SAAWA,GAMPA,EAASA,EAAgB,MAAI,GAAK,QAIlCA,EAASA,EAAgB,MAAI,GAAK,QAIlCA,EAASA,EAAe,KAAI,GAAK,OAIjCA,EAASA,EAAe,KAAI,GAAK,OAIjCA,EAASA,EAAgB,MAAI,GAAK,QAIlCA,EAASA,EAAgB,MAAI,GAAK,QAIlCA,EAASA,EAAe,KAAI,GAAK,OA9BrC,CA+BGA,IAAaA,EAAW,KACpB,MAAMC,EAAW,CACpBC,MAAO,EACP,MAAMC,KAASC,KACfC,MAAK,CAACF,KAASC,IAAiB,IAAIjB,MAAM,QAAQgB,MAEzCG,EAAS,CAQlBC,SAAS,EACTC,oBAAoB,EACpBC,WAAY,KASZ,MAAMC,EAASC,EAAYnK,KAI3B,UAMA,WAAWoK,KAMX,SAASA,KACTC,kBAMJ,SAA2BC,GAAmB,QAF1C,wBC5EJ,MAAMC,EAAa,CACftM,KAAM,gBACN,SAAS+D,EAAQ/C,GACb,MAAMyC,EAAOyC,EAASG,OAAOiG,EAAWtM,KAAM+D,QACjC,IAATN,EACAyC,EAASC,OAAOmG,EAAWtM,KAAM,CAACgB,GAAM+C,GAGxCN,EAAKqG,KAAK9I,IAGlB,IAAI+C,EAAQwI,EAAM7L,GACdwF,EAASC,OAAOmG,EAAWE,OAAOD,GAAO7L,EAAOqD,IAEpDzD,IAAG,CAACyD,EAAQwI,IACDrG,EAASG,OAAOiG,EAAWE,OAAOD,GAAOxI,GAEpD,QAAQA,GACJ,IAAIN,EAAOyC,EAASG,OAAOiG,EAAWtM,KAAM+D,GAI5C,YAHa,IAATN,GACAyC,EAASC,OAAOmG,EAAWtM,KAAMyD,EAAO,GAAIM,GAEzCN,GAEXgJ,MAAMzL,GACKA,EAAI0L,WAAWJ,EAAWtM,MAErCwM,OAAM,CAACxM,EAAMiJ,SACO,IAAZA,EACO,GAAGqD,EAAWtM,QAAQA,IAE1B,GAAGsM,EAAWtM,QAAQA,KAAQiJ,KAGvC0D,EAAW,CACb3M,KAAM,cACN,SAAS+D,EAAQ/C,GACb,MAAMyC,EAAOyC,EAASG,OAAOsG,EAAS3M,KAAM+D,QAC/B,IAATN,EACAyC,EAASC,OAAOwG,EAAS3M,KAAM,CAACgB,GAAM+C,GAGtCN,EAAKqG,KAAK9I,IAGlBoC,IAAIW,GACOmC,EAASE,OAAOuG,EAAS3M,KAAM+D,GAE1C,OAAOA,GACH,MAAMN,EAAOyC,EAASG,OAAOsG,EAAS3M,KAAM+D,GAC5C,YAAa,IAATN,EACO,IAAS4F,WAGT5F,EAAKrB,IAAIuB,GAAKuC,EAASG,OAAO1C,EAAGI,KAGhD,QAAQA,GACJ,IAAIN,EAAOyC,EAASG,OAAOsG,EAAS3M,KAAM+D,GAI1C,YAHa,IAATN,GACAyC,EAASC,OAAOwG,EAAS3M,KAAMyD,EAAO,GAAIM,GAEvCN,GAEXgJ,MAAMzL,GACKA,EAAI0L,WAAWC,EAAS3M,MAEnCwM,OAAM,CAACxM,EAAMiJ,SACO,IAAZA,EACO,GAAG0D,EAAS3M,QAAQA,IAExB,GAAG2M,EAAS3M,QAAQA,KAAQiJ,KAG9B2D,EAAW,CACpBN,aACAK,YAGEvG,EAASjG,OAAOkB,UAAUC,eAQzB,SAASuL,EAA0C7M,EAAM8M,EAAK9B,EAAM+B,GACvE,IAAIrM,EAAQwF,EAASG,OAAOuG,EAASN,WAAWE,OAAOxM,GAAOgL,GAC9D,YAAc,IAAVtK,GACAA,EAAQoM,EAAI9M,QACE,IAAVU,GACAA,EAAQsK,EAAKhL,QAEC,IAAVU,GAAqB0F,EAAOxG,KAAKoL,EAAMhL,GAGpCU,EAFIqM,KAIRrM,GAEJA,EAQJ,SAASsM,GAA8BhN,EAAMgL,EAAM+B,GACtD,IAAIrM,EAAQwF,EAASG,OAAOuG,EAASN,WAAWE,OAAOxM,GAAOgL,GAC9D,YAAc,IAAVtK,GACAA,EAAQsK,EAAKhL,QAEC,IAAVU,GAAqB0F,EAAOxG,KAAKoL,EAAMhL,GAGpCU,EAFIqM,KAIRrM,EAOJ,SAASuM,GAAwBjN,EAAM8M,EAAKC,GAC/C,MAAMrM,EAAQoM,EAAI9M,GAClB,YAAc,IAAVU,EACOqM,IAEJrM,GH+VJ,SAA+BwM,GAClC,GAJJ,SAAyBA,GACrB,MAFqB,YAEMA,EAGvBC,CAAgBD,GAAU,CAC1B,GAAIA,EANa,aAMiBvL,EAC9B,OAEJ,MAAM,IAAI+I,MAAM,qJAEpB,GAAI,aAAcwC,GACd,aAAcA,GACd,mBAAoBA,GACpB,gBAAiBA,GACjB,mBAAoBA,GACpB,gBAAiBA,GACjB,mBAAoBA,GACpB,oBAAqBA,GACrB,uBAAwBA,GACxB,mBAAoBA,EACpB,MAAM,IAAIxC,MAAM,6TAEpB,EAAIxE,EAAU,YAAavE,GAC3B,EAAIuL,EAAS,WAAYtJ,GACzB,EAAIsJ,EAAS,WAAYjJ,GACzB,EAAIiJ,EAAS,iBAAkBrI,GAC/B,EAAIqI,EAAS,cAAepI,GAC5B,EAAIoI,EAAS,iBAAkBhI,GAC/B,EAAIgI,EAAS,cAAe/H,GAC5B,EAAI+H,EAAS,iBAAkB7H,GAC/B,EAAI6H,EAAS,kBAAmB5H,GAChC,EAAI4H,EAAS,qBAAsBpH,GACnC,EAAIoH,EAAS,iBAAkBnH,GIhgBnCqH,CAAsB3G,SAKf,MAAM4G,GACT,YAAYC,EAAWtM,GACnBiJ,KAAKqD,UAAYA,EACjBrD,KAAKjJ,IAAMA,EAEf,SAASN,GACL,OAAOuJ,KAAKsD,iBAAiB,EAAkB7M,GAEnD,UAAUA,GACN,OAAOuJ,KAAKsD,iBAAiB,EAAmB7M,GAEpD,UAAUA,GACN,OAAOuJ,KAAKsD,iBAAiB,EAAmB7M,GAEpD,SAASA,GACL,OAAOuJ,KAAKsD,iBAAiB,EAAkB7M,GAEnD,eAAeA,GACX,OAAOuJ,KAAKsD,iBAAiB,EAAkBC,GAAoB9M,IAEvE,QAAQ+M,GACJ,OAAOxD,KAAKsD,iBAAiB,EAAeE,GAEhD,iBAAiBC,EAAUC,GACvB,MAAM,UAAEL,EAAS,IAAEtM,GAAQiJ,KAE3B,OADAA,KAAKqD,UAAYrD,KAAKjJ,SAAM,EACrBsM,EAAUC,iBAAiBvM,EAAK,IAAI,GAASA,EAAK0M,EAAUC,KAG3E,SAASC,GAA4BC,GACjC,MAAMC,EAAQD,EAAOlF,QACflF,EAAOtD,OAAOsD,KAAKoK,GACnB/F,EAAMrE,EAAKc,OACjB,IAAIvD,EACJ,IAAK,IAAIvB,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBuB,EAAMyC,EAAKhE,GACNoH,EAAa7F,KACd8M,EAAM9M,GAAO6M,EAAO7M,IAG5B,OAAO8M,EAEJ,MAKMC,GAAgC,CACzCC,mBAAmB,EACnBC,gBAP2B,CAC3B,KAAKjN,GAAO,MAAM0J,MAAM,GAAG1J,EAAIuB,mEAC/B2L,UAAUlN,GAAc,IAAI,GAASA,EAAK,EAAmBA,GAC7DmN,UAAUnN,GAAc,IAAI,GAASA,EAAK,EAAmBA,IAI5BkN,WAExBE,GAAK,CACdC,gBAAe,CAACC,EAASP,KACd,IAAI,GAAU,KAAMO,GAE/BC,oBAAoBvD,GACT9E,EAASG,OAAO,oBAAqB2E,GAEhD,wBAAwBA,GACpB,MAAMhK,EAAM4L,EAASN,WAAWE,OAAO,iBACvC,OAAOtG,EAASG,OAAOrF,EAAKgK,IAEhC,gCAAgCA,GAC5B,MAAMhK,EAAM4L,EAASN,WAAWE,OAAO,iBACvC,IAAIgC,EAAuBtI,EAASG,OAAOrF,EAAKgK,GAKhD,YAJ6B,IAAzBwD,IACAtI,EAASC,OAAOnF,EAAKwN,EAAuB,GAAIxD,GAChD4B,EAASN,WAAWmC,SAASzD,EAAMhK,IAEhCwN,GAEX,gBAAgBxD,GAIZ,MAAMhK,EAAM4L,EAASN,WAAWE,OAAO,mBACvC,IAAIkC,EAAexI,EAASG,OAAOrF,EAAKgK,GACxC,QAAqB,IAAjB0D,EAAyB,CAKzB,MAAMC,EAAS3D,EAAK2D,OACpB,QAAe,IAAXA,EAAmB,CAEnB,MAAMC,EAAmBR,GAAGG,oBAAoBvD,GAE1CwD,EAAuBJ,GAAGS,wBAAwB7D,GACxD,QAAyB,IAArB4D,EACA,QAA6B,IAAzBJ,EAAiC,CAGjC,MAAMM,EAAQ3O,OAAO8E,eAAe+F,GAEhC0D,EADiB,mBAAVI,GAAwBA,IAAUjE,SAASxJ,UACnCuM,GAA4BQ,GAAGW,gBAAgBD,IAG/C,QAKnBJ,EAAed,GAA4BY,QAG9C,QAA6B,IAAzBA,EAELE,EAAed,GAA4BgB,OAE1C,CAEDF,EAAed,GAA4BgB,GAC3C,IACII,EADAlH,EAAM0G,EAAqBjK,OAE/B,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBuP,EAAwBR,EAAqB/O,QACf,IAA1BuP,IACAN,EAAajP,GAAKuP,GAG1B,MAAMvL,EAAOtD,OAAOsD,KAAK+K,GAEzB,IAAIxN,EADJ8G,EAAMrE,EAAKc,OAEX,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBuB,EAAMyC,EAAKhE,GACNoH,EAAa7F,KACd0N,EAAa1N,GAAOwN,EAAqBxN,UAOrD0N,EAAed,GAA4Be,GAE/CzI,EAASC,OAAOnF,EAAK0N,EAAc1D,GACnC4B,EAASN,WAAWmC,SAASzD,EAAMhK,GAEvC,OAAO0N,GA6CX,gBAAgBO,GACZ,MAAMC,EAAY,SAAUnL,EAAQ3C,EAAU+N,GAC1C,GAAc,MAAVpL,QAAiCqL,eACjC,MAAM,IAAI1E,MAAM,mCAAmCwE,EAAUD,iBAIjE,OAF6Bb,GAAGiB,gCAAgCtL,GAC3CoL,GAASD,EACvBnL,GAgBX,OAdAmL,EAAUI,cAAe,EACzBJ,EAAUD,aAA+B,MAAhBA,EAAuB,YAAcA,EAC9DC,EAAUK,UAAY,WAClB,OAAOL,GAEXA,EAAUM,YAAc,SAAUC,GAO9B,OANAP,EAAUM,YAAc,WACpB,MAAMhE,EAASI,MAAM,GAAIsD,IAE7BA,EAAUQ,SAAW,SAAUpC,EAAWtM,GACtC,OAAOyO,EAAU,IAAIpC,GAAgBC,EAAWtM,QAAiCA,EAAMkO,KAEpFA,GAEJA,GAEXP,OAAM,IAAID,IACC,SAAU3K,EAAQ/C,EAAKsD,GAC1B,GAA0B,iBAAfA,EAAyB,CAChC,MAAMkK,EAAuBJ,GAAGiB,gCAAgCtL,GAC1D4L,EAAMjB,EAAa,QACb,IAARiB,IACAnB,EAAqBlK,GAAcqL,QAGtC,GAAI3O,EAAK,CACV,MAAMwN,EAAuBJ,GAAGiB,gCAAgCtL,EAAO6L,aACjED,EAAMjB,EAAa,QACb,IAARiB,IACAnB,EAAqBxN,GAAO2O,QAG/B,GAAIrL,EAAY,CACjB,MAAMgH,EAAKhH,EAAW5D,MAChB8N,EAAuBJ,GAAGiB,gCAAgC/D,GAChE,IAAIqE,EACJ,IAAK,IAAIlQ,EAAI,EAAGA,EAAIiP,EAAanK,SAAU9E,EACvCkQ,EAAMjB,EAAajP,QACP,IAARkQ,IACAnB,EAAqB/O,GAAKkQ,OAIjC,CACD,MAAMnB,EAAuBJ,GAAGiB,gCAAgCtL,GAChE,IAAI4L,EACJ,IAAK,IAAIlQ,EAAI,EAAGA,EAAIiP,EAAanK,SAAU9E,EACvCkQ,EAAMjB,EAAajP,QACP,IAARkQ,IACAnB,EAAqB/O,GAAKkQ,KAwB9CxB,UAAUpK,IACNA,EAAO2L,SAAW,SAAkBpC,GAEhC,OADqBuC,GAAa1B,UAAUpK,EAAQA,GAChC2L,SAASpC,EAAWvJ,IAErCA,GAmBXmK,UAAUnK,IACNA,EAAO2L,SAAW,SAAkBpC,GAEhC,OADqBuC,GAAa3B,UAAUnK,EAAQA,GAChC2L,SAASpC,EAAWvJ,IAErCA,IAGF+L,GAAa1B,GAAG2B,gBAAgB,cAAcR,YAC9CS,GAAkBF,GAC/B,SAASG,GAAehQ,GACpB,OAAO,SAAUe,GACb,MAAMkP,EAAW,SAAUnM,EAAQ3C,EAAUkD,GACzC8J,GAAGO,OAAOuB,EAAV9B,CAAoBrK,EAAQ3C,EAAUkD,IAM1C,OAJA4L,EAASC,aAAc,EACvBD,EAASE,QAAU,SAAUC,EAASC,GAClC,OAAOrQ,EAAOe,EAAKqP,EAASC,IAEzBJ,GAGR,MAAM,GAAS9B,GAAGO,OAalB,MAAM,GAAMsB,GAAe,CAACjP,EAAKqP,EAASC,IAAcA,EAAUC,OAAOvP,IAqDnEwP,IAzBOP,GAAe,CAACjP,EAAKqP,EAASC,IACvC,IAAMA,EAAUhQ,IAAIU,IAwBPiP,GAAe,CAACjP,EAAKqP,EAASC,IAC9CA,EAAUlN,IAAIpC,GAAK,GACZsP,EAAUhQ,IAAIU,QAGrB,IAMD,SAASyP,GAAO1M,EAAQ3C,EAAUkD,GACrC8J,GAAGO,OAAO8B,GAAVrC,CAAkBrK,EAAQ3C,EAAUkD,GAExCmM,GAAON,aAAc,EACrBM,GAAOL,QAAU,OACkBH,GAAe,CAACjP,EAAKqP,EAASC,KAC7D,MAAMI,EAAWC,GAAkB3P,EAAKqP,GAClCO,EAAmB,IAAI,GAG7B,OAFAA,EAAiBC,QAAQH,GACzBJ,EAAU/C,iBAAiBvM,EAAK4P,GAAkB,GAC3CF,IAEkBT,GAAe,CAACjP,EAAKqP,EAASS,IAAeH,GAAkB3P,EAAKqP,IACjG,SAASM,GAAkB3P,EAAKqP,GAC5B,MAAMU,EAAUV,EAAQW,WAAWhQ,GACnC,GAAgB,OAAZ+P,EACA,MAAM,IAAIrG,MAAM,6BAA6B1J,KAEjD,OAAO+P,EAAQE,UAAUZ,GAGtB,IAAIa,IACX,SAAWA,GACPA,EAAiBA,EAA2B,SAAI,GAAK,WACrDA,EAAiBA,EAA4B,UAAI,GAAK,YACtDA,EAAiBA,EAA4B,UAAI,GAAK,YACtDA,EAAiBA,EAA2B,SAAI,GAAK,WACrDA,EAAiBA,EAAwB,MAAI,GAAK,QAClDA,EAAiBA,EAAwB,MAAI,GAAK,QANtD,CAOGA,KAAqBA,GAAmB,KAEpC,MAAM,GACT,YAAYlQ,EAAK0M,EAAUC,GACvB1D,KAAKjJ,IAAMA,EACXiJ,KAAKyD,SAAWA,EAChBzD,KAAK0D,MAAQA,EACb1D,KAAKkH,WAAY,EAErB,kBAAoB,OAAO,EAC3B,SAAS7D,EAAWtM,GAChB,OAAOsM,EAAUC,iBAAiBvM,GAAOiJ,KAAKjJ,IAAKiJ,MAEvD,QAAQoG,EAASC,GACb,OAAQrG,KAAKyD,UACT,KAAK,EACD,OAAOzD,KAAK0D,MAChB,KAAK,EAAmB,CACpB,GAAI1D,KAAKkH,UACL,MAAM,IAAIzG,MAAM,4BAA4BT,KAAK0D,MAAM3N,QAE3DiK,KAAKkH,WAAY,EACjB,MAAMJ,EAAUV,EAAQW,WAAW/G,KAAK0D,OACxC,GAAgB,OAAZoD,EACA,MAAM,IAAIrG,MAAM,gBAAgBrI,OAAO4H,KAAKjJ,gCAKhD,OAHAiJ,KAAK0D,MAAQoD,EAAQE,UAAUX,GAC/BrG,KAAKyD,SAAW,EAChBzD,KAAKkH,WAAY,EACVlH,KAAK0D,MAEhB,KAAK,EAAmB,CAEpB,MAAMoD,EAAUV,EAAQW,WAAW/G,KAAK0D,OACxC,GAAgB,OAAZoD,EACA,MAAM,IAAIrG,MAAM,gBAAgBrI,OAAO4H,KAAKjJ,gCAEhD,OAAO+P,EAAQE,UAAUX,GAE7B,KAAK,EACD,OAAOrG,KAAK0D,MAAM0C,EAASC,EAAWrG,MAC1C,KAAK,EACD,OAAOA,KAAK0D,MAAM,GAAGyC,QAAQC,EAASC,GAC1C,KAAK,EACD,OAAOD,EAAQ/P,IAAI2J,KAAK0D,OAC5B,QACI,MAAMnC,EAASI,MAAM,EAAG3B,KAAKyD,WAGzC,WAAWJ,GACP,IAAI4C,EACJ,OAAQjG,KAAKyD,UACT,KAAK,EACL,KAAK,EACD,OAAOJ,EAAU0D,WAAW/G,KAAK0D,OACrC,KAAK,EAED,OADAuC,EAAW5C,EAAU8D,YAAYnH,KAAK0D,OACtB,MAAZuC,QAA4C,IAAxBA,EAASc,WACtB,KAEJd,EAASc,WAAW1D,GAC/B,QACI,OAAO,OAKhB,MAAM+D,GACT,YAAYrG,EAAMsG,EAAS5C,GACvBzE,KAAKe,KAAOA,EACZf,KAAKqH,QAAUA,EACfrH,KAAKyE,aAAeA,EACpBzE,KAAKsH,aAAe,KAExB,UAAUjE,EAAWkE,GACjB,MAAMD,EAAetH,KAAKsH,aAC1B,IAAIb,OAAmC,IAAxBc,EACTvH,KAAKqH,QAAQG,8BAA8BnE,EAAWrD,KAAKe,KAAMf,KAAKyE,aAAc8C,GACpFvH,KAAKqH,QAAQI,OAAOpE,EAAWrD,KAAKe,KAAMf,KAAKyE,cACrD,GAAoB,MAAhB6C,EACA,OAAOb,EAEX,IAAK,IAAIjR,EAAI,EAAGkS,EAAKJ,EAAahN,OAAQ9E,EAAIkS,IAAMlS,EAChDiR,EAAWa,EAAa9R,GAAGiR,GAE/B,OAAOA,EAEX,oBAAoBkB,GAKhB,OAJyB,MAArB3H,KAAKsH,eACLtH,KAAKsH,aAAe,IAExBtH,KAAKsH,aAAazH,KAAK8H,IAChB,GAGf,MAAMC,GAAgB,WAClB,SAASJ,EAA8BnE,EAAWtC,EAAM8G,EAAoBN,GACxE,IAEI/H,EAFAhK,EAAIqS,EAAmBvN,OACvBxC,EAAO,IAAIqC,MAAM3E,GAErB,KAAOA,KAAM,GAAG,CAEZ,GADAgK,EAASqI,EAAmBrS,GACd,MAAVgK,EACA,MAAM+B,EAASI,MAAM,EAAG,SAASnM,MAGjCsC,EAAKtC,GAAK6N,EAAUhN,IAAImJ,GAMhC,YAH4B,IAAxB+H,IACAzP,EAAOA,EAAKgQ,OAAOP,IAEhB/K,QAAQwK,UAAUjG,EAAMjJ,GAEnC,MAAMiQ,EAAgB,CAClB,CACIN,OAAM,CAACpE,EAAWtC,IACP,IAAIA,EAEfyG,iCAEJ,CACIC,OAAM,CAACpE,EAAWtC,EAAMiH,IACb,IAAIjH,EAAKsC,EAAUhN,IAAI2R,EAAK,KAEvCR,iCAEJ,CACIC,OAAM,CAACpE,EAAWtC,EAAMiH,IACb,IAAIjH,EAAKsC,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,KAE/DR,iCAEJ,CACIC,OAAM,CAACpE,EAAWtC,EAAMiH,IACb,IAAIjH,EAAKsC,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,KAEvFR,iCAEJ,CACIC,OAAM,CAACpE,EAAWtC,EAAMiH,IACb,IAAIjH,EAAKsC,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,KAE/GR,iCAEJ,CACIC,OAAM,CAACpE,EAAWtC,EAAMiH,IACb,IAAIjH,EAAKsC,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,KAEvIR,kCAGFS,EAAkB,CACpBR,OAAQD,EACRA,iCAEJ,OAAO,SAAUzG,GACTG,EAAiBH,IACjBQ,EAAS2G,MAAM,EAAGnH,EAAKhL,MAE3B,MAAM0O,EAAeN,GAAGW,gBAAgB/D,GAClCsG,EAAUU,EAAczN,OAASmK,EAAanK,OAASyN,EAActD,EAAanK,QAAU2N,EAClG,OAAO,IAAIb,GAAQrG,EAAMsG,EAAS5C,IAnEpB,GAsEhB0D,GAAoB,CACtBjC,aAAa,EACbC,QAAO,CAACC,EAASC,IACNA,GAGf,SAAS+B,GAAW7L,GAChB,MAA+B,mBAAjBA,EAAIkJ,SAQtB,MAAM4C,GAAsB,IAAI1M,IAAI,CAChC,QACA,cACA,UACA,WACA,OACA,QACA,YACA,eACA,eACA,WACA,YACA,aACA,aACA,MACA,SACA,SACA,UACA,aACA,iBACA,SACA,MACA,oBACA,SACA,cACA,YACA,aACA,oBACA,cACA,cACA,WACA,UACA,YAGE2M,GAAuB3F,EAASN,WAAWE,OAD9B,cAGZ,MAAM,GACT,YAAYxH,EAAQsJ,EAASP,IACzB9D,KAAKjF,OAASA,EACdiF,KAAKqE,OAASA,EACdrE,KAAKuI,cAAgB,EACrBvI,KAAKwI,oBAAsB,IAAI7M,IAChB,OAAXZ,GACAiF,KAAKyI,KAAOzI,KACZA,KAAK0I,UAAY,IAAI5P,IACrBkH,KAAK2I,kBAAoBzS,OAAOY,OAAO,QAGvCkJ,KAAKyI,KAAO1N,EAAO0N,KACnBzI,KAAK0I,UAAY,IAAI5P,IACrBkH,KAAK2I,kBAAoBzS,OAAOoH,OAAOpH,OAAOY,OAAO,MAAOkJ,KAAKyI,KAAKE,oBAE1E3I,KAAK0I,UAAU3P,IAAI8M,GAAYsC,IAEnC,YAAYzG,GACR,GAA6B,OAAvB1B,KAAKuI,cACP,MAAM,IAAI9H,MAAM,qCAKpB,IAAImI,EACApP,EACA/C,EACA6J,EACAuI,EACJ,IAAK,IAAIrT,EAAI,EAAGkS,EAAKhG,EAAOpH,OAAQ9E,EAAIkS,IAAMlS,EAE1C,GADAoT,EAAUlH,EAAOlM,GACZgC,EAASoR,GAGd,GAAIR,GAAWQ,GACXA,EAAQnD,SAASzF,WAEhB,GAAI2C,EAASD,SAASvJ,IAAIyP,GAAU,CACrC,MAAME,EAAOnG,EAASD,SAAS4D,OAAOsC,GACtC,GAAoB,IAAhBE,EAAKxO,OAELwO,EAAK,GAAGrD,SAASzF,UAEhB,CACD,MAAMnC,EAAMiL,EAAKxO,OACjB,IAAK,IAAIxE,EAAI,EAAGA,EAAI+H,IAAO/H,EACvBgT,EAAKhT,GAAG2P,SAASzF,YAIxB,QA7FY,IA6FA4I,EA7FdxR,UA8FCwO,GAAa3B,UAAU2E,EAASA,GAASnD,SAASzF,WAMlD,IAHAxG,EAAOtD,OAAOsD,KAAKoP,GACnBtI,EAAI,EACJuI,EAAKrP,EAAKc,OACHgG,EAAIuI,IAAMvI,EACb7J,EAAQmS,EAAQpP,EAAK8G,IAChB9I,EAASf,KAKV2R,GAAW3R,GACXA,EAAMgP,SAASzF,MAGfA,KAAKyF,SAAShP,IAM9B,QADEuJ,KAAKuI,cACAvI,KAEX,iBAAiBjJ,EAAKkP,EAAU8C,GAAe,GAC3CC,GAAYjS,GACZ,MAAM2R,EAAY1I,KAAK0I,UACjB7L,EAAS6L,EAAUrS,IAAIU,GAgB7B,OAfc,MAAV8F,GACA6L,EAAU3P,IAAIhC,EAAKkP,GA1H/B,SAAuBlP,GACnB,MAAsB,iBAARA,GAAoBA,EAAIkS,QAAQ,KAAO,EA0HzCC,CAAcnS,KACdiJ,KAAK2I,kBAAkB5R,GAAOkP,IAG7BpJ,aAAkB,IAAgC,IAApBA,EAAO4G,SAC1C5G,EAAO6G,MAAM7D,KAAKoG,GAGlByC,EAAU3P,IAAIhC,EAAK,IAAI,GAASA,EAAK,EAAe,CAAC8F,EAAQoJ,KAE7D8C,GACA/I,KAAKwI,oBAAoB5M,IAAIqK,GAE1BA,EAEX,oBAAoBlP,EAAK4Q,GACrB,MAAM1B,EAAWjG,KAAKmH,YAAYpQ,GAClC,GAAgB,MAAZkP,EACA,OAAO,EAEX,GAAIA,EAASc,WAAY,CACrB,MAAMD,EAAUb,EAASc,WAAW/G,MACpC,OAAe,MAAX8G,GAOGA,EAAQqC,oBAAoBxB,GAEvC,OAAO,EAEX,YAAY5Q,EAAKqS,GAAe,GAE5B,GADAJ,GAAYjS,QACQ,IAAhBA,EAAIoP,QACJ,OAAOpP,EAEX,IACIkP,EADA2C,EAAU5I,KAEd,KAAkB,MAAX4I,GAAiB,CAEpB,GADA3C,EAAW2C,EAAQF,UAAUrS,IAAIU,GACjB,MAAZkP,EAQA,OAAOA,EAPP,GAAsB,MAAlB2C,EAAQ7N,OAAgB,CACxB,MAAMqL,EAAUpG,KAAKqE,OAAON,kBAAoB6E,EAAU5I,KAC1D,OAAOoJ,EAAepJ,KAAKqJ,YAAYtS,EAAKqP,GAAW,KAE3DwC,EAAUA,EAAQ7N,OAM1B,OAAO,KAEX,IAAIhE,EAAKuS,GAAkB,GACvB,QAAOtJ,KAAK0I,UAAUvP,IAAIpC,OAEpBuS,GAAkC,MAAftJ,KAAKjF,SACpBiF,KAAKjF,OAAO5B,IAAIpC,GAAK,GAGnC,IAAIA,GAEA,GADAiS,GAAYjS,GACRA,EAAImP,YACJ,OAAOnP,EAAIoP,QAAQnG,KAAMA,MAE7B,IACIiG,EADA2C,EAAU5I,KAEd,KAAkB,MAAX4I,GAAiB,CAEpB,GADA3C,EAAW2C,EAAQF,UAAUrS,IAAIU,GACjB,MAAZkP,EASA,OAAOA,EAASE,QAAQyC,EAAS5I,MARjC,GAAsB,MAAlB4I,EAAQ7N,OAAgB,CACxB,MAAMqL,EAAUpG,KAAKqE,OAAON,kBAAoB6E,EAAU5I,KAE1D,OADAiG,EAAWjG,KAAKqJ,YAAYtS,EAAKqP,GAC1BH,EAASE,QAAQyC,EAAS5I,MAErC4I,EAAUA,EAAQ7N,OAM1B,MAAM,IAAI0F,MAAM,0BAA0B1J,KAE9C,OAAOA,GACHiS,GAAYjS,GACZ,IACIkP,EADA2C,EAAU5I,KAEd,KAAkB,MAAX4I,GAAiB,CAEpB,GADA3C,EAAW2C,EAAQF,UAAUrS,IAAIU,GACjB,MAAZkP,EAOA,OAAOsD,GAAiBtD,EAAU2C,EAAS5I,MAN3C,GAAmB,MAAfA,KAAKjF,OACL,OAAO,IAASqE,WAEpBwJ,EAAUA,EAAQ7N,OAM1B,OAAO,IAASqE,WAEpB,WAAW2B,GACP,IAAI+F,EAAU7K,EAASG,OAAOkM,GAAsBvH,GAKpD,YAJgB,IAAZ+F,IACA7K,EAASC,OAAOoM,GAAsBxB,EAAUc,GAAc7G,GAAOA,GACrE4B,EAASN,WAAWmC,SAASzD,EAAMuH,KAEhCxB,EAEX,gBAAgB/P,EAAK+P,GACjBnE,EAASN,WAAWtJ,IAAIhC,EAtMb,aAsM8B+P,GACzCnE,EAASN,WAAWmC,SAASzN,EAAKuR,IAEtC,YAAYjE,GACR,OAAO,IAAI,GAAUrE,KAAMqE,QAAuCA,EAASrE,KAAKqE,QAEpF,mBACI,IAAImF,EACJ,MAAMC,EAActP,MAAMuP,KAAK1J,KAAKwI,qBACpC,KAAOiB,EAAYnP,OAAS,GACK,QAA5BkP,EAAKC,EAAYE,aAA0B,IAAPH,GAAyBA,EAAGI,UAGzE,YAAYC,EAAYzD,GACpB,GAA0B,mBAAfyD,EACP,MAAM,IAAIpJ,MAAM,kEAAkEoJ,iDAEtF,GAAIxB,GAAoBlP,IAAI0Q,EAAW9T,MACnC,MAAM,IAAI0K,MAAM,+CAA+CoJ,EAAW9T,4CAE9E,GAAIqS,GAAWyB,GAAa,CACxB,MAAMC,EAAuBD,EAAWpE,SAASW,EAASyD,GAC1D,KAAMC,aAAgC5T,SAA2C,MAAhC4T,EAAqB3D,QAAiB,CACnF,MAAM4D,EAAc3D,EAAQsC,UAAUrS,IAAIwT,GAC1C,GAAmB,MAAfE,EACA,OAAOA,EAEX,MAAMxI,EAASI,MAAM,IAEzB,OAAOmI,EAEN,GAAInH,EAASD,SAASvJ,IAAI0Q,GAAa,CACxC,MAAMf,EAAOnG,EAASD,SAAS4D,OAAOuD,GACtC,GAAoB,IAAhBf,EAAKxO,OAELwO,EAAK,GAAGrD,SAASW,OAEhB,CACD,MAAMvI,EAAMiL,EAAKxO,OACjB,IAAK,IAAIxE,EAAI,EAAGA,EAAI+H,IAAO/H,EACvBgT,EAAKhT,GAAG2P,SAASW,GAGzB,MAAM2D,EAAc3D,EAAQsC,UAAUrS,IAAIwT,GAC1C,GAAmB,MAAfE,EACA,OAAOA,EAEX,MAAMxI,EAASI,MAAM,IAEpB,GAAIkI,EAAWxE,aAChB,MAAM,IAAI5E,MAAM,0CAA0CoJ,EAAW7E,gBAEpE,CACD,MAAMiB,EAAWjG,KAAKqE,OAAOL,gBAAgB6F,EAAYzD,GAEzD,OADAA,EAAQsC,UAAU3P,IAAI8Q,EAAY5D,GAC3BA,IASZ,MAAM+D,GACT,YAAYjT,EAAK2K,GACb1B,KAAKjJ,IAAMA,EACXiJ,KAAK0B,OAASA,EAElB,SAAS2B,GACL,GAAIA,EAAUlK,IAAI6G,KAAKjJ,KAAK,GAAO,CACdsM,EAAUhN,IAAI2J,KAAKjJ,KAC3B0O,SAASpC,KAAcrD,KAAK0B,aAGrC2B,EAAUoC,YAAYzF,KAAK0B,OAAOuI,OAAOC,GAAkB,iBAANA,KAIjE,MAAM3L,GAAQ,IAAI5G,QAClB,SAAS4L,GAAoB4G,GACzB,OAAO,SAAU/D,EAASC,EAAWJ,GACjC,GAAI1H,GAAMpF,IAAI8M,GACV,OAAO1H,GAAMlI,IAAI4P,GAErB,MAAMvP,EAAIyT,EAAI/D,EAASC,EAAWJ,GAElC,OADA1H,GAAMxF,IAAIkN,EAAUvP,GACbA,GAaR,MAAMkP,GAAe,CAWxBa,SAAQ,CAAC1P,EAAKN,IACH,IAAI,GAASM,EAAK,EAAkBN,GAY/CwN,UAAS,CAAClN,EAAKN,IACJ,IAAI,GAASM,EAAK,EAAmBN,GAYhDyN,UAAS,CAACnN,EAAKN,IACJ,IAAI,GAASM,EAAK,EAAmBN,GAahD+H,SAAQ,CAACzH,EAAKyH,IACH,IAAI,GAASzH,EAAK,EAAkByH,GAgB/C4L,eAAc,CAACrT,EAAKyH,IACT,IAAI,GAASzH,EAAK,EAAkBwM,GAAoB/E,IAenE6L,QAAO,CAACC,EAAaC,IACV,IAAI,GAASA,EAAU,EAAeD,GAOjDE,MAAK,CAACzT,KAAQ2K,IACH,IAAIsI,GAAsBjT,EAAK2K,IAGvC,MAAM,GACT,cACI1B,KAAKyG,SAAW,KAEpB,QAAQA,GACJzG,KAAKyG,SAAWA,EAEpB,kBAAoB,OAAO,EAC3B,UACI,QAAsBtB,IAAlBnF,KAAKyG,SACL,MAAMlF,EAASI,MAAM,IAEzB,OAAO3B,KAAKyG,SAEhB,UACIzG,KAAKyG,SAAW,MAIjB,SAASuC,GAAYjS,GACxB,GAAIA,QACA,MAAMwK,EAASI,MAAM,GAG7B,SAAS4H,GAAiBtD,EAAUG,EAASC,GACzC,GAAIJ,aAAoB,IAAkC,IAAtBA,EAASxC,SAA4B,CACrE,MAAMC,EAAQuC,EAASvC,MACvB,IAAIlO,EAAIkO,EAAMpJ,OACd,MAAMmQ,EAAU,IAAItQ,MAAM3E,GAC1B,KAAOA,KACHiV,EAAQjV,GAAKkO,EAAMlO,GAAG2Q,QAAQC,EAASC,GAE3C,OAAOoE,EAEX,MAAO,CAACxE,EAASE,QAAQC,EAASC,ICziCtC,IAmBWqE,GAnBPC,GAA0C,SAAU1Q,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5DyU,GAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtGC,GAAoC,SAAUC,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,MAU3D,SAAWR,GAIPA,EAAaA,EAAuB,SAAI,GAAK,WAI7CA,EAAaA,EAAqB,OAAI,GAAK,SAR/C,CASGA,KAAiBA,GAAe,KAC5B,MAAMS,GAAahH,GAAG2B,gBAAgB,cAAcP,YAAY2E,GAAKA,EAAEzD,SAAS,IAAI2E,GAAU,EAAkB,KAC1GC,GAAQlH,GAAG2B,gBAAgB,SAASR,YACpCgG,GAAmBnH,GAAG2B,gBAAgB,oBAAoBP,YAAY2E,GAAKA,EAAEjG,UAAUsH,KAEvFC,IADUrH,GAAG2B,gBAAgB,WAAWP,YAAY2E,GAAKA,EAAEjG,UAAUwH,KACxDtH,GAAG2B,gBAAgB,aAAaR,aAC7CoG,GAAaxV,OAAOyV,OAAO,CACpC5U,IAAK4L,EAASN,WAAWE,OAAO,uBAChC,OAAOzI,EAAQ8R,GAEX,OADA3P,EAASC,OAAO8D,KAAKjJ,IAAK6U,EAAWC,QAAS/R,EAAO1C,WAC9C0C,GAEX,WAAWA,GACP,OAAOmC,EAAS5F,IAAI2J,KAAKjJ,IAAK+C,MAS/B,MAAMgS,GAAS9K,EAAS,CAC3B+K,IAAIC,GACO,QAAaA,SAExBC,MAAMD,GACK,QAAaA,SAExBE,OAAOF,GACI,QAAaA,SAExBG,KAAKH,GACM,QAAaA,SAExBI,QAAQJ,GACG,QAAaA,SAExBK,KAAKL,GACM,QAAaA,SAExBM,MAAMN,GACK,QAAaA,SAExBO,KAAKP,GACM,QAAaA,WAGrB,MAAMZ,GACT,YAAYoB,EAAchL,GACtBxB,KAAKwM,aAAeA,EACpBxM,KAAKwB,MAAQA,GAGrB,MAAMiL,GAAoB,WACtB,MAAMC,EAAiB,CACnB1L,EAAS,CACL2L,IAAK,MACLC,IAAK,MACLC,IAAK,MACLC,IAAK,MACLC,IAAK,MACLC,IAAK,MACLC,IAAK,QAETjM,EAAS,CACL2L,IAAKb,GAAOS,KAAK,OACjBK,IAAKd,GAAOS,KAAK,OACjBM,IAAKf,GAAOQ,MAAM,OAClBQ,IAAKhB,GAAOI,OAAO,OACnBa,IAAKjB,GAAOC,IAAI,OAChBiB,IAAKlB,GAAOC,IAAI,OAChBkB,IAAKnB,GAAOS,KAAK,UAGzB,OAAO,SAAU/K,EAAOgL,GACpB,OAAIhL,GAAS,EACFkL,EAAeF,GAAcG,IAEpCnL,GAAS,EACFkL,EAAeF,GAAcI,IAEpCpL,GAAS,EACFkL,EAAeF,GAAcK,IAEpCrL,GAAS,EACFkL,EAAeF,GAAcM,IAEpCtL,GAAS,EACFkL,EAAeF,GAAcO,IAEpCvL,GAAS,EACFkL,EAAeF,GAAcQ,IAEjCN,EAAeF,GAAcS,KAxClB,GAkD1B,SAASC,GAAaC,EAAWX,GAC7B,OAAqB,IAAjBA,EACO,IAAItP,KAAKiQ,GAAWC,cAExBtB,GAAOS,KAAK,IAAIrP,KAAKiQ,GAAWC,eAEpC,MAAMC,GACT,YAAYC,EAAUC,EAASC,EAAgBC,EAAOjB,EAAcW,GAChEnN,KAAKsN,SAAWA,EAChBtN,KAAKuN,QAAUA,EACfvN,KAAKwN,eAAiBA,EACtBxN,KAAKyN,MAAQA,EACbzN,KAAKwM,aAAeA,EACpBxM,KAAKmN,UAAYA,EAErB,WACI,MAAM,SAAEG,EAAQ,QAAEC,EAAO,MAAEE,EAAK,aAAEjB,EAAY,UAAEW,GAAcnN,KAC9D,OAAqB,IAAjByN,EAAMnT,OACC,GAAG4S,GAAaC,EAAWX,OAAkBC,GAAkBa,EAAUd,OAAkBe,IAE/F,GAAGL,GAAaC,EAAWX,OAAkBC,GAAkBa,EAAUd,MA3BxF,SAAwBiB,EAAOjB,GAC3B,OAAqB,IAAjBA,EACOiB,EAAMpV,KAAK,KAGfoV,EAAMtV,IAAI2T,GAAOO,MAAMhU,KAAK,KAsBkEqV,CAAeD,EAAOjB,OAAkBe,KAGjJ,IAAIhC,GAAyB,MACzB,YAAYlH,GACRrE,KAAKqE,OAASA,EAElB,eAAesJ,EAAQnM,EAAO+L,EAASC,GACnC,OAAO,IAAIH,GAAgB7L,EAAO+L,EAASC,EAAgBG,EAAOF,MAAOzN,KAAKqE,OAAOmI,aAActP,KAAK0Q,SAGhHrC,GAAyBZ,GAAW,CAChCM,GAAQ,EAAGE,IACXJ,GAAW,oBAAqB,CAAC7U,UAClCqV,IAEI,MAAMsC,GACT,YAAYC,GACR9N,KAAK+N,YAAc,SAAcC,GAC7B,MAAMR,EAAiBQ,EAAMR,eAC7B,QAAuB,IAAnBA,GAAuD,IAA1BA,EAAelT,OAC5C,OAAQ0T,EAAMV,UACV,KAAK,EACL,KAAK,EACD,OAAOQ,EAASG,MAAMD,EAAM1V,YAChC,KAAK,EACD,OAAOwV,EAASI,KAAKF,EAAM1V,YAC/B,KAAK,EACD,OAAOwV,EAASK,KAAKH,EAAM1V,YAC/B,KAAK,EACL,KAAK,EACD,OAAOwV,EAASnM,MAAMqM,EAAM1V,iBAIpC,OAAQ0V,EAAMV,UACV,KAAK,EACL,KAAK,EACD,OAAOQ,EAASG,MAAMD,EAAM1V,cAAekV,GAC/C,KAAK,EACD,OAAOM,EAASI,KAAKF,EAAM1V,cAAekV,GAC9C,KAAK,EACD,OAAOM,EAASK,KAAKH,EAAM1V,cAAekV,GAC9C,KAAK,EACL,KAAK,EACD,OAAOM,EAASnM,MAAMqM,EAAM1V,cAAekV,MAMnE,IAAI/B,GAAgB,MAAMA,EACtB,YAAYpH,EAAQyC,EAASsH,EAAOX,EAAQ,GAAI1S,EAAS,MACrD,IAAIyO,EAAI6E,EAAIC,EAAIC,EAAIC,EAAIC,EAKxB,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACJ,GAVA/O,KAAKqE,OAASA,EACdrE,KAAK8G,QAAUA,EACf9G,KAAKyN,MAAQA,EACbzN,KAAKgP,cAAgB9Y,OAAOY,OAAO,MAOpB,OAAXiE,EAAiB,CACjBiF,KAAKyI,KAAOzI,KACZA,KAAKjF,OAASiF,KACd0O,EAAa1O,KAAK0O,WAAa,GAC/BC,EAAa3O,KAAK2O,WAAa,GAC/BC,EAAY5O,KAAK4O,UAAY,GAC7BC,EAAY7O,KAAK6O,UAAY,GAC7BC,EAAa9O,KAAK8O,WAAa,GAC/BC,EAAa/O,KAAK+O,WAAa,GAC/B,IAAK,MAAME,KAASb,EAAO,CACvB,MAAMvC,EAAUH,GAAWwD,WAAWD,IAC2D,QAA5FzF,EAAKqC,aAAyC,EAASA,EAAQsD,SAAS,UAAmC,IAAP3F,GAAgBA,IACrHkF,EAAW7O,KAAKoP,IAE6E,QAA5FZ,EAAKxC,aAAyC,EAASA,EAAQsD,SAAS,UAAmC,IAAPd,GAAgBA,IACrHM,EAAW9O,KAAKoP,IAE4E,QAA3FX,EAAKzC,aAAyC,EAASA,EAAQsD,SAAS,UAAkC,IAAPb,GAAgBA,IACpHM,EAAU/O,KAAKoP,IAE6E,QAA3FV,EAAK1C,aAAyC,EAASA,EAAQsD,SAAS,UAAkC,IAAPZ,GAAgBA,IACpHM,EAAUhP,KAAKoP,IAE8E,QAA5FT,EAAK3C,aAAyC,EAASA,EAAQsD,SAAS,UAAmC,IAAPX,GAAgBA,IACrHM,EAAWjP,KAAKoP,IAE6E,QAA5FR,EAAK5C,aAAyC,EAASA,EAAQsD,SAAS,UAAmC,IAAPV,GAAgBA,IACrHM,EAAWlP,KAAKoP,SAKxBjP,KAAKyI,KAAO1N,EAAO0N,KACnBzI,KAAKjF,OAASA,EACd2T,EAAa1O,KAAK0O,WAAa3T,EAAO2T,WACtCC,EAAa3O,KAAK2O,WAAa5T,EAAO4T,WACtCC,EAAY5O,KAAK4O,UAAY7T,EAAO6T,UACpCC,EAAY7O,KAAK6O,UAAY9T,EAAO8T,UACpCC,EAAa9O,KAAK8O,WAAa/T,EAAO+T,WACtCC,EAAa/O,KAAK+O,WAAahU,EAAOgU,WAE1C,MAAMK,EAAO,CAACC,EAAQ7N,EAAO8N,EAAa9B,KACtC,MAAMD,EAAiC,mBAAhB+B,EAA6BA,IAAgBA,EAC9DtB,EAAQlH,EAAQyI,eAAevP,KAAMwB,EAAO+L,EAASC,GAC3D,IAAK,IAAIhY,EAAI,EAAGkS,EAAK2H,EAAO/U,OAAQ9E,EAAIkS,IAAMlS,EAC1C6Z,EAAO7Z,GAAGuY,YAAYC,IAG9BhO,KAAKwP,MAAQ,SAAeC,KAAwBjC,GAC5CnJ,EAAO7C,OAAS,GAChB4N,EAAKV,EAAY,EAAee,EAAqBjC,IAG7DxN,KAAKiO,MAAQ,SAAewB,KAAwBjC,GAC5CnJ,EAAO7C,OAAS,GAChB4N,EAAKT,EAAY,EAAec,EAAqBjC,IAG7DxN,KAAKkO,KAAO,SAAcuB,KAAwBjC,GAC1CnJ,EAAO7C,OAAS,GAChB4N,EAAKR,EAAW,EAAca,EAAqBjC,IAG3DxN,KAAKmO,KAAO,SAAcsB,KAAwBjC,GAC1CnJ,EAAO7C,OAAS,GAChB4N,EAAKP,EAAW,EAAcY,EAAqBjC,IAG3DxN,KAAK2B,MAAQ,SAAe8N,KAAwBjC,GAC5CnJ,EAAO7C,OAAS,GAChB4N,EAAKN,EAAY,EAAeW,EAAqBjC,IAG7DxN,KAAK0P,MAAQ,SAAeD,KAAwBjC,GAC5CnJ,EAAO7C,OAAS,GAChB4N,EAAKL,EAAY,EAAeU,EAAqBjC,IAIjE,QAAQzX,GACJ,MAAMiZ,EAAgBhP,KAAKgP,cAC3B,IAAIW,EAAeX,EAAcjZ,GAIjC,YAHqB,IAAjB4Z,IACAA,EAAeX,EAAcjZ,GAAQ,IAAI0V,EAAczL,KAAKqE,OAAQrE,KAAK8G,aAAS,EAAU9G,KAAKyN,MAAM3F,OAAO/R,GAAOiK,OAElH2P,IAGflE,GAAgBd,GAAW,CACvBM,GAAQ,EAAGE,IACXF,GAAQ,EAAGK,IACXL,GAAQ,EAAG,GAAII,KACfJ,GAAQ,EAAG1E,GAASiF,KACpBP,GAAQ,EAAGzE,IACXuE,GAAW,oBAAqB,CAAC7U,OAAQA,OAAQiE,MAAOA,MAAOjE,UAChEuV,IA6BgCzK,EAAS,CAMxClK,OAAM,EAAC,SAAEgX,EAAQ,MAAEtM,EAAQ,EAAY,aAAEgL,EAAe,EAAgB,MAAE4B,EAAQ,IAAQ,KAC/EpN,EAAS,CACZ,SAASqC,GACLA,EAAUoC,SAASG,GAAaa,SAAS0E,GAAY,IAAIC,GAAUoB,EAAchL,KAC7EsM,SACAzK,EAAUoC,SAASG,GAAaa,SAAS4E,GAAO,IAAIwC,GAAYC,KAEpE,IAAK,MAAMmB,KAASb,EAChB/K,EAAUoC,SAASG,GAAa3B,UAAUoH,GAAO4D,IAErD,OAAO5L,OCpWhB,MAAMuM,GAAW,WACpB,MAAMhC,EAAM,IAASA,IACfiC,EAAS,GACf,IAAIC,EACJ,MAAMC,EAAW,CACbC,YAOJ,SAAqBja,GACjB8Z,EAAOhQ,KAAK9J,GACZ,IAAIka,EAAQ,EACRC,EAAO,EACX,MAAO,CACHC,MAGJ,WACoB,KAAVF,IACFC,EAAOtC,MACLkC,EAAW/Z,GAAMqa,iBAErBN,EAAW/Z,GAAMsa,YAPnBC,MASJ,WACoB,KAAVL,IACFH,EAAW/Z,GAAMwa,UAAa3C,IAAQsC,MAvB9CM,OA2BJ,WACIV,EAAa,GACb,IAAK,MAAMW,KAASZ,EAChBC,EAAWW,GAAS,CAChB1a,KAAM0a,EACNF,SAAU,EACVH,cAAe,EACfC,WAAY,GAGpBN,EAASlO,SAAU,GApCnB6O,QAsCJ,WACIX,EAASlO,SAAU,GAtCnB8O,OAwCJ,SAAgB/S,GACZ1H,OAAOsD,KAAKsW,GAAY3X,IAAIpB,GAAO+Y,EAAW/Y,IAAM6Z,KAAK,CAAC1R,EAAGC,IAAMA,EAAEoR,SAAWrR,EAAEqR,UAAUM,QAAQvZ,IAChGsG,EAAGtG,EAAEvB,KAAMuB,EAAEiZ,SAAUjZ,EAAE8Y,cAAe9Y,EAAE+Y,eAzC9CxO,SAAS,GAEb,OAAOkO,EAXa,GCIxB,MAAMe,GACF,YAEAC,EAEAvS,GACIwB,KAAK+Q,YAAcA,EACnB/Q,KAAKxB,SAAWA,EAEpB,OAAO+O,GACCA,aAAmBvN,KAAK+Q,aACxB/Q,KAAKxB,SAAS7I,KAAK,KAAM4X,IAIrC,SAASyD,GAAexS,EAAUyS,EAAMjD,GACpC,IACIxP,EAASyS,EAAMjD,GAEnB,MAAOkD,GACH3P,EAASI,MAAM,EAAGuP,IAG1B,SAASC,GAAc/K,EAAS6K,GAC5B,IACI7K,EAAQgL,OAAOH,GAEnB,MAAOC,GACH3P,EAASI,MAAM,EAAGuP,IAGM/M,GAAG2B,gBAAgB,oBAAoBP,YAAY2E,GAAKA,EAAEjG,UAAU,KAI7F,MAAM,GACT,cAEIjE,KAAKqR,YAAc,GAEnBrR,KAAKsR,gBAAkB,GAE3B,QAAQC,EAAmBN,GACvB,IAAIO,EACAhc,EACJ,IAAK+b,EACD,MAAMhQ,EAASI,MAAM,GAEzB,GAAiC,iBAAtB4P,EAAgC,CACvC,MAAME,EAAUF,EAEhB,GADAC,EAAcxR,KAAKqR,YAAYI,GACZ,MAAfD,EAGA,IAFAA,EAAcA,EAAY9S,QAC1BlJ,EAAIgc,EAAYlX,OACT9E,KACHwb,GAAeQ,EAAYhc,GAAIyb,EAAMQ,OAI5C,CACD,MAAMhL,EAAW8K,EAGjB,IAFAC,EAAcxR,KAAKsR,gBAAgB5S,QACnClJ,EAAIgc,EAAYlX,OACT9E,KACH2b,GAAcK,EAAYhc,GAAIiR,IAI1C,UAAUiL,EAAelT,GACrB,IAAI4H,EACAoL,EACJ,IAAKE,EACD,MAAMnQ,EAASI,MAAM,GAEzB,GAA6B,iBAAlB+P,EAA4B,CACnC,MAAMD,EAAUC,EAChBtL,EAAU5H,OACwB,IAA9BwB,KAAKqR,YAAYI,KACjBzR,KAAKqR,YAAYI,GAAW,IAEhCD,EAAcxR,KAAKqR,YAAYI,QAG/BrL,EAAU,IAAI0K,GAAQY,EAAelT,GACrCgT,EAAcxR,KAAKsR,gBAGvB,OADAE,EAAY3R,KAAKuG,GACV,CACH,UACI,MAAMuL,EAAMH,EAAYvI,QAAQ7C,IACnB,IAATuL,GACAH,EAAYI,OAAOD,EAAK,KAKxC,cAAcD,EAAelT,GACzB,MAAMqT,EAAM7R,KAAK8R,UAAUJ,EAAe,CAACT,EAAMjD,KAC7C6D,EAAIjI,UACGpL,EAASyS,EAAMjD,KAE1B,OAAO6D,GC1Gf,2iC,wCCCO,SAASE,IAEZ,OAAO,SAAUjY,GACb,MAAM+G,EAAQ/G,EAAO1C,UACrByJ,EAAMmR,iBAAmB,EACzBnR,EAAMoR,cAAgBA,EACtBpR,EAAMqR,iBAAmBA,EACzBrR,EAAMsR,cAAgBA,EACtBtR,EAAMuR,eAAiBA,EACvBvR,EAAMwR,gBAAkBA,OACA,IAApBxR,EAAMiR,YACNjR,EAAMiR,UAAYG,QACI,IAAtBpR,EAAMyR,cACNzR,EAAMyR,YAAcJ,IAmBzB,SAASK,IAEZ,OAAO,SAAUzY,GACb,MAAM+G,EAAQ/G,EAAO1C,UACrByJ,EAAM2R,2BAA6B,EACnC3R,EAAM4R,wBAA0BA,EAChC5R,EAAM6R,2BAA6BA,EACnC7R,EAAM8R,wBAA0BA,EAChC9R,EAAM+R,yBAA2BA,EACjC/R,EAAMgS,0BAA4BA,OACE,IAAhChS,EAAMiS,wBACNjS,EAAMiS,sBAAwBL,QACM,IAApC5R,EAAMkS,4BACNlS,EAAMkS,0BAA4BL,IAG9C,SAAST,EAAce,GACnB,GAAIhT,KAAKmS,cAAca,GACnB,OAAO,EAEX,MAAMC,EAAkBjT,KAAKgS,iBAqB7B,OApBgD,IAAzB,EAAlBiB,IACDjT,KAAKkT,aAAeF,EACpBhT,KAAKgS,kBAAoB,GAEwB,IAAzB,EAAlBiB,IACNjT,KAAKmT,aAAeH,EACpBhT,KAAKgS,kBAAoB,GAEwB,IAAzB,EAAlBiB,IACNjT,KAAKoT,aAAeJ,EACpBhT,KAAKgS,kBAAoB,GAE4B,IAA7B,EAAlBiB,IACNjT,KAAKqT,iBAAmB,CAACL,GACzBhT,KAAKgS,kBAAoB,GAIzBhS,KAAKqT,iBAAiBxT,KAAKmT,IAExB,EAEX,SAASM,EAAmBN,GACxB,GAAIhT,KAAKuT,mBAAmBP,GACxB,OAAO,EAEX,MAAMC,EAAkBjT,KAAKwT,sBAqB7B,OApBgD,IAAzB,EAAlBP,IACDjT,KAAKyT,kBAAoBT,EACzBhT,KAAKwT,uBAAyB,GAEmB,IAAzB,EAAlBP,IACNjT,KAAK0T,kBAAoBV,EACzBhT,KAAKwT,uBAAyB,GAEmB,IAAzB,EAAlBP,IACNjT,KAAK2T,kBAAoBX,EACzBhT,KAAKwT,uBAAyB,GAEuB,IAA7B,EAAlBP,IACNjT,KAAK4T,sBAAwB,CAACZ,GAC9BhT,KAAKwT,uBAAyB,GAI9BxT,KAAK4T,sBAAsB/T,KAAKmT,IAE7B,EAEX,SAASP,EAAwBO,GAC7B,GAAIhT,KAAK2S,wBAAwBK,GAC7B,OAAO,EAEX,MAAMC,EAAkBjT,KAAKwS,2BAqB7B,OApBgD,IAAzB,EAAlBS,IACDjT,KAAK6T,uBAAyBb,EAC9BhT,KAAKwS,4BAA8B,GAEc,IAAzB,EAAlBS,IACNjT,KAAK8T,uBAAyBd,EAC9BhT,KAAKwS,4BAA8B,GAEc,IAAzB,EAAlBS,IACNjT,KAAK+T,uBAAyBf,EAC9BhT,KAAKwS,4BAA8B,GAEkB,IAA7B,EAAlBS,IACNjT,KAAKgU,2BAA6B,CAAChB,GACnChT,KAAKwS,4BAA8B,GAInCxS,KAAKgU,2BAA2BnU,KAAKmT,IAElC,EAEX,SAASd,EAAiBc,GACtB,MAAMC,EAAkBjT,KAAKgS,iBAC7B,IAAuB,EAAlBiB,GAAyC,GAAKjT,KAAKkT,eAAiBF,EAGrE,OAFAhT,KAAKkT,kBAAe,EACpBlT,KAAKgS,iBAAmE,GAAvB,EAAxBhS,KAAKgS,mBACvB,EAEN,IAAuB,EAAlBiB,GAAyC,GAAKjT,KAAKmT,eAAiBH,EAG1E,OAFAhT,KAAKmT,kBAAe,EACpBnT,KAAKgS,iBAAmE,GAAvB,EAAxBhS,KAAKgS,mBACvB,EAEN,IAAuB,EAAlBiB,GAAyC,GAAKjT,KAAKoT,eAAiBJ,EAG1E,OAFAhT,KAAKoT,kBAAe,EACpBpT,KAAKgS,iBAAmE,GAAvB,EAAxBhS,KAAKgS,mBACvB,EAEN,IAAuB,EAAlBiB,GAA6C,EAAG,CAEtD,MAAMzB,EAAcxR,KAAKqT,iBACzB,IAAK,IAAI7d,EAAI,EAAGkS,EAAK8J,EAAYlX,OAAQ9E,EAAIkS,IAAMlS,EAC/C,GAAIgc,EAAYhc,KAAOwd,EAKnB,OAJAxB,EAAYI,OAAOpc,EAAG,GACX,IAAPkS,IACA1H,KAAKgS,iBAAuE,GAA3B,EAAxBhS,KAAKgS,oBAE3B,EAInB,OAAO,EAEX,SAASiC,EAAsBjB,GAC3B,MAAMC,EAAkBjT,KAAKwT,sBAC7B,IAAuB,EAAlBP,GAAyC,GAAKjT,KAAKyT,oBAAsBT,EAG1E,OAFAhT,KAAKyT,uBAAoB,EACzBzT,KAAKwT,sBAA6E,GAAvB,EAA7BxT,KAAKwT,wBAC5B,EAEN,IAAuB,EAAlBP,GAAyC,GAAKjT,KAAK0T,oBAAsBV,EAG/E,OAFAhT,KAAK0T,uBAAoB,EACzB1T,KAAKwT,sBAA6E,GAAvB,EAA7BxT,KAAKwT,wBAC5B,EAEN,IAAuB,EAAlBP,GAAyC,GAAKjT,KAAK2T,oBAAsBX,EAG/E,OAFAhT,KAAK2T,uBAAoB,EACzB3T,KAAKwT,sBAA6E,GAAvB,EAA7BxT,KAAKwT,wBAC5B,EAEN,IAAuB,EAAlBP,GAA6C,EAAG,CAEtD,MAAMzB,EAAcxR,KAAK4T,sBACzB,IAAK,IAAIpe,EAAI,EAAGkS,EAAK8J,EAAYlX,OAAQ9E,EAAIkS,IAAMlS,EAC/C,GAAIgc,EAAYhc,KAAOwd,EAKnB,OAJAxB,EAAYI,OAAOpc,EAAG,GACX,IAAPkS,IACA1H,KAAKwT,sBAAiF,GAA3B,EAA7BxT,KAAKwT,yBAEhC,EAInB,OAAO,EAEX,SAASd,EAA2BM,GAChC,MAAMC,EAAkBjT,KAAKwS,2BAC7B,IAAuB,EAAlBS,GAAyC,GAAKjT,KAAK6T,yBAA2Bb,EAG/E,OAFAhT,KAAK6T,4BAAyB,EAC9B7T,KAAKwS,2BAAuF,GAAvB,EAAlCxS,KAAKwS,6BACjC,EAEN,IAAuB,EAAlBS,GAAyC,GAAKjT,KAAK8T,yBAA2Bd,EAGpF,OAFAhT,KAAK8T,4BAAyB,EAC9B9T,KAAKwS,2BAAuF,GAAvB,EAAlCxS,KAAKwS,6BACjC,EAEN,IAAuB,EAAlBS,GAAyC,GAAKjT,KAAK+T,yBAA2Bf,EAGpF,OAFAhT,KAAK+T,4BAAyB,EAC9B/T,KAAKwS,2BAAuF,GAAvB,EAAlCxS,KAAKwS,6BACjC,EAEN,IAAuB,EAAlBS,GAA6C,EAAG,CAEtD,MAAMzB,EAAcxR,KAAKgU,2BACzB,IAAK,IAAIxe,EAAI,EAAGkS,EAAK8J,EAAYlX,OAAQ9E,EAAIkS,IAAMlS,EAC/C,GAAIgc,EAAYhc,KAAOwd,EAKnB,OAJAxB,EAAYI,OAAOpc,EAAG,GACX,IAAPkS,IACA1H,KAAKwS,2BAA2F,GAA3B,EAAlCxS,KAAKwS,8BAErC,EAInB,OAAO,EAEX,SAASJ,IACL,OAAiC,IAA1BpS,KAAKgS,iBAEhB,SAASkC,IACL,OAAsC,IAA/BlU,KAAKwT,sBAEhB,SAASZ,IACL,OAA2C,IAApC5S,KAAKwS,2BAEhB,SAASL,EAAca,GAInB,MAAMC,EAAkBjT,KAAKgS,iBAC7B,IAAuB,EAAlBiB,GAAyC,GAAKjT,KAAKkT,eAAiBF,EACrE,OAAO,EAEX,IAAuB,EAAlBC,GAAyC,GAAKjT,KAAKmT,eAAiBH,EACrE,OAAO,EAEX,IAAuB,EAAlBC,GAAyC,GAAKjT,KAAKoT,eAAiBJ,EACrE,OAAO,EAEX,IAAuB,EAAlBC,GAA6C,EAAG,CAEjD,MAAMzB,EAAcxR,KAAKqT,iBACzB,IAAK,IAAI7d,EAAI,EAAGkS,EAAK8J,EAAYlX,OAAQ9E,EAAIkS,IAAMlS,EAC/C,GAAIgc,EAAYhc,KAAOwd,EACnB,OAAO,EAInB,OAAO,EAEX,SAASO,EAAmBP,GACxB,MAAMC,EAAkBjT,KAAKwT,sBAC7B,IAAuB,EAAlBP,GAAyC,GAAKjT,KAAKyT,oBAAsBT,EAC1E,OAAO,EAEX,IAAuB,EAAlBC,GAAyC,GAAKjT,KAAK0T,oBAAsBV,EAC1E,OAAO,EAEX,IAAuB,EAAlBC,GAAyC,GAAKjT,KAAK2T,oBAAsBX,EAC1E,OAAO,EAEX,IAAuB,EAAlBC,GAA6C,EAAG,CAEjD,MAAMzB,EAAcxR,KAAK4T,sBACzB,IAAK,IAAIpe,EAAI,EAAGkS,EAAK8J,EAAYlX,OAAQ9E,EAAIkS,IAAMlS,EAC/C,GAAIgc,EAAYhc,KAAOwd,EACnB,OAAO,EAInB,OAAO,EAEX,SAASL,EAAwBK,GAC7B,MAAMC,EAAkBjT,KAAKwS,2BAC7B,IAAuB,EAAlBS,GAAyC,GAAKjT,KAAK6T,yBAA2Bb,EAC/E,OAAO,EAEX,IAAuB,EAAlBC,GAAyC,GAAKjT,KAAK8T,yBAA2Bd,EAC/E,OAAO,EAEX,IAAuB,EAAlBC,GAAyC,GAAKjT,KAAK+T,yBAA2Bf,EAC/E,OAAO,EAEX,IAAuB,EAAlBC,GAA6C,EAAG,CAEjD,MAAMzB,EAAcxR,KAAKgU,2BACzB,IAAK,IAAIxe,EAAI,EAAGkS,EAAK8J,EAAYlX,OAAQ9E,EAAIkS,IAAMlS,EAC/C,GAAIgc,EAAYhc,KAAOwd,EACnB,OAAO,EAInB,OAAO,EAEX,SAASX,EAAgB8B,EAAUC,EAAeC,GAQ9C,MAAMC,EAActU,KAAKkT,aACnBqB,EAAcvU,KAAKmT,aACnBqB,EAAcxU,KAAKoT,aACzB,IAAI5B,EAAcxR,KAAKqT,iBAavB,QAZoB,IAAhB7B,IACAA,EAAcA,EAAY9S,cAEV,IAAhB4V,GACAG,EAAeH,EAAaH,EAAUC,EAAeC,OAA0B,IAAnBC,EAAYI,GAAgB,EAAI1U,KAAKsU,EAAYI,UAE7F,IAAhBH,GACAE,EAAeF,EAAaJ,EAAUC,EAAeC,OAA0B,IAAnBE,EAAYG,GAAgB,EAAI1U,KAAKuU,EAAYG,UAE7F,IAAhBF,GACAC,EAAeD,EAAaL,EAAUC,EAAeC,OAA0B,IAAnBG,EAAYE,GAAgB,EAAI1U,KAAKwU,EAAYE,UAE7F,IAAhBlD,EAAwB,CACxB,MAAM,OAAElX,GAAWkX,EACnB,IAAIwB,EACJ,IAAK,IAAIxd,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1Bwd,EAAaxB,EAAYhc,QACN,IAAfwd,GACAyB,EAAezB,EAAYmB,EAAUC,EAAeC,OAAyB,IAAlBrB,EAAW0B,GAAgB,EAAI1U,KAAKgT,EAAW0B,MAK1H,SAASD,EAAezB,EAAYmB,EAAUC,EAAeC,EAAOM,GAChE3B,EAAW4B,aAAaT,EAAUC,EAA4C,IAAnB,GAARC,GAA8CM,GAErG,SAASE,EAAqB9d,EAAKod,EAAUC,EAAeC,GACxD,MAAMC,EAActU,KAAKyT,kBACnBc,EAAcvU,KAAK0T,kBACnBc,EAAcxU,KAAK2T,kBACzB,IAAInC,EAAcxR,KAAK4T,sBAavB,QAZoB,IAAhBpC,IACAA,EAAcA,EAAY9S,cAEV,IAAhB4V,GACAA,EAAYQ,kBAAkB/d,EAAKod,EAAUC,EAAeC,QAE5C,IAAhBE,GACAA,EAAYO,kBAAkB/d,EAAKod,EAAUC,EAAeC,QAE5C,IAAhBG,GACAA,EAAYM,kBAAkB/d,EAAKod,EAAUC,EAAeC,QAE5C,IAAhB7C,EAAwB,CACxB,MAAM,OAAElX,GAAWkX,EACnB,IAAIwB,EACJ,IAAK,IAAIxd,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1Bwd,EAAaxB,EAAYhc,QACN,IAAfwd,GACAA,EAAW8B,kBAAkB/d,EAAKod,EAAUC,EAAeC,IAK3E,SAASxB,EAA0BkC,EAAUV,GACzC,MAAMC,EAActU,KAAK6T,uBACnBU,EAAcvU,KAAK8T,uBACnBU,EAAcxU,KAAK+T,uBACzB,IAAIvC,EAAcxR,KAAKgU,2BAavB,QAZoB,IAAhBxC,IACAA,EAAcA,EAAY9S,cAEV,IAAhB4V,GACAA,EAAYU,uBAAuBD,EAAUV,QAE7B,IAAhBE,GACAA,EAAYS,uBAAuBD,EAAUV,QAE7B,IAAhBG,GACAA,EAAYQ,uBAAuBD,EAAUV,QAE7B,IAAhB7C,EAAwB,CACxB,MAAM,OAAElX,GAAWkX,EACnB,IAAIwB,EACJ,IAAK,IAAIxd,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1Bwd,EAAaxB,EAAYhc,QACN,IAAfwd,GACAA,EAAWgC,uBAAuBD,EAAUV,ICzY5D,IASIY,EATAtK,EAA0C,SAAU1Q,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5DyU,EAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAK1G,MAAM,EAAS,IAAIrT,QACnB,IAAIud,EAA4B,MAC5B,YAAYC,EAAOC,EAAKre,GACpBiJ,KAAKmV,MAAQA,EACbnV,KAAKoV,IAAMA,EACXpV,KAAKjJ,IAAMA,EACXiJ,KAAKqV,SAAU,EACfrV,KAAK8R,UAAY9R,KAAKiS,cACtBjS,KAAKsS,YAActS,KAAKkS,iBACpBkD,EAAIre,aAAgBb,SACpBkf,EAAIre,GAAO,EAAcue,YAAYF,EAAIre,IAAMoe,OAGvD,SAAS1e,EAAO4d,GACZ,MAAMkB,EAAWvV,KAAKoV,IAAIpV,KAAKjJ,KAC3Bwe,IAAa9e,IACbuJ,KAAKoV,IAAIpV,KAAKjJ,KAAON,EACrBuJ,KAAKqS,gBAAgB5b,EAAO8e,EAAkB,GAARlB,IAG9C,WACI,OAAOrU,KAAKoV,IAAIpV,KAAKjJ,KAEzB,WAAWsd,MAIfa,EAA4BvK,EAAW,CACnCoH,IACAhH,EAAW,oBAAqB,CAAC7U,OAAQA,OAAQA,UAClDgf,GAEH,IAAI,EAAgBD,EAAkB,MAClC,YAAY1Y,GACRyD,KAAKoV,IAAM7Y,EACXyD,KAAKmV,MAAQ,IAAIK,MAAMjZ,EAAKyD,MAC5B,EAAOjH,IAAIwD,EAAKyD,KAAKmV,OACrBnV,KAAKwR,YAAc,GAEvB,sBAAsBjV,GAClB,QAAiB,IAAbA,EAAIkZ,KAAiB,CACrB,MAAMN,EAAQ,EAAO9e,IAAIkG,GACzB,YAAc,IAAV4Y,EACO5Y,EAEJ4Y,EAEX,OAAO5Y,EAEX,qBAAqBA,GACjB,MAAM6Y,EAAM7Y,EAAIkZ,KAChB,YAAY,IAARL,EACO7Y,EAEJ6Y,EAEX,mBAAmB7Y,EAAKxF,GACpB,IAAI2e,EACJ,QAAiB,IAAbnZ,EAAIkZ,KAAiB,CACrB,MAAMN,EAAQ,EAAO9e,IAAIkG,GAErBmZ,OADU,IAAVP,EACgB,IAAIF,EAAgB1Y,GAGpB4Y,EAAMQ,eAI1BD,EAAgBnZ,EAAIoZ,UAExB,QAAY,IAAR5e,EACA,OAAO2e,EAEX,IAAIlE,EAAckE,EAAclE,YAAYza,GAC5C,QAAoB,IAAhBya,EAAwB,CACxB,MAAM4D,EAAMpV,KAAK4V,cAAcrZ,GACzB4Y,EAAQO,EAAcP,MAC5B3D,EAAckE,EAAclE,YAAYza,GAAO,IAAIme,EAA0BC,EAAOC,EAAKre,GAE7F,OAAOya,EAEX,eAAejV,GACX,YAAoB,IAAbA,EAAIkZ,KAEf,IAAI3b,EAAQxC,EAAGue,GACX,MAAU,cAANve,EACO0I,KAED,SAAN1I,EACOwC,EAEJA,EAAOxC,GAElB,IAAIwC,EAAQxC,EAAGb,EAAOof,GAClB,MAAMN,EAAWzb,EAAOxC,GAMxB,OALIie,IAAa9e,IACbqD,EAAOxC,GAAKb,EACZuJ,KAAK8V,wBAAwBrf,EAAO8e,EAAUje,GAC9C0I,KAAK6U,qBAAqBvd,EAAGb,EAAO8e,EAAU,MAE3C,EAEX,eAAezb,EAAQxC,GACnB,MAAMie,EAAWzb,EAAOxC,GACxB,QAAIkF,QAAQuZ,eAAejc,EAAQxC,UACd,IAAbie,IACAvV,KAAK8V,6BAAwB3Q,EAAWoQ,EAAUje,GAClD0I,KAAK6U,qBAAqBvd,OAAG6N,EAAWoQ,EAAU,MAE/C,GAIf,eAAezb,EAAQxC,EAAG4C,GACtB,MAAMqb,EAAWzb,EAAOxC,GACxB,QAAIkF,QAAQrG,eAAe2D,EAAQxC,EAAG4C,KAC9BA,EAAWzD,QAAU8e,IACrBvV,KAAK8V,wBAAwB5b,EAAWzD,MAAO8e,EAAUje,GACzD0I,KAAK6U,qBAAqBvd,EAAG4C,EAAWzD,MAAO8e,EAAU,MAEtD,GAIf,MAAMzb,EAAQkc,EAASC,EAAW,IAAS7W,YAEvC,OAAO5C,QAAQ0Z,MAAMpc,EAAQA,EAAQmc,GAEzC,UAAUjD,EAAYjc,GAClB,QAAY,IAARA,EACAiJ,KAAKsT,mBAAmBN,OAEvB,CACD,IAAIxB,EAAcxR,KAAKwR,YAAYza,QACf,IAAhBya,IACAA,EAAcxR,KAAKwR,YAAYza,GAAO,IAAIme,EAA0BlV,KAAKmV,MAAOnV,KAAKoV,IAAKre,IAE9Fya,EAAYS,cAAce,IAGlC,YAAYA,EAAYjc,GACpB,QAAY,IAARA,EACAiJ,KAAKiU,sBAAsBjB,OAE1B,CACD,MAAMxB,EAAcxR,KAAKwR,YAAYza,QACjBoO,IAAhBqM,GACAA,EAAYU,iBAAiBc,IAIzC,wBAAwBmB,EAAUoB,EAAUxe,GACxC,MAAMya,EAAcxR,KAAKwR,YAAYza,QACjB,IAAhBya,GACAA,EAAYa,gBAAgB8B,EAAUoB,EAAU,MAI5D,EAAgBN,EAAkBtK,EAAW,CDvJlC,SAAU7Q,GACb,MAAM+G,EAAQ/G,EAAO1C,UACrByJ,EAAM2S,sBAAwB,EAC9B3S,EAAMyS,mBAAqBA,EAC3BzS,EAAMoT,sBAAwBA,EAC9BpT,EAAM0S,mBAAqBA,EAC3B1S,EAAMqT,oBAAsBA,EAC5BrT,EAAMgU,qBAAuBA,OACE,IAA3BhU,EAAMsV,mBACNtV,EAAMsV,iBAAmB7C,QACM,IAA/BzS,EAAMuV,uBACNvV,EAAMuV,qBAAuBnC,IC8IrClJ,EAAW,oBAAqB,CAAC7U,UAClC,GC7KH,IAaWmgB,EAbP,EAA0C,SAAUpc,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,EAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtGC,EAAoC,SAAUC,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,MAI3D,SAAWmL,GACPA,EAAcA,EAA6B,cAAI,GAAK,gBACpDA,EAAcA,EAA+B,gBAAI,GAAK,kBACtDA,EAAcA,EAAyB,UAAI,GAAK,YAHpD,CAIGA,IAAkBA,EAAgB,KAC9B,MAAMC,EAAc,IAAGxQ,gBAAgB,eAAeR,YAItD,IAAIiR,GACX,SAAWA,GACPA,EAAcA,EAA4B,aAAI,GAAK,eACnDA,EAAcA,EAAsB,OAAI,GAAK,SAFjD,CAGGA,IAAkBA,EAAgB,KAC9B,MAAMC,EAAe,IAAG1Q,gBAAgB,gBAAgBR,YAClDmR,EAAa,IAAG3Q,gBAAgB,cAAcP,YAAY2E,GAAKA,EAAEjG,UAAU,IACxF,IAAIyS,EAAa,MACb,YAAYC,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAKiQ,MAAQ,EACbjQ,KAAK4W,UAAO,EACZ5W,KAAK6W,UAAO,EAEhB,UACM7W,KAAKiQ,MAEX,IAAIoE,QACc,IAAVA,IACAA,EAAQ,GAES,KAAfrU,KAAKiQ,OACPjQ,KAAK8W,QAAQzC,GAGrB,OAAOhT,EAAIgT,GACPrU,KAAK+W,QACL1V,IACArB,KAAKgX,IAAI3C,GAEb,IAAI4C,QACkB,IAAdjX,KAAK4W,KACL5W,KAAK4W,KAAOK,GAGZA,EAAWC,UAAYlX,KAAK6W,KAE5B7W,KAAK6W,KAAKM,UAAYF,GAE1BjX,KAAK6W,KAAOI,EAEhB,OAAOA,QAC0B,IAAzBA,EAAWC,YACXD,EAAWC,UAAUC,UAAYF,EAAWE,gBAEnB,IAAzBF,EAAWE,YACXF,EAAWE,UAAUD,UAAYD,EAAWC,WAEhDD,EAAWC,eAAY,EACvBD,EAAWE,eAAY,EACnBnX,KAAK6W,OAASI,IACdjX,KAAK6W,KAAOI,EAAWC,WAEvBlX,KAAK4W,OAASK,IACdjX,KAAK4W,KAAOK,EAAWE,WAG/B,QAAQ9C,GACJ,UAAqB,IAAdrU,KAAK4W,MAAiB,CACzB,IAEIQ,EAFAC,EAAMrX,KAAK4W,KACf5W,KAAK4W,KAAO5W,KAAK6W,UAAO,EAExB,GACIQ,EAAIC,UAAUjD,GACd+C,EAAOC,EAAIF,UACXE,EAAIF,eAAY,EAChBE,EAAIH,eAAY,EAEhBG,EAAMD,aACO,IAARC,MAIrBX,EAAa,EAAW,CACpBzL,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClCwgB,GAEH,IAAIa,EAAe,MACf,YAAYZ,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAKiQ,MAAQ,EACbjQ,KAAK4W,UAAO,EACZ5W,KAAK6W,UAAO,EAEhB,UACM7W,KAAKiQ,MAEX,IAAIoE,QACc,IAAVA,IACAA,EAAQ,GAES,KAAfrU,KAAKiQ,OACPjQ,KAAK8W,QAAQzC,GAGrB,OAAOhT,EAAIgT,GACPrU,KAAK+W,QACL1V,IACArB,KAAKgX,IAAI3C,GAEb,IAAI4C,QACkB,IAAdjX,KAAK4W,KACL5W,KAAK4W,KAAOK,GAGZA,EAAWO,YAAcxX,KAAK6W,KAE9B7W,KAAK6W,KAAKY,YAAcR,GAE5BjX,KAAK6W,KAAOI,EAEhB,OAAOA,QAC4B,IAA3BA,EAAWO,cACXP,EAAWO,YAAYC,YAAcR,EAAWQ,kBAErB,IAA3BR,EAAWQ,cACXR,EAAWQ,YAAYD,YAAcP,EAAWO,aAEpDP,EAAWO,iBAAc,EACzBP,EAAWQ,iBAAc,EACrBzX,KAAK6W,OAASI,IACdjX,KAAK6W,KAAOI,EAAWO,aAEvBxX,KAAK4W,OAASK,IACdjX,KAAK4W,KAAOK,EAAWQ,aAG/B,QAAQpD,GACJ,UAAqB,IAAdrU,KAAK4W,MAAiB,CACzB,IAEIQ,EAFAC,EAAMrX,KAAK4W,KACf5W,KAAK4W,KAAO5W,KAAK6W,UAAO,EAExB,GACIQ,EAAIK,YAAYrD,GAChB+C,EAAOC,EAAII,YACXJ,EAAII,iBAAc,EAClBJ,EAAIG,iBAAc,EAElBH,EAAMD,aACO,IAARC,MAIrBE,EAAe,EAAW,CACtBtM,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClCqhB,GAEH,IAAII,EAAgB,MAChB,YAAYhB,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAKiQ,MAAQ,EACbjQ,KAAK4W,UAAO,EACZ5W,KAAK6W,UAAO,EAEhB,UACM7W,KAAKiQ,MAEX,IAAIoE,QACc,IAAVA,IACAA,EAAQ,GAES,KAAfrU,KAAKiQ,QAEPjQ,KAAK2W,UAAUiB,MAAMd,QAAQzC,GAC7BrU,KAAK8W,QAAQzC,IAGrB,OAAOhT,EAAIgT,GACPrU,KAAK+W,QACL1V,IACArB,KAAKgX,IAAI3C,GAEb,IAAI4C,QACkB,IAAdjX,KAAK4W,KACL5W,KAAK4W,KAAOK,GAGZA,EAAWY,aAAe7X,KAAK6W,KAE/B7W,KAAK6W,KAAKiB,aAAeb,GAE7BjX,KAAK6W,KAAOI,EAEhB,OAAOA,QAC6B,IAA5BA,EAAWY,eACXZ,EAAWY,aAAaC,aAAeb,EAAWa,mBAEtB,IAA5Bb,EAAWa,eACXb,EAAWa,aAAaD,aAAeZ,EAAWY,cAEtDZ,EAAWY,kBAAe,EAC1BZ,EAAWa,kBAAe,EACtB9X,KAAK6W,OAASI,IACdjX,KAAK6W,KAAOI,EAAWY,cAEvB7X,KAAK4W,OAASK,IACdjX,KAAK4W,KAAOK,EAAWa,cAG/B,QAAQzD,GACJ,UAAqB,IAAdrU,KAAK4W,MAAiB,CACzB,IAEIQ,EAFAC,EAAMrX,KAAK4W,KACf5W,KAAK4W,KAAO5W,KAAK6W,UAAO,EAExB,GACIQ,EAAIU,YAAY1D,GAChB+C,EAAOC,EAAIS,aACXT,EAAIS,kBAAe,EACnBT,EAAIQ,kBAAe,EAEnBR,EAAMD,aACO,IAARC,MAIrBM,EAAgB,EAAW,CACvB1M,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClCyhB,GAEH,IAAIK,EAAgB,MAChB,YAAYrB,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAKiQ,MAAQ,EACbjQ,KAAK4W,UAAO,EACZ5W,KAAK6W,UAAO,EAEhB,UACM7W,KAAKiQ,MAEX,IAAIoE,QACc,IAAVA,IACAA,EAAQ,GAES,KAAfrU,KAAKiQ,QAEPjQ,KAAK2W,UAAUsB,QAAQnB,QAAQzC,GAC/BrU,KAAK8W,QAAQzC,IAGrB,OAAOhT,EAAIgT,GACPrU,KAAK+W,QACL1V,IACArB,KAAKgX,IAAI3C,GAEb,IAAI4C,QACkB,IAAdjX,KAAK4W,KACL5W,KAAK4W,KAAOK,GAGZA,EAAWiB,aAAelY,KAAK6W,KAE/B7W,KAAK6W,KAAKsB,aAAelB,GAE7BjX,KAAK6W,KAAOI,EAEhB,OAAOA,QAC6B,IAA5BA,EAAWiB,eACXjB,EAAWiB,aAAaC,aAAelB,EAAWkB,mBAEtB,IAA5BlB,EAAWkB,eACXlB,EAAWkB,aAAaD,aAAejB,EAAWiB,cAEtDjB,EAAWiB,kBAAe,EAC1BjB,EAAWkB,kBAAe,EACtBnY,KAAK6W,OAASI,IACdjX,KAAK6W,KAAOI,EAAWiB,cAEvBlY,KAAK4W,OAASK,IACdjX,KAAK4W,KAAOK,EAAWkB,cAG/B,QAAQ9D,GACJ,UAAqB,IAAdrU,KAAK4W,MAAiB,CACzB,IAEIQ,EAFAC,EAAMrX,KAAK4W,KACf5W,KAAK4W,KAAO5W,KAAK6W,UAAO,EAExB,GACIQ,EAAIe,YAAY/D,GAChB+C,EAAOC,EAAIc,aACXd,EAAIc,kBAAe,EACnBd,EAAIa,kBAAe,EAEnBb,EAAMD,aACO,IAARC,MAIrBW,EAAgB,EAAW,CACvB/M,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClC8hB,GAEH,IAAIK,EAAa,MACb,YAAY1B,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAKiQ,MAAQ,EACbjQ,KAAK4W,UAAO,EACZ5W,KAAK6W,UAAO,EAEhB,IAAII,QACkB,IAAdjX,KAAK4W,KACL5W,KAAK4W,KAAOK,GAGZA,EAAWqB,UAAYtY,KAAK6W,KAE5B7W,KAAK6W,KAAK0B,UAAYtB,GAE1BjX,KAAK6W,KAAOI,EAEhB,OAAOA,QAC0B,IAAzBA,EAAWqB,YACXrB,EAAWqB,UAAUC,UAAYtB,EAAWsB,gBAEnB,IAAzBtB,EAAWsB,YACXtB,EAAWsB,UAAUD,UAAYrB,EAAWqB,WAEhDrB,EAAWqB,eAAY,EACvBrB,EAAWsB,eAAY,EACnBvY,KAAK6W,OAASI,IACdjX,KAAK6W,KAAOI,EAAWqB,WAEvBtY,KAAK4W,OAASK,IACdjX,KAAK4W,KAAOK,EAAWsB,WAG/B,QAAQlE,GAEJ,UAAqB,IAAdrU,KAAK4W,MAAiB,CACzB,IAEIQ,EAFAC,EAAMrX,KAAK4W,KACf5W,KAAK4W,KAAO5W,KAAK6W,UAAO,EAExB,GAEIQ,EAAIO,MAAMvD,GACV+C,EAAOC,EAAIkB,UACXlB,EAAIkB,eAAY,EAChBlB,EAAIiB,eAAY,EAEhBjB,EAAMD,aACO,IAARC,MAIrBgB,EAAa,EAAW,CACpBpN,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClCmiB,GAEH,IAAIG,EAAe,MACf,YAAY7B,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAK4W,UAAO,EACZ5W,KAAK6W,UAAO,EAEhB,IAAII,QACkB,IAAdjX,KAAK4W,KACL5W,KAAK4W,KAAOK,GAGZA,EAAWwB,YAAczY,KAAK6W,KAE9B7W,KAAK6W,KAAK6B,YAAczB,GAE5BjX,KAAK6W,KAAOI,EAEhB,OAAOA,QAC4B,IAA3BA,EAAWwB,cACXxB,EAAWwB,YAAYC,YAAczB,EAAWyB,kBAErB,IAA3BzB,EAAWyB,cACXzB,EAAWyB,YAAYD,YAAcxB,EAAWwB,aAEpDxB,EAAWwB,iBAAc,EACzBxB,EAAWyB,iBAAc,EACrB1Y,KAAK6W,OAASI,IACdjX,KAAK6W,KAAOI,EAAWwB,aAEvBzY,KAAK4W,OAASK,IACdjX,KAAK4W,KAAOK,EAAWyB,aAG/B,QAAQrE,GAEJ,UAAqB,IAAdrU,KAAK4W,MAAiB,CACzB,IAEIQ,EAFAC,EAAMrX,KAAK4W,KACf5W,KAAK4W,KAAO5W,KAAK6W,UAAO,EAExB,GAEIQ,EAAIY,QAAQ5D,GACZ+C,EAAOC,EAAIqB,YACXrB,EAAIqB,iBAAc,EAClBrB,EAAIoB,iBAAc,EAElBpB,EAAMD,aACO,IAARC,MAIrBmB,EAAe,EAAW,CACtBvN,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClCsiB,GAEH,IAAIG,EAAa,MACb,YAAYhC,GACR3W,KAAK2W,UAAYA,EACjB3W,KAAK4Y,MAAQ,GACb5Y,KAAKiQ,MAAQ,EAEjB,UACMjQ,KAAKiQ,MAEX,IAAIoE,QACc,IAAVA,IACAA,EAAQ,GAES,KAAfrU,KAAKiQ,OACPjQ,KAAK8W,QAAQzC,GAGrB,OAAOhT,EAAIgT,GACPrU,KAAK+W,QACL1V,IACArB,KAAKgX,IAAI3C,GAEb,IAAIhO,GACArG,KAAK4Y,MAAM/Y,KAAKwG,GAEpB,OAAOA,GACH,MAAMnB,EAAQlF,KAAK4Y,MAAM3P,QAAQ5C,GAC7BnB,GAAS,GACTlF,KAAK4Y,MAAMhH,OAAO1M,EAAO,GAGjC,QAAQmP,GAEJ,IADAA,GAAS,IACFrU,KAAK4Y,MAAMte,OAAS,GAAG,CAC1B,MAAMue,EAAQ7Y,KAAK4Y,MAAMla,QACzBsB,KAAK4Y,MAAQ,GACb,MAAM,OAAEte,GAAWue,EACnB,IAAK,IAAIrjB,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BqjB,EAAMrjB,GAAGsjB,WAAWzE,MAKpCsE,EAAa,EAAW,CACpB1N,EAAQ,EAAGwL,GACX,EAAW,oBAAqB,CAACvgB,UAClCyiB,GAEI,MAAM,EACT,cACI3Y,KAAK6Y,MAAQ,IAAIF,EAAW3Y,MAC5BA,KAAK4X,MAAQ,IAAIS,EAAWrY,MAC5BA,KAAKiY,QAAU,IAAIO,EAAaxY,MAChCA,KAAKsX,UAAY,IAAIZ,EAAW1W,MAChCA,KAAK0X,YAAc,IAAIH,EAAavX,MACpCA,KAAK+X,YAAc,IAAIJ,EAAc3X,MACrCA,KAAKoY,YAAc,IAAIJ,EAAchY,MAEzC,gBAAgBqD,GACZ,OAAO,IAAaY,UAAUwS,EAAYzW,MAAMyF,SAASpC,IC1ejE,IAMI,EAA0C,SAAU3J,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAS1G,IAAI,EAAiB,MACjB,YAAY2L,EAAWtC,EAAO9X,EAAK/D,GAC/BwH,KAAK2W,UAAYA,EACjB3W,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKqV,SAAU,EACfrV,KAAKgZ,WAAY,EACjBhZ,KAAKiZ,gBAA0B,WAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACf,GAAIrU,KAAKgZ,UAAW,CAChB,MAAMD,EAAe/Y,KAAK+Y,aAC1B/Y,KAAK+Y,aAAe5E,EACe,IAA/BnU,KAAK2W,UAAUkC,MAAM5I,MACrBjQ,KAAKqS,gBAAgB8B,EAAU4E,EAAc/Y,KAAKiZ,gBAAkB5E,GAE9DrU,KAAKqV,UACXrV,KAAKqV,SAAU,EACfrV,KAAKuV,SAAWwD,EAChB/Y,KAAK2W,UAAUkC,MAAMjd,IAAIoE,YAU7BA,KAAKzD,IAAIyD,KAAKxH,aAAe2b,EAGrC,WAAWE,GACPrU,KAAKqV,SAAU,EACf,MAAM0D,EAAe/Y,KAAK+Y,aACpBxD,EAAWvV,KAAKuV,SACtBvV,KAAKuV,SAAWwD,EAChB/Y,KAAKqS,gBAAgB0G,EAAcxD,EAAUvV,KAAKiZ,gBAAkB5E,GAExE,UAAUrB,IACiB,IAAnBhT,KAAKgZ,YACLhZ,KAAKgZ,WAAY,EACjBhZ,KAAK+Y,aAAe/Y,KAAKzD,IAAIyD,KAAKxH,aAC7BgE,QAAQrG,eAAe6J,KAAKzD,IAAKyD,KAAKxH,YAAa,CACpDpC,YAAY,EACZsG,cAAc,EACdrG,IAAK,IACM2J,KAAKkZ,WAEhBngB,IAAKtC,IACDuJ,KAAKmZ,SAAS1iB,EAAO,OAGzB,IAASyR,MAAM,EAAGlI,KAAKxH,YAAawH,KAAKzD,MAGjDyD,KAAKiS,cAAce,KC1E3B,IAAIoG,ED6EJ,EAhF8C,SAAUnf,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA4E/C,CAAW,CACxByb,IACA,EAAW,oBAAqB,CAAC7b,OAAQmjB,OAAQnjB,OAAQkC,UAC1D,GC/EH,SAAWghB,GACPA,EAAaA,EAAuB,SAAI,KAAO,WAC/CA,EAAaA,EAAiC,mBAAI,KAAO,qBACzDA,EAAaA,EAA6B,eAAI,KAAO,iBAHzD,CAIGA,IAAiBA,EAAe,KACnC,MAAME,EAASpjB,OAAOyV,OAAO,IAEtB,MAAM,EACT,YAAYgL,EAAWtC,EAAO9X,EAAKxF,GAI/B,YAHkB,IAAdiJ,KAAKjJ,KACLiJ,KAAKjJ,GAAO,IAAI,EAAe4f,EAAWtC,EAAO9X,EAAKxF,IAEnDiJ,KAAKjJ,IAGb,MAAM,EACT,YAAYwiB,EAAU9iB,GAElB,GADAuJ,KAAKwZ,YAAa,OACD,IAAbD,EACA,QAAc,IAAV9iB,EAEAuJ,KAAKuZ,GAAY9iB,OAIjB,IAAK,MAAM6L,KAAQiX,EACXrjB,OAAOkB,UAAUC,eAAe1B,KAAK4jB,EAAUjX,KAC/CtC,KAAKsC,GAAQiX,EAASjX,IAM1C,cAAc+R,EAAOkF,EAAU9iB,GAC3B,MAAMgjB,EAAK,IAAI,EAAeF,EAAU9iB,GACxC,OAAY,EAAR4d,EACO,EAAciB,YAAYmE,GAAItE,MAElCsE,EAEX,WAAWhM,EAAO1X,EAAM2jB,EAAUrF,EAAOsF,GACrC,GAAa,MAATlM,EACA,MAAM,IAAS9L,MAAM,KAEzB,IAAIiY,EAAkBnM,EAAMmM,gBAC5B,GAAIF,EAAW,EAAG,CAEd,KAAOA,EAAW,GAAG,CACjB,GAA6C,MAAzCE,EAAgBC,sBAChB,OAEJH,IACAE,EAAkBA,EAAgBC,sBAEtC,OAAO9jB,KAAQ6jB,EAAkBA,EAAkBA,EAAgBE,eAGvE,KAAOF,KAAqB7jB,KAAQ6jB,MAAsBA,EAAgBE,gBAAkB/jB,KAAQ6jB,EAAgBE,iBAChHF,EAAkBA,EAAgBC,sBAEtC,GAAID,EAEA,OAAO7jB,KAAQ6jB,EAAkBA,EAAkBA,EAAgBE,eAGvE,IAAa,SAARzF,GAAoD,EAAG,CACxD,IAAItZ,EAAS0S,EAAMsM,YACnB,KAAkB,OAAXhf,GAAiB,CACpB,GAAIA,EAAOif,WAAW7K,SAASwK,GAAO,CAClC,MAAM9c,EAASmD,KAAK3J,IAAI0E,EAAQhF,EAAM2jB,GAEhC,SAF0CrF,EAI1C,SACN,OAAIxX,IAAWyc,EACJ7L,EAAMqM,gBAAkBrM,EAAMmM,gBAG9B/c,EAIX9B,EAASA,EAAOgf,YAGxB,GAAe,OAAXhf,EACA,MAAM,IAAI0F,MAAM,4CAA4CkZ,MAMpE,OAAY,QAARtF,EACOiF,EAEJ7L,EAAMqM,gBAAkBrM,EAAMmM,gBAEzC,aAAavF,GAIT,OAHuB,MAAnBrU,KAAKia,aACLja,KAAKia,WAAa,IAAI,GAEnBja,KAAKia,YAGb,MAAM,EACT,YAAYF,EAAaD,EAAgBF,GACrC5Z,KAAK+Z,YAAcA,EACnB/Z,KAAKga,WAAa,IAAS5a,WAC3BY,KAAK8Z,eAAiBA,EACtB9Z,KAAK4Z,gBAAkBA,EAE3B,cAAcvF,EAAOoF,EAAIS,GACrB,OAAO,IAAI,EAAM,KAAMT,EAAU,MAANS,EAAaC,EAAgBrjB,OAAOud,EAAOoF,EAAIS,GAAMA,GAEpF,oBAAoB7F,EAAO6F,GACvB,GAAU,MAANA,EACA,MAAM,IAASvY,MAAM,KAEzB,OAAO,IAAI,EAAM,KAAMuY,EAAGJ,eAAgBI,GAE9C,kBAAkB7F,EAAO+F,EAAIX,GACzB,GAAU,MAANW,EACA,MAAM,IAASzY,MAAM,KAEzB,OAAO,IAAI,EAAMyY,EAAIX,EAAIU,EAAgBrjB,OAAOud,EAAOoF,EAAIW,EAAGR,mBAG/D,MAAMO,EACT,YAAYL,EAAgBD,GACxB7Z,KAAKwZ,YAAa,EAClBxZ,KAAK8Z,eAAiBA,EACtB9Z,KAAK6Z,sBAAwBA,EAEjC,cAAcxF,EAAOoF,EAAIY,GACrB,OAAO,IAAIF,EAAgBV,OAAY,IAARY,EAAiB,KAAOA,GAE3D,eAII,YAHwB,IAApBra,KAAKia,aACLja,KAAKia,WAAa,IAAI,GAEnBja,KAAKia,YC/Ib,MAAMK,EAAY,IAAGxU,gBAAgB,aAAaP,YAAY2E,GAAKA,EAAEjG,UAAUsW,IAE/E,MAAMA,EACT,cACIva,KAAKwa,QAAUtkB,OAAOY,OAAO,MAEjC,eAAef,EAAMse,GACjB,MAAMoG,EAAYza,KAAKwa,QAAQzkB,GAC/B,QAAkBoP,IAAdsV,EAGJ,IAAK,MAAMC,KAAYD,EAAUjhB,OAC7BkhB,EAAS9F,kBAAazP,OAAWA,EAAmB,GAARkP,GAGpD,kBAAkBte,EAAM2kB,GACpB,MAAMF,EAAUxa,KAAKwa,QACfC,EAAYD,EAAQzkB,QACRoP,IAAdsV,EACAD,EAAQzkB,GAAQ,IAAI4F,IAAI,CAAC+e,IAGzBD,EAAU7e,IAAI8e,GAGtB,qBAAqB3kB,EAAM2kB,GACvB,MAAMD,EAAYza,KAAKwa,QAAQzkB,GAC3B0kB,GACAA,EAAU1e,OAAO2e,ICnBtB,IAAIC,IACX,SAAWA,GACPA,EAAwC,eAAI,KAC5CA,EAA0C,iBAAI,KAC9CA,EAAmD,0BAAI,KACvDA,EAA2C,kBAAI,KAC/CA,EAAqC,YAAI,KACzCA,EAAuC,cAAI,KAC3CA,EAAyC,gBAAI,KAC7CA,EAAqC,YAAI,KACzCA,EAAoC,WAAI,KACxCA,EAAoC,WAAI,KACxCA,EAAyC,gBAAI,KAXjD,CAYGA,KAA4BA,GAA0B,KACzD,MAAMC,GAA4B,IAAIjjB,QAY/B,SAASkjB,GAAWC,EAAaC,GACpC,GAAID,IAAgBC,EAChB,OAAOD,EAEX,QAAoB,IAAhBA,EACA,OAAOC,EAEX,QAAiB,IAAbA,EACA,OAAOD,EAEX,IAAIE,EAAiBJ,GAA0BvkB,IAAIykB,QAC5B,IAAnBE,GACAJ,GAA0B7hB,IAAI+hB,EAAaE,EAAiB,IAAIrjB,SAEpE,IAAIsjB,EAAcD,EAAe3kB,IAAI0kB,GAOrC,YANoB,IAAhBE,GACAD,EAAejiB,IAAIgiB,EAAUE,EAAc,IACpCH,KACAC,IAGJE,EAEJ,MAAMC,GAAuB,IAAGpV,gBAAgB,wBAAwBR,YAKxE,MAAM6V,GACT,YAAYrhB,GACRkG,KAAKob,UAAY,WAAYthB,EAC7BkG,KAAKqb,iBAAmB,kBAAmBvhB,EAC3CkG,KAAKsb,gBAAkB,iBAAkBxhB,EACzCkG,KAAKub,wBAA0B,yBAA0BzhB,EACzDkG,KAAKwb,cAAgB,eAAgB1hB,EACrCkG,KAAKyb,aAAe,cAAe3hB,EACnCkG,KAAK0b,gBAAkB,iBAAkB5hB,EACzCkG,KAAK2b,eAAiB,gBAAiB7hB,EACvCkG,KAAK4b,gBAAkB,iBAAkB9hB,EACzCkG,KAAK6b,eAAiB,gBAAiB/hB,EACvCkG,KAAK8b,gBAAkB,iBAAkBhiB,EACzCkG,KAAK+b,eAAiB,gBAAiBjiB,EACvCkG,KAAKgc,WAAa,YAAaliB,GAgBhC,SAASmiB,GAAgBC,EAASxZ,EAAU3L,EAAKsM,GACpD,IAAK,IAAI7N,EAAI,EAAGkS,EAAKwU,EAAQ5hB,OAAQ9E,EAAIkS,IAAMlS,EAC3C,IAAa6U,QAAQtT,EAAK2L,EAASyZ,QAAQD,EAAQ1mB,KAAKiQ,SAASpC,GAfzE8X,GAAgBiB,KAAO,IAAIjB,GAAgB,IChF7BhhB,MAAM/C,UAAUsH,MAA9B,MACM2d,GAAY,GACZC,GAAmB,GACzB,IAAIC,IAAY,EAChB,SAASC,GAAsBC,GAC3B,GAAIA,IAAgBF,GAAU,CAC1BA,IAAY,EACZ,MAAM7U,EAAK2U,GAAU/hB,OAASgiB,GAAiBhiB,OAASiiB,GAAW,EACnE,IAAK,IAAI/mB,EAAIinB,EAAc,EAAGjnB,EAAIkS,IAAMlS,EACpC6mB,GAAU7mB,GAAK,YAAYA,IAC3B8mB,GAAiB9mB,GAAK,mBAAmBA,KAM9C,SAASknB,GAAYC,GAExB,MAAMC,EAAsC,MAAtB5c,KAAK4c,cAAwB,EAAI5c,KAAK4c,cAC5D,IAAIpnB,EAAIonB,EACR,KAAOpnB,KAAOwK,KAAKqc,GAAU7mB,MAAQmnB,IAGrC,IAAW,IAAPnnB,EAAU,CAEV,IADAA,EAAI,EACGwK,KAAKqc,GAAU7mB,KAClBA,IAEJwK,KAAKqc,GAAU7mB,IAAMmnB,EACrBA,EAAS7K,UAAU9R,MACnB2c,EAAS3c,KAAK0U,KAAO,GAEjBlf,IAAMonB,IACN5c,KAAK4c,cAAgBpnB,EAAI,GAIb,MAAhBwK,KAAK6c,UACL7c,KAAK6c,QAAU,GAEnB7c,KAAKsc,GAAiB9mB,IAAMwK,KAAK6c,QACjCL,GAAsBhnB,GAGnB,SAASsnB,GAAgBzI,EAAO9X,EAAKwgB,GACxC,MAAMJ,EAAW3c,KAAKgd,gBAAgBC,YAAY5I,EAAO9X,EAAKwgB,GAQ9D/c,KAAK0c,YAAYC,GAGd,SAASO,GAAUC,GACtB,MAAMC,EAAQpd,KAAK4c,cACnB,IAAIS,EACAV,EACJ,IAAY,IAARQ,EACA,IAAK,IAAI3nB,EAAI,EAAGA,EAAI4nB,IAAS5nB,EACzB6nB,EAAWhB,GAAU7mB,GACrBmnB,EAAW3c,KAAKqd,GACA,MAAZV,IACA3c,KAAKqd,QAAY,EACjBV,EAASrK,YAAYtS,MACrB2c,EAAS3c,KAAK0U,MAAO,QAI5B,CACD,MAAMmI,EAAU7c,KAAK6c,QACrB,IAAK,IAAIrnB,EAAI,EAAGA,EAAI4nB,IAAS5nB,EACrBwK,KAAKsc,GAAiB9mB,MAAQqnB,IAC9BQ,EAAWhB,GAAU7mB,GACrBmnB,EAAW3c,KAAKqd,GACA,MAAZV,IACA3c,KAAKqd,QAAY,EACjBV,EAASrK,YAAYtS,MACrB2c,EAAS3c,KAAK0U,MAAO,MAMzC,SAAS4I,GAAqBxjB,GAC1B,MAAM+G,EAAQ/G,EAAO1C,UAOrB,OANKlB,OAAOkB,UAAUC,eAAe1B,KAAKkL,EAAO,qBAC7CA,EAAMic,gBAAkBA,IACvB5mB,OAAOkB,UAAUC,eAAe1B,KAAKkL,EAAO,eAC7CA,EAAMqc,UAAYA,IACjBhnB,OAAOkB,UAAUC,eAAe1B,KAAKkL,EAAO,iBAC7CA,EAAM6b,YAAcA,IACjB5iB,EAEJ,SAASyjB,GAAYzjB,GACxB,OAAiB,MAAVA,EAAiBwjB,GAAuBA,GAAqBxjB,GAnFxE0iB,IAAuB,GAqFvB,IAAI,GAAQ,EACZe,GAAYC,WAAc/W,IACtBA,EAASiO,KAAO,ICtGpB,IAYW+I,GAZP,GAA0C,SAAUxjB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAUnG,SAAS0S,GAAgBC,GAC5B,OAAO,SAAU7jB,GACb,OAAO8jB,GAAgB1hB,OAAOyhB,EAAW7jB,KANjD,SAAW2jB,GACPA,EAAwBA,EAAmC,UAAI,GAAK,YACpEA,EAAwBA,EAAqC,YAAI,GAAK,cAF1E,CAGGA,KAA4BA,GAA0B,KAMlD,MAAM,GACT,YAAY1c,EAAMhL,EAAMmmB,EAASnlB,EAAK0M,GAClCzD,KAAKe,KAAOA,EACZf,KAAKjK,KAAOA,EACZiK,KAAKkc,QAAUA,EACflc,KAAKjJ,IAAMA,EACXiJ,KAAKyD,SAAWA,EAEpB,cAAcka,EAAW5c,GACrB,IAAIhL,EACA8M,EACqB,iBAAd8a,GACP5nB,EAAO4nB,EACP9a,EAAM,CAAE9M,UAGRA,EAAO4nB,EAAU5nB,KACjB8M,EAAM8a,GAEV,MAAME,EAA0B3nB,OAAO8E,eAAe+F,KAAU+c,GAChE,OAAO,IAAI,GAA0B/c,EAAM,YAAa6c,GAAgBG,cAAchd,EAAM,QAAShL,GAAO,YAAY6nB,GAAgBG,cAAchd,EAAM,WAAY8B,EAAIqZ,QAASnb,EAAKmb,SAAU0B,GAAgBzB,QAAQpmB,GAAO,YAA0C,WAAY8M,EAAK9B,EAAM,IAAM8c,EAA0B,EAAsB,IAE9V,SAASxa,GACL,MAAM,KAAEtC,EAAI,IAAEhK,EAAG,QAAEmlB,EAAO,SAAEzY,GAAazD,KACzC,OAAQyD,GACJ,KAAK,EACD,IAAaQ,UAAUlN,EAAKgK,GAAM0E,SAASpC,GAC3C,MACJ,KAAK,EACD,IAAaoD,SAAS1P,EAAK,IAAI,GAAuBsM,EAAWtC,IAAO0E,SAASpC,GAGzF,IAAagH,QAAQtT,EAAKgK,GAAM0E,SAASpC,GACzC4Y,GAAgBC,EAAS0B,GAAiB7mB,EAAKsM,IAGhD,MAAM,GACT,YAAYA,EAAWtC,GACnBf,KAAKqD,UAAYA,EACjBrD,KAAKe,KAAOA,EACZf,KAAKgI,KAAO,IAAGlD,gBAAgB/D,GAEnC,UAAUid,EAASC,GACf,MAAM5a,EAAYrD,KAAKqD,UACjB2E,EAAOhI,KAAKgI,KAClB,OAAQA,EAAK1N,QACT,KAAK,EACL,KAAK,EACL,KAAK,EACD,OAAO,IAAI0F,KAAKe,KAAKid,EAASC,GAClC,KAAK,EACD,OAAO,IAAIje,KAAKe,KAAKsC,EAAUhN,IAAI2R,EAAK,IAAKgW,EAASC,GAC1D,KAAK,EACD,OAAO,IAAIje,KAAKe,KAAKsC,EAAUhN,IAAI2R,EAAK,IAAK3E,EAAUhN,IAAI2R,EAAK,IAAKgW,EAASC,GAClF,QACI,OAAO,IAAIje,KAAKe,QAAQiH,EAAK7P,IAAIrC,GAAKuN,EAAUhN,IAAIP,IAAKkoB,EAASC,KAIlF,IAAIH,GAAqB,MACrB,YAAYE,EAASC,GAIjB,IAAIC,EACJ,IAJAle,KAAKge,QAAUA,EACfhe,KAAKie,KAAOA,EACZje,KAAKke,YAAcle,KAEZge,EAAQE,cAAgBle,MAC3Bke,EAAcF,EAAQE,YACtBF,EAAQE,YAAcle,KACtBge,EAAUE,EAGlB,SACI,OAAOle,KAAKge,QAAQtJ,GAExB,sBACI,OAAO1U,KAAKge,QAAQhB,gBAExB,cACI,OAAOhd,KAAKge,QAAQG,QAExB,aACI,OAAOne,KAAKge,QAAQI,OAExB,WACI,OAAOpe,KAAKge,QAAQrE,KAExB,aACI,OAAO3Z,KAAKge,QAAQK,OAExB,aAAa5nB,EAAO4d,GAChBrU,KAAKge,QAAQM,aAAa7nB,EAAO4d,GAErC,aAAa5d,EAAO4d,GAChBrU,KAAKge,QAAQO,aAAa9nB,EAAO4d,GAErC,WAAWvc,GACP,OAAOkI,KAAKge,QAAQQ,WAAW1mB,GAEnC,aAAaqc,EAAUC,EAAeC,GAClCrU,KAAKge,QAAQpJ,aAAaT,EAAUC,EAAeC,GAEvD,MAAMA,EAAO5G,EAAOkM,GAChB3Z,KAAKge,QAAQS,MAAMpK,EAAO5G,EAAOkM,GAErC,QAAQtF,GACJrU,KAAKge,QAAQU,QAAQrK,KAG7ByJ,GAAqB,GAAW,CAC5BP,GACA,GAAW,oBAAqB,CAACrnB,OAAQA,UAC1C4nB,IAEI,MAAMF,GAAkB,CAC3B7nB,KAAM,IAAS2M,SAASH,OAAO,oBAC/B4Z,QAAQpmB,GACG,GAAG6nB,GAAgB7nB,QAAQA,IAEtC4oB,OAAOloB,GACqB,mBAAVA,GAAwB,IAAS0F,OAAOyhB,GAAgB7nB,KAAMU,GAEhF,OAAOknB,EAAW5c,GACd,MAAM6K,EAAa,GAA0B9U,OAAO6mB,EAAW5c,GAI/D,OAHA,IAAS7E,OAAO0hB,GAAgB7nB,KAAM6V,EAAYA,EAAW7K,MAC7D,IAAS7E,OAAO0hB,GAAgB7nB,KAAM6V,EAAYA,GAClD,IAASlJ,SAAS8B,SAASzD,EAAM6c,GAAgB7nB,MAC1C6V,EAAW7K,MAEtB,cAAcA,GACV,MAAM8B,EAAM,IAASzG,OAAOwhB,GAAgB7nB,KAAMgL,GAClD,QAAY,IAAR8B,EACA,MAAM,IAAIpC,MAAM,gCAAgCM,EAAKhL,QAEzD,OAAO8M,GAEX,SAAS9B,EAAMuB,EAAM7L,GACjB,IAASyF,OAAO,IAASmG,WAAWE,OAAOD,GAAO7L,EAAOsK,IAE7Dgd,cAAa,CAAChd,EAAMuB,IACT,IAASlG,OAAO,IAASiG,WAAWE,OAAOD,GAAOvB,IC/J1D,SAAS6d,GAAejB,GAC3B,OAAO,SAAU7jB,GACb,OAAO+kB,GAAe3iB,OAAOyhB,EAAW7jB,IAGzC,MAAM,GACT,YAAYiH,EAAMhL,EAAMmmB,EAASnlB,GAC7BiJ,KAAKe,KAAOA,EACZf,KAAKjK,KAAOA,EACZiK,KAAKkc,QAAUA,EACflc,KAAKjJ,IAAMA,EAEf,cAAc4mB,EAAW5c,GACrB,IAAIhL,EACA8M,EASJ,MARyB,iBAAd8a,GACP5nB,EAAO4nB,EACP9a,EAAM,CAAE9M,UAGRA,EAAO4nB,EAAU5nB,KACjB8M,EAAM8a,GAEH,IAAI,GAAyB5c,EAAM,YAAa8d,GAAed,cAAchd,EAAM,QAAShL,GAAO,YAAY8oB,GAAed,cAAchd,EAAM,WAAY8B,EAAIqZ,QAASnb,EAAKmb,SAAU2C,GAAe1C,QAAQpmB,IAE5N,SAASsN,GACL,MAAM,KAAEtC,EAAI,IAAEhK,EAAG,QAAEmlB,GAAYlc,KAC/B,IAAaiE,UAAUlN,EAAKgK,GAAM0E,SAASpC,GAC3C,IAAagH,QAAQtT,EAAKgK,GAAM0E,SAASpC,GACzC4Y,GAAgBC,EAAS2C,GAAgB9nB,EAAKsM,IAG/C,MAAMwb,GAAiB,CAC1B9oB,KAAM,IAAS2M,SAASH,OAAO,mBAC/B4Z,QAAQpmB,GACG,GAAG8oB,GAAe9oB,QAAQA,IAErC4oB,OAAOloB,GACqB,mBAAVA,GAAwB,IAAS0F,OAAO0iB,GAAe9oB,KAAMU,GAE/E,OAAOknB,EAAW5c,GACd,MAAM6K,EAAa,GAAyB9U,OAAO6mB,EAAW5c,GAI9D,OAHA,IAAS7E,OAAO2iB,GAAe9oB,KAAM6V,EAAYA,EAAW7K,MAC5D,IAAS7E,OAAO2iB,GAAe9oB,KAAM6V,EAAYA,GACjD,IAASlJ,SAAS8B,SAASzD,EAAM8d,GAAe9oB,MACzC6V,EAAW7K,MAEtB,cAAcA,GACV,MAAM8B,EAAM,IAASzG,OAAOyiB,GAAe9oB,KAAMgL,GACjD,QAAY,IAAR8B,EACA,MAAM,IAAIpC,MAAM,gCAAgCM,EAAKhL,QAEzD,OAAO8M,GAEX,SAAS9B,EAAMuB,EAAM7L,GACjB,IAASyF,OAAO,IAASmG,WAAWE,OAAOD,GAAO7L,EAAOsK,IAE7Dgd,cAAa,CAAChd,EAAMuB,IACT,IAASlG,OAAO,IAASiG,WAAWE,OAAOD,GAAOvB,IC9B1D,SAAS+d,GAAQb,GACpB,OAA6C,OAAxB,KAAbA,EAAKc,OAEV,SAASC,GAAUf,GACtB,OAA+C,OAA1B,KAAbA,EAAKc,OA+BjB,IAAI,IACJ,SAAW3F,GACPA,EAAaA,EAAwB,UAAI,KAAO,YAChDA,EAAaA,EAA8B,gBAAI,KAAO,kBACtDA,EAAaA,EAAqC,uBAAI,KAAO,yBAC7DA,EAAaA,EAA+B,iBAAI,KAAO,mBACvDA,EAAaA,EAAwB,UAAI,KAAO,YAChDA,EAAaA,EAA2B,aAAI,KAAO,eACnDA,EAAaA,EAA8B,gBAAI,KAAO,kBACtDA,EAAaA,EAAuB,SAAI,KAAO,WARnD,CASG,KAAiB,GAAe,KAC5B,MAAM6F,GACT,YAAYxoB,GACRuJ,KAAKvJ,MAAQA,EAEjB,SAAS4d,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAO3Z,KAAKvJ,OAGb,MAAM,GACT,YAAYyoB,EAAYnpB,EAAM+B,GAC1BkI,KAAKkf,WAAaA,EAClBlf,KAAKjK,KAAOA,EACZiK,KAAKlI,KAAOA,EACZkI,KAAK+e,MAAQ,MACb/e,KAAKmf,YAAcvB,GAAgBzB,QAAQpmB,GAE/C,SAASse,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAO3Z,KAAKkf,WAAWE,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAE3D,OAAOtF,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GACjC,OAAO3Z,KAAKkf,WAAW5hB,OAAO+W,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GAEhE,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B3Z,KAAKkf,WAAWG,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAEnD,KAAKtF,EAAO5G,EAAOuQ,GACf,GAAa,MAATvQ,EACA,MAAM,IAAS9L,MAAM,IAAoB3B,MAE7C,IAAKge,EACD,MAAM,IAASrc,MAAM,IAAqB3B,MAE9C,MAAMme,EAAUH,EAAQG,QACxB,IAAKA,EACD,MAAM,IAASxc,MAAM,IAAqB3B,MAE1C8e,GAAQ9e,KAAKkf,aACblf,KAAKkf,WAAWloB,KAAKqd,EAAO5G,EAAOuQ,GAEvC,MAAMmB,EAAcnf,KAAKmf,YACnBG,EAAWnB,EAAQ9nB,IAAI8oB,GAC7B,IAAKG,EACD,MAAM,IAAS3d,MAAM,IAA2B3B,MAE9Csf,aAAoB,UACO,IAAzBtB,EAAQmB,IACRnB,EAAQmB,GAAeG,EACvBA,EAAStoB,KAAKrB,KAAK2pB,EAAUjL,EAAO5G,EAAOuQ,KAAYuB,GAASlL,EAAO5G,EAAO0Q,EAASne,KAAKlI,QAG5F,IAASoQ,MAAM,IAAkClI,OAI7D,OAAOqU,EAAO5G,EAAOuQ,GACjB,MAAMmB,EAAcnf,KAAKmf,iBACI,IAAzBnB,EAAQmB,KACRnB,EAAQmB,GAAaK,OAAOnL,EAAO5G,EAAOuQ,GAC1CA,EAAQmB,QAAe,GAEvBH,GAAUhf,KAAKkf,aACflf,KAAKkf,WAAWM,OAAOnL,EAAO5G,EAAOuQ,GAG7C,OAAOyB,GACH,OAAOA,EAAQC,qBAAqB1f,OAGrC,MAAM,GACT,YAAYkf,EAAYnpB,EAAM+B,GAC1BkI,KAAKkf,WAAaA,EAClBlf,KAAKjK,KAAOA,EACZiK,KAAKlI,KAAOA,EACZkI,KAAK+e,MAAQ,MACb/e,KAAK2f,aAAed,GAAe1C,QAAQpmB,GAE/C,SAASse,EAAO5G,EAAO0Q,EAASxE,GAC5B,IAAKwE,EACD,MAAM,IAASxc,MAAM,IAAqB3B,MAE9C,MAAM4f,EAAYzB,EAAQ9nB,IAAI2J,KAAK2f,cACnC,IAAKC,EACD,MAAM,IAASje,MAAM,IAA4B3B,MAErD,GAAI,WAAY4f,EAAW,CACvB,MAAM9nB,EAAOkI,KAAKlI,KACZ+F,EAAM/F,EAAKwC,OACXuC,EAAS1C,MAAM0D,EAAM,GAC3BhB,EAAO,GAAKmD,KAAKkf,WAAWE,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAC5D,IAAK,IAAInkB,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBqH,EAAOrH,EAAI,GAAKsC,EAAKtC,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAE5D,OAAOiG,EAAUC,OAAOlqB,KAAKiqB,KAAc/iB,GAE/C,OAAOmD,KAAKkf,WAAWE,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAE3D,OAAOtF,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GACjC,IAAKwE,EACD,MAAM,IAASxc,MAAM,IAAqB3B,MAE9C,MAAM4f,EAAYzB,EAAQ9nB,IAAI2J,KAAK2f,cACnC,IAAKC,EACD,MAAM,IAASje,MAAM,IAA4B3B,MAKrD,MAHI,aAAc4f,IACdnpB,EAAQmpB,EAAUE,SAASnqB,KAAKiqB,EAAWnpB,KAAW8oB,GAASlL,EAAO5G,EAAO0Q,EAASne,KAAKlI,QAExFkI,KAAKkf,WAAW5hB,OAAO+W,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GAEhE,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,GAAa,MAATlM,EACA,MAAM,IAAS9L,MAAM,IAAoB3B,MAE7C,IAAKge,EACD,MAAM,IAASrc,MAAM,IAAqB3B,MAE9C,MAAMme,EAAUH,EAAQG,QACxB,IAAKA,EACD,MAAM,IAASxc,MAAM,IAAqB3B,MAE9CA,KAAKkf,WAAWG,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAC/C,MAAM7hB,EAAOkI,KAAKlI,KAClB,IAAK,IAAItC,EAAI,EAAGkS,EAAK5P,EAAKwC,OAAQ9E,EAAIkS,IAAMlS,EACxCsC,EAAKtC,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAE3C,MAAMiG,EAAYzB,EAAQ9nB,IAAI2J,KAAK2f,cACnC,IAAKC,EACD,MAAM,IAASje,MAAM,IAA4B3B,MAErD,MAAMwa,EAAUoF,EAAUpF,QAC1B,QAAgB,IAAZA,EACA,OAEJ,MAAMuF,EAAW5B,EAAQ9nB,IAAIikB,GAC7B,IAAK,IAAI9kB,EAAI,EAAGkS,EAAK8S,EAAQlgB,OAAQ9E,EAAIkS,IAAMlS,EAC3CuqB,EAASC,kBAAkBxF,EAAQhlB,GAAIwoB,GAG/C,OAAO3J,EAAO5G,EAAOuQ,GACjB,MAAMG,EAAUH,EAAQG,QAElB3D,EADY2D,EAAQ9nB,IAAI2J,KAAK2f,cACTnF,QAC1B,QAAgB,IAAZA,EACA,OAEJ,MAAMuF,EAAW5B,EAAQ9nB,IAAIikB,GAC7B,IAAK,IAAI9kB,EAAI,EAAGkS,EAAK8S,EAAQlgB,OAAQ9E,EAAIkS,IAAMlS,EAC3CuqB,EAASE,qBAAqBzF,EAAQhlB,GAAIwoB,GAGlD,OAAOyB,GACH,OAAOA,EAAQS,oBAAoBlgB,OAGpC,MAAMmgB,GACT,YAAYrmB,EAAQrD,GAChBuJ,KAAKlG,OAASA,EACdkG,KAAKvJ,MAAQA,EACbuJ,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAO3Z,KAAKlG,OAAOwD,OAAO+W,EAAO5G,EAAO0Q,EAASne,KAAKvJ,MAAM2oB,SAAS/K,EAAO5G,EAAO0Q,GAAUxE,GAEjG,QAAQtF,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAOtF,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GAEjC,OADA3Z,KAAKvJ,MAAM6G,OAAO+W,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GACzC3Z,KAAKlG,OAAOwD,OAAO+W,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GAE5D,OAAO8F,GACH,OAAOA,EAAQW,YAAYpgB,OAG5B,MAAMqgB,GACT,YAAYC,EAAWC,EAAKC,GACxBxgB,KAAKsgB,UAAYA,EACjBtgB,KAAKugB,IAAMA,EACXvgB,KAAKwgB,GAAKA,EACVxgB,KAAK+e,MAAQ,GAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAU3Z,KAAKsgB,UAAUlB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACnD3Z,KAAKugB,IAAInB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACzC3Z,KAAKwgB,GAAGpB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAElD,OAAOtF,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GACT3Z,KAAKsgB,UACTlB,SAAS/K,EAAO5G,EAAO,KAAMkM,IACvC3Z,KAAKsgB,UAAUjB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAC9C3Z,KAAKugB,IAAIlB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,KAGxC3Z,KAAKsgB,UAAUjB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAC9C3Z,KAAKwgB,GAAGnB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,IAG/C,OAAO8F,GACH,OAAOA,EAAQgB,iBAAiBzgB,OAGjC,MAAM,GACT,YAAY0Z,EAAW,GACnB1Z,KAAK0Z,SAAWA,EAChB1Z,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,GAAa,MAATlM,EACA,MAAM,IAAS9L,MAAM,IAAoB3B,MAE7C,IAAa,SAARqU,GAAoD,EAAG,CACxD,IAAItZ,EAAS0S,EAAMsM,YACnB,KAAkB,OAAXhf,GACEA,EAAOif,WAAW7K,SAASwK,KAC5B5e,EAASA,EAAOgf,aAGxB,GAAe,OAAXhf,EACA,MAAM,IAAI0F,MAAM,2CAA2CkZ,MAGnE,IAAIO,EAAKzM,EAAMmM,gBACXpkB,EAAIwK,KAAK0Z,SACb,KAAOlkB,KAAO0kB,GACVA,EAAKA,EAAGL,sBAEZ,OAAOrkB,EAAI,GAAK0kB,EAAKA,EAAGJ,oBAAiB,EAE7C,OAAOzF,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAO8F,GACH,OAAOA,EAAQiB,gBAAgB1gB,OAGvC,GAAqB2gB,MAAQ,IAAI,GAAqB,GACtD,GAAqBC,QAAU,IAAI,GAAqB,GACjD,MAAM,GACT,YAAY7qB,EAAM2jB,EAAW,GACzB1Z,KAAKjK,KAAOA,EACZiK,KAAK0Z,SAAWA,EAChB1Z,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MACMkH,EADM,EAAexqB,IAAIoX,EAAOzN,KAAKjK,KAAMiK,KAAK0Z,SAAUrF,EAAOsF,GAC5C3Z,KAAKjK,MAChC,OAAY,EAARse,EACOwM,EAEc,MAAlBA,EAAyB,GAAKA,EAEzC,OAAOxM,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GACjC,MAAMpd,EAAM,EAAelG,IAAIoX,EAAOzN,KAAKjK,KAAMiK,KAAK0Z,SAAUrF,EAAOsF,GACvE,GAAIpd,aAAerG,OACf,YAAuB,IAAnBqG,EAAI0d,iBAAuD,IAA9B1d,EAAI0d,WAAWja,KAAKjK,OACjDwG,EAAI0d,WAAWja,KAAKjK,MAAMojB,SAAS1iB,EAAO4d,GACnC5d,GAGA8F,EAAIyD,KAAKjK,MAAQU,EAKpC,QAAQ4d,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAM3a,EAAU,EAAe3I,IAAIoX,EAAOzN,KAAKjK,KAAMiK,KAAK0Z,SAAUrF,EAAOsF,GAC3EqE,EAAQlB,gBAAgBzI,EAAOrV,EAASgB,KAAKjK,MAEjD,OAAO0pB,GACH,OAAOA,EAAQqB,iBAAiB9gB,OAGjC,MAAM+gB,GACT,YAAY7pB,EAAQnB,GAChBiK,KAAK9I,OAASA,EACd8I,KAAKjK,KAAOA,EACZiK,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMlT,EAAWzG,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAC7D,OAAY,EAARtF,EACmB,MAAZ5N,EAAmBA,EAAWA,EAASzG,KAAKjK,MAEhD0Q,EAAWA,EAASzG,KAAKjK,MAAQ,GAE5C,OAAOse,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GACjC,MAAMpd,EAAMyD,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAYxD,OAXIpd,aAAerG,YACQ,IAAnBqG,EAAI0d,iBAAuD,IAA9B1d,EAAI0d,WAAWja,KAAKjK,MACjDwG,EAAI0d,WAAWja,KAAKjK,MAAMojB,SAAS1iB,EAAO4d,GAG1C9X,EAAIyD,KAAKjK,MAAQU,EAIrBuJ,KAAK9I,OAAOoG,OAAO+W,EAAO5G,EAAO0Q,EAAS,CAAE,CAACne,KAAKjK,MAAOU,IAEtDA,EAEX,QAAQ4d,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMpd,EAAMyD,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO,KAAMkM,GACO,IAA/C,UAARtF,IACDrU,KAAK9I,OAAOmoB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAE3Cpd,aAAerG,QACf8nB,EAAQlB,gBAAgBzI,EAAO9X,EAAKyD,KAAKjK,MAGjD,OAAO0pB,GACH,OAAOA,EAAQuB,kBAAkBhhB,OAGlC,MAAMihB,GACT,YAAY/pB,EAAQH,GAChBiJ,KAAK9I,OAASA,EACd8I,KAAKjJ,IAAMA,EACXiJ,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMlT,EAAWzG,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAC7D,GAAIlT,aAAoBvQ,OAAQ,CAE5B,OAAOuQ,EADKzG,KAAKjJ,IAAIqoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,KAK7D,OAAOtF,EAAO5G,EAAO0Q,EAAS1nB,EAAOkjB,GAGjC,OAFiB3Z,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACjD3Z,KAAKjJ,IAAIqoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,IAC9BljB,EAE3B,QAAQ4d,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMpd,EAAMyD,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO,KAAMkM,GAIrD,GAH4D,IAA/C,UAARtF,IACDrU,KAAK9I,OAAOmoB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAE3Cpd,aAAerG,OAAQ,CACvB8J,KAAKjJ,IAAIsoB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GACxC,MAAM5iB,EAAMiJ,KAAKjJ,IAAIqoB,SAAS/K,EAAO5G,EAAO,KAAMkM,GAElDqE,EAAQlB,gBAAgBzI,EAAO9X,EAAKxF,IAG5C,OAAO0oB,GACH,OAAOA,EAAQyB,iBAAiBlhB,OAGjC,MAAM,GACT,YAAYjK,EAAM+B,EAAM4hB,EAAW,GAC/B1Z,KAAKjK,KAAOA,EACZiK,KAAKlI,KAAOA,EACZkI,KAAK0Z,SAAWA,EAChB1Z,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAM7hB,EAAOynB,GAASlL,EAAO5G,EAAO0Q,EAASne,KAAKlI,KAAM6hB,GAClD3a,EAAU,EAAe3I,IAAIoX,EAAOzN,KAAKjK,KAAMiK,KAAK0Z,SAAUrF,EAAOsF,GACrEwH,EAAOC,GAAY/M,EAAOrV,EAASgB,KAAKjK,MAC9C,GAAIorB,EACA,OAAOA,EAAKjL,MAAMlX,EAASlH,GAInC,OAAOuc,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAM7hB,EAAOkI,KAAKlI,KAClB,IAAK,IAAItC,EAAI,EAAGkS,EAAK5P,EAAKwC,OAAQ9E,EAAIkS,IAAMlS,EACxCsC,EAAKtC,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAG/C,OAAO8F,GACH,OAAOA,EAAQ4B,eAAerhB,OAG/B,MAAMshB,GACT,YAAYpqB,EAAQnB,EAAM+B,GACtBkI,KAAK9I,OAASA,EACd8I,KAAKjK,KAAOA,EACZiK,KAAKlI,KAAOA,EACZkI,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMlT,EAAWzG,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACvD7hB,EAAOynB,GAASlL,EAAO5G,EAAO0Q,EAASne,KAAKlI,KAAM6hB,GAClDwH,EAAOC,GAAY/M,EAAO5N,EAAUzG,KAAKjK,MAC/C,GAAIorB,EACA,OAAOA,EAAKjL,MAAMzP,EAAU3O,GAIpC,OAAOuc,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMpd,EAAMyD,KAAK9I,OAAOkoB,SAAS/K,EAAO5G,EAAO,KAAMkM,GAIrD,GAH4D,IAA/C,UAARtF,IACDrU,KAAK9I,OAAOmoB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAE3CyH,IAAoB,QAAR/M,EAAqC9X,EAAKyD,KAAKjK,MAAO,CAClE,MAAM+B,EAAOkI,KAAKlI,KAClB,IAAK,IAAItC,EAAI,EAAGkS,EAAK5P,EAAKwC,OAAQ9E,EAAIkS,IAAMlS,EACxCsC,EAAKtC,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,IAInD,OAAO8F,GACH,OAAOA,EAAQ8B,gBAAgBvhB,OAGhC,MAAM,GACT,YAAYmhB,EAAMrpB,GACdkI,KAAKmhB,KAAOA,EACZnhB,KAAKlI,KAAOA,EACZkI,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMwH,EAAOnhB,KAAKmhB,KAAK/B,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACvD,GAAoB,mBAATwH,EACP,OAAOA,KAAQ5B,GAASlL,EAAO5G,EAAO0Q,EAASne,KAAKlI,KAAM6hB,IAE9D,GAAc,QAARtF,GAAgD,MAAR8M,EAG9C,MAAM,IAASxf,MAAM,IAAwB3B,MAEjD,OAAOqU,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMwH,EAAOnhB,KAAKmhB,KAAK/B,SAAS/K,EAAO5G,EAAO,KAAMkM,GAEpD,GADA3Z,KAAKmhB,KAAK9B,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GACrB,mBAATwH,EAAqB,CAC5B,MAAMrpB,EAAOkI,KAAKlI,KAClB,IAAK,IAAItC,EAAI,EAAGkS,EAAK5P,EAAKwC,OAAQ9E,EAAIkS,IAAMlS,EACxCsC,EAAKtC,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,IAInD,OAAO8F,GACH,OAAOA,EAAQ+B,kBAAkBxhB,OAGlC,MAAM,GACT,YAAYnI,EAAW4pB,EAAMC,GACzB1hB,KAAKnI,UAAYA,EACjBmI,KAAKyhB,KAAOA,EACZzhB,KAAK0hB,MAAQA,EACb1hB,KAAK+e,MAAQ,GAIb/e,KAAKof,SAAWpf,KAAKnI,GAEzB,SAASwc,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAM,IAAShY,MAAM,IAA2B3B,MAEpD,OAAOqU,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B3Z,KAAKyhB,KAAKpC,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GACzC3Z,KAAK0hB,MAAMrC,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAE9C,KAAOgI,EAAGpqB,EAAG9B,EAAG6B,GACZ,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,IAAM0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE1E,KAAOqqB,EAAGpqB,EAAG9B,EAAG6B,GACZ,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,IAAM0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE1E,KAAOqqB,EAAGpqB,EAAG9B,EAAG6B,GAEZ,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,IAAM0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE1E,MAAQqqB,EAAGpqB,EAAG9B,EAAG6B,GACb,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,KAAO0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE3E,KAAOqqB,EAAGpqB,EAAG9B,EAAG6B,GAEZ,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,IAAM0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE1E,MAAQqqB,EAAGpqB,EAAG9B,EAAG6B,GACb,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,KAAO0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE3E,WAAeqqB,EAAGpqB,EAAG9B,EAAG6B,GACpB,MAAMoqB,EAAQ1hB,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAC3C,MAAqB,mBAAVoqB,GACA1hB,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,aAAcoqB,EAIzD,GAAOC,EAAGpqB,EAAG9B,EAAG6B,GACZ,MAAMoqB,EAAQ1hB,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAC3C,OAAIoqB,aAAiBxrB,QACV8J,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,KAAMoqB,EAQjD,IAAMC,EAAGpqB,EAAG9B,EAAG6B,GACX,MAAMmqB,EAAOzhB,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GACnCoqB,EAAQ1hB,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAC3C,IAAS,EAAJqqB,GAAuC,EACxC,OAAOF,EAAOC,EAGlB,IAAKD,IAASC,EAAO,CACjB,GAAI,YAAiBD,IAAS,YAAiBC,GAE3C,OAAQD,GAAQ,IAAMC,GAAS,GAEnC,GAAI,YAAeD,IAAS,YAAeC,GAEvC,OAAQD,GAAQ,KAAOC,GAAS,IAGxC,OAAOD,EAAOC,EAElB,IAAMC,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAAK0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAEzE,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAAK0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAEzE,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAAK0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAEzE,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAAK0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAEzE,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAAK0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAEzE,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAAK0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAEzE,KAAOqqB,EAAGpqB,EAAG9B,EAAG6B,GACZ,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,IAAM0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE1E,KAAOqqB,EAAGpqB,EAAG9B,EAAG6B,GACZ,OAAO0I,KAAKyhB,KAAKrC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,IAAM0I,KAAK0hB,MAAMtC,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE1E,OAAOmoB,GACH,OAAOA,EAAQmC,YAAY5hB,OAG5B,MAAM,GACT,YAAYnI,EAAWqnB,GACnBlf,KAAKnI,UAAYA,EACjBmI,KAAKkf,WAAaA,EAClBlf,KAAK+e,MAAQ,GAEb/e,KAAKof,SAAWpf,KAAKnI,GAEzB,SAASwc,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAM,IAAShY,MAAM,IAA2B3B,MAEpD,OAAOqU,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B3Z,KAAKkf,WAAWG,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAEnD,KAASgI,EAAGpqB,EAAG9B,EAAG6B,GACF0I,KAAKkf,WAAWE,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAElD,OAAWqqB,EAAGpqB,EAAG9B,EAAG6B,GAChB,cAAc0I,KAAKkf,WAAWE,SAAa,EAAJuC,EAAqCpqB,EAAG9B,EAAG6B,GAEtF,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAQ0I,KAAKkf,WAAWE,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE9C,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAQ0I,KAAKkf,WAAWE,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE9C,IAAMqqB,EAAGpqB,EAAG9B,EAAG6B,GACX,OAAQ0I,KAAKkf,WAAWE,SAASuC,EAAGpqB,EAAG9B,EAAG6B,GAE9C,OAAOmoB,GACH,OAAOA,EAAQoC,WAAW7hB,OAG3B,MAAM8hB,GACT,YAAYrrB,GACRuJ,KAAKvJ,MAAQA,EACbuJ,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAO3Z,KAAKvJ,MAEhB,OAAO4d,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAO8F,GACH,OAAOA,EAAQsC,sBAAsB/hB,OAG7C8hB,GAA2BE,WAAa,IAAIF,QAA2B,GACvEA,GAA2BG,MAAQ,IAAIH,GAA2B,MAClEA,GAA2BI,MAAQ,IAAIJ,IAA2B,GAClEA,GAA2BK,OAAS,IAAIL,IAA2B,GACnEA,GAA2BM,OAAS,IAAIN,GAA2B,IAC5D,MAAMO,GACT,YAAYC,GACRtiB,KAAKsiB,MAAQA,EACbtiB,KAAK+e,MAAQ,GAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAM4I,EAAWviB,KAAKsiB,MACtB,IACI7rB,EADAoG,EAAS,GAEb,IAAK,IAAIrH,EAAI,EAAGkS,EAAK6a,EAASjoB,OAAQ9E,EAAIkS,IAAMlS,EAC5CiB,EAAQ8rB,EAAS/sB,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACvC,MAATljB,IAGJoG,GAAUpG,GAEd,OAAOoG,EAEX,OAAOwX,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,IAAK,IAAInkB,EAAI,EAAGkS,EAAK1H,KAAKsiB,MAAMhoB,OAAQ9E,EAAIkS,IAAMlS,EAC9CwK,KAAKsiB,MAAM9sB,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAGrD,OAAO8F,GACH,OAAOA,EAAQ+C,iBAAiBxiB,OAGjC,MAAMyiB,GACT,YAAYF,GACRviB,KAAKuiB,SAAWA,EAChBviB,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAM4I,EAAWviB,KAAKuiB,SAChBjoB,EAASioB,EAASjoB,OAClBuC,EAAS1C,MAAMG,GACrB,IAAK,IAAI9E,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BqH,EAAOrH,GAAK+sB,EAAS/sB,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAE5D,OAAO9c,EAEX,OAAOwX,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAM4I,EAAWviB,KAAKuiB,SACtB,IAAK,IAAI/sB,EAAI,EAAGkS,EAAK6a,EAASjoB,OAAQ9E,EAAIkS,IAAMlS,EAC5C+sB,EAAS/sB,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAGnD,OAAO8F,GACH,OAAOA,EAAQiD,kBAAkB1iB,OAGzCyiB,GAAuBL,OAAS,IAAIK,GAAuB,IAASrjB,YAC7D,MAAMujB,GACT,YAAYnpB,EAAMgH,GACdR,KAAKxG,KAAOA,EACZwG,KAAKQ,OAASA,EACdR,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMlT,EAAW,GACXjN,EAAOwG,KAAKxG,KACZgH,EAASR,KAAKQ,OACpB,IAAK,IAAIhL,EAAI,EAAGkS,EAAKlO,EAAKc,OAAQ9E,EAAIkS,IAAMlS,EACxCiR,EAASjN,EAAKhE,IAAMgL,EAAOhL,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAElE,OAAOlT,EAEX,OAAO4N,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMngB,EAAOwG,KAAKxG,KACZgH,EAASR,KAAKQ,OACpB,IAAK,IAAIhL,EAAI,EAAGkS,EAAKlO,EAAKc,OAAQ9E,EAAIkS,IAAMlS,EACxCgL,EAAOhL,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAGjD,OAAO8F,GACH,OAAOA,EAAQmD,mBAAmB5iB,OAG1C2iB,GAAwBP,OAAS,IAAIO,GAAwB,IAASvjB,WAAY,IAASA,YACpF,MAAM,GACT,YAAYyjB,EAAQC,EAAc,IAAS1jB,YACvCY,KAAK6iB,OAASA,EACd7iB,KAAK8iB,YAAcA,EACnB9iB,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMmJ,EAAc9iB,KAAK8iB,YACnBD,EAAS7iB,KAAK6iB,OACpB,IAAIhmB,EAASgmB,EAAO,GACpB,IAAK,IAAIrtB,EAAI,EAAGkS,EAAKob,EAAYxoB,OAAQ9E,EAAIkS,IAAMlS,EAC/CqH,GAAUimB,EAAYttB,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACzD9c,GAAUgmB,EAAOrtB,EAAI,GAEzB,OAAOqH,EAEX,OAAOwX,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMmJ,EAAc9iB,KAAK8iB,YACzB,IAAK,IAAIttB,EAAI,EAAGkS,EAAKob,EAAYxoB,OAAQ9E,EAAIkS,IAAMlS,EAC/CstB,EAAYttB,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAC9CnkB,IAGR,OAAOiqB,GACH,OAAOA,EAAQsD,cAAc/iB,OAGrC,GAAmBoiB,OAAS,IAAI,GAAmB,CAAC,KAC7C,MAAM,GACT,YAAYS,EAAQzN,EAAK+L,EAAM2B,EAAc,IAAS1jB,YAClDY,KAAK6iB,OAASA,EACd7iB,KAAKmhB,KAAOA,EACZnhB,KAAK8iB,YAAcA,EACnB9iB,KAAK+e,MAAQ,KACb8D,EAAOzN,IAAMA,EAEjB,SAASf,EAAO5G,EAAO0Q,EAASxE,GAC5B,MAAMmJ,EAAc9iB,KAAK8iB,YACnBjlB,EAAMilB,EAAYxoB,OAClBmQ,EAAUtQ,MAAM0D,GACtB,IAAK,IAAIrI,EAAI,EAAGkS,EAAK7J,EAAKrI,EAAIkS,IAAMlS,EAChCiV,EAAQjV,GAAKstB,EAAYttB,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAEhE,MAAMwH,EAAOnhB,KAAKmhB,KAAK/B,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACvD,GAAoB,mBAATwH,EACP,MAAM,IAASxf,MAAM,IAAwB3B,MAEjD,OAAOmhB,EAAKnhB,KAAK6iB,UAAWpY,GAEhC,OAAO4J,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,GAC3B,MAAMmJ,EAAc9iB,KAAK8iB,YACzB,IAAK,IAAIttB,EAAI,EAAGkS,EAAKob,EAAYxoB,OAAQ9E,EAAIkS,IAAMlS,EAC/CstB,EAAYttB,GAAG6pB,QAAQhL,EAAO5G,EAAOuQ,GAEzChe,KAAKmhB,KAAK9B,QAAQhL,EAAO5G,EAAOuQ,GAEpC,OAAOyB,GACH,OAAOA,EAAQuD,oBAAoBhjB,OAGpC,MAAMijB,GAET,YAAYV,GACRviB,KAAKuiB,SAAWA,EAChBviB,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,IAIhC,OAAOtF,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAInC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAO8F,GACH,OAAOA,EAAQyD,yBAAyBljB,OAGzC,MAAMmjB,GAET,YAAY3pB,EAAMgH,GACdR,KAAKxG,KAAOA,EACZwG,KAAKQ,OAASA,EACdR,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,IAIhC,OAAOtF,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAInC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAO8F,GACH,OAAOA,EAAQ2D,0BAA0BpjB,OAG1C,MAAMqjB,GACT,YAAYttB,GACRiK,KAAKjK,KAAOA,EACZiK,KAAK+e,MAAQ,MAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAO3Z,KAAKjK,KAEhB,QAAQse,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAO8F,GACH,OAAOA,EAAQ6D,uBAAuBtjB,OAG9C,MAAMxJ,GAAcN,OAAOkB,UAAUkB,SAG9B,MAAM,GACT,YAAYirB,EAAaC,GACrBxjB,KAAKujB,YAAcA,EACnBvjB,KAAKwjB,SAAWA,EAChBxjB,KAAK+e,MAAQ,KAEjB,SAAS1K,EAAO5G,EAAO0Q,EAASxE,GAC5B,OAAO3Z,KAAKwjB,SAASpE,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAEzD,OAAOtF,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,MAAMtF,EAAOxX,GACT,OAAQrG,GAAYb,KAAKkH,IACrB,IAAK,iBAAkB,OAAOA,EAAOvC,OACrC,IAAK,eACL,IAAK,eAAgB,OAAOuC,EAAO4mB,KACnC,IAAK,kBAAmB,OAAO5mB,EAC/B,IAAK,gBACL,IAAK,qBAAsB,OAAO,EAClC,QAAS,MAAM,IAAS8E,MAAM,IAGtC,QAAQ0S,EAAOxX,EAAQskB,GACnB,OAAQ3qB,GAAYb,KAAKkH,IACrB,IAAK,iBAAkB,OAAO6mB,GAAe,QAARrP,EAAuCxX,EAAQskB,GACpF,IAAK,eAAgB,OA4GjC,SAAc9M,EAAOxX,EAAQskB,GACzB,MAAMtiB,EAAM1E,MAAM0C,EAAO4mB,MACzB,IAAIjuB,GAAK,EACT,IAAK,MAAMmuB,KAAS9mB,EAAO+mB,UACvB/kB,IAAMrJ,GAAKmuB,EAEfD,IAAe,QAARrP,EAAwCxV,EAAKsiB,GAlHhB0C,CAAa,QAARxP,EAAuCxX,EAAQskB,GAChF,IAAK,eAAgB,OAmHjC,SAAc9M,EAAOxX,EAAQskB,GACzB,MAAMtiB,EAAM1E,MAAM0C,EAAO4mB,MACzB,IAAIjuB,GAAK,EACT,IAAK,MAAMuB,KAAO8F,EAAOrD,OACrBqF,IAAMrJ,GAAKuB,EAEf2sB,IAAe,QAARrP,EAAwCxV,EAAKsiB,GAzHhB,CAAa,QAAR9M,EAAuCxX,EAAQskB,GAChF,IAAK,kBAAmB,OA0HpC,SAAiB9M,EAAOxX,EAAQskB,GAC5B,MAAMtiB,EAAM1E,MAAM0C,GAClB,IAAK,IAAIrH,EAAI,EAAGA,EAAIqH,IAAUrH,EAC1BqJ,EAAIrJ,GAAKA,EAEbkuB,IAAe,QAARrP,EAAwCxV,EAAKsiB,GA/Hb2C,CAAgB,QAARzP,EAAuCxX,EAAQskB,GACtF,IAAK,gBACL,IAAK,qBAAsB,OAC3B,QAAS,MAAM,IAASxf,MAAM,IAGtC,QAAQ0S,EAAO5G,EAAOuQ,EAASrE,GAC3B3Z,KAAKujB,YAAYlE,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAChD3Z,KAAKwjB,SAASnE,QAAQhL,EAAO5G,EAAOuQ,EAASrE,GAEjD,KAAKtF,EAAO5G,EAAOuQ,GACXc,GAAQ9e,KAAKwjB,WACbxjB,KAAKwjB,SAASxsB,KAAKqd,EAAO5G,EAAOuQ,GAGzC,OAAO3J,EAAO5G,EAAOuQ,GACbgB,GAAUhf,KAAKwjB,WACfxjB,KAAKwjB,SAAShE,OAAOnL,EAAO5G,EAAOuQ,GAG3C,OAAOyB,GACH,OAAOA,EAAQsE,oBAAoB/jB,OAQpC,MAAM,GACT,YAAYsiB,EAAOQ,EAAc,IAAS1jB,YACtCY,KAAKsiB,MAAQA,EACbtiB,KAAK8iB,YAAcA,EACnB9iB,KAAK+e,MAAQ,GACb/e,KAAKgkB,QAAUlB,EAAYxoB,OAAS,EACpC0F,KAAKikB,gBAAkBnB,EAAY,GAEvC,SAASzO,EAAO5G,EAAO0Q,EAASxE,GAC5B,GAAI3Z,KAAKgkB,QAAS,CACd,MAAMlB,EAAc9iB,KAAK8iB,YACnBR,EAAQtiB,KAAKsiB,MACnB,IAAIzlB,EAASylB,EAAM,GACnB,IAAK,IAAI9sB,EAAI,EAAGkS,EAAKob,EAAYxoB,OAAQ9E,EAAIkS,IAAMlS,EAC/CqH,GAAUimB,EAAYttB,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GACzD9c,GAAUylB,EAAM9sB,EAAI,GAExB,OAAOqH,EAEN,CACD,MAAMylB,EAAQtiB,KAAKsiB,MACnB,MAAO,GAAGA,EAAM,KAAKtiB,KAAKikB,gBAAgB7E,SAAS/K,EAAO5G,EAAO0Q,EAASxE,KAAQ2I,EAAM,MAGhG,OAAOjO,EAAO5G,EAAO0Q,EAAS5hB,EAAKod,IAGnC,QAAQtF,EAAO5G,EAAOuQ,EAASrE,IAG/B,OAAO8F,GACH,OAAOA,EAAQyE,mBAAmBlkB,OAI1C,SAASuf,GAASlL,EAAO5G,EAAO0Q,EAASgG,EAAMxK,GAC3C,MAAM9b,EAAMsmB,EAAK7pB,OACXuC,EAAS1C,MAAM0D,GACrB,IAAK,IAAIrI,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBqH,EAAOrH,GAAK2uB,EAAK3uB,GAAG4pB,SAAS/K,EAAO5G,EAAO0Q,EAASxE,GAExD,OAAO9c,EAEX,SAASukB,GAAY/M,EAAO9X,EAAKxG,GAC7B,MAAMorB,EAAc,MAAP5kB,EAAc,KAAOA,EAAIxG,GACtC,GAAoB,mBAATorB,EACP,OAAOA,EAEX,KAAc,QAAR9M,IAA+C,MAAR8M,EACzC,OAAO,KAEX,MAAM,IAASxf,MAAM,IAAwBpF,EAAKxG,EAAMorB,GAG5D,SAASuC,GAAOrP,EAAOxX,EAAQskB,GAC3B,GAF0B,kBAErB9M,GAA0D,CAI3D,MAAM+P,EAAW,EAAcxO,cAAc/Y,GACvCgB,EAAMumB,EAAS9pB,OACrB,IAAIoF,EACAlK,EAAI,EACR,KAAOA,EAAIqI,IAAOrI,EACdkK,EAAO0kB,EAAS5uB,GACZkK,aAAgBxJ,SAChBwJ,EAAO0kB,EAAS5uB,GAAK,EAAc8f,YAAY5V,GAAMyV,OAEzDgM,EAAKiD,EAAU5uB,EAAGkK,QAItB,IAAK,IAAIlK,EAAI,EAAGkS,EAAK7K,EAAOvC,OAAQ9E,EAAIkS,IAAMlS,EAC1C2rB,EAAKtkB,EAAQrH,EAAGqH,EAAOrH,ICrgC5B,IAAI6uB,GAQAC,IAPX,SAAWD,GACPA,EAAYA,EAAqB,QAAI,GAAK,UAC1CA,EAAYA,EAAoB,OAAI,GAAK,SACzCA,EAAYA,EAAsB,SAAI,GAAK,WAC3CA,EAAYA,EAAoB,OAAI,GAAK,SACzCA,EAAYA,EAAqB,QAAI,GAAK,UAL9C,CAMGA,KAAgBA,GAAc,KAEjC,SAAWC,GAQPA,EAAgBA,EAA8B,aAAI,GAAK,eASvDA,EAAgBA,EAAyB,QAAI,GAAK,UAjBtD,CAkBGA,KAAoBA,GAAkB,KAUlC,IAAIC,GAiBAC,GA0CAC,GCvGAC,GASAC,GAMAC,GA4BJ,SAASC,GAAevqB,EAAS,GACpC,MAAMuE,EAAM1E,MAAMG,GAClB,IAAI9E,EAAI,EACR,KAAOA,EAAI8E,GACPuE,EAAIrJ,GAAKA,IAIb,OAFAqJ,EAAIimB,aAAe,GACnBjmB,EAAIkmB,YAAa,EACVlmB,GDNX,SAAW0lB,GACPA,EAAMA,EAAY,KAAI,GAAK,OAC3BA,EAAMA,EAAiB,UAAI,GAAK,YAChCA,EAAMA,EAAmB,YAAI,GAAK,cAClCA,EAAMA,EAAe,QAAI,GAAK,UAC9BA,EAAMA,EAAwB,iBAAI,GAAK,mBACvCA,EAAMA,EAA0B,mBAAI,GAAK,qBACzCA,EAAMA,EAAmB,YAAI,GAAK,cAClCA,EAAMA,EAAmB,YAAI,IAAM,cACnCA,EAAMA,EAAkB,WAAI,IAAM,aAClCA,EAAMA,EAA6B,sBAAI,IAAM,wBAC7CA,EAAMA,EAA6B,sBAAI,IAAM,wBAC7CA,EAAMA,EAAiB,UAAI,IAAM,YACjCA,EAAMA,EAAsB,eAAI,KAAO,iBACvCA,EAAMA,EAAmB,YAAI,KAAO,cAdxC,CAeGA,KAAUA,GAAQ,KAErB,SAAWC,GACPA,EAAeA,EAAqB,KAAI,GAAK,OAG7CA,EAAeA,EAAuC,uBAAI,YAAc,yBACxEA,EAAeA,EAA0C,0BAAI,UAAY,4BACzEA,EAAeA,EAA0C,0BAAI,WAAa,4BAC1EA,EAAeA,EAAoC,oBAAI,WAAa,sBACpEA,EAAeA,EAAsC,sBAAI,WAAa,wBACtEA,EAAeA,EAA8C,8BAAI,WAAa,gCAC9EA,EAAeA,EAAoC,oBAAI,YAAc,sBACrEA,EAAeA,EAAgC,gBAAI,IAAM,kBACzDA,EAAeA,EAAqC,qBAAI,GAAK,uBAC7DA,EAAeA,EAA8B,cAAI,GAAK,gBACtDA,EAAeA,EAAwC,wBAAI,GAAK,0BAChEA,EAAeA,EAAuB,OAAI,IAAM,SAChDA,EAAeA,EAAqC,qBAAI,IAAM,uBAC9DA,EAAeA,EAAuC,uBAAI,IAAM,yBAChEA,EAAeA,EAAqB,KAAI,QAAU,OAClDA,EAAeA,EAA0B,UAAI,KAAO,YACpDA,EAAeA,EAA+B,eAAI,IAAM,iBACxDA,EAAeA,EAA8B,cAAI,KAAO,gBACxDA,EAAeA,EAAyB,SAAI,KAAO,WACnDA,EAAeA,EAA0B,UAAI,KAAO,YACpDA,EAAeA,EAA8B,cAAI,MAAQ,gBACzDA,EAAeA,EAA6B,aAAI,MAAQ,eACxDA,EAAeA,EAAyB,SAAI,MAAQ,WACpDA,EAAeA,EAA2B,WAAI,MAAQ,aACtDA,EAAeA,EAA2B,WAAI,OAAS,aACvDA,EAAeA,EAA2B,WAAI,OAAS,aACvDA,EAAeA,EAA0B,UAAI,OAAS,YACtDA,EAAeA,EAA6B,aAAI,QAAU,eAC1DA,EAAeA,EAAkC,kBAAI,QAAU,oBAC/DA,EAAeA,EAAsC,sBAAI,QAAU,wBACnEA,EAAeA,EAA6B,aAAI,SAAW,eAC3DA,EAAeA,EAA6B,aAAI,SAAW,eAC3DA,EAAeA,EAAwC,wBAAI,SAAW,0BACtEA,EAAeA,EAAgC,gBAAI,SAAW,kBAC9DA,EAAeA,EAAqC,qBAAI,UAAY,uBACpEA,EAAeA,EAA6B,aAAI,UAAY,eAvChE,CAwCGA,KAAmBA,GAAiB,KAEvC,SAAWC,GACPA,EAAeA,EAAyB,SAAI,IAAM,WAClDA,EAAeA,EAAyB,SAAI,IAAM,WAClDA,EAAeA,EAA8B,cAAI,KAAO,gBACxDA,EAAeA,EAA4B,YAAI,KAAO,cACtDA,EAAeA,EAA0B,UAAI,KAAO,YACpDA,EAAeA,EAA+B,eAAI,MAAQ,iBAC1DA,EAAeA,EAAwB,QAAI,MAAQ,UACnDA,EAAeA,EAA0B,UAAI,MAAQ,YACrDA,EAAeA,EAA6B,aAAI,MAAQ,eACxDA,EAAeA,EAA0B,UAAI,OAAS,YACtDA,EAAeA,EAA2B,WAAI,OAAS,aACvDA,EAAeA,EAAiC,iBAAI,OAAS,mBAC7DA,EAAeA,EAAqB,KAAI,IAAM,OAE9CA,EAAeA,EAA2B,WAAI,MAAQ,aACtDA,EAAeA,EAA4B,YAAI,OAAS,cACxDA,EAAeA,EAA6B,aAAI,OAAS,eACzDA,EAAeA,EAA8B,cAAI,OAAS,gBAC1DA,EAAeA,EAAiC,iBAAI,OAAS,mBAC7DA,EAAeA,EAAyB,SAAI,OAAS,WACrDA,EAAeA,EAAsB,MAAI,IAAM,QAC/CA,EAAeA,EAA0B,UAAI,MAAQ,YACrDA,EAAeA,EAA2B,WAAI,MAAQ,aACtDA,EAAeA,EAA6B,aAAI,MAAQ,eACxDA,EAAeA,EAA6B,aAAI,MAAQ,eACxDA,EAAeA,EAA4B,YAAI,MAAQ,cACvDA,EAAeA,EAA+B,eAAI,MAAQ,iBAC1DA,EAAeA,EAAuB,OAAI,IAAM,SAChDA,EAAeA,EAA4B,YAAI,IAAM,cACrDA,EAAeA,EAAuB,OAAI,MAAQ,SAClDA,EAAeA,EAA+B,eAAI,OAAS,iBAC3DA,EAAeA,EAAgC,gBAAI,OAAS,kBAC5DA,EAAeA,EAA4B,YAAI,IAAM,cACrDA,EAAeA,EAAoC,oBAAI,OAAS,sBAChEA,EAAeA,EAAqC,qBAAI,OAAS,uBACjEA,EAAeA,EAAkC,kBAAI,OAAS,oBAC9DA,EAAeA,EAA+B,eAAI,MAAQ,iBAC1DA,EAAeA,EAA8B,cAAI,IAAM,gBAtC3D,CAuCGA,KAAmBA,GAAiB,KC9IvC,SAAWC,GACPA,EAAgBA,EAAsB,KAAI,GAAK,OAC/CA,EAAgBA,EAA6B,YAAI,GAAK,cACtDA,EAAgBA,EAA6B,YAAI,GAAK,cACtDA,EAAgBA,EAA6B,YAAI,GAAK,cACtDA,EAAgBA,EAAiC,gBAAI,GAAK,kBAC1DA,EAAgBA,EAAqB,IAAI,IAAM,MANnD,CAOGA,KAAoBA,GAAkB,KAEzC,SAAWC,GACPA,EAAmBA,EAAyB,KAAI,GAAK,OACrDA,EAAmBA,EAA8B,UAAI,GAAK,YAC1DA,EAAmBA,EAA6B,SAAI,GAAK,WAH7D,CAIGA,KAAuBA,GAAqB,KAE/C,SAAWC,GACPA,EAAeA,EAAwB,QAAI,GAAK,UAChDA,EAAeA,EAAsB,MAAI,GAAK,QAC9CA,EAAeA,EAAsB,MAAI,GAAK,QAC9CA,EAAeA,EAAoB,IAAI,GAAK,MAC5CA,EAAeA,EAAoB,IAAI,GAAK,MALhD,CAMGA,KAAmBA,GAAiB,KCvBvC,IAMI,GAA0C,SAAUlrB,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAG1G,IAAIga,GAA2B,MAC3B,YAAYzoB,GACRyD,KAAKzD,IAAMA,EACXyD,KAAK+Y,aAAexc,EAAIjC,OAE5B,WACI,OAAO0F,KAAKzD,IAAIjC,OAEpB,SAAS6Z,EAAUE,GACf,MAAM,aAAE0E,GAAiB/Y,KACrBmU,IAAa4E,IACb/Y,KAAK+Y,aAAe5E,EACpBnU,KAAKqS,gBAAgB8B,EAAU4E,EAAsB,GAAR1E,MAIzD2Q,GA1B8C,SAAU/qB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAsBrC,CAAW,CAClCyb,IACA,GAAW,oBAAqB,CAAC5X,SAClC6qB,IC7BH,IAAI,GAA0C,SAAU/qB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAM1G,MAAMia,GAAiB,IAAIttB,QAE3B,SAASutB,GAAYhb,EAAGib,GACpB,OAAIjb,IAAMib,EACC,GAEXjb,EAAU,OAANA,EAAa,OAASA,EAAE5R,aAC5B6sB,EAAU,OAANA,EAAa,OAASA,EAAE7sB,aACZ,EAAI,EAExB,SAAS8sB,GAAelb,EAAGib,GACvB,YAAU,IAANjb,OACU,IAANib,EACO,EAGA,OAGL,IAANA,GACQ,EAEL,EAEX,SAASE,GAAcxmB,EAAKkW,EAAUrL,EAAM4b,EAAIC,GAC5C,IAAIC,EAAUC,EAAUC,EAAMC,EAAMC,EAChCpwB,EAAG8K,EACP,IAAK9K,EAAIkU,EAAO,EAAGlU,EAAI8vB,EAAI9vB,IAAK,CAG5B,IAFAgwB,EAAW3mB,EAAIrJ,GACfiwB,EAAW1Q,EAASvf,GACf8K,EAAI9K,EAAI,EAAG8K,GAAKoJ,IACjBgc,EAAO7mB,EAAIyB,GACXqlB,EAAO5Q,EAASzU,GAChBslB,EAAQL,EAAUG,EAAMF,GACpBI,EAAQ,GAJWtlB,IAKnBzB,EAAIyB,EAAI,GAAKolB,EACb3Q,EAASzU,EAAI,GAAKqlB,EAM1B9mB,EAAIyB,EAAI,GAAKklB,EACbzQ,EAASzU,EAAI,GAAKmlB,GAG1B,SAASI,GAAUhnB,EAAKkW,EAAUrL,EAAM4b,EAAIC,GACxC,IACIO,EAAIC,EAAIC,EACRC,EAAIC,EAAIC,EACRC,EAAKC,EAAKC,EACVZ,EAAMC,EACNY,EAAQC,EAAQC,EAAQC,EACxBlB,EAAUC,EAAUG,EAAOe,EAN3BC,EAAa,EAAGpxB,EAAI,EAQxB,OAAa,CACT,GAAI8vB,EAAK5b,GAAQ,GAEb,YADA2b,GAAcxmB,EAAKkW,EAAUrL,EAAM4b,EAAIC,GAG3CqB,EAAald,GAAS4b,EAAK5b,GAAS,GACpCoc,EAAKjnB,EAAI6K,GACTuc,EAAKlR,EAASrL,GACdqc,EAAKlnB,EAAIymB,EAAK,GACdY,EAAKnR,EAASuQ,EAAK,GACnBU,EAAKnnB,EAAI+nB,GACTT,EAAKpR,EAAS6R,GACdR,EAAMb,EAAUO,EAAIC,GAChBK,EAAM,IACNV,EAAOI,EACPH,EAAOM,EACPH,EAAKC,EACLE,EAAKC,EACLH,EAAKL,EACLQ,EAAKP,GAETU,EAAMd,EAAUO,EAAIE,GAChBK,GAAO,GACPX,EAAOI,EACPH,EAAOM,EACPH,EAAKE,EACLC,EAAKE,EACLH,EAAKD,EACLI,EAAKD,EACLH,EAAKL,EACLQ,EAAKP,IAGLW,EAAMf,EAAUQ,EAAIC,GAChBM,EAAM,IACNZ,EAAOK,EACPJ,EAAOO,EACPH,EAAKC,EACLE,EAAKC,EACLH,EAAKN,EACLS,EAAKR,IAGb9mB,EAAI6K,GAAQoc,EACZ/Q,EAASrL,GAAQuc,EACjBpnB,EAAIymB,EAAK,GAAKU,EACdjR,EAASuQ,EAAK,GAAKa,EACnBI,EAASR,EACTS,EAASN,EACTO,EAAS/c,EAAO,EAChBgd,EAAYpB,EAAK,EACjBzmB,EAAI+nB,GAAc/nB,EAAI4nB,GACtB1R,EAAS6R,GAAc7R,EAAS0R,GAChC5nB,EAAI4nB,GAAUF,EACdxR,EAAS0R,GAAUD,EACnBK,EAAW,IAAKrxB,EAAIixB,EAAS,EAAGjxB,EAAIkxB,EAAWlxB,IAI3C,GAHAgwB,EAAW3mB,EAAIrJ,GACfiwB,EAAW1Q,EAASvf,GACpBowB,EAAQL,EAAUC,EAAUe,GACxBX,EAAQ,EACR/mB,EAAIrJ,GAAKqJ,EAAI4nB,GACb1R,EAASvf,GAAKuf,EAAS0R,GACvB5nB,EAAI4nB,GAAUjB,EACdzQ,EAAS0R,GAAUhB,EACnBgB,SAEC,GAAIb,EAAQ,EAAG,CAChB,EAAG,CAGC,GAFAc,IAEIA,GAAalxB,EACb,MAAMqxB,EAEVF,EAAc9nB,EAAI6nB,GAClBd,EAAQL,EAAUoB,EAAaJ,SAC1BX,EAAQ,GACjB/mB,EAAIrJ,GAAKqJ,EAAI6nB,GACb3R,EAASvf,GAAKuf,EAAS2R,GACvB7nB,EAAI6nB,GAAalB,EACjBzQ,EAAS2R,GAAajB,EAClBG,EAAQ,IACRJ,EAAW3mB,EAAIrJ,GACfiwB,EAAW1Q,EAASvf,GACpBqJ,EAAIrJ,GAAKqJ,EAAI4nB,GACb1R,EAASvf,GAAKuf,EAAS0R,GACvB5nB,EAAI4nB,GAAUjB,EACdzQ,EAAS0R,GAAUhB,EACnBgB,KAIRnB,EAAKoB,EAAYD,EAAS/c,GAC1Bmc,GAAUhnB,EAAKkW,EAAU2R,EAAWpB,EAAIC,GACxCD,EAAKmB,IAGLZ,GAAUhnB,EAAKkW,EAAUrL,EAAM+c,EAAQlB,GACvC7b,EAAOgd,IAInB,MAAM,GAAQvsB,MAAM/C,UACd0vB,GAAQ,GAAMjnB,KACdknB,GAAW,GAAMC,QACjBC,GAAO,GAAMtd,IACbud,GAAS,GAAMC,MACfC,GAAU,GAAMxV,OAChByV,GAAW,GAAMC,QACjBC,GAAQ,GAAM3W,KAEd4W,GAAU,CAAC,OAAQ,UAAW,MAAO,QAAS,SAAU,UAAW,QACnEC,GAAU,CAEZ5nB,KAAM,YAAa/H,GACf,IAAI6oB,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EACA,OAAO6wB,GAAM5Q,MAAMyK,EAAO7oB,GAE9B,MAAM+F,EAAM8iB,EAAMrmB,OACZotB,EAAW5vB,EAAKwC,OACtB,GAAiB,IAAbotB,EACA,OAAO7pB,EAEX8iB,EAAMrmB,OAASrE,EAAE8e,SAASza,OAASuD,EAAM6pB,EACzC,IAAIlyB,EAAIqI,EACR,KAAOrI,EAAImrB,EAAMrmB,QACbqmB,EAAMnrB,GAAKsC,EAAKtC,EAAIqI,GACpB5H,EAAE8e,SAASvf,IAAM,EACjBA,IAGJ,OADAS,EAAE0xB,SACKhH,EAAMrmB,QAGjB0sB,QAAS,YAAalvB,GAClB,IAAI6oB,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EACA,OAAO8wB,GAAS7Q,MAAMyK,EAAO7oB,GAEjC,MAAM4vB,EAAW5vB,EAAKwC,OAChBstB,EAAU,IAAIztB,MAAMutB,GAC1B,IAAIlyB,EAAI,EACR,KAAOA,EAAIkyB,GACPE,EAAQpyB,MAAQ,EAEpBuxB,GAAS7Q,MAAMjgB,EAAE8e,SAAU6S,GAC3B,MAAM/pB,EAAMkpB,GAAS7Q,MAAMyK,EAAO7oB,GAElC,OADA7B,EAAE0xB,SACK9pB,GAGX8L,IAAK,WACD,IAAIgX,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EACA,OAAOgxB,GAAKtxB,KAAKgrB,GAErB,MAAM5L,EAAW9e,EAAE8e,SACb8S,EAAUZ,GAAKtxB,KAAKgrB,GAEpBzb,EAAQ6P,EAASza,OAAS,EAMhC,OALIya,EAAS7P,IAAU,GACnB6P,EAAS+P,aAAajlB,KAAKkV,EAAS7P,IAExC+hB,GAAKtxB,KAAKof,GACV9e,EAAE0xB,SACKE,GAGXV,MAAO,WACH,IAAIxG,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EACA,OAAOixB,GAAOvxB,KAAKgrB,GAEvB,MAAM5L,EAAW9e,EAAE8e,SACb8S,EAAUX,GAAOvxB,KAAKgrB,GAO5B,OALI5L,EAAS,IAAM,GACfA,EAAS+P,aAAajlB,KAAKkV,EAAS,IAExCmS,GAAOvxB,KAAKof,GACZ9e,EAAE0xB,SACKE,GAGXjW,OAAQ,YAAa9Z,GACjB,MAAMgwB,EAAQhwB,EAAK,GACbiwB,EAAcjwB,EAAK,GACzB,IAAI6oB,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EACA,OAAOmxB,GAAQlR,MAAMyK,EAAO7oB,GAEhC,MAAM+F,EAAMmC,KAAK1F,OACX0tB,EAAwB,EAARF,EAChBG,EAAcD,EAAgB,EAAIE,KAAKC,IAAKtqB,EAAMmqB,EAAgB,GAAKE,KAAKE,IAAIJ,EAAenqB,GAC/FkX,EAAW9e,EAAE8e,SACb2S,EAAW5vB,EAAKwC,OAChB+tB,EAAiC,IAAbX,EAAiB,EAAiB,IAAbA,EAAiB7pB,EAAMoqB,EAAcF,EACpF,GAAIM,EAAoB,EAAG,CACvB,IAAI7yB,EAAIyyB,EACR,MAAM3C,EAAK9vB,EAAI6yB,EACf,KAAO7yB,EAAI8vB,GACHvQ,EAASvf,IAAM,GACfuf,EAAS+P,aAAajlB,KAAKkV,EAASvf,IAExCA,IAGR,GAAIkyB,EAAW,EAAG,CACd,MAAMY,EAAYZ,EAAW,EACvBE,EAAU,IAAIztB,MAAMmuB,GAC1B,IAAI9yB,EAAI,EACR,KAAOA,EAAI8yB,GACPV,EAAQpyB,MAAQ,EAEpB4xB,GAAQzxB,KAAKof,EAAU+S,EAAOC,KAAgBH,QAG9CR,GAAQlR,MAAMnB,EAAUjd,GAE5B,MAAMywB,EAAUnB,GAAQlR,MAAMyK,EAAO7oB,GAErC,OADA7B,EAAE0xB,SACKY,GAGXjB,QAAS,WACL,IAAI3G,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EAEA,OADAoxB,GAAS1xB,KAAKgrB,GACP3gB,KAEX,MAAMnC,EAAM8iB,EAAMrmB,OACZkuB,EAAU3qB,EAAM,EAAK,EAC3B,IAAI4qB,EAAQ,EACZ,KAAOA,IAAUD,GAAQ,CACrB,MAAME,EAAQ7qB,EAAM4qB,EAAQ,EACtBE,EAAahI,EAAM8H,GACnBG,EAAa3yB,EAAE8e,SAAS0T,GACxBI,EAAalI,EAAM+H,GACnBI,EAAa7yB,EAAE8e,SAAS2T,GAC9B/H,EAAM8H,GAASI,EACf5yB,EAAE8e,SAAS0T,GAASK,EACpBnI,EAAM+H,GAASC,EACf1yB,EAAE8e,SAAS2T,GAASE,EACpBH,IAGJ,OADAxyB,EAAE0xB,SACK3nB,MAIX4Q,KAAM,SAAU2U,GACZ,IAAI5E,EAAQ3gB,UACO,IAAf2gB,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAIgvB,GAAe5uB,IAAIsqB,GAC7B,QAAU,IAAN1qB,EAEA,OADAsxB,GAAM5xB,KAAKgrB,EAAO4E,GACXvlB,KAEX,MAAMnC,EAAM8iB,EAAMrmB,OAClB,GAAIuD,EAAM,EACN,OAAOmC,KAEX6lB,GAAUlF,EAAO1qB,EAAE8e,SAAU,EAAGlX,EAAKunB,IACrC,IAAI5vB,EAAI,EACR,KAAOA,EAAIqI,QACU,IAAb8iB,EAAMnrB,IAGVA,IAOJ,YALkB,IAAd+vB,GAA6C,mBAAdA,IAC/BA,EAAYL,IAEhBW,GAAUlF,EAAO1qB,EAAE8e,SAAU,EAAGvf,EAAG+vB,GACnCtvB,EAAE0xB,SACK3nB,OAGT+oB,GAAkB,CACpBtsB,UAAU,EACVrG,YAAY,EACZsG,cAAc,GAEZ,GAAMF,QAAQrG,eACpB,IAAK,MAAM6yB,KAAUxB,GACjB,GAAIC,GAAQuB,GAAS,YAAa,CAAEvyB,OAAO,EAAMgG,UAAU,EAAOC,cAAc,EAAOtG,YAAY,IAEvG,IAAI6yB,IAA+B,EAenC,IAAI,GAAgB,MAChB,YAAY5U,EAAOsC,EAAWvW,GACrB6oB,KACDA,IAA+B,EAjBpC,WACH,IAAK,MAAMD,KAAUxB,IACe,IAA5B,GAAMwB,GAAQhQ,WACd,GAAI,GAAOgQ,EAAQ,IAAKD,GAAiBtyB,MAAOgxB,GAAQuB,KAexDE,IAEJlpB,KAAKqV,SAAU,EACfrV,KAAKmpB,eAAiB,GACtBnpB,KAAKopB,WAAahpB,EAClBJ,KAAKiZ,gBAA0B,WAAR5E,EACvBrU,KAAK+U,SAAW8P,GAAezkB,EAAM9F,QACrC0F,KAAK2W,UAAYA,EACjB3W,KAAKqpB,oBAAiB,EACtBpE,GAAelsB,IAAIqH,EAAOJ,MAE9B,SACQA,KAAK2W,UAAUkC,MAAM5I,MAAQ,EACxBjQ,KAAKqV,UACNrV,KAAKqV,SAAU,EACfrV,KAAK2W,UAAUkC,MAAMjd,IAAIoE,OAI7BA,KAAK8Y,WAAW,GAGxB,oBAII,YAH4B,IAAxB9Y,KAAKqpB,iBACLrpB,KAAKqpB,eAAiB,IAAIrE,GAAyBhlB,KAAKopB,aAErDppB,KAAKqpB,eAEhB,iBAAiBnkB,GACb,OAAOlF,KAAKspB,yBAAyBpkB,GAEzC,WAAWmP,GACPrU,KAAKqV,SAAU,EACf,MAAMN,EAAW/U,KAAK+U,SAChBza,EAAS0F,KAAKopB,WAAW9uB,OAC/B0F,KAAK+U,SAAW8P,GAAevqB,GAC/B0F,KAAK6S,0BAA0BkC,EAAU,GAAgC/U,KAAKiZ,sBAClD,IAAxBjZ,KAAKqpB,gBACLrpB,KAAKqpB,eAAelQ,SAAS7e,EAAQ,IAM7C,iBAAiBivB,GACbvpB,KAAKyS,wBAAwB8W,GAKjC,oBAAoBA,GAChBvpB,KAAK0S,2BAA2B6W,GAKpC,yBAAyBrkB,GACrB,MAAMikB,EAAiBnpB,KAAKmpB,eAC5B,IAAIxM,EAAWwM,EAAejkB,GAI9B,YAHiB,IAAbyX,IACAA,EAAWwM,EAAejkB,GAAS,IAAIskB,GAAmBxpB,KAAMkF,IAE7DyX,IAGf,GAAgB,GAAW,CACvBpK,IACA,GAAW,oBAAqB,CAAC8G,OAAQnjB,OAAQA,UAClD,IAEH,IAAIszB,GAAqB,MACrB,YAAYC,EAAOvkB,GACflF,KAAKypB,MAAQA,EACbzpB,KAAKkF,MAAQA,EACblF,KAAK0pB,gBAAkB,EACvB1pB,KAAK+Y,aAAe/Y,KAAKkZ,WAE7B,WACI,OAAOlZ,KAAKypB,MAAML,WAAWppB,KAAKkF,OAEtC,SAASiP,EAAUE,GACf,GAAIF,IAAanU,KAAKkZ,WAClB,OAEJ,MAAMyQ,EAAgB3pB,KAAKypB,MACrBvkB,EAAQlF,KAAKkF,MACb6P,EAAW4U,EAAc5U,SAC3BA,EAAS7P,IAAU,GACnB6P,EAAS+P,aAAajlB,KAAKkV,EAAS7P,IAExC6P,EAAS7P,IAAU,EAGnBykB,EAAcP,WAAWlkB,GAASiP,EAClCwV,EAAchC,SAKlB,uBAAuB5S,EAAUV,GAC7B,MAAMnP,EAAQlF,KAAKkF,MAEnB,GADiB6P,EAAS7P,KAAWA,EAEjC,OAEJ,MAAM0kB,EAAY5pB,KAAK+Y,aACjB8Q,EAAY7pB,KAAK+Y,aAAe/Y,KAAKkZ,WAEvC0Q,IAAcC,GACd7pB,KAAKqS,gBAAgBwX,EAAWD,EAAWvV,GAGnD,UAAUrB,GACFhT,KAAKiS,cAAce,IAA0C,KAAzBhT,KAAK0pB,iBACzC1pB,KAAKypB,MAAMK,iBAAiB9pB,MAGpC,YAAYgT,GACJhT,KAAKkS,iBAAiBc,IAA0C,KAAzBhT,KAAK0pB,iBAC5C1pB,KAAKypB,MAAMM,oBAAoB/pB,QASpC,SAASgqB,GAAiB3V,EAAOsC,EAAWvW,GAC/C,MAAMuc,EAAWsI,GAAe5uB,IAAI+J,GACpC,YAAiB,IAAbuc,EACO,IAAI,GAActI,EAAOsC,EAAWvW,GAExCuc,EAVX6M,GAAqB,GAAW,CAC5BzX,IACA,GAAW,oBAAqB,CAAC,GAAesH,UACjDmQ,IC9gBH,IAAI,GAA0C,SAAUvvB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IA6B1G,MAAMif,GAA2B,CAAEC,QAAQ,EAAOC,UAAU,GAqB5D,IAAIC,GAAuB,MACvB,YAAY7tB,EAAK/D,EAAa6B,GAC1B2F,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAK3F,WAAaA,EAClB2F,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKgZ,WAAY,EAErB,SAAS7E,GAELnU,KAAK3F,WAAWtB,IAAIpD,KAAKqK,KAAKzD,IAAK4X,GAC/BnU,KAAK+Y,eAAiB5E,IACtBnU,KAAKuV,SAAWvV,KAAK+Y,aACrB/Y,KAAK+Y,aAAe5E,EACpBnU,KAAKqS,gBAAgB8B,EAAUnU,KAAKuV,SAAU,KAGtD,UAAUvC,GACDhT,KAAKgZ,WACNhZ,KAAKqqB,kBAETrqB,KAAKiS,cAAce,GAEvB,YAAYA,GACRhT,KAAKkS,iBAAiBc,GAE1B,kBACIhT,KAAKgZ,WAAY,EACjBhZ,KAAK+Y,aAAe/Y,KAAKzD,IAAIyD,KAAKxH,aAElCgE,QAAQrG,eAAe6J,KAAKzD,IAAKyD,KAAKxH,YAAa,CAAEO,IADxCob,IAAenU,KAAKmZ,SAAShF,IACgB9d,IAAK2J,KAAK3F,WAAWhE,QAGvF+zB,GAAuB,GAAW,CAC9BrY,IACA,GAAW,oBAAqB,CAAC7b,OAAQkC,OAAQlC,UAClDk0B,IAIH,IAAI,GAAiB,MACjB,YAAY/V,EAAOiW,EAAW/tB,EAAK/D,EAAa6B,EAAY2iB,GACxDhd,KAAKsqB,UAAYA,EACjBtqB,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAK3F,WAAaA,EAClB2F,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKuqB,aAAe,GACpBvqB,KAAKwqB,eAAiB,GACtBxqB,KAAK0pB,gBAAkB,EACvB1pB,KAAKyqB,cAAe,EACpBzqB,KAAKmV,MAAQ,IAAIK,MAAMjZ,EAAKmuB,GAAkBrW,EAAO2I,EAAiBhd,OAEtExD,QAAQrG,eAAeoG,EAAK/D,EAAa,CAAEnC,IAD/B,IAAM2J,KAAKkZ,WACyBngB,IAAKsB,EAAWtB,MAEpE,eAAe4xB,GACN3qB,KAAKuqB,aAAapb,SAASwb,IAC5B3qB,KAAKuqB,aAAa1qB,KAAK8qB,GAG/B,iBAAiBA,GACR3qB,KAAKwqB,eAAerb,SAASwb,IAC9B3qB,KAAKwqB,eAAe3qB,KAAK8qB,GAGjC,WASI,OARI3qB,KAAK0pB,gBAAkB,GAAK1pB,KAAKyqB,aAEjCzqB,KAAK+Y,aAAevc,QAAQ0Z,MAAMlW,KAAK3F,WAAWhE,IAAK2J,KAAKmV,MAAO,IAAS/V,YAI5EY,KAAK+Y,aAAevc,QAAQ0Z,MAAMlW,KAAK3F,WAAWhE,IAAK2J,KAAKzD,IAAK,IAAS6C,YAEvEY,KAAK+Y,aAEhB,UAAU/F,GACNhT,KAAKiS,cAAce,GACY,KAAzBhT,KAAK0pB,iBACP1pB,KAAK4qB,gCAA+B,GAG5C,YAAY5X,GACRhT,KAAKkS,iBAAiBc,GACS,KAAzBhT,KAAK0pB,iBACP1pB,KAAK6qB,6BAGb,eACI,MAAMtV,EAAWvV,KAAK+Y,aAChB5E,EAAWnU,KAAK4qB,gCAA+B,GACjDrV,IAAapB,GACbnU,KAAKqS,gBAAgB8B,EAAUoB,EAAU,IAGjD,yBACI,MAAMA,EAAWvV,KAAK+Y,aAChB5E,EAAWnU,KAAK4qB,gCAA+B,GACjDrV,IAAapB,GACbnU,KAAKqS,gBAAgB8B,EAAUoB,EAAU,IAGjD,+BAA+BuV,GAC3B,MAAMvjB,GAAuBvH,KAAKsqB,UAAUJ,QAAUY,EAWtD,OAVIvjB,IACAvH,KAAK6qB,6BACL7qB,KAAKyqB,cAAe,GAExBzqB,KAAK+Y,aAAe/Y,KAAKkZ,WACrB3R,IACAvH,KAAKuqB,aAAa1Z,QAAQ3G,IAAOA,EAAE4H,UAAU9R,QAC7CA,KAAKwqB,eAAe3Z,QAAQ3G,IAAOA,EAAE4I,sBAAsB9S,QAC3DA,KAAKyqB,cAAe,GAEjBzqB,KAAK+Y,aAEhB,aAAajf,EAAQ/C,EAAK8e,GACtB,OAAQ7V,KAAKyqB,cACE,eAAR1zB,GACQ,eAARA,GACQ,gBAARA,EAEX,6BACIiJ,KAAKuqB,aAAa1Z,QAAQ3G,IAAOA,EAAEoI,YAAYtS,QAC/CA,KAAKuqB,aAAajwB,OAAS,EAC3B0F,KAAKwqB,eAAe3Z,QAAQ3G,IAAOA,EAAE6I,0BAA0B/S,QAC/DA,KAAKwqB,eAAelwB,OAAS,IAGrC,GAAiB,GAAW,CACxByX,IACA,GAAW,oBAAqB,CAACsH,OAAQnjB,OAAQA,OAAQkC,OAAQlC,OAAQA,UAC1E,IAEH,MAAM,GAAcA,OAAOkB,UAAUkB,SAIrC,SAASoyB,GAAkBrW,EAAO2I,EAAiBL,GAC/C,MAAO,CACHtmB,IAAK,SAAUyD,EAAQ/C,EAAK8e,GACxB,GAAI8G,EAASoO,aAAajxB,EAAQ/C,EAAK8e,GACnC,OAAOrZ,QAAQnG,IAAIyD,EAAQ/C,EAAK8e,GAIpC,OAAQ,GAAYlgB,KAAKmE,IACrB,IAAK,iBACD,GAAY,WAAR/C,GAAoB,YAAaA,GAEjC,OADA4lB,EAASqO,iBAAiBhO,EAAgBgN,iBAAiB3V,EAAOva,IAC3DmxB,GAAa5W,EAAOva,EAAQ/C,EAAKimB,EAAiBL,GAE7D,MACJ,IAAK,eACD,GAAY,SAAR5lB,EAEA,OADA4lB,EAASqO,iBAAiBhO,EAAgBkO,eAAe7W,EAAOva,IACzD0C,QAAQnG,IAAIyD,EAAQ/C,EAAK+C,GAEpC,MACJ,IAAK,eACD,GAAY,SAAR/C,EAEA,OADA4lB,EAASqO,iBAAiBhO,EAAgBmO,eAAe9W,EAAOva,IACzD0C,QAAQnG,IAAIyD,EAAQ/C,EAAK+C,GAK5C,OADA6iB,EAASyO,eAAepO,EAAgBC,YAAY5I,EAAOva,EAAQ/C,IAC5Dk0B,GAAa5W,EAAOva,EAAQ/C,EAAKimB,EAAiBL,KAOrE,SAASsO,GAAa5W,EAAOva,EAAQ/C,EAAKimB,EAAiBL,GACvD,MAAMlmB,EAAQ+F,QAAQnG,IAAIyD,EAAQ/C,EAAK+C,GACvC,MAAqB,iBAAVrD,GAAuC,mBAAVA,GAAkC,OAAVA,EACrDA,EAEJ,IAAI+e,MAAM/e,EAAOi0B,GAAkBrW,EAAO2I,EAAiBL,I,YC9OlE,GAA0C,SAAU1iB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAKpD,MAAMmgB,GAAgB,IAAGvlB,gBAAgB,iBAAiBP,YAAY2E,GAAKA,EAAEjG,UAAU,KACjFqnB,GAAqB,CAS9BC,eAAgB,EAOhBC,UAAU,EAMVrd,MAAM,EAMNsd,OAAO,EAIP,iBACIzrB,KAAKurB,eAAiB,EACtBvrB,KAAKwrB,UAAW,EAChBxrB,KAAKmO,MAAO,EACZnO,KAAKyrB,OAAQ,IAIrB,IAAI,GAAe,MACf,YAAYC,GACR1rB,KAAK0rB,UAAYA,EACjB1rB,KAAK2rB,QAAU,GACf3rB,KAAK4rB,KAAO,KACZ5rB,KAAK6rB,cAAgB,EAEzB,eAAetvB,EAAKwgB,GAChB,GAAIuO,GAAmBG,MACnB,MAAM,IAAS9pB,MAAM,IAAKob,GAK9B,OAHIuO,GAAmBnd,MACnB,IAASjG,MAAM,IAAK6U,GAEjB,IAAI+O,GAAmB9rB,KAAMzD,EAAKwgB,GAE7C,YAAY5lB,GACR6I,KAAK2rB,QAAQ9rB,KAAK1I,GACU,IAAxB6I,KAAK2rB,QAAQrxB,SACb0F,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKgsB,QAAS,CAAEC,YAAY,KAGrF,eAAe90B,GACX6I,KAAK2rB,QAAQ/Z,OAAO5R,KAAK2rB,QAAQ1iB,QAAQ9R,GAAW,GACxB,IAAxB6I,KAAK2rB,QAAQrxB,SACb0F,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,MAGpB,MAAMO,GACF,GAAIb,GAAmBE,SACnB,OAEJ,KAAMxrB,KAAK6rB,cAAgBP,GAAmBC,eAC1C,OAEJvrB,KAAK6rB,cAAgB,EACrB,MAAMF,EAAU3rB,KAAK2rB,QACf9tB,EAAM8tB,EAAQrxB,OACpB,IAAIsO,EACApT,EAAI,EACR,KAAOA,EAAIqI,IAAOrI,EACdoT,EAAU+iB,EAAQn2B,GACdoT,EAAQwjB,WACRxjB,EAAQyjB,MAAM,OAK9B,GAAe,GAAW,CACtB,GAAQ,EAAG,MACX,GAAW,oBAAqB,CAACn2B,UAClC,IAEH,IAAI41B,GAAqB,MACrB,YAAYQ,EAAc/vB,EAAK/D,GAC3BwH,KAAKssB,aAAeA,EACpBtsB,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EAEvB,UACI,OAAOwH,KAAKuV,WAAavV,KAAKzD,IAAIyD,KAAKxH,aAE3C,MAAM6b,GACF,MAAMkB,EAAWvV,KAAKuV,SAChBpB,EAAWnU,KAAKzD,IAAIyD,KAAKxH,aAC/BwH,KAAKqS,gBAAgB8B,EAAUoB,EAAkB,GAARlB,GACzCrU,KAAKuV,SAAWpB,EAEpB,UAAUnB,GACDhT,KAAKoS,mBACNpS,KAAKuV,SAAWvV,KAAKzD,IAAIyD,KAAKxH,aAC9BwH,KAAKssB,aAAaC,YAAYvsB,OAElCA,KAAKiS,cAAce,GAEvB,YAAYA,GACJhT,KAAKkS,iBAAiBc,KAAgBhT,KAAKoS,kBAC3CpS,KAAKssB,aAAaE,eAAexsB,QAI7C8rB,GAAqB,GAAW,CAC5B/Z,IACA,GAAW,oBAAqB,CAAC7b,OAAQA,OAAQkC,UAClD0zB,IC7IH,IAMI,GAA0C,SAAUpyB,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAG1G,IAAIyhB,GAAyB,MACzB,YAAYlwB,GACRyD,KAAKzD,IAAMA,EACXyD,KAAK+Y,aAAexc,EAAIknB,KAE5B,WACI,OAAOzjB,KAAKzD,IAAIknB,KAEpB,SAAStP,EAAUE,GACf,MAAM,aAAE0E,GAAiB/Y,KACrBmU,IAAa4E,IACb/Y,KAAK+Y,aAAe5E,EACpBnU,KAAKqS,gBAAgB8B,EAAU4E,EAAsB,GAAR1E,MAIzDoY,GA1B8C,SAAUxyB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAsBvC,CAAW,CAChCyb,IACA,GAAW,oBAAqB,CAAC7b,UAClCu2B,IC7BH,IAAI,GAA0C,SAAUxyB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAM1G,MAAM,GAAiB,IAAIrT,QACrB,GAAQmB,IAAI1B,UACZ,GAAO,GAAM2B,IACb2zB,GAAS,GAAMC,MACf7wB,GAAU,GAAMC,OAEhB,GAAU,CAAC,MAAO,QAAS,UAG3B,GAAU,CAEZhD,IAAK,SAAUhC,EAAKN,GAChB,IAAIkqB,EAAQ3gB,UACOmF,IAAfwb,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAI,GAAeI,IAAIsqB,GAC7B,QAAUxb,IAANlP,EAEA,OADA,GAAKN,KAAKgrB,EAAO5pB,EAAKN,GACfuJ,KAEX,MAAMuV,EAAWoL,EAAMtqB,IAAIU,GACrB61B,EAAUjM,EAAM8C,KAGtB,GAFA,GAAK9tB,KAAKgrB,EAAO5pB,EAAKN,GACNkqB,EAAM8C,OACNmJ,EAAS,CACrB,IAAIp3B,EAAI,EACR,IAAK,MAAMmuB,KAAShD,EAAMiD,UAAW,CACjC,GAAID,EAAM,KAAO5sB,EAMb,OALI4sB,EAAM,KAAOpO,IACbtf,EAAE8e,SAAS+P,aAAajlB,KAAK5J,EAAE8e,SAASvf,IACxCS,EAAE8e,SAASvf,IAAM,EACjBS,EAAE0xB,UAEC3nB,KAEXxK,IAEJ,OAAOwK,KAIX,OAFA/J,EAAE8e,SAAS6X,IAAY,EACvB32B,EAAE0xB,SACK3nB,MAGX2sB,MAAO,WACH,IAAIhM,EAAQ3gB,UACOmF,IAAfwb,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAI,GAAeI,IAAIsqB,GAC7B,QAAUxb,IAANlP,EACA,OAAOy2B,GAAO/2B,KAAKgrB,GAGvB,GADaA,EAAM8C,KACR,EAAG,CACV,MAAM1O,EAAW9e,EAAE8e,SACnB,IAAIvf,EAAI,EACR,IAAK,MAAMmuB,KAAShD,EAAMnnB,OAClBub,EAASvf,IAAM,GACfuf,EAAS+P,aAAajlB,KAAKkV,EAASvf,IAExCA,IAEJk3B,GAAO/2B,KAAKgrB,GACZ5L,EAASza,OAAS,EAClBrE,EAAE0xB,WAKV5rB,OAAQ,SAAUtF,GACd,IAAIkqB,EAAQ3gB,UACOmF,IAAfwb,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAI,GAAeI,IAAIsqB,GAC7B,QAAUxb,IAANlP,EACA,OAAO6F,GAAQnG,KAAKgrB,EAAOlqB,GAG/B,GAAa,IADAkqB,EAAM8C,KAEf,OAAO,EAEX,IAAIjuB,EAAI,EACR,MAAMuf,EAAW9e,EAAE8e,SACnB,IAAK,MAAM4O,KAAShD,EAAMnnB,OAAQ,CAC9B,GAAImqB,IAAUltB,EAAO,CACbse,EAASvf,IAAM,GACfuf,EAAS+P,aAAajlB,KAAKkV,EAASvf,IAExCuf,EAASnD,OAAOpc,EAAG,GACnB,MAAMq3B,EAAe/wB,GAAQnG,KAAKgrB,EAAOlqB,GAIzC,OAHqB,IAAjBo2B,GACA52B,EAAE0xB,SAECkF,IAETr3B,EAEN,OAAO,IAGT,GAAkB,CACpBiH,UAAU,EACVrG,YAAY,EACZsG,cAAc,GAEZ,GAAMF,QAAQrG,eACpB,IAAK,MAAM6yB,KAAU,GACjB,GAAI,GAAQA,GAAS,YAAa,CAAEvyB,OAAO,EAAMgG,UAAU,EAAOC,cAAc,EAAOtG,YAAY,IAEvG,IAAI02B,IAA6B,EAenB3yB,MAAM/C,UAAUsH,MAC9B,IAAI,GAAc,MACd,YAAY2V,EAAOsC,EAAWxe,GACrB20B,KACDA,IAA6B,EAlBlC,WACH,IAAK,MAAM9D,KAAU,IACe,IAA5B,GAAMA,GAAQhQ,WACd,GAAI,GAAOgQ,EAAQ,IAAK,GAAiBvyB,MAAO,GAAQuyB,KAgBxD+D,IAEJ/sB,KAAKqV,SAAU,EACfrV,KAAKopB,WAAajxB,EAClB6H,KAAKiZ,gBAA0B,WAAR5E,EACvBrU,KAAK+U,SAAW8P,GAAe1sB,EAAIsrB,MACnCzjB,KAAK2W,UAAYA,EACjB3W,KAAKqpB,oBAAiB,EACtB,GAAetwB,IAAIZ,EAAK6H,MAE5B,SACQA,KAAK2W,UAAUkC,MAAM5I,MAAQ,EACxBjQ,KAAKqV,UACNrV,KAAKqV,SAAU,EACfrV,KAAK2W,UAAUkC,MAAMjd,IAAIoE,OAI7BA,KAAK8Y,WAAW,GAGxB,oBAII,YAH4B,IAAxB9Y,KAAKqpB,iBACLrpB,KAAKqpB,eAAiB,IAAIoD,GAAuBzsB,KAAKopB,aAEnDppB,KAAKqpB,eAEhB,iBAAiBnkB,GACb,MAAM,IAAIzE,MAAM,uCAEpB,WAAW4T,GACPrU,KAAKqV,SAAU,EACf,MAAM,SAAEN,EAAQ,WAAEqU,GAAeppB,MAC3B,KAAEyjB,GAAS2F,EACjBppB,KAAK+U,SAAW8P,GAAepB,GAC/BzjB,KAAK6S,0BAA0BkC,EAAU,GAAgC/U,KAAKiZ,sBAClD,IAAxBjZ,KAAKqpB,gBACLrpB,KAAKqpB,eAAelQ,SAASsK,EAAM,MASxC,SAASyH,GAAe7W,EAAOsC,EAAWxe,GAC7C,MAAMwkB,EAAW,GAAetmB,IAAI8B,GACpC,YAAiB,IAAbwkB,EACO,IAAI,GAAYtI,EAAOsC,EAAWxe,GAEtCwkB,EAVX,GAAc,GAAW,CACrBpK,IACA,GAAW,oBAAqB,CAAC8G,OAAQnjB,OAAQA,UAClD,IC5LWiE,MAAM/C,UAAUsH,MAA9B,MACMsuB,GAAO,IAASA,KAIf,MAAMC,GACT,YAAY1wB,EAAK/D,GACbwH,KAAKktB,YAAa,EAEE,WAAhB10B,GAEAwH,KAAKzD,IAAMA,EACXyD,KAAKkZ,SAAWlZ,KAAKmtB,iBAGrBntB,KAAKkZ,SAAWlZ,KAAKotB,gBAG7B,kBACI,OAAOptB,KAAKzD,IAAIjC,OAEpB,oBAIJ2yB,GAAkB71B,UAAU+hB,SAAW6T,GACvCC,GAAkB71B,UAAU0a,UAAYkb,GACxCC,GAAkB71B,UAAUkb,YAAc0a,GAC1CC,GAAkB71B,UAAUwS,QAAUojB,GC7B/B,MAAMK,GACT,YAAY9wB,EAAK/D,GACbwH,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,OACI,IAAnB+D,EAAI0d,iBAC+B,IAAhC1d,EAAI0d,WAAWzhB,SAC0B,IAAzC+D,EAAI0d,WAAWzhB,GAAa2gB,WAC/BnZ,KAAKmZ,SAAWnZ,KAAKstB,gBAG7B,WACI,OAAOttB,KAAKzD,IAAIyD,KAAKxH,aAEzB,SAAS/B,EAAO4d,GACZrU,KAAKzD,IAAIyD,KAAKxH,aAAe/B,EAEjC,eAAeA,EAAO4d,GAClBrU,KAAKzD,IAAI0d,WAAWja,KAAKxH,aAAa2gB,SAAS1iB,EAAO4d,ICjB9D,IAAI,GAA0C,SAAUpa,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAM1G,MAAM,GAAiB,IAAIrT,QACrB,GAAQgE,IAAIvE,UACZm2B,GAAO,GAAM3xB,IACb,GAAS,GAAM+wB,MACf,GAAU,GAAM5wB,OAEhB,GAAU,CAAC,MAAO,QAAS,UAG3B,GAAU,CAEZH,IAAK,SAAUnF,GACX,IAAIkqB,EAAQ3gB,UACOmF,IAAfwb,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAI,GAAeI,IAAIsqB,GAC7B,QAAUxb,IAANlP,EAEA,OADAs3B,GAAK53B,KAAKgrB,EAAOlqB,GACVuJ,KAEX,MAAM4sB,EAAUjM,EAAM8C,KAGtB,OAFA8J,GAAK53B,KAAKgrB,EAAOlqB,GACDkqB,EAAM8C,OACNmJ,EACL5sB,MAEX/J,EAAE8e,SAAS6X,IAAY,EACvB32B,EAAE0xB,SACK3nB,OAGX2sB,MAAO,WACH,IAAIhM,EAAQ3gB,UACOmF,IAAfwb,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAI,GAAeI,IAAIsqB,GAC7B,QAAUxb,IAANlP,EACA,OAAO,GAAON,KAAKgrB,GAGvB,GADaA,EAAM8C,KACR,EAAG,CACV,MAAM1O,EAAW9e,EAAE8e,SACnB,IAAIvf,EAAI,EACR,IAAK,MAAMmuB,KAAShD,EAAMnnB,OAClBub,EAASvf,IAAM,GACfuf,EAAS+P,aAAajlB,KAAKkV,EAASvf,IAExCA,IAEJ,GAAOG,KAAKgrB,GACZ5L,EAASza,OAAS,EAClBrE,EAAE0xB,WAKV5rB,OAAQ,SAAUtF,GACd,IAAIkqB,EAAQ3gB,UACOmF,IAAfwb,EAAMlL,OACNkL,EAAQA,EAAMlL,MAElB,MAAMxf,EAAI,GAAeI,IAAIsqB,GAC7B,QAAUxb,IAANlP,EACA,OAAO,GAAQN,KAAKgrB,EAAOlqB,GAG/B,GAAa,IADAkqB,EAAM8C,KAEf,OAAO,EAEX,IAAIjuB,EAAI,EACR,MAAMuf,EAAW9e,EAAE8e,SACnB,IAAK,MAAM4O,KAAShD,EAAMnnB,OAAQ,CAC9B,GAAImqB,IAAUltB,EAAO,CACbse,EAASvf,IAAM,GACfuf,EAAS+P,aAAajlB,KAAKkV,EAASvf,IAExCuf,EAASnD,OAAOpc,EAAG,GACnB,MAAMq3B,EAAe,GAAQl3B,KAAKgrB,EAAOlqB,GAIzC,OAHqB,IAAjBo2B,GACA52B,EAAE0xB,SAECkF,EAEXr3B,IAEJ,OAAO,IAGT,GAAkB,CACpBiH,UAAU,EACVrG,YAAY,EACZsG,cAAc,GAEZ,GAAMF,QAAQrG,eACpB,IAAK,MAAM6yB,KAAU,GACjB,GAAI,GAAQA,GAAS,YAAa,CAAEvyB,OAAO,EAAMgG,UAAU,EAAOC,cAAc,EAAOtG,YAAY,IAEvG,IAAIo3B,IAA6B,EAenBrzB,MAAM/C,UAAUsH,MAC9B,IAAI,GAAc,MACd,YAAY2V,EAAOsC,EAAW8W,GACrBD,KACDA,IAA6B,EAlBlC,WACH,IAAK,MAAMxE,KAAU,IACe,IAA5B,GAAMA,GAAQhQ,WACd,GAAI,GAAOgQ,EAAQ,IAAK,GAAiBvyB,MAAO,GAAQuyB,KAgBxD0E,IAEJ1tB,KAAKqV,SAAU,EACfrV,KAAKopB,WAAaqE,EAClBztB,KAAKiZ,gBAA0B,WAAR5E,EACvBrU,KAAK+U,SAAW8P,GAAe4I,EAAYhK,MAC3CzjB,KAAK2W,UAAYA,EACjB3W,KAAKqpB,oBAAiB,EACtB,GAAetwB,IAAI00B,EAAaztB,MAEpC,SACQA,KAAK2W,UAAUkC,MAAM5I,MAAQ,EACxBjQ,KAAKqV,UACNrV,KAAKqV,SAAU,EACfrV,KAAK2W,UAAUkC,MAAMjd,IAAIoE,OAI7BA,KAAK8Y,WAAW,GAGxB,oBAII,YAH4B,IAAxB9Y,KAAKqpB,iBACLrpB,KAAKqpB,eAAiB,IAAIoD,GAAuBzsB,KAAKopB,aAEnDppB,KAAKqpB,eAEhB,iBAAiBnkB,GACb,MAAM,IAAIzE,MAAM,uCAEpB,WAAW4T,GACPrU,KAAKqV,SAAU,EACf,MAAM,SAAEN,EAAQ,WAAEqU,GAAeppB,MAC3B,KAAEyjB,GAAS2F,EACjBppB,KAAK+U,SAAW8P,GAAepB,GAC/BzjB,KAAK6S,0BAA0BkC,EAAU,GAAgC/U,KAAKiZ,sBAClD,IAAxBjZ,KAAKqpB,gBACLrpB,KAAKqpB,eAAelQ,SAASsK,EAAM,MASxC,SAAS0H,GAAe9W,EAAOsC,EAAW8W,GAC7C,MAAM9Q,EAAW,GAAetmB,IAAIo3B,GACpC,YAAiB,IAAb9Q,EACO,IAAI,GAAYtI,EAAOsC,EAAW8W,GAEtC9Q,EAVX,GAAc,GAAW,CACrBpK,IACA,GAAW,oBAAqB,CAAC8G,OAAQnjB,OAAQA,UAClD,IChLH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAc3D,MAAM,GAAchV,OAAOkB,UAAUkB,SACxBq1B,GAAmB,IAAG7nB,gBAAgB,oBAAoBR,YAC1DsoB,GAAyB,IAAG9nB,gBAAgB,0BAA0BR,YACtEuoB,GAAyB,IAAG/nB,gBAAgB,0BAA0BR,YAWnF,IAAI,GAAkB,MAClB,YAAYqR,EAAW+U,EAAWY,EAAcwB,EAAuBC,GACnE/tB,KAAK2W,UAAYA,EACjB3W,KAAK0rB,UAAYA,EACjB1rB,KAAKssB,aAAeA,EACpBtsB,KAAK8tB,sBAAwBA,EAC7B9tB,KAAK+tB,sBAAwBA,EAC7B/tB,KAAKguB,SAAW,GAEpB,gBAAgB3qB,GACZ,OAAO,IAAaY,UAAU0pB,GAAkB3tB,MAAMyF,SAASpC,GAEnE,YAAYgR,EAAO9X,EAAKwgB,GACpB,GAAY,EAAR1I,GAAgD,iBAAR9X,EACxC,OAAO,EAAc+Y,YAAY/Y,EAAKwgB,GAE1C,GA6IR,SAA0BxgB,GACtB,OAA0B,IAAnBA,EAAIid,WA9IHyU,CAAiB1xB,GACjB,OAAOA,EAAI2xB,aAAa7Z,GAAOiB,YAAYtV,KAAK2W,UAAWtC,EAAO9X,EAAKwgB,GAE3E,IAAIoR,EAAkB5xB,EAAI0d,WAC1B,GAAIkU,GAAmBpR,KAAgBoR,EACnC,OAAOA,EAAgBpR,GAE3B,MAAMJ,EAAW3c,KAAKouB,uBAAuB/Z,EAAO9X,EAAKwgB,GAOzD,OANKJ,EAASuQ,kBACc,IAApBiB,IACAA,EAAkBnuB,KAAKquB,2BAA2B9xB,IAEtD4xB,EAAgBpR,GAAgBJ,GAE7BA,EAEX,WAAW2R,GACPtuB,KAAKguB,SAASnuB,KAAKyuB,GAEvB,YAAYja,EAAO9X,EAAKwgB,GACpB,OAAI/c,KAAK+tB,sBAAsBliB,QAAQwI,EAAO9X,GACtCyD,KAAK8tB,sBAAsBS,kBAAkBla,EAAO9X,EAAKwgB,GAClD/c,KAAKid,YAAY5I,EAAO9X,EAAKwgB,GAEjC/c,KAAK+tB,sBAAsBS,YAAYna,EAAOrU,KAAK0rB,UAAW1rB,KAAK2W,UAAWpa,EAAKwgB,GAElF,EAAR1I,EACO,EAAciB,YAAY/Y,EAAKwgB,GAEnC,IAAIsQ,GAAiB9wB,EAAKwgB,GAErC,iBAAiB1I,EAAOoa,GACpB,OAAOzE,GAAiB3V,EAAOrU,KAAK2W,UAAW8X,GAEnD,eAAepa,EAAOqa,GAClB,OAAOxD,GAAe7W,EAAOrU,KAAK2W,UAAW+X,GAEjD,eAAera,EAAOoZ,GAClB,OAAOtC,GAAe9W,EAAOrU,KAAK2W,UAAW8W,GAEjD,2BAA2BlxB,GACvB,OAAOA,EAAI0d,YAAcja,KAAK2uB,sBAAsBpyB,GAExD,sBAAsBA,GAClB,MAAM9F,EAAQ,GASd,OARK+F,QAAQrG,eAAeoG,EAAK,aAAc,CAC3CnG,YAAY,EACZsG,cAAc,EACdD,UAAU,EACVhG,MAAOA,KAEP,IAASyR,MAAM,EAAG3L,GAEf9F,EAEX,mBAAmB4d,EAAO9X,EAAKwgB,EAAc1iB,GACzC,IAAK,IAAI7E,EAAI,EAAGkS,EAAK1H,KAAKguB,SAAS1zB,OAAQ9E,EAAIkS,EAAIlS,IAAK,CACpD,MACMmnB,EADU3c,KAAKguB,SAASx4B,GACLynB,YAAY5I,EAAO9X,EAAKwgB,EAAc1iB,GAC/D,GAAgB,MAAZsiB,EACA,OAAOA,EAGf,OAAO,KAEX,uBAAuBtI,EAAO9X,EAAKwgB,GAC/B,KAAMxgB,aAAerG,QACjB,OAAO,IAAI+2B,GAAkB1wB,EAAKwgB,GAEtC,IAAI6R,GAAS,EACb,GAAI5uB,KAAK8tB,sBAAsBjiB,QAAQwI,EAAO9X,GAAM,CAChD,MAAMogB,EAAW3c,KAAK8tB,sBAAsB7Q,YAAY5I,EAAOrU,KAAK0rB,UAAW1rB,KAAK2W,UAAW3W,KAAMzD,EAAKwgB,GAC1G,GAAgB,MAAZJ,EACA,OAAOA,EAEXiS,GAAS,EAGb,OADY,GAAYj5B,KAAK4G,IAEzB,IAAK,iBACD,GAAqB,WAAjBwgB,EACA,OAAO/c,KAAKgqB,iBAAiB3V,EAAO9X,GAAKsyB,oBAG7C,GAAI,YAAa9R,GACb,OAAO/c,KAAKgqB,iBAAiB3V,EAAO9X,GAAKuyB,iBAAiBzV,OAAO0D,IAErE,MACJ,IAAK,eACD,GAAqB,SAAjBA,EACA,OAAO/c,KAAKkrB,eAAe7W,EAAO9X,GAAKsyB,oBAE3C,MACJ,IAAK,eACD,GAAqB,SAAjB9R,EACA,OAAO/c,KAAKmrB,eAAe9W,EAAO9X,GAAKsyB,oBAInD,MAAMx0B,EA7Hd,SAA+B00B,EAASh5B,GACpC,IAAIi5B,EAAK94B,OAAO4U,yBAAyBikB,EAASh5B,GAC9C8K,EAAQ3K,OAAO8E,eAAe+zB,GAClC,KAAa,MAANC,GAAuB,MAATnuB,GACjBmuB,EAAK94B,OAAO4U,yBAAyBjK,EAAO9K,GAC5C8K,EAAQ3K,OAAO8E,eAAe6F,GAElC,OAAOmuB,EAsHgBC,CAAsB1yB,EAAKwgB,GAC9C,GAAkB,MAAd1iB,IAAyC,MAAlBA,EAAWhE,KAAiC,MAAlBgE,EAAWtB,KAAc,CAC1E,GAAsB,MAAlBsB,EAAWhE,KAA6C,MAA9BgE,EAAWhE,IAAI4mB,YACzC,OAAO5iB,EAAWhE,IAAI4mB,YAAY1gB,GAGtC,MAAM2yB,EAAkBlvB,KAAKmvB,mBAAmB9a,EAAO9X,EAAKwgB,EAAc1iB,GAC1E,OAAuB,MAAnB60B,EACOA,EAEPN,EAEO5uB,KAAKssB,aAAa8C,eAAe7yB,EAAKwgB,GP/HtD,SAAgC1I,EAAO2I,EAAiBsP,EAAc3V,EAAWlQ,EAAUsW,EAAc1iB,GAC5G,IAAgC,IAA5BA,EAAWqC,aACX,OAAO4vB,EAAa8C,eAAe3oB,EAAUsW,GAEjD,GAAsB,MAAlB1iB,EAAWhE,IAAa,CACxB,MAAQsP,aAAevO,WAAai4B,SAAUC,KAAuB7oB,EAE/D6jB,EAAYgF,GAAkBA,EAAevS,IAAiBkN,GACpE,OAAsB,MAAlB5vB,EAAWtB,IACPuxB,EAAUH,SACH,IAAI,GAAe9V,EAAOiW,EAAW7jB,EAAUsW,EAAc1iB,EAAY2iB,GAE7E,IAAIoN,GAAqB3jB,EAAUsW,EAAc1iB,GAErD,IAAI,GAAega,EAAOiW,EAAW7jB,EAAUsW,EAAc1iB,EAAY2iB,GAEpF,MAAM,IAASrb,MAAM,GAAIob,GOiHVwS,CAAuBlb,EAAOrU,KAAMA,KAAKssB,aAActsB,KAAK2W,UAAWpa,EAAKwgB,EAAc1iB,GAErG,OAAO,IAAI,EAAe2F,KAAK2W,UAAWtC,EAAO9X,EAAKwgB,KAYvD,SAASyS,GAAsBnb,EAAOsC,EAAWyS,GAGpD,MAAMqG,EAAgBrG,aAAsBlzB,OAAS,EAAc0f,cAAcwT,GAAcA,EAC/F,OAAQ,GAAYzzB,KAAKyzB,IACrB,IAAK,iBACD,OAAOY,GAAiB3V,EAAOsC,EAAW8Y,GAC9C,IAAK,eACD,OAAOvE,GAAe7W,EAAOsC,EAAW8Y,GAC5C,IAAK,eACD,OAAOtE,GAAe9W,EAAOsC,EAAW8Y,IAnBpD,GAAkB,GAAW,CACzB,GAAQ,EAAGhZ,GACX,GAAQ,EAAG,MACX,GAAQ,EAAG4U,IACX,GAAQ,EAAGuC,IACX,GAAQ,EAAGC,IACX,GAAW,oBAAqB,CAAC33B,OAAQA,OAAQA,OAAQA,OAAQA,UAClE,ICnLH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAS1G,MAAM,QAAE0kB,GAAO,OAAE7P,GAAM,SAAEC,IAAauE,GAEhCsL,GAAkB9P,GAAS6P,GACjC,IAAI,GAAkB,MAClB,YAAYE,EAAkB91B,EAAQ+1B,EAAgBl5B,EAAMqmB,EAAiBmB,GACzEne,KAAK4vB,iBAAmBA,EACxB5vB,KAAKlG,OAASA,EACdkG,KAAK6vB,eAAiBA,EACtB7vB,KAAKrJ,KAAOA,EACZqJ,KAAKgd,gBAAkBA,EACvBhd,KAAKme,QAAUA,EACfne,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdre,KAAKoe,YAAS,EACdpe,KAAK8vB,oBAAiB,EACtB9vB,KAAKiZ,gBAAkB,EACvBsE,GAAYC,WAAWxd,MACvBA,KAAK+vB,WAAa5R,EAAQ9nB,IAAIogB,GAGlC,aAAahgB,EAAO4d,GAChBA,GAASrU,KAAKiZ,gBACdjZ,KAAK8vB,eAAe3W,SAAS1iB,EAAO4d,GAExC,aAAa5d,EAAO4d,GAChBA,GAASrU,KAAKiZ,gBACdjZ,KAAK4vB,iBAAiBtyB,OAAO+W,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAAS1nB,EAAOuJ,KAAK2Z,MAE/E,aAAaxF,EAAU6b,EAAgB3b,GACnC,GAAwC,IAArB,EAAdrU,KAAKqe,QAAV,CAIA,IAAa,IADbhK,GAASrU,KAAKiZ,kBACgC,EAAG,CAC7C,MAAM7E,EAAgBpU,KAAK8vB,eAAe5W,WAa1C,OAXoC,QAAhClZ,KAAK4vB,iBAAiB7Q,OAAqC/e,KAAK4c,cAAgB,KAChFzI,EAAWnU,KAAK4vB,iBAAiBxQ,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,OAEjFxF,IAAaC,GACbpU,KAAKke,YAAYI,aAAanK,EAAUE,QAEd,IAAzBrU,KAAKrJ,KAAO+4B,MACb1vB,KAAK6c,UACL7c,KAAK4vB,iBAAiBvQ,QAAQhL,EAAOrU,KAAKoe,OAAQpe,KAAKke,YAAale,KAAK2Z,MACzE3Z,KAAKke,YAAYhB,WAAU,KAInC,MAAa,GAAR7I,GAA2C,GAMhD,MAAM,IAAS1S,MAAM,GAAI0S,GALjBF,IAAanU,KAAK4vB,iBAAiBxQ,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,OACnF3Z,KAAKke,YAAYK,aAAapK,EAAUE,IAMpD,MAAMA,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAgB,KAARrK,GAG7BrU,KAAKqe,QAAU,EAEfhK,GAAS,EAGTrU,KAAKiZ,gBAA0B,WAAR5E,EACvBrU,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACZ,IAAIiW,EAAmB5vB,KAAK4vB,iBACxB9Q,GAAQ8Q,IACRA,EAAiB54B,KAAKqd,EAAO5G,EAAOzN,KAAKke,aAE7C,IAAI4R,EAAiB9vB,KAAK8vB,eACrBA,IAEGA,EADA9vB,KAAKrJ,KAAOmpB,GACK9f,KAAK8vB,eAAiB9vB,KAAKgd,gBAAgBC,YAAY5I,EAAOrU,KAAKlG,OAAQkG,KAAK6vB,gBAGhF7vB,KAAK8vB,eAAiB9vB,KAAKgd,gBAAgBwR,YAAYna,EAAOrU,KAAKlG,OAAQkG,KAAK6vB,iBAGrG7vB,KAAKrJ,OAAS0tB,GAAYqL,SAAWI,EAAe94B,MACpD84B,EAAe94B,KAAKqd,GAGxBub,EAAmB5vB,KAAK4vB,iBACpB5vB,KAAKrJ,KAAOg5B,IACZ3vB,KAAKke,YAAYI,aAAasR,EAAiBxQ,SAAS/K,EAAO5G,EAAOzN,KAAKme,QAASxE,GAAOtF,GAE3FrU,KAAKrJ,KAAOkpB,IACZ+P,EAAiBvQ,QAAQhL,EAAO5G,EAAOzN,KAAKke,YAAavE,GAEzD3Z,KAAKrJ,KAAOmpB,KACZgQ,EAAehe,UAAU9R,KAAKke,aACD,IAAxBle,KAAKrJ,KAAOkpB,KACb7f,KAAKke,YAAYK,aAAauR,EAAe5W,WAAY7E,GAE7Dyb,EAAe9vB,KAAK0U,KAAO,IAG/B1U,KAAKqe,QAAU,EACfre,KAAKqe,SAAU,EAEnB,QAAQhK,GACgB,EAAdrU,KAAKqe,SAIXre,KAAKqe,QAAU,EAEfre,KAAKiZ,gBAAkB,EACnB+F,GAAUhf,KAAK4vB,mBACf5vB,KAAK4vB,iBAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAE1Dle,KAAKoe,YAAS,EACVpe,KAAK8vB,eAAetQ,QACpBxf,KAAK8vB,eAAetQ,OAAOnL,GAE3BrU,KAAK8vB,eAAexd,cACpBtS,KAAK8vB,eAAexd,YAAYtS,KAAKke,aACrCle,KAAK8vB,eAAe9vB,KAAK0U,MAAO,IAEpC1U,KAAKke,YAAYhB,WAAU,GAE3Bld,KAAKqe,SAAU,KAGvB,GAAkB,GAAW,CACzBd,KACA,GAAW,oBAAqB,CAACrnB,OAAQA,OAAQkC,OAAQihB,OAAQnjB,OAAQA,UAC1E,ICtJI,MAAM,GACT,YAAY05B,EAAkB91B,EAAQ+1B,EAAgB7S,EAAiBmB,GACnEne,KAAK4vB,iBAAmBA,EACxB5vB,KAAKme,QAAUA,EACfne,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdre,KAAK8vB,eAAiB9S,EAAgBC,YAAY,EAAcnjB,EAAQ+1B,GAE5E,WAAW/3B,GACP,MAAM8hB,EAAkB5Z,KAAKoe,OAAOxE,gBACpC1jB,OAAOoH,OAAOsc,EAAiB9hB,GAC/B,MAAM+E,EAASmD,KAAK4vB,iBAAiBxQ,SAAS,QAA4Bpf,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,MAC1G,IAAK,MAAMrX,KAAQxK,EACf0E,QAAQuZ,eAAe6D,EAAiBtX,GAE5C,OAAOzF,EAEX,MAAMwX,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAgB,KAARrK,GAG7BrU,KAAKqe,QAAU,EACfre,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACRmF,GAAQ9e,KAAK4vB,mBACb5vB,KAAK4vB,iBAAiB54B,KAAKqd,EAAO5G,EAAOzN,KAAKke,aAElDle,KAAK8vB,eAAe3W,SAAU8W,GAAUjwB,KAAKke,YAAYM,WAAWyR,GAAQ5b,GAE5ErU,KAAKqe,QAAU,EACfre,KAAKqe,SAAU,EAEnB,QAAQhK,GACgB,EAAdrU,KAAKqe,SAIXre,KAAKqe,QAAU,EACXW,GAAUhf,KAAK4vB,mBACf5vB,KAAK4vB,iBAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAE1Dle,KAAKoe,YAAS,EACdpe,KAAK8vB,eAAe3W,SAAS,KAAM9E,GAEnCrU,KAAKqe,SAAU,GAEnB,gBAAgBhK,EAAO9X,EAAKwgB,IAG5B,aAAa5I,EAAUC,EAAeC,KCpDnC,MAAM6b,GAAoB,IAAGpqB,gBAAgB,qBAAqBP,YAAY2E,GAAKA,EAAEjG,UAAU,KAE/F,MAAM,GACT,cACIjE,KAAKmwB,iBAAmBj6B,OAAOY,OAAO,MACtCkJ,KAAKowB,YAAcl6B,OAAOY,OAAO,MACjCkJ,KAAKqwB,oBAAsBn6B,OAAOY,OAAO,MAE7C,MAAMooB,EAAYoR,GACd,OAAQA,GACJ,KAAK,KAA0B,CAC3B,IAAIC,EAAQvwB,KAAKqwB,oBAAoBnR,GAIrC,YAHc,IAAVqR,IACAA,EAAQvwB,KAAKqwB,oBAAoBnR,GAAclf,KAAKwwB,UAAUtR,EAAYoR,IAEvEC,EAEX,KAAK,IAAsB,CACvB,IAAIA,EAAQvwB,KAAKowB,YAAYlR,GAI7B,YAHc,IAAVqR,IACAA,EAAQvwB,KAAKowB,YAAYlR,GAAclf,KAAKwwB,UAAUtR,EAAYoR,IAE/DC,EAEX,QAAS,CAGL,GAA0B,IAAtBrR,EAAW5kB,QAA+B,GAAdg2B,EAC5B,OAAOxO,GAA2BM,OAEtC,IAAImO,EAAQvwB,KAAKmwB,iBAAiBjR,GAIlC,YAHc,IAAVqR,IACAA,EAAQvwB,KAAKmwB,iBAAiBjR,GAAclf,KAAKwwB,UAAUtR,EAAYoR,IAEpEC,IAInB,MAAMzN,GACF,MAAM,YAAEsN,EAAW,iBAAED,EAAgB,oBAAEE,GAAwBrwB,KAC/D,IAAK,MAAMkf,KAAc4D,EAAa,CAClC,MAAM7E,EAAO6E,EAAY5D,GACzB,OAAQjB,EAAKc,OACT,KAAK,GACDsR,EAAoBnR,GAAcjB,EAClC,MACJ,KAAK,KACDmS,EAAYlR,GAAcjB,EAC1B,MACJ,QACIkS,EAAiBjR,GAAcjB,IAI/C,UAAUiB,EAAYoR,GAClB,IACI,MAAMhO,EAAQpD,EAAWuR,MAAM,KACzBC,EAAYpO,EAAM,GACxB,IAAI1Z,EAEAA,EADA8nB,EAAUC,SAAS,MACT,IAAI,GAAoBD,EAAUE,QAAQ,KAAM,IAAK,IAASxxB,YAG9D,IAAI,GAAsBkjB,EAAM,IAE9C,IAAIpd,EAAQ,EACZ,KAAOA,EAAQod,EAAMhoB,QAAQ,CACzB,MAAMu2B,EAAcvO,EAAMpd,GAEtB0D,EADAioB,EAAYF,SAAS,MACX,IAAIrP,GAAqB1Y,EAASioB,EAAYD,QAAQ,KAAM,IAAK,IAASxxB,YAG1E,IAAI2hB,GAAuBnY,EAAS0Z,EAAMpd,IAExDA,IAEJ,OAAO0D,EAEX,MAAOsI,GACH,MAAM,IAASvP,MAAM,EAAGuP,KAK7B,IAAI4f,IACX,SAAWA,GACPA,EAAYA,EAAkB,KAAI,GAAK,OACvCA,EAAYA,EAA8B,iBAAI,MAAQ,mBACtDA,EAAYA,EAA2B,cAAI,MAAQ,gBACnDA,EAAYA,EAAmB,MAAI,MAAQ,QAC3CA,EAAYA,EAAwB,WAAI,KAAO,aAC/CA,EAAYA,EAAsB,SAAI,KAAO,WAC7CA,EAAYA,EAAwB,WAAI,KAAO,aAC/CA,EAAYA,EAAqB,QAAI,IAAM,UAC3CA,EAAYA,EAAwB,WAAI,IAAM,aAC9CA,EAAYA,EAAuB,UAAI,IAAM,YAC7CA,EAAYA,EAA+B,kBAAI,IAAM,oBACrDA,EAAYA,EAA4B,eAAI,IAAM,iBAClDA,EAAYA,EAAqC,wBAAI,GAAK,0BAC1DA,EAAYA,EAAqB,QAAI,IAAM,UAC3CA,EAAYA,EAA4B,eAAI,IAAM,iBAClDA,EAAYA,EAA2B,cAAI,IAAM,gBACjDA,EAAYA,EAA6B,gBAAI,IAAM,kBACnDA,EAAYA,EAA2B,cAAI,IAAM,gBACjDA,EAAYA,EAAyB,YAAI,IAAM,cAC/CA,EAAYA,EAA4B,eAAI,MAAQ,iBACpDA,EAAYA,EAA4B,eAAI,MAAQ,iBACpDA,EAAYA,EAA6B,gBAAI,MAAQ,kBACrDA,EAAYA,EAAyB,YAAI,KAAO,cAChDA,EAAYA,EAA4B,eAAI,IAAM,iBAClDA,EAAYA,EAAwB,WAAI,KAAO,aAC/CA,EAAYA,EAA2B,cAAI,KAAO,gBA1BtD,CA2BGA,KAAgBA,GAAc,KClHjC,IAAI,GAA0C,SAAU72B,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAM1G,MAAQ6U,OAAM,WAAS,IAAKwE,GACrB,MAAM0M,GACT,YAAY/T,EAAiBgU,EAAel3B,EAAQ+1B,EAAgBl5B,EAAMwnB,GACtEne,KAAKgd,gBAAkBA,EACvBhd,KAAKgxB,cAAgBA,EACrBhxB,KAAKlG,OAASA,EACdkG,KAAK6vB,eAAiBA,EACtB7vB,KAAKrJ,KAAOA,EACZqJ,KAAKme,QAAUA,EACfne,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdre,KAAKoe,YAAS,EAKd,MAAM0E,EAAckO,EAAclO,YAC5BR,EAAQtiB,KAAKsiB,MAAQnoB,MAAM2oB,EAAYxoB,QAC7C,IAAK,IAAI9E,EAAI,EAAGkS,EAAKob,EAAYxoB,OAAQ9E,EAAIkS,IAAMlS,EAC/C8sB,EAAM9sB,GAAK,IAAI,GAAqBstB,EAAYttB,GAAIw7B,EAAel3B,EAAQ+1B,EAAgBl5B,EAAMqmB,EAAiBmB,EAAe,IAAN3oB,GAInI,MAAM6e,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAQrK,GAE7BrU,KAAKqe,QAAU,EACfre,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACZ,MAAM2I,EAAQtiB,KAAKsiB,MACnB,IAAK,IAAI9sB,EAAI,EAAGkS,EAAK4a,EAAMhoB,OAAQ9E,EAAIkS,IAAMlS,EACzC8sB,EAAM9sB,GAAG0oB,YAAYO,MAAMpK,EAAO5G,EAAOkM,GAGjD,QAAQtF,GACJ,KAAoB,EAAdrU,KAAKqe,QACP,OAEJre,KAAKqe,SAAU,EACfre,KAAKoe,YAAS,EACd,MAAMkE,EAAQtiB,KAAKsiB,MACnB,IAAK,IAAI9sB,EAAI,EAAGkS,EAAK4a,EAAMhoB,OAAQ9E,EAAIkS,IAAMlS,EACzC8sB,EAAM9sB,GAAG0oB,YAAYQ,QAAQrK,IAIzC,IAAI,GAAuB,MACvB,YAAYub,EAAkBoB,EAAel3B,EAAQ+1B,EAAgBl5B,EAAMqmB,EAAiBmB,EAAS8S,GACjGjxB,KAAK4vB,iBAAmBA,EACxB5vB,KAAKgxB,cAAgBA,EACrBhxB,KAAKlG,OAASA,EACdkG,KAAK6vB,eAAiBA,EACtB7vB,KAAKrJ,KAAOA,EACZqJ,KAAKgd,gBAAkBA,EACvBhd,KAAKme,QAAUA,EACfne,KAAKixB,QAAUA,EACfjxB,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdd,GAAYC,WAAWxd,MACvBA,KAAK8vB,eAAiB9S,EAAgBwR,YAAY,EAAc10B,EAAQ+1B,GAE5E,aAAap5B,EAAO4d,GAChBrU,KAAK8vB,eAAe3W,SAAS1iB,EAAe,GAAR4d,GAExC,aAAa6c,EAAWlB,EAAgB3b,GACpC,KAAoB,EAAdrU,KAAKqe,QACP,OAEJ,MAAMjK,EAAgBpU,KAAK8vB,eAAe5W,WACpC/E,EAAWnU,KAAKgxB,cAAc5R,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,MAChFxF,IAAaC,GACbpU,KAAKke,YAAYI,aAAanK,EAAUE,GAEd,IAAzBrU,KAAKrJ,KAAO,MACbqJ,KAAK6c,UACL7c,KAAK4vB,iBAAiBvQ,QAAQhL,EAAOrU,KAAKoe,OAAQpe,KAAKke,YAAale,KAAK2Z,MACzE3Z,KAAKke,YAAYhB,WAAU,IAGnC,MAAM7I,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAQrK,GAE7BrU,KAAKqe,QAAU,EACfre,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACZ,MAAMiW,EAAmB5vB,KAAK4vB,iBAC1BA,EAAiB54B,MACjB44B,EAAiB54B,KAAKqd,EAAO5G,EAAOzN,KAAKke,aAEzCle,KAAKrJ,OAAS0tB,GAAYqL,SAAW1vB,KAAK8vB,eAAe94B,MACzDgJ,KAAK8vB,eAAe94B,KAAKqd,GAIzBrU,KAAKixB,SACLjxB,KAAKke,YAAYI,aAAate,KAAKgxB,cAAc5R,SAAS/K,EAAO5G,EAAOzN,KAAKme,QAASxE,GAAOtF,GAE7FrU,KAAKrJ,KAAO,IACZi5B,EAAiBvQ,QAAQhL,EAAO5G,EAAOzN,KAAKke,YAAavE,GAGjE,QAAQtF,GACJ,KAAoB,EAAdrU,KAAKqe,QACP,OAEJre,KAAKqe,SAAU,EACf,MAAMuR,EAAmB5vB,KAAK4vB,iBAC1BA,EAAiBpQ,QACjBoQ,EAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAEjDle,KAAK8vB,eAAetQ,QACpBxf,KAAK8vB,eAAetQ,OAAOnL,GAE/BrU,KAAKoe,YAAS,EACdpe,KAAKke,YAAYhB,WAAU,KAGnC,GAAuB,GAAW,CAC9BK,KACA,GAAW,oBAAqB,CAACrnB,OAAQA,OAAQA,OAAQkC,OAAQihB,OAAQnjB,OAAQA,OAAQi7B,WAC1F,IC7IH,IAMI,GAA0C,SAAUz3B,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAM1G,IAAI,GAAa,MACb,YAAY4kB,EAAkBC,EAAgB7S,EAAiBmB,EAASiT,GAAmB,GACvFpxB,KAAK4vB,iBAAmBA,EACxB5vB,KAAK6vB,eAAiBA,EACtB7vB,KAAKgd,gBAAkBA,EACvBhd,KAAKme,QAAUA,EACfne,KAAKoxB,iBAAmBA,EACxBpxB,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdre,KAAKoe,YAAS,EACdpe,KAAKlG,OAAS,KACdyjB,GAAYC,WAAWxd,MACvBA,KAAK+vB,WAAa5R,EAAQ9nB,IAAIogB,GAElC,aAAaya,EAAWlB,EAAgB3b,GACpC,GAAoB,EAAdrU,KAAKqe,OAAX,CAGA,KAAY,GAARhK,GASJ,MAAM,IAAS1S,MAAM,GAAI0S,GATzB,CACI,MAAM,OAAEva,EAAM,eAAE+1B,GAAmB7vB,KAC7BoU,EAAgBta,EAAO+1B,GACvB1b,EAAWnU,KAAK4vB,iBAAiBxQ,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,MACnFxF,IAAaC,IACbta,EAAO+1B,GAAkB1b,KAMrC,MAAME,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAgB,KAARrK,GAG7BrU,KAAKqe,QAAU,EACfre,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACZ3Z,KAAKlG,OAAUkG,KAAKoxB,iBAAmB3jB,EAAMqM,eAAiBrM,EAAMmM,gBACpE,MAAMgW,EAAmB5vB,KAAK4vB,iBAC1BA,EAAiB54B,MACjB44B,EAAiB54B,KAAKqd,EAAO5G,EAAOzN,KAAKke,aAG7Cle,KAAKlG,OAAOkG,KAAK6vB,gBAAkB7vB,KAAK4vB,iBAAiBxQ,SAAiB,KAAR/K,EAA6B5G,EAAOzN,KAAKme,QAASxE,GACpH3Z,KAAK4vB,iBAAiBvQ,QAAQhL,EAAO5G,EAAOzN,KAAKke,YAAavE,GAE9D3Z,KAAKqe,QAAU,EACfre,KAAKqe,SAAU,EAEnB,QAAQhK,GACJ,KAAoB,EAAdrU,KAAKqe,QACP,OAGJre,KAAKqe,QAAU,EACf,MAAMuR,EAAmB5vB,KAAK4vB,iBAC1BA,EAAiBpQ,QACjBoQ,EAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAErDle,KAAKoe,YAAS,EACdpe,KAAKke,YAAYhB,WAAU,GAE3Bld,KAAKqe,SAAU,IAGvB,GAjF8C,SAAUpkB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA6EnD,CAAW,CACpBinB,KACA,GAAW,oBAAqB,CAACrnB,OAAQkC,OAAQlC,OAAQA,OAAQi7B,WAClE,ICnFI,MAAM,GACT,YAAYvB,EAAkB91B,EAAQqkB,GAClCne,KAAK4vB,iBAAmBA,EACxB5vB,KAAKlG,OAASA,EACdkG,KAAKme,QAAUA,EACfne,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdre,KAAKoe,YAAS,EAElB,MAAM/J,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAgB,KAARrK,GAG7BrU,KAAKqe,QAAU,EACfre,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACRmF,GAAQ9e,KAAK4vB,mBACb5vB,KAAK4vB,iBAAiB54B,KAAKqd,EAAO5G,EAAOzN,MAE7CA,KAAK4vB,iBAAiBtyB,OAAe,GAAR+W,EAAyCrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAKlG,OAAQ6f,GAE9G3Z,KAAKqe,QAAU,EACfre,KAAKqe,SAAU,EAEnB,QAAQhK,GACJ,KAAoB,EAAdrU,KAAKqe,QACP,OAGJre,KAAKqe,QAAU,EACf,IAAIuR,EAAmB5vB,KAAK4vB,iBACxBA,EAAiBxQ,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,QAAU3Z,KAAKlG,QAChF81B,EAAiBtyB,OAAO+W,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAAS,KAAMne,KAAK2Z,MAGzEiW,EAAmB5vB,KAAK4vB,iBACpB5Q,GAAU4Q,IACVA,EAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAErDle,KAAKoe,YAAS,EAEdpe,KAAKqe,SAAU,EAEnB,gBAAgBhK,EAAO9X,EAAKwgB,IAG5B,aAAa5I,EAAUC,EAAeC,KCnD1C,IAMI,GAA0C,SAAU3a,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAO1G,IAAI,GAAwC,MACxC,YAAY2L,EAAWtC,EAAO9X,EAAK/D,EAAa64B,EAAQC,GACpDtxB,KAAK2W,UAAYA,EACjB3W,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAKsxB,KAAOA,EACZtxB,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKqV,SAAU,EACf,IAAIkc,GAAU,EACV,EAAcA,QAAQh1B,KACtBg1B,GAAU,EACVh1B,EAAIoZ,UAAU7D,UAAU9R,KAAMxH,GAC9BwH,KAAKzD,IAAMA,EAAIkZ,MAEnBzV,KAAKxB,SAAWwB,KAAKzD,IAAI80B,GACzB,MAAMG,EAA0BxxB,KAAKwxB,wBAA0BxxB,KAAKzD,IAAIk1B,gBAClEC,EAA6B1xB,KAAK0xB,2BAAgE,mBAA5BF,EACtEG,EAAqB3xB,KAAK2xB,mBAAqBL,IAAS,IAAStE,KAKvE,QAAsB,IAAlBhtB,KAAKxB,UAAwBkzB,GAA+BC,EAG3D,CACD3xB,KAAKgZ,WAAY,EACjB,MAAMD,EAAexc,EAAI/D,GACzBwH,KAAK+Y,aAAe4Y,QAAuC,IAAjB5Y,EACpCuY,EAAKvY,GACLA,EACDwY,GACDvxB,KAAK4xB,0BATT5xB,KAAKgZ,WAAY,EAYrBhZ,KAAKiZ,gBAA0B,WAAR5E,EAE3B,aAAaF,EAAUoB,EAAUlB,GAC7BrU,KAAKmZ,SAAShF,EAAUE,GAE5B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GAIf,GAHIrU,KAAK2xB,qBACLxd,EAAWnU,KAAKsxB,KAAKnd,IAErBnU,KAAKgZ,UAAW,CAChB,MAAMD,EAAe/Y,KAAK+Y,aAE1B,GAAI7iB,OAAO27B,GAAG1d,EAAU4E,GACpB,OAGJ,GADA/Y,KAAK+Y,aAAe5E,EACe,IAA/BnU,KAAK2W,UAAUkC,MAAM5I,OAErB,GADAjQ,KAAKqS,gBAAgB8B,EAAU4E,EAAc/Y,KAAKiZ,gBAAkB5E,GAC9B,IAAzB,KAARA,KAA+C,GAARA,GAA2C,EAAG,CACtF,MAAM7V,EAAWwB,KAAKxB,cACL,IAAbA,GACAA,EAAS7I,KAAKqK,KAAKzD,IAAK4X,EAAU4E,EAAc/Y,KAAKiZ,gBAAkB5E,GAEvErU,KAAK0xB,4BAEL1xB,KAAKwxB,wBAAwB77B,KAAKqK,KAAKzD,IAAKyD,KAAKxH,YAAa2b,EAAU4E,EAAc/Y,KAAKiZ,gBAAkB5E,SAI/GrU,KAAKqV,UACXrV,KAAKqV,SAAU,EACfrV,KAAKuV,SAAWwD,EAChB/Y,KAAK2W,UAAUkC,MAAMjd,IAAIoE,YAK7BA,KAAKzD,IAAIyD,KAAKxH,aAAe2b,EAGrC,UAAUnB,GACN,IAAuB,IAAnBhT,KAAKgZ,UAAqB,CAC1BhZ,KAAKgZ,WAAY,EACjB,MAAMD,EAAe/Y,KAAKzD,IAAIyD,KAAKxH,aACnCwH,KAAK+Y,aAAe/Y,KAAK2xB,mBACnB3xB,KAAKsxB,KAAKvY,GACVA,EACN/Y,KAAK4xB,qBAET5xB,KAAKiS,cAAce,GAEvB,qBACSxW,QAAQrG,eAAe6J,KAAKzD,IAAKyD,KAAKxH,YAAa,CACpDpC,YAAY,EACZsG,cAAc,EACdrG,IAAK,IAAM2J,KAAK+Y,aAChBhgB,IAAMtC,IACFuJ,KAAKmZ,SAAS1iB,EAAO,OAGzB,IAASyR,MAAM,EAAGlI,KAAKxH,YAAawH,KAAKzD,OAIrD,GArH8C,SAAUtC,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAiHxB,CAAW,CAC/Cyb,IACA,GAAW,oBAAqB,CAAC7b,OAAQmjB,OAAQnjB,OAAQkC,OAAQA,OAAQwI,YAC1E,ICxHH,IAAI,GAA0C,SAAU3G,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAInG,MAAM8mB,GACT,YAAYn7B,GACRqJ,KAAKrJ,KAAOA,EACZqJ,KAAK+xB,cAAgB,IAAIp6B,QAE7B,KAAK0c,EAAO5G,EAAOuQ,GACfhe,KAAK+xB,cAAch5B,IAAIilB,EAASA,EAAQrnB,MACxCqnB,EAAQrnB,KAAOqJ,KAAKrJ,KAExB,OAAO0d,EAAO5G,EAAOuQ,GACjBA,EAAQrnB,KAAOqJ,KAAK+xB,cAAc17B,IAAI2nB,IAG9C,IAAI,GAAyB,cAAqC8T,GAC9D,cACIE,MAAM3N,GAAYqL,WAG1B,GAAyB,GAAW,CAChChS,GAAgB,WAChB,GAAW,oBAAqB,KACjC,IAEH,IAAI,GAAwB,cAAoCoU,GAC5D,cACIE,MAAM3N,GAAYxE,UAG1B,GAAwB,GAAW,CAC/BnC,GAAgB,UAChB,GAAW,oBAAqB,KACjC,IAEH,IAAI,GAA0B,cAAsCoU,GAChE,cACIE,MAAM3N,GAAYvE,YAG1B,GAA0B,GAAW,CACjCpC,GAAgB,YAChB,GAAW,oBAAqB,KACjC,IAEH,IAAI,GAAwB,cAAoCoU,GAC5D,cACIE,MAAM3N,GAAY4N,UAG1B,GAAwB,GAAW,CAC/BvU,GAAgB,UAChB,GAAW,oBAAqB,KACjC,IC9DH,IAMI,GAA0C,SAAUhkB,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAK1G,IAAI,GAA0B,cAAsC8S,GAChE,YAAYE,EAASC,GACjB+T,MAAMhU,EAASC,GACfje,KAAKkyB,KAAO,CAAEC,MAAO,GACrBnyB,KAAKoyB,SAAW,KAChBpyB,KAAK4rB,KAAO,KACZ5rB,KAAKqyB,UAAYrU,EAAQG,QAAQ9nB,IAAI,MAAYi8B,yBAC7CrU,EAAKnmB,KAAKwC,OAAS,IACnB0F,KAAKoyB,SAAWnU,EAAKnmB,KAAK,IAGlC,WAAWA,GACPkI,KAAKuyB,UAAU,IAAMvyB,KAAKge,QAAQQ,WAAW1mB,IAGjD,aAAaqc,EAAUC,EAAeC,GAClCrU,KAAKuyB,UAAU,IAAMvyB,KAAKge,QAAQpJ,aAAaT,EAAUC,EAAeC,IAE5E,UAAU7V,GACY,OAAdwB,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAKqyB,UAAUE,UAAU/zB,EAAUwB,KAAKkyB,MAExD,MAAM7d,EAAO5G,EAAOkM,GAChB,GAAsB,OAAlB3Z,KAAKoyB,SAAmB,CACxB,MAAMD,EAAQ9Y,OAAOrZ,KAAKoyB,SAAShT,SAAS/K,EAAO5G,EAAOzN,KAAKme,QAASxE,IACnE6Y,MAAML,KACPnyB,KAAKkyB,KAAKC,MAAQA,GAG1BnyB,KAAKge,QAAQS,MAAMpK,EAAO5G,EAAOkM,KAGzC,GA9C8C,SAAU1f,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA0CtC,CAAW,CACjConB,GAAgB,YAChB,GAAW,oBAAqB,CAACxnB,OAAQ,MAC1C,ICjDH,IAMI,GAA0C,SAAUwD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAK3D,IAAI,GAAwB,MACxB,YAAY6U,GACR/f,KAAK+f,SAAWA,EAEpB,KAAK1L,EAAO5G,EAAOuQ,KAAYlmB,GAC3B,IAAKkmB,EAAQM,aACT,MAAM,IAAS3c,MAAM,IAEzB,GAAyB,IAArBkJ,UAAUvQ,OAAc,CACxB,MAAMvE,EAAO+B,EAAK,GAClBkI,KAAK+f,SAASC,kBAAkBjqB,EAAMioB,GACtCA,EAAQyU,OAAS18B,MAEhB,MAAI8U,UAAUvQ,OAAS,GAUxB,MAAM,IAASqH,MAAM,IAVM,CAC3B,MAAM+wB,EAAQv4B,MAAM/C,UAAUsH,MAAM/I,KAAKmC,EAAKwC,OAAS,EAAG,GAC1D,IAAI9E,EAAIk9B,EAAMp4B,OACd,KAAO9E,KAAK,CACR,MAAMO,EAAO28B,EAAMl9B,GACnBwK,KAAK+f,SAASC,kBAAkBjqB,EAAMioB,GAE1CA,EAAQyU,OAASC,IAMzB,OAAOre,EAAO5G,EAAOuQ,GACjB,MAAMjoB,EAAOioB,EAAQyU,OAErB,GADAzU,EAAQyU,OAAS,KACbt4B,MAAMC,QAAQrE,GAAO,CACrB,MAAM28B,EAAQ38B,EACd,IAAIP,EAAIk9B,EAAMp4B,OACd,KAAO9E,KACHwK,KAAK+f,SAASE,qBAAqByS,EAAMl9B,GAAIwoB,QAIjDhe,KAAK+f,SAASE,qBAAqBlqB,EAAMioB,KAIrD,GAxD8C,SAAU/jB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAoDxC,CAAW,CAC/BonB,GAAgB,UAChB,GAAQ,EAAGpD,GACX,GAAW,oBAAqB,CAACpkB,UAClC,IC5DH,IAMI,GAA0C,SAAUwD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAK1G,IAAI,GAA0B,cAAsC8S,GAChE,YAAYE,EAASC,GACjB+T,MAAMhU,EAASC,GACfje,KAAKkyB,KAAO,CAAEC,MAAO,GACrBnyB,KAAKoyB,SAAW,KAChBpyB,KAAK4rB,KAAO,KACZ5rB,KAAK2yB,SAAW,EAChB3yB,KAAKqyB,UAAYrU,EAAQG,QAAQ9nB,IAAI,MAAYi8B,yBACjDtyB,KAAK4N,IAAMoQ,EAAQG,QAAQ9nB,IAAI,MAC3B4nB,EAAKnmB,KAAKwC,OAAS,IACnB0F,KAAKoyB,SAAWnU,EAAKnmB,KAAK,IAGlC,WAAWA,GACPkI,KAAKuyB,UAAU,IAAMvyB,KAAKge,QAAQQ,WAAW1mB,IAGjD,aAAaqc,EAAUC,EAAeC,GAClCrU,KAAKuyB,UAAU,IAAMvyB,KAAKge,QAAQpJ,aAAaT,EAAUC,EAAeC,IAE5E,UAAU7V,GACN,MAAM0zB,EAAOlyB,KAAKkyB,KACZtkB,EAAM5N,KAAK4N,IACXglB,EAAY5yB,KAAK2yB,SAAWT,EAAKC,MAAQvkB,IAC3CglB,EAAY,GACM,OAAd5yB,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdgG,EAAKC,MAAQS,EACb5yB,KAAK4rB,KAAO5rB,KAAKqyB,UAAUE,UAAU,KACjCvyB,KAAK2yB,SAAW/kB,IAChBpP,KACD0zB,KAGHlyB,KAAK2yB,SAAW/kB,IAChBpP,KAGR,MAAM6V,EAAO5G,EAAOkM,GAChB,GAAsB,OAAlB3Z,KAAKoyB,SAAmB,CACxB,MAAMD,EAAQ9Y,OAAOrZ,KAAKoyB,SAAShT,SAAS/K,EAAO5G,EAAOzN,KAAKme,QAASxE,IACnE6Y,MAAML,KACPnyB,KAAKkyB,KAAKC,MAAQA,GAG1BnyB,KAAKge,QAAQS,MAAMpK,EAAO5G,EAAOkM,KAGzC,GA7D8C,SAAU1f,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAyDtC,CAAW,CACjConB,GAAgB,YAChB,GAAW,oBAAqB,CAACxnB,OAAQ,MAC1C,ICrDI,SAAS,GAAS28B,EAAgBvwB,GACrC,IAAI+B,EACJ,SAAS7J,EAAUs4B,EAASC,GACpBloB,UAAUvQ,OAAS,IAMnB+J,EAAOlN,SAAW47B,GAEtB,IAAS72B,OAAO82B,GAASj9B,KAAM,GAAmBe,OAAOi8B,EAAO1uB,GAASyuB,EAAQntB,YAAaotB,GAC9F,IAAS1wB,WAAWmC,SAASsuB,EAAQntB,YAAaqtB,GAAS7W,QAAQ4W,IAEvE,OAAIloB,UAAUvQ,OAAS,GAGnB+J,EAAS,QACT7J,EAAUq4B,EAAgBvwB,IAGK,iBAAnBuwB,GAKZxuB,EAAS,GACF7J,IAKX6J,OAA4B,IAAnBwuB,EAA4B,GAAKA,EACnCr4B,GAEX,SAASy4B,GAAqBl8B,GAC1B,OAAOA,EAAI0L,WAAWuwB,GAASj9B,MAE5B,MAAMi9B,GAAW,CACpBj9B,KAAM,IAASsM,WAAWE,OAAO,YACjC4Z,QAAQpmB,GACG,GAAGi9B,GAASj9B,QAAQA,IAE/B,QAAQm9B,GACJ,MAAMC,EAAY,GAEZ/4B,EAAUD,MAAMC,QACtB,SAASg5B,EAAQr9B,GACbo9B,EAAUp9B,GAAQ,GAAmBe,OAAOf,GAiBhD,OADAm9B,EAAcriB,SAXd,SAAiBwiB,GACTj5B,EAAQi5B,GACRA,EAAUxiB,QAAQuiB,GAEbC,aAAqB,GAC1BF,EAAUE,EAAUl8B,UAAYk8B,OAEb,IAAdA,GACLn9B,OAAOsD,KAAK65B,GAAWxiB,QAAQ9a,GAXvC,SAAwBA,EAAM8M,GAC1BswB,EAAUp9B,GAAQ8M,aAAe,GAAqBA,EAAM,GAAmB/L,OAAOf,EAAM8M,GAUjDywB,CAAev9B,EAAMs9B,EAAUt9B,QAIvEo9B,GAEX,IAAIpyB,GACA,IAAI8B,EACJ,MAAM0wB,EAAU,CACZ,IAAIC,GACA,IAAIlxB,EACA+B,EAcJ,MAb4B,iBAAjBmvB,GACPlxB,EAAOkxB,EACPnvB,EAAS,CAAElN,SAAUmL,KAGrBA,EAAOkxB,EAAar8B,SACpBkN,EAASmvB,GAEb3wB,EAAM,GAAmB/L,OAAOwL,EAAM+B,GACjC,IAASlI,OAAO62B,GAASj9B,KAAMgL,EAAMuB,IACtC,IAASD,WAAWmC,SAASzD,EAAMiyB,GAAS7W,QAAQ7Z,IAExD,IAASpG,OAAO82B,GAASj9B,KAAM8M,EAAK9B,EAAMuB,GACnCixB,GAEX58B,KAAKA,IACDkM,EAAIlM,KAAOA,EACJ48B,GAEX/0B,SAASA,IACLqE,EAAIrE,SAAWA,EACR+0B,GAEXE,UAAUA,IACN5wB,EAAI4wB,UAAYA,EACTF,GAEXG,QAAO,KACH7wB,EAAI6wB,SAAU,EACPH,GAEXx6B,IAAI46B,IACA9wB,EAAI9J,IAAM46B,EACHJ,IAGf,OAAOA,GAEX,OAAOxyB,GACH,MAAM6yB,EAAYZ,GAASj9B,KAAKuE,OAAS,EACnCwO,EAAO,GACP+qB,EAAiB,YAAkB9yB,GACzC,IAEIvH,EACAs6B,EACAC,EAJAC,EAASH,EAAev5B,OACxB25B,EAAQ,EAIZ,OAASD,GAAU,GAAG,CAClBD,EAAQF,EAAeG,GACvBx6B,EAAO,IAAS6I,WAAWhG,QAAQ03B,GAAO9pB,OAAOgpB,IACjDa,EAAUt6B,EAAKc,OACf,IAAK,IAAI9E,EAAI,EAAGA,EAAIs+B,IAAWt+B,EAC3BsT,EAAKmrB,KAAW,IAAS73B,OAAO42B,GAASj9B,KAAMg+B,EAAOv6B,EAAKhE,GAAGkJ,MAAMk1B,IAG5E,OAAO9qB,IAGR,MAAM,GACT,YAAY2qB,EAAWj1B,EAAU7H,EAAM+8B,EAASv8B,EAAU4B,GACtDiH,KAAKyzB,UAAYA,EACjBzzB,KAAKxB,SAAWA,EAChBwB,KAAKrJ,KAAOA,EACZqJ,KAAK0zB,QAAUA,EACf1zB,KAAK7I,SAAWA,EAChB6I,KAAKjH,IAAMA,EAEf,cAAcuJ,EAAMO,EAAM,IACtB,OAAO,IAAI,GAAmB,YAAaA,EAAI4wB,UAAW,YAAUnxB,IAAQ,YAAaO,EAAIrE,SAAU,GAAG8D,YAAgB,YAAaO,EAAIlM,KAAM0tB,GAAYxE,QAAS,YAAahd,EAAI6wB,SAAS,GAAQ,YAAa7wB,EAAI1L,SAAUmL,GAAO,YAAaO,EAAI9J,IAAK,IAASi0B,QCpJ1Q,SAASkH,GAAgBvW,GAC5B,OAAO,SAAU7jB,GACb,OAAOq6B,GAAgBj4B,OAAOyhB,EAAW7jB,IAG1C,SAASs6B,GAAmBzW,GAC/B,OAAO,SAAU7jB,GACb,OAAOq6B,GAAgBj4B,OAA4B,iBAAdyhB,EAC/B,CAAE0W,sBAAsB,EAAMt+B,KAAM4nB,GACpC,CAAE0W,sBAAsB,KAAS1W,GAAa7jB,IAGrD,MAAM,GACT,YAAYiH,EAAMhL,EAAMmmB,EAASnlB,EAAKu9B,EAAoBD,EAAsBlB,EAAW1vB,EAAU8wB,EAAOC,GACxGx0B,KAAKe,KAAOA,EACZf,KAAKjK,KAAOA,EACZiK,KAAKkc,QAAUA,EACflc,KAAKjJ,IAAMA,EACXiJ,KAAKs0B,mBAAqBA,EAC1Bt0B,KAAKq0B,qBAAuBA,EAC5Br0B,KAAKmzB,UAAYA,EACjBnzB,KAAKyD,SAAWA,EAChBzD,KAAKu0B,MAAQA,EACbv0B,KAAKw0B,gBAAkBA,EAE3B,cAAc7W,EAAW5c,GACrB,IAAIhL,EACA8M,EASJ,MARyB,iBAAd8a,GACP5nB,EAAO4nB,EACP9a,EAAM,CAAE9M,UAGRA,EAAO4nB,EAAU5nB,KACjB8M,EAAM8a,GAEH,IAAI,GAA0B5c,EAAM,YAAaozB,GAAgBpW,cAAchd,EAAM,QAAShL,GAAO,YAAYo+B,GAAgBpW,cAAchd,EAAM,WAAY8B,EAAIqZ,QAASnb,EAAKmb,SAAUiY,GAAgBhY,QAAQpmB,GAAO,YAAao+B,GAAgBpW,cAAchd,EAAM,sBAAuB8B,EAAIyxB,mBAAoBvzB,EAAKuzB,mBAAoBjQ,GAAYxE,QAAS,YAAasU,GAAgBpW,cAAchd,EAAM,wBAAyB8B,EAAIwxB,qBAAsBtzB,EAAKszB,sBAAsB,GAAQrB,GAAStpB,QAAQspB,GAAS1sB,OAAOvF,GAAOozB,GAAgBpW,cAAchd,EAAM,aAAcA,EAAKoyB,UAAWtwB,EAAIswB,WAAY,YAAagB,GAAgBpW,cAAchd,EAAM,YAAa8B,EAAIY,SAAU1C,EAAK0C,SAAU,GAAuB,YAAa0wB,GAAgBpW,cAAchd,EAAM,SAAU8B,EAAI0xB,MAAOxzB,EAAKwzB,MAAO,IAAIpZ,GAAgBpa,EAAK3J,YAAa,YAAa+8B,GAAgBpW,cAAchd,EAAM,mBAAoB8B,EAAI2xB,gBAAiBzzB,EAAKyzB,iBAAiB,IAEh9B,SAASnxB,GACL,MAAM,KAAEtC,EAAI,IAAEhK,EAAG,QAAEmlB,GAAYlc,KAC/B,IAAakE,UAAUnN,EAAKgK,GAAM0E,SAASpC,GAC3C,IAAagH,QAAQtT,EAAKgK,GAAM0E,SAASpC,GACzC4Y,GAAgBC,EAASiY,GAAiBp9B,EAAKsM,IAGhD,MAAM8wB,GAAkB,CAC3Bp+B,KAAM,IAAS2M,SAASH,OAAO,oBAC/B4Z,QAAQpmB,GACG,GAAGo+B,GAAgBp+B,QAAQA,IAEtC4oB,OAAOloB,GACqB,mBAAVA,GAAwB,IAAS0F,OAAOg4B,GAAgBp+B,KAAMU,GAEhFg+B,IAAG,CAACC,EAAM3+B,IACC,IAASqG,OAAO+3B,GAAgBhY,QAAQpmB,GAAO2+B,GAE1D,OAAO/W,EAAW5c,GACd,MAAM6K,EAAa,GAA0B9U,OAAO6mB,EAAW5c,GAI/D,OAHA,IAAS7E,OAAOi4B,GAAgBp+B,KAAM6V,EAAYA,EAAW7K,MAC7D,IAAS7E,OAAOi4B,GAAgBp+B,KAAM6V,EAAYA,GAClD,IAASlJ,SAAS8B,SAASzD,EAAMozB,GAAgBp+B,MAC1C6V,EAAW7K,MAEtB,cAAcA,GACV,MAAM8B,EAAM,IAASzG,OAAO+3B,GAAgBp+B,KAAMgL,GAClD,QAAY,IAAR8B,EACA,MAAM,IAAIpC,MAAM,gCAAgCM,EAAKhL,QAEzD,OAAO8M,GAEX,SAAS9B,EAAMuB,EAAM7L,GACjB,IAASyF,OAAO,IAASmG,WAAWE,OAAOD,GAAO7L,EAAOsK,IAE7Dgd,cAAa,CAAChd,EAAMuB,IACT,IAASlG,OAAO,IAASiG,WAAWE,OAAOD,GAAOvB,IC7EpD4zB,GAAQ,IAAG7uB,gBAAgB,SAASR,YACpCsvB,GAAkB,IAAG9uB,gBAAgB,mBAAmBR,YACxDuvB,GAAO,IAAG/uB,gBAAgB,QAAQR,YACzCwvB,GAAK,YAAah9B,GACpB,MAAM,IAAS6J,MAAM,MAGnBozB,GAAQ,CACVC,iBAAkBF,GAClBG,YAAaH,GACbI,UAAWJ,GACXK,wBAAyBL,GACzBM,uBAAwBN,GACxBO,mBAAoBP,GACpBQ,cAAeR,GACfS,kBAAmBT,GACnBU,cAAeV,GACfW,mBAAoBX,GACpBY,eAAgBZ,GAChBa,eAAgBb,GAChBc,uBAAwBd,GACxBe,uBAAwBf,GACxBgB,aAAchB,GACdiB,SAAUjB,GACVkB,eAAgBlB,GAChBmB,iBAAkBnB,GAClBoB,WAAYpB,GACZqB,wBAAyBrB,GACzBsB,OAAQtB,GACRuB,oBAAqBvB,GACrBwB,aAAcxB,IAELyB,GAAM,IACZxB,GACHrJ,eAAW,EACX,oBACI,OAA6C,IAAtClvB,QAAQnG,IAAI2J,KAAM,iBAE7B,WAAWw2B,GACP,GAAIx2B,KAAKy2B,cACL,MAAM,IAAS90B,MAAM,MAEzB,MAAM+0B,EAAc,GACdC,EAAS,CAACH,GAChB,IAAI31B,EAAQ3K,OAAO8E,eAAew7B,GAClC,KAAO31B,GAASA,IAAU3K,OAAOkB,WAC7Bu/B,EAAO3P,QAAQnmB,GACfA,EAAQ3K,OAAO8E,eAAe6F,GAElC,IAAKA,KAAS81B,EACVzgC,OAAOoH,OAAOo5B,EAAaxgC,OAAO0gC,0BAA0B/1B,IAEhE,MAAMrH,EAAO,GACb,IAAIzC,EACAsD,EACJ,IAAKtD,KAAO2/B,EACRr8B,EAAaq8B,EAAY3/B,GACrBsD,EAAWqC,cAAgBrC,EAAWoC,WACtCD,QAAQrG,eAAe6J,KAAMjJ,EAAKsD,GAClCb,EAAKqG,KAAK9I,IAGlByF,QAAQzD,IAAIiH,KAAM,WAAYxG,GAC9BgD,QAAQzD,IAAIiH,KAAM,gBAAgB,IAEtC,UACI,IAAKA,KAAKy2B,cACN,MAAM,IAAS90B,MAAM,MAEZnF,QAAQnG,IAAI2J,KAAM,YAC1B6Q,QAAQ9Z,IACTyF,QAAQuZ,eAAe/V,KAAMjJ,KAEjCb,OAAOoH,OAAO0C,KAAM+0B,IACpBv4B,QAAQzD,IAAIiH,KAAM,WAAY,IAASZ,YACvC5C,QAAQzD,IAAIiH,KAAM,gBAAgB,KAU1B,IAASZ,WCtFzB,IAAI,GAA0C,SAAUnF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAM3D,MAAM,GACF,YAAYpE,EAAS+vB,EAAUxiB,GAC3BrU,KAAK8G,QAAUA,EACf9G,KAAKqU,MAAQA,EACbrU,KAAK0U,GAAK,YAAO,gBACjB1U,KAAK82B,KAAO92B,KAAK8G,QAAQhQ,SACzBkJ,KAAK82B,KAAKC,KAAKF,EAAU,GAE7B,WAAWxiB,GAEP,OADArU,KAAK82B,KAAK/7B,OAASiF,KAAKg3B,YACjBh3B,KAAK82B,KAAK9/B,KAAKqd,EAAQrU,KAAKqU,MAAOrU,KAAKg3B,YAAYvpB,OAE/D,aAAa4G,GACTrU,KAAK82B,KAAKG,OAAO5iB,GAErB,aAAaA,GACTrU,KAAK82B,KAAKI,OAAO7iB,GAErB,aAAaA,GACT,MAAMuX,EAAO5rB,KAAK82B,KAAKtX,OAAOnL,GAE9B,OADArU,KAAK82B,KAAK/7B,YAAS,EACZ6wB,GAGf,IAAIuL,GAAsB,cAAkC,GACxD,YAAYrwB,EAAS+vB,GACjB7E,MAAMlrB,EAAS+vB,EAAU,aAGjCM,GAAsB,GAAW,CAC7B/C,GAAmB,wBACnB,GAAQ,EAAG5d,GAAe,GAAQ,EAAGoe,IACrC,GAAW,oBAAqB,CAAC1+B,OAAQA,UAC1CihC,IAEH,IAAIC,GAAoB,cAAgC,GACpD,YAAYtwB,EAAS+vB,GACjB7E,MAAMlrB,EAAS+vB,EAAU,aAGjCO,GAAoB,GAAW,CAC3BhD,GAAmB,sBACnB,GAAQ,EAAG5d,GAAe,GAAQ,EAAGoe,IACrC,GAAW,oBAAqB,CAAC1+B,OAAQA,UAC1CkhC,IAEH,IAAIC,GAAiB,cAA6B,GAC9C,YAAYvwB,EAAS+vB,GACjB7E,MAAMlrB,EAAS+vB,EAAU,aAGjCQ,GAAiB,GAAW,CACxBjD,GAAmB,mBACnB,GAAQ,EAAG5d,GAAe,GAAQ,EAAGoe,IACrC,GAAW,oBAAqB,CAAC1+B,OAAQA,UAC1CmhC,ICvEH,IAAI,GAA0C,SAAUp9B,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAGpD,MAAMosB,GAAgB,CACzBC,KAAM,CACFA,MAAM,EACNC,UAAS,KAAY,EACrB,WACAC,KAAI,IAAYC,QAAQvxB,YAGzB,IAAIwxB,IACX,SAAWA,GACPA,EAASA,EAAuB,aAAI,GAAK,eACzCA,EAASA,EAAuB,aAAI,GAAK,eACzCA,EAASA,EAAqB,WAAI,GAAK,aACvCA,EAASA,EAAuB,aAAI,GAAK,eAJ7C,CAKGA,KAAaA,GAAW,KACpB,MAAMC,GAAa,IAAG9xB,gBAAgB,cAAcR,YAC3D,IAAIuyB,IACJ,SAAWA,GACPA,EAASA,EAAe,KAAI,GAAK,OACjCA,EAASA,EAAe,KAAI,GAAK,OAFrC,CAGGA,KAAaA,GAAW,KAEpB,MA6FMC,GAAoB,IAAGhyB,gBAAgB,qBAAqBR,YACzE,IAAI,GAAmB,MACnB,YAAY6Y,GACRne,KAAKme,QAAUA,EAEnB,gBAAgB9a,GACZ,OAAO,IAAaY,UAAU6zB,GAAmB93B,MAAMyF,SAASpC,GAEpE,gBAAgB8a,EAAUne,KAAKme,SAC3B,OAAOne,KAAK+3B,IAAI,EAAsB5Z,GAE1C,gBAAgBA,EAAUne,KAAKme,SAC3B,OAAOne,KAAK+3B,IAAI,EAAsB5Z,GAE1C,cAAcA,EAAUne,KAAKme,SACzB,OAAOne,KAAK+3B,IAAI,EAAoB5Z,GAExC,gBAAgBA,EAAUne,KAAKme,SAC3B,OAAOne,KAAK+3B,IAAI,EAAsB5Z,GAE1C,IAAI6Z,EAAM7Z,EAAUne,KAAKme,SACrB,MAAM8Z,EAAQ9Z,EAAQ7X,OAAOsxB,IACxB3tB,OAAOiuB,GAAaA,EAAUF,OAASA,GACvC7/B,IAAI+/B,GAAaA,EAAUC,eAC3BluB,OAAO2hB,IAASA,EAAK2L,MAC1B,OAAqB,IAAjBU,EAAM39B,OACCg9B,GAAcC,KAElB,IAAIa,GAAsBH,KAGzC,GAAmB,GAAW,CAC1B,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC/hC,UAClC,IAEI,MAAMmiC,GACT,YAAYC,EAASlhB,EAAMpY,KAAYlH,GACnCkI,KAAKu3B,MAAO,EACZv3B,KAAKu4B,YAAa,EAClBv4B,KAAKw4B,aAAc,EACnBx4B,KAAKs4B,QAAUA,EAAQG,KAAKhiC,IACxB,IAAyB,IAArBuJ,KAAKw4B,cAGTx4B,KAAKu4B,YAAa,EACL,OAATnhB,GAAe,CACf,MAAMshB,EAAathB,EAAKzhB,KAAKqJ,EAASvI,KAAUqB,GAChD,QAAmB,IAAf4gC,EAGC,CAID,OAHoBA,EAAWD,gBAAgB73B,SACzC83B,EACAA,EAAWjB,QACEgB,KAAK,KACpBz4B,KAAKu3B,MAAO,IAPhBv3B,KAAKu3B,MAAO,KAa5B,YACI,OAAQv3B,KAAKu4B,WAEjB,SACQv4B,KAAKw3B,cACLx3B,KAAKw4B,aAAc,GAG3B,OACI,OAAOx4B,KAAKs4B,SAGb,MAAMK,GACT,YAAYt1B,EAAWtM,EAAKyH,GACxBwB,KAAKqD,UAAYA,EACjBrD,KAAKjJ,IAAMA,EACXiJ,KAAKxB,SAAWA,EAChBwB,KAAKu3B,MAAO,EAEhB,YACI,OAAO,EAEX,UAGA,OACI,QAAqB,IAAjBv3B,KAAKs4B,QAAoB,CACzB,MAAM7xB,EAAWzG,KAAKqD,UAAUhN,IAAI2J,KAAKjJ,KACnC6hC,EAAqB54B,KAAKxB,SAAS7I,UAAK,EAAQ8Q,GACtDzG,KAAKs4B,aAAiC,IAAvBM,EACTlB,QAAQvxB,UACRyyB,EAAmBH,gBAAgB73B,SAC/Bg4B,EACAA,EAAmBnB,OAC7Bz3B,KAAKs4B,QAAUt4B,KAAKs4B,QAAQG,KAAK,KAC7Bz4B,KAAKu3B,MAAO,EACZv3B,KAAKqD,eAAY,EACjBrD,KAAKjJ,SAAM,EACXiJ,KAAKxB,cAAW,IACjBq6B,MAAM3nB,IAAO,MAAMA,IAE1B,OAAOlR,KAAKs4B,SAGb,MAAMQ,GACT,YAAYC,EAAY3hB,EAAMpY,KAAYlH,GACtCkI,KAAKu3B,MAAO,EACZv3B,KAAKu4B,YAAa,EAClBv4B,KAAKw4B,aAAc,EACnB,MAAMF,EAAUS,EAAWN,gBAAgB73B,SACrCm4B,EACAA,EAAWtB,OACjBz3B,KAAKs4B,QAAUA,EAAQG,KAAK,KACxB,IAAyB,IAArBz4B,KAAKw4B,YACL,OAEJx4B,KAAKu4B,YAAa,EAClB,MAAMG,EAAathB,EAAKzhB,KAAKqJ,KAAYlH,GACzC,QAAmB,IAAf4gC,EAGC,CAID,OAHoBA,EAAWD,gBAAgB73B,SACzC83B,EACAA,EAAWjB,QACEgB,KAAK,KACpBz4B,KAAKu3B,MAAO,IAPhBv3B,KAAKu3B,MAAO,IAYxB,YACI,OAAQv3B,KAAKu4B,WAEjB,SACQv4B,KAAKw3B,cACLx3B,KAAKw4B,aAAc,GAG3B,OACI,OAAOx4B,KAAKs4B,SAGb,MAAMU,GACT,YAAYD,GACR/4B,KAAKu3B,MAAO,EACZv3B,KAAKs4B,QAAUS,EAAWN,gBAAgB73B,SACpCm4B,EACAA,EAAWtB,OACjBz3B,KAAKs4B,QAAQG,KAAK,KACdz4B,KAAKu3B,MAAO,IACbsB,MAAM3nB,IAAO,MAAMA,IAE1B,YACI,OAAO,EAEX,UAGA,OACI,OAAOlR,KAAKs4B,SAGb,MAAMW,GACT,YAAYC,EAAa9hB,EAAMpY,KAAYlH,GACvCkI,KAAKu3B,MAAO,EACZv3B,KAAKu4B,YAAa,EAClBv4B,KAAKw4B,aAAc,EACnBx4B,KAAKs4B,QAAUZ,QAAQva,IAAI+b,EAAY/gC,IAAIzB,GAAKA,EAAE+gC,SAASgB,KAAK,KAC5D,IAAyB,IAArBz4B,KAAKw4B,YACL,OAEJx4B,KAAKu4B,YAAa,EAClB,MAAMG,EAAathB,EAAKzhB,KAAKqJ,KAAYlH,GACzC,QAAmB,IAAf4gC,EAIA,OAAOA,EAAWjB,OAAOgB,KAAK,KAC1Bz4B,KAAKu3B,MAAO,IAJhBv3B,KAAKu3B,MAAO,IASxB,YACI,OAAQv3B,KAAKu4B,WAEjB,SACQv4B,KAAKw3B,cACLx3B,KAAKw4B,aAAc,GAG3B,OACI,OAAOx4B,KAAKs4B,SAGb,MAAMF,GACT,YAAYc,GACRl5B,KAAKu3B,MAAO,EACZv3B,KAAKs4B,QAAUZ,QAAQva,IAAI+b,EAAY/gC,IAAIzB,GAAKA,EAAE+gC,SAASgB,KAAK,KAC5Dz4B,KAAKu3B,MAAO,IAGpB,YACI,OAAO,EAEX,UAGA,OACI,OAAOv3B,KAAKs4B,SAGb,SAASa,GAAa1iC,GACzB,aAAmB,IAAVA,IAAmC,IAAfA,EAAM8gC,MCxVvC,IAAI,GAA0C,SAAUt9B,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAQ3D,IAAI,GAAK,MACL,YAAYkuB,EAAWvC,GACnB72B,KAAKo5B,UAAYA,EACjBp5B,KAAK62B,SAAWA,EAChB72B,KAAK0U,GAAK,YAAO,gBACjB1U,KAAKq5B,iBAAc,EACnBr5B,KAAKs5B,cAAW,EAChBt5B,KAAKu5B,YAAS,EACdv5B,KAAK82B,UAAO,EACZ92B,KAAK4rB,KAAO0L,GAAcC,KAC1Bv3B,KAAKvJ,OAAQ,EAGjB,WAAW4d,GAOP,OANIrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKw5B,KAAKx5B,KAAKvJ,MAAO4d,GAGlCrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKw5B,KAAMx5B,KAAMA,KAAKvJ,MAAO4d,GAEtErU,KAAK4rB,KAEhB,aAAavX,GACLrU,KAAK4rB,KAAK2L,KACVv3B,KAAKy5B,WAAWplB,GAGhBrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKy5B,WAAYz5B,KAAMqU,GAG3E,aAAaA,GAST,YARkB,IAAdrU,KAAK82B,OACD92B,KAAK4rB,KAAK2L,KACVv3B,KAAK82B,KAAKI,OAAO7iB,GAGjBrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAK82B,KAAKI,OAAQl3B,KAAK82B,KAAMziB,IAG1ErU,KAAK4rB,KAEhB,aAAavX,GAST,YARkB,IAAdrU,KAAK82B,OACD92B,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAK82B,KAAKtX,OAAOnL,GAG7BrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAK82B,KAAKtX,OAAQxf,KAAK82B,KAAMziB,IAG1ErU,KAAK4rB,KAEhB,QAAQvX,QACgB,IAAhBrU,KAAKu5B,QAAqBv5B,KAAKu5B,OAAOG,QAAQrlB,KAC9CrU,KAAKu5B,YAAS,QAEI,IAAlBv5B,KAAKs5B,UAAuBt5B,KAAKs5B,SAASI,QAAQrlB,KAClDrU,KAAKs5B,cAAW,GAEpBt5B,KAAK82B,UAAO,EAEhB,aAAa3iB,EAAUoB,EAAUlB,GACsB,IAArB,EAAzBrU,KAAKg3B,YAAYtzB,SAGlB1D,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKw5B,KAAKx5B,KAAKvJ,MAAO4d,GAGlCrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKw5B,KAAMx5B,KAAMA,KAAKvJ,MAAO4d,IAIjF,WAAW5d,EAAO4d,GACd,IAAIyiB,EAUJ,OARIA,EADArgC,EACOuJ,KAAKu5B,OAASv5B,KAAK25B,WAAW35B,KAAKu5B,OAAQv5B,KAAKo5B,UAAW/kB,GAEzC,MAApBrU,KAAKq5B,YACHr5B,KAAKs5B,SAAWt5B,KAAK25B,WAAW35B,KAAKs5B,SAAUt5B,KAAKq5B,YAAahlB,QAGjE,EAEJyiB,EAGX,WAAWA,EAAMhwB,EAASuN,GAKtB,YAJa,IAATyiB,IACAA,EAAOhwB,EAAQhQ,OAAOud,IAE1ByiB,EAAKC,KAAK/2B,KAAK62B,SAAU,GAClBC,EAEX,KAAKrgC,EAAO4d,GACR,IAAIuX,EAAO0L,GAAcC,KAKzB,KAJe,IAAV9gC,QAAoC,IAAlBuJ,KAAKs5B,WACV,IAAV7iC,QAAkC,IAAhBuJ,KAAKu5B,UAC3B3N,EAAO5rB,KAAK45B,WAAWvlB,IAEvBuX,EAAK2L,KAAM,CACX,MAAMT,EAAO92B,KAAK65B,WAAWpjC,EAAO4d,GACpCuX,EAAO5rB,KAAK85B,SAAShD,EAAMziB,QAG3BuX,EAAO,IAAIyM,GAAYzM,EAAK6L,OAAOgB,KAAK,IAAMz4B,KAAK65B,WAAWpjC,EAAO4d,IAASrU,KAAK85B,SAAU95B,KAAMqU,GAEvG,OAAOuX,EAEX,WAAWvX,GACP,MAAMyiB,EAAO92B,KAAK82B,KAClB,QAAa,IAATA,EACA,OAAOQ,GAAcC,KAEzBT,EAAKI,OAAO7iB,GACZ,MAAMuX,EAAOkL,EAAKtX,OAAOnL,GAEzB,OADAyiB,EAAK/7B,YAAS,EACP6wB,EAEX,SAASkL,EAAMziB,GAEX,GADArU,KAAK82B,KAAOA,OACC,IAATA,EACA,OAAOQ,GAAcC,KAEzB,IAAI3L,EAAO5rB,KAAK+5B,SAAS1lB,GACzB,OAAuD,IAAzB,GAAzBrU,KAAKg3B,YAAYtzB,OACXkoB,GAEPA,EAAK2L,KACLv3B,KAAKy5B,WAAWplB,GAGhBuX,EAAO,IAAIkN,GAAiBlN,EAAM5rB,KAAKy5B,WAAYz5B,KAAMqU,GAEtDuX,GAEX,SAASvX,GACL,YAAkB,IAAdrU,KAAK82B,OAA6C,EAAzB92B,KAAKg3B,YAAYtzB,OAAoC,GAC9E1D,KAAK82B,KAAK/7B,OAASiF,KAAKg3B,YACjBh3B,KAAK82B,KAAK9/B,KAAKqd,EAAOrU,KAAKg3B,YAAYvpB,MAAOzN,KAAKg3B,YAAYrd,OAEnE2d,GAAcC,KAEzB,WAAWljB,QACW,IAAdrU,KAAK82B,OAA6C,GAAzB92B,KAAKg3B,YAAYtzB,OAA0C,GACpF1D,KAAK82B,KAAKG,OAAO5iB,KAI7B,GAAW,CACP,GACA,GAAW,cAAe8c,UAC3B,GAAG/5B,UAAW,aAAS,GAC1B,GAAK,GAAW,CACZg9B,GAAmB,MACnB,GAAQ,EAAG5d,GACX,GAAQ,EAAGoe,IACX,GAAW,oBAAqB,CAAC1+B,OAAQA,UAC1C,IAEH,IAAI,GAAO,MACP,YAAY4Q,GACR9G,KAAK8G,QAAUA,EACf9G,KAAK0U,GAAK,YAAO,gBAErB,KAAKslB,GACD,GAAIA,aAAsB,GACtBA,EAAWX,YAAcr5B,KAAK8G,YAE7B,MAAIkzB,EAAWC,qBAAqB,IAIrC,MAAM,IAAIx5B,MAAM,0BAHhBu5B,EAAWC,UAAUZ,YAAcr5B,KAAK8G,WAOpD,GAAO,GAAW,CACdstB,GAAmB,QACnB,GAAQ,EAAG5d,GACX,GAAW,oBAAqB,CAACtgB,UAClC,ICvMH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAW3D,IAAI,GAAS,MACT,YAAY2rB,EAAUqD,EAAYpzB,GAC9B9G,KAAK62B,SAAWA,EAChB72B,KAAKk6B,WAAaA,EAClBl6B,KAAK8G,QAAUA,EACf9G,KAAK0U,GAAK,YAAO,gBACjB1U,KAAKm6B,4BAA6B,EAClCn6B,KAAK2c,cAAW,EAChB3c,KAAKo6B,MAAQ,GACbp6B,KAAKjJ,SAAM,EACXiJ,KAAK4rB,KAAO0L,GAAcC,KAC1Bv3B,KAAKq6B,qBAAkB,EAE3B,WAAWhmB,GACPrU,KAAKs6B,wBAAwBjmB,GAC7B,MAAMkmB,EAAWv6B,KAAKk6B,WAAWK,UAC3B,OAAEjgC,GAAWigC,EACnB,IAAIvc,EACJ,IAAK,IAAIxoB,EAAI,EAAGA,EAAI8E,IAAU9E,EAE1B,GADAwoB,EAAUuc,EAAS/kC,GACfwoB,EAAQlkB,SAAWkG,MAAmC,UAA3Bge,EAAQ6R,eAA4B,CAC/D7vB,KAAKw6B,MAAQxc,EAAQ4R,iBACrB,MAMR,OAHA5vB,KAAKy6B,MAAQz6B,KAAKw6B,MAAMjX,YAAYnE,SAAS/K,EAAOrU,KAAKg3B,YAAYvpB,MAAO,MAC5EzN,KAAK06B,iBAAiBrmB,GACtBrU,KAAK26B,uBAAkB,EAAQtmB,GACxBrU,KAAK4rB,KAEhB,aAAavX,GACLrU,KAAK4rB,KAAK2L,KACVv3B,KAAK46B,iBAAY,EAAQvmB,GAGzBrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAK46B,YAAa56B,UAAM,EAAQqU,GAGpF,aAAaA,GACLrU,KAAK4rB,KAAK2L,KACVv3B,KAAK66B,mBAAmB,EAAG76B,KAAKo6B,MAAM9/B,OAAQ+Z,GAG9CrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAK66B,mBAAoB76B,KAAM,EAAGA,KAAKo6B,MAAM9/B,OAAQ+Z,GAGzG,aAAaA,GAQT,OAPArU,KAAKs6B,wBAAwBjmB,GACzBrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAK86B,4BAA4B,EAAG96B,KAAKo6B,MAAM9/B,OAAQ+Z,GAAO,GAG1ErU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAK86B,4BAA6B96B,KAAM,EAAGA,KAAKo6B,MAAM9/B,OAAQ+Z,GAAO,GAE9GrU,KAAK4rB,KAGhB,aAAavX,GACTA,GAASrU,KAAKg3B,YAAY3iB,MAC1BrU,KAAKs6B,wBAAwBjmB,GAC7BA,GAAS,GACTrU,KAAK06B,iBAAiBrmB,GACtBrU,KAAK26B,uBAAkB,EAAQtmB,GAGnC,uBAAuBU,EAAUV,GAC7BA,GAASrU,KAAKg3B,YAAY3iB,MAC1BA,GAAS,IACTrU,KAAK06B,iBAAiBrmB,GACtBrU,KAAK26B,kBAAkB5lB,EAAUV,GAErC,kBAAkBU,EAAUV,GACxB,MAAM0mB,EAAY/6B,KAAKo6B,MAAM9/B,YACZ,IAAbya,IAC8B,EAAzB/U,KAAKg3B,YAAYtzB,OAAoC,IACtD1D,KAAK66B,mBAAmB,EAAGE,EAAW1mB,GAClCrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAK86B,4BAA4B,EAAGC,EAAW1mB,GAAO,GAGlErU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAK86B,4BAA6B96B,KAAM,EAAG+6B,EAAW1mB,GAAO,GAEzGrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKg7B,sBAAsB3mB,GAGvCrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKg7B,sBAAuBh7B,KAAMqU,KAGxD,GAAzBrU,KAAKg3B,YAAYtzB,OAA0C,IACxD1D,KAAK4rB,KAAK2L,KACVv3B,KAAKi7B,iBAAiB5mB,GAGtBrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKi7B,iBAAkBj7B,KAAMqU,O1B2atF,SAAiCU,GACpC,IAAImmB,EAAS,EACT56B,EAAI,EACR,MAAMzC,EAAMkX,EAASza,OACrB,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAAOrI,EAAG,CAC1B,KAAOuf,EAAS+P,aAAaxkB,IAAM9K,EAAI0lC,KACjC56B,IACA46B,GAEe,IAAjBnmB,EAASvf,KACP0lC,EAGFnmB,EAASvf,IAAM0lC,G0BnbfC,CAAwBpmB,IACM,EAAzB/U,KAAKg3B,YAAYtzB,OAAoC,IAElDqR,EAAS+P,aAAaxqB,OAAS,IAC/Bya,EAAS+P,aAAalU,KAAK,KACvB5Q,KAAK4rB,KAAK2L,KACVv3B,KAAKo7B,iBAAiBrmB,EAAUV,GAGhCrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKo7B,iBAAkBp7B,KAAM+U,EAAUV,GAEnFrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKq7B,0BAA0BtmB,EAAUV,GAGrDrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKq7B,0BAA2Br7B,KAAM+U,EAAUV,IAIhGrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKs7B,2BAA2BvmB,EAAUV,GAGtDrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKs7B,2BAA4Bt7B,KAAM+U,EAAUV,KAGvE,GAAzBrU,KAAKg3B,YAAYtzB,OAA0C,IACxD1D,KAAK4rB,KAAK2L,KACVv3B,KAAKu7B,eAAeR,EAAWhmB,EAAUV,GAGzCrU,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKu7B,eAAgBv7B,KAAM+6B,EAAWhmB,EAAUV,KAM5G,wBAAwBA,GACpB,MAAMmnB,EAAcx7B,KAAK2c,SACzB,GAAa,KAARtI,OACmB,IAAhBmnB,GACAA,EAAYzoB,0BAA0B/S,WAGzC,IAA8B,EAAzBA,KAAKg3B,YAAYtzB,OAAoC,EAAG,CAC9D,MAAM+3B,EAAcz7B,KAAK2c,SAAW6S,GAAsBnb,EAAOrU,KAAKg3B,YAAYrgB,UAAW3W,KAAK07B,OAC9FF,IAAgBC,GAAeD,GAC/BA,EAAYzoB,0BAA0B/S,MAEtCy7B,GACAA,EAAY3oB,sBAAsB9S,OAI9C,iBAAiBqU,GACb,MAAMqnB,EAAQ17B,KAAK07B,MACnB,GAAIA,aAAiBvhC,MAEjB,YADA6F,KAAKq6B,gBAAkBqB,GAI3B,QAAc,IADA17B,KAAKw6B,MAEf,OAEJ,MAAMH,EAAkB,GACxBr6B,KAAKw6B,MAAMmB,QAAQtnB,EAAOqnB,EAAO,CAAC78B,EAAKqG,EAAOxF,KAC1C26B,EAAgBn1B,GAASxF,IAE7BM,KAAKq6B,gBAAkBA,EAE3B,mBAAmBuB,EAAQC,EAAMxnB,GAC7B,MAAM+lB,EAAQp6B,KAAKo6B,MAEnB,IAAItD,EADJ92B,KAAKg3B,YAAYrgB,UAAUyB,YAAYrB,QAEvC,IAAK,IAAIvhB,EAAIomC,EAAQpmC,EAAIqmC,IAAQrmC,EAC7BshC,EAAOsD,EAAM5kC,GACbshC,EAAK4C,QAAQrlB,GACbyiB,EAAKI,OAAO7iB,GAEhBrU,KAAKg3B,YAAYrgB,UAAUyB,YAAYpB,IAAI3C,GAE/C,4BAA4BunB,EAAQC,EAAMxnB,EAAOynB,GAC7C,MAAM1B,EAAQp6B,KAAKo6B,MACnB,IACIxO,EAEAkL,EAHAmB,OAAQ,EAEZj4B,KAAKg3B,YAAYrgB,UAAUe,YAAYX,QAEvC,IAAK,IAAIvhB,EAAIomC,EAAQpmC,EAAIqmC,IAAQrmC,EAC7BshC,EAAOsD,EAAM5kC,GACbo2B,EAAOkL,EAAKtX,OAAOnL,GACnByiB,EAAK/7B,YAAS,EACT6wB,EAAK2L,YACQpyB,IAAV8yB,IACAA,EAAQ,IAEZA,EAAMp4B,KAAK+rB,IAMnB,OAHIkQ,IACA97B,KAAKo6B,MAAM9/B,OAASshC,QAEVz2B,IAAV8yB,GACAj4B,KAAKg3B,YAAYrgB,UAAUe,YAAYV,IAAI3C,GACpCijB,GAAcC,MAElB,IAAI0B,GAA0BhB,EAAOj4B,KAAKg3B,YAAYrgB,UAAUe,YAAYV,IAAKhX,KAAKg3B,YAAYrgB,UAAUe,YAAarD,GAEpI,iBAAiBU,EAAUV,GACvB,MAAM+lB,EAAQp6B,KAAKo6B,MACnBp6B,KAAKg3B,YAAYrgB,UAAUyB,YAAYrB,QACvC,MAAMwR,EAAUxT,EAAS+P,aACnBiX,EAAaxT,EAAQjuB,OAC3B,IAAIw8B,EACJ,IAAK,IAAIthC,EAAI,EAAGA,EAAIumC,IAAcvmC,EAC9BshC,EAAOsD,EAAM7R,EAAQ/yB,IACrBshC,EAAK4C,QAAQrlB,GACbyiB,EAAKI,OAAO7iB,GAEhBrU,KAAKg3B,YAAYrgB,UAAUyB,YAAYpB,IAAI3C,GAE/C,0BAA0BU,EAAUV,GAChC,MAAM+lB,EAAQp6B,KAAKo6B,MACnB,IACIxO,EADAqM,OAAQ,EAEZj4B,KAAKg3B,YAAYrgB,UAAUe,YAAYX,QACvC,MAAMwR,EAAUxT,EAAS+P,aACnBiX,EAAaxT,EAAQjuB,OAC3B,IAAIw8B,EACAthC,EAAI,EACR,KAAOA,EAAIumC,IAAcvmC,EACrBshC,EAAOsD,EAAM7R,EAAQ/yB,IACrBo2B,EAAOkL,EAAKtX,OAAOnL,GACnByiB,EAAK/7B,YAAS,EACT6wB,EAAK2L,YACQpyB,IAAV8yB,IACAA,EAAQ,IAEZA,EAAMp4B,KAAK+rB,IAGnBp2B,EAAI,EACJ,IAAI8K,EAAI,EACR,KAAO9K,EAAIumC,IAAcvmC,EACrB8K,EAAIioB,EAAQ/yB,GAAKA,EACjBwK,KAAKo6B,MAAMxoB,OAAOtR,EAAG,GAEzB,YAAc6E,IAAV8yB,GACAj4B,KAAKg3B,YAAYrgB,UAAUe,YAAYV,IAAI3C,GACpCijB,GAAcC,MAElB,IAAI0B,GAA0BhB,EAAOj4B,KAAKg3B,YAAYrgB,UAAUe,YAAYV,IAAKhX,KAAKg3B,YAAYrgB,UAAUe,YAAarD,GAEpI,sBAAsBA,GAClB,IACIuX,EACAkL,EACAkF,EAHA/D,OAAQ,EAIZ,MAAMjB,EAAch3B,KAAKg3B,YACnBrgB,EAAYqgB,EAAYrgB,UACxBoD,EAAcid,EAAYvpB,MAChCkJ,EAAUW,UAAUP,QACpB,MAAM4C,EAAOqd,EAAYrd,KACnB7S,EAAU9G,KAAK8G,QACf2zB,EAAQz6B,KAAKy6B,MACbiB,EAAQ17B,KAAK07B,MACbO,EAASj8B,KAAKw6B,MAAM0B,MAAM7nB,EAAOqnB,GACjCtB,EAAQp6B,KAAKo6B,MAAQjgC,MAAM8hC,GAcjC,OAbAj8B,KAAKw6B,MAAMmB,QAAQtnB,EAAOqnB,EAAO,CAAC78B,EAAKrJ,EAAGkK,KACtCo3B,EAAOsD,EAAM5kC,GAAKsR,EAAQhQ,OAAOud,GACjCyiB,EAAK/7B,OAASi8B,EACdgF,EAAY,EAAMG,WAAW9nB,EAAO0F,EAAa,EAAejjB,OAAOud,EAAOomB,EAAO/6B,IACrF08B,GAAwBJ,EAAUpiB,gBAAiBpkB,EAAGymC,GACtDrQ,EAAOkL,EAAK9/B,KAAKqd,EAAO2nB,EAAWriB,GAC9BiS,EAAK2L,YACQpyB,IAAV8yB,IACAA,EAAQ,IAEZA,EAAMp4B,KAAK+rB,WAGLzmB,IAAV8yB,GACAthB,EAAUW,UAAUN,IAAI3C,GACjBijB,GAAcC,MAElB,IAAI0B,GAA0BhB,EAAOthB,EAAUW,UAAUN,IAAKL,EAAUW,UAAWjD,GAE9F,2BAA2BU,EAAUV,GACjC,IACIuX,EACAkL,EACAkF,EAHA/D,OAAQ,EAIZ,MAAMnxB,EAAU9G,KAAK8G,QACfszB,EAAQp6B,KAAKo6B,MACbK,EAAQz6B,KAAKy6B,MACbJ,EAAkBr6B,KAAKq6B,gBACvBrD,EAAch3B,KAAKg3B,YACnBrgB,EAAYqgB,EAAYrgB,UACxBoD,EAAcid,EAAYvpB,MAChCkJ,EAAUW,UAAUP,QACpB,MAAM4C,EAAOqd,EAAYrd,KACnB0iB,EAAStnB,EAASza,OACxB,IAAK,IAAI9E,EAAI,EAAGA,EAAI6mC,IAAU7mC,GACL,IAAjBuf,EAASvf,KACTshC,EAAOhwB,EAAQhQ,OAAOud,GAEtByiB,EAAK/7B,OAASi8B,EACdgF,EAAY,EAAMG,WAAW9nB,EAAO0F,EAAa,EAAejjB,OAAOud,EAAOomB,EAAOJ,EAAgB7kC,KACrG4mC,GAAwBJ,EAAUpiB,gBAAiBpkB,EAAG6mC,GAEtDzQ,EAAOkL,EAAK9/B,KAAKqd,EAAO2nB,EAAWriB,GACnCygB,EAAMxoB,OAAOpc,EAAG,EAAGshC,GACdlL,EAAK2L,YACQpyB,IAAV8yB,IACAA,EAAQ,IAEZA,EAAMp4B,KAAK+rB,KAIvB,GAAIwO,EAAM9/B,SAAW+hC,EAEjB,MAAM,IAAI57B,MAAM,YAAY25B,EAAM9/B,kBAAkB+hC,KAExD,YAAcl3B,IAAV8yB,GACAthB,EAAUW,UAAUN,IAAI3C,GACjBijB,GAAcC,MAElB,IAAI0B,GAA0BhB,EAAOthB,EAAUW,UAAUN,IAAKL,EAAUW,UAAWjD,GAE9F,YAAYU,EAAUV,GAClB,IAAIyiB,EACJ,MAAMsD,EAAQp6B,KAAKo6B,MACbvD,EAAW72B,KAAK62B,SAChBlgB,EAAY3W,KAAKg3B,YAAYrgB,UAEnC,GADAA,EAAUoB,YAAYhB,aACL,IAAbhC,EACA,IAAK,IAAIvf,EAAI,EAAGkS,EAAK0yB,EAAM9/B,OAAQ9E,EAAIkS,IAAMlS,EACzCshC,EAAOsD,EAAM5kC,GACbshC,EAAKC,KAAKF,EAAU,GACpBC,EAAKwF,MAAMC,SACXzF,EAAKG,OAAO5iB,QAIhB,IAAK,IAAI7e,EAAI,EAAGkS,EAAK0yB,EAAM9/B,OAAQ9E,EAAIkS,IAAMlS,EACrCuf,EAASvf,KAAOA,IAChBshC,EAAOsD,EAAM5kC,GACbshC,EAAKC,KAAKF,EAAU,GACpBC,EAAKwF,MAAMC,SACXzF,EAAKG,OAAO5iB,IAIxBsC,EAAUoB,YAAYf,IAAI3C,GAE9B,iBAAiBA,GACb,IAAIyiB,EACJ,MAAM,MAAEsD,EAAK,SAAEvD,GAAa72B,KAC5BA,KAAKg3B,YAAYrgB,UAAUoB,YAAYhB,QACvC,IAAK,IAAIvhB,EAAI,EAAGkS,EAAK0yB,EAAM9/B,OAAQ9E,EAAIkS,IAAMlS,EACzCshC,EAAOsD,EAAM5kC,GACbshC,EAAKC,KAAKF,EAAU,GACpBC,EAAKwF,MAAMC,SACXzF,EAAKG,OAAO5iB,GAEhBrU,KAAKg3B,YAAYrgB,UAAUoB,YAAYf,IAAI3C,GAE/C,eAAe0mB,EAAWhmB,EAAUV,GAEhC,MAAMwiB,EAAW72B,KAAK62B,SAChBuD,EAAQp6B,KAAKo6B,MACb6B,EAASlnB,EAASza,Q1B4KzB,SAA4BohC,EAAO3mB,GACtC,MAAMynB,EAAOd,EAAMh9B,QACbb,EAAMkX,EAASza,OACrB,IAAIgrB,EAAK,EACL5b,EAAO,EACX,KAAO4b,EAAKznB,GACR6L,EAAOqL,EAASuQ,IACF,IAAV5b,IACAgyB,EAAMpW,GAAMkX,EAAK9yB,MAEnB4b,E0BrLFmX,CAAmBrC,EAAOrlB,GAG1B,MAAM2nB,EAsDP,SAAsC3nB,GACzC,MAAMlX,EAAMkX,EAASza,OACjBuD,EAAM8+B,KACNA,GAAS9+B,EACT++B,GAAc,IAAIC,WAAWh/B,GAC7Bi/B,GAAc,IAAID,WAAWh/B,IAEjC,IAAIk/B,EAAS,EACT1lB,EAAM,EACN2lB,EAAO,EACPxnC,EAAI,EACJ8K,EAAI,EACJ28B,EAAM,EACNC,EAAO,EACPC,EAAM,EACV,KAAO3nC,EAAIqI,EAAKrI,IAEZ,GADA6hB,EAAMtC,EAASvf,IACF,IAAT6hB,EAAY,CAGZ,GAFA/W,EAAIs8B,GAAYG,GAChBC,EAAOjoB,EAASzU,IACF,IAAV08B,GAAeA,EAAO3lB,EAAK,CAC3BylB,GAAYtnC,GAAK8K,EACjBs8B,KAAcG,GAAUvnC,EACxB,SAIJ,IAFAynC,EAAM,EACNC,EAAOH,EACAE,EAAMC,GACTC,EAAOF,EAAMC,GAAS,EACtBF,EAAOjoB,EAAS6nB,GAAYO,KACd,IAAVH,GAAeA,EAAO3lB,EACtB4lB,EAAME,EAAM,EAGZD,EAAOC,EAGfH,EAAOjoB,EAAS6nB,GAAYK,KACxB5lB,EAAM2lB,IAAkB,IAAVA,KACVC,EAAM,IACNH,GAAYtnC,GAAKonC,GAAYK,EAAM,IAEvCL,GAAYK,GAAOznC,GAI/BA,IAAMunC,EACN,MAAMlgC,EAAS,IAAIggC,WAAWrnC,GAC9B6hB,EAAMulB,GAAYG,EAAS,GAC3B,KAAOA,KAAW,GACdlgC,EAAOkgC,GAAU1lB,EACjBA,EAAMylB,GAAYzlB,GAEtB,KAAO7hB,KAAM,GACTonC,GAAYpnC,GAAK,EACrB,OAAOqH,EA7GSugC,CAA6BroB,GACnCsoB,EAASX,EAAIpiC,OAGnB,IAAI8c,EAFJpX,KAAKg3B,YAAYrgB,UAAUoB,YAAYhB,QACvC1C,GAAS,SAET,IAEIyiB,EAFAx2B,EAAI+8B,EAAS,EACb7nC,EAAIymC,EAAS,EAEjB,KAAOzmC,GAAK,IAAKA,EACbshC,EAAOsD,EAAM5kC,IACQ,IAAjBuf,EAASvf,IACT4mC,GAAwBtF,EAAKrpB,MAAMmM,gBAAiBpkB,EAAGymC,GACvDnF,EAAKC,KAAKF,EAAU,GACpBC,EAAKG,OAAO5iB,IAEP/T,EAAI,GAAgB,IAAX+8B,GAAgB7nC,IAAMknC,EAAIp8B,IACxC87B,GAAwBtF,EAAKrpB,MAAMmM,gBAAiBpkB,EAAGymC,GACvDnF,EAAKG,OAAO5iB,KAGR0mB,IAAckB,GACdG,GAAwBtF,EAAKrpB,MAAMmM,gBAAiBpkB,EAAGymC,KAEzD37B,GAEN8W,EAAOgjB,EAAM5kC,EAAI,QACJ,IAAT4hB,EACA0f,EAAKwF,MAAMgB,KAAKlmB,EAAKklB,OAGrBxF,EAAKwF,MAAMgB,KAAKzG,GAGxB72B,KAAKg3B,YAAYrgB,UAAUoB,YAAYf,IAAI3C,KAGnD,GAAW,CACP,GACA,GAAW,cAAene,SAC3B,GAAOkB,UAAW,aAAS,GAC9B,GAAS,GAAW,CAChBg9B,GAAmB,UACnB,GAAQ,EAAGQ,IACX,GAAQ,EAAGte,GACX,GAAQ,EAAGE,GACX,GAAW,oBAAqB,CAACtgB,OAAQA,OAAQA,UAClD,IAEH,IAAIymC,GAAS,GACTC,GAAc,IAAIC,WAAWF,IAC7BG,GAAc,IAAID,WAAWF,IA6DjC,SAASP,GAAwBliB,EAAIhV,EAAO5K,GACxC,MAAM22B,EAAoB,IAAV/rB,EACVq4B,EAASr4B,IAAU5K,EAAS,EAC5BkjC,EAASt4B,EAAQ,GAAM,EAC7BgV,EAAGujB,OAASv4B,EACZgV,EAAGwjB,OAASzM,EACZ/W,EAAGyjB,MAAQJ,EACXrjB,EAAG0jB,SAAW3M,IAAYsM,EAC1BrjB,EAAG2jB,MAAQL,EACXtjB,EAAG4jB,MAAQN,EACXtjB,EAAG6jB,QAAUzjC,ECpgBjB,IAMI,GAA0C,SAAUZ,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAM3D,IAAI,GAAc,MACd,YAAYpE,EAAS+vB,GACjB72B,KAAK8G,QAAUA,EACf9G,KAAK62B,SAAWA,EAChB72B,KAAK0U,GAAK,YAAO,gBACjB1U,KAAK82B,KAAO92B,KAAK8G,QAAQhQ,SACzBkJ,KAAK82B,KAAKC,KAAKF,EAAU,GAE7B,WAAWxiB,GAEP,OADArU,KAAK82B,KAAK/7B,OAASiF,KAAKg3B,YACjBh3B,KAAK82B,KAAK9/B,KAAa,SAARqd,EAAkDrU,KAAKg3B,YAAYvpB,MAAOzN,KAAK8G,QAAQ/Q,MAEjH,aAAase,GACTrU,KAAK82B,KAAKG,OAAO5iB,GAErB,aAAaA,GACTrU,KAAK82B,KAAKI,OAAO7iB,GAErB,aAAaA,GACT,MAAMuX,EAAO5rB,KAAK82B,KAAKtX,OAAOnL,GAE9B,OADArU,KAAK82B,KAAK/7B,YAAS,EACZ6wB,IAGf,GAxC8C,SAAU3xB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAoClD,CAAW,CACrB89B,GAAmB,eACnB,GAAQ,EAAG5d,GACX,GAAQ,EAAGoe,IACX,GAAW,oBAAqB,CAAC1+B,OAAQA,UAC1C,IC7CH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAQ3D,IAAI,GAAO,MACP,YAAYpE,EAAS+vB,GACjB72B,KAAK8G,QAAUA,EACf9G,KAAK62B,SAAWA,EAChB72B,KAAK0U,GAAK,YAAO,gBACjB1U,KAAK0U,GAAK,YAAO,gBACjB1U,KAAK82B,KAAO92B,KAAK8G,QAAQhQ,SACzBkJ,KAAK82B,KAAKC,KAAKF,EAAU,GAE7B,aAAa1iB,EAAUoB,EAAUlB,IACC,EAAzBrU,KAAKg3B,YAAYtzB,OAAoC,GACtD1D,KAAKg+B,UAAU,MAGvB,WAAW3pB,GACPrU,KAAK82B,KAAK/7B,OAASiF,KAAKg3B,YACxBh3B,KAAKg+B,UAAU3pB,GAEnB,aAAaA,GACTrU,KAAK82B,KAAKG,OAAO5iB,GAErB,aAAaA,GACTrU,KAAK82B,KAAKI,OAAO7iB,GAErB,aAAaA,GACTrU,KAAK82B,KAAKtX,OAAOnL,GACjBrU,KAAK82B,KAAK/7B,YAAS,EAEvB,UAAUsZ,GACN,MAAM5G,EAAQ,EAAM0uB,WAAW9nB,EAAOrU,KAAKg3B,YAAYvpB,WAAsB,IAAfzN,KAAKvJ,MAAmB,GAAKuJ,KAAKvJ,OAChGuJ,KAAK82B,KAAK9/B,KAAKqd,EAAO5G,EAAOzN,KAAKg3B,YAAYrd,QAGtD,GAAW,CACP,GACA,GAAW,cAAezjB,SAC3B,GAAKkB,UAAW,aAAS,GAC5B,GAAO,GAAW,CACdg9B,GAAmB,QACnB,GAAQ,EAAG5d,GACX,GAAQ,EAAGoe,IACX,GAAW,oBAAqB,CAAC1+B,OAAQA,UAC1C,IC5DH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IA0C1G,SAASizB,GAA6BlnC,GAClC,OAAOA,EAAI0L,WAAWy7B,GAASnoC,MAE5B,MAAMmoC,GAAW,CACpBnoC,KAAM,IAASsM,WAAWE,OAAO,qBACjC4Z,QAAQpmB,GACG,GAAGmoC,GAASnoC,QAAQA,IAE/B,QAAQooC,GACJ,MAAMC,EAAoB,GAEpBhkC,EAAUD,MAAMC,QACtB,SAASg5B,EAAQr9B,GACbqoC,EAAkBroC,GAAQ,GAAmBe,OAAOf,GAiBxD,OADAooC,EAAsBttB,SAXtB,SAAiBwiB,GACTj5B,EAAQi5B,GACRA,EAAUxiB,QAAQuiB,GAEbC,aAAqB,GAC1B+K,EAAkB/K,EAAUl8B,UAAYk8B,OAErB,IAAdA,GACLn9B,OAAOsD,KAAK65B,GAAWxiB,QAAQ9a,GAXvC,SAAwBA,EAAM8M,GAC1Bu7B,EAAkBroC,GAAQ,GAAmBe,OAAOf,EAAM8M,GAUfywB,CAAev9B,EAAMs9B,OAI7D+K,GAEX,OAAOr9B,GACH,MAAM6yB,EAAYsK,GAASnoC,KAAKuE,OAAS,EACnCwO,EAAO,GACP+qB,EAAiB,YAAkB9yB,GACzC,IAEIvH,EACAs6B,EACAC,EAJAC,EAASH,EAAev5B,OACxB25B,EAAQ,EAIZ,OAASD,GAAU,GAAG,CAClBD,EAAQF,EAAeG,GACvBx6B,EAAO,IAAS6I,WAAWhG,QAAQ03B,GAAO9pB,OAAOg0B,IACjDnK,EAAUt6B,EAAKc,OACf,IAAK,IAAI9E,EAAI,EAAGA,EAAIs+B,IAAWt+B,EAC3BsT,EAAKmrB,KAAW,IAAS73B,OAAO8hC,GAASnoC,KAAMg+B,EAAOv6B,EAAKhE,GAAGkJ,MAAMk1B,IAG5E,OAAO9qB,IAGR,MAAM,GACT,YAAYtK,EAAUrH,EAAUknC,EAASC,EAAOr0B,EAAQ9R,GACpD6H,KAAKxB,SAAWA,EAChBwB,KAAK7I,SAAWA,EAChB6I,KAAKq+B,QAAUA,EACfr+B,KAAKs+B,MAAQA,EACbt+B,KAAKiK,OAASA,EACdjK,KAAK7H,IAAMA,EAEf,cAAcmK,EAAMO,EAAM,IACtB,OAAO,IAAI,GAAmB,YAAaA,EAAIrE,SAAU,GAAG8D,YAAgB,YAAaO,EAAI1L,SAAUmL,GAAOO,EAAIw7B,QAASx7B,EAAIy7B,MAAOz7B,EAAIoH,OAAQpH,EAAI1K,MAI9J,IAAI,GAAwC,MACxC,YAAY8e,EAAY1a,EAAK8X,EAAO7b,EAAa64B,EAAQiN,EAAQC,GAAmBt0B,EAASu0B,GAAoBrmC,EAAMsmC,GAAiBJ,GACpIr+B,KAAKiX,WAAaA,EAClBjX,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAKs+B,MAAQA,EACbt+B,KAAKiK,OAASA,EACdjK,KAAK7H,IAAMA,EACX6H,KAAKq+B,QAAUA,EACfr+B,KAAKgZ,WAAY,EACjBhZ,KAAK0+B,cAAW,EAChB1+B,KAAKxB,SAAWjC,EAAI80B,GACpBrxB,KAAKiZ,gBAA0B,WAAR5E,EACvBrU,KAAK4xB,qBAET,WAEI,OADA5xB,KAAK2+B,oBACE3+B,KAAK0+B,SAEhB,SAASvqB,IACT,UAAUnB,GACNhT,KAAK2+B,oBACL3+B,KAAKiS,cAAce,GAEvB,oBACI,IAAKhT,KAAKgZ,UAAW,CACjBhZ,KAAKgZ,WAAY,EACjB,MAAM4lB,EAAY5+B,KAAKiX,WAAW2nB,UAClC5+B,KAAK0+B,SAAWG,GAAeD,EAAW5+B,KAAKs+B,MAAOt+B,KAAKiK,OAAQjK,KAAK7H,KACxEymC,EAAUE,0BAA0B,KAAQ9+B,KAAK++B,qBAAwB/+B,KAAKq+B,UAGtF,oBACIr+B,KAAK0+B,SAAWG,GAAe7+B,KAAKiX,WAAW2nB,UAAW5+B,KAAKs+B,MAAOt+B,KAAKiK,OAAQjK,KAAK7H,UAClE,IAAlB6H,KAAKxB,UACLwB,KAAKxB,SAAS7I,KAAKqK,KAAKzD,KAE5ByD,KAAKqS,gBAAgBrS,KAAK0+B,cAAUv5B,EAAkC,GAAvBnF,KAAKiZ,iBAExD,qBACSzc,QAAQrG,eAAe6J,KAAKzD,IAAKyD,KAAKxH,YAAa,CACpDpC,YAAY,EACZsG,cAAc,EACdrG,IAAK,IAAM2J,KAAKkZ,WAChBngB,IAAK,UAEL,IAASmP,MAAM,EAAGlI,KAAKxH,YAAawH,KAAKzD,OASrD,SAASgiC,GAAkBK,GACvB,OAAOA,EAAUF,SAErB,SAASF,GAAmB9J,EAAMzd,EAAYgjB,GAC1C,QAASA,EAEb,SAASwE,GAAgB/J,EAAMzd,EAAYgjB,GACvC,OAAOA,EAGJ,SAAS4E,GAAeD,EAAWN,EAAOr0B,EAAQ9R,GACrD,MAAMmkC,EAAQgC,EAAMM,GACdF,EAAW,GACjB,IAAK,IAAIlpC,EAAI,EAAGkS,EAAK40B,EAAMhiC,OAAQ9E,EAAIkS,IAAMlS,EAAG,CAC5C,MAAMk/B,EAAO4H,EAAM9mC,GACbyhB,EAAa+nB,GAAcvK,IAAIC,GAC/BuF,EAAYhjB,EAAaA,EAAWgjB,UAAY,KAClDhwB,EAAOyqB,EAAMzd,EAAYgjB,IACzByE,EAAS7+B,KAAK1H,EAAIu8B,EAAMzd,EAAYgjB,IAG5C,OAAOyE,EC1LJ,SAASO,GAActhB,GAC1B,OAAO,SAAU7jB,GACb,OAAOklC,GAAc9iC,OAAOyhB,EAAW7jB,ID8J/C,GAAwC,GAAW,CAC/CiY,IACA,GAAW,oBAAqB,CAAC7b,OAAQA,OAAQmjB,OAAQjhB,OAAQA,OAAQlC,OAAQA,OAAQA,OAAQA,UAClG,ICjIH,MAAMgpC,GAAmB,IAAIvnC,QACtB,MAAM,GACT,YAAYoJ,EAAMhL,EAAMmmB,EAASnlB,EAAKwH,EAAO4gC,EAAUC,EAAc36B,EAAc46B,EAAYC,EAAcC,EAAYpM,EAAWiL,EAAmBoB,EAAeC,EAAiBC,EAAeC,EAAUl8B,EAAU8wB,EAAOva,GAC7Nha,KAAKe,KAAOA,EACZf,KAAKjK,KAAOA,EACZiK,KAAKkc,QAAUA,EACflc,KAAKjJ,IAAMA,EACXiJ,KAAKzB,MAAQA,EACbyB,KAAKm/B,SAAWA,EAChBn/B,KAAKo/B,aAAeA,EACpBp/B,KAAKyE,aAAeA,EACpBzE,KAAKq/B,WAAaA,EAClBr/B,KAAKs/B,aAAeA,EACpBt/B,KAAKu/B,WAAaA,EAClBv/B,KAAKmzB,UAAYA,EACjBnzB,KAAKo+B,kBAAoBA,EACzBp+B,KAAKw/B,cAAgBA,EACrBx/B,KAAKy/B,gBAAkBA,EACvBz/B,KAAK0/B,cAAgBA,EACrB1/B,KAAK2/B,SAAWA,EAChB3/B,KAAKyD,SAAWA,EAChBzD,KAAKu0B,MAAQA,EACbv0B,KAAKga,WAAaA,EAEtB,cAAc2D,EAAW5c,EAAO,MAC5B,GAAa,OAATA,EAAe,CACf,MAAM8B,EAAM8a,EACZ,GAAmB,iBAAR9a,EACP,MAAM,IAAIpC,MAAM,2EAA2Ekd,KAG/F,MAAM5nB,EAAO,YAAwB,OAAQ8M,EAAKm8B,GAAcY,cAUhE,OALI7+B,EAJoB,mBAAb8B,EAAI9B,KAIJ8B,EAAI9B,KAGJi+B,GAAca,aAAa,YAAW9pC,IAE1C,IAAI,GAAwBgL,EAAMhL,EAAM,YAAY8M,EAAIqZ,SAAU,YAAwB,MAAOrZ,EAAK,IAAMm8B,GAAc7iB,QAAQpmB,IAAQ,YAAwB,QAAS8M,EAAK,IAAM,GAAI,YAAwB,WAAYA,EAAK,IAAM,MAAO,YAAYA,EAAIu8B,cAAe,YAAYv8B,EAAI4B,cAAe,YAAwB,aAAc5B,EAAK,IAAM,MAAO,YAAwB,eAAgBA,EAAK,KAAM,GAAO,YAAYA,EAAI08B,YAAavM,GAAStpB,KAAK7G,EAAIswB,WAAY+K,GAASx0B,KAAK7G,EAAIu7B,mBAAoB,YAAwB,gBAAiBv7B,EAAK,KAAM,GAAQ,YAAwB,kBAAmBA,EAAK,KAAM,GAAQ,YAAwB,gBAAiBA,EAAK,IAAM,MAAO,YAAwB,WAAYA,EAAK,KAAM,GAAQ,YAAwB,WAAYA,EAAK,IAAM,GAAuB,YAAwB,QAASA,EAAK,IAAMsY,GAAgBiB,MAAO,YAAYvZ,EAAImX,aAIj5B,GAAyB,iBAAd2D,EACP,OAAO,IAAI,GAAwB5c,EAAM4c,EAAW,YAAYqhB,GAAcjhB,cAAchd,EAAM,WAAYA,EAAKmb,SAAU8iB,GAAc7iB,QAAQwB,GAAY,YAA8B,QAAS5c,EAAM,IAAM,GAAI,YAA8B,WAAYA,EAAM,IAAM,MAAO,YAAYi+B,GAAcjhB,cAAchd,EAAM,gBAAiBA,EAAKq+B,cAAe,YAAYJ,GAAcjhB,cAAchd,EAAM,gBAAiBA,EAAK0D,cAAe,YAA8B,aAAc1D,EAAM,IAAM,MAAO,YAA8B,eAAgBA,EAAM,KAAM,GAAO,YAAYi+B,GAAcjhB,cAAchd,EAAM,cAAeA,EAAKw+B,YAAavM,GAAStpB,QAAQspB,GAAS1sB,OAAOvF,GAAOi+B,GAAcjhB,cAAchd,EAAM,aAAcA,EAAKoyB,WAAY+K,GAASx0B,QAAQw0B,GAAS53B,OAAOvF,GAAOi+B,GAAcjhB,cAAchd,EAAM,qBAAsBA,EAAKq9B,mBAAoB,YAA8B,gBAAiBr9B,EAAM,KAAM,GAAQ,YAA8B,kBAAmBA,EAAM,KAAM,GAAQ,YAA8B,gBAAiBA,EAAM,IAAM,MAAO,YAA8B,WAAYA,EAAM,KAAM,GAAQ,YAA8B,WAAYA,EAAM,IAAM,GAExqC,YAA8B,QAASA,EAAM,IAAM,IAAIoa,GAAgBpa,EAAK3J,YAAa,YAAY4nC,GAAcjhB,cAAchd,EAAM,cAAeA,EAAKiZ,aAO/J,MAAMjkB,EAAO,YAAwB,OAAQ4nB,EAAWqhB,GAAcY,cACtE,OAAO,IAAI,GAAwB7+B,EAAMhL,EAAM,YAAYipC,GAAcjhB,cAAchd,EAAM,WAAY4c,EAAUzB,QAASnb,EAAKmb,SAAU8iB,GAAc7iB,QAAQpmB,GAAO,YAA0C,QAAS4nB,EAAW5c,EAAM,IAAM,GAAI,YAA0C,WAAY4c,EAAW5c,EAAM,IAAM,MAAO,YAAYi+B,GAAcjhB,cAAchd,EAAM,gBAAiB4c,EAAUyhB,aAAcr+B,EAAKq+B,cAAe,YAAYJ,GAAcjhB,cAAchd,EAAM,gBAAiB4c,EAAUlZ,aAAc1D,EAAK0D,cAAe,YAA0C,aAAckZ,EAAW5c,EAAM,IAAM,MAAO,YAA0C,eAAgB4c,EAAW5c,EAAM,KAAM,GAAO,YAAYi+B,GAAcjhB,cAAchd,EAAM,cAAe4c,EAAU4hB,WAAYx+B,EAAKw+B,YAAavM,GAAStpB,QAAQspB,GAAS1sB,OAAOvF,GAAOi+B,GAAcjhB,cAAchd,EAAM,aAAcA,EAAKoyB,UAAWxV,EAAUwV,WAAY+K,GAASx0B,QAAQw0B,GAAS53B,OAAOvF,GAAOi+B,GAAcjhB,cAAchd,EAAM,qBAAsBA,EAAKq9B,kBAAmBzgB,EAAUygB,mBAAoB,YAA0C,gBAAiBzgB,EAAW5c,EAAM,KAAM,GAAQ,YAA0C,kBAAmB4c,EAAW5c,EAAM,KAAM,GAAQ,YAA0C,gBAAiB4c,EAAW5c,EAAM,IAAM,MAAO,YAA0C,WAAY4c,EAAW5c,EAAM,KAAM,GAAQ,YAA0C,WAAY4c,EAAW5c,EAAM,IAAM,GAEx/C,YAA8B,QAASA,EAAM,IAAM,IAAIoa,GAAgBpa,EAAK3J,YAAa,YAAY4nC,GAAcjhB,cAAchd,EAAM,cAAe4c,EAAU3D,WAAYjZ,EAAKiZ,aAErL,mBAAmB8lB,GACf,GAAIA,aAA6B,GAC7B,OAAOA,EAEX,GAAIZ,GAAiB/lC,IAAI2mC,GACrB,OAAOZ,GAAiB7oC,IAAIypC,GAEhC,MAAMl0B,EAAa,GAAwB9U,OAAOgpC,GAIlD,OAHAZ,GAAiBnmC,IAAI+mC,EAAmBl0B,GAExC,IAAS1P,OAAO8iC,GAAcjpC,KAAM6V,EAAYA,EAAW7K,MACpD6K,EAEX,SAASvI,GACL,MAAM,KAAEtC,EAAI,IAAEhK,EAAG,QAAEmlB,GAAYlc,KAC/B,IAAakE,UAAUnN,EAAKgK,GAAM0E,SAASpC,GAC3C,IAAagH,QAAQtT,EAAKgK,GAAM0E,SAASpC,GACzC4Y,GAAgBC,EAAS8iB,GAAejoC,EAAKsM,IAG9C,MAAM27B,GAAgB,CACzBjpC,KAAM,IAAS2M,SAASH,OAAO,kBAC/B4Z,QAAQpmB,GACG,GAAGipC,GAAcjpC,QAAQA,IAEpC4oB,OAAOloB,GACqB,mBAAVA,GAAwB,IAAS0F,OAAO6iC,GAAcjpC,KAAMU,GAE9E,IAAIi+B,EAAMqL,EAAqBC,GAC3B,QAA4B,IAAxBD,EACA,OAAO,IAAS3jC,OAAO4iC,GAAcjpC,KAAM2+B,GAE/C,GAAmC,iBAAxBqL,EAAkC,CACzC,IAAsB,IAAlBC,EAAwB,CACxB,MAAM/oB,EAAa,IAAS7a,OAAO4iC,GAAcjpC,KAAM2+B,GACvD,QAAmB,IAAfzd,EACA,OAEJ,OAAIA,EAAW4a,GAAGkO,GACP9oB,OAEX,EAEJ,IAAII,EAAMqd,EACV,KAAe,OAARrd,GAAc,CACjB,MAAMJ,EAAa,IAAS7a,OAAO4iC,GAAcjpC,KAAMshB,GACvD,QAAmB,IAAfJ,GAAyBA,EAAW4a,GAAGkO,GACvC,OAAO9oB,EAEXI,EAAMkf,GAAIX,uBAAuBve,GAErC,OAEJ,IAAIA,EAAMqd,EACV,KAAe,OAARrd,GAAc,CACjB,MAAMJ,EAAa,IAAS7a,OAAO4iC,GAAcjpC,KAAMshB,GACvD,QAAmB,IAAfJ,EACA,OAAOA,EAEXI,EAAMkf,GAAIX,uBAAuBve,KAIzC,OAAOsG,EAAW5c,GACd,MAAM6K,EAAa,GAAwB9U,OAAO6mB,EAAW5c,GAI7D,OAHA,IAAS7E,OAAO8iC,GAAcjpC,KAAM6V,EAAYA,EAAW7K,MAC3D,IAAS7E,OAAO8iC,GAAcjpC,KAAM6V,EAAYA,GAChD,IAASlJ,SAAS8B,SAASoH,EAAW7K,KAAMi+B,GAAcjpC,MACnD6V,EAAW7K,MAEtB,cAAcA,GACV,MAAM8B,EAAM,IAASzG,OAAO4iC,GAAcjpC,KAAMgL,GAChD,QAAY,IAAR8B,EACA,MAAM,IAAIpC,MAAM,gCAAgCM,EAAKhL,QAEzD,OAAO8M,GAEX,SAAS9B,EAAMuB,EAAM7L,GACjB,IAASyF,OAAO,IAASmG,WAAWE,OAAOD,GAAO7L,EAAOsK,IAE7Dgd,cAAa,CAAChd,EAAMuB,IACT,IAASlG,OAAO,IAASiG,WAAWE,OAAOD,GAAOvB,GAE7D6+B,aAAc,WACV,IAAIlrB,EAAK,EACT,OAAO,WACH,MAAO,aAAaA,KAHd,GAMd,mBACI,MAAMurB,EAAc,SAAUnmC,EAAQ3C,EAAU+N,GAG5C,OAF6B,IAAGE,gCAAgCtL,GAC3CoL,GAAS+6B,EACvBnmC,GAeX,OAbAmmC,EAAYx6B,SAAW,SAAUpC,GAE7B,MAAO,CACH8C,QAAO,CAAC9C,EAAWgD,IACXA,EAAUlN,IAAI8mC,GAAa,GACpB55B,EAAUhQ,IAAI4pC,GAGd,OAKhBA,GAEXJ,aAAc,WACV,MAAMK,EAAiB,CACnBzpC,MAAO,GACPgG,UAAU,EACVrG,YAAY,EACZsG,cAAc,GAGZyjC,EAAe,GACrB,OAAO,SAAUpqC,EAAM8K,EAAQs/B,GAG3B,MAAMp/B,EAAO,QAUb,OANAm/B,EAAezpC,MAAQV,EACvByG,QAAQrG,eAAe4K,EAAM,OAAQm/B,GAEjCr/B,IAAUs/B,GACVjqC,OAAOoH,OAAOyD,EAAK3J,UAAWyJ,GAE3BE,GAtBD,IA0BLq/B,GAAoB,IAAGt6B,gBAAgB,qBAAqBR,YC3OzE,IAAI,GAA0C,SAAUrL,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAI3D,MAAMm1B,GAAe,sDACRC,GAAa,IAAGx6B,gBAAgB,cAAcP,YAAY2E,GAAKA,EAAEjG,UAAU,MACpF,SAAStG,GACL,OAAOA,EAAMizB,QAAQyP,GAAc,QAM3C,IAAIE,GAAyB,MACzB,YAAYC,GACRxgC,KAAKwgC,UAAYA,EAOrB,OAAOC,GACH,OAAuB,MAAnBA,EACO,KAEJzgC,KAAKwgC,UAAUE,SAASD,KAGvCF,GAAyB,GAAW,CAChC3hB,GAAe,YACf,GAAQ,EAAG0hB,IACX,GAAW,oBAAqB,CAACpqC,UAClCqqC,IC3CH,IAAI,GAA0C,SAAUtmC,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAmBpD,MAAMy1B,GAAoB,IAAG76B,gBAAgB,qBAAqBR,YAC5Ds7B,GAAuB,IAAG96B,gBAAgB,wBAAwBR,YAClEu7B,GAAY,IAAG/6B,gBAAgB,aAAaR,YAClD,SAASw7B,GAAoBC,GAChC,OAAO,SAAmBjnC,GAEtB,MAAMknC,EAAkB,YAAalpC,GACjC,MAAM2O,EAAW,IAAI3M,KAAUhC,GAE/B,OADA2O,EAASs6B,gBAAkBA,EACpBt6B,GAGXu6B,EAAgBv7B,SAAW,SAAkBpC,GACzC,IAAaY,UAAU28B,GAAsBI,GAAiBv7B,SAASpC,IAK3E,MAAM49B,EAAe,IAAS3kC,WAAWxC,GACzC,IAAK,MAAM/C,KAAOkqC,EACd,IAAS/kC,OAAOnF,EAAK,IAASqF,OAAOrF,EAAK+C,GAASknC,GAEvD,MAAME,EAAgBhrC,OAAO0gC,0BAA0B98B,GAIvD,OAHA5D,OAAOsD,KAAK0nC,GAAej3B,OAAO3H,GAAiB,cAATA,GAAsBuO,QAAQvO,IACpE9F,QAAQrG,eAAe6qC,EAAiB1+B,EAAM4+B,EAAc5+B,MAEzD0+B,GAIf,IAAI,GAAW,MACX,YAAYG,GACR,MAAMC,EAASphC,KAAKmhC,qBAAuB,GAC3CA,EAAqBtwB,QAAQnR,IAIzB0hC,EAAO1hC,EAAKqhC,iBAAmBrhC,EAAK2hC,OAAOrqC,KAAK0I,KAGxD,gBAAgB2D,GACZ,OAAO,IAAaY,UAAU48B,GAAW7gC,MAAMyF,SAASpC,GAE5D,OAAOgR,EAAOrV,EAASiY,EAAYqqB,EAAS11B,EAAY21B,EAAMjf,GAC1D,MAAMkf,EAAqB51B,EAAWwzB,aACtC,GAAIkC,EAAQhnC,SAAWknC,EAAmBlnC,OACtC,MAAM,IAAImG,MAAM,gFAAgF6gC,EAAQhnC,sBAAsBknC,EAAmBlnC,wBAErJ,IAAK,IAAI9E,EAAI,EAAGkS,EAAK45B,EAAQhnC,OAAQ9E,EAAIkS,IAAMlS,EAC3CwK,KAAKyhC,mBACcptB,EACArV,EACAwiC,EAAmBhsC,GACnByhB,EACAqqB,EAAQ9rC,GACR8sB,GAEnBif,SACAvhC,KAAKyhC,mBACcptB,EACArV,EACA4M,EAAW2zB,WACXtoB,EACAsqB,EACAjf,GAG3B,mBAAmBjO,EAAOrV,EAASogC,EAAcnoB,EAAYnd,EAAQwoB,GACjE,MAAM6e,EAAuBnhC,KAAKmhC,qBAClC,IAAIv4B,EACJ,IAAK,IAAIpT,EAAI,EAAGkS,EAAK03B,EAAa9kC,OAAQ9E,EAAIkS,IAAMlS,EAChDoT,EAAUw2B,EAAa5pC,GACvB2rC,EAAqBv4B,EAAQ84B,MAAMrtB,EAAOrV,EAASiY,EAAYnd,EAAQ8O,EAAS0Z,KASrF,SAASqf,GAAiBC,EAAQC,EAAWvR,GAChD,MAAyB,iBAAduR,EACAD,EAAOE,MAAMD,EAAWvR,GAE5BuR,EAEJ,SAASE,GAAUC,GACtB,YAAuC,IAAnCA,EAAgBloB,eACTkoB,EAAgBloB,eAEpBkoB,EAfX,GAAW,GAAW,CAClB,GAAQ,EAAG,YAAIpB,KACf,GAAW,oBAAqB,CAACzmC,SAClC,IAyCH,IAAI8nC,GAEJ,MACI,OAAO5tB,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAM3lC,EAAMwlC,GAAUjoC,QACC,IAAnByC,EAAI0d,iBAA4D,IAAnC1d,EAAI0d,WAAWioB,EAAY5c,IACxD/oB,EAAI0d,WAAWioB,EAAY5c,IAAInM,SAAS+oB,EAAYzrC,MAAO,MAG3D8F,EAAI2lC,EAAY5c,IAAM4c,EAAYzrC,QAI9CwrC,GAAsB,GAAW,CAC7BnB,GAAoB,OAErBmB,IAEH,IAAI,GAEJ,MACI,OAAO5tB,EAAOrV,EAASiY,EAAYnd,EAAQooC,EAAa5f,GACpDA,EAAQzH,GAAWyH,EAAO4f,EAAY5f,OACtC,MAAMxb,EAAU9H,EAAQmjC,oBACDlrB,EACAnd,EACAooC,OACA,EACApoC,GACjB/C,EAAMioC,GAAc7iB,QAAQ+lB,EAAYE,KACxCC,EAAYv7B,EAAQw7B,gBAAgBvrC,GACpC4f,EAAY3X,EAAQ3I,IAAIogB,GACxB8rB,EAAkB,GAAWC,iBACbH,EACA1rB,EACA7c,EACAkF,EACAsjB,EACAjO,GACtBA,EAAQkuB,EAAgBluB,MACxB,IAASnY,OAAOnF,EAAKwrC,EAAiBzoC,GACtCkF,EAAQyiC,mBACWptB,EACA6tB,EAAY9C,aACZnoB,EACAsrB,EACAjgB,GACnBrL,EAAWwrB,cAAcF,GACzBz7B,EAAQ8C,YAGhB,GAAwB,GAAW,CAC/Bk3B,GAAoB,OAErB,IAEH,IAAI,GAEJ,MACI,OAAOzsB,EAAOrV,EAASiY,EAAYnd,EAAQooC,EAAa5f,GACpD,MAAMxb,EAAU9H,EAAQmjC,oBACDlrB,EACAnd,EACAooC,OACA,OACA,GACjBnrC,EAAMo9B,GAAgBhY,QAAQ+lB,EAAYE,KAC1CC,EAAYv7B,EAAQw7B,gBAAgBvrC,GACpC4f,EAAY3X,EAAQ3I,IAAIogB,GACxB8rB,EAAkB,GAAWG,mBACnBL,EACA1rB,EACA7c,EACAua,GAChB,IAASnY,OAAOnF,EAAKwrC,EAAiBzoC,GACtCkF,EAAQyiC,mBACWptB,EACA6tB,EAAY9C,aACZnoB,EACAsrB,EACAjgB,GACnBrL,EAAWwrB,cAAcF,GACzBz7B,EAAQ8C,YAGhB,GAA0B,GAAW,CACjCk3B,GAAoB,OAErB,IAEH,IAAI,GAEJ,MACI,OAAOzsB,EAAOsuB,EAAe1rB,EAAYnd,EAAQooC,EAAa5f,GAC1DA,EAAQzH,GAAWyH,EAAO4f,EAAY5f,OACtC,MAAMsgB,EAAcC,GAAiBX,EAAYr/B,IAAK8/B,EAAergB,GAAOwgB,iBACtEC,EAAiBJ,EAAcnM,IAAIrB,wBAAwBr7B,GAC3DkpC,EAAmBL,EAAcR,oBAChBlrB,EACAnd,EACAooC,EACAU,EACAG,GACjBhsC,EAAMo9B,GAAgBhY,QAAQ+lB,EAAYE,KAC1CC,EAAYW,EAAiBV,gBAAgBvrC,GAC7C4f,EAAYgsB,EAActsC,IAAIogB,GAC9B8rB,EAAkB,GAAWG,mBACnBL,EACA1rB,EACA7c,EACAua,GAEhB,GADA,IAASnY,OAAOnF,EAAKwrC,EAAiBQ,GAClCb,EAAY5E,KAAM,CAClB,MAAM2F,EAAchsB,EAAWgsB,YAC/BZ,EAAU/E,KAAK2F,EAAYA,EAAY3oC,OAAS,IAEpDqoC,EAAclB,mBACKptB,EACA6tB,EAAY9C,aACZnoB,EACAsrB,EACAjgB,GACnBrL,EAAWwrB,cAAcF,GACzBS,EAAiBp5B,YAGzB,GAA6B,GAAW,CACpCk3B,GAAoB,OAErB,IAEH,IAAI,GAEJ,MACI,YAAYc,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvCljC,EAAQw3B,IAAIJ,OAAOt8B,GACnB,MAAMopC,EAAoBhB,EAAY9C,aAChChO,EAAmB8Q,EAAY9Q,iBACrC,IAAI+R,EACAllB,EACAD,EACJ,IAAK,IAAIxoB,EAAI,EAAGkS,EAAKw7B,EAAkB5oC,OAAQ9E,EAAIkS,IAAMlS,EACrD2tC,EAAmBD,EAAkB1tC,GACrCyoB,EAAO0jB,GAAiB3hC,KAAK4hC,OAAQuB,EAAiBz5B,KAAM,IAC5DsU,EAAUolB,GAAqB,IAAI,GAAWnlB,EAAMklB,EAAiB7d,GAAItlB,KAAKgd,gBAAiBhe,EAASoyB,GAAmBnT,EAAMjf,GACjIiY,EAAWosB,WAAWrlB,KAIlC,GAAqB,GAAW,CAC5B8iB,GAAoB,MAGpB,GAAQ,EAAG5Q,IACX,GAAQ,EAAGvC,IACX,GAAW,oBAAqB,CAACz3B,OAAQA,UAC1C,IAEH,IAAI,GAEJ,MACI,YAAY0rC,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAMjkB,EAAO0jB,GAAiB3hC,KAAK4hC,OAAQM,EAAYx4B,KAAM,KACvDsU,EAAUolB,GAAqB,IAAI,GAAYnlB,EAAM8jB,GAAUjoC,GAASooC,EAAY5c,GAAItlB,KAAKgd,gBAAiBhe,GAAUif,EAAMjf,GACpIiY,EAAWosB,WAAWrlB,KAG9B,GAAsB,GAAW,CAC7B8iB,GAAoB,MAGpB,GAAQ,EAAG5Q,IACX,GAAQ,EAAGvC,IACX,GAAW,oBAAqB,CAACz3B,OAAQA,UAC1C,IAEH,IAAI,GAEJ,MACI,YAAY0rC,GACR5hC,KAAK4hC,OAASA,EAElB,OAAOvtB,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAMjkB,EAAO0jB,GAAiB3hC,KAAK4hC,OAAQM,EAAYx4B,KAAM,MACvDsU,EAAUolB,GAAqB,IAAI,GAAWnlB,EA3NrD,SAAsBqlB,EAASC,GAClC,GAAsB,YAAlBA,EACA,OAAOD,EAEX,OAAQC,GACJ,IAAK,aAED,OAAOvE,GAAcvK,IAAI6O,GAC7B,IAAK,OAED,MAAM,IAAI7iC,MAAM,qBACpB,IAAK,aAED,OAAOu+B,GAAcvK,IAAI6O,GAASrJ,UACtC,QAAS,CACL,MAAMuJ,EAAerP,GAAgBM,IAAI6O,EAASC,GAClD,QAAqB,IAAjBC,EACA,OAAOA,EAAavJ,UAExB,MAAMwJ,EAAezE,GAAcvK,IAAI6O,EAASC,GAChD,QAAqB,IAAjBE,EACA,MAAM,IAAIhjC,MAAM,2BAA2B8iC,sDAE/C,OAAOE,EAAaxJ,YAoMkCyJ,CAAa5pC,EAAQooC,EAAY5c,IAAKtmB,GAAUif,EAAMjf,GAChHiY,EAAWosB,WAAWrlB,KAG9B,GAAqB,GAAW,CAC5B8iB,GAAoB,MAGpB,GAAQ,EAAG5Q,IACX,GAAW,oBAAqB,CAACh6B,UAClC,IAEH,IAAI,GAEJ,MACI,YAAY0rC,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,IAAIlkB,EACJ,MAAMC,EAAO0jB,GAAiB3hC,KAAK4hC,OAAQM,EAAYx4B,KAAM,MAEzDsU,EADAC,EAAK+F,QACKof,GAAqB,IAAIrS,GAA0B/wB,KAAKgd,gBAAiBiB,EAAM8jB,GAAUjoC,GAASooC,EAAY5c,GAAIjB,GAAYxE,OAAQ7gB,GAAUif,EAAMjf,GAGtJokC,GAAqB,IAAI,GAAqBnlB,EAAKgG,gBAAiBhG,EAAM8jB,GAAUjoC,GAASooC,EAAY5c,GAAIjB,GAAYxE,OAAQ7f,KAAKgd,gBAAiBhe,GAAS,GAAOif,EAAMjf,GAE3LiY,EAAWosB,WAAWrlB,KAG9B,GAA+B,GAAW,CACtC8iB,GAAoB,MAGpB,GAAQ,EAAG5Q,IACX,GAAQ,EAAGvC,IACX,GAAW,oBAAqB,CAACz3B,OAAQA,UAC1C,IAEH,IAAI,GAEJ,MACI,YAAY0rC,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAMjkB,EAAO0jB,GAAiB3hC,KAAK4hC,OAAQM,EAAYx4B,KAAM,GAA6Bw4B,EAAYvrC,MAChGqnB,EAAUolB,GAAqB,IAAI,GAAgBnlB,EAAM8jB,GAAUjoC,GAASooC,EAAY5c,GAAI4c,EAAYvrC,KAAMqJ,KAAKgd,gBAAiBhe,GAAUif,EAAMjf,GAC1JiY,EAAWosB,WAAWrlB,KAG9B,GAA0B,GAAW,CACjC8iB,GAAoB,MAGpB,GAAQ,EAAG5Q,IACX,GAAQ,EAAGvC,IACX,GAAW,oBAAqB,CAACz3B,OAAQA,UAC1C,IAEH,IAAI,GAEJ,MACI,YAAY0rC,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAMjkB,EAAO0jB,GAAiB3hC,KAAK4hC,OAAQM,EAAYx4B,KAAM,KACvDsU,EAAUolB,GAAqB,IAAI,GAAgBnlB,EAAM8jB,GAAUjoC,GAASooC,EAAY5c,GAAIjB,GAAYxE,OAAQ7f,KAAKgd,gBAAiBhe,GAAUif,EAAMjf,GAC5JiY,EAAWosB,WAAWrlB,KAG9B,GAA0B,GAAW,CACjC8iB,GAAoB,MAGpB,GAAQ,EAAG5Q,IACX,GAAQ,EAAGvC,IACX,GAAW,oBAAqB,CAACz3B,OAAQA,UAC1C,IAEH,IAAIytC,GAA0B,EAC9B,MAAMC,GAAsB,GACrB,SAASR,GAAqBplB,EAASkB,EAAYf,GACtD,KAAOe,aAAsB,IACzB0kB,GAAoBD,MAA6BzkB,EACjDA,EAAaA,EAAWA,WAE5B,KAAOykB,GAA0B,GAAG,CAChC,MAAME,EAAqBD,KAAsBD,IAC3CG,EAAoB3lB,EAAQ9nB,IAAIwtC,EAAmB1kB,aACrD2kB,aAA6B,KAC7B9lB,EAAU8lB,EAAkB98B,UAAUgX,EAAS6lB,IAIvD,OADAD,GAAoBtpC,OAAS,EACtB0jB,ECjbX,MAAM+lB,GAA4B,IAAIpsC,QAChCqsC,GAAiC,IAAIrsC,QACrCssC,GAAgB,IAAItsC,QACnB,SAASusC,GAAgBztC,GAC5B,OAAOA,aAAiB,GAErB,SAASosC,GAAiB/C,EAAmBqE,EAAiB7hB,GACjE,MAAM1W,EAAa,GAAwB0J,YAAYwqB,GAKvD,GAJIoE,GAAgBC,KAChB7hB,EAAQzH,GAAWspB,EAAgB7hB,MAAOA,IAGhB,OAA1B1W,EAAWyzB,WACX,OAAO,IAAI,GAAczzB,EAAYu4B,EAAiB7hB,GAE1D,QAAc,IAAVA,EAAkB,CAClB,IAAI8hB,EAAkBL,GAA0B1tC,IAAIuV,QAC5B,IAApBw4B,GACAL,GAA0BhrC,IAAI6S,EAAYw4B,EAAkB,IAAIzsC,SAEpE,IAAIqH,EAAUolC,EAAgB/tC,IAAI8tC,GAIlC,YAHgB,IAAZnlC,GACAolC,EAAgBrrC,IAAIorC,EAAiBnlC,EAAU,IAAI,GAAc4M,EAAYu4B,EAAiB7hB,IAE3FtjB,EAEX,IAAIqlC,EAAuBL,GAA+B3tC,IAAIuV,QACjC,IAAzBy4B,GACAL,GAA+BjrC,IAAI6S,EAAYy4B,EAAuB,IAAI1sC,SAE9E,IAAI2sC,EAAcD,EAAqBhuC,IAAI8tC,QACvB,IAAhBG,GACAD,EAAqBtrC,IAAIorC,EAAiBG,EAAc,IAAI3sC,SAEhE,IAAIqH,EAAUslC,EAAYjuC,IAAIisB,GAI9B,YAHgB,IAAZtjB,GACAslC,EAAYvrC,IAAIupB,EAAOtjB,EAAU,IAAI,GAAc4M,EAAYu4B,EAAiB7hB,IAE7EtjB,EAEJ,MAAM,GACT,YAAY4M,EAAYu4B,EAAiB7hB,GACrCtiB,KAAK4L,WAAaA,EAClB5L,KAAKmkC,gBAAkBA,EACvBnkC,KAAKsiB,MAAQA,EACbtiB,KAAKukC,uBAAoB,EACzBvkC,KAAKwkC,SAAW,KAChBxkC,KAAK8G,aAAU,EACf9G,KAAKykC,YAAa,EAClBzkC,KAAK0kC,wBAAqB,EAC1B,MAAMrhC,EAAYrD,KAAKqD,UAAY8gC,EAAgBQ,cACnD3kC,KAAK4kC,SAAWvhC,EAAUhN,IAAIwqC,IAC9Bx9B,EAAUC,iBAAiBkT,EAAcxW,KAAK6kC,gBAAkB,IAAI,IAAuB,GAC3FxhC,EAAUC,iBAAiBgT,EAAatW,KAAK8kC,yBAA2B,IAAI,KAAoB,GAChGzhC,EAAUC,iBAAiB4X,GAAsBlb,KAAK+kC,oBAAsB,IAAI,KAAoB,GACpG1hC,EAAUC,iBAAiBsxB,GAAiB50B,KAAKglC,uBAAyB,IAAI,KAAoB,IACjGhlC,KAAKw2B,IAAMnzB,EAAUhN,IAAIw+B,KAAOsB,wBAAwB9yB,EAAWrD,KAAKilC,gBAAkB,IAAI,KAC/F5hC,EAAUoC,YAAYmG,EAAWnH,cAGrC,IAAI1N,EAAKuS,GACL,OAAOtJ,KAAKqD,UAAUlK,IAAIpC,EAAKuS,GAEnC,IAAIvS,GACA,OAAOiJ,KAAKqD,UAAUhN,IAAIU,GAE9B,OAAOA,GACH,OAAOiJ,KAAKqD,UAAUiD,OAAOvP,GAIjC,YAAY2K,GACR,OAAO1B,KAAKqD,UAAUoC,YAAY/D,GAEtC,iBAAiB3K,EAAKkP,GAClB,OAAOjG,KAAKqD,UAAUC,iBAAiBvM,EAAKkP,GAEhD,oBAAoBlP,EAAK4Q,GACrB,OAAO3H,KAAKqD,UAAU8F,oBAAoBpS,EAAK4Q,GAEnD,YAAY5Q,EAAKqS,GACb,OAAOpJ,KAAKqD,UAAU8D,YAAYpQ,EAAKqS,GAE3C,WAAWrS,GACP,OAAOiJ,KAAKqD,UAAU0D,WAAWhQ,GAErC,gBAAgBA,EAAK+P,GACjB9G,KAAKqD,UAAU6hC,gBAAgBnuC,EAAK+P,GAExC,cACI,OAAO9G,KAAKqD,UAAUshC,cAE1B,mBACI3kC,KAAKqD,UAAU8hC,mBAInB,UACI,IAAIT,EACJ,GAAI1kC,KAAKykC,WACL,OAAOzkC,KAEXA,KAAKykC,YAAa,EAClB,MAAM74B,EAAa5L,KAAK4L,WACxB,GAAIA,EAAW0zB,aAAc,CACzB,MAAMj8B,EAAYrD,KAAKqD,UACjB+hC,EAAW/hC,EAAUhN,IAAIsqC,IAC/B+D,EAAqB1kC,KAAK0kC,mBAAqBU,EAASC,QAAQz5B,EAAYvI,QAG5EqhC,EAAqB1kC,KAAK0kC,mBAAqB94B,EAInD,GADA84B,EAAmBj/B,SAASzF,MACxBikC,GAAc9qC,IAAIurC,GAClB1kC,KAAKwkC,SAAWP,GAAc5tC,IAAIquC,OAEjC,CACD,MAAMvF,EAAWuF,EAAmBvF,SACnB,OAAbA,EACA8E,GAAclrC,IAAI2rC,EAAoB,MAGtCT,GAAclrC,IAAI2rC,EAAoB1kC,KAAKwkC,SAAWxkC,KAAKw2B,IAAIpB,uBAAuB+J,IAG9F,OAAOn/B,KAEX,eAAejK,GACX,IAAI+Q,EAAU9G,KAAK8G,QACnB,QAAgB,IAAZA,EAAoB,MACP,IAAT/Q,IACAA,EAAOiK,KAAK4L,WAAW7V,MAE3B,MAAM4gB,EAAY3W,KAAKmkC,gBAAgB9tC,IAAIogB,GAC3C3P,EAAU9G,KAAK8G,QAAU,IAAI,GAAY/Q,EAAMiK,KAAM2W,EAAW3W,KAAKsiB,OAEzE,OAAOxb,EAEX,6BAA6BL,GACzB,MAAMmF,EAAa5L,KAAK4L,WAOxB,OAN8B,OAA1BA,EAAWyzB,kBACoB,IAA3Br/B,KAAKukC,mBACLvkC,KAAKqD,UAAUC,iBAAiBsI,EAAWyzB,WAAYr/B,KAAKukC,kBAAoB,IAAI,KAExFvkC,KAAKukC,kBAAkB39B,QAAQH,IAE5BzG,KAIX,cACI,OAAOA,KAAKw2B,IAAInB,mBAAmBr1B,KAAKwkC,UAG5C,oBAAoBc,EAAkB/D,EAAMW,EAAaU,EAAa/L,GAiBlE,YAhByB,IAArByO,GACAtlC,KAAK8kC,yBAAyBl+B,QAAQ0+B,QAE7B,IAAT/D,GAEAvhC,KAAKilC,gBAAgBr+B,QAAQ26B,QAEb,IAAhBW,GACAliC,KAAK+kC,oBAAoBn+B,QAAQs7B,QAEpB,IAAbrL,GACA72B,KAAKglC,uBAAuBp+B,QAAQiwB,QAEpB,IAAhB+L,GACA5iC,KAAK6kC,gBAAgBj+B,QAAQg8B,GAE1B5iC,KAIX,gBAAgBulC,GACZ,OAAOvlC,KAAKqD,UAAUhN,IAAIkvC,GAE9B,OAAOlxB,EAAO4C,EAAYqqB,EAASkE,EAAoBjE,EAAMjf,GACzDtiB,KAAK4kC,SAASvD,OAAOhtB,EAAOrU,KAAMiX,EAAYqqB,EAASkE,EAAoBjE,EAAMjf,GAErF,mBAAmBjO,EAAO+qB,EAAcnoB,EAAYnd,EAAQwoB,GACxDtiB,KAAK4kC,SAASnD,mBAAmBptB,EAAOrU,KAAMo/B,EAAcnoB,EAAYnd,EAAQwoB,GAEpF,UACItiB,KAAKilC,gBAAgBr7B,UACrB5J,KAAKqD,UAAU8hC,oBAIhB,MAAM,GACT,cACInlC,KAAK8G,QAAU,KAEnB,QAAQA,GACJ9G,KAAK8G,QAAUA,EAEnB,kBAAoB,OAAO,EAC3B,QAAQV,EAASC,GACb,MAAMS,EAAU9G,KAAK8G,QACrB,GAAgB,OAAZA,EACA,MAAM,IAASnF,MAAM,IAEzB,GAA4B,iBAAjBmF,EAAQ/Q,MAA6C,IAAxB+Q,EAAQ/Q,KAAKuE,OACjD,MAAM,IAASqH,MAAM,IAEzB,OAAOmF,EAAQX,QAAQE,GAE3B,UACIrG,KAAK8G,QAAU,MC/MvB,MAAM2+B,GAAmB,IAAI9tC,QACtB,MAAM,GACT,YAAY+tC,EAAQrxB,EAAOsC,EAAW4d,EAItCqO,EAIA3I,EAIAngB,EAIAynB,GACIvhC,KAAK0lC,OAASA,EACd1lC,KAAKqU,MAAQA,EACbrU,KAAK2W,UAAYA,EACjB3W,KAAKu0B,MAAQA,EACbv0B,KAAK4iC,YAAcA,EACnB5iC,KAAKi6B,UAAYA,EACjBj6B,KAAK8Z,eAAiBA,EACtB9Z,KAAKuhC,KAAOA,EACZvhC,KAAK0U,GAAK,YAAO,gBACjB1U,KAAKmX,eAAY,EACjBnX,KAAKyX,iBAAc,EACnBzX,KAAKkX,eAAY,EACjBlX,KAAKwX,iBAAc,EACnBxX,KAAK8X,kBAAe,EACpB9X,KAAKmY,kBAAe,EACpBnY,KAAK6X,kBAAe,EACpB7X,KAAKkY,kBAAe,EACpBlY,KAAKuY,eAAY,EACjBvY,KAAK0Y,iBAAc,EACnB1Y,KAAKsY,eAAY,EACjBtY,KAAKyY,iBAAc,EACnBzY,KAAKjF,YAAS,EACdiF,KAAKu6B,cAAW,EAChBv6B,KAAKijC,iBAAc,EACnBjjC,KAAK0D,MAAQ,EACb1D,KAAKga,gBAAa,EAClBha,KAAKy/B,iBAAkB,EACvBz/B,KAAKyN,WAAQ,EACbzN,KAAK2Z,UAAO,EACZ3Z,KAAK4+B,eAAY,EACjB5+B,KAAKs8B,WAAQ,EACbt8B,KAAKhB,aAAU,EACfgB,KAAK62B,cAAW,EAChB72B,KAAK2lC,cAAgB,EAEzB,iBAAiB1L,GACb,OAAOwL,GAAiBpvC,IAAI4jC,GAEhC,wBAAwBA,GACpB,MAAMhjB,EAAa,GAAW2uB,UAAU3L,GACxC,QAAmB,IAAfhjB,EACA,MAAM,IAAIxW,MAAM,6DAA6DrI,OAAO6hC,MAExF,OAAOhjB,EAEX,wBAAwBgjB,EAAWtjB,EAAW4qB,EAAM4C,EAAiB7hB,EAAOjO,EAAQ,GAChF,GAAIoxB,GAAiBtsC,IAAI8gC,GACrB,OAAOwL,GAAiBpvC,IAAI4jC,GAEhC,MAAMruB,EAAaozB,GAAc6G,cAAc5L,EAAUt0B,aACzD0O,GAASzI,EAAWnI,SACpB,MAAMwT,EAAa,IAAI,GAAW,EACb5C,EACAsC,EACA/K,EAAW2oB,WACX,EACA0F,EACA6L,GAAkBzxB,EAAO4lB,GACzBsH,GAGrB,OAFAkE,GAAiB1sC,IAAIkhC,EAAWhjB,GAChCA,EAAW8uB,qBAAqBn6B,EAAYu4B,EAAiB7hB,GACtDrL,EAEX,0BAA0BgjB,EAAWtjB,EAAW4qB,EAAMltB,EAAQ,GAC1D,GAAIoxB,GAAiBtsC,IAAI8gC,GACrB,OAAOwL,GAAiBpvC,IAAI4jC,GAEhC,MAAMruB,EAAauoB,GAAgB0R,cAAc5L,EAAUt0B,aAC3D0O,GAASzI,EAAWnI,SACpB,MAAMwT,EAAa,IAAI,GAAW,EACb5C,EACAsC,EACA/K,EAAW2oB,WACX,EACA0F,EACA6L,GAAkBzxB,EAAO4lB,GACzBsH,GAGrB,OAFAkE,GAAiB1sC,IAAIkhC,EAAWhjB,GAChCA,EAAW+uB,uBAAuBp6B,GAC3BqL,EAEX,wBAAwB2rB,EAAajsB,EAAW3X,EAASqV,EAAQ,GAC7D,MAAM4C,EAAa,IAAI,GAAW,EACb5C,EACAsC,EACAwE,GAAgBiB,KAChBwmB,OACA,OACA,OACA,GAErB,OADA3rB,EAAWgvB,iBAAiBjnC,EAAS4jC,EAAYtgB,OAC1CrL,EAEX,qBAAqBrL,EAAYu4B,EAAiB7hB,GAC9C,MAAMjO,EAAQrU,KAAKqU,OAASzI,EAAWnI,SACjCgD,EAAWzG,KAAKi6B,UACtBiM,GAAgBlmC,KAAK2W,UAAW/K,EAAYyI,EAAO5N,GA+oB3D,SAAiCwQ,EAAYrL,EAAYyI,EAAO5N,GAC5D,MAAM23B,EAAoBxyB,EAAWwyB,kBAC/B+H,EAAqBjwC,OAAOkwC,oBAAoBhI,GAChD9jC,EAAS6rC,EAAmB7rC,OAClC,GAAIA,EAAS,EAAG,CACZ,MAAM+rC,EAAYC,GAAU7/B,GAC5B,IAAI1Q,EACJ,IAAK,IAAIP,EAAI,EAAGA,EAAI8E,IAAU9E,EAE1B,GADAO,EAAOowC,EAAmB3wC,GACH,MAAnB6wC,EAAUtwC,GAAiB,CAC3B,MAAMwwC,EAAsBnI,EAAkBroC,GAC9CswC,EAAUtwC,GAAQ,IAAI,GAAiBkhB,EAAYxQ,EAAU4N,EAAOte,EAAMwwC,EAAoB/nC,SAAU+nC,EAAoBjI,MAAOiI,EAAoBt8B,OAAQs8B,EAAoBpuC,IAAKouC,EAAoBlI,WAzpBpNmI,CAAwBxmC,KAAM4L,EAAYyI,EAAO5N,GACjDzG,KAAKyN,MAAQ,EAAM3W,OAAOud,EAAOrU,KAAK8Z,eAAgB,MACtD,MAAMya,EAAQv0B,KAAKu0B,MACnB,GAAIA,EAAMnZ,UAAW,CACjB,MAAMve,EAAS4J,EAAS3P,OACFkJ,KACAmkC,EACAv4B,EACA0W,QACP,IAAXzlB,GAAqBA,IAAW+O,IAChCA,EAAa,GAAwB0J,YAAYzY,IAGzD,MAAMmC,EAAUgB,KAAKhB,QAAU6jC,GAAiBj3B,EAAYu4B,EAAiB7hB,GAE7E1W,EAAWnG,SAASzG,GACU,OAA1B4M,EAAWyzB,YAEXrgC,EAAQynC,6BAA6BhgC,GAErC8tB,EAAMlZ,kBACN5U,EAASigC,cAAc1mC,MAE3B,MAAM2mC,EAAkB3nC,EAAQqmC,UAC1BX,EAAqBiC,EAAgBjC,mBAC3C1kC,KAAKga,WAAa0qB,EAAmB1qB,WACrCha,KAAKy/B,gBAAkBiF,EAAmBjF,gBAC1C,MAAMmH,EAAmBzC,EAAgB9tC,IAAI+pC,IAC7CpgC,KAAK4+B,UAAYgI,EAAiBC,oBAAoB7nC,EAAQw3B,IAAKx2B,KAAMA,KAAKuhC,KAAMmD,GACpFj+B,EAASuwB,YAAch3B,KACvB,MAAMs8B,EAAQt8B,KAAKs8B,MAAQqK,EAAgBG,cACvCvS,EAAMjZ,iBACN7U,EAASsgC,aAAa/mC,MAE1B,MAAMshC,EAAUhF,EAAM0K,cACtBL,EAAgBtF,OACCrhC,KAAKqU,MACLrU,KACAshC,EACAoD,EACA1kC,KAAKuhC,KACLjf,GACbiS,EAAMhZ,yBACN9U,EAASwgC,qBAAqBjnC,MAGtC,uBAAuB4L,GACnB,MAAMyI,EAAQrU,KAAKqU,MAAQzI,EAAWnI,SAChCgD,EAAWzG,KAAKi6B,UACtBiM,GAAgBlmC,KAAK2W,UAAW/K,EAAYyI,EAAO5N,GACnDA,EAASuwB,YAAch3B,KAE3B,iBAAiBhB,EAASsjB,GACtBtiB,KAAKhB,QAAUA,EACf,MAAM2nC,EAAkB3nC,EAAQqmC,UAC1BX,EAAqBiC,EAAgBjC,mBAC3C1kC,KAAKga,WAAa0qB,EAAmB1qB,WACrCha,KAAKy/B,gBAAkBiF,EAAmBjF,gBAC1C,MACM6B,GADQthC,KAAKs8B,MAAQqK,EAAgBG,eACrBE,cACtBL,EAAgBtF,OACCrhC,KAAKqU,MACLrU,KACAshC,EACAoD,OACA,EACApiB,GAErB,WAAWtE,QACe,IAAlBhe,KAAKu6B,SACLv6B,KAAKu6B,SAAW,CAACvc,GAGjBhe,KAAKu6B,SAASv6B,KAAKu6B,SAASjgC,QAAU0jB,EAG9C,cAAc/G,QACe,IAArBjX,KAAKijC,YACLjjC,KAAKijC,YAAc,CAAChsB,GAGpBjX,KAAKijC,YAAYjjC,KAAKijC,YAAY3oC,QAAU2c,EAGpD,GAAGlhB,GACC,OAAQiK,KAAK0lC,QACT,KAAK,EAED,OADYvR,GAAgB0R,cAAc7lC,KAAKi6B,UAAUt0B,aAC9C5P,OAASA,EAExB,KAAK,EAED,OADYipC,GAAc6G,cAAc7lC,KAAKi6B,UAAUt0B,aAC5C5P,OAASA,EAExB,KAAK,EACD,OAAOiK,KAAK4iC,YAAY7sC,OAASA,GAG7C,UAAU0X,GACNzN,KAAKyN,MAAQA,EACbzN,KAAK0D,OAAS,IAElB,KAAKmzB,EAAU8O,GACX3lC,KAAK0D,MAA+C,KAAzB,IAAb1D,KAAK0D,OACnB1D,KAAK62B,SAAWA,EAChB72B,KAAK2lC,cAAgBA,EAEzB,QAAQtxB,GAEJ,OADArU,KAAK0D,OAAS,KACI,GAAb1D,KAAK0D,OAA+B,EAE9B1D,KAAK4iC,YAAYsE,iBAAiBlnC,MAEtCA,KAAKmnC,iBAAiB9yB,GAEjC,KAAKA,EAAO5G,EAAOkM,GAWf,OAVA3Z,KAAK2Z,KAAOA,EASZtF,GAAS,KACDrU,KAAK0lC,QACT,KAAK,EACD,OAAO1lC,KAAKonC,kBAAkB/yB,EAAO5G,GACzC,KAAK,EACD,OAAOzN,KAAKqnC,oBAAoBhzB,EAAO5G,GAC3C,KAAK,EACD,OAAOzN,KAAKsnC,cAAcjzB,EAAO5G,IAG7C,OAAO4G,GAEH,OADAA,GAAS,KACDrU,KAAK0lC,QACT,KAAK,EACD,OAAO1lC,KAAKunC,oBAAoBlzB,GACpC,KAAK,EACD,OAAOrU,KAAKwnC,sBAAsBnzB,GACtC,KAAK,EACD,OAAOrU,KAAKynC,gBAAgBpzB,IAGxC,UAAUA,GAENrU,KAAK8Z,eAAexC,UAAUjD,GAElC,YAAYA,GAERrU,KAAK8Z,eAAepC,YAAYrD,GAEpC,OAAOA,GACH,MAAkB,GAAbrU,KAAK0D,OAA0C,GAA+C,IAAjC,SAAR2Q,IAI1D,OADAA,GAAS,MACDrU,KAAK0lC,QACT,KAAK,EACD1lC,KAAK0nC,oBAAoBrzB,GACzB,MACJ,KAAK,EACDrU,KAAK2nC,sBAAsBtzB,GAC3B,MACJ,KAAK,EACDrU,KAAK4nC,gBAAgBvzB,IAGjC,OAAOA,GACH,GAAsD,IAApC,GAAbrU,KAAK0D,OAIV,OADA2Q,GAAS,MACDrU,KAAK0lC,QACT,KAAK,EACD1lC,KAAK6nC,oBAAoBxzB,GACzB,MACJ,KAAK,EACDrU,KAAK8nC,sBAAsBzzB,GAC3B,MACJ,KAAK,EACDrU,KAAK+nC,gBAAgB1zB,IAGjC,YAAYA,GAERrU,KAAK8Z,eAAe/B,YAAY1D,GAEpC,YAAYA,GAERrU,KAAK8Z,eAAe1B,YAAY/D,GAEpC,MAAMA,GACF,OAAQrU,KAAK0lC,QACT,KAAK,EACD1lC,KAAKgoC,mBAAmB3zB,GACxB,MACJ,KAAK,EACDrU,KAAKioC,eAAe5zB,IAGhC,QAAQA,GACJ,OAAQrU,KAAK0lC,QACT,KAAK,EACD1lC,KAAKkoC,qBAAqB7zB,GAC1B,MACJ,KAAK,EACDrU,KAAKmnC,iBAAiB9yB,IAGlC,MAAMA,GACF,OAAQrU,KAAK0lC,QACT,KAAK,EACD1lC,KAAKmoC,mBAAmB9zB,GACxB,MACJ,KAAK,EACDrU,KAAKooC,qBAAqB/zB,GAC1B,MACJ,KAAK,EACDrU,KAAKqoC,eAAeh0B,IAGhC,kBAAkB0I,GACd,MAAM,SAAEwd,GAAav6B,KACrB,QAAiB,IAAbu6B,EAAqB,CACrB,MAAMvc,EAAUuc,EAAS+N,KAAKnpC,GAAKA,EAAE0wB,iBAAmB9S,GACxD,QAAgB,IAAZiB,EACA,OAAOA,EAAQ8R,gBAM3B,kBAAkBzb,EAAO5G,GACrB,MAAM2Q,EAASpe,KAAKyN,MAGpB,GAFA2Q,EAAOrE,iBAAwB,IAAVtM,EAAmB,KAAOA,EAC/C2Q,EAAOpE,WAAaha,KAAKga,YACP,EAAbha,KAAK0D,OAA2B,EACjC,OAAO4zB,GAAcC,KAKzB,GAHAljB,GAAS,KACTrU,KAAK0D,OAAS,EACd1D,KAAK2W,UAAUW,UAAUP,QACrB/W,KAAKu0B,MAAM/Y,cAAe,CAC1B,MAAM+sB,EAAMvoC,KAAK8Z,eAAe0uB,WAAWn0B,GAC3C,GAAI8kB,GAAaoP,GAEb,OAAO,IAAIzP,GAAiByP,EAAKvoC,KAAKyoC,aAAczoC,KAAMqU,EAAOrU,KAAKyN,OAG9E,OAAOzN,KAAKyoC,aAAap0B,EAAOrU,KAAKyN,OAEzC,oBAAoB4G,EAAO5G,GACvB,IAAkB,EAAbzN,KAAK0D,OAA2B,EAAG,CACpC,GAAI1D,KAAKyN,QAAUA,EACf,OAAO6pB,GAAcC,KAEzBljB,GAAS,KACT,MAAMuX,EAAO5rB,KAAKwf,OAAOnL,GACzB,IAAKuX,EAAK2L,KACN,OAAO,IAAIuB,GAAiBlN,EAAM5rB,KAAKhJ,KAAMgJ,KAAMqU,EAAO5G,QAI9D4G,GAAS,KAKb,GAHArU,KAAK0D,OAAS,EACd1D,KAAKyN,MAAQA,EACbzN,KAAK2W,UAAUW,UAAUP,QACrB/W,KAAKu0B,MAAM/Y,cAAe,CAC1B,MAAM+sB,EAAMvoC,KAAK8Z,eAAe0uB,WAAWn0B,GAC3C,GAAI8kB,GAAaoP,GACb,OAAO,IAAIzP,GAAiByP,EAAKvoC,KAAK0oC,QAAS1oC,KAAMqU,GAI7D,OADArU,KAAK0oC,QAAQr0B,GACNijB,GAAcC,KAEzB,cAAcljB,EAAO5G,GACjB,GAAa,MAATA,EACA,MAAM,IAAIhN,MAAM,8BAGpB,GADAgN,EAAMuM,WAAa,YAAcvM,EAAMuM,WAAYha,KAAKga,YAAY,IAClD,EAAbha,KAAK0D,OAA2B,EAAG,CACpC,GAAI1D,KAAKyN,QAAUA,IAAuB,IAAbzN,KAAK0D,OAAoC,EAClE,OAAO4zB,GAAcC,KAEzBljB,GAAS,KACT,MAAMuX,EAAO5rB,KAAKwf,OAAOnL,GACzB,IAAKuX,EAAK2L,KACN,OAAO,IAAIuB,GAAiBlN,EAAM5rB,KAAKhJ,KAAMgJ,KAAMqU,EAAO5G,QAI9D4G,GAAS,KAOb,OALgD,IAA9B,IAAbrU,KAAK0D,SACN1D,KAAKyN,MAAQA,GAEjBzN,KAAK0D,OAAS,EACd1D,KAAK2W,UAAUW,UAAUP,QAClB/W,KAAKyoC,aAAap0B,EAAOrU,KAAKyN,OAEzC,aAAa4G,EAAO5G,GAChB,MAAM,SAAE8sB,GAAav6B,KACrB,QAAiB,IAAbu6B,EAAqB,CACrB,MAAM,OAAEjgC,GAAWigC,EACfv6B,KAAKy/B,kBACLprB,GAAS,GAEb,IAAK,IAAI7e,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1B+kC,EAAS/kC,GAAGipB,MAAMpK,EAAO5G,EAAOzN,KAAK2Z,MAG7C,OAAO3Z,KAAK2oC,gBAAgBt0B,EAAOrU,KAAKyN,OAE5C,gBAAgB4G,EAAO5G,GACnB,IACIme,EADAqM,OAAQ,EAEZ,MAAM,YAAEgL,GAAgBjjC,KACxB,QAAoB,IAAhBijC,EAAwB,CACxB,MAAM,OAAE3oC,GAAW2oC,EACnB,IAAK,IAAIztC,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BytC,EAAYztC,GAAGuF,OAASiF,KACxB4rB,EAAOqX,EAAYztC,GAAGwB,KAAKqd,EAAO5G,EAAOzN,KAAK2Z,MACzCiS,EAAK2L,YACQ,IAAVU,IACAA,EAAQ,IAEZA,EAAMp4B,KAAK+rB,IAIvB,YAAc,IAAVqM,GACAj4B,KAAK0oC,QAAQr0B,GACNijB,GAAcC,MAElB,IAAI0B,GAA0BhB,EAAOj4B,KAAK0oC,QAAS1oC,KAAMqU,GAEpE,QAAQA,GACArU,KAAKu0B,MAAM9Y,cACXzb,KAAK2W,UAAUW,UAAU1b,IAAIoE,MAEjCA,KAAK0D,MAAqB,EAAb1D,KAAK0D,MAA4B,EAC9C1D,KAAK2W,UAAUW,UAAUN,IAAI3C,GAEjC,oBAAoBA,GAChB,GAAuC,IAArB,EAAbrU,KAAK0D,OACN,OAAO4zB,GAAcC,KAMzB,GAJAv3B,KAAKyN,MAAMsM,YAAc,KACzB/Z,KAAK0D,OAAS,EACd2Q,GAAS,KACTrU,KAAK2W,UAAUe,YAAYX,QACvB/W,KAAKu0B,MAAM7Y,gBAAiB,CAC5B,MAAM6sB,EAAMvoC,KAAK8Z,eAAe8uB,aAAav0B,GAC7C,GAAI8kB,GAAaoP,GACb,OAAO,IAAIzP,GAAiByP,EAAKvoC,KAAK6oC,kBAAmB7oC,KAAMqU,GAGvE,OAAOrU,KAAK6oC,kBAAkBx0B,GAElC,sBAAsBA,GAClB,GAAuC,IAArB,EAAbrU,KAAK0D,OACN,OAAO4zB,GAAcC,KAKzB,GAHAv3B,KAAK0D,OAAS,EACd2Q,GAAS,KACTrU,KAAK2W,UAAUe,YAAYX,QACvB/W,KAAKu0B,MAAM7Y,gBAAiB,CAC5B,MAAM6sB,EAAMvoC,KAAK8Z,eAAe8uB,aAAav0B,GAC7C,GAAI8kB,GAAaoP,GACb,OAAO,IAAIzP,GAAiByP,EAAKvoC,KAAK8oC,UAAW9oC,KAAMqU,GAI/D,OADArU,KAAK8oC,UAAUz0B,GACRijB,GAAcC,KAEzB,gBAAgBljB,GACZ,OAAuC,IAArB,EAAbrU,KAAK0D,OACC4zB,GAAcC,MAEzBv3B,KAAK0D,OAAS,EACd2Q,GAAS,KACTrU,KAAK2W,UAAUe,YAAYX,QACpB/W,KAAK6oC,kBAAkBx0B,IAElC,eAAeA,GACX,MAAM,SAAEkmB,GAAav6B,KACrB,QAAiB,IAAbu6B,EACA,IAAK,IAAI/kC,EAAI+kC,EAASjgC,OAAS,EAAG9E,GAAK,IAAKA,EACxC+kC,EAAS/kC,GAAGkpB,QAAQrK,GAG5BrU,KAAK8oC,UAAUz0B,GAEnB,kBAAkBA,GACd,IACIuX,EADAqM,OAAQ,EAEZ,MAAM,YAAEgL,GAAgBjjC,KACxB,QAAoB,IAAhBijC,EACA,IAAK,IAAIztC,EAAIytC,EAAY3oC,OAAS,EAAG9E,GAAK,IAAKA,EAC3Co2B,EAAOqX,EAAYztC,GAAGgqB,OAAOnL,GAC7B4uB,EAAYztC,GAAGuF,YAAS,EACnB6wB,EAAK2L,YACQ,IAAVU,IACAA,EAAQ,IAEZA,EAAMp4B,KAAK+rB,IAIvB,YAAc,IAAVqM,GACAj4B,KAAK+oC,eAAe10B,GACbijB,GAAcC,MAElB,IAAI0B,GAA0BhB,EAAOj4B,KAAK+oC,eAAgB/oC,KAAMqU,GAE3E,UAAUA,GACN,OAAQrU,KAAK0lC,QACT,KAAK,EACD1lC,KAAKyN,WAAQ,EACb,MACJ,KAAK,EAC+C,IAA9B,IAAbzN,KAAK0D,SACN1D,KAAKyN,WAAQ,GAGrBzN,KAAKu0B,MAAM5Y,gBACX3b,KAAK2W,UAAUe,YAAY9b,IAAIoE,MAEnCA,KAAK0D,MAAoD,GAA9B,EAAb1D,KAAK0D,OACnB1D,KAAK2W,UAAUe,YAAYV,IAAI3C,GAInC,oBAAoBA,GAChBA,GAAS,MACTrU,KAAK0D,OAAS,EACd1D,KAAK2W,UAAUiB,MAAMhc,IAAIoE,MACzBA,KAAK2W,UAAUoB,YAAYhB,QACvB/W,KAAKu0B,MAAM3Y,iBACX5b,KAAK8Z,eAAekvB,aAAa30B,GAErCrU,KAAKipC,kBAAkB50B,GACnBrU,KAAKu0B,MAAM1Y,gBACX7b,KAAK2W,UAAUoB,YAAYnc,IAAIoE,MAEnCA,KAAK0D,MAAqB,EAAb1D,KAAK0D,MAA8B,GAChD1D,KAAK2W,UAAUoB,YAAYf,IAAI3C,GAEnC,sBAAsBA,GAClBA,GAAS,MACTrU,KAAK0D,OAAS,EACd1D,KAAK2W,UAAUoB,YAAYhB,QACvB/W,KAAKu0B,MAAM3Y,iBACX5b,KAAK8Z,eAAekvB,aAAa30B,GAEjCrU,KAAKu0B,MAAM1Y,gBACX7b,KAAK2W,UAAUoB,YAAYnc,IAAIoE,MAEnCA,KAAK0D,MAAqB,EAAb1D,KAAK0D,MAA8B,GAChD1D,KAAK2W,UAAUoB,YAAYf,IAAI3C,GAEnC,gBAAgBA,KACO,GAAbrU,KAAK0D,OAA+B,GAAa,SAAR2Q,GAAuC,EAClFrU,KAAK2W,UAAUiB,MAAMhc,IAAIoE,OAGzBqU,GAAS,MACTrU,KAAK0D,OAAS,EACd1D,KAAK2W,UAAUiB,MAAMhc,IAAIoE,MACzBA,KAAK2W,UAAUoB,YAAYhB,QAC3B/W,KAAKipC,kBAAkB50B,GACvBrU,KAAK0D,MAAqB,EAAb1D,KAAK0D,MAA8B,GAChD1D,KAAK2W,UAAUoB,YAAYf,IAAI3C,IAGvC,oBAAoBA,GAChBA,GAAS,MACTrU,KAAK0D,OAAS,GACd1D,KAAK2W,UAAUyB,YAAYrB,QAC3B/W,KAAK2W,UAAUsB,QAAQrc,IAAIoE,MACvBA,KAAKu0B,MAAMzY,iBACX9b,KAAK8Z,eAAeovB,aAAa70B,GAErCrU,KAAKmpC,kBAAkB90B,GACnBrU,KAAKu0B,MAAMxY,gBACX/b,KAAK2W,UAAUyB,YAAYxc,IAAIoE,MAEnCA,KAAK0D,MAAwD,IAAlC,GAAb1D,KAAK0D,OACnB1D,KAAK2W,UAAUyB,YAAYpB,IAAI3C,GAEnC,sBAAsBA,GAClBA,GAAS,MACTrU,KAAK0D,OAAS,GACd1D,KAAK2W,UAAUyB,YAAYrB,QACvB/W,KAAKu0B,MAAMzY,iBACX9b,KAAK8Z,eAAeovB,aAAa70B,GAEjCrU,KAAKu0B,MAAMxY,gBACX/b,KAAK2W,UAAUyB,YAAYxc,IAAIoE,MAEnCA,KAAK0D,MAAwD,IAAlC,GAAb1D,KAAK0D,OACnB1D,KAAK2W,UAAUyB,YAAYpB,IAAI3C,GAEnC,gBAAgBA,GACZA,GAAS,MACTrU,KAAK0D,OAAS,GACd1D,KAAK2W,UAAUyB,YAAYrB,QAC3B/W,KAAK2W,UAAUsB,QAAQrc,IAAIoE,MAC3BA,KAAKmpC,kBAAkB90B,GACvBrU,KAAK0D,MAAwD,IAAlC,GAAb1D,KAAK0D,OACnB1D,KAAK2W,UAAUyB,YAAYpB,IAAI3C,GAEnC,kBAAkBA,GACd,MAAM,YAAE4uB,GAAgBjjC,KACxB,QAAoB,IAAhBijC,EAAwB,CACxB,MAAM,OAAE3oC,GAAW2oC,EACnB,IAAK,IAAIztC,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BytC,EAAYztC,GAAGyhC,OAAO5iB,IAIlC,kBAAkBA,GACd,MAAM,YAAE4uB,GAAgBjjC,KACxB,QAAoB,IAAhBijC,EACA,IAAK,IAAIztC,EAAIytC,EAAY3oC,OAAS,EAAG9E,GAAK,IAAKA,EAC3CytC,EAAYztC,GAAG0hC,OAAO7iB,GAMlC,mBAAmBA,IACG,GAAbrU,KAAK0D,OAA8B,IAGxC1D,KAAK0D,OAAS,GAEd1D,KAAK4+B,UAAUwK,QAAQppC,KAAKs8B,QAEhC,eAAejoB,GACX,MAAMioB,EAAQt8B,KAAKs8B,MACbzF,EAAW72B,KAAK62B,SAEtB,OADA72B,KAAK0D,OAAS,GACN1D,KAAK2lC,eACT,KAAK,EACDrJ,EAAM93B,SAASqyB,GACf,MACJ,QACIyF,EAAMxG,aAAae,IAG/B,qBAAqBxiB,GACyB,IAAxB,GAAbrU,KAAK0D,SAGV1D,KAAK0D,MAA4C,IAAtB,GAAb1D,KAAK0D,OAEnB1D,KAAK4+B,UAAUyK,KAAKrpC,KAAKs8B,QAE7B,iBAAiBjoB,GACb,OAA0C,IAAxB,GAAbrU,KAAK0D,SAGV1D,KAAK0D,MAA4C,IAAtB,GAAb1D,KAAK0D,OAEnB1D,KAAKs8B,MAAMlG,SACXp2B,KAAKs8B,MAAMC,aACO,IAAbv8B,KAAK0D,OAAiC,IACvC1D,KAAK0D,MAA+C,KAAzB,IAAb1D,KAAK0D,OAEf1D,KAAK4iC,YAAY0G,iBAAiBtpC,SAM9C,mBAAmBqU,GACfA,GAAS,MACLrU,KAAKu0B,MAAMvY,YAEXhc,KAAK8Z,eAAeyvB,QAAQl1B,GAGpC,qBAAqBA,GACjBA,GAAS,MACLrU,KAAKu0B,MAAMvY,YAEXhc,KAAK8Z,eAAeyvB,QAAQl1B,GAEhC,MAAM,YAAE4uB,GAAgBjjC,KACxB,QAAoB,IAAhBijC,EAAwB,CACxB,MAAM,OAAE3oC,GAAW2oC,EACnB,IAAK,IAAIztC,EAAI8E,EAAS,EAAG9E,GAAK,IAAKA,EAC/BytC,EAAYztC,GAAG+I,MAAM8V,IAIjC,eAAeA,GACX,MAAM,YAAE4uB,GAAgBjjC,KACxB,QAAoB,IAAhBijC,EAAwB,CACxB,MAAM,OAAE3oC,GAAW2oC,EACnB,IAAK,IAAIztC,EAAI8E,EAAS,EAAG9E,GAAK,IAAKA,EAC/BytC,EAAYztC,GAAG+I,MAAM8V,KAKrC,SAASyxB,GAAkBzxB,EAAO5N,GAC9B,OAAyB,IAArBA,EAAS+iC,SAAwD,IAA3B,EAARn1B,GACvB5N,EAEJ,EAAc6O,YAAY7O,GAAU0O,MAE/C,SAASmxB,GAAU7/B,GACf,IAAIjH,EAASiH,EAASwT,WAOtB,YANe,IAAXza,GACAhD,QAAQrG,eAAesQ,EAAU,aAAc,CAC3CrQ,YAAY,EACZK,MAAO+I,EAAS,KAGjBA,EAEX,SAAS0mC,GAAgBvvB,EAAW/K,EAAYyI,EAAO5N,GACnD,MAAM0sB,EAAYvnB,EAAWunB,UACvBsW,EAAkBvzC,OAAOkwC,oBAAoBjT,GAC7C74B,EAASmvC,EAAgBnvC,OAC/B,GAAIA,EAAS,EAAG,CACZ,IAAIvE,EACA2zC,EACJ,IAAa,EAARr1B,GAAiC,EAClC,IAAK,IAAI7e,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BO,EAAO0zC,EAAgBj0C,GACvBk0C,EAAWvW,EAAUp9B,GACrB,IAAI,GAAiB4gB,EAAWtC,EAAO,EAAciB,YAAY7O,GAAU0O,MAAOpf,EAAM2zC,EAASlrC,SAAUkrC,EAAS3wC,SAGvH,CACD,MAAMstC,EAAYC,GAAU7/B,GAC5B,IAAK,IAAIjR,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BO,EAAO0zC,EAAgBj0C,QACC,IAApB6wC,EAAUtwC,KACV2zC,EAAWvW,EAAUp9B,GACrBswC,EAAUtwC,GAAQ,IAAI,GAAiB4gB,EAAWtC,EAAO5N,EAAU1Q,EAAM2zC,EAASlrC,SAAUkrC,EAAS3wC,QChwBlH,MAAM,GACT,YAAYhD,EAAMiJ,EAAS2X,EAAW2L,GAClCtiB,KAAKjK,KAAOA,EACZiK,KAAKhB,QAAUA,EACfgB,KAAK2W,UAAYA,EACjB3W,KAAKsiB,MAAQA,EACbtiB,KAAK2pC,WAAY,EACjB3pC,KAAKzB,MAAQ,KACbyB,KAAK4pC,WAAa,EAEtB,aAAanmB,EAAMomB,GACXpmB,IACa,MAATA,EACAA,EAAO,GAAYqmB,aAEE,iBAATrmB,IACZA,EAAOsmB,SAAStmB,EAAM,MAEF,IAApBzjB,KAAK4pC,WAAqBC,IAC1B7pC,KAAK4pC,UAAYnmB,IAGrBzjB,KAAK4pC,UAAY,EACjB5pC,KAAKzB,MAAQ,GAGbyB,KAAKzB,MAAQ,KAEjByB,KAAK2pC,UAAY3pC,KAAK4pC,UAAY,EAEtC,iBAAiB3yB,GACb,OAAqB,MAAdjX,KAAKzB,OAAiByB,KAAKzB,MAAMjE,OAAS0F,KAAK4pC,UAE1D,iBAAiB3yB,GACb,QAAIjX,KAAKknC,iBAAiBjwB,KACtBA,EAAW1Y,MAAM,GACjByB,KAAKzB,MAAMsB,KAAKoX,IACT,GAIf,OAAO5C,GACH,MAAM9V,EAAQyB,KAAKzB,MACnB,IAAI0Y,EACJ,OAAa,MAAT1Y,GAAiBA,EAAMjE,OAAS,GAChC2c,EAAa1Y,EAAMoL,MACZsN,IAEXA,EAAa,GAAW+yB,iBAAiBhqC,KAAMA,KAAK2W,UAAW3W,KAAKhB,QAASqV,GACtE4C,GAEX,QAAQ5Q,EAAWic,GAEf,QAAc,KADdA,EAAQzH,GAAW7a,KAAKsiB,MAAOA,IAE3B,OAAOtiB,KAEX,MAAM2Z,EAAO2I,EAAMtiB,KAAKjK,MACxB,YAAa,IAAT4jB,EACO3Z,KAEJ6iC,GAAiBlpB,EAAMtT,EAAWic,GAAOwgB,eAAe9iC,KAAKjK,OAG5E,GAAY+zC,aAAe,MAC3B,MAAMG,GAAY,IAAIC,QACtB,SAASC,GAAWC,GAChB,OAAQH,GAAU9wC,IAAIixC,GAE1B,SAASC,GAA0BD,GAE/B,OADAH,GAAUruC,IAAIwuC,GACP,GAAwBtzC,OAAOszC,GAEnC,MAAME,GAAQ,CACjBv0C,KAAM,IAAS2M,SAASH,OAAO,SAC/BpJ,IAAI1C,GACwB,mBAAVA,IAAyB,IAAS0F,OAAOmuC,GAAMv0C,KAAMU,IAAU,WAAYA,GAE7F,IAAIA,GACA,GAAqB,mBAAVA,GAAwB,WAAYA,EAAO,CAElD,MACM8zC,EADS9zC,EAAM+zC,OACMvgC,OAAOkgC,IAAYhyC,IAAIkyC,IAClD,IAAK,MAAMxnC,KAAO0nC,EACdD,GAAM1uC,IAAInF,EAAOoM,GAGzB,IAAIu3B,EAAQ,IAASh+B,OAAOkuC,GAAMv0C,KAAMU,GAIxC,YAHc,IAAV2jC,GACA,IAASl+B,OAAOouC,GAAMv0C,KAAMqkC,EAAQ,GAAI3jC,GAErC2jC,GAEX,IAAIr5B,EAAM++B,GACN,MAAMl0B,EAAa,GAAwB9U,OAAOgpC,GAClD,IAAI1F,EAAQ,IAASh+B,OAAOkuC,GAAMv0C,KAAMgL,GAOxC,YANc,IAAVq5B,EACA,IAASl+B,OAAOouC,GAAMv0C,KAAMqkC,EAAQ,CAACxuB,GAAa7K,GAGlDq5B,EAAMv6B,KAAK+L,GAERwuB,IAQR,MAAMqQ,GAAe,IAAG3kC,gBAAgB,gBAC1CR,YCpHL,IAMI,GAA0C,SAAU5L,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAI3D,IAAIw/B,GAAqB,MACrB,YAAYC,GACR3qC,KAAK2qC,YAAcA,EAEvB,OAAOzzC,EAAQ0zC,GACX,OAAO5qC,KAAK2qC,YAAYE,0BAA0B3zC,EAAQ0zC,KAGlEF,GAtB8C,SAAUzwC,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAkB3C,CAAW,CAC5BsoB,GAAe,QACf,GAAQ,EAAG6rB,IACX,GAAW,oBAAqB,CAACv0C,UAClCw0C,ICtBI,MAAMI,GAAa,IAAGhlC,gBAAgB,cAAcP,YAAY2E,GAAKA,EAAEjG,UAAU,KAEjF,MAAM,GACT,YAAY8mC,GACR/qC,KAAK+qC,YAAcA,EAEvB,gBAAgB1nC,GACZ,OAAO,IAAaY,UAAU6mC,GAAY9qC,MAAMyF,SAASpC,GAE7D,SAASk+B,EAAMc,EAAWh/B,EAAWgR,EAAQ,KAA0B0F,GACnE1F,OAAkB,IAAVA,EAAmB,EAAeA,EAC1C,MAAM22B,EAAMhrC,KAAK+qC,YACjB,IAAInf,EAAOof,EAAIC,kBA+Bf,OA9BIrf,EAAK2L,KACLv3B,KAAKqhC,OAAOE,EAAMc,EAAWh/B,EAAWgR,GAGxCuX,EAAO,IAAIkN,GAAiBlN,EAAM5rB,KAAKqhC,OAAQrhC,KAAMuhC,EAAMc,EAAWh/B,EAAWgR,GAGjFuX,EADAA,EAAK2L,KACEyT,EAAIE,gBAGJ,IAAIpS,GAAiBlN,EAAMof,EAAIE,cAAeF,GAGrDpf,EADAA,EAAK2L,KACEv3B,KAAKhJ,KAAKqrC,EAAWhuB,EAAO0F,GAG5B,IAAI+e,GAAiBlN,EAAM5rB,KAAKhJ,KAAMgJ,KAAMqiC,EAAWhuB,EAAO0F,GAGrE6R,EADAA,EAAK2L,KACEyT,EAAIG,kBAGJ,IAAIrS,GAAiBlN,EAAMof,EAAIG,gBAAiBH,GAEvDpf,EAAK2L,KACLv3B,KAAKi3B,OAAOoL,EAAWhuB,GAGvBuX,EAAO,IAAIkN,GAAiBlN,EAAM5rB,KAAKi3B,OAAQj3B,KAAMqiC,EAAWhuB,GAE7DuX,EAEX,WAAWyW,EAAWhuB,EAAQ,MAC1B,MAAM4C,EAAa,GAAWm0B,iBAAiB/I,GAE/C,OADAprB,EAAWigB,OAAe,MAAR7iB,GACX4C,EAAWuI,OAAe,KAARnL,GAE7B,OAAOktB,EAAMc,EAAWh/B,EAAWgR,GAC/B,MAAMsC,EAAYtT,EAAUhN,IAAIogB,GAChC,GAAW+rB,iBAAiBH,EAAW1rB,EAAW4qB,EAAMl+B,OAAW,EAAQgR,GAE/E,KAAKguB,EAAWhuB,EAAO0F,GACnB,OAAO,GAAWqxB,iBAAiB/I,GAAWrrC,KAAa,KAARqd,EAA6B0F,GAEpF,OAAOsoB,EAAWhuB,GACd,GAAW+2B,iBAAiB/I,GAAWpL,OAAe,MAAR5iB,IAGtD,GAAU3P,OAAS,CAACozB,IC1Db,MAAM,GACT,YAAYzzB,EAAQhB,GAEhB,GADArD,KAAKqE,OAASA,EACK,MAAfA,EAAOk9B,KACHl+B,EAAUlK,IAAIw7B,IAAO,GACrB30B,KAAKqD,UAAYA,EAAUshC,cAG3B3kC,KAAKqD,UAAYA,EAErB,IAAaoD,SAASkuB,GAAOtwB,EAAOk9B,MAAM97B,SAASzF,KAAKqD,WACxDrD,KAAKuhC,KAAOl9B,EAAOk9B,SAElB,KAAIl+B,EAAUlK,IAAIw7B,IAAO,GAK1B,MAAM,IAAIl0B,MAAM,0BAJhBT,KAAKqD,UAAYA,EACjBrD,KAAKuhC,KAAOl+B,EAAUhN,IAAIs+B,IAK9B30B,KAAKyD,SAA8B,MAAnBY,EAAOZ,SAAqBY,EAAOZ,SAAW,EAC9D,MAAM4nC,EAAcrrC,KAAKqD,UAAUhN,IAAIi1C,IACvCtrC,KAAKw2B,IAAM6U,EAAYE,WAAWlnC,GAClCrE,KAAK2W,UAAY3W,KAAKqD,UAAUhN,IAAIogB,GACpCzW,KAAKwrC,UAAYxrC,KAAKqD,UAAUhN,IAAIy0C,IACpC,MACMW,EADczrC,KAAKqD,UAAUhN,IAAIyhC,IACF4T,kBACjCD,EAAiBlU,MACjBv3B,KAAK4rB,KAAO0L,GAAcC,KAC1Bv3B,KAAKlJ,UAGLkJ,KAAK4rB,KAAO,IAAIkN,GAAiB2S,EAAkBzrC,KAAKlJ,OAAQkJ,MAGxE,SAAS+4B,GACL,MAAM,KAAEnN,EAAI,KAAE2V,EAAI,UAAEtH,EAAS,UAAE52B,EAAS,UAAEmoC,EAAS,SAAE/nC,GAAazD,KAC5DqU,EAAmB,KAAX5Q,EACd,QAAkB,IAAdw2B,EAIA,YAHwB,IAApBj6B,KAAK2rC,aACL3rC,KAAK2rC,WAAa,IAAI7S,GAAiBlN,EAAM5rB,KAAK85B,SAAU95B,KAAM+4B,IAE/D/4B,KAAK2rC,WAEhB,GAAI/f,EAAK2L,KACa,MAAdwB,GAAwBA,EAAWxB,KACnCv3B,KAAK4rB,KAAO4f,EAAU1R,SAASyH,EAAMtH,EAAW52B,EAAWgR,OAAO,GAGlErU,KAAK4rB,KAAO,IAAIkN,GAAiBC,EAAYyS,EAAU1R,SAAU0R,EAAWjK,EAAMtH,EAAW52B,EAAWgR,OAAO,QAInH,GAAkB,MAAd0kB,GAAwBA,EAAWxB,KACnCv3B,KAAK4rB,KAAO,IAAIkN,GAAiBlN,EAAM4f,EAAU1R,SAAU0R,EAAWjK,EAAMtH,EAAW52B,EAAWgR,OAAO,OAExG,CACD,MAAMu3B,EAAqB,IAAI9S,GAAiBlN,EAAMmN,EAAWtB,KAAMsB,GACvE/4B,KAAK4rB,KAAO,IAAIkN,GAAiB8S,EAAoBJ,EAAU1R,SAAU0R,EAAWjK,EAAMtH,EAAW52B,EAAWgR,OAAO,GAG/H,OAAOrU,KAAK4rB,KAEhB,WAAWmN,GACP,MAAM,KAAEnN,EAAI,UAAEqO,EAAS,UAAEuR,EAAS,SAAE/nC,GAAazD,KAC3CqU,EAAmB,KAAX5Q,EACd,QAAkB,IAAdw2B,EAIA,YAHwB,IAApBj6B,KAAK2rC,aACL3rC,KAAK2rC,WAAa,IAAI7S,GAAiBlN,EAAM5rB,KAAK45B,WAAY55B,KAAM+4B,IAEjE/4B,KAAK2rC,WAEhB,GAAI/f,EAAK2L,KACa,MAAdwB,GAAwBA,EAAWxB,KACnCv3B,KAAK4rB,KAAO4f,EAAU5R,WAAWK,EAAW5lB,GAG5CrU,KAAK4rB,KAAO,IAAIkN,GAAiBC,EAAYyS,EAAU5R,WAAY4R,EAAWvR,EAAW5lB,QAI7F,GAAkB,MAAd0kB,GAAwBA,EAAWxB,KACnCv3B,KAAK4rB,KAAO,IAAIkN,GAAiBlN,EAAM4f,EAAU5R,WAAY4R,EAAWvR,EAAW5lB,OAElF,CACD,MAAMu3B,EAAqB,IAAI9S,GAAiBlN,EAAMmN,EAAWtB,KAAMsB,GACvE/4B,KAAK4rB,KAAO,IAAIkN,GAAiB8S,EAAoBJ,EAAU5R,WAAY4R,EAAWvR,EAAW5lB,GAGzG,OAAOrU,KAAK4rB,KAEhB,SACI,MAAMvnB,EAASrE,KAAKqE,OACdoC,EAAWzG,KAAKi6B,UAAY+E,GAAcrgB,OAAOta,EAAOg+B,WACxDriC,KAAKqD,UAAUhN,IAAIgO,EAAOg+B,WAC1Bh+B,EAAOg+B,UACPh/B,EAAYrD,KAAKqD,UACjBsT,EAAYtT,EAAUhN,IAAIogB,GAChCzW,KAAKiX,WAAa,GAAWurB,iBAAiB/7B,EAAUkQ,EAAW3W,KAAKuhC,KAAMl+B,OAAW,EAAQrD,KAAKyD,WAGvG,MAAM,GACT,YAAYJ,EAAY,IAAGe,mBACvBpE,KAAKqD,UAAYA,EACjBrD,KAAK4rB,KAAO0L,GAAcC,KAC1Bv3B,KAAK6rC,YAAa,EAClB7rC,KAAK8rC,aAAc,EACnB9rC,KAAK+rC,aAAc,EACnB/rC,KAAKgsC,WAAQ,EACbhsC,KAAKoX,UAAO,EACZ,IAAa3Q,SAAS,GAASzG,MAAMyF,SAASpC,GAElD,gBACI,OAAOrD,KAAK6rC,WAEhB,iBACI,OAAO7rC,KAAK8rC,YAEhB,iBACI,OAAO9rC,KAAK+rC,YAEhB,WACI,GAAkB,MAAd/rC,KAAKgsC,MAAiB,CACtB,GAAiB,MAAbhsC,KAAKoX,KACL,MAAM,IAAI3W,MAAM,uBAEpB,OAAOT,KAAKoX,KAEhB,OAAOpX,KAAKgsC,MAEhB,YAAYtqC,GAER,OADA1B,KAAKqD,UAAUoC,YAAY/D,GACpB1B,KAEX,IAAIqE,GAKA,OAJArE,KAAKoX,KAAO,IAAI,GAAgB/S,EAAQrE,KAAKqD,WACzCrD,KAAKisC,WACLjsC,KAAK8nB,QAEF9nB,KAEX,MAAMyI,EAAOzI,KAAKoX,MACd,GAAY,MAAR3O,EACA,MAAM,IAAIhI,MAAM,gCAgBpB,OAdAT,KAAKksC,KAAKzjC,GACNzI,KAAK4rB,KAAK2L,KACVv3B,KAAKmsC,cAAc1jC,GAGnBzI,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKmsC,cAAensC,KAAMyI,GAE1EzI,KAAK4rB,KAAO5rB,KAAKyI,KAAKqxB,SAAS95B,KAAK4rB,MAChC5rB,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKosC,aAAa3jC,GAG9BzI,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKosC,aAAcpsC,KAAMyI,GAElEzI,KAAK4rB,KAEhB,KAAKnjB,EAAOzI,KAAKgsC,OAgBb,OAfIhsC,KAAK6rC,YAAsB,MAARpjC,IACfzI,KAAK4rB,KAAK2L,KACVv3B,KAAKqsC,aAAa5jC,GAGlBzI,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKqsC,aAAcrsC,KAAMyI,GAEzEzI,KAAK4rB,KAAOnjB,EAAKmxB,WAAW55B,KAAK4rB,MAC7B5rB,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKssC,YAAY7jC,GAG7BzI,KAAK4rB,KAAO,IAAIkN,GAAiB94B,KAAK4rB,KAAM5rB,KAAKssC,YAAatsC,KAAMyI,IAGrEzI,KAAK4rB,KAEhB,OACI,OAAO5rB,KAAK4rB,KAAK6L,OAErB,cAAchvB,GACVjM,QAAQzD,IAAI0P,EAAK84B,KAAM,WAAYvhC,MACnCA,KAAKgsC,MAAQvjC,EACbzI,KAAK8rC,aAAc,EAEvB,aAAarjC,GAKT,OAJAzI,KAAK6rC,YAAa,EAClB7rC,KAAK8rC,aAAc,EACnB9rC,KAAKw1B,cAAc/sB,EAAM,mBAAoBA,EAAK+tB,KAClDx2B,KAAKw1B,cAAc/sB,EAAM,aAAcA,EAAK84B,MACrCjK,GAAcC,KAEzB,aAAa9uB,GACTzI,KAAK6rC,YAAa,EAClB7rC,KAAK+rC,aAAc,EAEvB,YAAYtjC,GAKR,OAJAjM,QAAQuZ,eAAetN,EAAK84B,KAAM,YAClCvhC,KAAKgsC,WAAQ,EACbhsC,KAAK+rC,aAAc,EACnB/rC,KAAKw1B,cAAc/sB,EAAM,aAAcA,EAAK84B,MACrCjK,GAAcC,KAEzB,cAAc9uB,EAAM1S,EAAM+D,IACtBA,EAAS,kBAAmBA,EAASA,EAAS2O,EAAK+tB,KAC5ChB,cAAc/sB,EAAK+tB,IAAIjB,kBAAkBx/B,EAAM,CAAEw2C,OAAQvsC,KAAMwsC,SAAS,EAAMC,YAAY,MAGzG,IAASC,OAAOC,QAAU,GACnB,MAAMrB,GAAkB,IAAGxlC,gBAAgB,mBAAmBR,YCzLxDsnC,GAAoB,CAfW,GACN,EACD,GACQ,GJgGtC,MACH,cACI5sC,KAAK6sC,8BAAgC,IAAIl1C,QACzCqI,KAAK8sC,4BAA8B,IAAIh0C,IAE3C,gBAAgBuK,GACZ,OAAO,IAAaY,UAAUwmC,GAAczqC,MAAMyF,SAASpC,GAE/D,0BAA0BnM,EAAQ0zC,GAC9B,GAAI1zC,EAAQ,CACR,MAAM61C,EAAiBzC,GAAMnxC,IAAIjC,EAAOyO,aAAe2kC,GAAMj0C,IAAIa,EAAOyO,aAAe,GACjFqnC,EAAiD,mBAAvBpC,EAC1BA,EAAmB1zC,EAAQ61C,GAC3B/sC,KAAKitC,YAAYF,EAAgBnC,GACvC,OAAO5qC,KAAKktC,0BAA0Bh2C,EAAQ61C,EAAgBC,GAElE,OAAO,KAEX,0BAA0B91C,EAAQ61C,EAAgBC,GAC9C,IACIG,EADA3tC,EAASQ,KAAK6sC,8BAA8Bx2C,IAAIa,GASpD,QAPe,IAAXsI,GACAA,EAAS,GACTQ,KAAK6sC,8BAA8B9zC,IAAI7B,EAAQsI,IAG/C2tC,EAAiB3tC,EAAOwtC,QAEL,IAAnBG,EAA2B,CAC3B,MAAMC,EAAmBptC,KAAKqtC,4BAA4Bn2C,EAAQ61C,EAAgBC,GAClFG,EAAiBnO,GAAc9iC,OAAO8iC,GAAc6G,cAAcuH,GAAmB,cAAcA,EAC/F,cACIpb,MAAM96B,MAGdsI,EAAOwtC,GAAoBG,EAE/B,OAAOA,EAEX,4BAA4Bj2C,EAAQ61C,EAAgBC,GAChD,IACII,EADA5tC,EAASQ,KAAK8sC,4BAA4Bz2C,IAAIa,EAAOyO,aASzD,QAPe,IAAXnG,GACAA,EAAS,GACTQ,KAAK8sC,4BAA4B/zC,IAAI7B,EAAOyO,YAAanG,IAGzD4tC,EAAmB5tC,EAAOwtC,QAEL,IAArBI,EAA6B,CAC7BA,EAAmBpO,GAAc9iC,OAAO8D,KAAKstC,QAAQP,EAAgBC,GAAmB,MACpF,YAAY/S,GACRj6B,KAAKi6B,UAAYA,EAErB,OAAOhjB,EAAYktB,EAAiBv4B,EAAY0W,GAC5C,MAAMirB,EAAKvtC,KAAKi6B,UAEhB,GADAhjB,EAAWxJ,MAAQ,EAAM0uB,WAAWllB,EAAW5C,MAAO4C,EAAWxJ,MAAO8/B,QACtD,IAAdA,EAAGz2C,OACH,OAAOy2C,EAAGz2C,OAAOmgB,EAAYktB,EAAiBv4B,EAAY0W,MAItE,MAAMzhB,EAAQusC,EAAiBh2C,UAC3B,kBAAmBF,IACnB2J,EAAM6lC,cAAgB,SAAuBzvB,GACzCjX,KAAKi6B,UAAUyM,cAAczvB,KAGjC,iBAAkB/f,IAClB2J,EAAMkmC,aAAe,SAAsB9vB,GACvCjX,KAAKi6B,UAAU8M,aAAa9vB,KAGhC,yBAA0B/f,IAC1B2J,EAAMomC,qBAAuB,SAA8BhwB,GACvDjX,KAAKi6B,UAAUgN,qBAAqBhwB,KAGxC,eAAgB/f,IAChB2J,EAAM2nC,WAAa,SAAoBn0B,GACnC,OAAOrU,KAAKi6B,UAAUuO,WAAWn0B,KAGrC,cAAend,IACf2J,EAAMyW,UAAY,SAAmBjD,GACjCrU,KAAKi6B,UAAU3iB,UAAUjD,KAG7B,iBAAkBnd,IAClB2J,EAAM+nC,aAAe,SAAsBv0B,GACvC,OAAOrU,KAAKi6B,UAAU2O,aAAav0B,KAGvC,gBAAiBnd,IACjB2J,EAAM6W,YAAc,SAAqBrD,GACrCrU,KAAKi6B,UAAUviB,YAAYrD,KAG/B,iBAAkBnd,IAClB2J,EAAMmoC,aAAe,SAAsB30B,GACvCrU,KAAKi6B,UAAU+O,aAAa30B,KAGhC,gBAAiBnd,IACjB2J,EAAMkX,YAAc,SAAqB1D,GACrCrU,KAAKi6B,UAAUliB,YAAY1D,KAG/B,iBAAkBnd,IAClB2J,EAAMqoC,aAAe,SAAsB70B,GACvCrU,KAAKi6B,UAAUiP,aAAa70B,KAGhC,gBAAiBnd,IACjB2J,EAAMuX,YAAc,SAAqB/D,GACrCrU,KAAKi6B,UAAU7hB,YAAY/D,KAG/B,YAAand,IACb2J,EAAM0oC,QAAU,SAAiBl1B,GAC7BrU,KAAKi6B,UAAUsP,QAAQl1B,KAG/B7U,EAAOwtC,GAAoBI,EAE/B,OAAOA,EAEX,YAAYhT,EAAOoT,GACf,OAAIA,IAGiB,IAAjBpT,EAAM9/B,OACC8/B,EAAM,GAAGrkC,KAEb,gBAEX,QAAQqkC,EAAOrkC,GACX,MAAMiV,EAAIovB,EAAMkO,KAAKp+B,GAAKA,EAAEnU,OAASA,GACrC,QAAU,IAANiV,EAEA,MAAM,IAAIvK,MAAM,wBAAwB1K,KAE5C,OAAOiV,II5NX,MAyBSyiC,GAAmB,CAvBarW,GACED,GACLE,GACZ,GACE,GACE,GACK,GACP,GACkBkJ,GACJmK,GACK,GACD,GACD,GACE,GACF,GACE,GACF,IAiDpCgD,GAAmB,CAjBmB,GAFA,GAJJ,GAOD,GAJU,GAKTzL,GANE,GADE,GAQG,GAJR,IAoCjC0L,GAAuB,CAIhCloC,SAASpC,GACEA,EAAUoC,YAAYmnC,MAAsBa,MAAqBC,IAK5E,kBACI,OAAO1tC,KAAKyF,SAAS,IAAGrB,qBCtIzB,MAAMwpC,GACT,YAAYlkC,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MAGb,MAAM,GACT,YAAYh4B,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKrJ,KAAO0tB,GAAYqL,QACxB1vB,KAAK0vB,SAAU,GAGhB,MAAM,GACT,YAAYhmB,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKrJ,KAAO0tB,GAAYxE,OACxB7f,KAAK0vB,SAAU,GAGhB,MAAM,GACT,YAAYhmB,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKrJ,KAAO0tB,GAAYvE,SACxB9f,KAAK0vB,SAAU,GAGhB,MAAM,GACT,YAAYhmB,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKrJ,KAAO0tB,GAAY4N,OACxBjyB,KAAK0vB,SAAU,GAGhB,MAAMme,GACT,YAAYnkC,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MAGb,MAAMoM,GACT,YAAYpkC,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MAGb,MAAMqM,GACT,YAAYrkC,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAK0hC,KAAO,MAGb,MAAMsM,GACT,YAAYv3C,EAAO6uB,GACftlB,KAAKvJ,MAAQA,EACbuJ,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MAGb,MAAMuM,GACT,YAAY7L,EAAKhD,EAAc9c,GAC3BtiB,KAAKoiC,IAAMA,EACXpiC,KAAKo/B,aAAeA,EACpBp/B,KAAKsiB,MAAQA,EACbtiB,KAAK0hC,KAAO,MAGb,MAAMwM,GACT,YAAY9L,EAAKhD,GACbp/B,KAAKoiC,IAAMA,EACXpiC,KAAKo/B,aAAeA,EACpBp/B,KAAK0hC,KAAO,MAGb,MAAMyM,GACT,YAAYtrC,EAAKu/B,EAAKhD,EAAc9B,EAAMhb,GACtCtiB,KAAK6C,IAAMA,EACX7C,KAAKoiC,IAAMA,EACXpiC,KAAKo/B,aAAeA,EACpBp/B,KAAKs9B,KAAOA,EACZt9B,KAAKsiB,MAAQA,EACbtiB,KAAK0hC,KAAO,MAGb,MAAM0M,GACT,YAAYhP,EAAchO,GACtBpxB,KAAKo/B,aAAeA,EACpBp/B,KAAKoxB,iBAAmBA,EACxBpxB,KAAK0hC,KAAO,MAGb,MAAM2M,GACT,YAAY3kC,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MC7GpB,i3FjBmCyB,MAAM4M,EAC3B,YAAY5M,GACR1hC,KAAK0hC,KAAOA,EACZ1hC,KAAKuuC,WAAQ,EACbvuC,KAAKwuC,oBAAiB,EACtBxuC,KAAKyuC,gBAAa,EAClBzuC,KAAK0uC,UAAO,EACZ1uC,KAAK2uC,eAAY,EACjB3uC,KAAK4uC,WAAQ,EAEjB,WACI,QAAmB,IAAf5uC,KAAKuuC,MACL,MAAM,IAAI9tC,MAAM,6BAEpB,OAAOT,KAAKuuC,MAEhB,oBACI,QAA4B,IAAxBvuC,KAAKwuC,eACL,MAAM,IAAI/tC,MAAM,sCAEpB,OAAOT,KAAKwuC,eAEhB,gBACI,QAAwB,IAApBxuC,KAAKyuC,WACL,MAAM,IAAIhuC,MAAM,kCAEpB,OAAOT,KAAKyuC,WAEhB,UACI,QAAkB,IAAdzuC,KAAK0uC,KACL,MAAM,IAAIjuC,MAAM,4BAEpB,OAAOT,KAAK0uC,KAEhB,eACI,QAAuB,IAAnB1uC,KAAK2uC,UACL,MAAM,IAAIluC,MAAM,iCAEpB,OAAOT,KAAK2uC,UAEhB,WACI,QAAmB,IAAf3uC,KAAK4uC,MACL,MAAM,IAAInuC,MAAM,6BAEpB,OAAOT,KAAK4uC,MAEhB,YAAY73C,GACR,MAAM60B,EAAO,IAAI0iB,EAAW,GAE5B,OADA1iB,EAAK8iB,KAAO33C,EACL60B,EAEX,YAAYijB,GACR,MAAMjjB,EAAO,IAAI0iB,EAAW,GAE5B,OADA1iB,EAAK4iB,eAAiBK,EACfjjB,EAEX,eACI,OAAO5rB,KAAK8uC,GAAG,GAEnB,eACI,OAAO9uC,KAAK8uC,GAAG,GAEnB,aACI,OAAO9uC,KAAK8uC,GAAG,GAEnB,eACI,OAAO9uC,KAAK8uC,GAAG,GAEnB,GAAG9W,GAEC,OADAh4B,KAAKuuC,MAAQvW,EACNh4B,KAEX,KAAKqB,GAED,OADArB,KAAK2uC,UAAYttC,EACVrB,KAEX,SAASqD,GACL,OAAOrD,KAAKyuC,WAAaprC,EAAUoC,SAAS,IAAagB,SAASmxB,GAAY53B,OAElF,cACI,QAAmB,IAAfA,KAAK4uC,MACL,OAAQ5uC,KAAK0hC,MACT,KAAK,EACD1hC,KAAK4uC,MAAQ,IAAIjW,GAAa34B,KAAKqD,UAAWrD,KAAKjJ,IAAKiJ,KAAKxB,UAC7D,MACJ,KAAK,EACDwB,KAAK4uC,MAAQ,IAAI5V,GAAah5B,KAAK6uC,eAI/C,OAAO7uC,KAAK4rB,UiB7HpB,mL,wCCIO,MAAM,EACT,YAAY4K,EAAKuY,EAAaC,EAAoBpf,EAAkB91B,EAAQm1C,EAAgBC,EAAc/wB,GACtGne,KAAKw2B,IAAMA,EACXx2B,KAAK+uC,YAAcA,EACnB/uC,KAAKgvC,mBAAqBA,EAC1BhvC,KAAK4vB,iBAAmBA,EACxB5vB,KAAKlG,OAASA,EACdkG,KAAKivC,eAAiBA,EACtBjvC,KAAKkvC,aAAeA,EACpBlvC,KAAKme,QAAUA,EACfne,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EAElB,WAAWrQ,GACP,MAAM4L,EAAkB5Z,KAAKoe,OAAOxE,gBACpCA,EAAgBu1B,OAASnhC,EACzB,MAAMnR,EAASmD,KAAK4vB,iBAAiBxQ,SAAS,QAA4Bpf,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,MAK1G,OAJAnd,QAAQuZ,eAAe6D,EAAiB,WACzB,IAAX/c,GAAmBmD,KAAKivC,gBACxBjhC,EAAMihC,iBAEHpyC,EAEX,YAAYmR,GACRhO,KAAKke,YAAYM,WAAWxQ,GAEhC,MAAMqG,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAgB,KAARrK,GAG7BrU,KAAKqe,QAAU,EACfre,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACZ,MAAMiW,EAAmB5vB,KAAK4vB,iBAC1B,aAAQA,IACRA,EAAiB54B,KAAKqd,EAAO5G,EAAOzN,KAAKke,aAE7Cle,KAAKoG,QAAUpG,KAAKkvC,aAAala,iBAAiBh1B,KAAKw2B,IAAKx2B,KAAKlG,OAAQkG,KAAK+uC,YAAa/uC,KAAMA,KAAKgvC,oBAEtGhvC,KAAKqe,QAAU,EACfre,KAAKqe,SAAU,EAEnB,QAAQhK,GACJ,KAAoB,EAAdrU,KAAKqe,QACP,OAGJre,KAAKqe,QAAU,EACf,MAAMuR,EAAmB5vB,KAAK4vB,iBAC1B,aAAUA,IACVA,EAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAErDle,KAAKoe,OAAS,KACdpe,KAAKoG,QAAQwD,UACb5J,KAAKoG,QAAU,KAEfpG,KAAKqe,SAAU,EAEnB,gBAAgBhK,EAAO9X,EAAKwgB,IAG5B,aAAa5I,EAAUC,EAAeC,K,WC/DtCtJ,EAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAQ1G,IAAIokC,EAAoB,MACpB,YAAY1jB,EAAWrX,EAAO2I,EAAiBzgB,EAAK/D,EAAa62C,GAC7DrvC,KAAK0rB,UAAYA,EACjB1rB,KAAKgd,gBAAkBA,EACvBhd,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAKqvC,gBAAkBA,EACvBrvC,KAAK+Y,aAAe,KACpB/Y,KAAKuV,SAAW,KAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,GAAiB/Y,KAEzB,OADAA,KAAKuV,SAAWwD,EACR/Y,KAAKqvC,iBACT,IAAK,QAYKt2B,EACF/Y,KAAKzD,IAAIizC,UAAU5zC,IAAIoE,KAAKxH,aAG5BwH,KAAKzD,IAAIizC,UAAUpZ,OAAOp2B,KAAKxH,aAEnC,MAEJ,IAAK,QAAS,CACV,IAAIi3C,EAAW,GACXt7B,EAAW4E,EACS,iBAAb5E,GAAyBA,EAAShF,SAAS,gBAClDsgC,EAAW,YACXt7B,EAAWA,EAASyc,QAAQ,aAAc,KAE9C5wB,KAAKzD,IAAImzC,MAAMC,YAAY3vC,KAAKxH,YAAa2b,EAAUs7B,MAKvE,eAAeG,GACX,IAAIC,GAAgB,EACpB,IAAK,IAAIr6C,EAAI,EAAGkS,EAAKkoC,EAAgBt1C,OAAQoN,EAAKlS,IAAKA,EAAG,CACtD,MAAM4rC,EAASwO,EAAgBp6C,GAC/B,GAAoB,eAAhB4rC,EAAOM,MAAyBN,EAAO0O,gBAAkB9vC,KAAKxH,YAAa,CAC3Eq3C,GAAgB,EAChB,OAGR,GAAIA,EAAe,CACf,IAAI17B,EACJ,OAAQnU,KAAKqvC,iBACT,IAAK,QACDl7B,EAAWnU,KAAKzD,IAAIizC,UAAUO,SAAS/vC,KAAKxH,aAC5C,MACJ,IAAK,QACD2b,EAAWnU,KAAKzD,IAAImzC,MAAMM,iBAAiBhwC,KAAKxH,aAChD,MACJ,QACI,MAAM,IAAIiI,MAAM,gCAAgCT,KAAKqvC,mBAE7D,GAAIl7B,IAAanU,KAAK+Y,aAAc,CAChC,MAAM,aAAEA,GAAiB/Y,KACzBA,KAAK+Y,aAAe/Y,KAAKuV,SAAWpB,EACpCnU,KAAKsvC,YAAa,EAClBtvC,KAAKqS,gBAAgB8B,EAAU4E,EAAc,UAIzD,UAAU/F,GACDhT,KAAKoS,mBACNpS,KAAK+Y,aAAe/Y,KAAKuV,SAAWvV,KAAKzD,IAAI0zC,aAAajwC,KAAKxH,aAC/D03C,EAAiBlwC,KAAKzD,IAAKyD,OAE/BA,KAAKiS,cAAce,GAEvB,YAAYA,GACRhT,KAAKkS,iBAAiBc,GACjBhT,KAAKoS,kBACN+9B,EAAgBnwC,KAAKzD,IAAKyD,MAGlC,KAAKqU,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAGjG,OAAO5X,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,QAIxBwjB,EA3I8C,SAAUn1C,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAuI5CqU,CAAW,CAC3B,eACAI,EAAW,oBAAqB,CAAC7U,OAAQmjB,OAAQnjB,OAAQA,OAAQkC,OAAQA,UAC1Eg3C,GAEH,MAAMc,EAAmB,CAACroB,EAASuoB,UACFjrC,IAAzB0iB,EAAQwoB,eACRxoB,EAAQwoB,aAAe,IAAI10C,UAEJwJ,IAAvB0iB,EAAQyoB,aACRzoB,EAAQyoB,WAAa,IAAI7a,mBAAmB5N,EAAS0oB,EAAgB,CAAEr2C,YAAY,KAEvF2tB,EAAQwoB,aAAaz0C,IAAIw0C,IAEvBD,EAAkB,CAACtoB,EAASuoB,KAC9B,MAAMC,EAAexoB,EAAQwoB,aAC7B,SAAIA,IAAgBA,EAAat0C,OAAOq0C,MACV,IAAtBC,EAAa5sB,OACboE,EAAQyoB,WAAWE,aACnB3oB,EAAQyoB,gBAAanrC,IAElB,IAITorC,EAAkBX,IACpBA,EAAgB,GAAG91C,OAAOu2C,aAAax/B,QAAQ4/B,EAAsBb,IAEzE,SAASa,EAAqBl5C,GAC1BA,EAAEg5C,eAAevwC,MCxKrB,IAAI,EAA0C,SAAU/F,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,EAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAM1G,MAAM,QAAE0kB,EAAO,OAAE7P,EAAM,SAAEC,GAAa,IAEhC6P,EAAkB9P,EAAS6P,EAIjC,IAAI,EAAmB,MACnB,YAAYE,EAAkB91B,EAM9Bu1C,EAAiBxf,EAAgBl5B,EAAMqmB,EAAiBmB,GACpDne,KAAK4vB,iBAAmBA,EACxB5vB,KAAKqvC,gBAAkBA,EACvBrvC,KAAK6vB,eAAiBA,EACtB7vB,KAAKrJ,KAAOA,EACZqJ,KAAKgd,gBAAkBA,EACvBhd,KAAKme,QAAUA,EACfne,KAAKke,YAAcle,KACnBA,KAAKqe,OAAS,EACdre,KAAKoe,OAAS,KACdpe,KAAKiZ,gBAAkB,EACvBjZ,KAAKlG,OAASA,EACd,KAAY0jB,WAAWxd,MACvBA,KAAK0wC,WAAavyB,EAAQ9nB,IAAI,KAElC,aAAaI,EAAO4d,GAChBA,GAASrU,KAAKiZ,gBACdjZ,KAAK8vB,eAAe3W,SAAS1iB,EAAe,GAAR4d,GAExC,aAAa5d,EAAO4d,GAChBA,GAASrU,KAAKiZ,gBACdjZ,KAAK4vB,iBAAiBtyB,OAAe,GAAR+W,EAAyCrU,KAAKoe,OAAQpe,KAAKme,QAAS1nB,GAErG,aAAa0d,EAAU6b,EAAgB3b,GACnC,GAAoB,EAAdrU,KAAKqe,OAAX,CAQA,GALAhK,GAASrU,KAAKiZ,gBACVjZ,KAAKrJ,OAAS,IAAYmpB,WAC1BzL,IAAS,GACTA,GAAS,IAED,GAARA,EAAuC,CACvC,MAAMD,EAAgBpU,KAAK8vB,eAAe5W,WAa1C,OAXoC,QAAhClZ,KAAK4vB,iBAAiB7Q,OAAqC/e,KAAK4c,cAAgB,KAChFzI,EAAWnU,KAAK4vB,iBAAiBxQ,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,OAEjFxF,IAAaC,GACbpU,KAAKke,YAAYI,aAAanK,EAAUE,QAEd,IAAzBrU,KAAKrJ,KAAO+4B,KACb1vB,KAAK6c,UACL7c,KAAK4vB,iBAAiBvQ,QAAQhL,EAAOrU,KAAKoe,OAAQpe,KAAKke,YAAale,KAAK2Z,MACzE3Z,KAAKke,YAAYhB,WAAU,KAInC,KAAY,GAAR7I,GAMJ,MAAM,IAAS1S,MAAM,GAAI0S,GALjBF,IAAanU,KAAK4vB,iBAAiBxQ,SAAS/K,EAAOrU,KAAKoe,OAAQpe,KAAKme,QAASne,KAAK2Z,OACnF3Z,KAAKke,YAAYK,aAAapK,EAAUE,IAMpD,MAAMA,EAAO5G,EAAOkM,GAChB,GAAkB,EAAd3Z,KAAKqe,OAA0B,CAC/B,GAAIre,KAAKoe,SAAW3Q,EAChB,OAEJzN,KAAKke,YAAYQ,QAAgB,KAARrK,GAG7BrU,KAAKqe,QAAU,EAGfre,KAAKiZ,gBAA0B,WAAR5E,EACvBrU,KAAKoe,OAAS3Q,EACdzN,KAAK2Z,KAAOA,EACZ,IAAIiW,EAAmB5vB,KAAK4vB,iBACxB,aAAQA,IACRA,EAAiB54B,KAAKqd,EAAO5G,EAAOzN,KAAKke,aAE7C,IAAI4R,EAAiB9vB,KAAK8vB,eACrBA,IACDA,EAAiB9vB,KAAK8vB,eAAiB,IAAIsf,EAAkBpvC,KAAK0wC,WAAYr8B,EAAOrU,KAAKgd,gBAAiBhd,KAAKlG,OAAQkG,KAAK6vB,eAAgB7vB,KAAKqvC,kBAElJvf,EAAe94B,MACf84B,EAAe94B,KAAKqd,GAGxBub,EAAmB5vB,KAAK4vB,iBACpB5vB,KAAKrJ,KAAOg5B,GACZ3vB,KAAKke,YAAYI,aAAasR,EAAiBxQ,SAAS/K,EAAO5G,EAAOzN,KAAKme,QAASxE,GAAOtF,GAE3FrU,KAAKrJ,KAAOkpB,GACZ+P,EAAiBvQ,QAAQhL,EAAO5G,EAAOzN,KAAM2Z,GAE7C3Z,KAAKrJ,KAAOmpB,IACZgQ,EAAe9vB,KAAK0U,KAAO,GAC3Bob,EAAehe,UAAU9R,KAAKke,cAGlCle,KAAKqe,QAAU,EACfre,KAAKqe,SAAU,EAEnB,QAAQhK,GACgB,EAAdrU,KAAKqe,SAIXre,KAAKqe,QAAU,EAEfre,KAAKiZ,gBAAkB,EACnB,aAAUjZ,KAAK4vB,mBACf5vB,KAAK4vB,iBAAiBpQ,OAAOnL,EAAOrU,KAAKoe,OAAQpe,KAAKke,aAE1Dle,KAAKoe,OAAS,KACVpe,KAAK8vB,eAAetQ,QACpBxf,KAAK8vB,eAAetQ,OAAOnL,GAE3BrU,KAAK8vB,eAAexd,cACpBtS,KAAK8vB,eAAexd,YAAYtS,KAAKke,aACrCle,KAAK8vB,eAAe9vB,KAAK0U,MAAO,IAEpC1U,KAAKke,YAAYhB,WAAU,GAE3Bld,KAAKqe,SAAU,GAEnB,QAAQhK,GACc,EAAdrU,KAAKqe,SACLhK,GAASrU,KAAKiZ,gBACdjZ,KAAK4vB,iBAAiBvQ,QAAgB,QAARhL,EAAoCrU,KAAKoe,OAAQpe,KAAKke,YAAale,KAAK2Z,SAIlH,EAAmB,EAAW,CAC1B,eACA,EAAW,oBAAqB,CAACzjB,OAAQA,OAAQkC,OAAQA,OAAQihB,OAAQnjB,OAAQA,UAClF,GCxJI,MAAMy6C,EACT,YAAYjlB,EAAWrX,EAAO9X,EAAK/D,EAAao4C,GAC5C5wC,KAAK0rB,UAAYA,EACjB1rB,KAAKxH,YAAcA,EACnBwH,KAAK4wC,UAAYA,EACjB5wC,KAAK+Y,aAAe,KACpB/Y,KAAKuV,SAAW,KAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKzD,IAAMA,EACXyD,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,GAAiB/Y,KACzBA,KAAKuV,SAAWwD,EACI,MAAhBA,EACA/Y,KAAKzD,IAAIs0C,kBAAkB7wC,KAAK4wC,UAAW5wC,KAAKxH,aAGhDwH,KAAKzD,IAAIu0C,eAAe9wC,KAAK4wC,UAAW5wC,KAAKxH,YAAaugB,IAItE,KAAK1E,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAE7FjsB,KAAK+Y,aAAe/Y,KAAKuV,SAAWvV,KAAKzD,IAAIw0C,eAAe/wC,KAAK4wC,UAAW5wC,KAAKxH,aAErF,OAAO6b,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,OCzDxB,IAAI,EAA0C,SAAU3xB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,EAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAG1G,MAAMxU,EAAcN,OAAOkB,UAAUkB,SACrC,SAAS04C,EAAe9xC,EAAGC,GACvB,OAAOD,IAAMC,EAEjB,IAAI,EAAkB,MAClB,YAAYusB,EAAWrX,EAAOsC,EAAWvQ,EAAS7J,GAC9CyD,KAAK0rB,UAAYA,EACjB1rB,KAAK2W,UAAYA,EACjB3W,KAAKoG,QAAUA,EACfpG,KAAKzD,IAAMA,EACXyD,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKixC,wBAAqB,EAC1BjxC,KAAKkxC,mBAAgB,EACrBlxC,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,SACE,OAAzB,KAARlB,IAAiF,YAAzBrU,KAAKiZ,gBAC9DjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAMv2B,EAAe/Y,KAAKuV,SAAWvV,KAAK+Y,kBACf,IAAvB/Y,KAAKkxC,qBACuB,IAAxBlxC,KAAKzD,IAAI0d,kBACyB,IAA9Bja,KAAKzD,IAAI0d,WAAWk3B,MACpBnxC,KAAKkxC,cAAgBlxC,KAAKzD,IAAI0d,WAAWk3B,WAEN,IAA9BnxC,KAAKzD,IAAI0d,WAAWxjB,QACzBuJ,KAAKkxC,cAAgBlxC,KAAKzD,IAAI0d,WAAWxjB,aAGtB,IAAvBuJ,KAAKkxC,eACLlxC,KAAKkxC,cAAcp/B,UAAU9R,YAGL,IAA5BA,KAAKixC,qBACLjxC,KAAKixC,mBAAmBl+B,0BAA0B/S,MAClDA,KAAKixC,wBAAqB,GAER,aAAlBjxC,KAAKzD,IAAImlC,OACT1hC,KAAKixC,mBAAqB,aAAsB58B,EAAOrU,KAAK2W,UAAWoC,QACvC,IAA5B/Y,KAAKixC,oBACLjxC,KAAKixC,mBAAmBn+B,sBAAsB9S,OAGtDA,KAAKoxC,sBAGb,uBAAuBr8B,EAAUV,GAC7B,MAAM,aAAE0E,EAAY,SAAExD,GAAavV,MACtB,KAARqU,GAA+B,GAA8B,YAAzBrU,KAAKiZ,iBAC1CjZ,KAAKuV,SAAWwD,EAChB/Y,KAAKoxC,sBAGLpxC,KAAKsvC,YAAa,EAEO,YAAzBtvC,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OAC/E5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAGpB5rB,KAAKqS,gBAAgB0G,EAAcxD,EAAUlB,GAEjD,aAAaF,EAAUC,EAAeC,IACrB,KAARA,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKoxC,qBAGLpxC,KAAKsvC,YAAa,EAEO,YAAzBtvC,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OAC/E5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,KAEvErU,KAAKqS,gBAAgB8B,EAAUC,EAAeC,GAElD,qBACI,MAAM0E,EAAe/Y,KAAK+Y,aACpBxc,EAAMyD,KAAKzD,IACX80C,EAAen7C,OAAOkB,UAAUC,eAAe1B,KAAK4G,EAAK,SAAWA,EAAI40C,MAAQ50C,EAAI9F,MACpF66C,EAAuB,UAAb/0C,EAAImlC,KACd6P,OAA0B,IAAhBh1C,EAAIg1C,QAAqBh1C,EAAIg1C,QAAUP,EACvD,GAAIM,EACA/0C,EAAIi1C,UAAYD,EAAQx4B,EAAcs4B,QAErC,IAAqB,IAAjBt4B,EACLxc,EAAIi1C,SAAU,MAEb,CACD,IAAIC,GAAW,EACf,OAAQj7C,EAAYb,KAAKojB,IACrB,IAAK,iBACD04B,GAA8E,IAAnE14B,EAAa24B,UAAUhyC,KAAU6xC,EAAQ7xC,EAAM2xC,IAC1D,MACJ,IAAK,eACD,IAAK,MAAMrmC,KAAK+N,EACZ,GAAIw4B,EAAQvmC,EAAGqmC,GAAe,CAC1BI,GAAW,EACX,MAGR,MACJ,IAAK,eACD,IAAK,MAAME,KAAQ54B,EAAc,CAC7B,MAAM64B,EAAeD,EAAK,GACpBE,EAAaF,EAAK,GAGxB,GAAIJ,EAAQK,EAAcP,KAAgC,IAAfQ,EAAqB,CAC5DJ,GAAW,EACX,QAIhBl1C,EAAIi1C,QAAUC,GAGtB,cACI,IAAI14B,EAAe/Y,KAAKuV,SAAWvV,KAAK+Y,aACxC,MAAMxc,EAAMyD,KAAKzD,IACX80C,EAAen7C,OAAOkB,UAAUC,eAAe1B,KAAK4G,EAAK,SAAWA,EAAI40C,MAAQ50C,EAAI9F,MACpFq7C,EAAYv1C,EAAIi1C,QAChBD,OAA0B,IAAhBh1C,EAAIg1C,QAAqBh1C,EAAIg1C,QAAUP,EACvD,GAAiB,aAAbz0C,EAAImlC,KAAqB,CACzB,MAAMqQ,EAAcv7C,EAAYb,KAAKojB,GACrC,GAAoB,mBAAhBg5B,EAAkC,CASlC,MAAM7sC,EAAQ6T,EAAa24B,UAAUhyC,KAAU6xC,EAAQ7xC,EAAM2xC,IAc7D,YAXIS,IAAwB,IAAX5sC,EACb6T,EAAalZ,KAAKwxC,GAEZS,IAAwB,IAAX5sC,GAInB6T,EAAanH,OAAO1M,EAAO,IAM9B,GAAoB,iBAAhB6sC,EAAgC,CAUrC,MAAMC,EAAQ,GACd,IAAIJ,EAAeI,EACnB,IAAK,MAAMv7C,KAASsiB,EAChB,IAAqC,IAAjCw4B,EAAQ96C,EAAO46C,GAAwB,CACvCO,EAAen7C,EACf,MAqBR,YAdIq7C,GAAaF,IAAiBI,EAE9Bj5B,EAAand,IAAIy1C,GAEXS,GAAaF,IAAiBI,GAMpCj5B,EAAahd,OAAO61C,IAMvB,GAAoB,iBAAhBG,EAAgC,CAMrC,IAAIH,EACJ,IAAK,MAAMD,KAAQ54B,EAAc,CAC7B,MAAMk5B,EAAWN,EAAK,GACtB,IAAwC,IAApCJ,EAAQU,EAAUZ,GAAwB,CAC1CO,EAAeK,EACf,OAUR,YAHAl5B,EAAahgB,IAAI64C,EAAcE,GAKnC/4B,EAAe+4B,MAEd,KAAIA,EAOL,OANA/4B,EAAes4B,EAQnBrxC,KAAK+Y,aAAeA,EACpB/Y,KAAKqS,gBAAgBrS,KAAK+Y,aAAc/Y,KAAKuV,SAAU,QAE3D,KAAKlB,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAE7FjsB,KAAK+Y,aAAe/Y,KAAKzD,IAAIi1C,QAGjC,OAAOn9B,QAC6B,IAA5BrU,KAAKixC,qBACLjxC,KAAKixC,mBAAmBl+B,0BAA0B/S,MAClDA,KAAKixC,wBAAqB,QAEH,IAAvBjxC,KAAKkxC,eACLlxC,KAAKkxC,cAAc5+B,YAAYtS,MAEjB,OAAdA,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,MAGpB,UAAU5Y,GACDhT,KAAKoS,kBACNpS,KAAKoG,QAAQ0L,UAAU9R,KAAKzD,IAAKyD,MAErCA,KAAKiS,cAAce,GAEvB,YAAYA,GACRhT,KAAKkS,iBAAiBc,GACjBhT,KAAKoS,kBACNpS,KAAKoG,QAAQwD,YAIzB,EAAkB,EAAW,CACzB,eACA,EAAW,oBAAqB,CAAC1T,OAAQmjB,OAAQnjB,OAAQA,OAAQA,UAClE,GClSI,MAAMg8C,EACT,YAAYxmB,EAAWrX,EAAO9X,GAC1ByD,KAAK0rB,UAAYA,EACjB1rB,KAAK+Y,aAAe,GACpB/Y,KAAKuV,SAAW,GAChBvV,KAAKktB,YAAa,EAClBltB,KAAKmyC,UAAY,GACjBnyC,KAAK6c,QAAU,EACf7c,KAAKsvC,YAAa,EAClBtvC,KAAKoyC,UAAW,EAChBpyC,KAAK4rB,KAAO,KACZ5rB,KAAKzD,IAAMA,EACXyD,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,EAAY,UAAEo5B,GAAcnyC,KACpC,IAAI,QAAE6c,GAAY7c,KAClBA,KAAKuV,SAAWwD,EAChB,MAAMs5B,EAAeC,EAAgBv5B,GAOrC,GALIs5B,EAAa/3C,OAAS,GACtB0F,KAAKuyC,yBAAyBF,GAElCryC,KAAK6c,SAAW,EAEA,IAAZA,EACA,OAGJA,GAAW,EACX,IAAK,MAAM9mB,KAAQo8C,EACVj8C,OAAOkB,UAAUC,eAAe1B,KAAKw8C,EAAWp8C,IAASo8C,EAAUp8C,KAAU8mB,GAOlF7c,KAAKzD,IAAIizC,UAAUpZ,OAAOrgC,IAItC,KAAKse,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAGjG,OAAO5X,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,MAGpB,yBAAyB4mB,GACrB,MAAM9d,EAAO10B,KAAKzD,IAClB,IAAK,IAAI/G,EAAI,EAAGkS,EAAK8qC,EAAQl4C,OAAQ9E,EAAIkS,EAAIlS,IAAK,CAC9C,MAAMi9C,EAAYD,EAAQh9C,GACD,IAArBi9C,EAAUn4C,SAGd0F,KAAKmyC,UAAUM,GAAazyC,KAAK6c,QACjC6X,EAAK8a,UAAU5zC,IAAI62C,MAIxB,SAASH,EAAgBp7C,GAC5B,SAASw7C,EAAiBC,GACtB,MAAMC,EAAUD,EAAYE,MAAM,QAClC,OAAgB,OAAZD,EACO,IAASxzC,WAEbwzC,EAEX,GAAsB,iBAAX17C,EACP,OAAOw7C,EAAiBx7C,GAE5B,GAAIA,aAAkBiD,MAAO,CACzB,MAAM0D,EAAM3G,EAAOoD,OACnB,GAAIuD,EAAM,EAAG,CACT,MAAM20C,EAAU,GAChB,IAAK,IAAIh9C,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBg9C,EAAQ3yC,QAAQyyC,EAAgBp7C,EAAO1B,KAE3C,OAAOg9C,EAGP,OAAO,IAASpzC,WAGnB,GAAIlI,aAAkBhB,OAAQ,CAC/B,MAAMs8C,EAAU,GAChB,IAAK,MAAMr7C,KAAYD,EAGfi6B,QAAQj6B,EAAOC,MAEXA,EAASgY,SAAS,KAClBqjC,EAAQ3yC,QAAQ6yC,EAAiBv7C,IAGjCq7C,EAAQ3yC,KAAK1I,IAIzB,OAAOq7C,EAEX,OAAO,IAASpzC,WCzHb,MAAM0zC,EACT,YAAYpnB,EAAWrX,EAAO9X,EAAK/D,GAC/BwH,KAAK0rB,UAAYA,EACjB1rB,KAAKxH,YAAcA,EACnBwH,KAAK+Y,aAAe,KACpB/Y,KAAKuV,SAAW,KAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKzD,IAAMA,EACXyD,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,GAAiB/Y,KACzBA,KAAKuV,SAAWwD,EACI,MAAhBA,EACA/Y,KAAKzD,IAAIw2C,gBAAgB/yC,KAAKxH,aAG9BwH,KAAKzD,IAAI+5B,aAAat2B,KAAKxH,YAAaugB,IAIpD,KAAK1E,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAE7FjsB,KAAK+Y,aAAe/Y,KAAKuV,SAAWvV,KAAKzD,IAAI0zC,aAAajwC,KAAKxH,aAEnE,OAAO6b,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,OCpDjB,MAAMonB,EACT,YAAYtnB,EAAWrX,EAAO9X,EAAK/D,GAC/BwH,KAAK0rB,UAAYA,EACjB1rB,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,GAAiB/Y,KACzBA,KAAKuV,SAAWwD,EAChB/Y,KAAKzD,IAAIyD,KAAKxH,aAAeugB,GAGrC,KAAK1E,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAE7FjsB,KAAK+Y,aAAe/Y,KAAKuV,SAAWvV,KAAKzD,IAAIyD,KAAKxH,aAEtD,OAAO6b,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,OClDjB,SAASqnB,EAAwBjlC,GACpC,OAAQA,EAAMklC,cAAgBllC,EAAMklC,eAAe,IAAQllC,EAAMmlC,UAAYnlC,EAAMmlC,WAAW,IAAQnlC,EAAMolC,MAAQplC,EAAMolC,KAAK,IAAOplC,EAAMlU,OAEhJ,SAASu5C,IACLrzC,KAAKszC,0BACLtzC,KAAKuzC,oBAAqB,EAE9B,SAASC,EAAoBxlC,GACzBA,EAAMulC,oBAAqB,EAC3B,IAAIz5C,EAASm5C,EAAwBjlC,GACrC,MAAMylC,EAAmB,GAIzB,KAAO35C,GAAQ,CACX,GAAIA,EAAO45C,kBAAmB,CAC1B,MAAMl1C,EAAW1E,EAAO45C,kBAAkB1lC,EAAM0zB,MAC5CljC,IACIwP,EAAMqlC,kBAAoBA,IAC1BrlC,EAAMslC,wBAA0BtlC,EAAMqlC,gBACtCrlC,EAAMqlC,gBAAkBA,GAE5BI,EAAiB5zC,KAAKrB,IAG9B1E,EAASA,EAAO65C,WAEpB,IAAK,IAAIn+C,EAAIi+C,EAAiBn5C,OAAS,EAAG9E,GAAK,IAAMwY,EAAMulC,mBAAoB/9C,IAAK,CAChF,MAAMo+C,EAAkBH,EAAiBj+C,GACrC,gBAAiBo+C,EACjBA,EAAgB7lC,YAAYC,GAG5B4lC,EAAgB5lC,IAI5B,SAAS6lC,EAAqB7lC,GAC1BA,EAAMulC,oBAAqB,EAC3B,IAAIz5C,EAASm5C,EAAwBjlC,GACrC,KAAOlU,IAAWkU,EAAMulC,oBAAoB,CACxC,GAAIz5C,EAAOg6C,mBAAoB,CAC3B,MAAMt1C,EAAW1E,EAAOg6C,mBAAmB9lC,EAAM0zB,MAC7CljC,IACIwP,EAAMqlC,kBAAoBA,IAC1BrlC,EAAMslC,wBAA0BtlC,EAAMqlC,gBACtCrlC,EAAMqlC,gBAAkBA,GAExB,gBAAiB70C,EACjBA,EAASuP,YAAYC,GAGrBxP,EAASwP,IAIrBlU,EAASA,EAAO65C,YAGjB,MAAMI,EACT,YAAYvd,EAAKwd,EAAWt5B,EAAUu5B,GAClCj0C,KAAKw2B,IAAMA,EACXx2B,KAAKg0C,UAAYA,EACjBh0C,KAAK0a,SAAWA,EAChB1a,KAAKi0C,QAAUA,EACfj0C,KAAKk8B,MAAQ,EAEjB,YACIl8B,KAAKk8B,QACc,IAAfl8B,KAAKk8B,OACLl8B,KAAKw2B,IAAIxB,iBAAiBh1B,KAAKg0C,UAAWh0C,KAAK0a,SAAU,KAAM1a,KAAKi0C,SAG5E,YACIj0C,KAAKk8B,QACc,IAAfl8B,KAAKk8B,OACLl8B,KAAKw2B,IAAIH,oBAAoBr2B,KAAKg0C,UAAWh0C,KAAK0a,SAAU,KAAM1a,KAAKi0C,SAI/E,UACQj0C,KAAKk8B,MAAQ,IACbl8B,KAAKk8B,MAAQ,EACbl8B,KAAKw2B,IAAIH,oBAAoBr2B,KAAKg0C,UAAWh0C,KAAK0a,SAAU,KAAM1a,KAAKi0C,WAO5E,MAAMC,EACT,YAAYvwB,EAAOnkB,EAAQuvC,EAAavwC,GACpCwB,KAAK2jB,MAAQA,EACb3jB,KAAKR,OAASA,EACdQ,KAAK+uC,YAAcA,EACnBvvC,EAAOuvC,GAAevwC,EAE1B,UACIwB,KAAK2jB,MAAMwwB,YACXn0C,KAAKR,OAAOQ,KAAK+uC,aAAe,MAMjC,MAAMqF,EACT,YAAY5d,EAAK18B,EAAQi1C,EAAavwC,GAClCwB,KAAKw2B,IAAMA,EACXx2B,KAAKlG,OAASA,EACdkG,KAAK+uC,YAAcA,EACnB/uC,KAAKxB,SAAWA,EAChBg4B,EAAIxB,iBAAiB+Z,EAAavwC,EAAU1E,GAEhD,UACIkG,KAAKw2B,IAAIH,oBAAoBr2B,KAAK+uC,YAAa/uC,KAAKxB,SAAUwB,KAAKlG,SAGpE,MAAMu6C,EACT,YAAY7d,EAAK8d,GACbt0C,KAAKw2B,IAAMA,EACXx2B,KAAKs0C,OAASA,EACdt0C,KAAKlG,OAAS,KACdkG,KAAKoG,QAAU,KAEnB,UAAUsuB,EAAM6f,GACZv0C,KAAKlG,OAAS46B,EACd10B,KAAKoG,QAAUmuC,EACf,MAAM34C,EAAMoE,KAAKw2B,IAAIxB,iBACfsf,EAASt0C,KAAKs0C,OACpB,IAAK,IAAI9+C,EAAI,EAAGkS,EAAK4sC,EAAOh6C,OAAQoN,EAAKlS,IAAKA,EAC1CoG,EAAI04C,EAAO9+C,GAAI++C,EAAoB7f,GAG3C,UACI,MAAMA,EAAO10B,KAAKlG,OACZy6C,EAAqBv0C,KAAKoG,QAC1BkuC,EAASt0C,KAAKs0C,OACd9d,EAAMx2B,KAAKw2B,IACjB,IAAK,IAAIhhC,EAAI,EAAGkS,EAAK4sC,EAAOh6C,OAAQoN,EAAKlS,IAAKA,EAC1CghC,EAAIH,oBAAoBie,EAAO9+C,GAAI++C,EAAoB7f,GAE3D10B,KAAKlG,OAASkG,KAAKoG,QAAU,MAG9B,MAAMouC,EAAgB,IAAG1uC,gBAAgB,iBAAiBP,YAAY2E,GAAKA,EAAEjG,UAAU,IAEvF,MAAM,EACT,cACIjE,KAAKy0C,kBAAoB,GACzBz0C,KAAK00C,iBAAmB,GAE5B,iBAAiBle,EAAK18B,EAAQi1C,EAAawF,EAAoB9wC,GAC3D,IAAIgxC,EACAC,EACAC,EACJ,GAAIlxC,IAAa,IAAmBmxC,SAAU,CAC1CH,EAAoBz0C,KAAKy0C,kBACzBE,EAAeF,EAAkB1F,KAAiB0F,EAAkB1F,GAAe,IAAIgF,EAAgBvd,EAAKuY,EAAa8E,GAAsB,IAC/Ic,EAAaE,YACb,MAAMf,EAAqBh6C,EAAOg6C,qBAAuBh6C,EAAOg6C,mBAAqB,IACrF,OAAO,IAAII,EAA8BS,EAAcb,EAAoB/E,EAAawF,GAE5F,GAAI9wC,IAAa,IAAmBqxC,UAAW,CAC3CJ,EAAmB10C,KAAK00C,iBACxBC,EAAeD,EAAiB3F,KAAiB2F,EAAiB3F,GAAe,IAAIgF,EAAgBvd,EAAKuY,EAAayE,GAAqB,IAC5ImB,EAAaE,YACb,MAAMnB,EAAoB55C,EAAO45C,oBAAsB55C,EAAO45C,kBAAoB,IAClF,OAAO,IAAIQ,EAA8BS,EAAcjB,EAAmB3E,EAAawF,GAE3F,OAAO,IAAIH,EAAoB5d,EAAK18B,EAAQi1C,EAAawF,GAE7D,UACI,IAAIx9C,EACJ,MAAM,kBAAE09C,EAAiB,iBAAEC,GAAqB10C,KAChD,IAAKjJ,KAAO09C,EACRA,EAAkB19C,GAAK6S,UAE3B,IAAK7S,KAAO29C,EACRA,EAAiB39C,GAAK6S,WCtLlC,IAAI,EAA0C,SAAU3P,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,EAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAI1G,MAAM+pC,EAAuB,CACzBC,WAAW,EACXC,SAAS,EACTC,eAAe,GAEnB,SAAS,EAAeh2C,EAAGC,GACvB,OAAOD,IAAMC,EAEjB,IAAIg2C,EAAsB,MACtB,YAAYzpB,EAAWrX,EAAO2I,EAAiBwZ,EAAKpwB,EAAS7J,GACzDyD,KAAK0rB,UAAYA,EACjB1rB,KAAKgd,gBAAkBA,EACvBhd,KAAKw2B,IAAMA,EACXx2B,KAAKoG,QAAUA,EACfpG,KAAKzD,IAAMA,EACXyD,KAAK+Y,kBAAe,EACpB/Y,KAAKuV,cAAW,EAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAK2pB,mBAAgB,EACrB3pB,KAAKo1C,kBAAe,EACpBp1C,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,GAAiB/Y,KACzBA,KAAKuV,SAAWwD,EAChB,MAAM3e,EAAUD,MAAMC,QAAQ2e,GAC9B,IAAK3e,GAA2B,MAAhB2e,GAA0B/Y,KAAKzD,IAAI84C,SAC/C,MAAM,IAAI50C,MAAM,gEAEhBT,KAAK2pB,gBACL3pB,KAAK2pB,cAAc5W,0BAA0B/S,MAC7CA,KAAK2pB,mBAAgB,GAErBvvB,IACA4F,KAAK2pB,cAAgB3pB,KAAKgd,gBAAgBgN,iBAAiB3V,EAAO0E,GAClE/Y,KAAK2pB,cAAc7W,sBAAsB9S,OAE7CA,KAAKs1C,qBACLt1C,KAAK2nB,OAAOtT,IAGpB,uBAAuBU,EAAUV,IAChB,KAARA,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKs1C,qBAGLt1C,KAAKsvC,YAAa,EAEO,YAAzBtvC,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OAC/E5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAGpB5rB,KAAKqS,gBAAgBrS,KAAK+Y,aAAc/Y,KAAKuV,SAAUlB,GAE3D,aAAaF,EAAUC,EAAeC,IACrB,KAARA,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKs1C,qBAGLt1C,KAAKsvC,YAAa,EAEO,YAAzBtvC,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OAC/E5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAGpB5rB,KAAKqS,gBAAgB8B,EAAUC,EAAeC,GAElD,OAAOA,GACH,IAAa,KAARA,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1C,OAEJ,MAAM1D,EAAWvV,KAAKuV,SAChBpB,EAAWnU,KAAK+Y,aAClB5E,IAAaoB,GAGjBvV,KAAKqS,gBAAgB8B,EAAUoB,EAAUlB,GAE7C,cAEyBrU,KAAKu1C,oBAEtBv1C,KAAKqS,gBAAgBrS,KAAK+Y,aAAc/Y,KAAKuV,SAAU,QAG/D,mBAAmBR,GACf,MAAM,aAAEgE,EAAY,IAAExc,GAAQyD,KACxB5F,EAAUD,MAAMC,QAAQ2e,GACxBw4B,OAA0B,IAAhBh1C,EAAIg1C,QAAqBh1C,EAAIg1C,QAAU,EACjDlT,EAAU9hC,EAAI8hC,QACpB,IAAI7oC,EAAI6oC,EAAQ/jC,OAChB,KAAO9E,KAAM,GAAG,CACZ,MAAMggD,EAASnX,EAAQ7oC,GACjBigD,EAAcv/C,OAAOkB,UAAUC,eAAe1B,KAAK6/C,EAAQ,SAAWA,EAAOrE,MAAQqE,EAAO/+C,MAC9F2D,EACAo7C,EAAOE,UAA6E,IAAlE38B,EAAa24B,UAAUhyC,KAAU6xC,EAAQkE,EAAa/1C,IAG5E81C,EAAOE,WAAanE,EAAQkE,EAAa18B,IAGjD,mBAgBI,MAAMxc,EAAMyD,KAAKzD,IACX8hC,EAAU9hC,EAAI8hC,QACdxgC,EAAMwgC,EAAQ/jC,OACdye,EAAe/Y,KAAK+Y,aAC1B,IAAIvjB,EAAI,EACR,GAAI+G,EAAI84C,SAAU,CAEd,IAAKl7C,MAAMC,QAAQ2e,GAEf,OAAO,EAIX,IAAIy8B,EACJ,MAAMjE,EAAUh1C,EAAIg1C,SAAW,EAEzB/wC,EAAS,GACf,KAAOhL,EAAIqI,GACP23C,EAASnX,EAAQ7oC,GACbggD,EAAOE,UACPl1C,EAAOX,KAAK3J,OAAOkB,UAAUC,eAAe1B,KAAK6/C,EAAQ,SACnDA,EAAOrE,MACPqE,EAAO/+C,SAEfjB,EAIN,IADAA,EAAI,EACGA,EAAIujB,EAAaze,QAAQ,CAC5B,MAAM4E,EAAI6Z,EAAavjB,IAEyB,IAA5CgL,EAAOkxC,UAAUvyC,KAAOoyC,EAAQryC,EAAGC,IACnC4Z,EAAanH,OAAOpc,EAAG,KAGrBA,EAKV,IADAA,EAAI,EACGA,EAAIgL,EAAOlG,QAAQ,CACtB,MAAM4E,EAAIsB,EAAOhL,IAEqC,IAAlDujB,EAAa24B,UAAUvyC,KAAOoyC,EAAQryC,EAAGC,KACzC4Z,EAAalZ,KAAKX,KAEpB1J,EAGN,OAAO,EAIX,IAAIiB,EAAQ,KACZ,KAAOjB,EAAIqI,GAAK,CACZ,MAAM23C,EAASnX,EAAQ7oC,GACvB,GAAIggD,EAAOE,SAAU,CACjBj/C,EAAQP,OAAOkB,UAAUC,eAAe1B,KAAK6/C,EAAQ,SAC/CA,EAAOrE,MACPqE,EAAO/+C,MACb,QAEFjB,EAON,OAJAwK,KAAKuV,SAAWvV,KAAK+Y,aAErB/Y,KAAK+Y,aAAetiB,GAEb,EAEX,KAAK4d,GACDrU,KAAKo1C,aAAep1C,KAAKw2B,IAAIf,mBAAmBz1B,KAAKzD,IAAKyD,KAAK21C,iBAAkBZ,GACpD,YAAzB/0C,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAGjG,OAAO5X,GACHrU,KAAKo1C,aAAa5E,aAClBxwC,KAAKo1C,aAAe,KACF,OAAdp1C,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,MAEZ5rB,KAAK2pB,gBACL3pB,KAAK2pB,cAAc5W,0BAA0B/S,MAC7CA,KAAK2pB,cAAgB,MAG7B,mBACI3pB,KAAKs1C,qBACgBt1C,KAAKu1C,oBAEtBv1C,KAAK2nB,OAAO,QAGpB,UAAU3U,GACDhT,KAAKoS,kBACNpS,KAAKoG,QAAQ0L,UAAU9R,KAAKzD,IAAKyD,MAErCA,KAAKiS,cAAce,GAEvB,YAAYA,GACRhT,KAAKkS,iBAAiBc,GACjBhT,KAAKoS,kBACNpS,KAAKoG,QAAQwD,YAIzB,EAAW,CACP,IACA,EAAW,cAAehJ,UAC1B,EAAW,oBAAqB,IAChC,EAAW,yBAAqB,IACjCu0C,EAAoB/9C,UAAW,mBAAoB,MACtD+9C,EAAsB,EAAW,CAC7B,eACA,EAAW,oBAAqB,CAACj/C,OAAQmjB,OAAQnjB,OAAQA,OAAQA,OAAQA,UAC1Ei/C,GC/QI,MAAM,EACT,YAAYzpB,EAAWrX,EAAO9X,GAC1ByD,KAAK0rB,UAAYA,EACjB1rB,KAAK+Y,aAAe,GACpB/Y,KAAKuV,SAAW,GAChBvV,KAAK41C,OAAS,GACd51C,KAAK6c,QAAU,EACf7c,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKzD,IAAMA,EACXyD,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAKzD,IAAImzC,MAAMmG,QAE1B,SAAS1hC,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,yBAAyB7S,GACrB,MAAM+8B,EAAc,GACdC,EAAK,kMACX,IAAIpE,EACA57C,EACJ,KAA0C,QAAlC47C,EAAOoE,EAAGC,KAAKj9B,KACnBhjB,EAAO47C,EAAK,GACQ,IAAhB57C,EAAKuE,QAGTw7C,EAAYj2C,KAAK,CAAC9J,EAAM47C,EAAK,KAEjC,OAAOmE,EAEX,yBAAyB/8B,GACrB,IAAItiB,EACJ,MAAMm/C,EAAS,GACf,IAAK,MAAMz+C,KAAY4hB,EACnBtiB,EAAQsiB,EAAa5hB,GACR,MAATV,IAGiB,iBAAVA,EAIXm/C,EAAO/1C,QAAQG,KAAKi2C,eAAex/C,IAH/Bm/C,EAAO/1C,KAAK,CAAC,YAAU1I,GAAWV,KAK1C,OAAOm/C,EAEX,wBAAwB78B,GACpB,MAAMlb,EAAMkb,EAAaze,OACzB,GAAIuD,EAAM,EAAG,CACT,MAAM+3C,EAAS,GACf,IAAK,IAAIpgD,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBogD,EAAO/1C,QAAQG,KAAKi2C,eAAel9B,EAAavjB,KAEpD,OAAOogD,EAEX,OAAO,IAASx2C,WAEpB,eAAe2Z,GACX,MAA4B,iBAAjBA,EACA/Y,KAAKk2C,yBAAyBn9B,GAErCA,aAAwB5e,MACjB6F,KAAKm2C,wBAAwBp9B,GAEpCA,aAAwB7iB,OACjB8J,KAAKo2C,yBAAyBr9B,GAElC,IAAS3Z,WAEpB,aAAaiV,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,GAAiB/Y,KACzBA,KAAKuV,SAAWwD,EAChB,MAAM68B,EAAS51C,KAAK41C,OACpB,IAAIlG,EACA7yB,EAAU7c,KAAK6c,QACnB,MAAMi5B,EAAc91C,KAAKi2C,eAAel9B,GACxC,IAAIs9B,EACAtgD,EACAU,EACJ,MAAMoH,EAAMi4C,EAAYx7C,OACxB,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAAOrI,EACvB6gD,EAAQP,EAAYtgD,GACpBO,EAAOsgD,EAAM,GACb5/C,EAAQ4/C,EAAM,GACdr2C,KAAK2vC,YAAY55C,EAAMU,GACvBm/C,EAAO7/C,GAAQ8mB,EAInB,GAFA7c,KAAK41C,OAASA,EACd51C,KAAK6c,SAAW,EACA,IAAZA,EACA,OAGJ,IAAK6yB,KADL7yB,GAAW,EACG+4B,EACL1/C,OAAOkB,UAAUC,eAAe1B,KAAKigD,EAAQlG,IAAUkG,EAAOlG,KAAW7yB,GAG9E7c,KAAKzD,IAAImzC,MAAMljB,eAAekjB,IAI1C,YAAYA,EAAOj5C,GACf,IAAIg5C,EAAW,GACF,MAATh5C,GAA0C,mBAAlBA,EAAMwS,SAA0BxS,EAAM0Y,SAAS,gBACvEsgC,EAAW,YACXh5C,EAAQA,EAAMm6B,QAAQ,aAAc,KAExC5wB,KAAKzD,IAAImzC,MAAMC,YAAYD,EAAOj5C,EAAOg5C,GAE7C,KAAKp7B,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAE7FjsB,KAAKuV,SAAWvV,KAAK+Y,aAAe/Y,KAAKzD,IAAImzC,MAAMmG,QAEvD,OAAOxhC,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,OCvIjB,MAAM0qB,EAAe,IAAGxwC,gBAAgB,gBAAgBP,YAAY2E,GAAKA,EAAEjG,UAAU,MACxF,uBAAuBywB,EAAMob,GACzB,OAAO,MCHf,IAMI,EAA0C,SAAUp2C,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAO1G,IAAIurC,EAAyB,MACzB,YAAY7qB,EAAWrX,EAAOjO,EAAS7J,EAAK/D,GACxCwH,KAAK0rB,UAAYA,EACjB1rB,KAAKoG,QAAUA,EACfpG,KAAKzD,IAAMA,EACXyD,KAAKxH,YAAcA,EACnBwH,KAAK+Y,aAAe,GACpB/Y,KAAKuV,SAAW,GAChBvV,KAAKsvC,YAAa,EAClBtvC,KAAK4rB,KAAO,KACZ5rB,KAAKiZ,gBAA0B,UAAR5E,EAE3B,WACI,OAAOrU,KAAK+Y,aAEhB,SAAS5E,EAAUE,GACfrU,KAAK+Y,aAAe5E,EACpBnU,KAAKsvC,WAAan7B,IAAanU,KAAKuV,UACvB,KAARlB,GAA+B,GAA8B,YAAzBrU,KAAKiZ,gBAC1CjZ,KAAKuvC,aAAal7B,GAEY,YAAzBrU,KAAKiZ,iBAAmF,OAAdjZ,KAAK4rB,OACpF5rB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,KACvC/rB,KAAKuvC,aAAal7B,GAClBrU,KAAK4rB,KAAO,QAIxB,aAAavX,GACT,GAAIrU,KAAKsvC,WAAY,CACjBtvC,KAAKsvC,YAAa,EAClB,MAAM,aAAEv2B,EAAY,SAAExD,GAAavV,KACnCA,KAAKuV,SAAWwD,EAEZ/Y,KAAKzD,IAAIyD,KAAKxH,aADE,MAAhBugB,EAC6B,GAGAA,EAEK,IAAzB,KAAR1E,IACDrU,KAAKqS,gBAAgB0G,EAAcxD,EAAUlB,IAIzD,cACI,MAAMkB,EAAWvV,KAAKuV,SAAWvV,KAAK+Y,aAChCA,EAAe/Y,KAAK+Y,aAAe/Y,KAAKzD,IAAIyD,KAAKxH,aACnD+c,IAAawD,IACb/Y,KAAKuV,SAAWwD,EAChB/Y,KAAKqS,gBAAgB0G,EAAcxD,EAAU,SAGrD,UAAUvC,GACDhT,KAAKoS,mBACNpS,KAAKoG,QAAQ0L,UAAU9R,KAAKzD,IAAKyD,MACjCA,KAAK+Y,aAAe/Y,KAAKuV,SAAWvV,KAAKzD,IAAIyD,KAAKxH,cAEtDwH,KAAKiS,cAAce,GAEvB,YAAYA,GACRhT,KAAKkS,iBAAiBc,GACjBhT,KAAKoS,kBACNpS,KAAKoG,QAAQwD,UAGrB,KAAKyK,GAC4B,YAAzBrU,KAAKiZ,kBACa,OAAdjZ,KAAK4rB,MACL5rB,KAAK4rB,KAAKM,SAEdlsB,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB,IAAM/rB,KAAKuvC,aAAal7B,GAAQ,CAAE4X,YAAY,KAGjG,OAAO5X,GACe,OAAdrU,KAAK4rB,OACL5rB,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,QAIxB2qB,EA9F8C,SAAUt8C,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA0FvC,CAAW,CAChC,eACA,EAAW,oBAAqB,CAACJ,OAAQmjB,OAAQnjB,OAAQA,OAAQkC,UAClEm+C,GCjGH,IAAI,EAA0C,SAAUt8C,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,EAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtGC,EAAoC,SAAUC,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAe3D,MAGMsrC,EAAU,+BACVC,EAAQ,uCACRC,EAAU,gCAEVC,GAAezgD,OAAOoH,OAAOpH,OAAOY,OAAO,MAAO,CACpD,gBAAiB,CAAC,UAAW0/C,GAC7B,gBAAiB,CAAC,UAAWA,GAC7B,aAAc,CAAC,OAAQA,GACvB,aAAc,CAAC,OAAQA,GACvB,aAAc,CAAC,OAAQA,GACvB,cAAe,CAAC,QAASA,GACzB,aAAc,CAAC,OAAQA,GACvB,WAAY,CAAC,OAAQC,GACrB,YAAa,CAAC,QAASA,GACvB,MAAS,CAAC,QAASC,GACnB,cAAe,CAAC,QAASA,KAEvBE,GAAc,CAAC,SAAU,SACzBC,GAAe,CAAC,UAChBC,GAAgB,CAAC,SAAU,QAAS,OAAQ,QAAS,SACrDC,GAAe,CAAC,UAChBC,GAAgB9gD,OAAOoH,OAAOpH,OAAOY,OAAO,MAAO,CACrD,OAAS,EACT,OAAS,EACT,KAAO,EACP,SAAW,EACX,OAAS,EACT,OAAS,EACT,iBAAiB,EACjB,iBAAiB,EACjB,cAAc,EACd,cAAc,EACd,cAAc,EACd,eAAe,EACf,cAAc,EACd,YAAY,EACZ,aAAa,EACb,OAAS,EACT,eAAe,IAEnB,IAAI,GAAwB,MACxB,YAAY0/B,EAAKygB,GACbj3C,KAAKw2B,IAAMA,EACXx2B,KAAKi3C,YAAcA,EAEvB,gBAAgB5zC,GACZ,OAAO,IAAaY,UAAU,IAAwBjE,MAAMyF,SAASpC,GAEzE,YAAYgR,EAAOqX,EAAW/U,EAAWqG,EAAiBzgB,EAAKwgB,GAC3D,OAAQA,GACJ,IAAK,UACD,OAAO,IAAI,EAAgB2O,EAAWrX,EAAOsC,EAAW,IAAI09B,EAAgBr0C,KAAKw2B,IAAKogB,IAAcr6C,GACxG,IAAK,QACD,MAAoB,WAAhBA,EAAI26C,QACG,IAAI/B,EAAoBzpB,EAAWrX,EAAO2I,EAAiBhd,KAAKw2B,IAAK,IAAI6d,EAAgBr0C,KAAKw2B,IAAKqgB,IAAet6C,GAEtH,IAAIg6C,EAAuB7qB,EAAWrX,EAAO,IAAIggC,EAAgBr0C,KAAKw2B,IAAKogB,IAAcr6C,EAAKwgB,GACzG,IAAK,QACD,OAAO,IAAIw5B,EAAuB7qB,EAAWrX,EAAO,IAAIggC,EAAgBr0C,KAAKw2B,IAAKogB,IAAcr6C,EAAKwgB,GACzG,IAAK,cACL,IAAK,YACD,OAAO,IAAIw5B,EAAuB7qB,EAAWrX,EAAO,IAAIggC,EAAgBr0C,KAAKw2B,IAAKsgB,IAAgBv6C,EAAKwgB,GAC3G,IAAK,YACL,IAAK,aACD,OAAO,IAAIw5B,EAAuB7qB,EAAWrX,EAAO,IAAIggC,EAAgBr0C,KAAKw2B,IAAKugB,IAAex6C,EAAKwgB,GAC1G,IAAK,QACD,OAAO,IAAIm1B,EAAuBxmB,EAAWrX,EAAO9X,GACxD,IAAK,QACL,IAAK,MACD,OAAO,IAAI,EAAuBmvB,EAAWrX,EAAO9X,GACxD,IAAK,QACD,OAAO,IAAI,KAAeoa,EAAWtC,EAAO9X,EAAKwgB,GACrD,IAAK,OACD,OAAO,IAAI+1B,EAAsBpnB,EAAWrX,EAAO9X,EAAKwgB,GAC5D,QACI,QAAmC5X,IAA/BwxC,GAAa55B,GAA6B,CAC1C,MAAMo6B,EAAUR,GAAa55B,GAC7B,OAAO,IAAI4zB,EAAoBjlB,EAAWrX,EAAO9X,EAAK46C,EAAQ,GAAIA,EAAQ,IAE9E,GAAIC,GAAgB76C,EAAKwgB,EAAc/c,KAAKi3C,aACxC,OAAO,IAAInE,EAAsBpnB,EAAWrX,EAAO9X,EAAKwgB,GAGpE,OAAO,KAEX,kBAAkB1I,EAAO9X,EAAKwgB,GAC1B,OAAuC,IAAhCi6B,GAAcj6B,GAMzB,QAAQ1I,EAAO9X,GACX,OAAOyD,KAAKw2B,IAAIR,eAAez5B,KAGvC,GAAwB,EAAW,CAC/B0O,EAAQ,EAAG,KACXA,EAAQ,EAAGqrC,GACX,EAAW,oBAAqB,CAACpgD,OAAQA,UAC1C,IAEH,IAAI,GAAwB,MACxB,YAAYsgC,EAAKygB,GACbj3C,KAAKw2B,IAAMA,EACXx2B,KAAKi3C,YAAcA,EAEvB,gBAAgB5zC,GACZ,OAAO,IAAaY,UAAU,IAAwBjE,MAAMyF,SAASpC,GAEzE,YAAYgR,EAAOqX,EAAW/U,EAAWpa,EAAKwgB,GAC1C,OAAQA,GACJ,IAAK,cAED,OAAO,IAAIi2B,EAAwBtnB,EAAWrX,EAAO9X,EAAKwgB,GAC9D,IAAK,QACD,OAAO,IAAIm1B,EAAuBxmB,EAAWrX,EAAO9X,GACxD,IAAK,QACL,IAAK,MACD,OAAO,IAAI,EAAuBmvB,EAAWrX,EAAO9X,GAGxD,IAAK,MACL,IAAK,OAEL,IAAK,OACD,OAAO,IAAIu2C,EAAsBpnB,EAAWrX,EAAO9X,EAAKwgB,GAC5D,QACI,QAAmC5X,IAA/BwxC,GAAa55B,GAA6B,CAC1C,MAAMo6B,EAAUR,GAAa55B,GAC7B,OAAO,IAAI4zB,EAAoBjlB,EAAWrX,EAAO9X,EAAK46C,EAAQ,GAAIA,EAAQ,IAE9E,OAAIC,GAAgB76C,EAAKwgB,EAAc/c,KAAKi3C,aACjC,IAAInE,EAAsBpnB,EAAWrX,EAAO9X,EAAKwgB,GAErD,IAAIi2B,EAAwBtnB,EAAWrX,EAAO9X,EAAKwgB,IAGtE,QAAQ1I,EAAO9X,GACX,OAAOyD,KAAKw2B,IAAIR,eAAez5B,KAGvC,GAAwB,EAAW,CAC/B0O,EAAQ,EAAG,KACXA,EAAQ,EAAGqrC,GACX,EAAW,oBAAqB,CAACpgD,OAAQA,UAC1C,IAEH,MAAMmhD,GAAkB,GACxB,SAASD,GAAgB76C,EAAKwgB,EAAck6B,GACxC,IAAsC,IAAlCI,GAAgBt6B,GAChB,OAAO,EAEX,MAAMu6B,EAASv6B,EAAare,MAAM,EAAG,GAGrC,OAAO24C,GAAgBt6B,GACR,UAAXu6B,GACe,UAAXA,GACAL,EAAYM,uBAAuBh7C,EAAKwgB,GCnLpD,IAAI,GAAsB,MACtB,KAAK1I,EAAO5G,EAAOuQ,GACfA,EAAQ8R,eAAiB,IAAIgjB,EAAsB90B,EAAQG,QAAQ9nB,IAAI,KAAage,EAAO2J,EAAQlkB,OAAQkkB,EAAQ6R,gBAEvH,OAAOxb,EAAO5G,EAAOuQ,MCFlB,SAASw5B,GAAgBxpC,GAC5B,MAAMlU,EAASm5C,EAAwBjlC,GACvC,GAAIhO,KAAKlG,SAAWA,EAGpB,OAAOkG,KAAKy3C,oBAAoBzpC,GDCpC,GAhB8C,SAAU/T,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAY1C,CAAW,CAC7B,aAAgB,SACjB,ICDH,IAAI,GAAsB,MACtB,KAAK+d,EAAO5G,EAAOuQ,GACf,IAAKA,EAAQQ,aAAeR,EAAQ+wB,YAChC,MAAM,IAASptC,MAAM,GAEzBqc,EAAQy5B,oBAAsBz5B,EAAQQ,WACtCR,EAAQQ,WAAag5B,GAEzB,OAAOnjC,EAAO5G,EAAOuQ,GACjBA,EAAQQ,WAAaR,EAAQy5B,oBAC7Bz5B,EAAQy5B,oBAAsB,OAGtC,GA9B8C,SAAUx9C,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA0B1C,CAAW,CAC7B,aAAgB,SACjB,IChCH,IAMI,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAK3D,IAAI,GAA+B,MAC/B,YAAY8R,GACRhd,KAAKgd,gBAAkBA,EAE3B,KAAK3I,EAAO5G,EAAOuQ,KAAYs2B,GAC3B,GAAsB,IAAlBA,EAAOh6C,OACP,MAAM,IAASqH,MAAM,GAEzB,GAAIqc,EAAQrnB,OAAS,IAAYs7B,QAAUjU,EAAQrnB,OAAS,IAAYmpB,SACpE,MAAM,IAASne,MAAM,IAEzB3B,KAAKiZ,gBAA0B,WAAR5E,EAEvB,MAAMyb,EAAiB9vB,KAAKgd,gBAAgBC,YAAYjd,KAAKiZ,gBAAkB5E,EAAO2J,EAAQlkB,OAAQkkB,EAAQ6R,gBAC9G,IAAKC,EAAe1pB,QAChB,MAAM,IAASzE,MAAM,IAEzBqc,EAAQ8R,eAAiBA,EAEzBA,EAAe4nB,gBAAkB15B,EAAQ8R,eAAe1pB,QAExD0pB,EAAe1pB,QAAU,IAAIiuC,EAAgBr2B,EAAQG,QAAQ9nB,IAAI,KAAOi+C,GAE5E,OAAOjgC,EAAO5G,EAAOuQ,GAEjBA,EAAQ8R,eAAe1pB,QAAQwD,UAC/BoU,EAAQ8R,eAAe1pB,QAAU4X,EAAQ8R,eAAe4nB,gBACxD15B,EAAQ8R,eAAe4nB,gBAAkB,OAGjD,GA7C8C,SAAUz9C,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAyCjC,CAAW,CACtC,aAAgB,iBAChB,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAACJ,UAClC,IChDI,MAAMyhD,GAAsBzhD,OAAOyV,OAAO,CAC7CisC,QAAS,IAAS5qB,OAET6qB,GAAmB,IAAG/xC,gBAAgB,oBAAoBR,YAC1DwyC,GAAyB,IAAGhyC,gBAAgB,0BACpDP,YAAY2E,GAAKA,EAAEzD,SAASkxC,KAC1B,MAAMI,GACT,YAAYvhB,EAAKwhB,EAAaC,EAAiBC,EAAe,MAC1Dl4C,KAAKk4C,aAAeA,EACpBl4C,KAAKm4C,YAAcH,EAAY7/C,IAAI+R,IAC/B,IAAIkuC,EAYJ,OAXIluC,aAAassB,EAAI6hB,cACjBD,EAAQluC,GAGRkuC,EAAQH,EAAgB5hD,IAAI6T,GACvBkuC,IACDA,EAAQ,IAAI5hB,EAAI6hB,cAChBD,EAAME,YAAYpuC,GAClB+tC,EAAgBl/C,IAAImR,EAAGkuC,KAGxBA,IAGf,iBAAiB5hB,GACb,MAAO,uBAAwBA,EAAI+hB,WAAWnhD,UAElD,QAAQohD,GACsB,OAAtBx4C,KAAKk4C,cACLl4C,KAAKk4C,aAAaN,QAAQY,GAI9BA,EAAWC,mBAAqB,IACzBD,EAAWC,sBACXz4C,KAAKm4C,cAIb,MAAMO,GACT,YAAYliB,EAAKwhB,EAAaE,EAAe,MACzCl4C,KAAKw2B,IAAMA,EACXx2B,KAAKg4C,YAAcA,EACnBh4C,KAAKk4C,aAAeA,EAExB,QAAQM,GACJ,MAAM5C,EAAS51C,KAAKg4C,YACdxhB,EAAMx2B,KAAKw2B,IACjB,IAAK,IAAIhhC,EAAIogD,EAAOt7C,OAAS,EAAG9E,GAAK,IAAKA,EAAG,CACzC,MAAMqyB,EAAU2O,EAAIlB,cAAc,SAClCzN,EAAQ8wB,UAAY/C,EAAOpgD,GAC3BgjD,EAAWI,QAAQ/wB,GAEG,OAAtB7nB,KAAKk4C,cACLl4C,KAAKk4C,aAAaN,QAAQY,ICrDtC,MAAMK,GAAuB,CACzBliD,KAAM,QAmBV,MAAM,GAAuB,CAAEq+C,WAAW,GAEnC,MAAM,GACT,YAAYxe,EAEZQ,EAAauK,EAAM31B,GAIf,IAAI8zB,EAHJ1/B,KAAKw2B,IAAMA,EACXx2B,KAAKg3B,YAAcA,EACnBh3B,KAAKuhC,KAAOA,EAIR7B,EAFA9zB,EAAW8zB,yBAAyBxpC,QACpC,SAAU0V,EAAW8zB,cACL9zB,EAAW8zB,cAGXmZ,GAEpB74C,KAAKw4C,WAAajX,EAAKuX,aAAapZ,GACpC,IAASxjC,OAAO,IAAcnG,KAAMihC,EAAah3B,KAAKuhC,MACtD,IAASrlC,OAAO,IAAcnG,KAAMihC,EAAah3B,KAAKw4C,YAE1D,eACI,OAAOx4C,KAAKuhC,KAAKwX,WAErB,0BAA0Bv6C,EAAU6/B,EAAU,IAE1Cr+B,KAAKw2B,IAAIf,mBAAmBz1B,KAAKuhC,KAAM/iC,EAAU6/B,GAErD,6BACI,OAAOr+B,KAAKw4C,WAEhB,QAAQlc,GACJ,MAAMt9B,EAAUgB,KAAKg3B,YAAYh4B,SAClBA,EAAQ7F,IAAI0+C,IAAkB,GACvC74C,EAAQ3I,IAAIwhD,IACZ74C,EAAQ3I,IAAIyhD,KACXF,QAAQ53C,KAAKw4C,YACpBlc,EAAM93B,SAASxE,KAAKw4C,YAExB,KAAKlc,GACDA,EAAMlG,SACNkG,EAAMC,UAIP,MAAM,GACT,YAAY/F,EAAKQ,EAAauK,GACtBA,EAAKwX,WAAWz+C,OAChB0F,KAAK+4C,WAAa,YAAQxX,EAAKwX,YAG/B/4C,KAAK+4C,WAAa,IAAS35C,WAE/BY,KAAKuhC,KAAO/K,EAAIrB,wBAAwBoM,GACxC,IAASrlC,OAAO,IAAcnG,KAAMihC,EAAah3B,KAAKuhC,MAE1D,eACI,OAAOvhC,KAAK+4C,WAEhB,0BAA0Bv6C,IAI1B,6BACI,OAAOwB,KAAKuhC,KAAKyX,cAErB,QAAQ1c,GACJA,EAAMxG,aAAa91B,KAAKuhC,MAE5B,KAAKjF,GACDA,EAAMlG,SACNkG,EAAMC,UAIP,MAAM,GACT,YAAYvF,EAAauK,GACrBvhC,KAAKuhC,KAAOA,EACZ,IAASrlC,OAAO,IAAcnG,KAAMihC,EAAauK,GAErD,eACI,OAAOvhC,KAAKuhC,KAAKwX,WAErB,0BAA0Bv6C,IAG1B,6BACI,OAAOwB,KAAKuhC,KAAKyX,cAErB,QAAQ1c,GACJA,EAAM93B,SAASxE,KAAKuhC,MAExB,KAAKjF,GACDA,EAAMlG,SACNkG,EAAMC,UClHP,IAAI0c,IACX,SAAWA,GACPA,EAASA,EAAkB,QAAI,GAAK,UACpCA,EAASA,EAAe,KAAI,GAAK,OACjCA,EAASA,EAAe,KAAI,GAAK,OACjCA,EAASA,EAAuB,aAAI,GAAK,eACzCA,EAASA,EAA0B,gBAAI,GAAK,kBAC5CA,EAASA,EAAiB,OAAI,GAAK,SACnCA,EAASA,EAAgC,sBAAI,GAAK,wBAClDA,EAASA,EAAkB,QAAI,GAAK,UACpCA,EAASA,EAAmB,SAAI,GAAK,WACrCA,EAASA,EAAuB,aAAI,IAAM,eAC1CA,EAASA,EAA2B,iBAAI,IAAM,mBAC9CA,EAASA,EAAmB,SAAI,IAAM,WAZ1C,CAaGA,KAAaA,GAAW,KAC3B,MAAMC,GAA+B,IAAIvhD,QAIlC,MAAM,GACT,YAAYwhD,EAAQC,EAAUC,EAAOC,EAAUC,EAAcC,EAAcC,EAAgBC,GACvF15C,KAAKm5C,OAASA,EACdn5C,KAAKo5C,SAAWA,EAChBp5C,KAAK25C,KAAON,EACZr5C,KAAK45C,QAAUN,EACft5C,KAAK65C,YAAcN,EACnBv5C,KAAK85C,YAAcN,EACnBx5C,KAAKq4C,cAAgBoB,EACrBz5C,KAAKu4C,WAAamB,EACd,IAAIjjB,gBACJ,IAASvuB,MAAM,MACf,IAAI6xC,WAER,IAAIxO,WAAWvrC,MACfA,KAAKg6C,WAAa,IAAIC,GAAqBj6C,KAAMo5C,EAAShkB,0BAE9D,gBAAgB/xB,GACZ,OAAO,IAAagH,QAAQ,IAAMrK,MAAMyF,SAASpC,GAErD,iBAAiB2wC,EAAWhhC,EAAYknC,EAAW7b,IAC9C6b,GAAal6C,KAAKo5C,UAAUpkB,iBAAiBgf,EAAWhhC,EAAYqrB,GAEzE,YAAYtjC,EAAQo/C,GAChBp/C,EAAOk6B,YAAYklB,GAEvB,UAAUzlB,EAAM0lB,GACZ,OAAO1lB,EAAKQ,WAAmB,IAATklB,GAE1B,wBAAwB1lB,GACpB,GAAI10B,KAAKi2B,iBAAiBvB,GACtB,OAAOA,EAEX,GAAuB,MAAnBA,EAAKif,WACL,MAAM,IAAShyC,MAAM,IAEzB,MAAM04C,EAAcr6C,KAAKo5C,SAASkB,cAAc,UAC1CC,EAAgBv6C,KAAKo5C,SAASkB,cAAc,YAKlD,OAJA5lB,EAAKif,WAAW6G,aAAaH,EAAa3lB,GAC1C2lB,EAAY1G,WAAW7d,aAAaykB,EAAeF,GACnDA,EAAYI,OAASF,EACrBA,EAAcG,OAAS,KAChBL,EAEX,uBAAuBM,GACnB,GAAoB,MAAhBA,EACA,OAAO36C,KAAKo5C,SAAShkB,yBAEzB,GAAIp1B,KAAKg2B,eAAe2kB,GAAe,CACnC,QAA6Bx1C,IAAzBw1C,EAAaC,QACb,OAAOD,EAAaC,QAExB,MAAMpW,EAAWxkC,KAAKo5C,SAAShkB,yBAE/B,OADAoP,EAASvP,YAAY0lB,GACdnW,EAEX,OAAOxkC,KAAK01B,eAAeilB,GAAcC,QAE7C,mBAAmBpW,GACf,OAAiB,OAAbA,EACOxkC,KAAKg6C,WAET,IAAIC,GAAqBj6C,KAAMwkC,EAAStP,WAAU,IAE7D,cAAcn/B,GACV,OAAOiK,KAAKo5C,SAAS9jB,cAAcv/B,GAEvC,MAAM4H,EAAOk9C,GACT,OAAO76C,KAAKm5C,OAAO2B,MAAMn9C,EAAOk9C,GAGpC,kBAAkBE,EAAW1c,GACzB,OAAO,IAAIr+B,KAAK85C,YAAYiB,EAAW1c,GAE3C,cAAc2c,GACVh7C,KAAKo5C,SAAS5jB,cAAcwlB,GAEhC,mBAAmBtmB,EAAM92B,EAAIi9C,GACzB,GAAgC,oBAArBI,iBAEP,MAAO,CACH,eACA,YACAC,YAAW,IAAY,IAAS97C,YAGxC,MAAMud,EAAW,IAAIs+B,iBAAiBr9C,GAEtC,OADA+e,EAAS8K,QAAQiN,EAAMmmB,GAChBl+B,EAEX,eAAew+B,GACX,GAAc,MAAVA,EACA,OAAOn7C,KAAKo5C,SAAS9jB,cAAc,YAEvC,MAAM6J,EAAWn/B,KAAKo5C,SAAS9jB,cAAc,YAE7C,OADA6J,EAASwZ,UAAYwC,EAAO7iD,WACrB6mC,EAEX,eAAeic,GACX,OAAOp7C,KAAKo5C,SAASzjB,eAAeylB,GAexC,uBAAuB1mB,GAGnB,GAAIwkB,GAA6B//C,IAAIu7B,GACjC,OAAOwkB,GAA6B7iD,IAAIq+B,GAK5C,IAAI2mB,EAAsB,EACtBjkC,EAAOsd,EAAK4mB,YAChB,KAAgB,OAATlkC,GAAe,CAClB,GAAsB,IAAlBA,EAAKmkC,SACL,OAAQnkC,EAAKokC,aACT,IAAK,aAGCH,EACF,MACJ,IAAK,SACD,GAA8B,GAA1BA,IACA,OAAOjkC,EAIvBA,EAAOA,EAAKkkC,YAEhB,GAAwB,OAApB5mB,EAAKif,YAAyC,KAAlBjf,EAAK6mB,SAAwC,CAEzE,MAAMtkC,EAAa,IAAcwd,IAAIC,GACrC,QAAmB,IAAfzd,EAGA,OAAO,KAEX,MAAM2nB,EAAY3nB,EAAW2nB,UAC7B,GAAIA,aAAqB,GAErB,OAAO5+B,KAAK41B,uBAAuBgJ,EAAU2C,MAGrD,OAAO7M,EAAKif,WAEhB,uBAAuB8H,EAAyB9H,GAC5C,GAAI3zC,KAAKg2B,eAAeylB,GACpBvC,GAA6BngD,IAAI0iD,EAAyB9H,OAEzD,CACD,MAAMrX,EAAQmf,EAAwB1C,WACtC,IAAK,IAAIvjD,EAAI,EAAGkS,EAAK40B,EAAMhiC,OAAQ9E,EAAIkS,IAAMlS,EACzC0jD,GAA6BngD,IAAIujC,EAAM9mC,GAAIm+C,IAIvD,aAAa+H,EAAcC,GACvBA,EAAchI,WAAW7d,aAAa4lB,EAAcC,GAExD,SAASjnB,GACL,MAAyB,SAAlBA,EAAKknB,SAEhB,eAAeC,GACX,OAAwB,MAAjBA,GAAyBA,EAAcN,SAAW,EAE7D,iBAAiB7mB,GACb,MAA4B,WAArBA,EAAK8mB,YAEhB,WAAW9mB,GACPA,EAAK+d,UAAY,KAErB,wBAAwBpvC,EAAW4C,GAC/B5C,EAAUC,iBAAiB,IAAO2C,GAClC5C,EAAUC,iBAAiBtD,KAAK25C,KAAM1zC,GACtC5C,EAAUC,iBAAiBtD,KAAK45C,QAAS3zC,GACzC5C,EAAUC,iBAAiBtD,KAAK65C,YAAa5zC,GAEjD,OAAOyuB,GACCA,EAAK0B,OACL1B,EAAK0B,SAGL1B,EAAKif,WAAWmI,YAAYpnB,GAGpC,oBAAoBsf,EAAWhhC,EAAYknC,EAAW7b,IACjD6b,GAAal6C,KAAKo5C,UAAU/iB,oBAAoB2d,EAAWhhC,EAAYqrB,GAE5E,aAAa3J,EAAM3+B,EAAMU,GACrBi+B,EAAK4B,aAAavgC,EAAMU,IAGhC,MAAMslD,GAAO,IAaN,MAAM9B,GACT,YAAYzjB,EAAKgO,GACbxkC,KAAKw2B,IAAMA,EACXx2B,KAAKwkC,SAAWA,EAChBxkC,KAAKg8C,WAAY,EACjBh8C,KAAKi8C,UAAW,EAChBj8C,KAAKoX,UAAO,EACZpX,KAAKk8C,aAAU,EACf,MAAMC,EAAiB3X,EAAS4X,iBAAiB,OACjD,IAAI5mD,EAAI,EACJkS,EAAKy0C,EAAe7hD,OACxB,MAAMgnC,EAAUthC,KAAKshC,QAAUnnC,MAAMuN,GACrC,KAAOlS,EAAIkS,GAAI,CAIX,MAAM5N,EAASqiD,EAAe3mD,GACN,SAApBsE,EAAO8hD,SAGPta,EAAQ9rC,GAAKwK,KAAKw2B,IAAIrB,wBAAwBr7B,GAI9CwnC,EAAQ9rC,GAAKsE,IAEftE,EAEN,MAAM6mD,EAAgB7X,EAASuU,WAC/BvjD,EAAI,EACJkS,EAAK20C,EAAc/hD,OACnB,MAAMy+C,EAAa/4C,KAAK+4C,WAAa5+C,MAAMuN,GAC3C,KAAOlS,EAAIkS,GACPqxC,EAAWvjD,GAAK6mD,EAAc7mD,KAC5BA,EAENwK,KAAKs8C,WAAa9X,EAAS8X,WAC3Bt8C,KAAKu8C,UAAY/X,EAAS+X,UAE9B,cACI,OAAOv8C,KAAKshC,QAEhB,aAAa4a,GACT,GAAIl8C,KAAKi8C,UAAcj8C,KAAKk8C,QACxBl8C,KAAKw8C,kBAEJ,CACD,MAAMzhD,EAASmhD,EAAQvI,WACvB,GAAI3zC,KAAKg8C,UAAW,CAChB,IAAIpzC,EAAU5I,KAAKs8C,WACnB,MAAMtlC,EAAMhX,KAAKu8C,UACjB,IAAInlC,EACJ,KAAkB,MAAXxO,IACHwO,EAAOxO,EAAQ0yC,YACfvgD,EAAO+6B,aAAaltB,EAASszC,GACzBtzC,IAAYoO,IAGhBpO,EAAUwO,OAIdpX,KAAKg8C,WAAY,EACjBE,EAAQvI,WAAW7d,aAAa91B,KAAKwkC,SAAU0X,IAI3D,SAASnhD,GACL,GAAIiF,KAAKg8C,UAAW,CAChB,IAAIpzC,EAAU5I,KAAKs8C,WACnB,MAAMtlC,EAAMhX,KAAKu8C,UACjB,IAAInlC,EACJ,KAAkB,MAAXxO,IACHwO,EAAOxO,EAAQ0yC,YACfvgD,EAAOk6B,YAAYrsB,GACfA,IAAYoO,IAGhBpO,EAAUwO,OAIdpX,KAAKg8C,WAAY,EACjBjhD,EAAOk6B,YAAYj1B,KAAKwkC,UAGhC,SACI,GAAIxkC,KAAKg8C,UAAW,CAChBh8C,KAAKg8C,WAAY,EACjB,MAAMxX,EAAWxkC,KAAKwkC,SAChBxtB,EAAMhX,KAAKu8C,UACjB,IAAInlC,EACAxO,EAAU5I,KAAKs8C,WACnB,KAAmB,OAAZ1zC,IACHwO,EAAOxO,EAAQ0yC,YACf9W,EAASvP,YAAYrsB,GACjBA,IAAYoO,IAGhBpO,EAAUwO,GAItB,cACI,MAAM8kC,EAAUl8C,KAAKk8C,QACfnhD,EAASmhD,EAAQvI,WACvB,GAAI3zC,KAAKg8C,UAAW,CAChB,IAAIpzC,EAAU5I,KAAKs8C,WACnB,MAAMtlC,EAAMhX,KAAKu8C,UACjB,IAAInlC,EACJ,KAAkB,MAAXxO,IACHwO,EAAOxO,EAAQ0yC,YACfvgD,EAAO+6B,aAAaltB,EAASszC,GACzBtzC,IAAYoO,IAGhBpO,EAAUwO,OAIdpX,KAAKg8C,WAAY,EACjBjhD,EAAO+6B,aAAa91B,KAAKwkC,SAAU0X,GAG3C,SACIl8C,KAAKi8C,UAAW,EAChBj8C,KAAKoX,UAAO,EACZpX,KAAKk8C,aAAU,EAEnB,KAAK9kC,GACDpX,KAAKi8C,UAAW,EACZj8C,KAAKw2B,IAAIP,iBAAiB7e,GAC1BpX,KAAKk8C,QAAU9kC,GAGfpX,KAAKoX,KAAOA,EACZpX,KAAKy8C,iBAGb,qBACsB,IAAdz8C,KAAKoX,KACLpX,KAAKk8C,QAAUl8C,KAAKoX,KAAKklC,WAGzBt8C,KAAKk8C,aAAU,GAe3B,IAACr7C,OAVM,MACH,YAAYy6C,GACRt7C,KAAKs7C,YAAcA,EACnBt7C,KAAKw7C,YAAc,GAEvB,iBACI,OAAOx7C,KAAKs7C,YAAY3H,WAE5B,YAOQv8C,WAJFslD,gBAAkB,KACxB77C,GAAMk4C,WAAa,IAAS35C,WAC5ByB,GAAM+6C,SAAW,OACjB/6C,GAAM06C,SAAW,EClZrB,IAAI,GAA0C,SAAUthD,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAK3D,MAAM8mC,GAAQz7C,SAERomD,GAA0B,CAC5BC,SAAS,EACT3I,SAAS,GAGP4I,GAAyB,CAC3BD,SAAS,GAIPE,GAAa,IAAInlD,QAChB,MAAMolD,GACT,YAAYvmB,EAAK9K,GACb1rB,KAAKw2B,IAAMA,EACXx2B,KAAK0rB,UAAYA,EACjB1rB,KAAKg9C,MAAQ,GACbF,GAAW/jD,IAAIy9B,EAAI4iB,SAAUp5C,MAC7BA,KAAKoG,QAAU62C,GAAcj9C,KAAMA,KAAKg9C,OAE5C,iBAAiBxmB,EAAK9K,GAClB,OAAOoxB,GAAWzmD,IAAImgC,EAAI4iB,WAAa,IAAI2D,GAAYvmB,EAAK9K,GAEhE,SAASwxB,GACL,MAAMF,EAAQh9C,KAAKg9C,MACdA,EAAM7tC,SAAS+tC,IAA8B,IAArBF,EAAMn9C,KAAKq9C,IACpCl9C,KAAKm9C,eAGb,WAAWD,GACP,MAAMF,EAAQh9C,KAAKg9C,MACb93C,EAAQ83C,EAAM/zC,QAAQi0C,GACxBh4C,GAAS,GACT83C,EAAMprC,OAAO1M,EAAO,GAEH,IAAjB83C,EAAM1iD,QACN0F,KAAKo9C,kBAGb,eACI,MAAM5mB,EAAMx2B,KAAKw2B,IACX6mB,EAAM7mB,EAAI4iB,SACVkE,EAAM9mB,EAAI2iB,OACV/yC,EAAUpG,KAAKoG,QACjBk3C,EAAIC,UAAUC,gBACdH,EAAIroB,iBAAiB,cAAe5uB,EAASu2C,IAEjDU,EAAIroB,iBAAiB,aAAc5uB,EAASu2C,IAC5CU,EAAIroB,iBAAiB,YAAa5uB,EAASu2C,IAC3CU,EAAIroB,iBAAiB,QAAS5uB,EAASu2C,IACvCW,EAAItoB,iBAAiB,OAAQ5uB,EAASy2C,IAE1C,kBACI,MAAMrmB,EAAMx2B,KAAKw2B,IACX6mB,EAAM7mB,EAAI4iB,SACVkE,EAAM9mB,EAAI2iB,OACV/yC,EAAUpG,KAAKoG,QACjBk3C,EAAIC,UAAUC,gBACdH,EAAIhnB,oBAAoB,cAAejwB,EAASu2C,IAEpDU,EAAIhnB,oBAAoB,aAAcjwB,EAASu2C,IAC/CU,EAAIhnB,oBAAoB,YAAajwB,EAASu2C,IAC9CU,EAAIhnB,oBAAoB,QAASjwB,EAASu2C,IAC1CW,EAAIjnB,oBAAoB,OAAQjwB,EAASy2C,KAGjD,IAAI,GAAO,MACP,YAAYh1B,EAAS2O,EAAK9K,GACtB1rB,KAAKw2B,IAAMA,EACXx2B,KAAK6nB,QAAUA,EAOf7nB,KAAKy9C,gBAAiB,EACtBz9C,KAAK09C,eAAgB,EACrB19C,KAAK29C,eAAiB,KACtB39C,KAAKvJ,MAAQu7C,GACbhyC,KAAK49C,QAAUb,GAAYc,UAAUrnB,EAAK9K,GAE9C,cACI1rB,KAAK49C,QAAQn4C,SAASzF,MAE1B,eACIA,KAAK49C,QAAQE,WAAW99C,MAE5B,kBAAkBlG,GACd,IAAmB,IAAfkG,KAAKvJ,MACL,OAEJ,MAAM+/B,EAAMx2B,KAAKw2B,IACb18B,IAAW08B,EAAI2iB,QAAUr/C,IAAW08B,EAAI4iB,UAAap5C,KAAK+vC,SAASj2C,IACnEkG,KAAK+9C,cAGb,SAASjkD,GACL,IAAKkG,KAAKvJ,MACN,OAAO,EAEX,IAAIunD,EACAxoD,EACA8K,EAAGuI,EACHy0B,EACJ,MAAMzV,EAAU7nB,KAAK6nB,QACrB,GAAIo2B,GAA4Bp2B,EAAS/tB,GACrC,OAAO,EAEX,IAAKkG,KAAKk+C,WACN,OAAO,EAEX,MAAMb,EAAMr9C,KAAKw2B,IAAI4iB,SACf8E,EAAal+C,KAAKk+C,WAClBP,EAAiB39C,KAAK29C,eACtBD,EAAgB19C,KAAK09C,cACrBD,EAAiBz9C,KAAKy9C,eACtBU,EAAQhkD,MAAMC,QAAQ8jD,GAAcA,EAAa,CAACA,GAClDE,GAAyC,iBAAnBT,EACtBN,EAAIgB,cAAcV,GAClBA,IACCN,EAAIiB,KACL52C,EAAKy2C,EAAM7jD,OACjB,IAAK9E,EAAI,EAAGkS,EAAKlS,IAAKA,EAIlB,GAHA8nC,EAAO6gB,EAAM3oD,GAGO,iBAAT8nC,GAEP,GAAIogB,EAAe,CAEf,GAAKD,EAKDO,EAAMI,EAAYhC,iBAAiB9e,OALlB,CACjB,MAAMihB,EAAKH,EAAYC,cAAc/gB,GACrC0gB,EAAa,OAAPO,EAAc,CAACA,GAAM,IAASn/C,WAMxC,IADAyJ,EAAKm1C,EAAI1jD,OACJgG,EAAI,EAAGuI,EAAKvI,IAAKA,EAClB,GAAI09C,EAAI19C,GAAGyvC,SAASj2C,GAChB,OAAO,OAUf,IAFAkkD,EAAMI,EAAY1f,SAClB71B,EAAKm1C,EAAI1jD,OACJgG,EAAI,EAAGuI,EAAKvI,IAAKA,EAClB,GAAI09C,EAAI19C,GAAGsyC,QAAQtV,GACf,OAAO,OAUnB,GAAIA,GAAQA,EAAKyS,SAASj2C,GACtB,OAAO,EAInB,OAAO,EAEX,cACIkG,KAAKvJ,OAAQ,EACc,mBAAhBuJ,KAAKw+C,QACZx+C,KAAKw+C,OAAO7oD,KAAK,QAI7B,GAAW,CACP,eACA,GAAW,cAAeO,SAC3B,GAAKkB,UAAW,aAAS,GAC5B,GAAW,CACP,eACA,GAAW,cAAewJ,WAC3B,GAAKxJ,UAAW,cAAU,GAC7B,GAAW,CACP,eACA,GAAW,cAAelB,SAC3B,GAAKkB,UAAW,kBAAc,GACjC,GAAW,CACP,eACA,GAAW,cAAe+5B,UAC3B,GAAK/5B,UAAW,sBAAkB,GACrC,GAAW,CACP,eACA,GAAW,cAAe+5B,UAC3B,GAAK/5B,UAAW,qBAAiB,GACpC,GAAW,CACP,eACA,GAAW,cAAelB,SAC3B,GAAKkB,UAAW,sBAAkB,GACrC,GAAO,GAAW,CACd,aAAgB,QAChB,GAAQ,EAAG,KAAQ,GAAQ,EAAG,KAAO,GAAQ,EAAG,KAChD,GAAW,oBAAqB,CAAClB,OAAQ,GAASA,UACnD,IAEH,MAAM+nD,GAA8B,CAAC56C,EAAWvJ,KAC5C,GAAIuJ,EAAU0sC,SAASj2C,GACnB,OAAO,EAEX,IAAI65C,EAAa,KACjB,KAAiB,MAAV75C,GAAgB,CACnB,GAAIA,IAAWuJ,EACX,OAAO,EAEXswC,EAAa75C,EAAO65C,WACD,OAAfA,GAA2C,KAApB75C,EAAOyhD,SAIlCzhD,EAAS65C,EAHL75C,EAASA,EAAOynC,KAKxB,OAAO,GAEL0b,GAAgB,CAACW,EAASa,KAsB5B,IAAIC,GAAa,EACjB,MAAMC,EAAiB,KACnBD,GAAa,GAEXE,EAAc,KAChBF,GAAa,EACbd,EAAQlyB,UAAUK,gBAAgB4yB,EAAgB,CAAEE,SAAS,KAE3DC,EAAmB5tC,IAChBwtC,IACD3wC,EAAYmD,GACZ0tC,MAuCF7wC,EAAemD,IACjB,MAAMpX,EAASoX,EAAE6tC,SAAW7tC,EAAEgiC,eAAe,GAAKhiC,EAAEpX,OACpD,GAAe,OAAXA,EAGJ,IAAK,IAAItE,EAAI,EAAGkS,EAAK+2C,EAAankD,OAAQ9E,EAAIkS,IAAMlS,EAChDipD,EAAajpD,GAAGwpD,kBAAkBllD,IAG1C,MAAO,CACHmlD,cAAeH,EACfI,aAAcJ,EACdK,YAAaL,EACbM,QAxCiBluC,IACjB,GAAIwtC,EACA,OASJ,GADiBxtC,EAAEpX,SAAW8jD,EAAQpnB,IAAI2iB,OAEtC,IAAK,IAAI3jD,EAAI,EAAGkS,EAAK+2C,EAAankD,OAAQoN,EAAKlS,IAAKA,EAChDipD,EAAajpD,GAAGuoD,mBAIpBhwC,EAAYmD,GAEhB0tC,KAsBAS,OApBqB,KACrBX,GAAa,EACb,IAAK,IAAIlpD,EAAI,EAAGkS,EAAK+2C,EAAankD,OAAQ9E,EAAIkS,IAAMlS,EAChDipD,EAAajpD,GAAGuoD,eAkBpB,YAAY7sC,GACRlR,KAAK,KAAKkR,EAAEwwB,QAAQxwB,MCzUhC,IAAI,GAA0C,SAAUjX,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAO3D,IAAIo0C,GAAQ,MACR,YAAYz3B,EAAS2O,GACjBx2B,KAAKw2B,IAAMA,EAIXx2B,KAAKu/C,YAAa,EAClBv/C,KAAK6nB,QAAUA,EAEnB,aACI7nB,KAAKw/C,eAOT,eAMiC,GAAzBx/C,KAAKg3B,YAAYtzB,MACjB1D,KAAKkW,QAMLlW,KAAKu/C,YAAa,EAM1B,cACQv/C,KAAKu/C,aACLv/C,KAAKu/C,YAAa,EAClBv/C,KAAKkW,SAET,MAAMqoC,EAAKv+C,KAAK6nB,QAChB02B,EAAGvpB,iBAAiB,QAASh1B,MAC7Bu+C,EAAGvpB,iBAAiB,OAAQh1B,MAKhC,cACI,MAAMu+C,EAAKv+C,KAAK6nB,QAChB02B,EAAGloB,oBAAoB,QAASr2B,MAChCu+C,EAAGloB,oBAAoB,OAAQr2B,MAKnC,YAAYkR,GAIO,UAAXA,EAAEwwB,KACF1hC,KAAKvJ,OAAQ,EAERuJ,KAAKw2B,IAAI4iB,SAASqG,gBAAkBz/C,KAAK6nB,UAQ9C7nB,KAAKvJ,OAAQ,GAMrB,QACI,MAAM8nD,EAAKv+C,KAAK6nB,QACZ7nB,KAAKvJ,MACL8nD,EAAGmB,QAGHnB,EAAGrB,SAIf,GAAW,CACP,aAAS,CAAEvmD,KAAM,IAAYs7B,SAC7B,GAAW,cAAe/7B,SAC3BopD,GAAMloD,UAAW,aAAS,GAC7BkoD,GAAQ,GAAW,CACf,aAAgB,SAChB,GAAQ,EAAG,KAAQ,GAAQ,EAAG,KAC9B,GAAW,oBAAqB,CAACppD,OAAQ,MAC1CopD,IChHH,IAAI,GAA0C,SAAUrlD,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAK3D,SAASy0C,GAAO/mB,GACZ,OAA0B,MAAtBA,EACO,KAAcrB,KAEc,mBAA5BqB,EAAmBH,KACnB,IAAI,KAAaG,GAErBA,EAEX,IAAI,GAAS,MACT,YAAY9xB,EAAS84C,EAAappB,GAC9Bx2B,KAAK8G,QAAUA,EACf9G,KAAK4/C,YAAcA,EACnB5/C,KAAKw2B,IAAMA,EACXx2B,KAAK0U,GAAK,YAAO,gBACjB1U,KAAK6/C,QAAS,EACd7/C,KAAK4rB,KAAO,KAAc2L,KAG1Bv3B,KAAK8/C,cAAgBtpB,EAAIlB,cAAc,OACvCt1B,KAAK82B,KAAO92B,KAAK8G,QAAQhQ,SACzB0/B,EAAIX,uBAAuB71B,KAAK82B,KAAKwF,MAAOsjB,GAC5C5/C,KAAK82B,KAAKC,KAAK6oB,EAAa,GAEhC,WAAWvrC,GAIP,OAH4B,MAAxBrU,KAAK+/C,kBACL//C,KAAK+/C,gBAAkB//C,KAAKg3B,YAAYvpB,MAAMqM,gBAE3C9Z,KAAK82B,KAAK9/B,KAAKqd,EAAOrU,KAAKg3B,YAAYvpB,OAElD,YAAY4G,GACRrU,KAAKggD,gBAET,aAAa3rC,GACTrU,KAAK4rB,KAAO5rB,KAAK45B,WAAWvlB,GAEhC,aAAaA,GAET,OADArU,KAAK+/C,gBAAkB,KAChB//C,KAAK82B,KAAKtX,OAAOnL,GAE5B,gBACI,MAAM2iB,EAAch3B,KAAKg3B,YACqB,IAArB,EAApBA,EAAYtzB,QAGjB1D,KAAKopC,QAAQpS,EAAY3iB,OAE7B,QAAQA,GACJ,MAAM4rC,EAAYjgD,KAAK8/C,cACjBI,EAAYlgD,KAAK8/C,cAAgB9/C,KAAKmgD,gBACxCF,IAAcC,IAGlBlgD,KAAK4rB,KAAO5rB,KAAK45B,WAAWvlB,GAC5BrU,KAAK4rB,KAAO5rB,KAAK85B,SAASomB,EAAW7rC,IAEzC,SAASva,EAAQua,GACb,MAAM,WAAE+rC,EAAU,UAAEC,EAAS,gBAAEN,EAAe,KAAEjpB,GAAS92B,KACzD,IAAI4rB,EAAO5rB,KAAK4rB,KAEhB,OADAkL,EAAKC,KAAKj9B,EAAQ,GACgD,IAApC,GAAzBkG,KAAKg3B,YAAYtzB,OACXkoB,GAEe,mBAAfw0B,IAEHx0B,EADAA,EAAK2L,KACEooB,GAAOS,EAAWzqD,KAAKoqD,EAAiBjmD,EAAQg9B,IAGhD,IAAI,IAAiBlL,EAAMw0B,EAAYL,EAAiBjmD,EAAQg9B,IAG3ElL,EAAK2L,KACLT,EAAKG,OAAO5iB,GAGZuX,EAAO,IAAI,IAAiBA,EAAMkL,EAAKG,OAAQH,EAAMziB,GAEhC,mBAAdgsC,IAIHz0B,EAHAA,EAAK2L,KAGEooB,GAAOU,EAAU1qD,KAAKoqD,EAAiBjmD,EAAQg9B,IAG/C,IAAI,IAAiBlL,EAAMy0B,EAAWN,EAAiBjmD,EAAQg9B,IAGvElL,GAEX,WAAWvX,GACP,MAAM,aAAEisC,EAAY,YAAEC,EAAW,gBAAER,EAAe,KAAEjpB,EAAMh9B,OAAQA,GAAWkG,KAC7E,IAAI4rB,EAAO5rB,KAAK4rB,KAuBhB,MAtB4B,mBAAjB00B,IAEH10B,EADAA,EAAK2L,KACEooB,GAAOW,EAAa3qD,KAAKoqD,EAAiBjmD,EAAQg9B,IAGlD,IAAI,IAAiBlL,EAAM00B,EAAcP,EAAiBjmD,EAAQg9B,IAG7ElL,EAAK2L,KACLT,EAAKI,OAAO7iB,GAGZuX,EAAO,IAAI,IAAiBA,EAAMkL,EAAKI,OAAQJ,EAAMziB,GAE9B,mBAAhBksC,IAEH30B,EADAA,EAAK2L,KACEooB,GAAOY,EAAY5qD,KAAKoqD,EAAiBjmD,EAAQg9B,IAGjD,IAAI,IAAiBlL,EAAM20B,EAAaR,EAAiBjmD,EAAQg9B,IAGzElL,EAEX,gBACI,MAAM4K,EAAMx2B,KAAKw2B,IAEXgqB,EAAYhqB,EAAI4iB,SACtB,IAAIt/C,EAASkG,KAAKlG,OACdkF,EAAUgB,KAAKygD,cACnB,GAAsB,iBAAX3mD,EAAqB,CAC5B,IAAI4mD,EAAeF,EACI,iBAAZxhD,IACPA,EAAUwhD,EAAUnC,cAAcr/C,IAElCw3B,EAAIR,eAAeh3B,KACnB0hD,EAAe1hD,GAEnBlF,EAAS4mD,EAAarC,cAAcvkD,GAExC,GAAI08B,EAAIR,eAAel8B,GACnB,OAAOA,EAEX,GAAc,MAAVA,EAAgB,CAChB,GAAIkG,KAAK6/C,OACL,MAAM,IAAIp/C,MAAM,2BAGhB3G,EAAS0mD,EAAUlC,KAG3B,OAAOxkD,IC9JR,IAAI6mD,GAUJ,SAASC,GAA0BnqD,GACtC,MAAMirC,EAAOjrC,EAAMirC,KACnB,MAAuB,iBAATA,GAAqC,IAAhBA,EAAKpnC,ODqJ5C,GAAW,CACP,aAAS,CAAEo5B,SAAS,IACpB,GAAW,cAAex9B,SAC3B,GAAOkB,UAAW,cAAU,GAC/B,GAAW,CACP,aAAS,CAAEoH,SAAU,kBACrB,GAAW,cAAetI,SAC3B,GAAOkB,UAAW,qBAAiB,GACtC,GAAW,CACP,eACA,GAAW,cAAe+5B,UAC3B,GAAO/5B,UAAW,cAAU,GAC/B,GAAW,CACP,eACA,GAAW,cAAewJ,WAC3B,GAAOxJ,UAAW,oBAAgB,GACrC,GAAW,CACP,eACA,GAAW,cAAewJ,WAC3B,GAAOxJ,UAAW,kBAAc,GACnC,GAAW,CACP,eACA,GAAW,cAAewJ,WAC3B,GAAOxJ,UAAW,mBAAe,GACpC,GAAW,CACP,eACA,GAAW,cAAewJ,WAC3B,GAAOxJ,UAAW,iBAAa,GAClC,GAAW,CACP,eACA,GAAW,cAAelB,SAC3B,GAAOkB,UAAW,uBAAmB,GACxC,GAAS,GAAW,CAChB,aAAmB,UACnB,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAClB,OAAQA,OAAQ,MAClD,ICtMH,SAAWyqD,GACPA,EAAyC,YAAI,KAC7CA,EAA6C,gBAAI,KACjDA,EAA8C,iBAAI,KAClDA,EAAkD,qBAAI,KACtDA,EAA0C,aAAI,KAC9CA,EAA+C,kBAAI,KACnDA,EAA+C,kBAAI,KAPvD,CAQGA,KAAgCA,GAA8B,KCR1D,MAAME,GACT,YAAYn3C,GACR1J,KAAK0J,KAAOA,EACZ1J,KAAK0hC,KAAO,MAGb,MAAM,GACT,YAAYh4B,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKivC,gBAAiB,EACtBjvC,KAAKyD,SAAW,IAAmB2Y,MAGpC,MAAM,GACT,YAAY1S,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKivC,gBAAiB,EACtBjvC,KAAKyD,SAAW,IAAmBmxC,UAGpC,MAAM,GACT,YAAYlrC,EAAM4b,GACdtlB,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,KACZ1hC,KAAKivC,gBAAiB,EACtBjvC,KAAKyD,SAAW,IAAmBqxC,WAUpC,MAAMgM,GACT,YAAYrqD,EAAO6uB,GACftlB,KAAKvJ,MAAQA,EACbuJ,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MAGb,MAAMqf,GACT,YAAYtqD,GACRuJ,KAAKvJ,MAAQA,EACbuJ,KAAK0hC,KAAO,MAGb,MAAMsf,GACT,YAAYvqD,GACRuJ,KAAKvJ,MAAQA,EACbuJ,KAAK0hC,KAAO,MAGb,MAAMuf,GACT,YAOAC,EAAMx3C,EAAM4b,GACRtlB,KAAKkhD,KAAOA,EACZlhD,KAAK0J,KAAOA,EACZ1J,KAAKslB,GAAKA,EACVtlB,KAAK0hC,KAAO,MCrEb,SAASpM,GAAckB,EAAK2qB,EAAWC,EAAO1iB,GACjD,GAAyB,iBAAdyiB,EACP,OAgDR,SAA6B3qB,EAAK0gB,EAASkK,EAAO1iB,GAC9C,MAAMU,EAAe,GACfiiB,EAAkB,GAClB58C,EAAe,GACfojB,EAAU2O,EAAIlB,cAAc4hB,GAClC,IAAIoK,GAAkB,EAClBF,GACAlrD,OAAOsD,KAAK4nD,GACPvwC,QAAQyU,IACT,MAAM7uB,EAAQ2qD,EAAM97B,GAChBs7B,GAA0BnqD,IAC1B6qD,GAAkB,EAClBliB,EAAav/B,KAAKpJ,IAGlB+/B,EAAIF,aAAazO,EAASvC,EAAI7uB,KAItC6qD,IACA9qB,EAAIN,WAAWrO,GACfw5B,EAAgBxhD,KAAKu/B,IAErBV,GACA6iB,GAAY/qB,EAAK3O,EAAS6W,EAAU2iB,EAAiB58C,GAEzD,OAAO,IAAI,GAAW+xB,EAAK3O,EAASw5B,EAAiB58C,GA1E1C+8C,CAAoBhrB,EAAK2qB,EAAWC,EAAO1iB,GAEjD,GAAI,IAAc/f,OAAOwiC,GAC1B,OAyER,SAA8B3qB,EAAKz1B,EAAMqgD,EAAO1iB,GAC5C,MAAM9yB,EAAa,IAAci6B,cAAc9kC,GACzCm2C,EAAUtrC,EAAW7V,KACrBqpC,EAAe,GACfiiB,EAAkB,CAACjiB,GACnB36B,EAAe,GACfy+B,EAAoB,GACpB/P,EAAYvnB,EAAWunB,UACvBtL,EAAU2O,EAAIlB,cAAc4hB,GAClC1gB,EAAIN,WAAWrO,GACVpjB,EAAa0K,SAASpO,IACvB0D,EAAa5E,KAAKkB,GAEtBq+B,EAAav/B,KAAK,IAAI,IAA0Bq3C,EAAShU,IACrDke,GACAlrD,OAAOsD,KAAK4nD,GACPvwC,QAAQyU,IACT,MAAM7uB,EAAQ2qD,EAAM97B,GACpB,GAAIs7B,GAA0BnqD,GAC1BysC,EAAkBrjC,KAAKpJ,OAEtB,MAEgB,IADA08B,EAAU7N,GAEvB4d,EAAkBrjC,KAAK,CACnB6hC,KAAM,KACNpc,KACA7uB,UAIJysC,EAAkBrjC,KAAK,IAAIihD,GAAwBrqD,EAAO6uB,OAKtEoZ,GACA6iB,GAAY/qB,EAAK3O,EAAS6W,EAAU2iB,EAAiB58C,GAEzD,OAAO,IAAI,GAAW+xB,EAAK3O,EAASw5B,EAAiB58C,GAhH1Cg9C,CAAqBjrB,EAAK2qB,EAAWC,EAAO1iB,GAGnD,MAAM,IAAIj+B,MAAM,sBAMjB,MAAM,GACT,YAAY+1B,EAAK9B,EAAM0K,EAAc36B,GACjCzE,KAAKw2B,IAAMA,EACXx2B,KAAK00B,KAAOA,EACZ10B,KAAKo/B,aAAeA,EACpBp/B,KAAKyE,aAAeA,EACpBzE,KAAK0hD,oBAAiB,EAE1B,iBAUI,YAT4B,IAAxB1hD,KAAK0hD,iBACL1hD,KAAK0hD,eAAiB,IAAwB5qD,OAAO,CACjDf,KAAM,IAAc6pC,eACpBT,SAAUn/B,KAAK00B,KACf4K,aAAmC,iBAAdt/B,KAAK00B,KAC1B0K,aAAcp/B,KAAKo/B,aACnB36B,aAAczE,KAAKyE,gBAGpBzE,KAAK0hD,eAEhB,WAAWvd,GACP,OAAO,aAAiBnkC,KAAK4L,WAAYu4B,OAAiB,GAE9D,WAAWA,GACP,OAAOnkC,KAAK8iC,eAAeqB,GAAiBrtC,SAEhD,eAAeqtC,GACX,OAAOnkC,KAAK2hD,WAAWxd,GAAiBrB,iBAG5C,UAAU/nC,EAAQqkC,EAAc36B,GAC5BzE,KAAKw2B,IAAIvB,YAAYl6B,EAAQiF,KAAK00B,MAClC0K,EAAav/B,QAAQG,KAAKo/B,cAC1B36B,EAAa5E,QAAQG,KAAKyE,eAwElC,SAAS88C,GAAY/qB,EAAKz7B,EAAQ2jC,EAAU2iB,EAAiB58C,GACzD,IAAK,IAAIjP,EAAI,EAAGkS,EAAKg3B,EAASpkC,OAAQ9E,EAAIkS,IAAMlS,EAAG,CAC/C,MAAMoT,EAAU81B,EAASlpC,GACzB,cAAeoT,GACX,IAAK,SACD4tB,EAAIvB,YAAYl6B,EAAQy7B,EAAIb,eAAe/sB,IAC3C,MACJ,IAAK,SACG4tB,EAAIR,eAAeptB,GACnB4tB,EAAIvB,YAAYl6B,EAAQ6N,GAEnB,cAAeA,GACpBA,EAAQg5C,UAAU7mD,EAAQsmD,EAAiB58C,KCtI/D,IAAI,GAA0C,SAAUxK,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAK3D,MAAM,GAAY,CAAC,UAAW,aAC9B,IAAI,GAAU,MACV,YAAYsrB,EAAK0L,GACbliC,KAAKw2B,IAAMA,EACXx2B,KAAK0U,GAAK,YAAO,gBACjB1U,KAAK+uB,aAAU,EACf/uB,KAAK6hD,WAAY,EACjB7hD,KAAK82B,UAAO,EACZ92B,KAAK4rB,KAAO,KAAc2L,KAC1Bv3B,KAAK8hD,iBAAc,EACnB9hD,KAAK+hD,WAAa7f,EAAY9C,aACzBn1B,OAAQC,IAAO,GAAUiF,SAASjF,EAAEob,KACpC08B,OAAO,CAACC,EAAKviD,KACVA,EAAK4lB,KACL28B,EAAIviD,EAAK4lB,IAAM5lB,GAEZuiD,GACR,IAEP,WAAW5tC,GAaP,OAZIrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKkiD,QAAQliD,KAAK+uB,QAAS1a,GAGvCrU,KAAK4rB,KAAO,IAAI,IAAiB5rB,KAAK4rB,KAAM5rB,KAAKkiD,QAASliD,KAAMA,KAAK+uB,QAAS1a,GAE9ErU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAK+5B,SAAS1lB,GAG1BrU,KAAK4rB,KAAO,IAAI,IAAiB5rB,KAAK4rB,KAAM5rB,KAAK+5B,SAAU/5B,KAAMqU,GAE9DrU,KAAK4rB,KAEhB,aAAavX,GACLrU,KAAK4rB,KAAK2L,KACVv3B,KAAKy5B,WAAWplB,GAGhBrU,KAAK4rB,KAAO,IAAI,IAAiB5rB,KAAK4rB,KAAM5rB,KAAKy5B,WAAYz5B,KAAMqU,GAG3E,aAAaA,GACQ,MAAbrU,KAAK82B,OACD92B,KAAK4rB,KAAK2L,KACVv3B,KAAK82B,KAAKI,OAAO7iB,GAGjBrU,KAAK4rB,KAAO,IAAI,IAAiB5rB,KAAK4rB,KAAM5rB,KAAK82B,KAAKI,OAAQl3B,KAAK82B,KAAMziB,IAIrF,aAAaA,GAUT,OATArU,KAAK8hD,iBAAc,EACF,MAAb9hD,KAAK82B,OACD92B,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAK82B,KAAKtX,OAAOnL,GAG7BrU,KAAK4rB,KAAO,IAAI,IAAiB5rB,KAAK4rB,KAAM5rB,KAAK82B,KAAKtX,OAAQxf,KAAK82B,KAAMziB,IAG1ErU,KAAK4rB,KAEhB,QAAQvX,GACJrU,KAAK82B,UAAO,EAEhB,eAAe3iB,EAAUC,EAAeC,GACpCA,GAASrU,KAAKg3B,YAAY3iB,MACtBrU,KAAK4rB,KAAK2L,KACVv3B,KAAK4rB,KAAO5rB,KAAKkiD,QAAQ/tC,EAAUE,GAGnCrU,KAAK4rB,KAAO,IAAI,IAAiB5rB,KAAK4rB,KAAM5rB,KAAKkiD,QAASliD,KAAMmU,EAAUE,GAGlF,QAAQ0a,EAAS1a,GACb,GAAIrU,KAAK8hD,cAAgB/yB,EACrB,OAAO,KAAcwI,KAEzBv3B,KAAK8hD,YAAc/yB,EACnB/uB,KAAK6hD,WAAY,EACjB,IAAIj2B,EAAO5rB,KAAK45B,WAAWvlB,GAC3B,GAAI0a,aAAmB2I,QAAS,CAC5B,IAAIyqB,EAEAA,EADAv2B,EAAK2L,KACSxI,EAAQ0J,KAAKlhC,GAAKyI,KAAKoiD,YAAY7qD,EAAG8c,IAGtCuX,EAAK6L,OAAOgB,KAAK,IAAM1J,EAAQ0J,KAAKlhC,GAAKyI,KAAKoiD,YAAY7qD,EAAG8c,KAE/EuX,EAAO,IAAI,KAAYu2B,EAAaniD,KAAK85B,SAAU95B,KAAMqU,OAExD,CACD,MAAMyiB,EAAO92B,KAAKoiD,YAAYrzB,EAAS1a,GAEnCuX,EADAA,EAAK2L,KACEv3B,KAAK85B,SAAShD,EAAMziB,GAGpB,IAAI,IAAiBuX,EAAM5rB,KAAK85B,SAAU95B,KAAM82B,EAAMziB,GASrE,OANIuX,EAAK2L,KACLv3B,KAAKqiD,aAGLz2B,EAAO,IAAI,IAAiBA,EAAM5rB,KAAKqiD,WAAYriD,MAEhD4rB,EAEX,WAAWvX,GACP,MAAMyiB,EAAO92B,KAAK82B,KAClB,OAAY,MAARA,EACO,KAAcS,MAEzBT,EAAKI,OAAO7iB,GACLyiB,EAAKtX,OAAOnL,IAEvB,SAASyiB,EAAMziB,GAEX,GADArU,KAAK82B,KAAOA,EACA,MAARA,EACA,OAAO,KAAcS,KAEzB,IAAI3L,EAAO5rB,KAAK+5B,SAAS1lB,GAOzB,OANIuX,EAAK2L,KACLv3B,KAAKy5B,WAAWplB,GAGhBuX,EAAO,IAAI,IAAiBA,EAAM5rB,KAAKy5B,WAAYz5B,KAAMqU,GAEtDuX,EAEX,SAASvX,GACL,OAAiB,MAAbrU,KAAK82B,OAA4C,EAAzB92B,KAAKg3B,YAAYtzB,OAAsC,EACxE1D,KAAK82B,KAAK9/B,KAAKqd,EAAOrU,KAAKg3B,YAAYvpB,MAAOzN,KAAKg3B,YAAYrd,MAEnE,KAAc4d,KAEzB,WAAWljB,GACU,MAAbrU,KAAK82B,OAA4C,GAAzB92B,KAAKg3B,YAAYtzB,OAA4C,GACrF1D,KAAK82B,KAAKG,OAAO5iB,GAGzB,aACIrU,KAAK6hD,WAAY,EAErB,YAAY9yB,EAAS1a,GACjB,MAAMyiB,EAAO92B,KAAKsiD,eAAevzB,EAAS1a,GAC1C,GAAIyiB,EAGA,OAFAA,EAAKC,KAAK/2B,KAAKg3B,YAAY4H,UAAU2C,KAAM,GAC3CzK,EAAKyrB,UAAUviD,KAAKg3B,YAAYvpB,OACzBqpB,EAIf,eAAe/H,EAAS1a,GACpB,GAAK0a,EAAL,CAGA,GAkCR,SAAsBA,GAClB,MAAO,cAAeA,EAnCdyzB,CAAazzB,GACb,OAAOA,EAEX,GAAI,eAAgBA,EAChB,OAAOA,EAAQ0zB,WAAWziD,KAAKg3B,YAAYh4B,SAE/C,GAAI,WAAY+vB,EACZ,OAAOA,EAAQj4B,OAAOud,GAE1B,GAAI,aAAc0a,EAAS,CACvB,MAAMnjB,EAAa,IAAwB0J,YAAYyZ,GACvD,OAAO,aAAiBnjB,EAAY5L,KAAKg3B,YAAYh4B,aAAS,GAAQ8jC,iBAAiBhsC,OAAOud,GAGlG,OAAOihB,GAAct1B,KAAKw2B,IAAKzH,EAAS/uB,KAAK+hD,gBAA2C,IAA/B/hD,KAAKg3B,YAAY4H,UACpE,IAASx/B,WACTY,KAAKg3B,YAAY4H,UAAUF,UAAU+jB,WAAWziD,KAAKg3B,YAAYh4B,YAG/E,GAAW,CACP,KACA,GAAW,cAAe9I,SAC3B,GAAQkB,UAAW,eAAW,GACjC,GAAW,CACP,aAAS,CAAET,KAAM,IAAYmpB,WAC7B,GAAW,cAAeqR,UAC3B,GAAQ/5B,UAAW,iBAAa,GACnC,GAAU,GAAW,CACjB,aAAc,CAAErB,KAAM,aAAcopC,SAAU,KAAMK,eAAe,IACnE,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAACtpC,OAAQA,UAC1C,IC9MH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAM3D,IAAI,GAEJ,MACI,YAAY02B,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAM9qB,EAAOtd,EAAOwhD,YAIpB,IAAIt9B,EAHAhf,EAAQw3B,IAAIT,SAASj8B,IACrBkF,EAAQw3B,IAAIJ,OAAOt8B,GAGvB,MAAMmkB,EAAO,aAAiBje,KAAK4hC,OAAQM,EAAYx4B,KAAM,MAEzDsU,EADAC,EAAK+F,QACK,aAAqB,IAAI,KAA0BhkB,KAAKgd,gBAAiBiB,EAAM7G,EAAM,cAAe,IAAYyI,OAAQ7gB,GAAUif,EAAMjf,GAGxI,aAAqB,IAAI,IAAqBif,EAAKgG,gBAAiBhG,EAAM7G,EAAM,cAAe,IAAYyI,OAAQ7f,KAAKgd,gBAAiBhe,GAAS,GAAOif,EAAMjf,GAE7KiY,EAAWosB,WAAWrlB,KAG9B,GAAsB,GAAW,CAC7B,aAAoB,MAGpB,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC9nB,OAAQA,UAC1C,IAEH,IAAI,GAEJ,MACI,YAAY0rC,EAAQsN,GAChBlvC,KAAK4hC,OAASA,EACd5hC,KAAKkvC,aAAeA,EAExB,OAAO76B,EAAOrV,EAASiY,EAAYnd,EAAQooC,GAEvC,MAAMjkB,EAAO,aAAiBje,KAAK4hC,OAAQM,EAAYx4B,KAAM,GAA2Bw4B,EAAYz+B,SAAW,GACzGua,EAAU,aAAqB,IAAI,EAAShf,EAAQw3B,IAAK0L,EAAY5c,GAAI4c,EAAYz+B,SAAUwa,EAAMnkB,EAAQooC,EAAY+M,eAAgBjvC,KAAKkvC,aAAclwC,GAAUif,EAAMjf,GAClLiY,EAAWosB,WAAWrlB,KAG9B,GAA0B,GAAW,CACjC,aAAoB,MAGpB,GAAQ,EAAG,KACX,GAAQ,EAAGw2B,GACX,GAAW,oBAAqB,CAACt+C,OAAQA,UAC1C,IAEH,IAAIwsD,GAEJ,MACI,OAAOruC,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvCpoC,EAAOw8B,aAAa4L,EAAY5c,GAAI4c,EAAYzrC,SAGxDisD,GAAuB,GAAW,CAC9B,aAAoB,OAErBA,IAEH,IAAIC,GAA4B,MAC5B,OAAOtuC,EAAOrV,EAASiY,EAAYnd,EAAQooC,IA8D/C,SAAoBsN,EAAWiD,GAC3B,MAAM50C,EAAM40C,EAAUn4C,OACtB,IAAIwtB,EAAQ,EACZ,IAAK,IAAItyB,EAAI,EAAGA,EAAIqI,IAAOrI,EACS,KAA5Bi9C,EAAU11C,WAAWvH,IACjBA,IAAMsyB,GACN0nB,EAAU5zC,IAAI62C,EAAU/zC,MAAMopB,EAAOtyB,IAEzCsyB,EAAQtyB,EAAI,GAEPA,EAAI,IAAMqI,GACf2xC,EAAU5zC,IAAI62C,EAAU/zC,MAAMopB,IAxElC86B,CAAW9oD,EAAO01C,UAAWtN,EAAYzrC,SAGjDksD,GAA4B,GAAW,CACnC,aAAoB,OACrBA,IAEH,IAAIE,GAA4B,MAC5B,OAAOxuC,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvCpoC,EAAO41C,MAAMmG,SAAW3T,EAAYzrC,QAG5CosD,GAA4B,GAAW,CACnC,aAAoB,OACrBA,IAEH,IAAI,GAEJ,MACI,YAAYjhB,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAMjkB,EAAO,aAAiBje,KAAK4hC,OAAQM,EAAYx4B,KAAM,GAA6B,IAAYmW,QAChG7B,EAAU,aAAqB,IAAI,KAAgBC,EAAMnkB,EAAO41C,MAAOxN,EAAY5c,GAAI,IAAYzF,OAAQ7f,KAAKgd,gBAAiBhe,GAAUif,EAAMjf,GACvJiY,EAAWosB,WAAWrlB,KAG9B,GAA+B,GAAW,CACtC,aAAoB,MAGpB,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC9nB,OAAQA,UAC1C,IAEH,IAAI,GAEJ,MACI,YAAY0rC,EAAQ5kB,GAChBhd,KAAK4hC,OAASA,EACd5hC,KAAKgd,gBAAkBA,EAE3B,OAAO3I,EAAOrV,EAASiY,EAAYnd,EAAQooC,GACvC,MAAMjkB,EAAO,aAAiBje,KAAK4hC,OAAQM,EAAYx4B,KAAM,GAA6B,IAAYmW,QAChG7B,EAAU,aAAqB,IAAI,EAAiBC,EAAMnkB,EAAQooC,EAAYgf,KAA4Bhf,EAAY5c,GAAoB,IAAYzF,OAAQ7f,KAAKgd,gBAAiBhe,GAAUif,EAAMjf,GAC1MiY,EAAWosB,WAAWrlB,KAG9B,GAA2B,GAAW,CAClC,aAAoB,MAGpB,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC9nB,OAAQA,UAC1C,ICnII,MAUM02C,GAAoB,CVhB1B,MACH,gBAAgBvpC,GACZ,OAAO,IAAaY,UAAU,IAAmBjE,MAAMyF,SAASpC,GAEpE,oBAAoBmzB,EAAKssB,EAAYvhB,EAAM1+B,GACvC,GAAIA,EAAI68B,eAAiB78B,EAAI88B,SAAU,CACnC,GAAI98B,EAAI28B,cACJ,MAAM,IAAS79B,MAAM,IAEzB,OAAO,IAAI,GAAmB60B,EAAKssB,EAAYvhB,EAAM1+B,GAEzD,OAAIA,EAAI28B,cACG,IAAI,GAAuBhJ,EAAKssB,EAAYvhB,GAEhD,IAAI,GAAcuhB,EAAYvhB,KUPK,GACA,IA0BrCkM,GAAmB,CAbe,GACA,GACS,GACrB,GACD,GACD6R,GACD,IA8BnB5R,GAAmB,CAdmB,GACC,GACJgV,GACKC,GACAE,GACG,GACT,IAwBlCE,GAA2B,CAIpCt9C,SAASpC,GACE,KACFoC,SAASpC,GACToC,YAAYmnC,MAAsBa,MAAqBC,IAKhE,kBACI,OAAO1tC,KAAKyF,SAAS,IAAGrB,qBC5FhC,IAAI,GAA0C,SAAUnK,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAS3D,MAAM83C,GAAe,IAAIrrD,QACZsrD,GAAyB,IAAGn9C,gBAAgB,0BACpDP,YAAY2E,GAAKA,EAAE1L,SAAS,CAAC4H,EAASC,EAAWJ,KAClD,IAAIa,EAAUk8C,GAAa3sD,IAAI4P,GAI/B,YAHgB,IAAZa,GACAk8C,GAAajqD,IAAIkN,EAAUa,EAAU,GAAkBo8C,mBAAmB98C,IAEvEU,KAEJ,MAAM,GACT,YAAYq8C,GACRnjD,KAAKmjD,IAAMA,EAEf,SAAS9/C,GACL,MAAM60C,EAAe70C,EAAUhN,IAAIyhD,IAC7BhxC,EAAUzD,EAAUhN,IAAI4sD,IAC9B5/C,EAAUoC,SAAS,IAAagB,SAASoxC,GAAkB/wC,EAAQs8C,aAAapjD,KAAKmjD,IAAKjL,KAE9F,0BAA0B70C,GACtB,OAAI00C,GAAyBsL,UAAUhgD,EAAUhN,IAAI,KAC1CgN,EAAUhN,IAAI,IAElBgN,EAAUhN,IAAI,KAG7B,IAAI,GAAkC,MAClC,YAAYmgC,GACRx2B,KAAKw2B,IAAMA,EACXx2B,KAAKzB,MAAQ,IAAIzF,IAErB,aAAak/C,EAAaE,GACtB,OAAO,IAAIH,GAAyB/3C,KAAKw2B,IAAKwhB,EAAah4C,KAAKzB,MAAO25C,KAG/E,GAAkC,GAAW,CACzC,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC,MAClC,IACH,IAAI,GAA4B,MAC5B,YAAY1hB,GACRx2B,KAAKw2B,IAAMA,EAEf,aAAawhB,EAAaE,GACtB,GAAIF,EAAYsL,KAAKp5C,GAAkB,iBAANA,GAE7B,MAAM,IAAIzJ,MAAM,oCAEpB,OAAO,IAAIi4C,GAAmB14C,KAAKw2B,IAAKwhB,EAAaE,KAG7D,GAA4B,GAAW,CACnC,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC,MAClC,ICxEH,IAAI,GAA0C,SAAUj+C,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAIpD,SAASq4C,MAAcA,GAC1B,OAAO,IAAI,GAA4BA,GAEpC,MAAM,GACT,YAAYA,GACRvjD,KAAKujD,WAAaA,EAEtB,SAASlgD,GACL,MAAMmgD,EAActtD,OAAOoH,OAAO,MAAO0C,KAAKujD,YAC9C,IAAIE,EAAuB,MACvB,YAAY57B,GACR7nB,KAAK6nB,QAAUA,EAEnB,aACI7nB,KAAKw/C,eAET,eACSx/C,KAAKvJ,MAIVuJ,KAAK6nB,QAAQ4qB,UAAYH,EAAgBtyC,KAAKvJ,OACzC0B,IAAI+R,GAAKs5C,EAAYt5C,IAAMA,GAC3B7R,KAAK,KALN2H,KAAK6nB,QAAQ4qB,UAAY,KAQrC,GAAW,CACP,KACA,GAAW,cAAer6C,SAC3BqrD,EAAqBrsD,UAAW,aAAS,GAC5CqsD,EAAuB,GAAW,CAC9B,aAAgB,SAChB,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAACvtD,UAClCutD,GACHpgD,EAAUoC,SAASg+C,ICjD3B,uc,6BCAO,MAAMC,EACT,YAAYC,EAASC,EAAU9pD,EAAQ+pD,GACnC7jD,KAAK2jD,QAAUA,EACf3jD,KAAK4jD,SAAWA,EAChB5jD,KAAKlG,OAASA,EACdkG,KAAK6jD,QAAUA,G,WCHhB,MAAMC,EACT,YAAYC,EAAOC,EAAQC,EAAUC,GAKjC,GAJAlkD,KAAK+jD,MAAQA,EACb/jD,KAAKgkD,OAASA,EACdhkD,KAAKikD,SAAWA,EAChBjkD,KAAKkkD,WAAaA,EACdA,EACA,OAAQH,EAAMzpD,QACV,KAAK,EACD0F,KAAK7G,IAAM6G,KAAKmkD,iBAChB,MACJ,KAAK,EACDnkD,KAAK7G,IAAM6G,KAAKokD,mBAChB,MACJ,QACIpkD,KAAK7G,IAAM6G,KAAKqkD,0BAIxB,OAAQN,EAAMzpD,QACV,KAAK,EACD0F,KAAK7G,IAAM6G,KAAKskD,UAChB,MACJ,KAAK,EACDtkD,KAAK7G,IAAM6G,KAAKukD,YAChB,MACJ,QACIvkD,KAAK7G,IAAM6G,KAAKwkD,eAIhC,OAAOC,GACH,OAAOzkD,KAAK+jD,QAAUU,EAAMV,OACrB/jD,KAAKgkD,SAAWS,EAAMT,QACtBhkD,KAAKikD,WAAaQ,EAAMR,UACxBjkD,KAAKkkD,aAAeO,EAAMP,WAErC,cAAc1mD,GACV,OAAOwC,KAAK+jD,MAAM50C,SAAS3R,GAE/B,YAAYA,GACR,OAAOwC,KAAK+jD,QAAUvmD,EAE1B,UAAUA,GACN,OAAO,EAEX,qBAAqBA,GACjB,OAAQwC,KAAK+jD,MAAM50C,SAAS3R,GAEhC,mBAAmBA,GACf,OAAOwC,KAAK+jD,QAAUvmD,EAE1B,iBAAiBA,GACb,OAAO,GAGR,MAAM,EACT,cACIwC,KAAKsiB,MAAQ,IAASljB,WACtBY,KAAK0kD,SAAW,GAChB1kD,KAAK2kD,cAAgB,GACrB3kD,KAAK4kD,YAAc,GAEvB,cACI,MAAMnuD,EAAQuJ,KAAK0kD,SACnB,MAAc,KAAVjuD,EACO,KAGAA,EAGf,YAAYA,GACK,MAATA,GACAuJ,KAAK0kD,SAAW,GAChB1kD,KAAKsiB,MAAQ,IAASljB,aAGtBY,KAAK0kD,SAAWjuD,EAChBuJ,KAAKsiB,MAAQtiB,KAAK4kD,YAAYnuD,IAGtC,OAAOouD,EAAS/nD,GACZ,MAAM,cAAE6nD,GAAkB3kD,UACKmF,IAA3Bw/C,EAAcE,GACdF,EAAcE,GAAW/nD,EAGzB6nD,EAAcE,IAAY/nD,EAGlC,KAAK+nD,GACD,MAAM,cAAEF,GAAkB3kD,KAC1B,QAA+BmF,IAA3Bw/C,EAAcE,GAAwB,CACtC,MAAM,YAAED,GAAgB5kD,UACKmF,IAAzBy/C,EAAYC,GACZD,EAAYC,GAAW,CAACF,EAAcE,IAGtCD,EAAYC,GAAShlD,KAAK8kD,EAAcE,IAE5CF,EAAcE,QAAW1/C,IAK9B,MAAMof,EACT,YAAYugC,KAAaC,GACrB/kD,KAAK8kD,SAAWA,EAChB9kD,KAAKglD,WAAa,GAClBhlD,KAAKilD,MAAQ,KACbjlD,KAAKklD,YAAa,EAClBllD,KAAK+kD,SAAWA,EAEpB,cACI,OAAO/kD,KAAKklD,WAAallD,KAAK+kD,SAAS,GAAK,KAEhD,UAAUD,GACN,MAAME,EAAahlD,KAAKglD,WAClBnnD,EAAMmnD,EAAW1qD,OACvB,IAAI6/C,EAAQ,KACZ,IAAK,IAAI3kD,EAAI,EAAGA,EAAIqI,IAAOrI,EAEvB,GADA2kD,EAAQ6K,EAAWxvD,GACfsvD,EAASK,OAAOhL,EAAM2K,UACtB,OAAO3K,EAGf,OAAO,KAEX,OAAO2K,EAAUD,GACb,MAAM,SAAEE,GAAa/kD,KAChB+kD,EAAS51C,SAAS01C,IACnBE,EAASllD,KAAKglD,GAElB,IAAInhD,EAAQ1D,KAAKolD,UAAUN,GAQ3B,OAPa,MAATphD,IACAA,EAAQ,IAAI6gB,EAAMugC,EAAUD,GAC5B7kD,KAAKglD,WAAWnlD,KAAK6D,GACjBohD,EAASd,QACTtgD,EAAMshD,WAAWnlD,KAAK6D,IAGvBA,EAEX,YAAY5G,EAAIuoD,GAEZ,MAAM56C,EAAU,GACVu6C,EAAahlD,KAAKglD,WAClBnnD,EAAMmnD,EAAW1qD,OACvB,IAAIgrD,EAAW,EACXnL,EAAQ,KACR3kD,EAAI,EACJ8K,EAAI,EACR,KAAO9K,EAAIqI,IAAOrI,EAEd,GADA2kD,EAAQ6K,EAAWxvD,GACf2kD,EAAM2K,SAAS3rD,IAAI2D,GAInB,GAHA2N,EAAQ5K,KAAKs6C,GACbmL,EAAWnL,EAAM4K,SAASzqD,OAC1BgG,EAAI,EACA65C,EAAM2K,SAASb,SACf,KAAO3jD,EAAIglD,IAAYhlD,EACnB+kD,EAAejuC,KAAK+iC,EAAM4K,SAASzkD,SAIvC,KAAOA,EAAIglD,IAAYhlD,EACnB+kD,EAAeE,OAAOpL,EAAM4K,SAASzkD,GAAIxD,GAKzD,OAAO2N,GAIR,MAAM+6C,EACT,YAAYpK,GACRp7C,KAAKo7C,KAAOA,EACZp7C,KAAKo7C,KAAOA,EACZ,MAAMv9C,EAAMmC,KAAKnC,IAAMu9C,EAAK9gD,OACtBmrD,EAAQzlD,KAAKylD,MAAQ,GAC3B,IAAK,IAAIjwD,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBiwD,EAAM5lD,KAAK,IAAIikD,EAAS1I,EAAK5lD,IAAI,GAAO,GAAO,IAGvD,SAASgJ,GACL,MAAM,IAAEX,EAAG,MAAE4nD,GAAUzlD,KACvB,IAAK,IAAIxK,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBgJ,EAASinD,EAAMjwD,KAKpB,MAAMkwD,EACT,YAAYC,GACR3lD,KAAKo7C,KAAO,OACZp7C,KAAK4lD,KAAO,IAAI9B,EAAS6B,GAAS,GAAM,GAAO,GAEnD,SAASnnD,GACLA,EAASwB,KAAK4lD,OAIf,MAAMC,EACT,YAAYzK,GACRp7C,KAAKo7C,KAAOA,EACZp7C,KAAK4lD,KAAO,IAAI9B,EAAS1I,GAAM,GAAO,GAAM,GAEhD,SAAS58C,GACLA,EAASwB,KAAK4lD,OAIf,MAAME,EACT,cACI9lD,KAAK+lD,QAAU,EACf/lD,KAAKgmD,SAAW,EAChBhmD,KAAK2lD,QAAU,GAGhB,MAAMM,EAAqB,IAAGngD,gBAAgB,sBAAsBP,YAAY2E,GAAKA,EAAEjG,UAAUiiD,IAEjG,MAAMA,EACT,cACIlmD,KAAKmmD,UAAY,IAAI5hC,EAAM,MAC3BvkB,KAAKomD,cAAgB,CAACpmD,KAAKmmD,WAE/B,IAAIE,GACA,IAAI7wD,EAAI,EACR,GAAI2E,MAAMC,QAAQisD,GAAY,CAC1B,MAAM3+C,EAAK2+C,EAAU/rD,OACrB,KAAO9E,EAAIkS,IAAMlS,EACbwK,KAAKpE,IAAIyqD,EAAU7wD,IAEvB,OAEJ,IAAI8wD,EAAetmD,KAAKmmD,UACxB,MAAMtjD,EAAMwjD,EACNxB,EAAUhiD,EAAIgiD,QACdI,EAAQ,IAAIa,EACZS,EAAWvmD,KAAK8hC,MAAMj/B,EAAKoiD,GAC3BpnD,EAAM0oD,EAASjsD,OACfkE,EAAY1B,IACdwpD,EAAeA,EAAaf,OAAOzoD,EAAI+nD,IAE3C,IAAKrvD,EAAI,EAAGA,EAAIqI,IAAOrI,EACnB+wD,EAAS/wD,GAAGgxD,SAAShoD,GAEzB8nD,EAAarB,MAAQA,EACrBqB,EAAapB,YAAa,EAE9B,UAAUnvD,GACN,MAAMsvD,EAAiB,IAAI,EAC3B,IAAIoB,EAASzmD,KAAKomD,cAClB,MAAMvoD,EAAM9H,EAAKuE,OACjB,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAChB4oD,EAASzmD,KAAK0mD,cAAcD,EAAQ1wD,EAAKqI,OAAO5I,GAAI6vD,GAC9B,IAAlBoB,EAAOnsD,UAFY9E,GA+B3B,GAzBAixD,EAAO71C,KAAK,CAAC1R,EAAGC,KACZ,IAAID,EAAEgmD,WAKD,OAAI/lD,EAAE+lD,WACA,EAGA,EARP,IAAK/lD,EAAE+lD,WACH,OAAQ,EAShB,MAAMyB,EAASznD,EAAE+lD,MACX2B,EAASznD,EAAE8lD,MACjB,OAAI0B,EAAOZ,UAAYa,EAAOb,QACnBa,EAAOb,QAAUY,EAAOZ,QAE/BY,EAAOX,WAAaY,EAAOZ,SACpBY,EAAOZ,SAAWW,EAAOX,SAEhCW,EAAOhB,UAAYiB,EAAOjB,QACnBiB,EAAOjB,QAAUgB,EAAOhB,QAE5B,IAEPc,EAAOnsD,OAAS,EAAG,CACnB,MAAMoJ,EAAQ+iD,EAAO,GAChB/iD,EAAMohD,SAASb,UAChBoB,EAAejuC,KAAK1T,EAAMmhD,SAE9BQ,EAAeR,QAAUnhD,EAAMmhD,QAEnC,OAAOQ,EAEX,cAAcoB,EAAQ3pD,EAAIuoD,GAEtB,MAAML,EAAa,GACnB,IAAIthD,EAAQ,KACZ,MAAM7F,EAAM4oD,EAAOnsD,OACnB,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAAOrI,EACvBkO,EAAQ+iD,EAAOjxD,GACfwvD,EAAWnlD,QAAQ6D,EAAMmjD,YAAY/pD,EAAIuoD,IAE7C,OAAOL,EAEX,MAAMniD,EAAKoiD,GACP,MAAMpoD,EAAS,GACTgoD,EAAUhiD,EAAIgiD,QACdhnD,EAAMgnD,EAAQvqD,OACpB,IAAI9E,EAAI,EACJsyB,EAAQ,EACRjyB,EAAI,GACR,KAAOL,EAAIqI,GACPhI,EAAIgvD,EAAQzmD,OAAO5I,GACdqN,EAAI8iD,QAAQx2C,SAAStZ,GAejBL,IAAMsyB,GACXjrB,EAAOgD,KAAK,IAAI2lD,EAAcX,EAAQnmD,MAAMopB,EAAOtyB,OACjDyvD,EAAMc,QACRj+B,EAAQtyB,IAGRqH,EAAOgD,KAAK,IAAIgmD,EAAchB,EAAQnmD,MAAMopB,EAAOtyB,EAAI,OACrDyvD,EAAMU,QACR79B,IAAUtyB,GAtBNA,IAAMsyB,GACI,MAANjyB,GAAyC,SAA5BgvD,EAAQnmD,MAAMlJ,EAAGA,EAAI,IAClCsyB,EAAQtyB,GAAS,EACjBqH,EAAOgD,KAAK,IAAI6lD,EAAe7iD,EAAI8iD,YACjCV,EAAMe,YAOVxwD,EAkBd,OAJIsyB,IAAUtyB,IACVqH,EAAOgD,KAAK,IAAI2lD,EAAcX,EAAQnmD,MAAMopB,EAAOtyB,OACjDyvD,EAAMc,SAELlpD,GAcR,MAAMiqD,EAAoB,IAAGhhD,gBAAgB,qBAAqBR,YAClE,SAASyhD,KAAoBC,GAChC,OAAO,SAAmBltD,GACtB,OAAOmtD,EAAiB/qD,OAAO8qD,EAAaltD,IAG7C,MAAM,EACT,YAAYiH,GACRf,KAAKe,KAAOA,EACZf,KAAKjK,UAAO,EAEhB,SAASsN,GACL,IAAaY,UAAU6iD,EAAmB9mD,KAAKe,MAAM0E,SAASpC,IAG/D,MAAM4jD,EAAmB/wD,OAAOyV,OAAO,CAC1C5V,KAAM,IAAS2M,SAASH,OAAO,qBAC/B2kD,wBAAyB,gCACzB,OAAOF,EAAajmD,IA7BxB,SAA2BqF,EAAS4gD,GAChC,IAAK,MAAMnkD,KAAOmkD,EAERnkD,EAAIgiD,WAAWz+C,EAGoB,mBAAzBA,EAAQvD,EAAIgiD,UACxB,IAAS38C,MAAM,IAAKrF,EAAIgiD,SAHxB,IAAS38C,MAAM,IAAKrF,EAAIgiD,SA0B5BsC,CAAkBpmD,EAAK3J,UAAW4vD,GAClC,MAAMp7C,EAAa,IAAI,EAAmC7K,IACpD,KAAEhL,EAAI,wBAAEmxD,GAA4BD,EAK1C,OAJA,IAAS/qD,OAAOnG,EAAM6V,EAAY7K,GAClC,IAAS2B,SAAS8B,SAASzD,EAAMhL,GACjC,IAASsM,WAAWtJ,IAAIgI,EAAMmmD,EAAyBF,GACvD,IAAS3kD,WAAWmC,SAASzD,EAAMmmD,GAC5BnmD,GAEXqmD,sBAAsBrmD,GACX,IAASsB,WAAWhM,IAAI0K,EAAMkmD,EAAiBC,2BCtY9D,IAAIv8C,EAA0C,SAAU1Q,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5DyU,EAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtGC,EAAoC,SAAUC,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAKpD,MAAMm8C,EAAmB,IAAGvhD,gBAAgB,oBAAoBP,YAAY2E,GAAKA,EAAEjG,UAAU,IAEpG,IAAI,EAAkB,MAClB,YAAYqjD,EAAaC,GACrBvnD,KAAKsnD,YAAcA,EACnBtnD,KAAKzB,MAAQ,GACbyB,KAAKsnD,YAAcA,EACnB,MAAMvC,EAAW/kD,KAAK+kD,SAAW,GACjCwC,EAAa12C,QAAQ22C,IACjB,MAAM1+C,EAAOm+C,EAAiBG,sBAAsBI,EAAY7hD,aAChE2hD,EAAY1rD,IAAIkN,GAChBA,EAAK+H,QAAQhO,IACTkiD,EAASliD,EAAIgiD,SAAW2C,MAIpC,MAAMzxD,EAAMU,GACR,IAAI4uD,EAAiBrlD,KAAKzB,MAAMxI,GACV,MAAlBsvD,IACAA,EAAiBrlD,KAAKzB,MAAMxI,GAAQiK,KAAKsnD,YAAYG,UAAU1xD,IAEnE,MAAM8uD,EAAUQ,EAAeR,QAC/B,OAAe,MAAXA,EACO,IAAInB,EAAW3tD,EAAMU,EAAOV,EAAM,MAGlCiK,KAAK+kD,SAASF,GAASA,GAAS9uD,EAAMU,EAAO4uD,EAAe/iC,SAI/E,EAAkB3X,EAAW,CACzBM,EAAQ,EAAGg7C,GACXh7C,EAAQ,EAAG,YAAI67C,IACf/7C,EAAW,oBAAqB,CAAC7U,OAAQiE,SAC1C,GCjDH,IAAI,EAA0C,SAAUF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAIhE,IAAI,EAA+B,MAC/B,YAAcqtD,EAASC,EAAUthC,GAC7B,OAAO,IAAIohC,EAAWC,EAASC,EAAUthC,EAAM,GAAIA,EAAM,IAE7D,iBAAmBqhC,EAASC,EAAUthC,GAClC,OAAO,IAAIohC,EAAWC,EAASC,EAAUthC,EAAM,GAAIA,EAAM,MAGjE,EAA+B,EAAW,CACtCykC,EAAiB,CAAElC,QAAS,YAAac,QAAS,KAAO,CAAEd,QAAS,iBAAkBc,QAAS,OAChG,GAEH,IAAI,EAAsB,MACtB,IAAQhC,EAASC,EAAUthC,GACvB,OAAO,IAAIohC,EAAWC,EAASC,EAAU,UAAW,OAExD,WAAaD,EAASC,EAAUthC,GAC5B,OAAO,IAAIohC,EAAWC,EAASC,EAAUthC,EAAM,GAAI,SAG3D,EAAsB,EAAW,CAC7BykC,EAAiB,CAAElC,QAAS,MAAOc,QAAS,IAAM,CAAEd,QAAS,WAAYc,QAAS,OACnF,GAEH,IAAI,EAAoC,MACpC,QAAUhC,EAASC,EAAUthC,GACzB,OAAO,IAAIohC,EAAWC,EAASC,EAAUthC,EAAM,GAAI,UAG3D,EAAoC,EAAW,CAC3CykC,EAAiB,CAAElC,QAAS,QAASc,QAAS,OAC/C,GAEH,IAAI,EAAoC,MACpC,QAAUhC,EAASC,EAAUthC,GACzB,OAAO,IAAIohC,EAAWC,EAASC,EAAUthC,EAAM,GAAI,aAG3D,EAAoC,EAAW,CAC3CykC,EAAiB,CAAElC,QAAS,QAASc,QAAS,OAC/C,G,WC9CI,SAAS+B,EAAeC,GAC3B,OAAO,SAAU7tD,GACb,OAAO8tD,EAAe1rD,OAAOyrD,EAAkB7tD,IAGhD,MAAM,EACT,YAAYiH,EAAMhL,EAAMmmB,EAASnlB,EAAK2qC,GAClC1hC,KAAKe,KAAOA,EACZf,KAAKjK,KAAOA,EACZiK,KAAKkc,QAAUA,EACflc,KAAKjJ,IAAMA,EACXiJ,KAAK0hC,KAAOA,EAEhB,cAAc/jB,EAAW5c,GACrB,IAAIhL,EACA8M,EASJ,MARyB,iBAAd8a,GACP5nB,EAAO4nB,EACP9a,EAAM,CAAE9M,UAGRA,EAAO4nB,EAAU5nB,KACjB8M,EAAM8a,GAEH,IAAI,EAAyB5c,EAAM,YAAa6mD,EAAe7pC,cAAchd,EAAM,QAAShL,GAAO,YAAY6xD,EAAe7pC,cAAchd,EAAM,WAAY8B,EAAIqZ,QAASnb,EAAKmb,SAAU0rC,EAAezrC,QAAQpmB,GAAO,YAAa6xD,EAAe7pC,cAAchd,EAAM,QAAS8B,EAAI6+B,KAAM3gC,EAAK2gC,KAAM,OAEjT,SAASr+B,GACL,MAAM,KAAEtC,EAAI,IAAEhK,EAAG,QAAEmlB,GAAYlc,KAC/B,IAAaiE,UAAUlN,EAAKgK,GAAM0E,SAASpC,GAC3C,IAAagH,QAAQtT,EAAKgK,GAAM0E,SAASpC,GACzC,aAAgB6Y,EAAS0rC,EAAgB7wD,EAAKsM,IAG/C,MAAMukD,EAAiB,CAC1B7xD,KAAM,IAAS2M,SAASH,OAAO,mBAC/B4Z,QAAQpmB,GACG,GAAG6xD,EAAe7xD,QAAQA,IAErC4oB,OAAOloB,GACqB,mBAAVA,GAAwB,IAAS0F,OAAOyrD,EAAe7xD,KAAMU,GAE/E,OAAOknB,EAAW5c,GACd,MAAM6K,EAAa,EAAyB9U,OAAO6mB,EAAW5c,GAI9D,OAHA,IAAS7E,OAAO0rD,EAAe7xD,KAAM6V,EAAYA,EAAW7K,MAC5D,IAAS7E,OAAO0rD,EAAe7xD,KAAM6V,EAAYA,GACjD,IAASlJ,SAAS8B,SAASzD,EAAM6mD,EAAe7xD,MACzC6V,EAAW7K,MAEtB,cAAcA,GACV,MAAM8B,EAAM,IAASzG,OAAOwrD,EAAe7xD,KAAMgL,GACjD,QAAY,IAAR8B,EACA,MAAM,IAAIpC,MAAM,gCAAgCM,EAAKhL,QAEzD,OAAO8M,GAEX,SAAS9B,EAAMuB,EAAM7L,GACjB,IAASyF,OAAO,IAASmG,WAAWE,OAAOD,GAAO7L,EAAOsK,IAE7Dgd,cAAa,CAAChd,EAAMuB,IACT,IAASlG,OAAO,IAASiG,WAAWE,OAAOD,GAAOvB,IAG1D,SAASghC,EAAU/jB,EAAS6pC,GAC/B,OAAoB,IAAhB7pC,EAAQ3J,MACD2J,EAAQ0rB,SAASoe,SAEnBD,EACE,YAAU7pC,EAAQ+pC,OAAOjuD,QAGzBkkB,EAAQ+pC,OAAOjuD,OCxEvB,IAAIkuD,EAmBX,SAASC,EAAazxB,GAClB,MAAMld,EAASkd,EAAIlB,cAAc,QAEjC,OADAkB,EAAIN,WAAW5c,GACRA,GArBX,SAAW0uC,GACPA,EAAYA,EAAkB,KAAI,KAAO,OACzCA,EAAYA,EAAkC,qBAAI,GAAK,uBACvDA,EAAYA,EAA2B,cAAI,GAAK,gBAChDA,EAAYA,EAA+B,kBAAI,GAAK,oBACpDA,EAAYA,EAA8B,iBAAI,GAAK,mBACnDA,EAAYA,EAA6B,gBAAI,IAAM,kBACnDA,EAAYA,EAA0B,aAAI,IAAM,eAChDA,EAAYA,EAA4B,eAAI,IAAM,iBAClDA,EAAYA,EAAoB,OAAI,KAAO,SAC3CA,EAAYA,EAAuB,UAAI,KAAO,YAC9CA,EAAYA,EAAuB,UAAI,KAAO,YAC9CA,EAAYA,EAAyB,YAAI,MAAQ,cACjDA,EAAYA,EAA2B,cAAI,MAAQ,gBACnDA,EAAYA,EAAyB,YAAI,MAAQ,cACjDA,EAAYA,EAA2B,cAAI,MAAQ,gBACnDA,EAAYA,EAAsB,SAAI,OAAS,WAhBnD,CAiBGA,IAAgBA,EAAc,KAS1B,MAAME,EACT,YAAY1xB,EAAKuxB,EAAQ75C,EAAMi6C,EAAU/lB,EAAMl0B,EAAKnY,MAChDiK,KAAK+nD,OAASA,EACd/nD,KAAKkO,KAAOA,EACZlO,KAAKoiC,IAAMA,EACXpiC,KAAKqU,MAAQ,IACbrU,KAAKooD,aAAe,KACpBpoD,KAAKm/B,SAAW,KAChBn/B,KAAKo0B,mBAAqB,KAC1Bp0B,KAAKqoD,UAAY,KACjBroD,KAAKsoD,OAAS,KACdtoD,KAAKmoD,SAAyB,gBAAdj6C,EAAKnY,KAAyBoyD,EAAW,KACzDnoD,KAAKsZ,OAAS2uC,EAAazxB,GAE/B,eAKI,OAJuB,OAAnBx2B,KAAKqoD,YACLroD,KAAKqoD,UAAY,GACjBroD,KAAKqU,OAAS,MAEXrU,KAAKqoD,UAEhB,YAKI,OAJoB,OAAhBroD,KAAKsoD,SACLtoD,KAAKsoD,OAAS,GACdtoD,KAAKqU,OAAS,OAEXrU,KAAKsoD,QASb,MAAMC,EACT,YAAYxyD,EAAMqyD,EAAe,KAAMrtD,EAAS,KAAMokC,EAAW,MAC7Dn/B,KAAKjK,KAAOA,EACZiK,KAAKooD,aAAeA,EACpBpoD,KAAKjF,OAASA,EACdiF,KAAKm/B,SAAWA,EAChBn/B,KAAKqU,MAAQ,GAMd,MAAMm0C,EACT,YAAYT,EAAQ75C,EAAMk0B,EAAMl0B,EAAKnY,MACjCiK,KAAK+nD,OAASA,EACd/nD,KAAKkO,KAAOA,EACZlO,KAAKoiC,IAAMA,EACXpiC,KAAKqU,MAAQ,EACbrU,KAAKqoD,UAAY,KAErB,eAKI,OAJuB,OAAnBroD,KAAKqoD,YACLroD,KAAKqoD,UAAY,GACjBroD,KAAKqU,OAAS,MAEXrU,KAAKqoD,WASb,MAAMI,EACT,YAAYV,EAAQlE,EAAS3kC,GACzBlf,KAAK+nD,OAASA,EACd/nD,KAAK6jD,QAAUA,EACf7jD,KAAKkf,WAAaA,EAClBlf,KAAKqU,MAAQ,GAUd,MAAMq0C,EACT,YAAY7E,EAASna,EAAUxqB,EAAY0kC,EAAU9pD,GACjDkG,KAAK6jD,QAAUA,EACf7jD,KAAK0pC,SAAWA,EAChB1pC,KAAKkf,WAAaA,EAClBlf,KAAK4jD,SAAWA,EAChB5jD,KAAKlG,OAASA,EACdkG,KAAKqU,MAAQ,KAOd,MAAMs0C,EACT,YAAYnyB,EAAK4xB,EAAcl6C,EAAMk0B,EAAMl0B,EAAKnY,KAAMo9B,EAAYjlB,EAAKilB,WACnEnzB,KAAKooD,aAAeA,EACpBpoD,KAAKkO,KAAOA,EACZlO,KAAKoiC,IAAMA,EACXpiC,KAAKmzB,UAAYA,EACjBnzB,KAAKqU,MAAQ,GACbrU,KAAK4oD,UAAW,EAChB5oD,KAAKo0B,mBAAqB,KAC1Bp0B,KAAK6oD,kBAAoB,KACzB7oD,KAAK8oD,iBAAmB,KACxB9oD,KAAKqoD,UAAY,KACjBroD,KAAK+oD,YAAc,KACnB/oD,KAAKsoD,OAAS,KACVp6C,EAAKsxB,eACLx/B,KAAKgpD,iBAAkB,EACvBhpD,KAAKsZ,OAAS2uC,EAAazxB,GAC3Bx2B,KAAKqU,OAAS,MAGdrU,KAAKgpD,iBAAkB,EACvBhpD,KAAKsZ,OAAS,MAGtB,uBAKI,OAJ+B,OAA3BtZ,KAAK6oD,oBACL7oD,KAAK6oD,kBAAoB,GACzB7oD,KAAKqU,OAAS,MAEXrU,KAAK6oD,kBAEhB,sBAKI,OAJ8B,OAA1B7oD,KAAK8oD,mBACL9oD,KAAK8oD,iBAAmB,GACxB9oD,KAAKqU,OAAS,MAEXrU,KAAK8oD,iBAEhB,eAKI,OAJuB,OAAnB9oD,KAAKqoD,YACLroD,KAAKqoD,UAAY,GACjBroD,KAAKqU,OAAS,MAEXrU,KAAKqoD,UAEhB,iBAKI,OAJyB,OAArBroD,KAAK+oD,cACL/oD,KAAK+oD,YAAc,GACnB/oD,KAAKqU,OAAS,MAEXrU,KAAK+oD,YAEhB,YAKI,OAJoB,OAAhB/oD,KAAKsoD,SACLtoD,KAAKsoD,OAAS,GACdtoD,KAAKqU,OAAS,OAEXrU,KAAKsoD,QAGb,MAAMW,EACT,YAAYzyB,EAAK4xB,EAAc9uC,EAAS2uC,EAAazxB,IACjDx2B,KAAKooD,aAAeA,EACpBpoD,KAAKsZ,OAASA,EACdtZ,KAAKqU,MAAQ,IACbrU,KAAKoxB,kBAAmB,EACxBpxB,KAAKqoD,UAAY,KAErB,eAKI,OAJuB,OAAnBroD,KAAKqoD,YACLroD,KAAKqoD,UAAY,GACjBroD,KAAKqU,OAAS,MAEXrU,KAAKqoD,WAQb,MAAMa,EACT,YAAY1yB,EAAK4xB,GACbpoD,KAAKooD,aAAeA,EACpBpoD,KAAKqU,MAAQ,GACbrU,KAAK4oD,UAAW,EAChB5oD,KAAKo0B,mBAAqB,KAC1Bp0B,KAAK2/B,UAAW,EAChB3/B,KAAK6oD,kBAAoB,KACzB7oD,KAAK8oD,iBAAmB,KACxB9oD,KAAK+oD,YAAc,KAEvB,uBAKI,OAJ+B,OAA3B/oD,KAAK6oD,oBACL7oD,KAAK6oD,kBAAoB,GACzB7oD,KAAKqU,OAAS,MAEXrU,KAAK6oD,kBAEhB,sBAKI,OAJ8B,OAA1B7oD,KAAK8oD,mBACL9oD,KAAK8oD,iBAAmB,GACxB9oD,KAAKqU,OAAS,MAEXrU,KAAK8oD,iBAEhB,iBAKI,OAJyB,OAArB9oD,KAAK+oD,cACL/oD,KAAK+oD,YAAc,GACnB/oD,KAAKqU,OAAS,MAEXrU,KAAK+oD,aAMb,MAAMI,EACT,YAAY3yB,EAAK4xB,EAAcp3B,EAAe1X,EAAS2uC,EAAazxB,IAChEx2B,KAAKooD,aAAeA,EACpBpoD,KAAKgxB,cAAgBA,EACrBhxB,KAAKsZ,OAASA,EACdtZ,KAAKqU,MAAQ,KCvPrB,IAAI,EAA0C,SAAUpa,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAKhE,IAAI,EAAwB,MACxB,cACI0J,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,OAAO,IAAI,KAA0BA,EAAQkB,WAAY6iB,EAAU/jB,GAAS,MAGpF,EAAwB,EAAW,CAC/B0pC,EAAe,aAChB,GAEH,IAAI,EAAuB,MACvB,cACI1nD,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,OAAO,IAAI,KAAyBA,EAAQkB,WAAY6iB,EAAU/jB,GAAS,MAGnF,EAAuB,EAAW,CAC9B0pC,EAAe,YAChB,GAEH,IAAI,EAAyB,MACzB,cACI1nD,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA2BA,EAAQkB,WAAY6iB,EAAU/jB,GAAS,MAGrF,EAAyB,EAAW,CAChC0pC,EAAe,cAChB,GAEH,IAAI,EAAuB,MACvB,cACI1nD,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,OAAO,IAAI,KAAyBA,EAAQkB,WAAY6iB,EAAU/jB,GAAS,MAGnF,EAAuB,EAAW,CAC9B0pC,EAAe,YAChB,GAEH,IAAI,EAAwB,MACxB,cACI1nD,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,IAAIrnB,EAAO,IAAYyyD,QACvB,GAAIprC,aAAmB0qC,EACnB/xD,EAAOqnB,EAAQ0rB,SAAS/yC,SAEvB,CAED,OADgBqnB,EAAQ+pC,OAAOlE,SAE3B,IAAK,OACL,IAAK,UACDltD,EAAO,IAAYkpB,OACnB,MACJ,IAAK,WACDlpB,EAAO,IAAY+4B,QACnB,MACJ,IAAK,YACD/4B,EAAO,IAAYmpB,SACnB,MACJ,IAAK,UACDnpB,EAAO,IAAYs7B,QAI/B,OAAQt7B,GACJ,KAAK,IAAYyyD,QACjB,KAAK,IAAYvpC,OACb,OAAO,EAAqBzoB,UAAUiuC,QAAQrnB,GAClD,KAAK,IAAY0R,QACb,OAAO,EAAsBt4B,UAAUiuC,QAAQrnB,GACnD,KAAK,IAAY8B,SACb,OAAO,EAAuB1oB,UAAUiuC,QAAQrnB,GACpD,KAAK,IAAYiU,OACb,OAAO,EAAqB76B,UAAUiuC,QAAQrnB,MAI9D,EAAwB,EAAW,CAC/B0pC,EAAe,SAChB,GAEH,IAAI,EAAqB,MACrB,cACI1nD,KAAKswB,YAAc,IAEvB,QAAQtS,GACJ,OAAO,IAAI,IAAuBA,EAAQkB,WAAY6iB,EAAU/jB,GAAS,MAGjF,EAAqB,EAAW,CAC5B0pC,EAAe,SAChB,GAEH,IAAI,EAAoB,MACpB,cACI1nD,KAAKswB,YAAc,IAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA2BA,EAAQkB,WAAY6iB,EAAU/jB,GAAS,MCtH9E,SAASqrC,EAAa5nD,GACzB,OAAQA,GACJ,KAAK,GAAiB,OAAO,EAC7B,KAAK,IAAkB,OAAO,EAC9B,KAAK,IAAkB,OAAO,GAC9B,KAAK,IAAkB,OAAO,GAC9B,KAAK,IAAkB,OAAO,GAC9B,KAAK,IAAkB,OAAO,GAC9B,KAAK,GAAsB,OAAO,GAClC,KAAK,GAAsB,OAAO,GAClC,KAAK,GAAoB,OAAO,GAChC,QAAS,OAAOA,GAGjB,IAAI6nD,EASAC,GAiBAC,GA8DAC,GDmBX,EAAoB,EAAW,CAC3B/B,EAAe,QAChB,GC5GH,SAAW4B,GACPA,EAAOA,EAAc,MAAI,GAAK,QAC9BA,EAAOA,EAAiB,SAAI,KAAO,WACnCA,EAAOA,EAAa,KAAI,KAAO,OAC/BA,EAAOA,EAAc,MAAI,MAAQ,QACjCA,EAAOA,EAAe,OAAI,MAAQ,SAClCA,EAAOA,EAAc,MAAI,MAAQ,QANrC,CAOGA,IAAWA,EAAS,KAEvB,SAAWC,GACPA,EAAWA,EAAqB,SAAI,IAAM,WAC1CA,EAAWA,EAAmB,OAAI,IAAM,SACxCA,EAAWA,EAAwB,YAAI,IAAM,cAC7CA,EAAWA,EAAsB,UAAI,IAAM,YAC3CA,EAAWA,EAAuB,WAAI,KAAO,aAC7CA,EAAWA,EAAqB,SAAI,KAAO,WAC3CA,EAAWA,EAAuB,WAAI,KAAO,aAC7CA,EAAWA,EAAqB,SAAI,KAAO,WAC3CA,EAAWA,EAA2B,eAAI,KAAO,iBACjDA,EAAWA,EAAmB,OAAI,KAAO,SACzCA,EAAWA,EAAyB,aAAI,KAAO,eAC/CA,EAAWA,EAAoB,QAAI,KAAO,UAC1CA,EAAWA,EAAkB,MAAI,KAAO,QAb5C,CAcGA,KAAeA,GAAa,KAG/B,SAAWC,GACPA,EAAMA,EAAW,IAAI,SAAW,MAChCA,EAAMA,EAA0B,mBAAI,SAAW,qBAC/CA,EAAMA,EAA2B,oBAAI,QAAU,sBAC/CA,EAAMA,EAAoB,aAAI,QAAU,eACxCA,EAAMA,EAAoB,aAAI,QAAU,eACxCA,EAAMA,EAAgB,SAAI,OAAS,WACnCA,EAAMA,EAAe,QAAI,OAAS,UAClCA,EAAMA,EAAoB,aAAI,OAAS,eACvCA,EAAMA,EAA8B,uBAAI,OAAS,yBACjDA,EAAMA,EAAsB,eAAI,MAAQ,iBACxCA,EAAMA,EAAqB,cAAI,MAAQ,gBACvCA,EAAMA,EAAsB,eAAI,MAAQ,iBACxCA,EAAMA,EAAe,QAAI,MAAQ,UACjCA,EAAMA,EAAkB,WAAI,MAAQ,aACpCA,EAAMA,EAAkB,WAAI,KAAO,aACnCA,EAAMA,EAAkB,WAAI,KAAO,aACnCA,EAAMA,EAAY,KAAI,IAAM,OAC5BA,EAAMA,EAAoB,aAAI,MAAQ,eACtCA,EAAMA,EAAmB,YAAI,MAAQ,cACrCA,EAAMA,EAAmB,YAAI,MAAQ,cACrCA,EAAMA,EAAwB,iBAAI,MAAQ,mBAC1CA,EAAMA,EAAiB,UAAI,MAAQ,YACnCA,EAAMA,EAAmB,YAAI,MAAQ,cACrCA,EAAMA,EAAiB,UAAI,QAAU,YACrCA,EAAMA,EAAiB,UAAI,QAAU,YACrCA,EAAMA,EAAW,IAAI,OAAS,MAC9BA,EAAMA,EAAkB,WAAI,SAAW,aACvCA,EAAMA,EAAkB,WAAI,SAAW,aACvCA,EAAMA,EAAa,MAAI,SAAW,QAClCA,EAAMA,EAAmB,YAAI,QAAU,cACvCA,EAAMA,EAAoB,aAAI,SAAW,eACzCA,EAAMA,EAAa,MAAI,SAAW,QAClCA,EAAMA,EAAgB,SAAI,SAAW,WACrCA,EAAMA,EAAiB,UAAI,SAAW,YACtCA,EAAMA,EAAW,IAAI,SAAW,MAChCA,EAAMA,EAAc,OAAI,SAAW,SACnCA,EAAMA,EAA0B,mBAAI,SAAW,qBAC/CA,EAAMA,EAAoB,aAAI,SAAW,eACzCA,EAAMA,EAAyB,kBAAI,SAAW,oBAC9CA,EAAMA,EAA0B,mBAAI,SAAW,qBAC/CA,EAAMA,EAA+B,wBAAI,SAAW,0BACpDA,EAAMA,EAAgB,SAAI,SAAW,WACrCA,EAAMA,EAAmB,YAAI,SAAW,cACxCA,EAAMA,EAAsB,eAAI,SAAW,iBAC3CA,EAAMA,EAAyB,kBAAI,SAAW,oBAC9CA,EAAMA,EAAiB,UAAI,SAAW,YACtCA,EAAMA,EAAyB,kBAAI,SAAW,oBAC9CA,EAAMA,EAAY,KAAI,QAAU,OAChCA,EAAMA,EAAa,MAAI,QAAU,QACjCA,EAAMA,EAAqB,cAAI,OAAS,gBACxCA,EAAMA,EAAmB,YAAI,OAAS,cACtCA,EAAMA,EAAgB,SAAI,SAAW,WACrCA,EAAMA,EAAe,QAAI,SAAW,UACpCA,EAAMA,EAAa,MAAI,SAAW,QAClCA,EAAMA,EAAc,OAAI,SAAW,SACnCA,EAAMA,EAAmB,YAAI,OAAS,cACtCA,EAAMA,EAAoB,aAAI,QAAU,eACxCA,EAAMA,EAA4B,qBAAI,QAAU,uBAChDA,EAAMA,EAAiB,UAAI,SAAW,YA3D1C,CA4DGA,KAAUA,GAAQ,KAErB,SAAWC,GACPA,EAAKA,EAAW,KAAI,GAAK,OACzBA,EAAKA,EAAgB,UAAI,GAAK,YAC9BA,EAAKA,EAAU,IAAI,GAAK,MACxBA,EAAKA,EAAe,SAAI,IAAM,WAC9BA,EAAKA,EAAkB,YAAI,IAAM,cACjCA,EAAKA,EAAe,SAAI,IAAM,WAC9BA,EAAKA,EAAqB,eAAI,IAAM,iBACpCA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAkB,YAAI,IAAM,cACjCA,EAAKA,EAAkB,YAAI,IAAM,cACjCA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAc,QAAI,IAAM,UAC7BA,EAAKA,EAAgB,UAAI,IAAM,YAC/BA,EAAKA,EAAkB,YAAI,IAAM,cACjCA,EAAKA,EAAgB,UAAI,IAAM,YAC/BA,EAAKA,EAAiB,WAAI,IAAM,aAChCA,EAAKA,EAAe,SAAI,IAAM,WAC9BA,EAAKA,EAAW,KAAI,IAAM,OAC1BA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAU,IAAI,IAAM,MACzBA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAgB,UAAI,IAAM,YAC/BA,EAAKA,EAAe,SAAI,IAAM,WAC9BA,EAAKA,EAAkB,YAAI,IAAM,cACjCA,EAAKA,EAAgB,UAAI,IAAM,YAC/BA,EAAKA,EAAmB,aAAI,IAAM,eAClCA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAiB,WAAI,IAAM,aAChCA,EAAKA,EAAgB,UAAI,KAAO,YAChCA,EAAKA,EAAU,IAAI,KAAO,MAC1BA,EAAKA,EAAiB,WAAI,KAAO,aACjCA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAe,SAAI,IAAM,WAC9BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAkB,YAAI,IAAM,cACjCA,EAAKA,EAAe,SAAI,IAAM,WAC9BA,EAAKA,EAAW,KAAI,IAAM,OAC1BA,EAAKA,EAAU,IAAI,IAAM,MACzBA,EAAKA,EAAU,IAAI,IAAM,MACzBA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAW,KAAI,IAAM,OAC1BA,EAAKA,EAAW,KAAI,IAAM,OAC1BA,EAAKA,EAAU,IAAI,IAAM,MACzBA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAY,MAAI,IAAM,QAC3BA,EAAKA,EAAW,KAAI,IAAM,OAC1BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,IAAM,SAC5BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAC7BA,EAAKA,EAAa,OAAI,KAAO,SAnGjC,CAoGGA,KAASA,GAAO,KCxMnB,MAAMtnC,GAAS,KAA2BA,OACpCD,GAAQ,KAA2BA,MACnCD,GAAQ,KAA2BA,MACnCD,GAAa,KAA2BA,WACxCrB,GAAQ,IAAqBA,MAC7BC,GAAU,IAAqBA,QAkBrC,MAAMvC,GAAS,IAhBR,MACH,YAAY1gB,GACRqC,KAAKrC,MAAQA,EACbqC,KAAKkF,MAAQ,EACblF,KAAK0pD,WAAa,EAClB1pD,KAAK2pD,UAAY,EACjB3pD,KAAK4pD,aAAe,QACpB5pD,KAAK6pD,WAAa,GAClB7pD,KAAK8pD,YAAa,EAClB9pD,KAAK1F,OAASqD,EAAMrD,OACpB0F,KAAK+pD,YAAcpsD,EAAMZ,WAAW,GAExC,eACI,OAAOiD,KAAKrC,MAAMe,MAAMsB,KAAK0pD,WAAY1pD,KAAKkF,SAGvB,IAC/B,IAAI8kD,GAiBAC,GAKG,SAASC,GAAgBvsD,EAAO2yB,GAKnC,OAJAjS,GAAO1gB,MAAQA,EACf0gB,GAAO/jB,OAASqD,EAAMrD,OACtB+jB,GAAOnZ,MAAQ,EACfmZ,GAAO0rC,YAAcpsD,EAAMZ,WAAW,GAC/B+kC,GAAMzjB,GAAQ,EAAe,QAAmC,IAAhBiS,EAAyB,GAAuBA,GAWpG,SAASwR,GAAMp+B,EAAOymD,EAAQC,EAAe95B,GAChD,GAAoB,MAAhBA,EACA,OAAO,IAAI,IAAiB5sB,EAAM/F,OAEtC,GAAoB,IAAhB+F,EAAMwB,MAAa,CACnB,GAAkB,KAAdorB,EAEA,OAmfZ,SAA4B5sB,GACxB,MAAM4e,EAAQ,GACRQ,EAAc,GACdxoB,EAASoJ,EAAMpJ,OACrB,IAAIuC,EAAS,GACb,KAAO6G,EAAMwB,MAAQ5K,GAAQ,CACzB,OAAQoJ,EAAMqmD,aACV,KAAK,GACD,GAAgD,MAA5CrmD,EAAM/F,MAAMZ,WAAW2G,EAAMwB,MAAQ,GAA4B,CACjEod,EAAMziB,KAAKhD,GACXA,EAAS,GACT6G,EAAMwB,OAAS,EACfxB,EAAMqmD,YAAcrmD,EAAM/F,MAAMZ,WAAW2G,EAAMwB,OACjDmlD,GAAU3mD,GACV,MAAMwb,EAAa4iB,GAAMp+B,EAAO,EAAe,GAAmB,MAClEof,EAAYjjB,KAAKqf,GACjB,SAGAriB,GAAU,IAEd,MACJ,KAAK,GACDA,GAAUzE,OAAOkyD,aAAajB,EAAalrD,GAASuF,KACpD,MACJ,QACI7G,GAAUzE,OAAOkyD,aAAa5mD,EAAMqmD,aAE5C5rD,GAASuF,GAEb,GAAIof,EAAYxoB,OAEZ,OADAgoB,EAAMziB,KAAKhD,GACJ,IAAI,IAAcylB,EAAOQ,GAEpC,OAAO,KArhBQynC,CAAmB7mD,GAG9B,GADA2mD,GAAU3mD,GACe,QAArBA,EAAMkmD,aACN,MAAM,IAASjoD,MAAM,IAAkC,CAAE+B,UAGjEA,EAAMomD,WAAa,IAAmBM,EACtC,IAAIvtD,OAAS,EACb,GAAyB,MAArB6G,EAAMkmD,aAAoC,CAkB1C,MAAMY,EAAKC,GAAiC,GAArB/mD,EAAMkmD,cAC7BS,GAAU3mD,GACV7G,EAAS,IAAI,KAAgB2tD,EAAI1oB,GAAMp+B,EAAOymD,EAAQ,IAAwB75B,IAC9E5sB,EAAMomD,YAAa,MAElB,CA0BDp2B,EAAS,OAAQhwB,EAAMkmD,cACnB,KAAK,KACDlmD,EAAMomD,YAAa,EACnB,EAAG,CAGC,GAFAO,GAAU3mD,GACVymD,KACIO,GAAWhnD,EAAO,OAQjB,IAAyB,OAArBA,EAAMkmD,aAAiD,CAC5D,MAAMlwC,EAAoB,IAATywC,EACjBttD,EAAsB,IAAb6c,EAAiBiH,GAAqB,IAAbjH,EAAiBkH,GAAU,IAAI,IAAqBlH,GACtFywC,EAAS,IACT,MAAMz2B,EAGN,MAAM,IAAS/xB,MAAM,IAAmC,CAAE+B,UAd1D,GAA2B,QAAvBA,EAAMkmD,aACN,MAAM,IAASjoD,MAAM,IAAqB,CAAE+B,UAE3C,GAA2B,UAAvBA,EAAMkmD,aACX,MAAM,IAASjoD,MAAM,IAA8B,CAAE+B,gBAYjC,OAAvBA,EAAMkmD,cAEnB,KAAK,KACiB,IAAdt5B,EACAzzB,EAAS,IAAI,IAAkB6G,EAAMmmD,aAGrChtD,EAAS,IAAI,IAAsB6G,EAAMmmD,WAAqB,IAATM,GACrDA,EAAS,MAEbzmD,EAAMomD,YAAa,EACnBO,GAAU3mD,GACV,MACJ,KAAK,KACDA,EAAMomD,YAAa,EACnBO,GAAU3mD,GACV7G,EAAS8jB,GACTwpC,EAAS,IACT,MACJ,KAAK,OACDE,GAAU3mD,GACV7G,EAASilC,GAAMp+B,EAAO,EAAe,GAAiB4sB,GACtDq6B,GAAQjnD,EAAO,SACfymD,EAAS,EACT,MACJ,KAAK,OACDttD,EA6RhB,SAAqC6G,EAAOymD,EAAQ75B,GAChD+5B,GAAU3mD,GACV,MAAM6e,EAAW,IAAIpoB,MACrB,KAA8B,UAAvBuJ,EAAMkmD,cACT,GAAIc,GAAWhnD,EAAO,UAElB,GADA6e,EAAS1iB,KAAKmiB,IACa,UAAvBte,EAAMkmD,aACN,UAGH,CAED,GADArnC,EAAS1iB,KAAKiiC,GAAMp+B,EAAOymD,EAAQ,IAA+B,IAAd75B,KAChDo6B,GAAWhnD,EAAO,SAMlB,MALA,GAA2B,UAAvBA,EAAMkmD,aACN,MAShB,OADAe,GAAQjnD,EAAO,SACG,IAAd4sB,EACO,IAAI,IAAoB/N,IAG/B7e,EAAMomD,YAAa,EACZ,IAAI,IAAuBvnC,IAzTjBqoC,CAA4BlnD,EAAOymD,EAAQ75B,GACpD65B,EAAS,EACT,MACJ,KAAK,OACDttD,EAyVhB,SAAsC6G,EAAO4sB,GACzC,MAAM92B,EAAO,IAAIW,MACXqG,EAAS,IAAIrG,MACnBkwD,GAAU3mD,GACV,KAA8B,UAAvBA,EAAMkmD,cAA2C,CAGpD,GAFApwD,EAAKqG,KAAK6D,EAAMmmD,YAES,MAArBnmD,EAAMkmD,aACNS,GAAU3mD,GACVinD,GAAQjnD,EAAO,SACflD,EAAOX,KAAKiiC,GAAMp+B,EAAO,EAAe,IAA+B,IAAd4sB,QAExD,MAAyB,KAArB5sB,EAAMkmD,cAgBX,MAAM,IAASjoD,MAAM,IAAkD,CAAE+B,UAhBpB,CAErD,MAAM,YAAEqmD,EAAW,aAAEH,EAAY,MAAE1kD,GAAUxB,EAC7C2mD,GAAU3mD,GACNgnD,GAAWhnD,EAAO,SAClBlD,EAAOX,KAAKiiC,GAAMp+B,EAAO,EAAe,IAA+B,IAAd4sB,KAIzD5sB,EAAMqmD,YAAcA,EACpBrmD,EAAMkmD,aAAeA,EACrBlmD,EAAMwB,MAAQA,EACd1E,EAAOX,KAAKiiC,GAAMp+B,EAAO,EAAe,KAAiC,IAAd4sB,MAMxC,UAAvB5sB,EAAMkmD,cACNe,GAAQjnD,EAAO,SAIvB,OADAinD,GAAQjnD,EAAO,SACG,IAAd4sB,EACO,IAAI,KAAqB92B,EAAMgH,IAGtCkD,EAAMomD,YAAa,EACZ,IAAI,KAAwBtwD,EAAMgH,IAjYxBqqD,CAA6BnnD,EAAO4sB,GAC7C65B,EAAS,EACT,MACJ,KAAK,OACDttD,EAAS,IAAI,KAAmB,CAAC6G,EAAMmmD,aACvCnmD,EAAMomD,YAAa,EACnBO,GAAU3mD,GACVymD,EAAS,EACT,MACJ,KAAK,OACDttD,EAASiuD,GAAcpnD,EAAOymD,EAAQ75B,EAAazzB,GAAQ,GAC3DstD,EAAS,EACT,MACJ,KAAK,KACL,KAAK,KACDttD,EAAS,IAAI,KAA2B6G,EAAMmmD,YAC9CnmD,EAAMomD,YAAa,EACnBO,GAAU3mD,GACVymD,EAAS,EACT,MACJ,KAAK,KACL,KAAK,KACL,KAAK,KACL,KAAK,KACDttD,EAAS4tD,GAAiC,GAArB/mD,EAAMkmD,cAC3BlmD,EAAMomD,YAAa,EACnBO,GAAU3mD,GACVymD,EAAS,EACT,MACJ,QACI,MAAIzmD,EAAMwB,OAASxB,EAAMpJ,OACf,IAASqH,MAAM,IAAqC,CAAE+B,UAGtD,IAAS/B,MAAM,IAA2B,CAAE+B,UAG9D,GAAkB,IAAd4sB,EAEA,OAiRZ,SAA6B5sB,EAAO7G,GAChC,GAAsD,IAAlC,MAAfA,EAAOkiB,OACR,MAAM,IAASpd,MAAM,IAAiC,CAAE+B,UAE5D,GAA2B,UAAvBA,EAAMkmD,aACN,MAAM,IAASjoD,MAAM,IAAiC,CAAE+B,UAE5D2mD,GAAU3mD,GACV,MAAM6f,EAAc1mB,EACdkuD,EAAYjpB,GAAMp+B,EAAO,EAAe,GAAmB,GACjE,OAAO,IAAI,IAAe6f,EAAawnC,GA3RxBC,CAAoBtnD,EAAO7G,GAEtC,GAAI,IAAyButD,EAEzB,OAAOvtD,EA0BX,IAAI9G,EAAO2N,EAAMmmD,WACjB,MAA6B,MAArBnmD,EAAMkmD,cAA2C,GAAG,CACxD,MAAM9xD,EAAO,GACb,IAAImzD,EACJ,OAAQvnD,EAAMkmD,cACV,KAAK,MAGD,GAFAlmD,EAAMomD,YAAa,EACnBO,GAAU3mD,GAC+C,IAA/B,KAArBA,EAAMkmD,cACP,MAAM,IAASjoD,MAAM,IAA8B,CAAE+B,UAMzD,GAJA3N,EAAO2N,EAAMmmD,WACbQ,GAAU3mD,GAEVymD,GAAoB,KAATA,IAAiD,EAAe,KAATA,GAAyC,KAATA,IAA8B,EACrG,SAAvBzmD,EAAMkmD,aAAyC,CAChC,IAAXO,IACAA,EAAS,MAEb,SAGAttD,EADS,KAATstD,EACS,IAAI,IAAsBp0D,EAAM8G,EAAO6c,UAGvC,IAAI,IAAuB7c,EAAQ9G,GAEhD,SACJ,KAAK,OACD2N,EAAMomD,YAAa,EACnBO,GAAU3mD,GACVymD,EAAS,KACTttD,EAAS,IAAI,IAAsBA,EAAQilC,GAAMp+B,EAAO,EAAe,GAAiB4sB,IACxFq6B,GAAQjnD,EAAO,SACf,MACJ,KAAK,OAGD,IAFAA,EAAMomD,YAAa,EACnBO,GAAU3mD,GACoB,UAAvBA,EAAMkmD,eACT9xD,EAAK+H,KAAKiiC,GAAMp+B,EAAO,EAAe,GAAiB4sB,IAClDo6B,GAAWhnD,EAAO,YAI3BinD,GAAQjnD,EAAO,SAEX7G,EADS,KAATstD,EACS,IAAI,IAAoBp0D,EAAM+B,EAAM+E,EAAO6c,UAEtC,KAATywC,EACI,IAAI,IAAqBttD,EAAQ9G,EAAM+B,GAGvC,IAAI,IAAuB+E,EAAQ/E,GAEhDqyD,EAAS,EACT,MACJ,KAAK,OACDzmD,EAAMomD,YAAa,EACnBmB,EAAU,CAACvnD,EAAMmmD,YACjBhtD,EAAS,IAAI,KAAyBouD,EAASA,EAASpuD,GACxDwtD,GAAU3mD,GACV,MACJ,KAAK,OACD7G,EAASiuD,GAAcpnD,EAAOymD,EAAQ75B,EAAazzB,GAAQ,KAK3E,GAAI,IAAmButD,EAEnB,OAAOvtD,EA6BX,MAA6B,MAArB6G,EAAMkmD,cAAuC,GAAG,CACpD,MAAMsB,EAAUxnD,EAAMkmD,aACtB,IAAe,IAAVsB,IAAmCd,EACpC,MAEJC,GAAU3mD,GACV7G,EAAS,IAAI,IAAiB4tD,GAAsB,GAAVS,GAA0BruD,EAAQilC,GAAMp+B,EAAOymD,EAAkB,IAAVe,EAAgC56B,IACjI5sB,EAAMomD,YAAa,EAEvB,GAAI,GAAuBM,EAEvB,OAAOvtD,EAaX,GAAI6tD,GAAWhnD,EAAO,SAAyB,CAC3C,MAAM6c,EAAMuhB,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,GAClDq6B,GAAQjnD,EAAO,SACf7G,EAAS,IAAI,IAAsBA,EAAQ0jB,EAAKuhB,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,IACtF5sB,EAAMomD,YAAa,EAEvB,GAAI,GAAkBM,EAElB,OAAOvtD,EAaX,GAAI6tD,GAAWhnD,EAAO,SAAuB,CACzC,IAAKA,EAAMomD,WACP,MAAM,IAASnoD,MAAM,IAAyB,CAAE+B,UAEpD7G,EAAS,IAAI,IAAiBA,EAAQilC,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,IAEhF,GAAI,GAAoB85B,EAEpB,OAAOvtD,EAIX,KAAO6tD,GAAWhnD,EAAO,UAAoB,CACzC,GAA2B,UAAvBA,EAAMkmD,aACN,MAAM,IAASjoD,MAAM,KAEzB,MAAM5L,EAAO2N,EAAMmmD,WACnBQ,GAAU3mD,GACV,MAAM5L,EAAO,IAAIqC,MACjB,KAAOuwD,GAAWhnD,EAAO,UACrB5L,EAAK+H,KAAKiiC,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,IAEpDzzB,EAAS,IAAI,KAAyBA,EAAQ9G,EAAM+B,GAIxD,KAAO4yD,GAAWhnD,EAAO,UAA0B,CAC/C,GAA2B,UAAvBA,EAAMkmD,aACN,MAAM,IAASjoD,MAAM,KAEzB,MAAM5L,EAAO2N,EAAMmmD,WACnBQ,GAAU3mD,GACV,MAAM5L,EAAO,IAAIqC,MACjB,KAAOuwD,GAAWhnD,EAAO,UACrB5L,EAAK+H,KAAKiiC,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,IAEpDzzB,EAAS,IAAI,IAA0BA,EAAQ9G,EAAM+B,GAEzD,GAA2B,UAAvB4L,EAAMkmD,aAAoC,CAC1C,GAAkB,KAAdt5B,EAEA,OAAOzzB,EAEX,GAAuB,OAAnB6G,EAAMynD,SACN,MAAM,IAASxpD,MAAM,IAA2B,CAAE+B,UAEtD,MAAM,IAAS/B,MAAM,IAA2B,CAAE+B,UAGtD,OAAO7G,EAkMX,SAASiuD,GAAcpnD,EAAOymD,EAAQ75B,EAAazzB,EAAQuuD,GACvD,MAAMvoC,EAAS,CAACnf,EAAMmmD,YAEtBc,GAAQjnD,EAAO,QACf,MAAMof,EAAc,CAACgf,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,IAC3D,KAA0D,UAAlD5sB,EAAMkmD,aAAeyB,GAAiB3nD,KAC1Cmf,EAAOhjB,KAAK6D,EAAMmmD,YAClBc,GAAQjnD,EAAO,QACfof,EAAYjjB,KAAKiiC,GAAMp+B,EAAOymD,EAAQ,GAAiB75B,IAI3D,OAFAzN,EAAOhjB,KAAK6D,EAAMmmD,YAClBnmD,EAAMomD,YAAa,EACfsB,GACAf,GAAU3mD,GACH,IAAI,KAAyBmf,EAAQA,EAAQhmB,EAAQimB,KAG5DunC,GAAU3mD,GACH,IAAI,KAAmBmf,EAAQC,IAG9C,SAASunC,GAAU3mD,GACf,KAAOA,EAAMwB,MAAQxB,EAAMpJ,QAEvB,GADAoJ,EAAMgmD,WAAahmD,EAAMwB,MAC8C,OAAlExB,EAAMkmD,aAAgB0B,GAAa5nD,EAAMqmD,aAAarmD,IACvD,OAGRA,EAAMkmD,aAAe,QAEzB,SAASzrD,GAASuF,GACd,OAAOA,EAAMqmD,YAAcrmD,EAAM/F,MAAMZ,aAAa2G,EAAMwB,OAS9D,SAASqmD,GAAW7nD,EAAO8nD,GACvB,IAAIhuD,EAAOkG,EAAMqmD,YACjB,IAAgB,IAAZyB,EAAmB,CACnB,GACIhuD,EAAOW,GAASuF,SACXlG,GAAQ,IAAiBA,GAAQ,IAC1C,GAAa,KAATA,EAEA,OADAkG,EAAMmmD,WAAa9f,SAASrmC,EAAMynD,SAAU,IACrC,KAIX,GADA3tD,EAAOW,GAASuF,GACZA,EAAMwB,OAASxB,EAAMpJ,OAIrB,OADAoJ,EAAMmmD,WAAa9f,SAASrmC,EAAMynD,SAASzsD,MAAM,GAAI,GAAI,IAClD,KAGf,GAAIlB,GAAQ,IAAiBA,GAAQ,GACjC,GACIA,EAAOW,GAASuF,SACXlG,GAAQ,IAAiBA,GAAQ,SAG1CkG,EAAMqmD,YAAcrmD,EAAM/F,MAAMZ,aAAa2G,EAAMwB,OAGvD,OADAxB,EAAMmmD,WAAa4B,WAAW/nD,EAAMynD,UAC7B,KAgCX,SAASO,GAAahoD,GAClB,IAAImT,GAAO,EACPha,EAAS,GACb,KAA2B,KAApBsB,GAASuF,IACZ,GAA0B,KAAtBA,EAAMqmD,YAAiC,CACvC,GAAKrmD,EAAMwB,MAAQ,EAAKxB,EAAMpJ,QAAsD,MAA5CoJ,EAAM/F,MAAMZ,WAAW2G,EAAMwB,MAAQ,GAA4B,CACrGxB,EAAMwB,QACN2R,GAAO,EACP,MAGAha,GAAU,SAGb,GAA0B,KAAtB6G,EAAMqmD,YACXltD,GAAUzE,OAAOkyD,aAAajB,EAAalrD,GAASuF,SAEnD,CACD,GAAIA,EAAMwB,OAASxB,EAAMpJ,OACrB,MAAM,IAASqH,MAAM,IAAgC,CAAE+B,UAE3D7G,GAAUzE,OAAOkyD,aAAa5mD,EAAMqmD,aAK5C,OAFA5rD,GAASuF,GACTA,EAAMmmD,WAAahtD,EACfga,EACO,OAEJ,OAEX,SAASw0C,GAAiB3nD,GACtB,GAAIA,EAAMwB,OAASxB,EAAMpJ,OACrB,MAAM,IAASqH,MAAM,IAAgC,CAAE+B,UAG3D,OADAA,EAAMwB,QACCwmD,GAAahoD,GAExB,SAASgnD,GAAWhnD,EAAOioD,GACvB,OAAIjoD,EAAMkmD,eAAiB+B,IACvBtB,GAAU3mD,IACH,GAIf,SAASinD,GAAQjnD,EAAOioD,GACpB,GAAIjoD,EAAMkmD,eAAiB+B,EAIvB,MAAM,IAAShqD,MAAM,IAAgC,CAAE+B,QAAOkoD,SAAUD,IAHxEtB,GAAU3mD,IAtvBlB,SAAWsmD,GACPA,EAAYA,EAAoC,uBAAI,KAAO,yBAC3DA,EAAYA,EAA6B,gBAAI,KAAO,kBACpDA,EAAYA,EAAuB,UAAI,KAAO,YAC9CA,EAAYA,EAAqC,wBAAI,KAAO,0BAC5DA,EAAYA,EAAuC,0BAAI,KAAO,4BAC9DA,EAAYA,EAAgC,mBAAI,KAAO,qBACvDA,EAAYA,EAAmC,sBAAI,KAAO,wBAC1DA,EAAYA,EAAoD,uCAAI,KAAO,yCAC3EA,EAAYA,EAA+B,kBAAI,KAAO,oBACtDA,EAAYA,EAAkC,qBAAI,KAAO,uBACzDA,EAAYA,EAAkC,qBAAI,KAAO,uBACzDA,EAAYA,EAAiC,oBAAI,KAAO,sBACxDA,EAAYA,EAAmC,sBAAI,KAAO,wBAC1DA,EAAYA,EAAoC,uBAAI,KAAO,yBAd/D,CAeGA,KAAgBA,GAAc,KAEjC,SAAWC,GACPA,EAAcA,EAA6B,cAAI,KAAO,gBACtDA,EAAcA,EAA+B,gBAAI,KAAO,kBAF5D,CAGGA,KAAkBA,GAAgB,KA+uBrC,MAAMQ,GAAc,CAChBtoC,GAAQD,GAAOD,GAAOD,GAAY,QAAS,UAC3C,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAM,IACxD,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,IAAK,IACrD,KAAM,KAAM,KAAM,aAAc,IAAK,IAAK,SAAU,OAAQ,IAAK,IAAK,IAAK,IAAK,IAChF,OAA2B,OAC3B,MAEE6pC,GAAgB31D,OAAOY,OAAO,MACpC+0D,GAAcC,KAAO,KACrBD,GAAcE,KAAO,KACrBF,GAAcG,MAAQ,KACtBH,GAAc1mD,UAAY,KAC1B0mD,GAAclrC,MAAQ,KACtBkrC,GAAcjrC,QAAU,KACxBirC,GAAcI,GAAK,QACnBJ,GAAcK,WAAa,QAC3BL,GAAcM,OAAS,MACvBN,GAAcO,KAAO,MACrBP,GAAcQ,GAAK,QASnB,MAAMC,GAEW,CAAC,GAAM,EAAG,GAAM,GAAM,GAAM,GAAM,GAAM,EAAG,GAAM,KAF5DA,GAG6B,CAAC,GAAM,EAAG,GAAM,GAAM,GAAM,EAAG,GAAM,IAAM,IAAM,EAAG,IAAM,EAAG,IAAM,IAAM,IAAM,IAAM,IAAM,IAAO,IAAO,IAAO,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,EAAG,KAAQ,EAAG,KAAQ,KAAQ,KAAQ,KAAQ,KAAQ,EAAG,KAAQ,EAAG,KAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,OAHjeA,GAIyB,CAAC,GAAM,IAJhCA,GAKoB,CAAC,EAAG,GAAM,IAAM,KAM1C,SAASC,GAAW/sD,EAAQ8xB,EAAMk7B,EAAY/1D,GAC1C,MAAMg2D,EAAaD,EAAWlyD,OAC9B,IAAK,IAAI9E,EAAI,EAAGA,EAAIi3D,EAAYj3D,GAAK,EAAG,CACpC,MAAMsyB,EAAQ0kC,EAAWh3D,GACzB,IAAIwhB,EAAMw1C,EAAWh3D,EAAI,GAKzB,GAJAwhB,EAAMA,EAAM,EAAIA,EAAM8Q,EAAQ,EAC1BtoB,GACAA,EAAOktD,KAAKj2D,EAAOqxB,EAAO9Q,GAE1Bsa,EACA,IAAK,IAAIx0B,EAAKgrB,EAAOhrB,EAAKka,EAAKla,IAC3Bw0B,EAAK11B,IAAIkB,IAMzB,SAAS6vD,GAAYhB,GACjB,OAAOp0D,IACH4G,GAAS5G,GACFo0D,GAGf,MAAMiB,GAAsBr1D,IACxB,MAAM,IAASoK,MAAM,IAA+B,CAAE+B,MAAOnM,KAEjEq1D,GAAoBC,WAAY,EAGhCN,GAAW,KADU,IAAI5wD,IACM2wD,IAAmB,GAElD,MAAMQ,GAAU,IAAIC,WAAW,OAE/BR,GAAWO,GAAS,KAAMR,GAAe,GAEzCC,GAAWO,GAAS,KAAMR,GAAa,GAEvC,MAAMhB,GAAe,IAAInxD,MAAM,OAC/BmxD,GAAaoB,KAAKE,GAAqB,EAAG,OAC1CL,GAAWjB,GAAc,KAAMgB,GAAY/0D,IACvC4G,GAAS5G,GACF,OAEXg1D,GAAWjB,GAAc,KAAMgB,IAjN/B,SAAwB5oD,GAEpB,KAAOopD,GAAQ3uD,GAASuF,MAExB,MAAMioD,EAAQE,GAAcnoD,EAAMmmD,WAAanmD,EAAMynD,UACrD,YAAiBhmD,IAAVwmD,EAAsB,KAAwBA,KA6MzDY,GAAWjB,GAAc,KAAMgB,GAAa/0D,GAAKg0D,GAAWh0D,GAAG,IAC/D+zD,GAAa,IACTA,GAAa,IAAwB/zD,GA/KzC,SAAoBmM,GAChB,MAAMspD,EAAQtpD,EAAMqmD,YACpB5rD,GAASuF,GACT,IAAIupD,EAAY,EAChB,MAAMC,EAAS,IAAI/yD,MACnB,IAAImf,EAAS5V,EAAMwB,MACnB,KAAOxB,EAAMqmD,cAAgBiD,GACzB,GAA0B,KAAtBtpD,EAAMqmD,YACNmD,EAAOrtD,KAAK6D,EAAM/F,MAAMe,MAAM4a,EAAQ5V,EAAMwB,QAC5C/G,GAASuF,GACTupD,EAAY5D,EAAa3lD,EAAMqmD,aAC/B5rD,GAASuF,GACTwpD,EAAOrtD,KAAKzH,OAAOkyD,aAAa2C,IAChC3zC,EAAS5V,EAAMwB,UAEd,IAAIxB,EAAMwB,OAASxB,EAAMpJ,OAC1B,MAAM,IAASqH,MAAM,IAA6B,CAAE+B,UAGpDvF,GAASuF,GAGjB,MAAMypD,EAAOzpD,EAAM/F,MAAMe,MAAM4a,EAAQ5V,EAAMwB,OAC7C/G,GAASuF,GAETwpD,EAAOrtD,KAAKstD,GACZ,MAAMC,EAAeF,EAAO70D,KAAK,IAEjC,OADAqL,EAAMmmD,WAAauD,EACZ,KAoJIC,CAAW91D,GAE1B+zD,GAAa,IAAqB/zD,GACvBm0D,GAAan0D,GAGxB+zD,GAAa,IAAwB/zD,GACb,KAAhB4G,GAAS5G,GACF,MAES,KAAhB4G,GAAS5G,GACF,SAEX4G,GAAS5G,GACF,SAGX+zD,GAAa,IAAmB/zD,GACR,KAAhB4G,GAAS5G,GACF,QAES,KAAhB4G,GAAS5G,GACF,SAEX4G,GAAS5G,GACF,SAGX+zD,GAAa,IAAsB/zD,GACX,KAAhB4G,GAAS5G,GACF,SAEX4G,GAAS5G,GACF,SAGX+zD,GAAa,KAAiB/zD,GACN,MAAhB4G,GAAS5G,GACF,SAEX4G,GAAS5G,GACF,SAGX+zD,GAAa,IAAgB/zD,GACrB4G,GAAS5G,IAAM,IAAiBA,EAAEwyD,aAAe,GAC1CwB,GAAWh0D,GAAG,GAElB,MAGX+zD,GAAa,IAAqB/zD,GACV,KAAhB4G,GAAS5G,GACF,SAEX4G,GAAS5G,GACF,SAGX+zD,GAAa,IAAwB/zD,GACb,KAAhB4G,GAAS5G,GACF,SAEX4G,GAAS5G,GACF,SAEX+zD,GAAa,IAAoBqB,GAAY,SAC7CrB,GAAa,IAAsBqB,GAAY,QAC/CrB,GAAa,IAAuBqB,GAAY,SAChDrB,GAAa,IAAqBqB,GAAY,SAC9CrB,GAAa,IAAiBqB,GAAY,QAC1CrB,GAAa,IAAkBqB,GAAY,SAC3CrB,GAAa,IAAkBqB,GAAY,QAC3CrB,GAAa,IAAkBqB,GAAY,SAC3CrB,GAAa,IAAkBqB,GAAY,SAC3CrB,GAAa,IAAqBqB,GAAY,SAC9CrB,GAAa,IAAwBqB,GAAY,QACjDrB,GAAa,IAAyBqB,GAAY,SAClDrB,GAAa,KAAuBqB,GAAY,QAChDrB,GAAa,KAAwBqB,GAAY,SC/7B1C,MAYM/f,GAAoB,CAZY,CACzC,SAASvpC,GACLA,EAAU8F,oBAAoB,IAAmBy4B,IAC7CplC,QAAQzD,IAAI6oC,EAAQ,YAAasoB,IAC1BtoB,OAoBN0rB,GAAuB,CAPW,EACS,GAgC3CC,GAAyB,CAZW,EAGA,EADC,EAEF,EACA,EANF,EAED,GCrCtC,MAAMC,GACT,YAQA1F,EAQAnxD,GACIqJ,KAAK8nD,SAAWA,EAChB9nD,KAAKrJ,KAAOA,GAOb,MAAM,GACT,YAAYZ,EAAMypC,GACdx/B,KAAKjK,KAAOA,EACZiK,KAAKw/B,cAAgBA,EAKrBx/B,KAAKmzB,UAAYj9B,OAAOY,OAAO,MAEnC,YAAY+L,GACR,MAAMqL,EAAO,IAAI,GAAYrL,EAAI9M,KAAM8M,EAAI28B,eACrCrM,EAAYtwB,EAAIswB,UAChBmB,EAAqB,IAAYzU,OACvC,IAAI6pB,EACApnC,EACA4+C,EACAvqD,EACJ,IAAK2L,KAAQ6wB,EACTuW,EAAWvW,EAAU7wB,QAEK,IAAtBonC,EAASvyC,WACTmL,EAAOonC,EAASvyC,UAIhB+pD,OADuB,IAAvBxX,EAASjW,UACFiW,EAASjW,UAIT,YAAUnxB,GAGjB3L,OADkB,IAAlB+yC,EAAS/yC,MAAmB+yC,EAAS/yC,OAAS,IAAYyyD,QACnD1f,EAAS/yC,KAGT29B,EAEXpmB,EAAKilB,UAAU+tB,GAAQ,IAAIsM,GAAalrD,EAAM3L,GAElD,OAAOuX,GAOR,MAAM,GACT,YAAYnY,EAAMs+B,EAAsBG,GACpCx0B,KAAKjK,KAAOA,EACZiK,KAAKq0B,qBAAuBA,EAC5Br0B,KAAKw0B,gBAAkBA,EAOvBx0B,KAAKmzB,UAAYj9B,OAAOY,OAAO,MAQ/BkJ,KAAK0pC,SAAW,KAEpB,YAAY7mC,GACR,MAAMqL,EAAO,IAAI,GAASrL,EAAI9M,KAAM8M,EAAIwxB,qBAAsBxxB,EAAI2xB,iBAC5DrB,EAAYtwB,EAAIswB,UAChBmB,OAAgD,IAA3BzxB,EAAIyxB,oBAAiCzxB,EAAIyxB,qBAAuB,IAAY80B,QACjGvmD,EAAIyxB,mBACJ,IAAYzU,OAClB,IAAI6pB,EACApnC,EACA3L,EAGA82D,EAFAC,GAAa,EACbC,GAAY,EAEhB,IAAKrrD,KAAQ6wB,EAAW,CAcpB,GAbAuW,EAAWvW,EAAU7wB,QAEK,IAAtBonC,EAASvyC,WACTmL,EAAOonC,EAASvyC,UAGhBR,OADkB,IAAlB+yC,EAAS/yC,MAAmB+yC,EAAS/yC,OAAS,IAAYyyD,QACnD1f,EAAS/yC,KAGT29B,EAEXq5B,GAAiC,IAArBjkB,EAAShW,QACrB+5B,EAAev/C,EAAKilB,UAAU7wB,GAAQ,IAAIkrD,GAAalrD,EAAM3L,GACzDg3D,EAAW,CACX,GAAID,EACA,MAAM,IAAIjtD,MAAM,0BAEpBitD,GAAa,EACbx/C,EAAKw7B,SAAW+jB,EAGE,OAAlBv/C,EAAKw7B,WACLx7B,EAAKw7B,SAAW+jB,GAOxB,OAHsB,OAAlBv/C,EAAKw7B,WACLx7B,EAAKw7B,SAAW,IAAI8jB,GAAa,QAASl5B,IAEvCpmB,GAGf,MAAM0/C,GAAgB,IAAIj2D,QAKnB,MAAM,GACT,YAAY0L,GACRrD,KAAK6tD,cAAgB33D,OAAOY,OAAO,MACnCkJ,KAAK8tD,gBAAkB53D,OAAOY,OAAO,MACrCkJ,KAAK+tD,cAAgB73D,OAAOY,OAAO,MAEnCkJ,KAAKqD,UAAYA,EACjB,MAAM2qD,EAAgB3qD,EAAUoF,KAChCzI,KAAK2I,kBAAoBtF,EAAUsF,kBACnC3I,KAAKiuD,sBAAwBD,EAAcrlD,kBAE/C,mBAAmB3J,GACf,IAAImyC,EAAQyc,GAAcv3D,IAAI2I,GAI9B,YAHc,IAAVmyC,GACAyc,GAAc70D,IAAIiG,EAASmyC,EAAQ,IAAI,GAAcnyC,IAElDmyC,EASX,eAAep7C,GACX,IAAI8G,EAASmD,KAAK6tD,cAAc93D,GAChC,QAAe,IAAX8G,EAAmB,CACnB,MAAMgG,EAAM7C,KAAKsoC,KAAK,IAAevyC,GACrCiK,KAAK6tD,cAAc93D,GAAQ8G,EAAiB,OAARgG,EAAe,KAAO,GAAY6G,KAAK7G,GAE/E,OAAOhG,EASX,iBAAiBkrD,GACb,IAAIlrD,EAASmD,KAAK8tD,gBAAgB/F,EAAOjuD,QACzC,QAAe,IAAX+C,EAAmB,CACnB,MAAMgG,EAAM7C,KAAKsoC,KAAK,IAAiByf,EAAOjuD,QAC9CkG,KAAK8tD,gBAAgB/F,EAAOjuD,QAAU+C,EAAiB,OAARgG,EAAe,KAAO,GAAS6G,KAAK7G,GAEvF,OAAOhG,EASX,kBAAkBkrD,EAAQxhD,GACtB,MAAMxQ,EAAOgyD,EAAOlE,QACpB,GAAa,OAAT9tD,EACA,OAAO,KAEX,IAAI8G,EAASmD,KAAK+tD,cAAch4D,GAChC,QAAe,IAAX8G,EAAmB,CAEnB,GADAA,EAASmD,KAAKlJ,OAAO8wD,EAAgB7xD,GACtB,OAAX8G,EAAiB,CACjB,GAAI0J,EACA,OAAO,KAEX,MAAM,IAAI9F,MAAM,4BAA4B1K,KAEhDiK,KAAK+tD,cAAch4D,GAAQ8G,EAE/B,OAAOA,EAEX,KAAKqxD,EAAMn4D,GACP,MAAMgB,EAAMm3D,EAAK/xC,QAAQpmB,GACzB,IAAIkQ,EAAWjG,KAAK2I,kBAAkB5R,GACtC,QAAiB,IAAbkP,IACAA,EAAWjG,KAAKiuD,sBAAsBl3D,QACrB,IAAbkP,GACA,OAAO,KAGf,GAAiB,OAAbA,EACA,OAAO,KAEX,GAAmC,mBAAxBA,EAASc,WAA2B,CAC3C,MAAMD,EAAUb,EAASc,WAAW/G,KAAKqD,WACzC,GAAIyD,QACA,OAAO,KAEX,MAAM8E,EAAa,IAASxP,OAAO8xD,EAAKn4D,KAAM+Q,EAAQ/F,MACtD,YAAmB,IAAf6K,EAGO,KAEJA,EAEX,OAAO,KAEX,OAAOsiD,EAAMn4D,GACT,MAAMgB,EAAMm3D,EAAK/xC,QAAQpmB,GACzB,IAAIkQ,EAAWjG,KAAK2I,kBAAkB5R,GACtC,QAAiB,IAAbkP,IACAA,EAAWjG,KAAKiuD,sBAAsBl3D,QACrB,IAAbkP,GACA,OAAO,KAGf,GAAiB,OAAbA,EACA,OAAO,KAEX,MAAMQ,EAAWR,EAASE,QAAQnG,KAAKqD,UAAWrD,KAAKqD,WACvD,YAAiB,IAAboD,EACO,KAEJA,GC3Qf,wkB,wCCCA,MAAM0nD,EAAa,IAASvgD,IAAI5W,KAAK,KACxBo3D,EAAM,IAAGtoD,gBAAgB,OAAOP,YAAY2E,GAAKA,EAAEzD,SAAS0nD,ICFlE,IAAIE,GACX,SAAWA,GACPA,EAAkBA,EAA6B,UAAI,GAAK,YACxDA,EAAkBA,EAA0B,OAAI,GAAK,SACrDA,EAAkBA,EAA6B,UAAI,GAAK,YACxDA,EAAkBA,EAA8B,WAAI,GAAK,aACzDA,EAAkBA,EAAwB,KAAI,GAAK,OALvD,CAMGA,IAAsBA,EAAoB,KACtC,MAAMC,EAA0B,CACnCn8B,MAAO,EACP0sB,SAAS,EACTpP,SAAU,EACVxjB,YAAY,EACZsiC,UAAU,GAEd,IAAIC,EACAC,EACJ,SAASC,EAASvoD,EAASwoD,GACvBH,EAAWroD,EACXsoD,EAAUE,EAEP,SAASC,IACZ,MAAMt3D,EAAI,IAAIogC,QAAQg3B,GAGtB,OAFAp3D,EAAE6O,QAAUqoD,EACZl3D,EAAEq3D,OAASF,EACJn3D,ECxBJ,MAAMu3D,UAAuBpuD,MAChC,YAAYmrB,GACRoG,MAAM,sBACNhyB,KAAK4rB,KAAOA,GAGpB,IAAIlX,EAAK,EACF,MAAM,EACT,YAAY2d,EAAWy8B,EAAaC,EAAWlQ,EAAS5yB,EAAYsiC,EAAU/vD,GAC1EwB,KAAKqyB,UAAYA,EACjBryB,KAAK8uD,YAAcA,EACnB9uD,KAAK+uD,UAAYA,EACjB/uD,KAAK6+C,QAAUA,EACf7+C,KAAKisB,WAAaA,EAClBjsB,KAAKuuD,SAAWA,EAChBvuD,KAAKxB,SAAWA,EAChBwB,KAAK0U,KAAOA,EACZ1U,KAAKoX,UAAO,EACZpX,KAAKg9B,UAAO,EACZh9B,KAAKmG,aAAU,EACfnG,KAAK2uD,YAAS,EACd3uD,KAAKgvD,aAAU,EACfhvD,KAAKivD,QAAU,UACfjvD,KAAKyvC,SAAWpd,EAAUod,SAE9B,aACI,MAAM5yC,EAASmD,KAAKgvD,QACpB,QAAe,IAAXnyD,EACA,OAAQmD,KAAKivD,SACT,IAAK,UAAW,CACZ,MAAM32B,EAAUt4B,KAAKgvD,QAAUJ,IAG/B,OAFA5uD,KAAKmG,QAAUmyB,EAAQnyB,QACvBnG,KAAK2uD,OAASr2B,EAAQq2B,OACfr2B,EAEX,IAAK,UACD,MAAM,IAAI73B,MAAM,gEACpB,IAAK,YACD,OAAOT,KAAKgvD,QAAUt3B,QAAQvxB,UAClC,IAAK,WACD,OAAOnG,KAAKgvD,QAAUt3B,QAAQi3B,OAAO,IAAIE,EAAe7uD,OAGpE,OAAOnD,EAEX,aACI,OAAOmD,KAAKivD,QAEhB,MACI,GAAqB,YAAjBjvD,KAAKivD,QACL,MAAM,IAAIxuD,MAAM,sBAAsBT,KAAKivD,iBAK/C,MAAMhjC,EAAajsB,KAAKisB,WAClBsiC,EAAWvuD,KAAKuuD,SAChBl8B,EAAYryB,KAAKqyB,UACjB7zB,EAAWwB,KAAKxB,SAChB2H,EAAUnG,KAAKmG,QACfwoD,EAAS3uD,KAAK2uD,OACdG,EAAc9uD,KAAK8uD,YACzBz8B,EAAU+D,OAAOp2B,MACjBA,KAAKivD,QAAU,UACf,IACI,MAAM1mB,EAAM/pC,EAAS6zB,EAAUzkB,MAAQkhD,GACnC9uD,KAAKisB,WACLoG,EAAU68B,oBAAoBlvD,MAI9BA,KAAKivD,QAFAhjC,EAEU,WAGA,iBAEH,IAAZ9lB,GACAA,EAAQoiC,GAGhB,MAAO4mB,GACH,QAAe,IAAXR,EAIA,MAAMQ,EAHNR,EAAOQ,GAMf,QACSnvD,KAAKisB,aACNjsB,KAAK4J,UACD2kD,GACAl8B,EAAU+8B,aAAapvD,QAKvC,SACI,GAAqB,YAAjBA,KAAKivD,QAAuB,CAC5B,MAAM58B,EAAYryB,KAAKqyB,UACjBk8B,EAAWvuD,KAAKuuD,SAChBI,EAAS3uD,KAAK2uD,OAapB,OAZAt8B,EAAU+D,OAAOp2B,MACbqyB,EAAUg9B,SACVh9B,EAAUnG,SAEdlsB,KAAKivD,QAAU,gBACA,IAAXN,GACAA,EAAO,IAAIE,EAAe7uD,OAE9BA,KAAK4J,UACD2kD,GACAl8B,EAAU+8B,aAAapvD,OAEpB,EAEN,QAAqB,YAAjBA,KAAKivD,UAAyBjvD,KAAKisB,cACxCjsB,KAAKisB,YAAa,GACX,GAIf,MAAMqjC,GACF,MAAMn9B,EAAQnyB,KAAK+uD,UAAY/uD,KAAK8uD,YACpC9uD,KAAK8uD,YAAcQ,EACnBtvD,KAAK+uD,UAAYO,EAAOn9B,EACxBnyB,KAAKivD,QAAU,UACfjvD,KAAKmG,aAAU,EACfnG,KAAK2uD,YAAS,EACd3uD,KAAKgvD,aAAU,EAEnB,MAAMM,EAAMn9B,EAAO0sB,EAAS5yB,EAAYztB,GACpCwB,KAAK8uD,YAAcQ,EACnBtvD,KAAK+uD,UAAYO,EAAOn9B,EACxBnyB,KAAK6+C,QAAUA,EACf7+C,KAAKisB,WAAaA,EAClBjsB,KAAKxB,SAAWA,EAChBwB,KAAKivD,QAAU,UAEnB,UACIjvD,KAAKg9B,UAAO,EACZh9B,KAAKoX,UAAO,EACZpX,KAAKxB,cAAW,EAChBwB,KAAKmG,aAAU,EACfnG,KAAK2uD,YAAS,EACd3uD,KAAKgvD,aAAU,GChJhB,MAAM,EACT,YAAYphD,EAAK6hC,EAAU/jB,EAAW6jC,GAClCvvD,KAAK4N,IAAMA,EACX5N,KAAKyvC,SAAWA,EAChBzvC,KAAK0rB,UAAYA,EACjB1rB,KAAKwvD,eAAiB,EACtBxvD,KAAKyvD,oBAAiB,EACtBzvD,KAAK0vD,oBAAiB,EACtB1vD,KAAK2vD,YAAc,EACnB3vD,KAAK4vD,iBAAc,EACnB5vD,KAAK6vD,iBAAc,EACnB7vD,KAAK8vD,YAAc,EACnB9vD,KAAK+vD,iBAAc,EACnB/vD,KAAKgwD,iBAAc,EACnBhwD,KAAKiwD,gBAAiB,EACtBjwD,KAAKkwD,kBAAe,EACpBlwD,KAAKmwD,SAAW,GAChBnwD,KAAKowD,aAAe,EACpBpwD,KAAKqwD,YAAc,EACnBrwD,KAAKswD,0BAA4B,KACjCtwD,KAAKuwD,eAAiBhB,EAAsBz4D,OAAOkJ,MACnDA,KAAKwwD,aAAexwD,KAAKwwD,aAAax5D,KAAKgJ,MAE/C,cACI,OAA+B,IAAxBA,KAAKwvD,gBAA6C,IAArBxvD,KAAK2vD,aAA0C,IAArB3vD,KAAK8vD,YAEvE,QAYI,IAXuC,OAAnC9vD,KAAKswD,4BACLtwD,KAAKswD,0BAA0BpkC,SAC/BlsB,KAAKswD,0BAA4B,MAErCtwD,KAAKiwD,gBAAiB,EAClBjwD,KAAK2vD,YAAc,GACnB3vD,KAAKywD,0BAELzwD,KAAK8vD,YAAc,GACnB9vD,KAAK0wD,0BAEF1wD,KAAKwvD,eAAiB,GACzBxvD,KAAKyvD,eAAe13B,MAqBxB,GAnBI/3B,KAAK2vD,YAAc,GACnB3vD,KAAKywD,0BAELzwD,KAAK8vD,YAAc,GACnB9vD,KAAK0wD,0BAEL1wD,KAAKwvD,eAAiB,EACtBxvD,KAAKwwD,eAEAxwD,KAAK8vD,YAAc,IACpB9vD,KAAKyvC,UAAY,EAEjBzvC,KAAKswD,0BAA4BtwD,KAAK0rB,UAAUilC,aAAa,GAAmBp+B,UAAUvyB,KAAKwwD,cAI/FxwD,KAAKwwD,qBAGa,IAAtBxwD,KAAKkwD,aAAyB,CAC9B,IAAIU,GAAmB,EACnBv5C,EAAMrX,KAAKyvD,eACf,UAAe,IAARp4C,GAAgB,CACnB,IAAKA,EAAI4U,WAAY,CACjB2kC,GAAmB,EACnB,MAEJv5C,EAAMA,EAAID,KAEd,GAAIw5C,EAEA,IADAv5C,EAAMrX,KAAK4vD,iBACI,IAARv4C,GAAgB,CACnB,IAAKA,EAAI4U,WAAY,CACjB2kC,GAAmB,EACnB,MAEJv5C,EAAMA,EAAID,KAGlB,GAAIw5C,EAEA,IADAv5C,EAAMrX,KAAK+vD,iBACI,IAAR14C,GAAgB,CACnB,IAAKA,EAAI4U,WAAY,CACjB2kC,GAAmB,EACnB,MAEJv5C,EAAMA,EAAID,KAGlB,GAAIw5C,EAAkB,CAClB,MAAMt5D,EAAI0I,KAAKkwD,aACflwD,KAAKkwD,kBAAe,EACpB54D,EAAE6O,YAId,SAC2C,OAAnCnG,KAAKswD,4BACLtwD,KAAKswD,0BAA0BpkC,SAC/BlsB,KAAKswD,0BAA4B,MAErCtwD,KAAKuwD,eAAerkC,SACpBlsB,KAAKiwD,gBAAiB,EAE1B,eACQjwD,KAAKwvD,eAAiB,GAAKxvD,KAAK2vD,YAAc,GAAK3vD,KAAK8vD,YAAc,UAC5C,IAAtB9vD,KAAKkwD,eACLlwD,KAAKkwD,aAAetB,WAElB5uD,KAAKkwD,cAGnB,UAAU1xD,EAAU0zB,GAChB,MAAM,MAAEC,EAAK,QAAE0sB,EAAO,WAAE5yB,EAAU,SAAEsiC,GAAa,IAAKD,KAA4Bp8B,GAClF,GAAI2sB,EAAS,CACT,GAAI1sB,EAAQ,EACR,MAAM,IAAI1xB,MAAM,gFAEpB,GAAIwrB,EACA,MAAM,IAAIxrB,MAAM,iEAGxB,GAAIwrB,GAAgC,IAAlBjsB,KAAKyvC,SACnB,MAAM,IAAIhvC,MAAM,4EAEQ,IAAxBT,KAAKwvD,gBACLxvD,KAAKwwD,eAET,MAAMlB,EAAOtvD,KAAK4N,MAClB,IAAIge,EACJ,GAAI2iC,EAAU,CACV,MAAM4B,EAAWnwD,KAAKmwD,SAChBjrD,EAAQlF,KAAKowD,aAAe,EAC9BlrD,GAAS,GACT0mB,EAAOukC,EAASjrD,GAChBirD,EAASjrD,QAAS,EAClBlF,KAAKowD,aAAelrD,EACpB0mB,EAAKilC,MAAMvB,EAAMn9B,EAAO0sB,EAAS5yB,EAAYztB,IAG7CotB,EAAO,IAAI,EAAK5rB,KAAMsvD,EAAMA,EAAOn9B,EAAO0sB,EAAS5yB,EAAYsiC,EAAU/vD,QAI7EotB,EAAO,IAAI,EAAK5rB,KAAMsvD,EAAMA,EAAOn9B,EAAO0sB,EAAS5yB,EAAYsiC,EAAU/vD,GA0B7E,OAxBIqgD,EAC8B,GAA1B7+C,KAAKwvD,iBACLxvD,KAAKyvD,eAAiBzvD,KAAK0vD,eAAiB9jC,EAG5C5rB,KAAK0vD,gBAAkB9jC,EAAKoR,KAAOh9B,KAAK0vD,gBAAgBt4C,KAAOwU,EAGpD,IAAVuG,EACsB,GAAvBnyB,KAAK2vD,cACL3vD,KAAK4vD,YAAc5vD,KAAK6vD,YAAcjkC,EAGtC5rB,KAAK6vD,aAAejkC,EAAKoR,KAAOh9B,KAAK6vD,aAAaz4C,KAAOwU,EAIlC,GAAvB5rB,KAAK8vD,cACL9vD,KAAK+vD,YAAc/vD,KAAKgwD,YAAcpkC,EAGtC5rB,KAAKgwD,aAAepkC,EAAKoR,KAAOh9B,KAAKgwD,aAAa54C,KAAOwU,EAG1DA,EAEX,KAAKA,GACD,GAAoB,YAAhBA,EAAKklC,OACL,MAAM,IAAIrwD,MAAM,gCAEQ,IAAxBT,KAAKwvD,gBACLxvD,KAAKwwD,eAET5kC,EAAKyG,UAAU+D,OAAOxK,GAClBA,EAAKizB,QACL7+C,KAAK+wD,gBAAgBnlC,GAEhBA,EAAKmjC,WAAa/uD,KAAK4N,MAC5B5N,KAAKgxD,aAAaplC,GAGlB5rB,KAAKixD,aAAarlC,GAG1B,OAAOA,GACH,GAAIA,EAAKizB,QAGL,YADA7+C,KAAKkxD,qBAAqBtlC,GAG9B,GAAIA,EAAKmjC,UAAY/uD,KAAK4N,MAGtB,YADA5N,KAAKmxD,kBAAkBvlC,GAI3B,IAAIvU,EAAMrX,KAAKyvD,eACf,UAAe,IAARp4C,GAAgB,CACnB,GAAIA,IAAQuU,EAER,YADA5rB,KAAKkxD,qBAAqBtlC,GAG9BvU,EAAMA,EAAID,KAGd,IADAC,EAAMrX,KAAK4vD,iBACI,IAARv4C,GAAgB,CACnB,GAAIA,IAAQuU,EAER,YADA5rB,KAAKoxD,kBAAkBxlC,GAG3BvU,EAAMA,EAAID,KAGd,IADAC,EAAMrX,KAAK+vD,iBACI,IAAR14C,GAAgB,CACnB,GAAIA,IAAQuU,EAER,YADA5rB,KAAKmxD,kBAAkBvlC,GAG3BvU,EAAMA,EAAID,KAEd,MAAM,IAAI3W,MAAM,SAASmrB,EAAKlX,yBAElC,aAAakX,GACT5rB,KAAKmwD,SAASnwD,KAAKowD,gBAAkBxkC,EAEzC,oBAAoBA,GAChBA,EAAKylC,MAAMrxD,KAAK4N,OACZge,EAAKkjC,cAAgBljC,EAAKmjC,UACC,GAAvB/uD,KAAK2vD,eACL3vD,KAAK4vD,YAAc5vD,KAAK6vD,YAAcjkC,EACtCA,EAAKoR,KAAOpR,EAAKxU,UAAO,IAGxBpX,KAAK6vD,aAAejkC,EAAKoR,KAAOh9B,KAAK6vD,aAAaz4C,KAAOwU,EACzDA,EAAKxU,UAAO,GAIW,GAAvBpX,KAAK8vD,eACL9vD,KAAK+vD,YAAc/vD,KAAKgwD,YAAcpkC,EACtCA,EAAKoR,KAAOpR,EAAKxU,UAAO,IAGxBpX,KAAKgwD,aAAepkC,EAAKoR,KAAOh9B,KAAKgwD,aAAa54C,KAAOwU,EACzDA,EAAKxU,UAAO,GAIxB,OAAOwU,QACe,IAAdA,EAAKxU,OACLwU,EAAKxU,KAAK4lB,KAAOpR,EAAKoR,WAER,IAAdpR,EAAKoR,OACLpR,EAAKoR,KAAK5lB,KAAOwU,EAAKxU,MAG9B,qBAAqBwU,GACb5rB,KAAKyvD,iBAAmB7jC,IACxB5rB,KAAKyvD,eAAiB7jC,EAAKxU,MAE3BpX,KAAK0vD,iBAAmB9jC,IACxB5rB,KAAK0vD,eAAiB9jC,EAAKoR,QAE7Bh9B,KAAKwvD,eACPxvD,KAAKsxD,OAAO1lC,GAEhB,kBAAkBA,GACV5rB,KAAK4vD,cAAgBhkC,IACrB5rB,KAAK4vD,YAAchkC,EAAKxU,MAExBpX,KAAK6vD,cAAgBjkC,IACrB5rB,KAAK6vD,YAAcjkC,EAAKoR,QAE1Bh9B,KAAK2vD,YACP3vD,KAAKsxD,OAAO1lC,GAEhB,kBAAkBA,GACV5rB,KAAK+vD,cAAgBnkC,IACrB5rB,KAAK+vD,YAAcnkC,EAAKxU,MAExBpX,KAAKgwD,cAAgBpkC,IACrB5rB,KAAKgwD,YAAcpkC,EAAKoR,QAE1Bh9B,KAAK8vD,YACP9vD,KAAKsxD,OAAO1lC,GAEhB,gBAAgBA,GACkB,GAA1B5rB,KAAKwvD,iBACLxvD,KAAKyvD,eAAiBzvD,KAAK0vD,eAAiB9jC,EAG5C5rB,KAAK0vD,gBAAkB9jC,EAAKoR,KAAOh9B,KAAK0vD,gBAAgBt4C,KAAOwU,EAGvE,aAAaA,GACkB,GAAvB5rB,KAAK2vD,cACL3vD,KAAK4vD,YAAc5vD,KAAK6vD,YAAcjkC,EAGtC5rB,KAAK6vD,aAAejkC,EAAKoR,KAAOh9B,KAAK6vD,aAAaz4C,KAAOwU,EAGjE,aAAaA,GACkB,GAAvB5rB,KAAK8vD,cACL9vD,KAAK+vD,YAAc/vD,KAAKgwD,YAAcpkC,EAGtC5rB,KAAKgwD,aAAepkC,EAAKoR,KAAOh9B,KAAKgwD,aAAa54C,KAAOwU,EAGjE,0BAEgC,IAAxB5rB,KAAKwvD,gBACLxvD,KAAKyvD,eAAiBzvD,KAAK4vD,YAC3B5vD,KAAK0vD,eAAiB1vD,KAAK6vD,YAC3B7vD,KAAKwvD,eAAiBxvD,KAAK2vD,cAG3B3vD,KAAK0vD,eAAet4C,KAAOpX,KAAK4vD,YAChC5vD,KAAK0vD,eAAiB1vD,KAAK6vD,YAC3B7vD,KAAKwvD,gBAAkBxvD,KAAK2vD,aAEhC3vD,KAAK4vD,iBAAc,EACnB5vD,KAAK6vD,iBAAc,EACnB7vD,KAAK2vD,YAAc,EAEvB,0BACI,MAAML,EAAOtvD,KAAK4N,MAEZmiD,EAAc/vD,KAAK+vD,YACzB,GAAIA,EAAYhB,WAAaO,EAAM,CAC/B,IAAIU,EAAcD,EACd34C,EAAO44C,EAAY54C,KACnB8kB,EAAQ,EACZ,UAAgB,IAAT9kB,GAAmBA,EAAK23C,WAAaO,GACxCU,EAAc54C,EACdA,EAAO44C,EAAY54C,OACjB8kB,EAEsB,IAAxBl8B,KAAKwvD,gBACLxvD,KAAKyvD,eAAiBM,EACtB/vD,KAAK0vD,eAAiBM,EACtBhwD,KAAKwvD,eAAiBtzB,IAGtBl8B,KAAK0vD,eAAet4C,KAAO24C,EAC3B/vD,KAAK0vD,eAAiBM,EACtBhwD,KAAKwvD,gBAAkBtzB,GAE3Bl8B,KAAK+vD,YAAc34C,EACnBpX,KAAK8vD,aAAe5zB,EACK,IAArBl8B,KAAK8vD,cACL9vD,KAAKgwD,iBAAc,IAI/B,eAC2C,OAAnChwD,KAAKswD,4BACLtwD,KAAKswD,0BAA0BpkC,SAC/BlsB,KAAKswD,0BAA4B,MAEhCtwD,KAAKiwD,iBACNjwD,KAAKiwD,gBAAiB,EACtBjwD,KAAKqwD,YAAcrwD,KAAK4N,MACxB5N,KAAKuwD,eAAegB,YClXhC,MAAMC,EAAQ,IAAI75D,QACL85D,EAAa,IAAG3rD,gBAAgB,cAAcR,YACpD,MAAM,EACT,YAAYsI,EAAK8jD,EAAkBC,EAAeC,EAAkBC,EAAmBC,GACnF9xD,KAAK+xD,WAAa,CACd/xD,KAAKgyD,UAAY,IAAK,EAAUpkD,EAAK,EAAmB5N,KAAM0xD,GAC9D1xD,KAAKqhC,OAAS,IAAK,EAAUzzB,EAAK,EAAgB5N,KAAM2xD,GACxD3xD,KAAKiyD,UAAY,IAAK,EAAUrkD,EAAK,EAAmB5N,KAAM4xD,GAC9D5xD,KAAKkyD,WAAa,IAAK,EAAUtkD,EAAK,EAAoB5N,KAAM6xD,GAChE7xD,KAAKmyD,KAAO,IAAK,EAAUvkD,EAAK,EAAc5N,KAAM8xD,IAExD9xD,KAAKoyD,eAAiBpyD,KAAKoyD,eAAep7D,KAAKgJ,MAC/CA,KAAKqyD,gBAAkBryD,KAAKqyD,gBAAgBr7D,KAAKgJ,MACjDA,KAAKsyD,eAAiBtyD,KAAKsyD,eAAet7D,KAAKgJ,MAC/CA,KAAKuyD,oBAAsBvyD,KAAKuyD,oBAAoBv7D,KAAKgJ,MACzDA,KAAKwyD,cAAgBxyD,KAAKwyD,cAAcx7D,KAAKgJ,MAC7CA,KAAKyyD,SAAWzyD,KAAKyyD,SAASz7D,KAAKgJ,MAEvC,WAAWjJ,GACP,OAAOy6D,EAAMn7D,IAAIU,GAErB,WAAWA,EAAK0P,GACZ+qD,EAAMz4D,IAAIhC,EAAK0P,GAEnB,aAAagpC,GACT,OAAOzvC,KAAK+xD,WAAWtiB,GAE3B,MAAMA,GACF,OAAOzvC,KAAK+xD,WAAWtiB,GAAUijB,QAErC,UAAUl0D,EAAU0zB,GAChB,MAAM,MAAEC,EAAK,QAAE0sB,EAAO,SAAEpP,EAAQ,WAAExjB,EAAU,SAAEsiC,GAAa,IAAKD,KAA4Bp8B,GAC5F,OAAOlyB,KAAK+xD,WAAWtiB,GAAUld,UAAU/zB,EAAU,CAAE2zB,QAAO0sB,UAAS5yB,aAAYsiC,aAEvF,oBACI,OAAOvuD,KAAKgyD,UAEhB,qBACI,OAAOhyD,KAAKqhC,OAEhB,oBACI,OAAOrhC,KAAKiyD,UAEhB,yBACI,OAAOjyD,KAAKkyD,WAEhB,mBACI,OAAOlyD,KAAKmyD,KAEhB,iBACI,OAAOnyD,KAAKgyD,UAAUU,QAE1B,kBACI,OAAO1yD,KAAKqhC,OAAOqxB,QAEvB,iBACI,OAAO1yD,KAAKiyD,UAAUS,QAE1B,sBACI,OAAO1yD,KAAKkyD,WAAWQ,QAE3B,gBACI,OAAO1yD,KAAKmyD,KAAKO,QAErB,eAAe1O,EAAS,GACpB,KAAOA,KAAW,SACRhkD,KAAKwyD,sBACLxyD,KAAKuyD,4BACLvyD,KAAKsyD,uBACLtyD,KAAKqyD,wBACLryD,KAAKoyD,iBAGnB,eAAe5zD,EAAU0zB,GACrB,OAAOlyB,KAAKgyD,UAAUz/B,UAAU/zB,EAAU0zB,GAE9C,gBAAgB1zB,EAAU0zB,GACtB,OAAOlyB,KAAKqhC,OAAO9O,UAAU/zB,EAAU0zB,GAE3C,eAAe1zB,EAAU0zB,GACrB,OAAOlyB,KAAKiyD,UAAU1/B,UAAU/zB,EAAU0zB,GAE9C,oBAAoB1zB,EAAU0zB,GAC1B,OAAOlyB,KAAKkyD,WAAW3/B,UAAU/zB,EAAU0zB,GAE/C,cAAc1zB,EAAU0zB,GACpB,OAAOlyB,KAAKmyD,KAAK5/B,UAAU/zB,EAAU0zB,ICzF7C,uG,8BCAA,gDACA,MAAMygC,EAAU,WACZ,QAAsB,IAAXjmB,EACP,OAAOA,EAEX,GAAoB,oBAATkmB,KACP,OAAOA,KAEX,GAAsB,oBAAXzZ,OACP,OAAOA,OAEX,IAGI,OAAO,IAAIv4C,SAAS,cAAb,GAEX,MAAO4I,GAGH,MAAO,IAlBC,GAqBVqpD,EAAmC,oBAAX1Z,aACI,IAApBA,OAAOC,SACf0Z,EAAmC,iBAATF,MACL,MAApBA,KAAKjtD,aACqB,+BAA1BitD,KAAKjtD,YAAY5P,KAClBg9D,OAAiC,IAAZj8C,GACA,MAApBA,EAAQk8C,UACiB,MAAzBl8C,EAAQk8C,SAASt+B,KAElBu+B,EAAO,WACT,IAAIzpD,EAAI6E,EACR,IAAI6kD,EACAC,EACAC,EACAC,EACAC,EACJ,GAAgF,OAA5C,QAA9B9pD,EAAKmpD,EAAQY,mBAAgC,IAAP/pD,OAAgB,EAASA,EAAGoE,KAAc,CAClF,MAAM4lD,EAAeb,EAAQY,YAC7B,OAAO,WACH,OAAOC,EAAa5lD,OAGvB,GAA+E,OAA/C,QAA1BS,EAAKskD,EAAQ77C,eAA4B,IAAPzI,OAAgB,EAASA,EAAG8kD,QAAiB,CACtF,MAAMvlD,EAAM,WACR,OAAQslD,IAAmBG,GAAgB,KAU/C,OARAF,EAASR,EAAQ77C,QAAQq8C,OACzBD,EAAiB,WACb,MAAMO,EAAKN,IACX,OAAe,IAARM,EAAG,GAAWA,EAAG,IAE5BL,EAAiBF,IACjBI,EAAoC,IAA3BX,EAAQ77C,QAAQ48C,SACzBL,EAAeD,EAAiBE,EACzB1lD,EAEN,CACD,MAAMA,EAAM,WACR,OAAO1Q,KAAK0Q,MAAQylD,GAGxB,OADAA,EAAen2D,KAAK0Q,MACbA,GAhCF,GAmCPvW,EAAiBnB,OAAOkB,UAAUC,eAClC+H,EAAalJ,OAAOyV,OAAO,IAC3BgoD,EAAcz9D,OAAOyV,OAAO,IAC5BioD,EAAY,CAOdf,gBAOAC,kBAOAC,aACArmB,OAAQimB,EACRvzD,aACAu0D,cACA3mC,KA9FJ,aA+FIpf,IAAKqlD,EACL57D,iBACA,UACInB,OAAOoH,OAAOu2D,EAAUD,KAGnBC,EAAW,IAAKD,K,uECpGtB,MAAME,EAAyB,IACjChuD,gBAAgB,0BAChBR,Y,kBCHDqF,EAA0C,SAAU1Q,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAQhE,IAAI,EAAwB,MACxB,cACI0J,KAAKswB,YAAc,KAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA0BA,EAAQkB,WAAY,YAAUlB,GAAS,MAGpF,EAAwBrT,EAAW,CAC/B,YAAe,YAChB,GAKH,IAAI,EAAyB,MACzB,cACI3K,KAAKswB,YAAc,KAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA2BA,EAAQkB,WAAY,YAAUlB,GAAS,MAGrF,EAAyBrT,EAAW,CAChC,YAAe,aAChB,GAKH,IAAI,EAAwB,MACxB,cACI3K,KAAKswB,YAAc,KAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA0BA,EAAQkB,WAAY,YAAUlB,GAAS,MAGpF,EAAwBrT,EAAW,CAC/B,YAAe,YAChB,GAKH,IAAI,EAAqB,MACrB,cACI3K,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,MAAMlkB,EAAS,YAAUkkB,GAAS,GAClC,OAAO,IAAI,IAA4BlkB,EAAQkkB,EAAQkB,WAAYplB,KAG3E,EAAqB6Q,EAAW,CAC5B,YAAe,SAChB,GAKH,IAAI,EAAsB,MACtB,cACI3K,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA4B,QAASA,EAAQkB,WAAY,YAAUlB,GAAS,MAG/F,EAAsBrT,EAAW,CAC7B,YAAe,UAChB,GAKH,IAAI,EAAsB,MACtB,cACI3K,KAAKswB,YAAc,GAEvB,QAAQtS,GACJ,OAAO,IAAI,IAA4B,QAASA,EAAQkB,WAAY,YAAUlB,GAAS,MAG/F,EAAsBrT,EAAW,CAC7B,YAAe,UAChB,GAKH,IAAI,EAAoB,MACpB,cACI3K,KAAKswB,YAAc,KAEvB,QAAQtS,GACJ,OAAO,IAAI,KAAsBA,EAAQkB,WAAY,YAAUlB,GAAS,MAGhF,EAAoBrT,EAAW,CAC3B,YAAe,QAChB,GChHI,MAAMg+C,EAAsB,IACtBM,EAAmB,IACnBC,EAAqB,IACrBX,EAAoB,IACpBL,EAA2B,IAC3BiB,EAAa,ICDpB4K,EAA4B79D,OAAOoH,OAAOpH,OAAOY,OAAO,MAAO,CACjE,IAAM,EACN,SAAW,IAETk9D,EAAqB99D,OAAOoH,OAAOpH,OAAOY,OAAO,MAAO,CAC1D,cAAc,EACd,SAAW,IAEf,SAASm9D,EAAkBrQ,GACvB,MAAM/lD,EAAM+lD,EAAStpD,OACrB,IAAIwC,EAAK,EACT,IAAK,IAAItH,EAAI,EAAGA,EAAIqI,IAAOrI,EAEvB,GADAsH,EAAK8mD,EAAS7mD,WAAWvH,GACd,KAAPsH,IACEtH,MAGD,IAAW,KAAPsH,EACL,OAAO,EAEN,GAAW,KAAPA,GAAyD,MAA/B8mD,EAAS7mD,WAAWvH,EAAI,GACvD,OAAO,EAGf,OAAO,EAWX,SAAS0+D,EAAuB/+C,EAAOg/C,GACnC,OAAOh/C,IAAUg/C,EAyDd,MAAM,EACT,YAAY39B,EAAK49B,EAAWC,EAAYC,EAAYC,GAChDv0D,KAAKw2B,IAAMA,EACXx2B,KAAKo0D,UAAYA,EACjBp0D,KAAKq0D,WAAaA,EAClBr0D,KAAKs0D,WAAaA,EAClBt0D,KAAKu0D,sBAAwBA,EAEjC,KAAK7/B,GACD,MAAM8/B,EAAY,IAAItL,EAAmBlpD,KAAKw2B,IAAK9B,GAC7C0/B,EAAYp0D,KAAKo0D,UACjBG,EAAwBv0D,KAAKu0D,sBAC7Br6D,EAAaw6B,EAAKx6B,WACxB,IAAI1E,EAAI,EACR,KAAOA,EAAI0E,EAAWI,QAAQ,CAC1B,MAAM4mD,EAAOhnD,EAAW1E,GAClBi/D,EAAaz0D,KAAKq0D,WAAWvyB,MAAMof,EAAKnrD,KAAMmrD,EAAKzqD,OACzD,IAAqD,IAAjDs9D,EAA0BU,EAAW36D,QACrC,MAAM,IAAI2G,MAAM,gCAAgCg0D,EAAW36D,UAG/D,MAAM4tD,EAAiB0M,EAAUM,kBAAkBD,GAAY,GAC/D,GAAuB,OAAnB/M,GAA0F,IAAjC,KAA7BA,EAAep3B,aAAkD,CAC7F,MAAMqkC,EAAWP,EAAUQ,iBAAiBH,GAC5C,GAAiB,OAAbE,EAEAJ,EAAsBM,UAAUngC,EAAM+/B,GAEtCz0D,KAAK80D,mBACYL,EACAvT,EACAsT,EACAA,OAEhB,IAAIG,EAAStgC,qBACd,MAAM,IAAI5zB,MAAM,yDAIhBT,KAAKqnC,oBACYotB,EACAE,EACAjN,EACA8M,SAKrBD,EAAsBM,UAAUngC,EAAM+/B,GAEtCz0D,KAAK80D,mBACYL,EACAvT,EACAsT,EACAA,KAEnBh/D,EASN,OAPAwK,KAAK+0D,eACoBrgC,EACA8/B,EACAA,EACA,KACA,KACA,MAClBA,EAEX,aAAaQ,EAAgBtgC,EAAM8/B,EAAWL,EAAUc,EAAcC,EAAoB/M,GACtF,OAAQzzB,EAAKknB,UACT,IAAK,MAKD,YAHA57C,KAAKm1D,eACgBH,EACAtgC,GAEzB,IAAK,OACD8/B,EAAU70B,UAAW,EAIZ,MADjBwoB,EAAWzzB,EAAKub,aAAa,kBAEzBkY,EAAW,WAEf,IAAIpyD,EAAO2+B,EAAKub,aAAa,cAChB,OAATl6C,IACAA,EAAO2+B,EAAKknB,SAASl+C,eAEzB,MAAM03D,EAAcp1D,KAAKo0D,UAAUiB,eAAet/D,GAC9B,OAAhBq/D,EAEAjB,EAAW,IAAIjL,EAAmBlpD,KAAKw2B,IAAK9B,IAI5CwgC,EAAqBD,EACrBA,EAAed,EAAW,IAAIxL,EAAoB3oD,KAAKw2B,IAAK9B,EAAM0gC,IAGtEp1D,KAAK+0D,eACoBrgC,EACA8/B,EACAL,EACAc,EACAC,EACA/M,GAGzBnoD,KAAKs1D,eACoB5gC,EACAsgC,EACAR,EACAL,EACAc,EACAC,EACA/M,GACrB8M,IAAiBd,GAAYA,EAASnL,gBACtCt0B,EAAKif,WAAW6G,aAAa2Z,EAAS76C,OAAQob,GAEzCy/B,EAASvL,UACdl0B,EAAK8a,UAAU5zC,IAAI,MAG3B,eAAeo5D,EAAgBtgC,GAC3B,MAAM6gC,EAAS,IAAItM,EAAiBjpD,KAAKw2B,IAAK9B,GAC9CsgC,EAAejc,WAAWl5C,KAAK01D,GAC/B,MAAMr7D,EAAaw6B,EAAKx6B,WACxB,IAAI1E,EAAI,EACR,KAAOA,EAAI0E,EAAWI,QAAQ,CAC1B,MAAM4mD,EAAOhnD,EAAW1E,GACxB,GAAkB,uBAAd0rD,EAAKnrD,KAA+B,CACpC2+B,EAAKqe,gBAAgB,sBACrBwiB,EAAOnkC,kBAAmB,EAC1B,SAEJ,MAAMqjC,EAAaz0D,KAAKq0D,WAAWvyB,MAAMof,EAAKnrD,KAAMmrD,EAAKzqD,OACnDotD,EAAU7jD,KAAKo0D,UAAUM,kBAAkBD,GAAY,GACvDnkC,EAA0B,OAAZuzB,EAAmB,KAA2BA,EAAQvzB,YACpErS,EAAOje,KAAKs0D,WAAWxyB,MAAM2yB,EAAW7Q,SAAUtzB,GAClDhL,EAAK,YAAUmvC,EAAW36D,QAC1BoU,EAAO,IAAI,IAAaoX,EAAI,IAAYzF,QAC9C01C,EAAOh7B,SAAS16B,KAAK,IAAI,IAAcgkD,EAAS31C,EAAM+P,EAAMw2C,EAAW7Q,SAAUt+B,MAC/E9vB,EAENk/B,EAAKif,WAAW6G,aAAa+a,EAAOj8C,OAAQob,GAEhD,eAAeA,EAAMsgC,EAAgBR,EAAWL,EAAUc,EAAcC,EAAoB/M,GAIxF,IAAIqN,EAAgBrB,EAChBsB,OAAqB,EACrBC,OAAoB,EACxB,MAAMx7D,EAAaw6B,EAAKx6B,WACxB,IAAI1E,EAAI,EACR,KAAOA,EAAI0E,EAAWI,QAAQ,CAC1B,MAAM4mD,EAAOhnD,EAAW1E,GAExB,KADEA,GACoC,IAAlCw+D,EAAmB9S,EAAKnrD,MACxB,SAEJ,MAAM0+D,EAAaz0D,KAAKq0D,WAAWvyB,MAAMof,EAAKnrD,KAAMmrD,EAAKzqD,OACnDixD,EAAiB1nD,KAAKo0D,UAAUM,kBAAkBD,GAAY,GACpE,GAAuB,OAAnB/M,GAA0F,IAAjC,KAA7BA,EAAep3B,aAAkD,CAC7F,MAAMqkC,EAAW30D,KAAKo0D,UAAUQ,iBAAiBH,GAChC,OAAbE,GAEA30D,KAAKu0D,sBAAsBM,UAAUngC,EAAM+/B,GAE3Cz0D,KAAK80D,mBACYL,EACAvT,EACAsT,EACAL,IAEZQ,EAAStgC,sBAGdqhC,EAAoBvB,EAAS//B,mBAAqBp0B,KAAK21D,0BACtClB,EACAE,EACAxM,GAGbqN,IAAkBrB,GAClBuB,EAAkBv2B,SAAWg1B,EAC7BqB,EAAgBE,IAGhBA,EAAkBthC,mBAAqBqhC,EACvCC,EAAkBv2B,SAAWs2B,EAAmBt2B,SAChDs2B,EAAmBt2B,SAAWu2B,GAElCD,EAAqBC,GAIrB11D,KAAKqnC,oBACYotB,EACAE,EACAjN,EACAyM,QAKrBn0D,KAAKu0D,sBAAsBM,UAAUngC,EAAM+/B,GAE3Cz0D,KAAK80D,mBACYL,EACAvT,EACAsT,EACAL,GAGzB,GAAqB,UAAjBz/B,EAAKwiB,QAAqB,CAC1B,MAAMxV,EAAOhN,EAAKgN,KACL,aAATA,GAAgC,UAATA,GACvB1hC,KAAK41D,qBAAqBzB,IA5Q1C,SAAoC39B,EAAKg/B,EAAerB,GACpD,MAAM0B,EAAe1B,EAAS/L,aAC9B,IACI0N,EADAltD,EAAU4sD,EAEd,KAAOtB,EAAuBtrD,EAASurD,IAC/BvrD,EAAQu2B,WAAag1B,GAErB0B,EAAaliB,WAAW6G,aAAa5xC,EAAQ0Q,OAAQu8C,GAGvB,aAA1BA,EAAaja,UACbhzC,EAAQw/C,aAAeyN,EAEvBA,EAAaz/B,WAIb0/B,EAAkBltD,EAAQw/C,aAAe5xB,EAAId,iBAC7CogC,EAAgBlb,QAAQ3lB,YAAY4gC,MAIxCC,EAAkBltD,EAAQw/C,aAAe5xB,EAAId,iBAC7CogC,EAAgBlb,QAAQ3lB,YAAYrsB,EAAQ0Q,SAEhDu8C,EAAa9iB,gBAAgBnqC,EAAQm/C,OAAOpE,SAC5C/6C,EAAUA,EAAQu2B,SAqPlB42B,CAA2B/1D,KAAKw2B,IAAKg/B,EAAerB,GACpD,IAAIvjC,EAAU8D,EAAKub,aAAa,YAChB,KAAZrf,GAA+B,OAAZA,GAAqC,OAAjBqkC,GAAyBA,EAAajM,kBAA4C,GAAvBgM,EAAe3gD,OAAoC,KACrJuc,EAAU,WAEd,MAAMolC,EAAY7B,IAAac,EAAeC,EAAqBD,EACnE,GAAgB,OAAZrkC,GAAkC,OAAdolC,EAEpBhB,EAAejc,WAAWl5C,KAAK21D,OAE9B,CAGD,MAAMS,EAAc,IAAI1N,EAAkB33B,GAC1CqlC,EAAYl7D,OAASi6D,EACrBiB,EAAY92B,SAAWq2B,EACvBQ,EAAU1zC,MAAMziB,KAAKo2D,GACoB,MAArCjB,EAAe5gC,oBACf4gC,EAAe5gC,mBAAmB9R,MAAMziB,KAAKo2D,GApQ7D,SAA4Bz/B,EAAKy/B,EAAaT,GAC1C,IAAIU,EACAJ,EAEAI,GADuB,IAAtBV,EAAcnhD,OAA+B,EAClCmhD,EAAcl8C,OAGdk8C,EAAcpN,aAEH,aAAvB8N,EAAUta,SAEVqa,EAAY7N,aAAe8N,GAI3BJ,EAAkBG,EAAY7N,aAAe5xB,EAAId,iBACjDogC,EAAgBlb,QAAQ3lB,YAAYihC,IAsPhCC,CAAmBn2D,KAAKw2B,IAAKy/B,EAAaT,IAIlD,qBAAqBrB,GAEjB,MAAMj6D,EAAai6D,EAASiC,gBAC5B,IAAIC,OAAoB,EACpBC,OAAe,EACf/lC,EAAQ,EACZ,IAAK,IAAI/6B,EAAI,EAAGA,EAAI0E,EAAWI,QAAUi2B,EAAQ,EAAG/6B,IAChD,OAAQ0E,EAAW1E,GAAGuyD,OAAOjuD,QACzB,IAAK,QACL,IAAK,QACL,IAAK,UACDu8D,EAAoB7gE,EACpB+6B,IACA,MACJ,IAAK,UACD+lC,EAAe9gE,EACf+6B,SAIS,IAAjB+lC,QAAiD,IAAtBD,GAAgCC,EAAeD,KACzEn8D,EAAWm8D,GAAoBn8D,EAAWo8D,IAAiB,CAACp8D,EAAWo8D,GAAep8D,EAAWm8D,KAG1G,eAAe3hC,EAAM8/B,EAAWL,EAAUc,EAAcC,EAAoB/M,GACxE,IAAIoO,EAOAC,EACJ,IANID,EADkB,aAAlB7hC,EAAKknB,SACOlnB,EAAKkmB,QAAQ0B,WAGb5nB,EAAK4nB,WAGA,OAAdia,GACH,OAAQA,EAAUhb,UACd,KAAK,EACDib,EAAYD,EAAUjb,YACtBt7C,KAAKy2D,aACoBtC,EACAoC,EACA/B,EACAL,EACAc,EACAC,EACA/M,GACzBoO,EAAYC,EACZ,MACJ,KAAK,EACDD,EAAYv2D,KAAK02D,SACFH,EACApC,GAAU7Y,YACzB,MACJ,KAAK,EACL,KAAK,EACL,KAAK,EACL,KAAK,GACDib,EAAYA,EAAUjb,YACtB,MACJ,KAAK,EACL,KAAK,GACDib,EAAYA,EAAUja,YAItC,SAASqa,EAAUxC,GACf,MAAMnjC,EAAgBhxB,KAAKs0D,WAAWxyB,MAAM60B,EAASC,UAAW,MAChE,GAAsB,OAAlB5lC,EAAwB,CACxB,MAAMukC,EAAS,IAAIpM,EAAWnpD,KAAKw2B,IAAKmgC,EAAU3lC,GAClDmjC,EAASpb,WAAWl5C,KAAK01D,GA3XrC,SAAkCA,GAC9B,MAAM7gC,EAAO6gC,EAAOnN,aACdzU,EAAajf,EAAKif,WACxB,KAA4B,OAArBjf,EAAK4mB,aAAsD,IAA9B5mB,EAAK4mB,YAAYC,UACjD5H,EAAWmI,YAAYpnB,EAAK4mB,aAEhC5mB,EAAK8mB,YAAc,GACnB7H,EAAW7d,aAAay/B,EAAOj8C,OAAQob,GAqX/BmiC,CAAyBtB,GAE7B,IAAIn+C,EAAOu/C,EACX,KAA4B,OAArBv/C,EAAKkkC,aAAsD,IAA9BlkC,EAAKkkC,YAAYC,UACjDnkC,EAAOA,EAAKkkC,YAEhB,OAAOlkC,EAEX,0BAA0Bq9C,EAAYE,EAAUxM,GAC5C,IAAIoN,EACJ,MAAMuB,EAAerC,EAAW7Q,SAC1BC,EAAU7jD,KAAKo0D,UAAUM,kBAAkBD,GAAY,GAG7D,IADqD,IAA7BE,EAASngC,iBAAyC,OAAZqvB,GAAoBoQ,EAAkB6C,GAEhGvB,EAAS,IAAIrN,EAAyBloD,KAAKw2B,IAAKi+B,EAAYE,EAAUxM,GACtEnoD,KAAK+2D,mBAAmBxB,EAAQZ,EAAUmC,OAEzC,CACDvB,EAAS,IAAIrN,EAAyBloD,KAAKw2B,IAAKi+B,EAAYE,EAAUxM,GACtE,MAAM73B,EAA0B,OAAZuzB,EAAmB,KAA2BA,EAAQvzB,YACpErS,EAAOje,KAAKs0D,WAAWxyB,MAAMg1B,EAAcxmC,GACjDilC,EAAOh7B,SAAS16B,KAAK,IAAI,IAAcgkD,EAAS8Q,EAASjrB,SAAUzrB,EAAM64C,EAAcrC,EAAW36D,SAEtG,OAAOy7D,EAEX,oBAAoBd,EAAYE,EAAU9Q,EAASsQ,GAC/C,IAAIoB,EACJ,MAAMuB,EAAerC,EAAW7Q,SAUhC,IADqD,IAA7B+Q,EAASngC,iBAAyC,OAAZqvB,GAAoBoQ,EAAkB6C,GAIhGvB,EAAS,IAAI,IAAsBd,EAAYE,GAC/C30D,KAAK+2D,mBAAmBxB,EAAQZ,EAAUmC,OAEzC,CACDvB,EAAS,IAAI,IAAsBd,EAAYE,GAC/C,MAAMrkC,EAA0B,OAAZuzB,EAAmB,KAA2BA,EAAQvzB,YACpErS,EAAOje,KAAKs0D,WAAWxyB,MAAMg1B,EAAcxmC,GACjDilC,EAAOh7B,SAAS16B,KAAK,IAAI,IAAcgkD,EAAS8Q,EAASjrB,SAAUzrB,EAAM64C,EAAcrC,EAAW36D,SAEtGq6D,EAAS6C,iBAAiBn3D,KAAK01D,GAC/BpB,EAASvL,UAAW,EAExB,mBAAmB2M,EAAQZ,EAAUl+D,GACjC,MAAM08B,EAAYwhC,EAASxhC,UACrB8jC,EAAcxgE,EAAM6D,OAC1B,IAAI48D,OAAW,EACXC,OAAY,EACZrvC,EAAQ,EACRhrB,EAAK,EACT,IAAK,IAAItH,EAAI,EAAGA,EAAIyhE,IAAezhE,EAE/B,GADAsH,EAAKrG,EAAMsG,WAAWvH,GACX,KAAPsH,IACEtH,OAGD,GAAW,KAAPsH,EAAuB,CAG5B,IAFAo6D,EAAWzgE,EAAMiI,MAAMopB,EAAOtyB,GAEvBiB,EAAMsG,aAAavH,IAAM,KAGhC,IADAsyB,EAAQtyB,EACDA,EAAIyhE,IAAezhE,EAEtB,GADAsH,EAAKrG,EAAMsG,WAAWvH,GACX,KAAPsH,IACEtH,OAGD,GAAW,KAAPsH,EAA2B,CAChCq6D,EAAY1gE,EAAMiI,MAAMopB,EAAOtyB,GAC/B,WAGU,IAAd2hE,IAEAA,EAAY1gE,EAAMiI,MAAMopB,IAE5B,MAAM2sC,EAAaz0D,KAAKq0D,WAAWvyB,MAAMo1B,EAAUC,GAC7CC,EAAa,YAAU3C,EAAW36D,QAClC+pD,EAAU7jD,KAAKo0D,UAAUM,kBAAkBD,GAAY,GACvDnkC,EAA0B,OAAZuzB,EAAmB,KAA2BA,EAAQvzB,YACpErS,EAAOje,KAAKs0D,WAAWxyB,MAAMq1B,EAAW7mC,GAC9C,IAAIoZ,EAAWvW,EAAUikC,GAQzB,SAPiBjyD,IAAbukC,IAGAA,EAAWvW,EAAUikC,GAAc,IAAI,IAAaA,EAAY,IAAYv3C,SAEhF01C,EAAOh7B,SAAS16B,KAAK,IAAI,IAAcgkD,EAASna,EAAUzrB,EAAMk5C,EAAWC,IAEpE5hE,EAAIyhE,GAAexgE,EAAMsG,aAAavH,IAAM,KAEnDsyB,EAAQtyB,EACR0hE,OAAW,EACXC,OAAY,GAIxB,mBAAmB1C,EAAYvT,EAAMsT,EAAWL,GAC5C,MAAMtQ,EAAU7jD,KAAKo0D,UAAUM,kBAAkBD,GAAY,GACvDnkC,EAA0B,OAAZuzB,EAAmB,KAA2BA,EAAQvzB,YACpE8mC,EAAa3C,EAAW36D,OACxBg9D,EAAerC,EAAW7Q,SAChC,IAAI3lC,EACJ,GAA4B,IAAxB64C,EAAax8D,SAC4B,GAAvB,GAAdg2B,GAAkH,EAAG,CACzH,MAA0C,GAAvB,GAAdA,GAAkH,GAKnH,OAHArS,EAAOje,KAAKs0D,WAAWxyB,MAAM,YAAUs1B,GAAa9mC,QAOxDrS,EAAOje,KAAKs0D,WAAWxyB,MAAMg1B,EAAcxmC,GAE/C,IAAsB,GAAjB6jC,EAAS9/C,OAAoC,EAAG,CACjD,MAAMq1B,EAAWyqB,EAAShhC,UAAUikC,GACpB,MAAZ1tB,GAGAyqB,EAAS55B,SAAS16B,KAAK,IAAI,IAAcgkD,EAASna,EAAUzrB,EAAM64C,EAAcM,IAChFjD,EAASvL,UAAW,GAEP,MAAR3qC,IAELk2C,EAASiC,gBAAgBv2D,KAAK,IAAI,IAAqB40D,EAAY5Q,EAAS5lC,IAC5Ek2C,EAASvL,UAAW,QAGX,MAAR3qC,GAELk2C,EAASiC,gBAAgBv2D,KAAK,IAAI,IAAqB40D,EAAY5Q,EAAS5lC,IAC5Ek2C,EAASvL,UAAW,GAEfuL,IAAaK,GAGlBL,EAASiC,gBAAgBv2D,KAAK,IAAI,IAAqB40D,EAAY5Q,EAAS5lC,IAEjE,MAAX4lC,GAA2B,MAAR5lC,IAEnBijC,EAAKzqD,MAAQ,KCpjBzB,IAAI,EAA0C,SAAUwD,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5DyU,EAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtGC,EAAoC,SAAUC,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAOpD,MAAMmsD,EAA0B,IAAGvxD,gBAAgB,2BAA2BR,YAC/EgyD,EAAc,GAMpB,IAAI,EAA6B,MAC7B,YAAY9gC,GACRx2B,KAAKw2B,IAAMA,EACXx2B,KAAKm/B,SAAW3I,EAAId,iBAExB,gBAAgBryB,GACZ,OAAO,IAAaY,UAAUozD,EAAyBr3D,MAAMyF,SAASpC,GAE1E,eAAe1F,GACX,GAAqB,iBAAVA,EAAoB,CAC3B,IAAId,EAASy6D,EAAY35D,GACzB,QAAe,IAAXd,EAAmB,CACnB,MAAMsiC,EAAWn/B,KAAKm/B,SACtBA,EAASwZ,UAAYh7C,EACrB,MAAM+2B,EAAOyK,EAASyb,QAAQ2c,kBAGlB,MAAR7iC,GAAkC,aAAlBA,EAAKknB,UAAsD,MAA3BlnB,EAAK8iC,oBACrDx3D,KAAKm/B,SAAWn/B,KAAKw2B,IAAId,iBACzB74B,EAASsiC,IAKTA,EAASyb,QAAQkB,YAAYpnB,GAC7B73B,EAAS63B,GAEb4iC,EAAY35D,GAASd,EAEzB,OAAOA,EAAOq4B,WAAU,GAE5B,GAAuB,aAAnBv3B,EAAMi+C,SAAyB,CAE/B,MAAMzc,EAAWn/B,KAAKw2B,IAAId,iBAE1B,OADAyJ,EAASyb,QAAQ3lB,YAAYt3B,GACtBwhC,EAOX,OAHwB,MAApBxhC,EAAMg2C,YACNh2C,EAAMg2C,WAAWmI,YAAYn+C,GAE1BA,IAGf,EAA6B,EAAW,CACpCsN,EAAQ,EAAG,KACXF,EAAW,oBAAqB,CAAC7U,UAClC,GCxEH,IAMI,EAA0C,SAAUwD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,EAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAS3D,MAAM,EACF,YAAY40B,EAAmB00B,EAAWr1B,GACtCn/B,KAAK8/B,kBAAoBA,EACzB9/B,KAAKw0D,UAAYA,EACjBx0D,KAAKm/B,SAAWA,EAChBn/B,KAAKo/B,aAAe,GACpBp/B,KAAKu/B,WAAa,GAClBv/B,KAAKga,WAAa,GAClBha,KAAKsiB,MAAQ,GAEjB,eACI,MAAMzf,EAAM7C,KAAK8/B,kBACjB,OAAO,IAAwBhpC,OAAO,IAC/B+L,EACHu8B,aAAc,YAAYv8B,EAAIu8B,aAAcp/B,KAAKo/B,cACjDG,WAAY,YAAY18B,EAAI08B,WAAYv/B,KAAKu/B,YAC7CvlB,WAAY,YAAYnX,EAAImX,WAAYha,KAAKga,YAC7CmlB,SAAUn/B,KAAKm/B,SACfG,cAAc,EACdK,SAAU3/B,KAAKw0D,UAAU70B,YASrC,IAAI,EAAmB,MACnB,YAAY74B,EAASutD,EAAYC,EAAYmD,GACzCz3D,KAAK8G,QAAUA,EACf9G,KAAKq0D,WAAaA,EAClBr0D,KAAKs0D,WAAaA,EAClBt0D,KAAKy3D,mBAAqBA,EAE9B,WACI,MAAO,UAEX,gBAAgBp0D,GACZ,OAAO,IAAaY,UAAU,IAAmBjE,MAAMyF,SAASpC,GAEpE,QAAQy8B,EAAmB9gC,GACvB,MAAM4M,EAAa,IAAwB0J,YAAYwqB,GACvD,GAA4B,OAAxBl0B,EAAWuzB,eAA6C,IAAxBvzB,EAAWuzB,SAC3C,OAAOvzB,EAEX,MAAMwoD,EAAY,IAAc9+C,YAAYtW,IACtC,WAAEq1D,EAAU,WAAEC,EAAU,mBAAEmD,EAAkB,QAAE3wD,GAAY9G,KAC1D03D,EAAS,IAAI,EAAe14D,EAAQ3I,IAAI,KAAO+9D,EAAWC,EAAYC,EAAYmD,GAClFt4B,EAAWr4B,EAAQ4uB,eAAe9pB,EAAWuzB,UAC7Cq1B,EAAYkD,EAAO1gE,KAAKmoC,GACxBw4B,EAAc33D,KAAK23D,YAAc,IAAI,EAA6B/rD,EAAY4oD,EAAWr1B,GACzF63B,EAAmBxC,EAAUwC,iBAC7BZ,EAAkB5B,EAAU4B,gBAC5BwB,EAAwBZ,EAAiB18D,OACzCu9D,EAAuBzB,EAAgB97D,OAC7C,GAAIs9D,EAAwBC,EAAuB,EAAG,CAClD,IAAI38B,EAAS,EACb,IAAK,IAAI1lC,EAAI,EAAGoiE,EAAwBpiE,IAAKA,EACzCmiE,EAAYp4B,WAAWrE,GAAUl7B,KAAK83D,uBAAuBd,EAAiBxhE,IAC9E0lC,IAEJ,IAAK,IAAI1lC,EAAI,EAAGA,EAAIqiE,IAAwBriE,EACxCmiE,EAAYp4B,WAAWrE,GAAUl7B,KAAK+3D,sBAAsB3B,EAAgB5gE,IAAI,GAChF0lC,IAGRl7B,KAAKg4D,kBAAkBxD,EAAWmD,EAAYv4B,aAAcu4B,EAAY39C,YACxE,MAAM0qB,EAAqBizB,EAAYM,eAEvC,OADAj4D,KAAK23D,YAAc,KACZjzB,EAEX,kBAAkB3pC,EAAQm9D,EAAiBl+C,GACvC,IAAoB,KAAfjf,EAAOsZ,OAAoC,EAAG,CAC/C,MAAM0kC,EAAah+C,EAAOg+C,WACpBrxC,EAAKqxC,EAAWz+C,OACtB,IAAIi8D,EACJ,IAAK,IAAI/gE,EAAI,EAAGA,EAAIkS,IAAMlS,EAEtB,GADA+gE,EAAYxd,EAAWvjD,IACA,IAAlB+gE,EAAUliD,OAA4B,EACvC6jD,EAAgBr4D,KAAK,CAAC,IAAI,IAAuB02D,EAAUvlC,sBAE1D,IAAuB,GAAlBulC,EAAUliD,OAAiC,EAAG,CACpD,MAAMkmB,EAAWg8B,EAAUh8B,SACrB6E,EAAe,GACrB,IAAIphB,EACJ,MAAMnV,EAAK0xB,EAASjgC,OACpB,IAAK,IAAIgG,EAAI,EAAGA,EAAIuI,IAAMvI,EACtB0d,EAAUuc,EAASj6B,GACnB8+B,EAAa9+B,GAAK,IAAI,IAAsB0d,EAAQkB,WAAYlB,EAAQlkB,QAE5Eo+D,EAAgBr4D,KAAK,CAAC,IAAI,IAAsBu/B,EAAcm3B,EAAUnlC,yBAGxEpxB,KAAKm4D,kBAAkB5B,EAAW2B,EAAiBl+C,IAKnE,qBAAqBu7C,EAAQ2C,EAAiBl+C,GAE1C,MAAMo+C,EAAiBp4D,KAAKq4D,kBAAkB9C,EAAQ,GACtD6C,EAAe,GAAK,IAAI,IAA0B7C,EAAOnzB,IAAKpiC,KAAKs4D,gBAAgB/C,GAASv1D,KAAKu4D,aAAahD,EAAQv7C,IACtHk+C,EAAgBr4D,KAAKu4D,GACrBp4D,KAAKg4D,kBAAkBzC,EAAQ2C,EAAiBl+C,GAEpD,oBAAoBu7C,EAAQ2C,EAAiBl+C,GACzC,MAAM9f,EAAa8F,KAAKq4D,kBAAkB9C,EAAQ,GAC9Cr7D,EAAWI,OAAS,GACpB49D,EAAgBr4D,KAAK3F,GAEzB8F,KAAKg4D,kBAAkBzC,EAAQ2C,EAAiBl+C,GAEpD,kBAAkBu7C,EAAQ2C,EAAiBl+C,GACvC,OAAuB,IAAfu7C,EAAOlhD,OACX,KAAK,GACDrU,KAAKw4D,qBAAqBjD,EAAQ2C,EAAiBl+C,GACnD,MACJ,KAAK,GACDha,KAAKy4D,oBAAoBlD,EAAQ2C,EAAiBl+C,GAClD,MACJ,KAAK,EACDha,KAAK04D,0BAA0BnD,EAAQ2C,EAAiBl+C,IAGpE,0BAA0Bu7C,EAAQ2C,EAAiBl+C,GAC/C,MAAMugB,EAAWv6B,KAAKs4D,gBAAgB/C,GAChCoD,EAA4B,GAC5BC,EAAuB,GAC7B54D,KAAKm4D,kBAAkB5C,EAAOp2B,SAAUw5B,EAA2BC,GACnE,YAAc5+C,EAAY4+C,GAAsB,GAChD,MAAM/1D,EAAM,IAAwB/L,OAAO,CACvCf,KAA0B,OAApBw/D,EAAOpN,SAAoBoN,EAAOnzB,IAAMmzB,EAAOpN,SACrDnuC,WAAY4+C,EACZz5B,SAAUo2B,EAAOnN,aACjBhpB,aAAcu5B,EACdr5B,cAAc,IAElB,IAAIhd,OAAQ,EACZ,IAAoB,MAAfizC,EAAOlhD,OAAgC,EAAG,CAC3CiO,EAAQ,GACR,IAAK,MAAM3I,KAAQ47C,EAAOjzC,MACtBA,EAAM3I,EAAK5jB,MAAQiK,KAAK23D,YAAYr1C,MAAM3I,EAAK5jB,MAGvDmiE,EAAgBr4D,KAAK,CAAC,IAAI,IAA0BgD,EAAK0yD,EAAOnzB,IAAK7H,EAAyB,SAAfg7B,EAAOnzB,IAAgB9f,KAE1G,gBAAgBizC,GACZ,IAAIsD,EACJ,IAAoB,KAAftD,EAAOlhD,OAAkC,EAAG,CAG7C,MAAM,SAAEkmB,GAAag7B,EACf13D,EAAM08B,EAASjgC,OACrBu+D,EAAsB1+D,MAAM0D,GAC5B,IAAIrI,EAAI,EACR,KAAOA,EAAIqI,IAAOrI,EACdqjE,EAAoBrjE,GAAKwK,KAAK84D,eAAev+B,EAAS/kC,SAI1DqjE,EAAsB,IAASz5D,WAEnC,OAAOy5D,EAEX,eAAetD,GACX,OAAuB,OAAnBA,EAAO1R,QAEmB,OAAtB0R,EAAOr2C,WAEA,IAAI,KAAuBq2C,EAAO3R,SAAU2R,EAAO7rB,SAASoe,UAI5D,IAAI,IAAyByN,EAAOr2C,WAAYq2C,EAAO7rB,SAASoe,UAMpEyN,EAAO1R,QAAQxe,QAAQkwB,GAGtC,kBAAkBA,EAAQr6B,GACtB,IAAI69B,EACJ,IAAoB,KAAfxD,EAAOlhD,OAAoC,EAAG,CAE/C,MAAM2iD,EAAmBzB,EAAOyB,iBAC1BZ,EAAkBb,EAAOa,gBACzBwB,EAAwBZ,EAAiB18D,OACzC0+D,EAAwB5C,EAAgB97D,OAC9Cy+D,EAAwB5+D,MAAM+gC,EAAS08B,EAAwBoB,GAC/D,IAAK,IAAIxjE,EAAI,EAAGoiE,EAAwBpiE,IAAKA,EACzCujE,EAAsB79B,GAAUl7B,KAAK83D,uBAAuBd,EAAiBxhE,IAC7E0lC,IAEJ,IAAK,IAAI1lC,EAAI,EAAGwjE,EAAwBxjE,IAAKA,EACzCujE,EAAsB79B,GAAUl7B,KAAK+3D,sBAAsB3B,EAAgB5gE,IAAI,GAC/E0lC,SAIJ69B,EADK79B,EAAS,EACU/gC,MAAM+gC,GAGN,IAAS97B,WAErC,OAAO25D,EAEX,uBAAuBxD,GAEnB,MAAMh7B,EAAWv6B,KAAKs4D,gBAAgB/C,GACtC,OAAO,IAAI,IAA4BA,EAAOnzB,IAAK7H,GAEvD,sBAAsBg7B,EAAQ0D,GAC1B,GAAuB,OAAnB1D,EAAO1R,QAAkB,CACzB,MAAMkE,EAASwN,EAAOxN,OACtB,GAA0B,OAAtBwN,EAAOr2C,WAAqB,CAC5B,MAAM43C,EAAe/O,EAAOnE,SAC5B,GAAIqV,EACA,OAAQlR,EAAOjuD,QACX,IAAK,QACD,OAAO,IAAI,IAA6Bg9D,GAC5C,IAAK,QACD,OAAO,IAAI,IAA6BA,GAMpD,OAAO,IAAI,IAAwBA,EAAc/O,EAAOjuD,QAIxD,OAAO,IAAI,IAAyBy7D,EAAOr2C,WAAY6oC,EAAOjuD,QAKlE,OAAOy7D,EAAO1R,QAAQxe,QAAQkwB,GAWtC,aAAaA,EAAQv7C,GACjB,MAAMsI,EAAQ,GACd,IAAoB,MAAfizC,EAAOlhD,OAAgC,EAAG,CAC3C,MAAM6kD,EAAe3D,EAAOjzC,MACtBzkB,EAAMq7D,EAAa5+D,OACzB,IAAI/C,EAAIyiB,EAAW1f,OACnB,IAAK,IAAI9E,EAAI,EAAGA,EAAIqI,IAAOrI,EAAG,CAC1B,MAAMygE,EAAciD,EAAa1jE,GAC5BwkB,EAAW7K,SAAS8mD,EAAYlgE,QACjCikB,EAAWziB,KAAO0+D,EAAYlgE,MAElC,MAAMojE,EAAiB,GACjBC,EAAsB,GAC5Bp5D,KAAKm4D,kBAAkBlC,EAAY92B,SAAUi6B,EAAqBD,GAGlEn5D,KAAK23D,YAAYr1C,MAAM2zC,EAAYlgE,MAAQusB,EAAM2zC,EAAYlgE,MAAQ,IAAwBe,OAAO,CAChGf,KAAMkgE,EAAYlgE,KAClBikB,WAAYm/C,EACZh6B,SAAU82B,EAAY7N,aACtBhpB,aAAcg6B,EACd95B,cAAc,KAI1B,OAAOhd,IAGf,EAzS8C,SAAUroB,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAqS7C,CAAW,CAC1B,EAAQ,EAAG+gE,GACX,EAAQ,EAAG,KACX,EAAQ,EAAG,KACX,EAAQ,EAAGvD,GACX,EAAW,oBAAqB,CAAC59D,OAAQA,OAAQA,OAAQA,UAC1D,GCxSI,MAQM02C,EAAoB,CARY,EACM,ECN5C,MACH,gBAAgBvpC,GACZ,OAAO,IAAaY,UAAU6vD,EAAwB9zD,MAAMyF,SAASpC,GAEzE,UAAUqxB,EAAM+/B,GACe,SAAvBA,EAAW5Q,SAmFvB,SAA+Bh8B,EAASq5B,GACpC,OAAQr5B,EAAQqvB,SACZ,IAAK,QACD,OAAQrvB,EAAQ6Z,MACZ,IAAK,WACL,IAAK,QACD,MAAuB,YAAhBwf,EAAKpnD,OAChB,QACI,MAAuB,UAAhBonD,EAAKpnD,QAAsC,UAAhBonD,EAAKpnD,OAEnD,IAAK,WACL,IAAK,SACD,MAAuB,UAAhBonD,EAAKpnD,OAChB,QACI,OAAQonD,EAAKpnD,QACT,IAAK,cACL,IAAK,YACD,OAAO+tB,EAAQwxC,aAAa,mBAChC,IAAK,YACL,IAAK,aACD,OAAO,EACX,QACI,OAAO,IAzGkBC,CAAsB5kC,EAAM+/B,KAC7DA,EAAW5Q,QAAU,WAEzB4Q,EAAW36D,OAASkG,KAAK7H,IAAIu8B,EAAKwiB,QAASud,EAAW36D,QAE1D,IAAIo9C,EAASgK,GACT,OAAQhK,GACJ,IAAK,QACD,OAAQgK,GACJ,IAAK,MACD,MAAO,UACX,QACI,OAAOA,EAEnB,IAAK,MACD,OAAQA,GACJ,IAAK,SACD,MAAO,SACX,QACI,OAAOA,EAEnB,IAAK,QACD,OAAQA,GACJ,IAAK,YACD,MAAO,YACX,IAAK,YACD,MAAO,YACX,IAAK,aACD,MAAO,aACX,IAAK,cACD,MAAO,cACX,IAAK,aACD,MAAO,aACX,IAAK,iBACD,MAAO,iBACX,IAAK,aACD,MAAO,aACX,IAAK,YACD,MAAO,YACX,QACI,OAAOA,EAEnB,IAAK,WACD,OAAQA,GACJ,IAAK,YACD,MAAO,YACX,QACI,OAAOA,EAEnB,IAAK,KACL,IAAK,KACD,OAAQA,GACJ,IAAK,UACD,MAAO,UACX,IAAK,UACD,MAAO,UACX,QACI,OAAOA,EAEnB,QACI,OAAQA,GACJ,IAAK,YACD,MAAO,YACX,IAAK,kBACD,MAAO,kBACX,IAAK,WACD,MAAO,WACX,IAAK,cACD,MAAO,cACX,IAAK,YACD,MAAO,YACX,IAAK,YACD,MAAO,YACX,IAAK,aACD,MAAO,aACX,IAAK,WACD,MAAO,WACX,QACI,OAAOA,ODtDlBqM,EAAyB,CAXO,EACI,EACC,EACD,EAEF,EACA,EAFD,G,WEsJvC,SAASgM,EAAmBl2D,EAAWm2D,GAC1C,IAAI9tC,EAAY,IAAUr1B,IAAI,IAASq2C,QAIvC,YAHkB,IAAdhhB,GACA,IAAU3yB,IAAI,IAAS2zC,OAAQhhB,EAAY,IAAI,IAAUroB,EAAUhN,IAAI,KA9KpE,CACH,OAAOg8B,GACH,IAAIonC,GAAY,EACZC,GAAW,EACf,MAAMpiE,EAAIogC,QAAQvxB,UAClB,SAASkmB,IACDqtC,EACAA,GAAW,GAGXD,GAAY,EACZpnC,EAAUhG,SAGlB,MAAO,CACH,UACSotC,IACDC,GAAW,EACXD,GAAY,EAEZniE,EAAEmhC,KAAKpM,KAGf,SACIqtC,GAAW,EACXD,GAAY,MAgChC,SAAmDD,GAC/C,MAAO,CACH,OAAOnnC,GACH,IAAIjhB,GAAU,EACd,SAASib,IACDjb,GAAU,IACVA,GAAU,EACVihB,EAAUhG,SAGlB,MAAO,CACH,SACQjb,GAAU,IACVooD,EAAEG,qBAAqBvoD,GACvBA,GAAU,IAGlB,WACoB,IAAZA,IACAA,EAASooD,EAAEI,sBAAsBvtC,QAkGoEwtC,CAA0CL,GA/IvK,SAA+CA,GAC3C,MAAO,CACH,OAAOnnC,GACH,IAAIjhB,GAAU,EACd,SAASib,IACDjb,GAAU,IACVA,GAAU,EACVihB,EAAUhG,SAGlB,MAAO,CACH,SACQjb,GAAU,IACVooD,EAAEM,aAAa1oD,GACfA,GAAU,IAGlB,WACoB,IAAZA,IACAA,EAASooD,EAAEO,WAAW1tC,EAAO,QA4HsH2tC,CAAsCR,GA3FjN,SAAuDA,GACnD,MAAO,CACH,OAAOnnC,GACH,IAAI4nC,GAAa,EACbC,GAAiB,EACrB,SAAS7tC,IACD6tC,GAAiB,IACjBA,GAAiB,EACjB7nC,EAAUhG,SAGlB,SAAS8tC,IACDF,GAAa,IACbA,GAAa,GACU,IAAnBC,IACAA,EAAgBV,EAAEO,WAAW1tC,EAAO,KAIhD,MAAO,CACH,SACQ4tC,GAAa,IACbT,EAAEG,qBAAqBM,GACvBA,GAAa,GAEbC,GAAiB,IACjBV,EAAEM,aAAaI,GACfA,GAAiB,IAGzB,WACuB,IAAfD,IACAA,EAAYT,EAAEI,sBAAsBO,QA2DyJC,CAA8CZ,GApDnQ,SAAiDA,GAC7C,MAAO,CACH,OAAOnnC,GACH,IAAIjhB,GAAU,EACd,SAASib,IACDjb,GAAU,IACVA,GAAU,EACVihB,EAAUhG,SAGlB,MAAqC,mBAA1BmtC,EAAEa,qBACT,YAAiBb,EAAEa,qBACZ,CACH,SACQjpD,GAAU,IAEVooD,EAAEc,mBAAmBlpD,GACrBA,GAAU,IAGlB,WACoB,IAAZA,IAEAA,EAASooD,EAAEa,oBAAoBhuC,MAMpC,CACH,SACQjb,GAAU,IACVooD,EAAEM,aAAa1oD,GACfA,GAAU,IAGlB,WACoB,IAAZA,IAIAA,EAASooD,EAAEO,WAAW1tC,EAAO,SAW8MkuC,CAAwCf,KAEpS9tC,ECnLX,IAMI,EAA0C,SAAUhyB,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAS1G,IAAI,EAAwB,MACxB,YAAY3H,GACRrD,KAAKqD,UAAYA,EAErB,gBAAgBA,GACZ,OAAO,IAAaY,UAAU,IAAiBjE,MAAMyF,SAASpC,GAElE,WAAWgB,GACP,GAAIrE,KAAKqD,UAAUlK,IAAI,KAAM,GACzB,OAAO6G,KAAKqD,UAAUhN,IAAI,KAE9B,IAAImgC,EAiBJ,OAdQA,OAFOrxB,IAAXd,OACmBc,IAAfd,EAAOmyB,IACDnyB,EAAOmyB,IAEsB,OAA9BnyB,EAAOk9B,KAAKi5B,cACX,IAAI,IAAQrhB,OAAQ90C,EAAOk9B,KAAKi5B,cAAe7gB,KAAMC,QAASC,YAAaC,YAAazB,cAAeE,YAGvG,IAAI,IAAQY,OAAQC,SAAUO,KAAMC,QAASC,YAAaC,YAAazB,cAAeE,YAI1F,IAAI,IAAQY,OAAQC,SAAUO,KAAMC,QAASC,YAAaC,YAAazB,cAAeE,YAEhG,IAAa9xC,SAAS,IAAM+vB,GAAK/wB,SAASzF,KAAKqD,WAC/C,IAAaoD,SAAS,IAAY8yD,EAAmBv5D,KAAKqD,UAAW81C,SAAS1zC,SAASzF,KAAKqD,WACrFmzB,IAGf,EA/C8C,SAAUv8B,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA2CxC,CAAW,CAtCK,SAAU4U,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,IAsCvD,CAAQ,EAAG,KACX,EAAW,oBAAqB,CAAChV,UAClC,GACI,MAKM,EAAoB,CALU,GAa9BukE,EAAkC,CAI3Ch1D,SAASpC,GACE,IACFoC,SAASpC,GACToC,YAAY,GAKrB,kBACI,OAAOzF,KAAKyF,SAAS,IAAGrB,qBC7EhC,kCAIA,MAAM,MAAE+L,EAAK,MAAEG,GAAU,IAASN,YAAY,+BAUjC0qD,EAA8B,CAIvCj1D,SAASpC,IACLo3D,EACKh1D,SAASpC,GACToC,YAAY,OAA8B,OAA4B,OAAyB,KAAkC,GAC/HpC,GAKX,kBACI,OAAOrD,KAAKyF,SAAS,IAAGrB,sB,6BC1BhC,IACMu2D,EADFC,EAEK,WAUL,YAToB,IAATD,IAMTA,EAAOxpC,QAAQgoB,QAAUC,UAAYA,SAASj8B,MAAQg8B,OAAO0hB,OAGxDF,GAIP54B,EAAY,WACd,IAAI44B,EAAO,GACX,OAAO,SAAkB7gE,GACvB,QAA4B,IAAjB6gE,EAAK7gE,GAAyB,CACvC,IAAIghE,EAAc1hB,SAASiF,cAAcvkD,GAEzC,GAAIq/C,OAAO4hB,mBAAqBD,aAAuB3hB,OAAO4hB,kBAC5D,IAGED,EAAcA,EAAYE,gBAAgBpkD,KAC1C,MAAO1F,GAEP4pD,EAAc,KAIlBH,EAAK7gE,GAAUghE,EAGjB,OAAOH,EAAK7gE,IApBA,GAwBZmhE,EAAc,GAElB,SAASC,EAAqBC,GAG5B,IAFA,IAAIt+D,GAAU,EAELrH,EAAI,EAAGA,EAAIylE,EAAY3gE,OAAQ9E,IACtC,GAAIylE,EAAYzlE,GAAG2lE,aAAeA,EAAY,CAC5Ct+D,EAASrH,EACT,MAIJ,OAAOqH,EAGT,SAASu+D,EAAaj3C,EAAMka,GAI1B,IAHA,IAAIg9B,EAAa,GACbC,EAAc,GAET9lE,EAAI,EAAGA,EAAI2uB,EAAK7pB,OAAQ9E,IAAK,CACpC,IAAIkK,EAAOykB,EAAK3uB,GACZkf,EAAK2pB,EAAQk9B,KAAO77D,EAAK,GAAK2+B,EAAQk9B,KAAO77D,EAAK,GAClDw8B,EAAQm/B,EAAW3mD,IAAO,EAC1BymD,EAAa,GAAGrzD,OAAO4M,EAAI,KAAK5M,OAAOo0B,GAC3Cm/B,EAAW3mD,GAAMwnB,EAAQ,EACzB,IAAIh3B,EAAQg2D,EAAqBC,GAC7B5+D,EAAM,CACR4mD,IAAKzjD,EAAK,GACV87D,MAAO97D,EAAK,GACZ+7D,UAAW/7D,EAAK,KAGH,IAAXwF,GACF+1D,EAAY/1D,GAAOw2D,aACnBT,EAAY/1D,GAAOy2D,QAAQp/D,IAE3B0+D,EAAYp7D,KAAK,CACfs7D,WAAYA,EACZQ,QAASC,EAASr/D,EAAK8hC,GACvBq9B,WAAY,IAIhBJ,EAAYz7D,KAAKs7D,GAGnB,OAAOG,EAGT,SAASO,EAAmBx9B,GAC1B,IAAIqR,EAAQ0J,SAAS9jB,cAAc,SAC/Bp7B,EAAamkC,EAAQnkC,YAAc,GAEvC,QAAgC,IAArBA,EAAW4hE,MAAuB,CAC3C,IAAIA,EAAmD,KAEnDA,IACF5hE,EAAW4hE,MAAQA,GAQvB,GAJA5lE,OAAOsD,KAAKU,GAAY2W,SAAQ,SAAU9Z,GACxC24C,EAAMpZ,aAAav/B,EAAKmD,EAAWnD,OAGP,mBAAnBsnC,EAAQ09B,OACjB19B,EAAQ09B,OAAOrsB,OACV,CACL,IAAI51C,EAASioC,EAAU1D,EAAQ09B,QAAU,QAEzC,IAAKjiE,EACH,MAAM,IAAI2G,MAAM,2GAGlB3G,EAAOm7B,YAAYya,GAGrB,OAAOA,EAcT,IACMssB,EADFC,GACED,EAAY,GACT,SAAiB92D,EAAOg3D,GAE7B,OADAF,EAAU92D,GAASg3D,EACZF,EAAU/xD,OAAOknB,SAAS94B,KAAK,QAI1C,SAAS8jE,EAAoBzsB,EAAOxqC,EAAOkxB,EAAQ75B,GACjD,IAAI4mD,EAAM/sB,EAAS,GAAK75B,EAAIi/D,MAAQ,UAAU1zD,OAAOvL,EAAIi/D,MAAO,MAAM1zD,OAAOvL,EAAI4mD,IAAK,KAAO5mD,EAAI4mD,IAIjG,GAAIzT,EAAM0sB,WACR1sB,EAAM0sB,WAAWvmB,QAAUomB,EAAY/2D,EAAOi+C,OACzC,CACL,IAAIkZ,EAAUjjB,SAASzjB,eAAewtB,GAClCpK,EAAarJ,EAAMqJ,WAEnBA,EAAW7zC,IACbwqC,EAAMoM,YAAY/C,EAAW7zC,IAG3B6zC,EAAWz+C,OACbo1C,EAAM5Z,aAAaumC,EAAStjB,EAAW7zC,IAEvCwqC,EAAMza,YAAYonC,IAKxB,SAASC,EAAW5sB,EAAOrR,EAAS9hC,GAClC,IAAI4mD,EAAM5mD,EAAI4mD,IACVqY,EAAQj/D,EAAIi/D,MACZC,EAAYl/D,EAAIk/D,UAepB,GAbID,EACF9rB,EAAMpZ,aAAa,QAASklC,GAE5B9rB,EAAMqD,gBAAgB,SAGpB0oB,GAAac,OACfpZ,GAAO,uDAAuDr7C,OAAOy0D,KAAKC,SAASC,mBAAmBC,KAAKC,UAAUlB,MAAe,QAMlI/rB,EAAM0sB,WACR1sB,EAAM0sB,WAAWvmB,QAAUsN,MACtB,CACL,KAAOzT,EAAM4M,YACX5M,EAAMoM,YAAYpM,EAAM4M,YAG1B5M,EAAMza,YAAYmkB,SAASzjB,eAAewtB,KAI9C,IAAIl/C,EAAY,KACZ24D,EAAmB,EAEvB,SAAShB,EAASr/D,EAAK8hC,GACrB,IAAIqR,EACAmtB,EACAzmC,EAEJ,GAAIiI,EAAQp6B,UAAW,CACrB,IAAI64D,EAAaF,IACjBltB,EAAQzrC,IAAcA,EAAY43D,EAAmBx9B,IACrDw+B,EAASV,EAAoBnlE,KAAK,KAAM04C,EAAOotB,GAAY,GAC3D1mC,EAAS+lC,EAAoBnlE,KAAK,KAAM04C,EAAOotB,GAAY,QAE3DptB,EAAQmsB,EAAmBx9B,GAC3Bw+B,EAASP,EAAWtlE,KAAK,KAAM04C,EAAOrR,GAEtCjI,EAAS,YAxFb,SAA4BsZ,GAE1B,GAAyB,OAArBA,EAAMiE,WACR,OAAO,EAGTjE,EAAMiE,WAAWmI,YAAYpM,GAmFzBqtB,CAAmBrtB,IAKvB,OADAmtB,EAAOtgE,GACA,SAAqBygE,GAC1B,GAAIA,EAAQ,CACV,GAAIA,EAAO7Z,MAAQ5mD,EAAI4mD,KAAO6Z,EAAOxB,QAAUj/D,EAAIi/D,OAASwB,EAAOvB,YAAcl/D,EAAIk/D,UACnF,OAGFoB,EAAOtgE,EAAMygE,QAEb5mC,KAKN7gC,EAAOD,QAAU,SAAU6uB,EAAMka,IAC/BA,EAAUA,GAAW,IAGRp6B,WAA0C,kBAAtBo6B,EAAQp6B,YACvCo6B,EAAQp6B,UAAY22D,KAItB,IAAIqC,EAAkB7B,EADtBj3C,EAAOA,GAAQ,GAC0Bka,GACzC,OAAO,SAAgB6+B,GAGrB,GAFAA,EAAUA,GAAW,GAE2B,mBAA5ChnE,OAAOkB,UAAUkB,SAAS3C,KAAKunE,GAAnC,CAIA,IAAK,IAAI1nE,EAAI,EAAGA,EAAIynE,EAAgB3iE,OAAQ9E,IAAK,CAC/C,IACI0P,EAAQg2D,EADK+B,EAAgBznE,IAEjCylE,EAAY/1D,GAAOw2D,aAKrB,IAFA,IAAIyB,EAAqB/B,EAAa8B,EAAS7+B,GAEtC++B,EAAK,EAAGA,EAAKH,EAAgB3iE,OAAQ8iE,IAAM,CAClD,IAEIC,EAASnC,EAFK+B,EAAgBG,IAIK,IAAnCnC,EAAYoC,GAAQ3B,aACtBT,EAAYoC,GAAQ1B,UAEpBV,EAAYrpD,OAAOyrD,EAAQ,IAI/BJ,EAAkBE,M,6BClQtB5nE,EAAOD,QAAU,SAAUgoE,GACzB,IAAIn5C,EAAO,GAuDX,OArDAA,EAAK7rB,SAAW,WACd,OAAO0H,KAAK7H,KAAI,SAAUuH,GACxB,IAAIk7C,EAsDV,SAAgCl7C,EAAM49D,GACpC,IAAI1iB,EAAUl7C,EAAK,IAAM,GAErB69D,EAAa79D,EAAK,GAEtB,IAAK69D,EACH,OAAO3iB,EAGT,GAAI0iB,GAAgC,mBAATf,KAAqB,CAC9C,IAAIiB,GAWW/B,EAXe8B,EAa5BE,EAASlB,KAAKC,SAASC,mBAAmBC,KAAKC,UAAUlB,MACzDxqD,EAAO,+DAA+DnJ,OAAO21D,GAC1E,OAAO31D,OAAOmJ,EAAM,QAdrBysD,EAAaH,EAAWI,QAAQxlE,KAAI,SAAUyL,GAChD,MAAO,iBAAiBkE,OAAOy1D,EAAWK,YAAc,IAAI91D,OAAOlE,EAAQ,UAE7E,MAAO,CAACg3C,GAAS9yC,OAAO41D,GAAY51D,OAAO,CAAC01D,IAAgBnlE,KAAK,MAOrE,IAAmBojE,EAEbgC,EACAxsD,EAPJ,MAAO,CAAC2pC,GAASviD,KAAK,MAvEJwlE,CAAuBn+D,EAAM49D,GAE3C,OAAI59D,EAAK,GACA,UAAUoI,OAAOpI,EAAK,GAAI,MAAMoI,OAAO8yC,EAAS,KAGlDA,KACNviD,KAAK,KAKV8rB,EAAK3uB,EAAI,SAAUE,EAASooE,EAAYC,GACf,iBAAZroE,IAETA,EAAU,CAAC,CAAC,KAAMA,EAAS,MAG7B,IAAIsoE,EAAyB,GAE7B,GAAID,EACF,IAAK,IAAIvoE,EAAI,EAAGA,EAAIwK,KAAK1F,OAAQ9E,IAAK,CAEpC,IAAIkf,EAAK1U,KAAKxK,GAAG,GAEP,MAANkf,IACFspD,EAAuBtpD,IAAM,GAKnC,IAAK,IAAI0oD,EAAK,EAAGA,EAAK1nE,EAAQ4E,OAAQ8iE,IAAM,CAC1C,IAAI19D,EAAO,GAAGoI,OAAOpS,EAAQ0nE,IAEzBW,GAAUC,EAAuBt+D,EAAK,MAKtCo+D,IACGp+D,EAAK,GAGRA,EAAK,GAAK,GAAGoI,OAAOg2D,EAAY,SAASh2D,OAAOpI,EAAK,IAFrDA,EAAK,GAAKo+D,GAMd35C,EAAKtkB,KAAKH,MAIPykB,I,+CC9DG,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KACA,KACA,KACA,KACA,KACA,KACA,KCjBL,IAmCP,SAAS85C,EAAsBx8D,GAC3B,MAAMyM,EAAOgwD,EAAWz8D,GACxB,YAAgB0D,IAAT+I,EAAqBA,EAEhC,SAAsCzM,GAClC,MAAO,CACHD,MAAO,EACP+L,QAAS,yCAAyC9L,MALnB08D,CAA6B18D,GAQpE,MAAMy8D,EAAa,CACfE,EAAG,CACC58D,MAAO,EACP+L,QAAS,mCAEb8wD,EAAG,CACC78D,MAAO,EACP+L,QAAS,sCAEb+wD,EAAG,CACC98D,MAAO,EACP+L,QAAS,uCAEbgxD,EAAG,CACC/8D,MAAO,EACP+L,QAAS,gFAEbixD,EAAG,CACCh9D,MAAO,EACP+L,QAAS,gCAEbkxD,EAAG,CACCj9D,MAAO,EACP+L,QAAS,kHAEbmxD,EAAG,CACCl9D,MAAO,EACP+L,QAAS,wCAEboxD,EAAG,CACCn9D,MAAO,EACP+L,QAAS,yIAEbqxD,EAAG,CACCp9D,MAAO,EACP+L,QAAS,+CAEbsxD,EAAG,CACCr9D,MAAO,EACP+L,QAAS,4IAEbuxD,GAAI,CACAt9D,MAAO,EACP+L,QAAS,mHAEbwxD,GAAI,CACAv9D,MAAO,EACP+L,QAAS,qIAEbyxD,GAAI,CACAx9D,MAAO,EACP+L,QAAS,4BAEb0xD,GAAI,CACAz9D,MAAO,EACP+L,QAAS,gCAEb2xD,GAAI,CACA19D,MAAO,EACP+L,QAAS,4BAEb4xD,GAAI,CACA39D,MAAO,EACP+L,QAAS,8DAEb6xD,GAAI,CACA59D,MAAO,EACP+L,QAAS,oEAEb8xD,GAAI,CACA79D,MAAO,EACP+L,QAAS,8CAEb+xD,GAAI,CACA99D,MAAO,EACP+L,QAAS,2CAEbgyD,GAAI,CACA/9D,MAAO,EACP+L,QAAS,qGAEbiyD,GAAI,CACAh+D,MAAO,EACP+L,QAAS,+EAEbkyD,GAAI,CACAj+D,MAAO,EACP+L,QAAS,kFAEbmyD,GAAI,CACAl+D,MAAO,EACP+L,QAAS,8DAEboyD,GAAI,CACAn+D,MAAO,EACP+L,QAAS,8DAEbqyD,IAAK,CACDp+D,MAAO,EACP+L,QAAS,gCAEbsyD,IAAK,CACDr+D,MAAO,EACP+L,QAAS,qBAEbuyD,IAAK,CACDt+D,MAAO,EACP+L,QAAS,sDAEbwyD,IAAK,CACDv+D,MAAO,EACP+L,QAAS,8BAEbyyD,IAAK,CACDx+D,MAAO,EACP+L,QAAS,iCAEb0yD,IAAK,CACDz+D,MAAO,EACP+L,QAAS,wBAEb2yD,IAAK,CACD1+D,MAAO,EACP+L,QAAS,wDAEb4yD,IAAK,CACD3+D,MAAO,EACP+L,QAAS,iEAEb6yD,IAAK,CACD5+D,MAAO,EACP+L,QAAS,yCAEb8yD,IAAK,CACD7+D,MAAO,EACP+L,QAAS,iCAEb+yD,IAAK,CACD9+D,MAAO,EACP+L,QAAS,2BAEbgzD,IAAK,CACD/+D,MAAO,EACP+L,QAAS,yBAEbizD,IAAK,CACDh/D,MAAO,EACP+L,QAAS,mDAEbkzD,IAAK,CACDj/D,MAAO,EACP+L,QAAS,2BAEbmzD,IAAK,CACDl/D,MAAO,EACP+L,QAAS,mDAEbozD,IAAK,CACDn/D,MAAO,EACP+L,QAAS,wDAEbqzD,IAAK,CACDp/D,MAAO,EACP+L,QAAS,yCAEbszD,IAAK,CACDr/D,MAAO,EACP+L,QAAS,yCAEbuzD,IAAM,CACFt/D,MAAO,EACP+L,QAAS,kCAEbwzD,KAAM,CACFv/D,MAAO,EACP+L,QAAS,sCAEbyzD,KAAM,CACFx/D,MAAO,EACP+L,QAAS,oCAEb0zD,KAAM,CACFz/D,MAAO,EACP+L,QAAS,kDAEb2zD,KAAM,CACF1/D,MAAO,EACP+L,QAAS,2CAEb4zD,KAAM,CACF3/D,MAAO,EACP+L,QAAS,6DAEb6zD,IAAO,CACH5/D,MAAO,EACP+L,QAAS,OCvPX+L,EAAS,CACXtX,QAAS,SACTC,WAAY,OACZP,OAAQ,IAAStC,WACjB6Q,OAAQ,EACR+sB,KAAM,KACN5lB,KAAM,MAEV,MAAMiqD,EACF,YAAYr/D,EAASC,EAAYP,GAC7B1B,KAAKgC,QAAUA,EACfhC,KAAKiC,WAAaA,EAClBjC,KAAK0B,OAASA,EACd1B,KAAKgC,QAAUA,EACfhC,KAAKiC,WAAaA,EAClBjC,KAAKiQ,MAAQoxD,EAAUC,MAAMhnE,OAC7B0F,KAAK0B,OAASA,EACd1B,KAAKoX,KAAOkC,EACZtZ,KAAKg9B,KAAOqkC,EAAUxqD,KACtBwqD,EAAUxqD,KAAKO,KAAOpX,KACtBqhE,EAAUxqD,KAAO7W,KACjBqhE,EAAUC,MAAMzhE,KAAKG,MAEzB,eACI,IAAI4I,EAAUy4D,EAAUzqD,KACpBQ,EAAO,KACX,KAAkB,MAAXxO,GACHwO,EAAOxO,EAAQwO,KACfxO,EAAQwO,KAAO,KACfxO,EAAQo0B,KAAO,KACfp0B,EAAQlH,OAAS,KACjBkH,EAAUwO,EAEdiqD,EAAUzqD,KAAO0C,EACjB+nD,EAAUxqD,KAAOyC,EACjB+nD,EAAUC,MAAQ,GAEtB,aAAat/D,EAASC,EAAYP,GAC9B,OAAO,IAAI2/D,EAAUr/D,EAASC,EAAYP,GAE9C,eACI,OAAO2/D,EAAUC,MAAM33D,OAG/B03D,EAAUzqD,KAAO0C,EACjB+nD,EAAUxqD,KAAOyC,EACjB+nD,EAAUC,MAAQ,GAEX,IADA,MA0EDC,EAAiB,CACnBC,WAAW,EACXxjD,SAAS,EACTyjD,aAAa,EACbz4B,cAAc,EACd04B,UAAU,EACVC,IAAI,EACJhrD,WAAW,EACXirD,KAAK,GAYT,MAAM,EAAW1rE,OAAOkB,UAAUkB,SAClC,SAASupE,EAAU3zD,EAAM1Y,EAAI,GACzB,OAAmB,MAAf0Y,EAAKxM,QAAkBwM,EAAKxM,OAAOpH,OAAS9E,EAiW7C,SAAiC6e,GACpC,MAAMytD,EAAY,GACN,QAARztD,GACAytD,EAAUjiE,KAAK,gBAEP,SAARwU,GACAytD,EAAUjiE,KAAK,wBAEP,GAARwU,GACAytD,EAAUjiE,KAAK,wBAEP,GAARwU,GACAytD,EAAUjiE,KAAK,0BAEP,GAARwU,GACAytD,EAAUjiE,KAAK,kBAEP,IAARwU,GACAytD,EAAUjiE,KAAK,iBAEP,IAARwU,GACAytD,EAAUjiE,KAAK,YAEP,KAARwU,GACAytD,EAAUjiE,KAAK,iBAEP,KAARwU,GACAytD,EAAUjiE,KAAK,gBAEP,KAARwU,GACAytD,EAAUjiE,KAAK,YAEP,KAARwU,GACAytD,EAAUjiE,KAAK,cAEP,MAARwU,GACAytD,EAAUjiE,KAAK,cAEP,MAARwU,GACAytD,EAAUjiE,KAAK,cAEP,MAARwU,GACAytD,EAAUjiE,KAAK,aAEP,OAARwU,GACAytD,EAAUjiE,KAAK,gBAEP,OAARwU,GACAytD,EAAUjiE,KAAK,qBAEP,QAARwU,GACAytD,EAAUjiE,KAAK,2BAEP,SAARwU,GACAytD,EAAUjiE,KAAK,6BAEP,EAARwU,GACAytD,EAAUjiE,KAAK,wBAEP,EAARwU,GACAytD,EAAUjiE,KAAK,iBAEP,WAARwU,GACAytD,EAAUjiE,KAAK,uBAEnB,GAAyB,IAArBiiE,EAAUxnE,OACV,MAAO,OAEX,OAAOwnE,EAAUzpE,KAAK,KApaX0pE,CAAwB7zD,EAAKxM,OAAOlM,IAExC,OAEX,SAASwsE,EAAUzlE,GACf,IAAIxG,EAqBJ,OAnBIA,OADQoP,IAAR5I,EACO,YAEM,OAARA,EACE,YAEkB4I,IAApB5I,EAAIoJ,YACLpJ,EAAIoJ,YAAYs8D,YACT,aAAa1lE,EAAIoJ,YAAYs8D,YAAYlsE,SAGzCwG,EAAIoJ,YAAY5P,KAGP,iBAARwG,EACL,IAAIA,KAGJ,EAAS5G,KAAK4G,GAElBxG,EAEX,SAASmsE,EAASh0D,EAAM1Y,EAAI,GACxB,OAAmB,MAAf0Y,EAAKxM,QAAkBwM,EAAKxM,OAAOpH,OAAS9E,EACrCwsE,EAAU9zD,EAAKxM,OAAOlM,IAE1B,YAEX,SAAS2sE,EAAUj0D,EAAM1Y,EAAI,GACzB,IAAI4sE,EACJ,GAAmB,MAAfl0D,EAAKxM,QAAkBwM,EAAKxM,OAAOpH,OAAS9E,EAAG,CAC/C,MAAM4oB,EAASlQ,EAAKxM,OAAOlM,GAO3B,OALI4sE,EADU,MAAVhkD,GAA2C,MAAzBA,EAAOtE,eACbkoD,EAAU5jD,EAAOtE,gBAGjB,YAET,SAASsoD,KAEpB,MAAO,YAEX,SAASC,EAAQn0D,EAAM1Y,EAAI,GACvB,GAAmB,MAAf0Y,EAAKxM,QAAkBwM,EAAKxM,OAAOpH,OAAS9E,EAAG,CAC/C,MAAM8sE,EAAOp0D,EAAKxM,OAAOlM,GACzB,MAAoB,iBAAT8sE,EACA,IAAIA,UAEFn9D,IAATm9D,GAAsB9lE,QAAQrD,IAAImpE,EAAM,gBACjCA,EAAmB,aAEvBN,EAAUM,GAErB,MAAO,YAEX,SAASC,EAAUr0D,EAAM1Y,EAAI,GACzB,GAAmB,MAAf0Y,EAAKxM,QAAkBwM,EAAKxM,OAAOpH,OAAS9E,EAAG,CAC/C,MAAM8sE,EAAOp0D,EAAKxM,OAAOlM,GACzB,MAAoB,iBAAT8sE,EACA,IAAIA,KAERA,EAAKhqE,WAEhB,MAAO,YAEX,MAAMkqE,EAAyB,CAC3BC,SAASv0D,GACE2zD,EAAU3zD,GAErBmzB,OAAOnzB,GACI,GAAG2zD,EAAU3zD,sBAAyBg0D,EAASh0D,EAAM,KAEhEm1B,WAAWn1B,GACA,GAAGg0D,EAASh0D,MAASg0D,EAASh0D,EAAM,KAE/Cw0D,aAAax0D,GACF,GAAGg0D,EAASh0D,MAASg0D,EAASh0D,EAAM,MAG7Cy0D,EAAuB,CACzBlkD,MAAMvQ,GACK2zD,EAAU3zD,GAErBwQ,QAAQxQ,GACG2zD,EAAU3zD,GAErBmR,QAAQnR,GACG2zD,EAAU3zD,GAGrB,YAAYA,GACR,OAAQA,EAAKlM,SACT,IAAK,gBACL,IAAK,cACL,IAAK,cACD,OAAO6/D,EAAU3zD,GACrB,IAAK,iBACL,IAAK,mBACD,MAAO,GAAG2zD,EAAU3zD,MAASg0D,EAASh0D,EAAM,MAAMq0D,EAAUr0D,EAAM,KACtE,IAAK,gBACD,OAAOg0D,EAASh0D,GACpB,IAAK,4BACL,IAAK,qBACD,MAAO,GAAGg0D,EAASh0D,EAAM,MAAMq0D,EAAUr0D,EAAM,KACnD,IAAK,oBACL,IAAK,mBACD,MAAO,GAAGg0D,EAASh0D,MAASq0D,EAAUr0D,EAAM,KAChD,QACI,MAAO,KAGnB00D,WAAW10D,GACA2zD,EAAU3zD,GAErB20D,aAAa30D,GACF2zD,EAAU3zD,GAErB40D,wBAAwB50D,GACb,GAAG2zD,EAAU3zD,MAASg0D,EAASh0D,EAAM,MAAMq0D,EAAUr0D,EAAM,KAEtE,eAAeA,GACX,OAAQA,EAAKjM,YACT,IAAK,MACD,MAAO,GAAGkgE,EAAUj0D,MAASq0D,EAAUr0D,EAAM,MAAMq0D,EAAUr0D,EAAM,MAAM2zD,EAAU3zD,EAAM,KAC7F,IAAK,eACD,OAAO2zD,EAAU3zD,GACrB,QACI,MAAO,YAGnB,MAAMA,GACF,OAAQA,EAAKjM,YACT,IAAK,SACD,MAAO,GAAG4/D,EAAU3zD,MAASg0D,EAASh0D,EAAM,MAAMg0D,EAASh0D,EAAM,KACrE,IAAK,eACD,MAAO,GAAG2zD,EAAU3zD,MAASg0D,EAASh0D,EAAM,KAChD,IAAK,aACD,MAAO,GAAG2zD,EAAU3zD,MAASi0D,EAAUj0D,EAAM,MAAMg0D,EAASh0D,EAAM,KACtE,QACI,MAAO,YAGnB,gBAAgBA,GACZ,OAAQA,EAAKjM,YACT,IAAK,SACD,MAAO,GAAG4/D,EAAU3zD,MAASg0D,EAASh0D,EAAM,MAAMg0D,EAASh0D,EAAM,KACrE,IAAK,eACD,MAAO,GACX,QACI,MAAO,aAIjB60D,EAA2B,CAC7B,WAAW70D,GACP,MAAMwkB,EAAQ,GACd,OAAQxkB,EAAKlM,SACT,IAAK,WACD,OAAQkM,EAAKxM,OAAO,GAAIggC,KAC5B,IAAK,cACD,GAAmB,MAAfxzB,EAAKxM,OACL,IAAK,IAAIlM,EAAI,EAAGkS,EAAKwG,EAAKxM,OAAOpH,OAAQ9E,EAAIkS,IAAMlS,EAC/Ck9B,EAAM7yB,KAAKqiE,EAASh0D,EAAM1Y,IAGlC,OAAOk9B,EAAMr6B,KAAK,KACtB,QACI,MAAO,YAGnB,SAAS6V,GACL,IAAI80D,EACJ,MAAMvsE,EAAQyX,EAAKxM,OAAO,GAC1B,cAAejL,GACX,IAAK,YACDusE,EAAY,YACZ,MACJ,IAAK,SAEGA,EADU,OAAVvsE,EACY,OAGAurE,EAAUvrE,GAE1B,MACJ,IAAK,SACDusE,EAAY,IAAIvsE,KAChB,MACJ,IAAK,SACDusE,EAAYvsE,EAAM6B,WAClB,MACJ,QACI0qE,EAAYhB,EAAUvrE,GAE9B,MAAO,GAAGusE,KAAanB,EAAU3zD,EAAM,MAE3Cme,MAAMne,GACK2zD,EAAU3zD,GAErB0G,aAAa1G,GACF,GAAGq0D,EAAUr0D,MAASq0D,EAAUr0D,EAAM,MAAM2zD,EAAU3zD,EAAM,KAEvEq0C,UAAUr0C,GACCi0D,EAAUj0D,IAGnB+0D,EAAyB,CAC3BC,QAAQh1D,GACG2zD,EAAU3zD,GAErBi1D,QAAQj1D,GACG2zD,EAAU3zD,GAErBk1D,OAAOl1D,GACI2zD,EAAU3zD,GAErB6oB,KAAK7oB,GACM,SAAUA,EAAKxM,OAAO,GAAI85C,gBAErC9hB,QAAQxrB,GACG2zD,EAAU3zD,IAGnBm1D,EAAwB,CAC1BC,OAAOp1D,GACI2zD,EAAU3zD,GAErBq1D,SAASr1D,GACE2zD,EAAU3zD,GAErBk7B,QAAQl7B,GACGg0D,EAASh0D,GAEpBm7B,KAAKn7B,GACMg0D,EAASh0D,IAGlBs1D,EAAkB,CACpBx8D,UAAUkH,GACCg0D,EAASh0D,GAEpB,UAAUA,GACN,MAAMwkB,EAAQ,GACd,OAAQxkB,EAAKjM,YACT,IAAK,MACL,IAAK,SACD,OAAOogE,EAAQn0D,GACnB,IAAK,WACD,GAAmB,MAAfA,EAAKxM,OACL,IAAK,IAAIlM,EAAI,EAAGkS,EAAKwG,EAAKxM,OAAOpH,OAAQ9E,EAAIkS,IAAMlS,EAC/Ck9B,EAAM7yB,KAAKwiE,EAAQn0D,EAAM1Y,IAGjC,OAAOk9B,EAAMr6B,KAAK,KACtB,IAAK,cACD,MAAO,GACX,QACI,MAAO,aAIjBorE,EAAyB,CAC3B,UAAUv1D,GACN,OAAQA,EAAKjM,WAAWvD,MAAM,EAAG,IAC7B,IAAK,MACD,MAAO,GACX,IAAK,MACD,OAAOwjE,EAASh0D,GACpB,IAAK,MACL,IAAK,MACD,OAAO2zD,EAAU3zD,GACrB,QACI,MAAO,YAGnB,uBAAuBA,GACnB,OAAQA,EAAKjM,YACT,IAAK,UACD,MAAO,cACX,IAAK,OACD,MAAO,eAAe4/D,EAAU3zD,EAAM,KAC1C,IAAK,cACD,MAAO,GACX,QACI,MAAO,YAGnB,uBAAuBA,GACnB,OAAQA,EAAKjM,YACT,IAAK,UACL,IAAK,aACD,OAAOigE,EAASh0D,GACpB,IAAK,WACD,MAAO,GAAGq0D,EAAUr0D,EAAM,KAC9B,QACI,MAAO,aAIjBw1D,EAAmB,CACrBC,eAAez1D,GACJ,K,8BCpcf,4EAKA,SAAS01D,IACL,MAAMC,EAAK,IAAIl3B,EAWf,OAVAk3B,EAAGp+D,SAAS,UAEW,IAAZqR,GAAkCA,EAAQgtD,IAQ9CD,EAEJ,MAAMl3B,UAAgB,IACzB,YAAYtpC,EAAY,IAAGe,mBACvB4tB,MAAM3uB,GAEV,aAAaoF,GACT,OAAOm7D,IAAgB97C,MAAMrf,GAEjC,WAAWpE,GACP,OAAOu/D,IAAgBG,IAAI1/D,GAE/B,mBAAmB3C,GACf,OAAOkiE,IAAgBn+D,YAAY/D,GAEvC,IAAI2C,GACA,GAAI,IAAcsa,OAAOta,GAAS,CAE9B,MAAMuH,EAAa,IAAci6B,cAAcxhC,GAC/C,IAAIk9B,EAAO6X,SAASiF,cAAczyC,EAAW7V,MAM7C,OALa,OAATwrC,IAGAA,EAAO6X,SAASkF,MAEbtsB,MAAM+xC,IAAI,CACbxiC,KAAMA,EACNc,UAAWh+B,IAGnB,OAAO2tB,MAAM+xC,IAAI1/D,O,gCC9CzB,IAOI2/D,EACAC,EARAntD,EAAUvhB,EAAOD,QAAU,GAU/B,SAAS4uE,IACL,MAAM,IAAIzjE,MAAM,mCAEpB,SAAS0jE,IACL,MAAM,IAAI1jE,MAAM,qCAsBpB,SAAS2jE,EAAWj6D,GAChB,GAAI65D,IAAqBjK,WAErB,OAAOA,WAAW5vD,EAAK,GAG3B,IAAK65D,IAAqBE,IAAqBF,IAAqBjK,WAEhE,OADAiK,EAAmBjK,WACZA,WAAW5vD,EAAK,GAE3B,IAEI,OAAO65D,EAAiB75D,EAAK,GAC/B,MAAM+G,GACJ,IAEI,OAAO8yD,EAAiBruE,KAAK,KAAMwU,EAAK,GAC1C,MAAM+G,GAEJ,OAAO8yD,EAAiBruE,KAAKqK,KAAMmK,EAAK,MAvCnD,WACG,IAEQ65D,EADsB,mBAAfjK,WACYA,WAEAmK,EAEzB,MAAOhzD,GACL8yD,EAAmBE,EAEvB,IAEQD,EADwB,mBAAjBnK,aACcA,aAEAqK,EAE3B,MAAOjzD,GACL+yD,EAAqBE,GAjB7B,GAwEA,IAEIE,EAFAzrD,EAAQ,GACR0rD,GAAW,EAEXC,GAAc,EAElB,SAASC,IACAF,GAAaD,IAGlBC,GAAW,EACPD,EAAa/pE,OACbse,EAAQyrD,EAAav8D,OAAO8Q,GAE5B2rD,GAAc,EAEd3rD,EAAMte,QACNmqE,KAIR,SAASA,IACL,IAAIH,EAAJ,CAGA,IAAII,EAAUN,EAAWI,GACzBF,GAAW,EAGX,IADA,IAAIzmE,EAAM+a,EAAMte,OACVuD,GAAK,CAGP,IAFAwmE,EAAezrD,EACfA,EAAQ,KACC2rD,EAAa1mE,GACdwmE,GACAA,EAAaE,GAAYxsC,MAGjCwsC,GAAc,EACd1mE,EAAM+a,EAAMte,OAEhB+pE,EAAe,KACfC,GAAW,EAnEf,SAAyBhrD,GACrB,GAAI2qD,IAAuBnK,aAEvB,OAAOA,aAAaxgD,GAGxB,IAAK2qD,IAAuBE,IAAwBF,IAAuBnK,aAEvE,OADAmK,EAAqBnK,aACdA,aAAaxgD,GAExB,IAEW2qD,EAAmB3qD,GAC5B,MAAOpI,GACL,IAEI,OAAO+yD,EAAmBtuE,KAAK,KAAM2jB,GACvC,MAAOpI,GAGL,OAAO+yD,EAAmBtuE,KAAKqK,KAAMsZ,KAgD7CqrD,CAAgBD,IAiBpB,SAASE,EAAKz6D,EAAK/J,GACfJ,KAAKmK,IAAMA,EACXnK,KAAKI,MAAQA,EAYjB,SAAS4sB,KA5BTlW,EAAQ+tD,SAAW,SAAU16D,GACzB,IAAIrS,EAAO,IAAIqC,MAAM0Q,UAAUvQ,OAAS,GACxC,GAAIuQ,UAAUvQ,OAAS,EACnB,IAAK,IAAI9E,EAAI,EAAGA,EAAIqV,UAAUvQ,OAAQ9E,IAClCsC,EAAKtC,EAAI,GAAKqV,UAAUrV,GAGhCojB,EAAM/Y,KAAK,IAAI+kE,EAAKz6D,EAAKrS,IACJ,IAAjB8gB,EAAMte,QAAiBgqE,GACvBF,EAAWK,IASnBG,EAAKxtE,UAAU2gC,IAAM,WACjB/3B,KAAKmK,IAAI+L,MAAM,KAAMlW,KAAKI,QAE9B0W,EAAQguD,MAAQ,UAChBhuD,EAAQiuD,SAAU,EAClBjuD,EAAQgtD,IAAM,GACdhtD,EAAQkuD,KAAO,GACfluD,EAAQ+F,QAAU,GAClB/F,EAAQk8C,SAAW,GAInBl8C,EAAQmuD,GAAKj4C,EACblW,EAAQouD,YAAcl4C,EACtBlW,EAAQquD,KAAOn4C,EACflW,EAAQsuD,IAAMp4C,EACdlW,EAAQuuD,eAAiBr4C,EACzBlW,EAAQwuD,mBAAqBt4C,EAC7BlW,EAAQ1H,KAAO4d,EACflW,EAAQyuD,gBAAkBv4C,EAC1BlW,EAAQ0uD,oBAAsBx4C,EAE9BlW,EAAQ2D,UAAY,SAAU1kB,GAAQ,MAAO,IAE7C+gB,EAAQkH,QAAU,SAAUjoB,GACxB,MAAM,IAAI0K,MAAM,qCAGpBqW,EAAQ2uD,IAAM,WAAc,MAAO,KACnC3uD,EAAQ4uD,MAAQ,SAAUC,GACtB,MAAM,IAAIllE,MAAM,mCAEpBqW,EAAQ8uD,MAAQ,WAAa,OAAO,I,gBCvLpC,IAAIC,EAAM,EAAQ,GACFjrB,EAAU,EAAQ,IAIC,iBAFvBA,EAAUA,EAAQhkD,WAAagkD,EAAQwO,QAAUxO,KAG/CA,EAAU,CAAC,CAACrlD,EAAOC,EAAIolD,EAAS,MAG9C,IAAIvc,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBynC,GAFSD,EAAIjrB,EAASvc,GAEXuc,EAAQmrB,OAASnrB,EAAQmrB,OAAS,IAIjDxwE,EAAOD,QAAUwwE,G,gBCpBjB,IAAID,EAAM,EAAQ,GACFjrB,EAAU,EAAQ,IAIC,iBAFvBA,EAAUA,EAAQhkD,WAAagkD,EAAQwO,QAAUxO,KAG/CA,EAAU,CAAC,CAACrlD,EAAOC,EAAIolD,EAAS,MAG9C,IAAIvc,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBynC,GAFSD,EAAIjrB,EAASvc,GAEXuc,EAAQmrB,OAASnrB,EAAQmrB,OAAS,IAIjDxwE,EAAOD,QAAUwwE,G,gBCpBjB,IAAID,EAAM,EAAQ,GACFjrB,EAAU,EAAQ,IAIC,iBAFvBA,EAAUA,EAAQhkD,WAAagkD,EAAQwO,QAAUxO,KAG/CA,EAAU,CAAC,CAACrlD,EAAOC,EAAIolD,EAAS,MAG9C,IAAIvc,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBynC,GAFSD,EAAIjrB,EAASvc,GAEXuc,EAAQmrB,OAASnrB,EAAQmrB,OAAS,IAIjDxwE,EAAOD,QAAUwwE,G,gBCpBjB,IAAID,EAAM,EAAQ,GACFjrB,EAAU,EAAQ,IAIC,iBAFvBA,EAAUA,EAAQhkD,WAAagkD,EAAQwO,QAAUxO,KAG/CA,EAAU,CAAC,CAACrlD,EAAOC,EAAIolD,EAAS,MAG9C,IAAIvc,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBynC,GAFSD,EAAIjrB,EAASvc,GAEXuc,EAAQmrB,OAASnrB,EAAQmrB,OAAS,IAIjDxwE,EAAOD,QAAUwwE,G,cCpBjB,IAAIE,EAGJA,EAAI,WACH,OAAOhmE,KADJ,GAIJ,IAECgmE,EAAIA,GAAK,IAAIplE,SAAS,cAAb,GACR,MAAOsQ,GAEc,iBAAXioC,SAAqB6sB,EAAI7sB,QAOrC5jD,EAAOD,QAAU0wE,G,iBCjBjB1wE,EADkC,EAAQ,EAChC2wE,EAA4B,IAE9BpmE,KAAK,CAACtK,EAAOC,EAAI,+dAAge,KAEzfD,EAAOD,QAAUA,G,iBCJjBA,EADkC,EAAQ,EAChC2wE,EAA4B,IAE9BpmE,KAAK,CAACtK,EAAOC,EAAI,ygFAA0gF,KAEniFF,EAAQywE,OAAS,CAChB,eAAgB,0BAChB,SAAY,yBACZ,SAAY,0BACZ,KAAQ,0BACR,KAAQ,0BACR,OAAU,0BACV,oBAAqB,0BACrB,kBAAmB,0BACnB,UAAW,0BACX,mBAAoB,0BACpB,WAAY,0BACZ,WAAY,0BACZ,WAAY,2BAEbxwE,EAAOD,QAAUA,G,iBCnBjBA,EADkC,EAAQ,EAChC2wE,EAA4B,IAE9BpmE,KAAK,CAACtK,EAAOC,EAAI,ilEAAslE,KAE/mEF,EAAQywE,OAAS,CAChB,OAAU,0BACV,KAAQ,0BACR,KAAQ,wBACR,eAAgB,wBAChB,MAAS,0BACT,QAAW,wBACX,qBAAsB,0BACtB,OAAU,0BACV,KAAQ,2BAETxwE,EAAOD,QAAUA,G,iBCfjBA,EADkC,EAAQ,EAChC2wE,EAA4B,IAE9BpmE,KAAK,CAACtK,EAAOC,EAAI,6cAA8c,KAEveF,EAAQywE,OAAS,CAChB,kCAAmC,0BACnC,kCAAmC,0BACnC,MAAS,wBACT,MAAS,wBACT,OAAU,0BACV,KAAQ,2BAETxwE,EAAOD,QAAUA,G,wlCCbV,MAAM4wE,EACF,EADEA,EAEI,EAFJA,EAGI,EAHJA,EAID,EAENC,EAAqB,CACvBC,WAAY,EACZC,SAAU,IACV5iE,SAAUyiE,GAKP,MAAM,EAIT,YAAYI,GAER,GADAtmE,KAAKsmE,YAAc,IAAKH,UAAwChhE,IAAhBmhE,EAA4BA,EAAc,IACtFtmE,KAAKsmE,YAAY7iE,WAAayiE,GAC9BlmE,KAAKsmE,YAAYD,UAAY,IAC7B,MAAM,IAAI5lE,MAAM,uGASxB,QAAQ8wD,GAOJ,OANKA,EAAQ+U,cACT/U,EAAQ+U,YAAc,IAAKtmE,KAAKsmE,aAChC/U,EAAQ+U,YAAYC,QAAU,GAGlChV,EAAQ+U,YAAYE,aAAejV,EAAQ1tD,QACpC0tD,EAQX,SAASkV,EAAUlV,GAGf,OADA/0D,QAAQuZ,eAAew7C,EAAS,eACzBkV,EAWX,cAAc9kE,EAAO4vD,EAASmV,GAC1B,MAAM,YAAEJ,GAAgB/U,GAClB,aAAEiV,GAAiBF,EACzB,OAAO5uC,QAAQvxB,UAAUsyB,KAAK,KAC1B,GAAI6tC,EAAYC,QAAUD,EAAYF,WAAY,CAC9C,MAAMvpE,OAAiCsI,IAAxBmhE,EAAYK,SAAwBL,EAAYK,QAAQhlE,EAAO4vD,GAC9E,OAAO75B,QAAQvxB,QAAQtJ,GAAQ47B,KAAKkuC,IAChC,GAAIA,EAAS,CACTL,EAAYC,UACZ,MAAMp0C,EAyB9B,SAAwBm0C,GACpB,MAAM,SAAED,EAAQ,SAAE5iE,EAAQ,kBAAEmjE,EAAiB,kBAAEC,EAAiB,QAAEN,GAAYD,EAC9E,GAA0B,mBAAf,EACP,OAAOA,EAAY7iE,SAAS8iE,GAEhC,OAAQ9iE,GACJ,KAAK,EACD,OAAOqjE,EAAgBZ,GAAqBG,GAChD,KAAK,EACD,OAAOS,EAAgBZ,GAA2BK,EAASF,GAC/D,KAAK,EACD,OAAOS,EAAgBZ,GAA2BK,EAASF,GAC/D,KAAK,EACD,OAAOS,EAAgBZ,GAAsBK,EAASF,EAAUO,EAAmBC,GACvF,QACI,MAAM,IAAIpmE,MAAM,gCAxCUsmE,CAAeT,GAC7B,OAAO,IAAI5uC,QAASvxB,GAAY,IAAIgzC,OAAO4gB,WAAW5zD,EAAUqsB,MAAML,GAAiB,EAARA,IAC1EsG,KAAK,KACN,MAAMuuC,EAAaR,EAAa3iE,QAChC,MAAyC,mBAA7ByiE,EAAuB,YACxBA,EAAYW,YAAYD,EAAYN,GAExCM,IAENvuC,KAAKuuC,IACN,MAAME,EAAmB,IAAKF,EAAYV,eAC1C,OAAOI,EAAW5rB,MAAMosB,KAKhC,MADA1qE,QAAQuZ,eAAew7C,EAAS,eAC1B5vD,IAKd,MADAnF,QAAQuZ,eAAew7C,EAAS,eAC1B5vD,KAsBlB,MAAMmlE,EAAkB,CAEpBT,GAAYA,EAEZ,CAACc,EAAYd,IAAaA,EAAWc,EAErC,CAACA,EAAYd,IAA4B,IAAfc,EAAmBd,EAAWA,GAAYc,EAAa,IAEjF,CAACA,EAAYd,EAAUO,EAAoB,EAAGC,EAAoB,MACvD3+C,KAAKk/C,UAAYP,EAAoBD,GAAqBA,GCtHlE,MAAM,EACT,cAII5mE,KAAKqnE,QAAU,GAOfrnE,KAAKsnE,SAAW,GAIhBtnE,KAAKunE,aAAe,GASxB,YAAYF,GAER,OADArnE,KAAKqnE,QAAUA,EACRrnE,KASX,aAAasnE,GAET,OADAtnE,KAAKsnE,SAAWA,EACTtnE,KAaX,gBAAgBke,GAEZ,OADAle,KAAKunE,aAAa1nE,KAAKqe,GAChBle,KASX,2BAGI,OADA9J,OAAOoH,OAAO0C,KAAKsnE,SADI,CAAEE,YAAa,eACOxnE,KAAKsnE,UAC3CtnE,KAAKynE,uBAahB,uBACI,OAAOznE,KAAK0nE,gBAAgB,CAAEjB,SAAUkB,IAE5C,UAAUtjE,GACN,MAAM6Z,EAAc,IAAI,EAAiB7Z,GACzC,OAAOrE,KAAK0nE,gBAAgBxpD,IAGpC,SAASypD,EAAclB,GACnB,IAAKA,EAASmB,GACV,MAAMnB,EAEV,OAAOA,E,WCxFP17D,EAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAS1G,MAAM68D,EAAoB,+BAI1B,IAAI,EAAa,MAIb,YAAYrxC,GAER,GADAx2B,KAAKw2B,IAAMA,OACcrxB,IAArBqxB,EAAI2iB,OAAO2B,MACX,MAAM,IAAIr6C,MAAM,2KAEpBT,KAAKw2B,IAAMA,EACXx2B,KAAK8nE,mBAAqB,EAC1B9nE,KAAK+nE,cAAe,EACpB/nE,KAAKgoE,cAAe,EACpBhoE,KAAKqnE,QAAU,GACfrnE,KAAKsnE,SAAW,KAChBtnE,KAAKunE,aAAe,GAUxB,UAAUljE,GACN,IAAI4jE,EACJ,GAAsB,iBAAX5jE,EAAqB,CAE5B4jE,EADiC,CAAEX,SAAUjjE,OAG5C,IAAsB,mBAAXA,EAWZ,MAAM,IAAI5D,MAAM,kBAXmB,CACnCwnE,EAAmB,IAAI,EACvBA,EAAiBZ,QAAUrnE,KAAKqnE,QAChCY,EAAiBX,SAAW,IAAKtnE,KAAKsnE,UACtCW,EAAiBV,aAAevnE,KAAKunE,aACrC,MAAM1xE,EAAIwO,EAAO4jE,GACb/xE,OAAOkB,UAAU8wE,cAAcvyE,KAAK,EAAwByB,UAAWvB,KACvEoyE,EAAmBpyE,IAM3B,MAAMyxE,EAAWW,EAAiBX,SAClC,QAAiBniE,IAAbmiE,GAA0BpxE,OAAOkB,UAAU8wE,cAAcvyE,KAAKwyE,QAAQ/wE,UAAWkwE,EAASc,SAG1F,MAAM,IAAI3nE,MAAM,2CAEpB,MAAM8mE,EAAeU,EAAiBV,aACtC,QAAqBpiE,IAAjBoiE,GAA8BA,EAAajtE,OAAQ,CAEnD,GAAIitE,EAAat9D,OAAOC,GAAKhU,OAAOkB,UAAU8wE,cAAcvyE,KAAK,EAAiByB,UAAW8S,IAAI5P,OAAS,EACtG,MAAM,IAAImG,MAAM,yCAEpB,MAAM4nE,EAAwBd,EAAa71B,UAAUxnC,GAAKhU,OAAOkB,UAAU8wE,cAAcvyE,KAAK,EAAiByB,UAAW8S,IAC1H,GAAIm+D,GAAyB,GAAKA,IAA0Bd,EAAajtE,OAAS,EAC9E,MAAM,IAAImG,MAAM,+DAOxB,OAJAT,KAAKqnE,QAAUY,EAAiBZ,QAChCrnE,KAAKsnE,SAAWA,EAChBtnE,KAAKunE,kBAAiDpiE,IAAlC8iE,EAAiBV,aAA6BU,EAAiBV,aAAe,GAClGvnE,KAAKgoE,cAAe,EACbhoE,KAgBX,MAAMrC,EAAOk9C,GACT76C,KAAKsoE,oBACL,IAAI/W,EAAUvxD,KAAKuoE,aAAa5qE,EAAOk9C,GACvC,OAAO76C,KAAKwoE,eAAejX,EAASvxD,KAAKunE,cAAc9uC,KAAK57B,IACxD,IAAI4pE,EACJ,GAAIvwE,OAAOkB,UAAU8wE,cAAcvyE,KAAK8yE,SAASrxE,UAAWyF,GACxD4pE,EAAW/uC,QAAQvxB,QAAQtJ,OAE1B,KAAI3G,OAAOkB,UAAU8wE,cAAcvyE,KAAK+yE,QAAQtxE,UAAWyF,GAK5D,MAAM,IAAI4D,MAAM,8GAA8G5D,MAJ9H00D,EAAU10D,EACV4pE,EAAW3rB,MAAMyW,GAKrB,OAAOvxD,KAAK2oE,gBAAgBlC,EAAUzmE,KAAKunE,aAAchW,KAExD94B,KAAK57B,GACF3G,OAAOkB,UAAU8wE,cAAcvyE,KAAK+yE,QAAQtxE,UAAWyF,GAChDmD,KAAK86C,MAAMj+C,GAEfA,GAEN47B,KAAK57B,IACNmD,KAAK4oE,kBACE/rE,GACR8E,IAEC,MADA3B,KAAK4oE,kBACCjnE,IAGd,aAAahE,EAAOk9C,GAChB,MAAMysB,EAA6B,OAAlBtnE,KAAKsnE,SAAoBtnE,KAAKsnE,SAAW,GAC1D,IAAI/V,EACAjT,EACAuqB,EACJ,MAAMC,EA4Id,SAA2BV,GACvB,MAAMW,EAAgB,GAChBC,OAAuB7jE,IAAZijE,EAAwBA,EAAU,GACnD,IAAK,MAAMryE,KAAQizE,EACX9yE,OAAOkB,UAAUC,eAAe1B,KAAKqzE,EAAUjzE,KAC/CgzE,EAAchzE,GAAmC,mBAAnBizE,EAASjzE,GACjCizE,EAASjzE,KACTizE,EAASjzE,IAGvB,OAAOgzE,EAtJ0BE,CAAkB3B,EAASc,SACxD,GAAIlyE,OAAOkB,UAAU8wE,cAAcvyE,KAAK+yE,QAAQtxE,UAAWuG,GACvD4zD,EAAU5zD,EACVkrE,EAAqB,IAAIV,QAAQ5W,EAAQ6W,SAAS/xE,IAAI,oBAErD,CACIwkD,IACDA,EAAO,IAEXyD,EAAOzD,EAAKyD,KACZ,MAAM4qB,OAAmB/jE,IAATm5C,EAAqB,CAAEA,KAAMA,GAAS,KAChD6qB,EAAc,IAAK7B,EAAUc,QAAS,MAAOvtB,KAASquB,GAC5DL,EAAqB,IAAIV,QAAQgB,EAAYf,SAAS/xE,IAAI,gBAC1Dk7D,EAAU,IAAImX,QA2I1B,SAAuBrB,EAAS+B,GAC5B,GAAIvB,EAAkBwB,KAAKD,GACvB,OAAOA,EAEX,YAAoBjkE,IAAZkiE,EAAwBA,EAAU,IAAM+B,EA/IlBE,CAActpE,KAAKqnE,QAAS1pE,GAAQwrE,GAgB9D,OAdKN,IACG,IAAIV,QAAQW,GAAsB3vE,IAAI,gBACtCo4D,EAAQ6W,QAAQrvE,IAAI,eAAgB,IAAIovE,QAAQW,GAAsBzyE,IAAI,sBAE5D8O,IAATm5C,GAmJrB,SAAgBtyC,GACZ,IACI0wD,KAAK56B,MAAM91B,GAEf,MAAOmjD,GACH,OAAO,EAEX,OAAO,EA1JgCoa,CAAOjrB,IAClCiT,EAAQ6W,QAAQrvE,IAAI,eAAgB,qBA0IpD,SAA2BqvE,EAASoB,GAChC,MAAMC,OAAqCtkE,IAAnBqkE,EAA+BA,EAAiB,GACxE,IAAK,MAAMzzE,KAAQ0zE,EACXvzE,OAAOkB,UAAUC,eAAe1B,KAAK8zE,EAAiB1zE,KAAUqyE,EAAQjvE,IAAIpD,IAC5EqyE,EAAQrvE,IAAIhD,EAAM0zE,EAAgB1zE,IA3ItC2zE,CAAkBnY,EAAQ6W,QAASU,QACtB3jE,IAATm5C,GAAsBpoD,OAAOkB,UAAU8wE,cAAcvyE,KAAKg0E,KAAKvyE,UAAWknD,IAASA,EAAK5c,MAGxF6vB,EAAQ6W,QAAQrvE,IAAI,eAAgBulD,EAAK5c,MAEtC6vB,EAWX,IAAI5zD,EAAOk9C,GACP,OAAO76C,KAAK86C,MAAMn9C,EAAOk9C,GAY7B,KAAKl9C,EAAO2gD,EAAMzD,GACd,OAAO76C,KAAK4pE,UAAUjsE,EAAO2gD,EAAMzD,EAAM,QAY7C,IAAIl9C,EAAO2gD,EAAMzD,GACb,OAAO76C,KAAK4pE,UAAUjsE,EAAO2gD,EAAMzD,EAAM,OAY7C,MAAMl9C,EAAO2gD,EAAMzD,GACf,OAAO76C,KAAK4pE,UAAUjsE,EAAO2gD,EAAMzD,EAAM,SAY7C,OAAOl9C,EAAO2gD,EAAMzD,GAChB,OAAO76C,KAAK4pE,UAAUjsE,EAAO2gD,EAAMzD,EAAM,UAE7C,oBAEI,GADA76C,KAAK+nE,iBAAoB/nE,KAAK8nE,mBAC1B9nE,KAAK+nE,aAAc,CACnB,MAAM/sB,EAAM,IAAIzlB,kBAAkB,uCAAwC,CAAEiX,SAAS,EAAMC,YAAY,IACvG,IAAI0M,OAAO4gB,WAAW,KAAQ,IAAIvkC,cAAcwlB,IAAS,IAGjE,kBAEI,GADAh7C,KAAK+nE,iBAAoB/nE,KAAK8nE,oBACzB9nE,KAAK+nE,aAAc,CACpB,MAAM/sB,EAAM,IAAIzlB,kBAAkB,wCAAyC,CAAEiX,SAAS,EAAMC,YAAY,IACxG,IAAI0M,OAAO4gB,WAAW,KAAQ,IAAIvkC,cAAcwlB,IAAS,IAGjE,eAAeuW,EAASgW,GACpB,OAAOvnE,KAAK6pE,kBAAkBtY,EAASgW,EAAc,UAAW,eAAgBvnE,MAEpF,gBAAgBymE,EAAUc,EAAchW,GACpC,OAAOvxD,KAAK6pE,kBAAkBpD,EAAUc,EAAc,WAAY,gBAAiBhW,EAASvxD,MAEhG,kBAAkBrC,EAAO4pE,EAAcuC,EAAaC,KAAcC,GAC9D,YAAyB7kE,IAAjBoiE,EAA6BA,EAAe,IAC/CvlB,OAAO,CAAClhD,EAAOod,KAChB,MAAM+rD,EAAiB/rD,EAAY4rD,GAC7BI,EAAehsD,EAAY6rD,GAEjC,OAAOjpE,EAAM23B,KAAKwxC,EAAkBxzE,GAASwzE,EAAet0E,KAAKuoB,EAAaznB,KAAUuzE,GAAoBG,EAAUD,EAAgBE,GAAUF,EAAav0E,KAAKuoB,EAAaksD,KAAWJ,GAAoBK,IAC/M3yC,QAAQvxB,QAAQxI,IAEvB,UAAUA,EAAO2gD,EAAMzD,EAAM7xB,GAQzB,OAPK6xB,IACDA,EAAO,IAEXA,EAAK7xB,OAASA,EACVs1B,IACAzD,EAAKyD,KAAOA,GAETt+C,KAAK86C,MAAMn9C,EAAOk9C,KA2CjC,SAASsvB,EAASjgE,GACd,OAAOA,EAEX,SAASmgE,EAAQngE,GACb,MAAMA,EA5CV,EAhR8C,SAAUjQ,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA4QnDqU,CAAW,CAvQgB,SAAUO,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,IAuQvDD,CAAQ,EAAG,KACXF,EAAW,oBAAqB,CAAC,OAClC,G,uBC7QC,EAA0C,SAAUrR,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAcnG,MAAMs/D,EACT,YAAY9rE,GACRwB,KAAKxB,SAAWA,EAChBwB,KAAKuqE,QAAU,GACfvqE,KAAKwqE,WAAa,KAClBxqE,KAAKyqE,+BAAiC,KACtCzqE,KAAK0qE,kCAAoC,EACzC1qE,KAAK0rB,UAAY,KACjB1rB,KAAK4rB,KAAO,KAEhB,eACI,OAAqB,OAAd5rB,KAAK4rB,KAEhB,aACI,OAAO5rB,KAAKuqE,QAAQjwE,OAExB,SAAS+jC,GACL,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,oCAEpBT,KAAK0rB,UAAY2S,EAAQ3S,UACzB1rB,KAAKyqE,+BAAiCpsC,EAAQosC,+BAC9CzqE,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB/rB,KAAK2qE,QAAS,CAAE1+C,YAAY,IAE3E,aACI,IAAKjsB,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,gCAEpBT,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,KACZ5rB,KAAKyqE,+BAAiC,KACtCzqE,KAAK2sB,QAET,QAAQi+C,EAAaC,GACjB,MAAM1mD,EAAOhqB,MAAMC,QAAQwwE,GACrBlvC,EAAQvX,EAAOymD,EAAc,CAACA,GAC9BE,EAAQpvC,EACTvjC,IAAI,CAAC1B,EAAOyO,IAAW/K,MAAMC,QAAQywE,GAA6BA,EAAY3lE,GAA1B2lE,GACpD1yE,IAAI1B,QAAmB0O,IAAV1O,EAAsBA,EAAQ,GAC1Cs0E,EAAW,GACjB,IAAK,MAAMrrE,KAAQg8B,EAAO,CACtB,MAAMsvC,EAAQ,IAAKtrE,GACnBsrE,EAAMC,KAAOH,EAAM3jD,QACnB4jD,EAASlrE,KAAK,IAAI63B,QAAQ,CAACvxB,EAASwoD,KAChCqc,EAAM7kE,QAAU,KACZA,IACAnG,KAAKwqE,WAAa,KAClBxqE,KAAK2qE,WAETK,EAAMrc,OAAUyb,IACZzb,EAAOyb,GACPpqE,KAAKwqE,WAAa,KAClBxqE,KAAK2qE,cAGb3qE,KAAKuqE,QAAQ1qE,KAAKmrE,GAGtB,OADAhrE,KAAK2qE,UACExmD,EAAO4mD,EAAWA,EAAS,GAEtC,QAAQ5+C,GACoB,OAApBnsB,KAAKwqE,kBAGKrlE,IAAVgnB,IACAnsB,KAAK0qE,kCAAoC,GAExC1qE,KAAKuqE,QAAQjwE,SAG0B,OAAxC0F,KAAKyqE,qCAAqDtlE,IAAVgnB,GAAuBnsB,KAAK0qE,mCAAqC1qE,KAAKuqE,QAAQ,GAAGU,MAAQ,GAAKjrE,KAAKyqE,iCAGvJzqE,KAAKwqE,WAAaxqE,KAAKuqE,QAAQpjD,SAAW,KACtCnnB,KAAKwqE,aACLxqE,KAAK0qE,mCAAqC1qE,KAAKwqE,WAAWS,MAAQ,EAClEjrE,KAAKxB,SAASwB,KAAKwqE,gBAG3B,QACIxqE,KAAKuqE,QAAQ34D,OAAO,EAAG5R,KAAKuqE,QAAQjwE,UArGE,SAAUL,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GACzIT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,IAoG5D,CAAW,CACP,IACA,EAAW,cAAesK,UAC1B,EAAW,oBAAqB,CAACyY,SACjC,EAAW,yBAAqB,IACjCixD,EAAMlzE,UAAW,UAAW,MC7G/B,IAMI,EAA0C,SAAUsC,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,EAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAS3D,IAAI,EAAmB,MACnB,YAAYwgB,EAAW8K,GACnBx2B,KAAK0rB,UAAYA,EACjB1rB,KAAKyqE,+BAAiC,EACtCzqE,KAAKoyC,UAAW,EAChBpyC,KAAKq+B,QAAU,CACX6sC,oBAAoB,EACpB1sE,SAAU,QAEdwB,KAAKmrE,eAAiB,GACtBnrE,KAAKorE,eAAkBC,GACZrrE,KAAKsrE,QAAQtrE,KAAM,WAAY,CAACqrE,IAE3CrrE,KAAKurE,aAAgBC,IACjB,MAAM71E,EAAO61E,EACT71E,EAAKmE,SAAWkG,MAA4B,iBAApBrK,EAAKsM,aAC7BtM,EAAK81E,WAAW5rE,KAAKG,KAAKmrE,eAAehlE,SACzCnG,KAAKmrE,eAAehlE,QAAU,KAEN,aAApBxQ,EAAKsM,YAA6BjC,KAAKmrE,eAAeO,mBACtD/1E,EAAK81E,WAAW5rE,MAAK,GACrBG,KAAKmrE,eAAeO,kBAAmB,IAI/C,MAAM1iD,EAASrzB,EAAKmE,OAAOnE,EAAKsM,YAChC,IAASiG,MAAM,IAAO,UAAWvS,EAAKsM,WAAYtM,EAAK81E,YACnDziD,GACAA,EAAO9S,MAAMvgB,EAAKmE,OAAQnE,EAAK81E,YAEnCD,EAAMrlE,WAEVnG,KAAKm5C,OAAS3iB,EAAI2iB,OAClBn5C,KAAK2rE,QAAUn1C,EAAI2iB,OAAOwyB,QAC1B3rE,KAAK62B,SAAWL,EAAI2iB,OAAOtiB,SAC3B72B,KAAK4rE,aAAe,IAAItB,EAAMtqE,KAAKurE,cAEvC,SAASltC,GACL,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,iDAEpBT,KAAKoyC,UAAW,EAChBpyC,KAAKq+B,QAAQ7/B,SAAW6/B,EAAQ7/B,SACE,MAA9B6/B,EAAQ6sC,qBACRlrE,KAAKq+B,QAAQ6sC,mBAAqB7sC,EAAQ6sC,oBAE9ClrE,KAAK4rE,aAAa9xC,SAAS,CAAEpO,UAAW1rB,KAAK0rB,UAAW++C,+BAAgCzqE,KAAKyqE,iCAC7FzqE,KAAKm5C,OAAOnkB,iBAAiB,WAAYh1B,KAAKorE,gBAElD,aACI,IAAKprE,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,6CAEpBT,KAAKm5C,OAAO9iB,oBAAoB,WAAYr2B,KAAKorE,gBACjDprE,KAAK4rE,aAAahyC,aAClB55B,KAAKq+B,QAAU,CAAE6sC,oBAAoB,EAAM1sE,SAAU,QACrDwB,KAAKoyC,UAAW,EAEpB,aACI,OAAOpyC,KAAK2rE,QAAQrxE,OAExB,YACI,OAAO0F,KAAK2rE,QAAQjoE,MAExB,kBACI,MAAM,SAAEmoE,EAAQ,OAAEC,EAAM,KAAEC,GAAS/rE,KAAK62B,SACxC,MAAO,CACHuc,KAAMy4B,EACNvtC,MAAOwtC,EACPC,OACA7pC,YAAaliC,KAAKq+B,QAAQ6sC,mBAAqBa,EAAKrtE,MAAM,GAAKmtE,GAGvE,GAAG1/C,EAAOu/C,GAAmB,GACzB,OAAO1rE,KAAKsrE,QAAQtrE,KAAK2rE,QAAS,KAAM,CAACx/C,GAAQu/C,GAErD,mBAAmBhoE,GACf,MAAM,MAAEohE,EAAK,KAAE1xB,GAAS1vC,EAAMsoE,aACxBxnC,EAAWxkC,KAAKq+B,QAAQ6sC,mBAAqB,KAAO,GAC1D,OAAOlrE,KAAKsrE,QAAQtrE,KAAK2rE,QAAS,YAAa,CAACjoE,EAAOohE,EAAO,GAAGtgC,IAAW4O,MAEhF,sBAAsB1vC,GAClB,MAAM,MAAEohE,EAAK,KAAE1xB,GAAS1vC,EAAMsoE,aACxBxnC,EAAWxkC,KAAKq+B,QAAQ6sC,mBAAqB,KAAO,GAC1D,OAAOlrE,KAAKsrE,QAAQtrE,KAAK2rE,QAAS,eAAgB,CAACjoE,EAAOohE,EAAO,GAAGtgC,IAAW4O,MAEnF,oBACI,OAAOpzC,KAAKsrE,QAAQtrE,KAAM,WAAY,IAE1C,SAASqrE,EAAIllE,EAASulE,GAAmB,GAChCA,GACD1rE,KAAKq+B,QAAQ7/B,SAAS,IACfwB,KAAKisE,YAEJj+D,MAAOq9D,EACP3nE,MAAO1D,KAAK2rE,QAAQjoE,QAI5ByC,SACAA,IAGR,eAAeA,SACLnG,KAAKksE,IAAI,GAAG,GAClB,MAAMxoE,EAAQ1D,KAAK2rE,QAAQjoE,MAE3B,GAAIA,GAASA,EAAMyoE,kBAAoBzoE,EAAMyoE,gBAAgBC,WAEzD,aADMpsE,KAAKksE,IAAI,GAAG,GACXlsE,KAAKqsE,mBAAmB3oE,GAEnCyC,IAEJ,aAAazC,GACT1D,KAAKmrE,eAAiBznE,EAI1B,QAAQ5J,EAAQmI,EAAYwpE,EAAYC,GACpC,MAAMY,EAAQ,GACRxB,EAAQ,GACRC,EAAW,GACjB,QAAyB5lE,IAArBumE,EAAgC,CAEhC,IAAIvlE,EAAU,KACd4kE,EAASlrE,KAAK,IAAI63B,QAAQ60C,IACtBpmE,EAAUomE,KAEdD,EAAMzsE,KAAK,CACP/F,OAAQkG,KACRiC,WAAY,eACZwpE,WAAY,CACR,CACItlE,UACAulE,uBAIZZ,EAAMjrE,KAAK,GAWf,OATAysE,EAAMzsE,KAAK,CACP/F,OAAQA,EACRmI,WAAYA,EACZwpE,WAAYA,IAEhBX,EAAMjrE,KAAK,GAGXkrE,EAASlrE,KAAKG,KAAK4rE,aAAaN,QAAQgB,EAAOxB,GAAO,IAC/CC,EAAS,KAGxB,EA3K8C,SAAU9wE,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAuK7C,CAAW,CAC1B,EAAQ,EAAG,KACX,EAAQ,EAAG,KACX,EAAW,oBAAqB,CAACJ,OAAQ,OAC1C,GCzKI,MAAM,EACT,YAAYsgC,GACRx2B,KAAKq+B,QAAU,CACXmuC,SAAS,EACThuE,SAAU,QAEdwB,KAAKoyC,UAAW,EAChBpyC,KAAKoG,QAAW8K,IACZ,MAAMhD,EAAO,EAAYu+D,aAAav7D,EAAGlR,KAAKm5C,OAAQn5C,KAAKq+B,SACvDnwB,EAAKw+D,oBACLx7D,EAAE+9B,iBACFjvC,KAAKq+B,QAAQ7/B,SAAS0P,KAG9BlO,KAAKm5C,OAAS3iB,EAAI2iB,OAClBn5C,KAAKo5C,SAAW5iB,EAAI4iB,SAOxB,oBAAoBprC,EAAOsvC,EAAKjf,GAC5B,MAAMnwB,EAAO,CACTw+D,mBAAmB,EACnBxqC,YAAa,KACbyqC,OAAQ,MAEN7yE,EAASoU,EAAKy+D,OAAS3+D,EAAM8xC,cAGnC,IAAKhmD,IAAW,EAAY8yE,mBAAmB9yE,EAAQwjD,GACnD,OAAOpvC,EAEX,GAAIpU,EAAOu/D,aAAa,YACpB,OAAOnrD,EAEX,GAAIF,EAAM6+D,QAAU7+D,EAAM8+D,SAAW9+D,EAAM++D,SAAW/+D,EAAMg/D,SACxD,OAAO9+D,EAEX,MAAM++D,EAAW,IAAgBx4C,IAAI36B,EAAQ,QACvCozE,OAAoB,IAAbD,EAAsBA,EAAShzC,UAAUxjC,MAAQ,KACxD02E,EAAO9uC,EAAQmuC,SAAW1yE,EAAOu/D,aAAa,QAAUv/D,EAAOm2C,aAAa,QAAU,KAC5F,KAAc,OAATi9B,GAAiC,IAAhBA,EAAK5yE,QAA2B,OAAT6yE,GAAiC,IAAhBA,EAAK7yE,QAC/D,OAAO4T,EAEXA,EAAKy+D,OAAS7yE,EACdoU,EAAKg0B,YAAcgrC,GAAQC,EAC3B,MAAMC,EAAqC,IAAjBp/D,EAAMq/D,OAEhC,OADAn/D,EAAKw+D,kBAAoBU,EAClBl/D,EAuBX,0BAA0BpU,EAAQwjD,GAC9B,MAAMgwB,EAAexzE,EAAOm2C,aAAa,UACzC,OAAQq9B,GACJA,IAAiBhwB,EAAIvnD,MACJ,UAAjBu3E,EAMR,SAASjvC,GACL,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,2CAEpBT,KAAKoyC,UAAW,EAChBpyC,KAAKq+B,QAAU,IAAKA,GAKxB,aACI,IAAKr+B,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,uCAEpBT,KAAKoyC,UAAW,GCpGjB,SAASm7B,EAAY1uE,EAAKsiB,GAC7B,MAAMqsD,EAAU,GAChB,IAAIC,EAAW5uE,EAAI6yC,UAAUvwB,GAC7B,KAAOssD,GAAY,GACfD,EAAQ3tE,KAAKhB,EAAI+S,OAAO67D,EAAU,GAAG,IACrCA,EAAW5uE,EAAI6yC,UAAUvwB,GAE7B,OAAOqsD,ECPJ,SAASE,EAAWpvC,GACvB,IAAKA,IAAUA,EAAMhkC,OACjB,MAAO,GAEX,MAAMmxE,EAAa,GAEb/pE,EAAS48B,EAAM1N,QAAQ,IAAK,KAAKH,MAAM,KAC7C,IAAK,MAAMk9C,KAASjsE,EAAQ,CACxB,MAAO3K,EAAKN,GAASk3E,EAAMl9C,MAAM,KACjCg7C,EAAWmC,mBAAmB72E,IAAQ62E,wBAA6B,IAAVn3E,EAAmBA,EAAQM,GAExF,OAAO00E,ECPJ,IAAIoC,EC4ZPC,EJzTJ,EAAYppE,OAAS,CAAC,KGlGtB,SAAWmpE,GACPA,EAAcA,EAAoB,KAAI,GAAK,OAC3CA,EAAcA,EAAuB,QAAI,GAAK,UAC9CA,EAAcA,EAAsB,OAAI,GAAK,SAC7CA,EAAcA,EAA2B,YAAI,GAAK,cAClDA,EAAcA,EAAqB,MAAI,GAAK,QALhD,CAMGA,IAAkBA,EAAgB,KAI9B,MAAM,EACT,YAEAjzB,EAAU,IAAI,GAAoB,IAAK1Y,EAAc,CACjDA,YAAa,GACb6rC,qBAAsB,IACvB1qE,EAAY,MACXrD,KAAK46C,QAAUA,EACf56C,KAAKkiC,YAAcA,EACnBliC,KAAKguE,cAAgB,EACrBhuE,KAAKiuE,SAAU,EACfjuE,KAAKkuE,WAAY,EACjBluE,KAAKmuE,aAAc,EACnBnuE,KAAKouE,SAAU,EAEVpuE,KAAK46C,QAAQyzB,mBAAmC,OAAdhrE,IACnCrD,KAAK46C,QAAQ0zB,cAAgBtuE,KAAKuuE,gBAAgBlrE,IAG1D,wBACI,OAAOrD,KAAK46C,QAAQ4zB,kBAExB,eACI,OAAOxuE,KAAK46C,QAAQ6zB,SAExB,eAAehqB,GACX,OAAOzkD,KAAK46C,QAAQ8zB,cAAcjqB,EAAM7J,SAE5C,gBAAgB6J,GACZ,OAAOzkD,KAAK46C,QAAQ8zB,cAAcjqB,EAAM7J,SAAS,IAE7C56C,KAAKkiC,YAAY5D,QAAUmmB,EAAMviB,YAAY5D,MAErD,kBACI,OAA2C,OAAnCt+B,KAAK46C,QAAQ4zB,mBACjB,oBAAqBxuE,KAAK46C,QAAQ4zB,wBACiB,IAAnDxuE,KAAK46C,QAAQ4zB,kBAAkBG,gBAC7B3uE,KAAK46C,QAAQ4zB,kBAAkBG,gBAC/B,UAEV,aAAalqB,GACT,OAAOzkD,KAAK46C,QAAQ8zB,cAAcjqB,EAAM7J,SAAS,GAErD,gBAAgBv3C,EAAWurE,GACvB,GAA2B,IAAvB5uE,KAAKguE,cAAT,CAIA,IAAKhuE,KAAKkuE,YAAcluE,KAAKmuE,YACzB,IACInuE,KAAK46C,QAAQ4zB,kBAAoBxuE,KAAK6uE,oBAAoBxrE,GAE9D,MAAO6N,GACH,QAAiB,IAAb09D,EAWA,MAAM19D,EAVNlR,KAAK46C,QAAQk0B,cAAc,CAAEp6D,GAAI1U,KAAK46C,QAAQm0B,gBAC9C/uE,KAAK46C,QAAQo0B,aAAaJ,GAC1B,IACI5uE,KAAK46C,QAAQ4zB,kBAAoBxuE,KAAK6uE,oBAAoBxrE,GAE9D,MAAO4rE,GACH,MAAM/9D,GAQtBlR,KAAKguE,cAAgB,GAEzB,mBAE+B,IAAvBhuE,KAAKguE,gBAIThuE,KAAKguE,cAAgB,GAEzB,eAAeS,EAAUS,GACrB,IAAKlvE,KAAK46C,QAAQ4zB,kBACd,OAAO,EAEX,IAAKxuE,KAAK46C,QAAQ4zB,kBAAkBW,SAChC,OAAO,EAEX,MAAMC,EAAiBpvE,KAAK46C,QAAQ0zB,cAAgBtuE,KAAK46C,QAAQ0zB,cAAc7C,WAAa,KAC5FzrE,KAAKkiC,YAAYupC,WAAazrE,KAAK46C,QAAQy0B,sBAAsBD,GACjE,MAAME,EAAS,IAAK5B,EAAW1tE,KAAKkiC,YAAY5D,UAAWt+B,KAAKkiC,YAAYupC,YACtE5uE,EAASmD,KAAK46C,QAAQ4zB,kBAAkBW,SAASG,EAAQtvE,KAAKkiC,YAAagtC,GAEjF,OADA,IAAShnE,MAAM,IAAO,oBAAqBrL,GACrB,kBAAXA,EACAA,EAEW,iBAAXA,EACA,CAAC4xE,EAASc,OAAOC,0BAA0B3yE,EAAQ4xE,IAEvD5xE,EAEX,eAAe4yE,GACX,IAAKzvE,KAAK46C,QAAQ4zB,oBAAsBxuE,KAAK46C,QAAQ4zB,kBAAkBkB,SACnE,OAAO,EAEX,MAAM7yE,EAASmD,KAAK46C,QAAQ4zB,kBAAkBkB,SAASD,EAAiBzvE,KAAKkiC,aAE7E,OADA,IAASh6B,MAAM,IAAO,oBAAqBrL,GAEhCA,EAIf,YAAYqyE,GAER,GAAKlvE,KAAKouE,SAAmC,IAAvBpuE,KAAKguE,gBAAoChuE,KAAKiuE,QAApE,CAGA,GAAIjuE,KAAK46C,QAAQ4zB,mBAAqBxuE,KAAK46C,QAAQ4zB,kBAAkBr+D,MAAO,CACxE,MAAMi/D,EAAiBpvE,KAAK46C,QAAQ0zB,cAAgBtuE,KAAK46C,QAAQ0zB,cAAc7C,WAAa,KAC5FzrE,KAAKkiC,YAAYupC,WAAazrE,KAAK46C,QAAQy0B,sBAAsBD,GACjE,MAAME,EAAS,IAAK5B,EAAW1tE,KAAKkiC,YAAY5D,UAAWt+B,KAAKkiC,YAAYupC,kBACtEzrE,KAAK46C,QAAQ4zB,kBAAkBr+D,MAAMm/D,EAAQtvE,KAAKkiC,YAAagtC,GAEzElvE,KAAKiuE,SAAU,GAEnB,YAAYwB,GACmB,IAAvBzvE,KAAKguE,eAAoChuE,KAAKiuE,UAG9CjuE,KAAK46C,QAAQ4zB,mBAAqBxuE,KAAK46C,QAAQ4zB,kBAAkBl+D,aAC3DtQ,KAAK46C,QAAQ4zB,kBAAkBl+D,MAAMm/D,EAAiBzvE,KAAKkiC,aAErEliC,KAAKiuE,SAAU,GAGnB,oBAAoB5qE,EAAWwkB,EAAS4mD,GAEpC,GAA2B,IAAvBzuE,KAAKguE,gBAAqChuE,KAAKiuE,SAAYjuE,KAAK46C,QAAQ4zB,kBAA5E,CAIA,IAAKxuE,KAAKkuE,YAAcluE,KAAKmuE,YAAa,CACtC,MAAM5sC,EAAO1Z,EACM,IAAW2a,iBAAiBxiC,KAAK46C,QAAQ4zB,kBAAmBnrE,EAAUhN,IAAI,KAAakrC,EAAMl+B,OAAW,OAAQ,GACxHtI,OAAS,IAAc05B,IAAI5M,GAE1C7nB,KAAKguE,cAAgB,GAEzB,gBAAgBzvE,EAAOoxE,GAAW,GAEH,IAAvB3vE,KAAKguE,gBAIJ2B,EAIDpxE,EAAMsB,KAAKG,MAHXA,KAAKguE,cAAgB,GAM7B,oBAAoBjzE,GACW,IAAvBiF,KAAKguE,gBAMThuE,KAAK46C,QAAQ4zB,kBAAkBx3C,YAAYhgC,KAAK,MAEhDgJ,KAAKguE,cAAgB,GAEzB,yBAAyB2B,GAAW,GACL,IAAvB3vE,KAAKguE,sBAKHhuE,KAAK46C,QAAQ4zB,kBAAkBx3C,YAAYxX,OAAO,OAAiDiY,OAGzGz3B,KAAKguE,cAAgB,GAEzB,aAAanmD,GACT,GAA2B,IAAvB7nB,KAAKguE,cAAT,CAIA,GADAhuE,KAAK46C,QAAQ4zB,kBAAkBx3C,YAAYC,OAAO,MAC9Cj3B,KAAKkuE,WAAaluE,KAAKmuE,YAAa,CACpC,MAAM5rD,EAAWpoB,MAAMuP,KAAKme,EAAQ+nD,qBAAqB,MACzD,IAAK,MAAMrxB,KAAMh8B,EAAU,CACvB,MAAM2+B,EAAO3C,EAAGtO,aAAa,qBAC7B,GAAIiR,EAAM,CACN,MAAO2uB,EAAKpuD,GAAQy/B,EAAKzwB,MAAM,KAC/B8tB,EAAGxL,gBAAgB,qBACnBwL,EAAGuxB,UAAUruD,GAAOouD,KAIhC7vE,KAAKguE,cAAgB,GAEzB,gBAAgBnmD,EAAS8nD,GAAW,GAChC,GAA2B,IAAvB3vE,KAAKguE,gBAAmChuE,KAAKiuE,QAAjD,CAGA,GAAI0B,GAAwB,OAAZ9nD,EAAkB,CAC9B,MAAMtF,EAAWpoB,MAAMuP,KAAKme,EAAQ+nD,qBAAqB,MACzD,IAAK,MAAMrxB,KAAMh8B,GACTg8B,EAAGwxB,UAAY,GAAKxxB,EAAGyxB,aACvBzxB,EAAGjoB,aAAa,oBAAqB,GAAGioB,EAAGwxB,aAAaxxB,EAAGyxB,cAIvEhwE,KAAK46C,QAAQ4zB,kBAAkBx3C,YAAYE,OAAO,MAClDl3B,KAAKguE,cAAgB,GAEzB,kBAAkBnmD,EAAS4nD,EAAiBlxE,EAAOoxE,GAAW,GAC1D,OAAQ3vE,KAAKguE,eACT,KAAK,QACKhuE,KAAKsQ,MAAMm/D,GACjBzvE,KAAKiwE,gBAAgBpoD,EAAS8nD,GAClC,KAAK,QACK3vE,KAAKkwE,mBAAmBP,GAClC,KAAK,EACD3vE,KAAKmwE,gBAAgB5xE,EAAOoxE,GAChC,KAAK,EACD3vE,KAAKowE,oBAGjB,kBACI,OAAOpwE,KAAK46C,QAAQm0B,cAExB,gBAAgB1rE,GACZ,OAAIrD,KAAK46C,QAAQyU,UACN,KAEJrvD,KAAK46C,QAAQ2zB,gBAAgBlrE,GAExC,oBAAoBA,GAChB,OAAIrD,KAAK46C,QAAQyU,UACN,KAEJrvD,KAAK46C,QAAQi0B,oBAAoBxrE,IE9PzC,MAAM,EACT,YAAYtN,EAAMw5E,EAAQ1nD,EAASwoD,EAAa5iE,EAAO6iE,EAAoB,KAC3EjyC,EAAU,CACNkyC,QAAS,GACT3sE,OAAQ,OAER5D,KAAKjK,KAAOA,EACZiK,KAAKuvE,OAASA,EACdvvE,KAAK6nB,QAAUA,EACf7nB,KAAKswE,kBAAoBA,EACzBtwE,KAAKq+B,QAAUA,EACfr+B,KAAKozC,KAAO,KACZpzC,KAAK46C,QAAU,KACf56C,KAAKwwE,YAAc,KACnBxwE,KAAKywE,WAAY,EACjBzwE,KAAK0wE,WAAa,KAClB1wE,KAAK2wE,iBAAmB,EACxB3wE,KAAKo2B,QAAS,EACdp2B,KAAKpE,KAAM,EACXoE,KAAK4wE,eAAiB,IAAI,GAAMrB,EAAQ9hE,EAAO4iE,EAAa,KAAMrwE,MAC9DA,KAAKuwE,QAAQj2E,OAAS,IACtB0F,KAAK46C,QAAU20B,EAAOC,0BAA0BxvE,KAAKuwE,QAAQ,GAAIvwE,KAAKjK,OAG9E,YACI,OAAOiK,KAAK4wE,eAAenjE,MAE/B,kBACI,OAAOzN,KAAK4wE,eAAeP,YAE/B,cACI,OAAOrwE,KAAK4wE,eAAe/uE,QAE/B,YAAYA,GACR7B,KAAK4wE,eAAe/uE,QAAUA,EAElC,iBACI,OAAO,EAEX,sBACI,OAAO,EAEX,cACI,OAAwB,OAAjB7B,KAAK46C,QAEhB,uBACI,OAAkC,OAA3B56C,KAAKswE,mBAAsD,IAAxBtwE,KAAKuwE,QAAQj2E,OAE3D,eACI,MAAMS,EAASiF,KAAK4wE,eAAe71E,OACnC,OAAe,OAAXA,EACO,CAACiF,MAELjF,EAAO81E,gBACT5mE,OAAOkwC,GAASA,EAAM22B,iBAAmB32B,EAAM42B,cAAch7E,OAASiK,KAAKjK,MAC3EoC,IAAIgiD,GAASA,EAAM42B,eAE5B,aACI,OAAO/wE,KAAKq+B,QAAQz6B,QAAU,KAElC,cACI,IAAI2sE,EAAUvwE,KAAKq+B,QAAQkyC,SAAW,GAItC,MAHuB,iBAAZA,IACPA,EAAUA,EAAQ9/C,MAAM,MAErB8/C,EAEX,cACI,GAAIvwE,KAAKuwE,QAAQj2E,OAAS,EACtB,OAAO0F,KAAKuwE,QAAQ,GAG5B,eAAe31B,EAAS1Y,GACpB,IAAI8uC,EAwBJ,OAtBIA,EADAp2B,aAAmB,GACGA,EAGC,iBAAZA,EACe56C,KAAKuvE,OAAO0B,oBAAoBC,yBAAyBt2B,GAGzD56C,KAAKuvE,OAAOC,0BAA0B50B,GAGpEo2B,EAAoBD,cAAgB/wE,KACpCA,KAAKo2B,OAASp2B,KAAKuvE,OAAO0B,oBAAoBE,2BAA2BH,IAClEhxE,KAAKuvE,OAAO0B,oBAAoBG,+BAA+BJ,GACtEhxE,KAAKpE,IAAMoE,KAAKuvE,OAAO0B,oBAAoBI,yBAAyBL,IAC7D72E,MAAMC,QAAQ4F,KAAK4D,QACtB5D,KAAKpE,MACLo1E,EAAoBjC,cAAgB,WAEnB,IAAjB/uE,KAAKopD,SAA4D,OAAtC4nB,EAAoBjC,gBAC/CiC,EAAoBjC,cAAgB/uE,KAAKopD,SAE7CppD,KAAKwwE,YAAcQ,GACZ,EAEX,WACI,OAAOt5C,QAAQvxB,SAAQ,GAE3B,WACI,OAAOuxB,QAAQvxB,SAAQ,GAE3B,QACI,OAAOuxB,QAAQvxB,SAAQ,GAE3B,cAGI,OAFAnG,KAAK46C,QAAW56C,KAAKo2B,OAA4B,KAAnBp2B,KAAKwwE,YACnCxwE,KAAKwwE,YAAc,KACZ94C,QAAQvxB,SAAQ,GAE3B,wBAEQnG,KAAKo2B,QAAUj8B,MAAMC,QAAQ4F,KAAK4D,SAClC5D,KAAKsxE,mBAGb,qBAEI,GADAtxE,KAAKwwE,YAAc,KACfxwE,KAAKpE,IAAK,CACV,MAAMsJ,EAAQlF,KAAK4D,OAAOqF,QAAQjJ,KAAK0wE,YACvC1wE,KAAK4D,OAAOgO,OAAO1M,EAAO,GAC1BlF,KAAK0wE,WAAa,KAEtB,OAAOh5C,QAAQvxB,UAEnB,cAAcorE,GACV,OAAgB,OAAZA,QAAgC,IAAZA,GAAyC,IAAnBA,EAAQj3E,SAGlDi3E,IAAYvxE,KAAKuvE,OAAO0B,oBAAoBO,0BACzCD,IAAYvxE,KAAKuvE,OAAO0B,oBAAoBQ,wBAC5CF,IAAYvxE,KAAKjK,OAGI,IAAxBiK,KAAKuwE,QAAQj2E,WAGb0F,KAAKuwE,QAAQphE,SAASoiE,MAGtBvxE,KAAKuwE,QAAQtmE,OAAQxT,GAAUA,EAAM0Y,SAAS,MAAM7U,UAK5D,cACmB0F,KAAK4D,QAAU,IACnBtJ,OAAS,GAAyB,OAApB0F,KAAK0wE,aAC1B1wE,KAAK0wE,WAAa1wE,KAAK0xE,0BAG/B,eAC4B,OAApB1xE,KAAK0wE,YAAuC,OAAhB1wE,KAAK4D,QACjC2pE,EAAYvtE,KAAK4D,OAASlE,GAASA,IAASM,KAAK0wE,YAErD1wE,KAAK0wE,WAAa,KAEtB,yBACI,GAAoB,OAAhB1wE,KAAK4D,OACL,OAAO,KAEX,MAAM+tE,EAAW3xE,KAAK2xE,SACtB,IAAK,MAAMjyE,KAAQM,KAAK4D,OACpB,GAAI+tE,EAASC,MAAMC,GAAWA,EAAQnB,aAAehxE,GACjD,OAAOA,EAGf,OAAO,KAEX,gBACI,MAAMA,EAAO,GAEb,OADAM,KAAK4D,OAAO/D,KAAKH,GACVA,EAEX,mBACIM,KAAK2wE,gBAAkB3wE,KAAK4D,OAAOqF,QAAQjJ,KAAK0wE,YAC5C1wE,KAAK2wE,iBAAmB,GACxB3wE,KAAK4D,OAAOgO,OAAO5R,KAAK2wE,gBAAiB,GAGjD,YACI,OAA+B,OAA3B3wE,KAAKswE,kBACEtwE,KAAKswE,kBAAkBwB,OAE3B,MC3LR,MAAMC,EACT,YAAYl/B,EAAQ,KAAMm/B,EAAW,GAAI5yC,EAAe,GAAI6yC,EAAY,IACpEjyE,KAAK6yC,MAAQA,EACb7yC,KAAKgyE,SAAWA,EAChBhyE,KAAKo/B,aAAeA,EACpBp/B,KAAKiyE,UAAYA,EAErB,yBACI,OAAsB,OAAfjyE,KAAK6yC,MAEhB,wBACI,OAAO7yC,KAAKo/B,aAAa9kC,OAAS,EAEtC,mBACI,OAA0B,OAAnB0F,KAAKiyE,WAAsBjyE,KAAKiyE,UAAU33E,OAAS,GCb3D,MAAM,UAAmBH,MAC5B,cACI63B,SAASnnB,WACT7K,KAAKkyE,cAAgB,EAEzB,OACI,OAAIlyE,KAAK1F,OAAS0F,KAAKkyE,aAAe,EAC3BlyE,OAAOA,KAAKkyE,eAGnBlyE,KAAKkyE,cAAgB,EACd,MAGf,gBACIlyE,KAAK4R,OAAO5R,KAAKkyE,eAAgB,GAErC,OAAOhwC,GACHqrC,EAAYvtE,KAAMvJ,GAASA,IAAUyrC,IHrBtC,MAAMiwC,EACT,YAAY/+B,EAAMg/B,EAAehsE,GAC7BpG,KAAKozC,KAAOA,EACZpzC,KAAKoyE,cAAgBA,EACrBpyE,KAAKoG,QAAUA,GAGhB,MAAMisE,EACT,YAAYC,EAAOC,GACfvyE,KAAKsyE,MAAQA,EACbtyE,KAAKuyE,WAAaA,GAGnB,MAAMC,EACT,YAAYC,EAAU/wE,EAAQgxE,EAAcC,EAAWC,GACnD5yE,KAAKyyE,SAAWA,EAChBzyE,KAAK0B,OAASA,EACd1B,KAAK0yE,aAAeA,EACpB1yE,KAAK2yE,UAAYA,EACjB3yE,KAAK4yE,YAAcA,GAG3B,MAAMC,EACF,YAAY9uB,EAAO0C,EAAQqsB,EAAej2E,GACtC,IAAI2M,EACJxJ,KAAK+jD,MAAQA,EACb/jD,KAAKymD,OAASA,EACdzmD,KAAK8yE,cAAgBA,EACrB9yE,KAAKnD,OAASA,EACdmD,KAAK4W,KAAO6vC,EAAOA,EAAOnsD,OAAS,GACnC0F,KAAKyyE,SAAgC,QAApBjpE,EAAKxJ,KAAK4W,YAAyB,IAAPpN,OAAgB,EAASA,EAAGipE,SAE7E,QAAQ31E,GACJ,MAAM,MAAEinD,EAAK,OAAE0C,EAAM,cAAEqsB,EAAa,OAAEj2E,GAAWmD,KACjD,IAAI+yE,EAAa,KACbC,EAAa,EACjB,MAAMtvE,EAAQ+iD,EAAOA,EAAOnsD,OAAS,GACrC,SAAS24E,EAASC,EAAWC,GASzB,GARID,EAAUE,QAAQt2E,KACG,KAAfk2E,EACFD,EAAaG,EAGbr2E,EAAOjB,IAAI,IAAIi3E,EAAU9uB,EAAMj8C,OAAOhL,GAAK2pD,EAAO3+C,OAAOorE,GAA6B,OAAjBC,EAAwBL,EAAgBA,EAAchrE,OAAOqrE,GAAet2E,KAGnI,OAAlB6G,EAAM6tE,SAAoB2B,EAAUG,YAAuC,OAAzBH,EAAUluB,WAAqB,CACjF,GAAIkuB,EAAUluB,WAAW1qD,OAAS,EAC9B,MAAM,IAAImG,MAAM,GAAGyyE,EAAUluB,WAAW1qD,qBAE5C,MAAMg5E,EAAYJ,EAAUluB,WAAW,GACvC,IAAKsuB,EAAUC,YACX,MAAM,IAAI9yE,MAAM,mBAEpB,GAA6B,OAAzB6yE,EAAUtuB,WACV,IAAK,MAAMwuB,KAAcF,EAAUtuB,WAC/BiuB,EAASO,EAAYN,IAQrC,GAHIxvE,EAAMivE,WACNM,EAASvvE,EAAO,MAEK,OAArBA,EAAMshD,WACN,IAAK,MAAMkuB,KAAaxvE,EAAMshD,WAC1BiuB,EAASC,EAAW,MAGT,OAAfH,IACAtsB,EAAO5mD,KAAKG,KAAK4W,KAAOm8D,GACxBhvB,EAAMlkD,KAAK/C,GACiB,OAAxBi2E,EAAWN,WACXzyE,KAAKyyE,SAAWM,EAAWN,WAGhB,IAAfO,GACAn2E,EAAOu5B,OAAOp2B,MAGtB,YACI,SAASyzE,EAAqBX,EAAepvE,GACzC,MAAMshD,EAAathD,EAAMshD,WACzB,GAAmB,OAAfA,EACA,GAA0B,IAAtBA,EAAW1qD,QAA0C,OAA1B0qD,EAAW,GAAGusB,QACzCkC,EAAqBX,EAAe9tB,EAAW,SAG/C,IAAK,MAAMkuB,KAAaluB,EACpB,GAAIkuB,EAAUG,YAAqC,OAAvBH,EAAUT,SAAmB,CAErD,GADAK,EAAcjzE,KAAKqzE,GACU,OAAzBA,EAAUluB,WACV,IAAK,MAAMwuB,KAAcN,EAAUluB,WAC/ByuB,EAAqBX,EAAeU,GAG5C,OAMpBC,CAAqBzzE,KAAK8yE,cAAe9yE,KAAK4W,MAElD,YACI,MAAM,OAAE6vC,EAAM,MAAE1C,EAAK,SAAE0uB,GAAazyE,KAC9B0B,EAAS,GAEf,IAAK,MAAM3L,KAAQ08E,EAASF,WACxB7wE,EAAO3L,QAAQ,EAEnB,IAAK,IAAIP,EAAI,EAAGkS,EAAK++C,EAAOnsD,OAAQ9E,EAAIkS,IAAMlS,EAAG,CAC7C,MAAMkO,EAAQ+iD,EAAOjxD,GACrB,GAAIkO,EAAMivE,UAAW,CACjB,MAAM58E,EAAO2N,EAAM6tE,QAAQx7E,UACN,IAAjB2L,EAAO3L,GACP2L,EAAO3L,GAAQguD,EAAMvuD,GAGrBkM,EAAO3L,IAASguD,EAAMvuD,IAIlC,OAAOkM,EA8BX,UAAUvC,GACN,MAAMu0E,EAAU1zE,KAAKymD,OACfktB,EAAUx0E,EAAEsnD,OAClB,IAAK,IAAImtB,EAAK,EAAGC,EAAK,EAAGnsE,EAAKwgB,KAAKC,IAAIurD,EAAQp5E,OAAQq5E,EAAQr5E,QAASs5E,EAAKlsE,IAAMksE,EAAI,CACnF,IAAIE,EAASJ,EAAQE,GACrB,QAAe,IAAXE,EACA,OAAO,EAEX,IAAIC,EAASJ,EAAQE,GACrB,QAAe,IAAXE,EACA,OAAQ,EAEZ,IAAIC,EAAWF,EAAOvC,QAClB0C,EAAWF,EAAOxC,QACtB,GAAiB,OAAbyC,EAAmB,CACnB,GAAiB,OAAbC,EAAmB,GACjBJ,EACF,SAEJ,QAAiC,KAA5BC,EAASJ,IAAUE,IACpB,OAAO,EAEXI,EAAWF,EAAOvC,aAEjB,GAAiB,OAAb0C,EAAmB,CACxB,QAAiC,KAA5BF,EAASJ,IAAUE,IACpB,OAAQ,EAEZI,EAAWF,EAAOxC,QAEtB,GAAIyC,EAAS9lB,KAAO+lB,EAAS/lB,KACzB,OAAO,EAEX,GAAI8lB,EAAS9lB,KAAO+lB,EAAS/lB,KACzB,OAAQ,IAEV2lB,EAEN,MAAMK,EAAiBl0E,KAAK8yE,cACtBqB,EAAiBh1E,EAAE2zE,cACnBsB,EAAoBF,EAAe55E,OACnC+5E,EAAoBF,EAAe75E,OACzC,GAAI85E,EAAoBC,EACpB,OAAO,EAEX,GAAID,EAAoBC,EACpB,OAAQ,EAEZ,IAAK,IAAI7+E,EAAI,EAAGA,EAAI4+E,IAAqB5+E,EAAG,CACxC,MAAM8+E,EAAgBJ,EAAe1+E,GAC/B++E,EAAgBJ,EAAe3+E,GACrC,GAAI8+E,EAAch6E,OAASi6E,EAAcj6E,OACrC,OAAO,EAEX,GAAIg6E,EAAch6E,OAASi6E,EAAcj6E,OACrC,OAAQ,EAKhB,OAAO,GAGf,SAASk6E,EAAYC,GACjB,OAAmC,OAA5BA,EAAU79D,KAAK67D,SAE1B,SAASiC,EAAcx1E,EAAGC,GACtB,OAAOD,EAAEy1E,UAAUx1E,GAEvB,MAAMy1E,EACF,YAAYzuB,GACRnmD,KAAK60E,WAAa,GAClB70E,KAAK60E,WAAa,CAAC,IAAIhC,EAAU,CAAC,IAAK,CAAC1sB,GAAY,GAAInmD,OAE5D,cACI,OAAkC,IAA3BA,KAAK60E,WAAWv6E,OAE3B,cACI,MAAMu6E,EAAa70E,KAAK60E,WAAW5qE,OAAOuqE,GAC1C,GAA0B,IAAtBK,EAAWv6E,OACX,OAAO,KAEX,IAAK,MAAMm6E,KAAaI,EACpBJ,EAAUK,WAGd,OADAD,EAAWjkE,KAAK8jE,GACTG,EAAW,GAEtB,IAAIJ,GACAz0E,KAAK60E,WAAWh1E,KAAK40E,GAEzB,OAAOA,GACHz0E,KAAK60E,WAAWjjE,OAAO5R,KAAK60E,WAAW5rE,QAAQwrE,GAAY,GAE/D,QAAQ33E,GACJ,MAAM+3E,EAAa70E,KAAK60E,WAAWn2E,QACnC,IAAK,MAAM+1E,KAAaI,EACpBJ,EAAUM,QAAQj4E,IAmF9B,MAAMynB,EACF,YAAYywD,EAAWzD,EAAS96E,GAM5B,OALAuJ,KAAKg1E,UAAYA,EACjBh1E,KAAKuxE,QAAUA,EACfvxE,KAAKvJ,MAAQA,EACbuJ,KAAKglD,WAAa,KAClBhlD,KAAKyyE,SAAW,KACRlB,aAAyC,EAASA,EAAQrjB,MAC9D,KAAK,EACDluD,KAAK1F,OAAS06E,EAAU16E,OAAS,EACjC0F,KAAKuzE,aAAc,EACnBvzE,KAAK2yE,WAAY,EACjB3yE,KAAKqzE,WAAa9B,EAAQhrE,SAC1B,MACJ,KAAK,EACDvG,KAAK1F,OAAS06E,EAAU16E,OAAS,EACjC0F,KAAKuzE,aAAc,EACnBvzE,KAAK2yE,WAAY,EACjB3yE,KAAKqzE,YAAa,EAClB,MACJ,KAAK,EACDrzE,KAAK1F,OAAS06E,EAAU16E,OAAS,EACjC0F,KAAKuzE,aAAc,EACnBvzE,KAAK2yE,WAAY,EACjB3yE,KAAKqzE,YAAa,EAClB,MACJ,UAAKluE,EACDnF,KAAK1F,OAAuB,OAAd06E,EAAqB,EAAIA,EAAU16E,OACjD0F,KAAKuzE,aAAc,EACnBvzE,KAAK2yE,WAAY,EACjB3yE,KAAKqzE,YAAa,GAI9B,OAAO9B,EAAS96E,GACZ,IAAIiN,EACAshD,EAAahlD,KAAKglD,WActB,OAbmB,OAAfA,GACAthD,OAAQ,EACRshD,EAAahlD,KAAKglD,WAAa,IAG/BthD,EADiB,OAAZ6tE,EACGvsB,EAAW1c,KAAK/wC,GAAKA,EAAEd,QAAUA,GAGjCuuD,EAAW1c,KAAK/wC,IAAO,IAAIiS,EAAI,OAA4B,QAApBA,EAAKjS,EAAEg6E,eAA4B,IAAP/nE,OAAgB,EAASA,EAAG27C,OAAOosB,UAEpG,IAAV7tE,GACAshD,EAAWnlD,KAAK6D,EAAQ,IAAI6gB,EAAMvkB,KAAMuxE,EAAS96E,IAE9CiN,EAEX,YAAY+uE,GACR,GAAsB,OAAlBzyE,KAAKyyE,SACL,MAAM,IAAIhyE,MAAM,2CAA2CgyE,EAASH,MAAMl/B,qBAAqBpzC,KAAKyyE,SAASH,MAAMl/B,QAEvHpzC,KAAKyyE,SAAWA,EACZzyE,KAAKqzE,aACLrzE,KAAKg1E,UAAUC,YAAYxC,GACvBzyE,KAAKg1E,UAAUzB,aAA4C,OAA7BvzE,KAAKg1E,UAAUA,WAC7Ch1E,KAAKg1E,UAAUA,UAAUC,YAAYxC,IAIjD,QAAQ31E,GACJ,MAAMy0E,EAAUvxE,KAAKuxE,QACrB,OAAQA,aAAyC,EAASA,EAAQrjB,MAC9D,KAAK,EACD,OAAQluD,KAAKvJ,MAAM0Y,SAASrS,GAChC,KAAK,EACD,OAAO,EACX,KAAK,EACL,UAAKqI,EAED,OAAOnF,KAAKvJ,MAAM0Y,SAASrS,KAI3C,SAASo4E,EAAW3D,GAChB,OAAOA,EAAQj3E,OAAS,GAO5B,SAAWwzE,GACPA,EAAYA,EAAkB,KAAI,GAAK,OACvCA,EAAYA,EAAqB,QAAI,GAAK,UAC1CA,EAAYA,EAAoB,OAAI,GAAK,SAH7C,CAIGA,IAAgBA,EAAc,KACjC,MAAMtoB,EACF,YAAY/uD,EAAO27E,GACfpyE,KAAKvJ,MAAQA,EACbuJ,KAAKoyE,cAAgBA,EAEzB,WAAa,OAAO,EACpB,SAAS1uE,GACL,MAAM,MAAEjN,EAAOA,OAAO,OAAE6D,IAAa0F,KACrC,GAAIA,KAAKoyE,cACL,IAAK,IAAI58E,EAAI,EAAGA,EAAI8E,IAAU9E,EAC1BkO,EAAQA,EAAM6hD,OACAvlD,KACAvJ,EAAM2H,OAAO5I,SAI/B,IAAK,IAAIA,EAAI,EAAGA,EAAI8E,IAAU9E,EAAG,CAC7B,MAAMsH,EAAKrG,EAAM2H,OAAO5I,GACxBkO,EAAQA,EAAM6hD,OACAvlD,KACAlD,EAAGW,cAAgBX,EAAGY,eAG5C,OAAOgG,EAEX,OAAOvE,GACH,OAAmB,IAAXA,EAAE+uD,MACN/uD,EAAEizE,gBAAkBpyE,KAAKoyE,eACzBjzE,EAAE1I,QAAUuJ,KAAKvJ,OAG7B,MAAMivD,EACF,YAAY3vD,EAAMwQ,GACdvG,KAAKjK,KAAOA,EACZiK,KAAKuG,SAAWA,EAEpB,WAAa,OAAO,EACpB,SAAS7C,GAIL,OAHAA,EAAQA,EAAM6hD,OACAvlD,KACA,KAGlB,OAAOb,GACH,OAAmB,IAAXA,EAAE+uD,MACN/uD,EAAEoH,WAAavG,KAAKuG,UACpBpH,EAAEpJ,OAASiK,KAAKjK,MAG5B,MAAMo/E,EACF,YAAYp/E,GACRiK,KAAKjK,KAAOA,EAEhB,WAAa,OAAO,EACpB,SAAS2N,GAIL,OAHAA,EAAQA,EAAM6hD,OACAvlD,KACA,IAGlB,OAAOb,GACH,OAAmB,IAAXA,EAAE+uD,MACN/uD,EAAEpJ,OAASiK,KAAKjK,MIterB,MAAM,EJ8PN,MACH,cACIiK,KAAKmmD,UAAY,IAAI5hC,EAAM,KAAM,KAAM,IAE3C,IAAI6wD,GACA,GAAIA,aAAyBj7E,MAAO,CAChC,IAAK,MAAMm4E,KAAS8C,EAChBp1E,KAAKpE,IAAI02E,GAEb,OAEJ,MAAMA,EAAQ8C,EACRC,EAAS,IAAIlD,EAAkBG,EAAMl/B,MAA8B,IAAxBk/B,EAAMF,cAAwBE,EAAMlsE,SAC/Ekc,EAAkB+yD,EAAOjiC,KAqJvB3iB,MAAM,KAAKxmB,OAAOirE,GApJ1B,MAAM3C,EAAa,GACnB,IAAI7uE,EAAQ1D,KAAKmmD,UACjB,IAAK,MAAMxsC,KAAQ2I,EAGf,OADA5e,EAAQA,EAAM6hD,OAAO,KAAM,KACnB5rC,EAAKvb,OAAO,IAChB,IAAK,IAAK,CACN,MAAMi1E,EAAa15D,EAAKgX,SAAS,KAC3B56B,EAAOs9E,EAAa15D,EAAKjb,MAAM,GAAI,GAAKib,EAAKjb,MAAM,GACzD6zE,EAAW1yE,KAAK9J,GAChB2N,EAAQ,IAAIgiD,EAAe3vD,EAAMs9E,GAAY7uE,SAASd,GACtD,MAEJ,IAAK,IAAK,CACN,MAAM3N,EAAO4jB,EAAKjb,MAAM,GACxB6zE,EAAW1yE,KAAK9J,GAChB2N,EAAQ,IAAIyxE,EAAYp/E,GAAMyO,SAASd,GACvC,MAEJ,QACIA,EAAQ,IAAI8hD,EAAc7rC,EAAM07D,EAAOjD,eAAe5tE,SAASd,GAK3E,MAAM+uE,EAAW,IAAIJ,EAASgD,EAAQ9C,GACtC7uE,EAAMuxE,YAAYxC,GAEtB,UAAUr/B,GACN,IAAIs/B,EACAE,EAAc,GAClB,MAAM0C,EAAaliC,EAAKnqC,QAAQ,KAC5BqsE,GAAc,GACd1C,EAAcx/B,EAAK10C,MAAM42E,EAAa,GACtCliC,EAAOA,EAAK10C,MAAM,EAAG42E,GACrB5C,EAAe,IAAI6C,gBAAgB3C,IAGnCF,EAAe,IAAI6C,iBAEvBniC,EAAOoiC,UAAUpiC,IACP3wC,WAAW,OACjB2wC,EAAO,IAAIA,KAEXA,EAAK94C,OAAS,GAAK84C,EAAKziB,SAAS,OACjCyiB,EAAOA,EAAK10C,MAAM,GAAI,IAE1B,MAAM7B,EAAS,IAAI+3E,EAAgB50E,KAAKmmD,WACxC,IAAK,IAAI3wD,EAAI,EAAGkS,EAAK0rC,EAAK94C,OAAQ9E,EAAIkS,IAAMlS,EAAG,CAC3C,MAAMsH,EAAKs2C,EAAKh1C,OAAO5I,GAEvB,GADAqH,EAAOk4E,QAAQj4E,GACXD,EAAOwyD,QACP,OAAO,KAGf,MAAMolB,EAAY53E,EAAO44E,cACzB,GAAkB,OAAdhB,EACA,OAAO,KAEX,MAAM,SAAEhC,GAAagC,EACf/yE,EAAS+yE,EAAUiB,YACnB/C,EAAY8B,EAAUhC,SAASF,WAAWj4E,OAAS,EACzD,OAAO,IAAIk4E,EAAgBC,EAAU/wE,EAAQgxE,EAAcC,EAAWC,KKjUvE,MAAM,GACT,YAAYrD,EAAQoG,EAAUtF,EAAa5B,EAAW,KAAMsC,EAAgB,KAAMT,EAAoB,MAClGtwE,KAAKuvE,OAASA,EACdvvE,KAAK21E,SAAWA,EAChB31E,KAAKqwE,YAAcA,EACnBrwE,KAAKyuE,SAAWA,EAChBzuE,KAAK+wE,cAAgBA,EACrB/wE,KAAKswE,kBAAoBA,EACzBtwE,KAAK0U,GAAK,IACV1U,KAAKjF,OAAS,KACdiF,KAAK0+B,SAAW,GAChB1+B,KAAK41E,iBAAmB,GACxB51E,KAAKozC,KAAO,KACZpzC,KAAK6B,SAAU,EAEf7B,KAAK61E,iBAAmB,GACxB71E,KAAKqwE,YAAcA,GAAerwE,KAClCA,KAAKyN,MAAQzN,KAAK21E,SAAW31E,KAAOA,KAAKqwE,YAE7C,iBACI,OAAyB,OAAlBrwE,KAAKyuE,SAEhB,sBACI,OAA8B,OAAvBzuE,KAAK+wE,cAEhB,uBACI,OAAO/wE,KAAK8wE,iBAAmB9wE,KAAK+wE,cAAc+E,iBAEtD,YACI,OAAI91E,KAAK+1E,WACE/1E,KAAKyuE,SAEZzuE,KAAK8wE,gBACE9wE,KAAK+wE,cAET,KAEX,sBACI,OAAO/wE,KAAK0+B,SAASz0B,OAAOwD,GAASA,EAAM5L,SAE/C,sBACI,MAAMm0E,EAASh2E,KAAK6wE,gBACpB,KAAOmF,EAAO1yB,KAAK71C,GAASA,EAAMqoE,mBAC9B,IAAK,MAAMroE,KAASuoE,EAAOt3E,QACvB,GAAI+O,EAAMqoE,iBAAkB,CACxB,MAAM5wE,EAAQ8wE,EAAO/sE,QAAQwE,GAC7BuoE,EAAOpkE,OAAO1M,EAAO,KAAMuI,EAAMojE,iBAI7C,OAAOmF,EAEX,uBACI,OAAOh2E,KAAK0+B,SAASz0B,OAAOwD,GAASA,EAAMsoE,YAActoE,EAAM5L,SAC1D1J,IAAIsV,GAASA,EAAMghE,UAE5B,0BACI,OAAIzuE,KAAK8wE,gBACE9wE,KAAK+wE,cAAcn2B,QAE1B56C,KAAK+1E,WACE/1E,KAAKyuE,SAAS7zB,QAAQA,QAE1B,KAEX,oBAAoBq7B,GAChB,OAAOA,EAAehsE,OAAOwD,IAAUA,EAAMqjE,iBAAiB34E,IAAIsV,GAASA,EAAMghE,UAAUzsB,OAAO,CAACk0B,EAAWzH,KAC1GyH,EAAUzH,EAAS14E,MAAQ04E,EACpByH,GACR,IAEP,kBAAkBC,GAAkB,GAChC,OAAOn2E,KAAKo2E,aAAaD,GAAiBlsE,OAAOwkE,GAAYA,EAAS4B,cAAgBrwE,MAE1F,eAAem2E,GAAkB,GAC7B,MAAMH,EAASh2E,KAAKq2E,UAAUF,GAAiBlsE,OAAOwD,GAASA,EAAM4iE,cAAgBrwE,MAErF,IAAK,MAAMyN,KAASuoE,EAAOt3E,QACvB,GAAI+O,EAAMqoE,iBAAkB,CACxB,MAAM5wE,EAAQ8wE,EAAO/sE,QAAQwE,GAC7BuoE,EAAOpkE,OAAO1M,EAAO,KAAMuI,EAAM6oE,kBAGzC,OAAON,EAGX,cAAc52C,EAAcm3C,EAAcC,GAAqB,GAC3D,MAAMC,EAAiB,GACvB,IAAIC,EAAwB,GAC5B,MAAMC,EAAc32E,KAAKs2E,iBAEnBL,EAAiBU,EAAY1sE,OAAOwD,GAASA,EAAMqjE,iBAAiB34E,IAAIsV,GAASA,EAAMsjE,eACvF6F,EAA0BX,EAAehsE,OAAO8mE,GAAiBwF,EAAa3E,MAAMrhD,GAASA,EAAMwgD,gBAAkBA,IAErH8F,EAAqB,IAAK72E,KAAK82E,oBAAoBH,IACzD,IAAK,MAAMz0C,KAAeq0C,EAAatsE,OAAOsmB,GAASA,EAAM9iB,QAAUzN,MACnE62E,EAAmB30C,EAAY60C,cAAgB,KAEnD,MAAMC,EAAuB,IAAI,KAAc53C,EAAa1gC,SAC5D,IAAIwjC,EAAc,KAElB,KAAuD,QAA/CA,EAAc80C,EAAqB5/D,SACL,OAA9B8qB,EAAY6uC,eAA2B/wE,KAAKuvE,OAAO0B,oBAAoBI,yBAAyBnvC,KAChGw0C,EAAsB72E,QAAQG,KAAKi3E,mBAAmB/0C,EAAaA,EAAY6uC,gBAC/E0F,EAAe52E,KAAKqiC,GACpBqrC,EAAYqJ,EAAyBnG,GAAaA,IAAcvuC,EAAY6uC,eAC5EiG,EAAqBE,iBAI7B,IAAKV,EACD,KAAuD,QAA/Ct0C,EAAc80C,EAAqB5/D,SACnC8qB,EAAYusC,WACZiI,EAAsB72E,QAAQG,KAAKm3E,cAAcj1C,EAAaA,EAAYusC,SAAU+H,IACpFC,EAAe52E,KAAKqiC,GACpB20C,EAAmB30C,EAAYusC,SAAS14E,MAAQ,KAChDihF,EAAqBE,iBAKjC,KAAuD,QAA/Ch1C,EAAc80C,EAAqB5/D,SACvC,IAAK,IAAI25D,KAAiBkF,EACtB,GAAIlF,EAAcqG,cAAcl1C,EAAY6sC,eAAgB,CACxD,GAAI50E,MAAMC,QAAQ22E,EAAcntE,QAAS,CAErC,IAAI6sE,EAAYmG,EAAwBtuC,KAAKmoC,GAAaA,EAAU16E,OAASg7E,EAAch7E,MAC3F,QAAkB,IAAd06E,GAAwBzwE,KAAKuvE,OAAO0B,oBAAoBI,yBAAyBnvC,GAAc,CAC/F,MAAMxiC,EAAOqxE,EAAcsG,gBAC3B5G,EAAYzwE,KAAKs2E,iBACZrsE,OAAOwD,GAASA,EAAMqjE,iBACtB34E,IAAIsV,GAASA,EAAMsjE,eACnBzoC,KAAKyoC,GAAiBA,EAAcL,aAAehxE,GAE5DqxE,EAAgBN,EAEpBiG,EAAsB72E,QAAQG,KAAKi3E,mBAAmB/0C,EAAa6uC,IACnE0F,EAAe52E,KAAKqiC,GACpBqrC,EAAYqJ,EAAyBnG,GAAaA,IAAcvuC,EAAY6uC,eAC5EiG,EAAqBE,gBACrB,MAKZ,KAAuD,QAA/Ch1C,EAAc80C,EAAqB5/D,SAAkB,CACzD8qB,EAAYo1C,wBAAyB,EACrC,IAAK,MAAMvhF,KAAQ8gF,EACf,GAAI3gF,OAAOkB,UAAUC,eAAe1B,KAAKkhF,EAAoB9gF,GAAO,CAChE,MAAM04E,EAAWoI,EAAmB9gF,GAEpC,GAAI04E,GAAYA,EAAS8I,cAAcr1C,EAAY6sC,eAAgB,CAC/D,MAAMkD,EAAYjyE,KAAKm3E,cAAcj1C,EAAausC,EAAU+H,GAAoB,GAChFC,EAAe52E,KAAKqiC,GACpBw0C,EAAsB72E,QAAQoyE,GAC9B4E,EAAmB9gF,GAAQ,KAC3BihF,EAAqBE,gBACrB,QAMhB,IAAKV,EACD,KAAuD,QAA/Ct0C,EAAc80C,EAAqB5/D,SAAkB,CACzD,MAAMrhB,EAAOmsC,EAAY60C,aACzB,IAAKhhF,IAASA,EAAKuE,OACf,SAEa4nC,EAAYs1C,UAC7B,IAAKx3E,KAAK82E,oBAAoBH,GAAa5gF,GACvC,SAKJ,MAAM04E,EAAWoI,EAAmB9gF,GACpC,GAAI04E,GAAYA,EAASgJ,gBAAgBv1C,EAAY6sC,eAAgB,CACjE,MAAMkD,EAAYjyE,KAAKm3E,cAAcj1C,EAAausC,EAAU+H,GAAoB,GAChFC,EAAe52E,KAAKqiC,GACpBw0C,EAAsB72E,QAAQoyE,GAC9B4E,EAAmB9gF,GAAQ,KAC3BihF,EAAqBE,iBAKjC,KAAuD,QAA/Ch1C,EAAc80C,EAAqB5/D,SAAkB,CACzD,MAAMsgE,EAAqB,GAC3B,IAAK,MAAM3hF,KAAQ8gF,EACf,GAAI3gF,OAAOkB,UAAUC,eAAe1B,KAAKkhF,EAAoB9gF,GAAO,CAChE,MAAM04E,EAAWoI,EAAmB9gF,GAChC04E,GAAYA,EAASgJ,gBAAgBv1C,EAAY6sC,gBACjD2I,EAAmB73E,KAAK4uE,GAIpC,GAAkC,IAA9BiJ,EAAmBp9E,OAAc,CACjC,MAAMm0E,EAAWiJ,EAAmBvwD,QAC9B8qD,EAAYjyE,KAAKm3E,cAAcj1C,EAAausC,EAAU+H,GAAoB,GAChFC,EAAe52E,KAAKqiC,GACpBw0C,EAAsB72E,QAAQoyE,GAC9B4E,EAAmBpI,EAAS14E,MAAQ,KACpCihF,EAAqBE,iBAI7B,GAAIV,EACA,KAAuD,QAA/Ct0C,EAAc80C,EAAqB5/D,SAAkB,CACzD,IAAIq3D,EAAWvsC,EAAYusC,SAC3B,IAAKA,EAAU,CACX,MAAM14E,EAAOmsC,EAAY60C,aACzB,IAAKhhF,IAASA,EAAKuE,OACf,SAEa4nC,EAAYs1C,UAC7B,IAAKx3E,KAAK82E,oBAAoBH,GAAa5gF,GACvC,SAKJ04E,EAAWoI,EAAmB9gF,GAElC,GAAI04E,GAAYA,EAASgJ,gBAAgBv1C,EAAY6sC,eAAgB,CACjE,MAAMkD,EAAYjyE,KAAKm3E,cAAcj1C,EAAausC,EAAU+H,GAC5DC,EAAe52E,KAAKqiC,GACpBw0C,EAAsB72E,QAAQoyE,GAC9B4E,EAAmBpI,EAAS14E,MAAQ,KACpCihF,EAAqBE,iBAKjC,OADAR,EAAwB,IAAIM,KAAyBN,GAC9C,CACHD,iBACAC,yBAGR,mBAAmBx0C,EAAa6uC,GAC5B7uC,EAAY6uC,cAAgBA,EAC5B7uC,EAAYo1C,wBAAyB,EACrC,MAAMrF,GAAa/vC,EAAYy1C,uBAAyB,IAAIj5E,QAC5D,IAAK,MAAMk5E,KAAO3F,EACI,OAAd2F,EAAInqE,QACJmqE,EAAInqE,MAAQsjE,EAActjE,MAAMA,OAGxC,OAAOwkE,EAEX,cAAc/vC,EAAausC,EAAUoJ,EAAkBC,GAA8B,GACjF51C,EAAY61C,YAAYtJ,GACpBqJ,IACA51C,EAAYo1C,wBAAyB,GAEzC,MAAMrF,GAAa/vC,EAAYy1C,uBAAyB,IAAIj5E,QAC5D,IAAK,MAAMk5E,KAAO3F,EACI,OAAd2F,EAAInqE,QACJmqE,EAAInqE,MAAQghE,EAAShhE,OAG7B,OAAOwkE,EAEX,YAAYl8E,EAAM8xB,EAASxkB,EAAWg7B,EAAU,IAC5C,IAAIowC,EAAWzuE,KAAK82E,oBAAoB92E,KAAKs2E,kBAAkBvgF,GAiB/D,OAfI8xB,GAAW4mD,GAAiC,OAArBA,EAAS5mD,SAAoB4mD,EAAS5mD,UAAYA,IACzE4mD,EAAS5sE,SAAU,EACnB4sE,EAAWzuE,KAAKg4E,mBAAkB,GAAM1vC,KAAK6R,GAASA,EAAMpkD,OAASA,GAAQokD,EAAMtyB,UAAYA,IAAY,KACvG4mD,IACAA,EAAS5sE,SAAU,IAGtB4sE,IACDA,EAAW,IAAI,GAASzuE,KAAKuvE,OAAQx5E,EAAM,KAAM,KAAMiK,KAAKyN,QAAS4wB,EAAQ5wB,MAAO4wB,GACpFr+B,KAAKi4E,SAASxJ,EAASmC,kBAGvB/oD,GAAWxkB,IACXorE,EAASyJ,WAAWrwD,EAASxkB,EAAWg7B,GAErCowC,EAEX,eAAeA,EAAU5mD,EAASxkB,GAC9B,SAAMwkB,GAAYxkB,KAAcorE,EAASr4C,OAAOvO,EAASxkB,MACrDrD,KAAK87C,YAAY2yB,EAASmC,iBACnB,GAIf,iBAAiB76E,EAAM8xB,EAASwW,EAAU,IACtC,MAAM0yC,EAAgB,IAAI,EAAch7E,EAAMiK,KAAKuvE,OAAQ1nD,EAAS7nB,KAAKyN,OAAO,EAAM,KAAM4wB,GAE5F,OADAr+B,KAAKi4E,SAASlH,EAAcH,gBACrBG,EAEX,oBAAoBA,GAGhB,OADA/wE,KAAK87C,YAAYi1B,EAAcH,iBACxB,EAEX,SAASnjE,GACAzN,KAAK0+B,SAAS4kB,KAAK60B,GAAMA,IAAO1qE,KACZ,OAAjBA,EAAM1S,QACN0S,EAAM1S,OAAO+gD,YAAYruC,GAE7BzN,KAAK0+B,SAAS7+B,KAAK4N,GACnBA,EAAM1S,OAASiF,MAGvB,YAAYyN,GACR,MAAMvI,EAAQlF,KAAK0+B,SAASz1B,QAAQwE,GAChCvI,GAAS,IACTlF,KAAK0+B,SAAS9sB,OAAO1M,EAAO,GAC5BuI,EAAM1S,OAAS,MAGvB,wBACIiF,KAAK41E,iBAAmB,GAE5B,0BACI51E,KAAK41E,iBAAmB51E,KAAK6wE,gBAC7B,IAAK,MAAMpjE,KAASzN,KAAK41E,iBACrBnoE,EAAM5L,SAAU,EAGxB,2BACI,IAAK,MAAM4L,KAASzN,KAAK41E,iBACrBnoE,EAAM5L,SAAU,EAGxB,aAAas0E,GAAkB,EAAOiC,GAAkB,GACpD,OAAOp4E,KAAKq2E,UAAUF,EAAiBiC,GAAiBnuE,OAAOwD,GAASA,EAAMsoE,YAAY59E,IAAIsV,GAASA,EAAMghE,UAEjH,UAAU0H,GAAkB,EAAOiC,GAAkB,GACjD,MAAMpC,EAASG,EAAkBn2E,KAAK0+B,SAAShgC,QAAUsB,KAAK6wE,gBAC9D,IAAK,MAAMpjE,KAASuoE,EAAOt3E,QACvBs3E,EAAOn2E,QAAQ4N,EAAM4oE,UAAUF,EAAiBiC,IAEpD,OAAOpC,EAEX,+BACI,MAAMA,EAASh2E,KAAKq4E,gBACfpuE,OAAOwD,GAAuC,OAA9BA,EAAMujE,qBAAgCvjE,EAAMujE,oBAAoBjC,eACrF,IAAKiH,EAAO17E,OACR,OAAO,KAEX,IAAK,MAAMmT,KAASuoE,EAAQ,CACxB,MAAM9yC,EAAoBz1B,EAAM6qE,+BAChC7qE,EAAMujE,oBAAoB2G,sBACA,OAAtBz0C,GAA8BA,EAAkB5oC,OAAS,EAAI4oC,EAAoB,KAEzF,OAAO8yC,EAAO79E,IAAIsV,GAASA,EAAMujE,qBAErC,kBAAkB59B,GACd,GAAIpzC,KAAK8wE,kBAAoB9wE,KAAK81E,iBAC9B,OAAO91E,KAAKu4E,0BAA0BnlC,EAAMpzC,KAAK+wE,cAAcyH,aAEnE,GAAIx4E,KAAK+1E,WACL,OAAO/1E,KAAKu4E,0BAA0BnlC,EAAMpzC,KAAKyuE,SAAS+J,aAG9D,IAAK,MAAMr+B,KAASn6C,KAAK6wE,gBAAiB,CACtC,MAAMtgD,EAAQ4pB,EAAMs+B,kBAAkBrlC,GACtC,GAAc,OAAV7iB,EACA,OAAOA,EAGf,OAAO,KAEX,iBAII,cAHsBmH,QAAQva,IAAInd,KAAK0+B,SAASvmC,IAAIgiD,GAA4B,OAAnBA,EAAMs0B,SAC7Dt0B,EAAMs0B,SAASiB,WACfv1B,EAAMu1B,cACIpsB,KAAKzmD,IAAqB,IAAXA,GAEnC,0BAA0Bu2C,EAAM0+B,GAC5B,IAAK33E,MAAMC,QAAQ03E,GACf,OAAO,KAGX,MAAM4G,GADN5G,EAASA,EAAO35E,IAAIm6E,GAAStyE,KAAK24E,kBAAkBrG,KAC7Bn6E,IAAIm6E,IAAS,CAChCl/B,KAAMk/B,EAAMl/B,KACZhtC,QAASksE,KAEb,IAAK,IAAI98E,EAAI,EAAGkS,EAAKgxE,EAAQp+E,OAAQ9E,EAAIkS,IAAMlS,EAAG,CAC9C,MAAMojF,EAASF,EAAQljF,GACvBkjF,EAAQ74E,KAAK,IACN+4E,EACHxlC,KAAM,GAAGwlC,EAAOxlC,wBAGxB,MAAM7iB,EAAQ,IAAIwhD,EAClB,IAAIrwE,EAAS,IACT0xC,EAAK3wC,WAAW,MAAQ2wC,EAAK3wC,WAAW,QACxC2wC,EAAOA,EAAK10C,MAAM,IAEtB,MAAMm6E,EAAa,IAAI,EACvBA,EAAWj9E,IAAI88E,GACf,MAAM77E,EAASg8E,EAAWC,UAAU1lC,GACpC,GAAe,OAAXv2C,EAAiB,CACjB0zB,EAAMsiB,MAAQh2C,EAAO41E,SAASH,MAAMlsE,QACpCmqB,EAAMyhD,SAAW5+B,EACjB,MAAM2lC,EAAU,IAAKl8E,EAAO6E,aACE,IAA1Bq3E,EAAQC,gBACRzoD,EAAM0hD,UAAY8G,EAAQC,cAC1Bx8E,QAAQuZ,eAAegjE,EAAS,iBAChCxoD,EAAMyhD,SAAWzhD,EAAMyhD,SAAStzE,MAAM,EAAG6xB,EAAMyhD,SAAS/oE,QAAQsnB,EAAM0hD,aAE1EvwE,EAASq3E,EAEb,GAAIxoD,EAAM0oD,mBAAoB,CAE1B1oD,EAAM6O,aAAep/B,KAAKuvE,OAAO0B,oBAAoBiI,0BAA0B3oD,EAAMsiB,MAAMzT,cAAc,GAAO,GAChH,MAAMA,EAAe7O,EAAM6O,aAAa1gC,QACxC,KAAO0gC,EAAa9kC,OAAS,GAAG,CAC5B,MAAM4nC,EAAc9C,EAAajY,QACjC+a,EAAYi3C,cAAcz3E,GAC1BwgC,EAAYowC,MAAQ,GACsB,OAAtCpwC,EAAYy1C,uBACZv4C,EAAapY,WAAWkb,EAAYy1C,uBAGxCpnD,EAAM6O,aAAa9kC,OAAS,IAC5Bi2B,EAAM6O,aAAa,GAAGkzC,MAAQ/hD,EAAMyhD,UAG5C,OAAOzhD,EAEX,kBAAkB+hD,GAKd,YAJiB,IAAbA,EAAM59D,KACN49D,EAAM59D,GAAK49D,EAAMl/B,MAErBk/B,EAAMlzC,aAAeg6C,GAA8BC,uBAAuBr5E,KAAKuvE,OAAQ+C,EAAMlzC,cACtFkzC,GCrbR,MAAM,GACT,YAAY/C,EAAQx5E,EAAM8xB,EAASxkB,EAAWgtE,EAAa5iE,EAAO4wB,EAAU,IACxEr+B,KAAKuvE,OAASA,EACdvvE,KAAKjK,KAAOA,EACZiK,KAAK6nB,QAAUA,EACf7nB,KAAKqD,UAAYA,EACjBrD,KAAKq+B,QAAUA,EACfr+B,KAAKwwE,YAAc,KACnBxwE,KAAKs5E,aAAc,EACnBt5E,KAAKozC,KAAO,KACZpzC,KAAK2sB,OAAQ,EACb3sB,KAAKu5E,eAAiB,KACtBv5E,KAAKw5E,sBAAwB,KAC7Bx5E,KAAKzB,MAAQ,GACbyB,KAAKy5E,aAAe,GACpBz5E,KAAK46C,QAAU,IAAI,EACnB56C,KAAK4wE,eAAiB,IAAI,GAAMrB,EAAQ9hE,EAAO4iE,EAAarwE,MAEhE,YACI,OAAOA,KAAK4wE,eAAenjE,MAE/B,kBACI,OAAOzN,KAAK4wE,eAAeP,YAE/B,cACI,OAAOrwE,KAAK4wE,eAAe/uE,QAE/B,YAAYA,GACR7B,KAAK4wE,eAAe/uE,QAAUA,EAElC,iBACI,OAAO,EAEX,sBACI,OAAO,EAEX,cACI,OAA0C,OAAnC7B,KAAK46C,QAAQ4zB,kBAExB,oBACI,IAAI/gE,EAAQzN,KAAK4wE,eACjB,KAAiB,OAAVnjE,GAAgB,CACnB,GAAuB,OAAnBA,EAAMghE,UAAqBhhE,EAAMghE,SAAS6K,YAC1C,OAAO,EAEX7rE,EAAQA,EAAM1S,OAElB,OAAO,EAEX,eAAe6/C,EAAS1Y,GACpB,IAAI8uC,EAmBJ,GAjBIA,EADAp2B,aAAmB,GACGA,EAGC,iBAAZA,EACe56C,KAAKuvE,OAAO0B,oBAAoBC,yBAAyBt2B,GAGzD56C,KAAKuvE,OAAOC,0BAA0B50B,GAGpEo2B,EAAoB+G,YAAY/3E,MAChCA,KAAK2sB,MAAQ3sB,KAAKuvE,OAAO0B,oBAAoBE,2BAA2BH,GAExEhxE,KAAKwwE,YAAc,IAAI,EAAiBxwE,KAAK2sB,WAA8B,EAAtBqkD,EAA8B9uC,EAAaliC,KAAKqD,WACrGrD,KAAKwwE,YAAYrC,eAAcnuE,KAAKwwE,YAAYhC,oBAAqBtsC,EAAYw3C,gBACzEx3C,EAAYw3C,WAAWC,QAAUz3C,EAAYw3C,WAAWE,SAE5D55E,KAAKq+B,QAAQsxC,SAAU,CAEvB,MAAMkK,EAAS75E,KAAKzB,MAAM+pC,KAAM5oC,GAASM,KAAKwwE,YAAYsJ,aAAap6E,IACnEm6E,GACA75E,KAAKwwE,YAAcqJ,EACnB75E,KAAKwwE,YAAYtC,WAAY,GAG7BluE,KAAKzB,MAAMsB,KAAKG,KAAKwwE,aAO7B,OAFAxwE,KAAK4wE,eAAemJ,wBAEuB,OAAvC/5E,KAAKwwE,YAAYhC,mBAA8BxuE,KAAK46C,QAAQ4zB,oBAAsBxuE,KAAKwwE,YAAYhC,mBACnGxuE,KAAKwwE,YAAc,MACZ,IAGNxwE,KAAK46C,QAAQo/B,eAAeh6E,KAAKwwE,cAClCtuC,EAAYw3C,WAAWO,SACY,YAAnCj6E,KAAK46C,QAAQ+zB,mBACb3uE,KAAK4wE,eAAesJ,2BACb,GAG4B,aAAnCl6E,KAAK46C,QAAQ+zB,mBACb3uE,KAAKwwE,YAAc,MACZ,GAG4B,UAAnCxwE,KAAK46C,QAAQ+zB,mBACb3uE,KAAK46C,QAAQwzB,SAAU,EACvBpuE,KAAKwwE,YAAY51B,QAAQo0B,aAAahvE,KAAK46C,QAAQ4zB,mBACnDxuE,KAAKwwE,YAAYxC,cAAgBhuE,KAAK46C,QAAQozB,cAC9ChuE,KAAKwwE,YAAYpC,QAAUpuE,KAAK46C,QAAQwzB,SACjC,GAIPpuE,KAAKq+B,QAAQsxC,UACb3vE,KAAK46C,QAAQu/B,gBAAgBn6E,KAAKwwE,cAClCxwE,KAAKwwE,YAAc,MACZ,IAGXxwE,KAAK4wE,eAAesJ,2BACb,GAEX,WAAWryD,EAASxkB,EAAWg7B,GAoC3B,GAnCAA,EAAUA,GAAW,GACjBr+B,KAAK6nB,UAAYA,IAEjB7nB,KAAKw5E,sBAAwB,IAAKx5E,MAClCA,KAAKo6E,aACLp6E,KAAK6nB,QAAUA,EACXwW,EAAQg8C,SACRr6E,KAAKq+B,QAAQg8C,OAASh8C,EAAQg8C,QAE9Bh8C,EAAQ+qB,UACRppD,KAAKq+B,QAAQ+qB,QAAU/qB,EAAQ+qB,SAE/B/qB,EAAQuwC,WACR5uE,KAAKq+B,QAAQuwC,SAAWvwC,EAAQuwC,UAEhCvwC,EAAQi8C,SACRt6E,KAAKq+B,QAAQi8C,OAASj8C,EAAQi8C,QAE9Bj8C,EAAQk8C,YACRv6E,KAAKq+B,QAAQk8C,UAAYl8C,EAAQk8C,WAEjCl8C,EAAQsxC,WACR3vE,KAAKq+B,QAAQsxC,SAAWtxC,EAAQsxC,UAEhC3vE,KAAKu5E,gBACLv5E,KAAKu5E,kBAOTv5E,KAAKqD,YAAcA,IACnBrD,KAAKqD,UAAYA,IAEhBrD,KAAK46C,QAAQ4zB,qBAAuBxuE,KAAKwwE,cAAgBxwE,KAAKwwE,YAAYhC,oBAAsBxuE,KAAKq+B,QAAQ+qB,QAAS,CACvH,MAAMhqB,EAAep/B,KAAKuvE,OAAO0B,oBAAoBuJ,0BAA0Bx6E,KAAKq+B,QAAQ+qB,SAC5F,IAAK,MAAMlnB,KAAe9C,EAEtB8C,EAAY61C,YAAY/3E,KAAKjK,MAC7BmsC,EAAYz0B,MAAQzN,KAAKqwE,YACzBnuC,EAAYknB,SAAU,EAE1BppD,KAAKuvE,OAAOrC,KAAK9tC,EAAc,CAAEmmB,QAAQ,IAAQ1sB,MAAMl3B,IAAW,MAAMA,KAGhF,aAAakmB,EAASxkB,GAClB,OAAIrD,KAAK6nB,UAAYA,GAAW7nB,KAAKqD,YAAcA,IAC3CrD,KAAK46C,QAAQ4zB,yBACPxuE,KAAK46C,QAAQ6/B,YAAYz6E,KAAK6nB,QAAU7nB,KAAKwwE,YAAcxwE,KAAKwwE,YAAYtuC,YAAc,KAAOliC,KAAKy5E,cAAcz5E,KAAK06E,gBAAwB16E,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,WAEnM3vE,KAAK06E,sBACChjD,QAAQva,IAAInd,KAAKy5E,aAAathF,IAAIyiD,GAAWA,EAAQ6/B,YAAY,KAAM,KAAMz6E,KAAKy5E,cAAc,KACtGz5E,KAAKy5E,aAAe,KAEjB,GAIf,iBAEI,cAD+Bz5E,KAAK4wE,eAAelB,YAI5C1vE,KAAK46C,QAAQ80B,SAAS1vE,KAAKwwE,YAAcxwE,KAAKwwE,YAAYtuC,YAAc,MAEnF,iBACI,QAAIliC,KAAK2sB,OAGkC,QAAtC3sB,KAAKwwE,YAAY51B,SAAW,cAG3B56C,KAAK46E,iBACX56E,KAAKwwE,YAAYluC,gBAAgBtiC,KAAKqD,UAAWrD,KAAKq+B,QAAQuwC,gBACxD5uE,KAAKwwE,YAAYqK,cAAc76E,KAAKqD,UAAWrD,KAAK6nB,QAAS7nB,MAC5DA,KAAKwwE,YAAYrB,SAASnvE,KAAMA,KAAK46C,QAAQ1Y,cAExD,cAEI,OADA,IAASh6B,MAAM,IAAO,iBAAkBlI,KAAKjK,QACzCiK,KAAK2sB,UAGJ3sB,KAAKwwE,cAAgBxwE,KAAKwwE,YAAYhC,2BAGrCxuE,KAAKwwE,YAAYrgE,MAAMnQ,KAAK46C,QAAQ1Y,aAE1CliC,KAAKwwE,YAAYsK,oBAAoB,IAAcrmD,IAAIz0B,KAAK6nB,WACrD,GAEX,oBA4BI,OA3BA,IAAS3f,MAAM,IAAO,uBAAwBlI,KAAKjK,MAE/CiK,KAAK46C,QAAQ4zB,oBAAsBxuE,KAAKwwE,YAAYhC,0BAC9CxuE,KAAK46C,QAAQtqC,MAAMtQ,KAAKwwE,YAAYtuC,mBACpCliC,KAAK+6E,iBAEX/6E,KAAKwwE,YAAYhC,oBACbxuE,KAAK46C,QAAQ4zB,oBAAsBxuE,KAAKwwE,YAAYhC,kBACpDxuE,KAAKwwE,YAAY9N,aAAa1iE,KAAK6nB,SAGnC7nB,KAAK4wE,eAAeoK,2BAGpBh7E,KAAK46C,QAAQ4zB,0BACPxuE,KAAK46C,QAAQtqC,MAAMtQ,KAAKwwE,YAAYtuC,aACrCliC,KAAK46C,QAAQwzB,SAAWpuE,KAAK46C,QAAQ4zB,oBAAsBxuE,KAAKwwE,YAAYhC,yBACvExuE,KAAK+6E,iBAGnB/6E,KAAK46C,QAAU56C,KAAKwwE,YACpBxwE,KAAK46C,QAAQwzB,SAAU,GAEvBpuE,KAAK2sB,QACL3sB,KAAK46C,QAAU,IAAI,OAAgB,EAAQ56C,KAAKwwE,YAAYtuC,cAEhEliC,KAAKwwE,YAAc,MACZ,EAEX,wBACIxwE,KAAKw5E,sBAAwB,KAC7Bx5E,KAAK4wE,eAAemJ,wBAExB,2BACI/5E,KAAK4wE,eAAeoK,iCACdh7E,KAAKwwE,YAAYiK,YAAYz6E,KAAK6nB,QAAS7nB,KAAKwwE,YAAYtuC,YAAaliC,KAAKy5E,aAAcz5E,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,UAC1I3vE,KAAKw5E,uBACLtjF,OAAOoH,OAAO0C,KAAMA,KAAKw5E,uBAIjC,cAAcn3C,GACV,IAAIg4C,EAASr6E,KAAKq+B,QAAQg8C,QAAU,GAIpC,MAHsB,iBAAXA,IACPA,EAASA,EAAO5pD,MAAM,MAEnB4pD,EAAOlrE,SAASkzB,GAG3B,gBAAgBA,GACZ,GAAkB,MAAdA,GAAmC,OAAdA,EACrB,OAAO,EAEX,IAAIg4C,EAASr6E,KAAKq+B,QAAQg8C,OAC1B,OAAKA,IAAWA,EAAO//E,SAGD,iBAAX+/E,IACPA,EAASA,EAAO5pD,MAAM,QAEtB4pD,EAAOlrE,SAASkzB,MAGhBg4C,EAAOpwE,OAAQxT,GAAUA,EAAM0Y,SAAS,MAAM7U,QAKtD,WAAW+Z,GACHrU,KAAK46C,QAAQ4zB,mBACbxuE,KAAK46C,QAAQkgC,oBAAoB,IAAcrmD,IAAIz0B,KAAK6nB,UAGhE,mBAAmBxT,GACfrU,KAAK6B,SAAU,EACX7B,KAAK46C,QAAQ4zB,0BAEPxuE,KAAK46C,QAAQzqC,MAAMnQ,KAAK46C,QAAQ1Y,aACtCliC,KAAK46C,QAAQ8nB,aAAa1iE,KAAK6nB,UAGvC,mBAAmBxT,GACXrU,KAAK46C,QAAQ4zB,0BAEPxuE,KAAK46C,QAAQtqC,MAAMtQ,KAAK46C,QAAQ1Y,aACtCliC,KAAK46C,QAAQq1B,gBAAgBjwE,KAAK6nB,SAAS7nB,KAAK06E,gBAAwB16E,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,YAExH3vE,KAAK6B,SAAU,EAEnB,mBAAmBwS,GACXrU,KAAK46C,QAAQ4zB,yBACPxuE,KAAK46C,QAAQs1B,oBAAmBlwE,KAAK06E,gBAAwB16E,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,WAGvH,kBAAkBttC,GACd,MAAMuY,EAAU56C,KAAKy5E,aAAanxC,KAAKuxC,GAAUA,EAAOrL,oBAAsBnsC,QAC9D,IAAZuY,IACA56C,KAAKs5E,aAAc,QACb1+B,EAAQ6/B,YAAY,KAAM,KAAMz6E,KAAKy5E,cAAc,GACzDz5E,KAAKs5E,aAAc,EACnB/L,EAAYvtE,KAAKy5E,aAAeI,GAAUA,IAAWj/B,IAG7D,YACI,IAAI0zB,EAAqC,OAArBtuE,KAAKwwE,aACW,OAA7BxwE,KAAKwwE,YAAY51B,QAClB56C,KAAKwwE,YAAY51B,QAAQ0zB,cACzBtuE,KAAK46C,QAAQA,QAAQ0zB,cAE3B,GAAIA,QAAoD,CAEpDA,EADmB,IAAc75C,IAAIz0B,KAAK6nB,SACf7oB,QAAQsvE,cAEvC,GAAIA,QACA,OAAO,KAEX,MAAMwD,EAASxD,EAAcwD,OAC7B,OAAO33E,MAAMC,QAAQ03E,GAAUA,EAAS,KAE5C,sBACI9xE,KAAK46C,QAAQq1B,gBAAgBjwE,KAAK6nB,QAAS7nB,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,gBACjF3vE,KAAK46C,QAAQs1B,mBAAmBlwE,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,UAClF3vE,KAAK46C,QAAQu1B,gBAAgBnwE,KAAKy5E,aAAcz5E,KAAKuvE,OAAOoL,iBAAmB36E,KAAKq+B,QAAQsxC,UAC5F3vE,KAAK46C,QAAQw1B,mBAEjB,aACIpwE,KAAKq+B,QAAU,GACfr+B,KAAK46C,QAAU,IAAI,EACnB56C,KAAKzB,MAAQ,GAEjB,uBACI,OAAIyB,KAAK6nB,QACE6P,QAAQvxB,UAEZ,IAAIuxB,QAASvxB,IAChBnG,KAAKu5E,eAAiBpzE,KC9V3B,MAAM80E,GAA+B,CACxCC,OAAQ,SAAU74C,GACd,MAA4B,iBAAdA,GAElB1jB,OAAQ,SAAU0jB,GACd,OAAO,IAAc1jB,OAAO0jB,IAEhC84C,WAAY,SAAU94C,GAClB,OAAQ44C,GAA6BC,OAAO74C,KAAe44C,GAA6Bt8D,OAAO0jB,IAEnG+4C,QAAS,SAAU/4C,GACf,OAAI44C,GAA6BC,OAAO74C,GAC7BA,EAEF44C,GAA6Bt8D,OAAO0jB,GAClC,IAAcwD,cAAcxD,GAAWtsC,KAGvCklF,GAA6BG,QAAQ/4C,EAAU18B,cAG9D01E,QAAS,SAAUh5C,GACf,OAAI44C,GAA6BC,OAAO74C,GAC7B,KAEF44C,GAA6Bt8D,OAAO0jB,GAClCA,EAGAA,EAAU18B,aAGzB21E,YAAa,SAAUj5C,GACnB,OAAI44C,GAA6BC,OAAO74C,IAAc44C,GAA6Bt8D,OAAO0jB,GAC/E,KAGAA,IAINk5C,GAAyB,CAClCL,OAAQ,SAAUzM,GACd,MAA2B,iBAAbA,GAElB0M,WAAY,SAAU1M,GAClB,OAAOA,aAAoB,IAE/B2M,QAAS,SAAU3M,GACf,OAAI8M,GAAuBL,OAAOzM,GACvBA,EAGAA,EAAW,EAAW14E,KAAO,MAG5CulF,YAAa,SAAU7M,GACnB,OAAI8M,GAAuBL,OAAOzM,GACvB,KAGAA,IAIN2K,GAAgC,CACzCoC,2BAA4B,SAAUjM,EAAQkM,EAAwBp9C,GAElE,IAAI5wB,EAAQ,KACZ,IAFA4wB,EAAUA,GAAW,IAETr/B,QAER,GADAyO,EAAQ8hE,EAAOmM,UAAUr9C,EAAQr/B,SACK,iBAA3By8E,EAEP,GAAKA,EAAuBh5E,WAAW,KAmBnCgL,EAAQ8hE,EAAOoM,UAAUluE,UAnBgB,CAEzC,GAAIguE,EAAuBh5E,WAAW,KAMlC,IAJIg5E,EAAuBh5E,WAAW,QAClCg5E,EAAyBA,EAAuB/8E,MAAM,IAGnD+8E,EAAuBh5E,WAAW,QACrCgL,EAAQA,EAAM1S,QAAU0S,EACxBguE,EAAyBA,EAAuB/8E,MAAM,GAG3C,OAAf+O,EAAM2lC,OACNqoC,EAAyB,GAAGhuE,EAAM2lC,QAAQqoC,IAC1ChuE,EAAQ8hE,EAAOoM,UAAUluE,WAOhC,CACDguE,EAAyBrC,GAA8BC,uBAAuB9J,EAAQkM,GACtF,IAAK,MAAMv5C,KAAeu5C,EACI,OAAtBv5C,EAAYz0B,QACZy0B,EAAYz0B,MAAQA,GAKpC,MAAO,CACH2xB,aAAcq8C,EACdhuE,UAGR4rE,uBAAwB,SAAU9J,EAAQkM,GACtC,IAAKthF,MAAMC,QAAQqhF,GACf,OAAOrC,GAA8BC,uBAAuB9J,EAAQ,CAACkM,IAEzE,MAAMr8C,EAAe,GACrB,IAAK,MAAM8C,KAAeu5C,EACtB,GAA2B,iBAAhBv5C,EACP9C,EAAav/B,QAAQ0vE,EAAO0B,oBAAoBuJ,0BAA0Bt4C,SAEzE,GAAIA,aAAuB,GAC5B9C,EAAav/B,KAAKqiC,QAEjB,GAAIA,EAAYG,UAAW,CAC5B,MAAMu5C,EAAoB15C,EACpB25C,EAAiBtM,EAAOC,0BAA0BoM,EAAkBv5C,UAAWu5C,EAAkBnN,SAAUmN,EAAkBnQ,iBAChG,IAA/BmQ,EAAkBl9C,UAAsD,OAA/Bk9C,EAAkBl9C,WAC3Dm9C,EAAelE,sBAAwByB,GAA8BC,uBAAuB9J,EAAQqM,EAAkBl9C,WAE1HU,EAAav/B,KAAKg8E,QAGlBz8C,EAAav/B,KAAK0vE,EAAOC,0BAA0BttC,IAG3D,OAAO9C,ICnIR,IAAI08C,GCLAC,GCIAC,IFEX,SAAWF,GACPA,EAAqB,KAAI,OACzBA,EAAuB,OAAI,SAC3BA,EAAsB,MAAI,QAC1BA,EAAuB,OAAI,SAJ/B,CAKGA,KAAmBA,GAAiB,KAIhC,MAAM,GACT,YAAYz5C,EAAWosC,EAAUhD,EAAY+L,GAAY,EAAMG,EAAwB,MACnF33E,KAAKw3E,UAAYA,EACjBx3E,KAAK23E,sBAAwBA,EAC7B33E,KAAK+uE,cAAgB,KACrB/uE,KAAKsuE,cAAgB,KACrBtuE,KAAKwuE,kBAAoB,KACzBxuE,KAAK+2E,aAAe,KACpB/2E,KAAKyuE,SAAW,KAChBzuE,KAAKi8E,iBAAmB,KACxBj8E,KAAKk8E,iBAAmB,KACxBl8E,KAAKm8E,eAAiB,KACtBn8E,KAAKo8E,eAAiB,OACtBp8E,KAAKyN,MAAQ,KACbzN,KAAKhB,QAAU,GACfgB,KAAK+wE,cAAgB,KACrB/wE,KAAKs3E,wBAAyB,EAC9Bt3E,KAAKsyE,MAAQ,KACbtyE,KAAKopD,SAAU,EACfppD,KAAKixE,oBAAsB,KAC3BjxE,KAAKgvE,aAAa3sC,GAClBriC,KAAK+3E,YAAYtJ,GACjBzuE,KAAK8uE,cAAcrD,GAEvB,YACI,OAAOzrE,KAAKyuE,UAAYzuE,KAAK+wE,eAAiB,KAElD,sBACI,OAAQ/wE,KAAKo8E,gBACT,IAAK,SACD,OAAOp8E,KAAKi8E,iBAChB,IAAK,QACD,OAAOj8E,KAAKm8E,eAChB,IAAK,SACD,OAAOn8E,KAAKk8E,iBAChB,QACI,OAAO,MAGnB,iBACI,OAAiC,OAA7Bl8E,KAAKixE,oBACEjxE,KAAKixE,oBAAoBoL,yBAAyBr8E,KAAKs8E,iBAE3D,GAEX,2BACI,OAAiC,OAA7Bt8E,KAAKixE,qBAAyD,OAAzBjxE,KAAKs8E,gBACnCt8E,KAAKixE,oBAAoBsL,6BAA6Bv8E,KAAKyrE,YAE/D,GAEX,aAAappC,GACL44C,GAA6BC,OAAO74C,IACpCriC,KAAK+uE,cAAgBkM,GAA6BG,QAAQ/4C,GAC1DriC,KAAKsuE,cAAgB,KACrBtuE,KAAKwuE,kBAAoB,MAEpByM,GAA6Bt8D,OAAO0jB,IACzCriC,KAAK+uE,cAAgBkM,GAA6BG,QAAQ/4C,GAC1DriC,KAAKsuE,cAAgB2M,GAA6BI,QAAQh5C,GAC1DriC,KAAKwuE,kBAAoB,MAEpByM,GAA6BE,WAAW94C,KAC7CriC,KAAK+uE,cAAgBkM,GAA6BG,QAAQ/4C,GAC1DriC,KAAKsuE,cAAgB2M,GAA6BI,QAAQh5C,GAC1DriC,KAAKwuE,kBAAoByM,GAA6BK,YAAYj5C,IAG1E,YAAYosC,QACStpE,IAAbspE,GAAuC,KAAbA,IAC1BA,EAAW,MAES,iBAAbA,GACPzuE,KAAK+2E,aAAetI,EACpBzuE,KAAKyuE,SAAW,OAGhBzuE,KAAKyuE,SAAWA,EACC,OAAbA,IACAzuE,KAAK+2E,aAAetI,EAAS14E,KAC7BiK,KAAKyN,MAAQghE,EAAS4B,cAIlC,cAAc5E,GACNA,SAAkE,KAAfA,GACnDzrE,KAAKo8E,eAAiB,OACtB3Q,EAAa,MAEc,iBAAfA,GACZzrE,KAAKo8E,eAAiB,SACtBp8E,KAAKi8E,iBAAmBxQ,GAEnBtxE,MAAMC,QAAQqxE,IACnBzrE,KAAKo8E,eAAiB,QACtBp8E,KAAKm8E,eAAiB1Q,IAGtBzrE,KAAKo8E,eAAiB,SACtBp8E,KAAKk8E,iBAAmBzQ,GAIhC,cAAcA,GACV,GAA4B,SAAxBzrE,KAAKo8E,eACL,OAAOp8E,KAAK8uE,cAAcrD,GAE9B,GAA4B,WAAxBzrE,KAAKo8E,eACL,MAAM,IAAI37E,MAAM,kEAEpBT,KAAK8uE,cAAc,IAAK9uE,KAAKk8E,oBAAqBzQ,IAEtD,uBAAuBwF,GACnBjxE,KAAKixE,oBAAsBA,EAE/B,UACI,OAAQjxE,KAAKw8E,oBAAsBx8E,KAAKquE,oBAAsBruE,KAAKy8E,sBAEvE,kBACI,QAASz8E,KAAK+uE,gBAAkB/uE,KAAKquE,oBAAsBruE,KAAKy8E,sBAEpE,kBACI,OAA8B,OAAvBz8E,KAAKsuE,gBAA2BtuE,KAAKy8E,sBAEhD,sBACI,OAAkC,OAA3Bz8E,KAAKwuE,kBAEhB,gBAAgBnrE,GACZ,GAA2B,OAAvBrD,KAAKsuE,cACL,OAAOtuE,KAAKsuE,cAEhB,GAA2B,OAAvBtuE,KAAK+uE,eAC4B,iBAAvB/uE,KAAK+uE,eACE,OAAd1rE,GACAA,EAAUlK,IAAI,IAAcgjB,QAAQnc,KAAK+uE,gBAAgB,GAAO,CACnE,MAAM9oE,EAAW5C,EAAU8D,YAAY,IAAcgV,QAAQnc,KAAK+uE,gBAClE,GAAiB,OAAb9oE,QAA6C,IAAxBA,EAASc,WAAuB,CACrD,MAAMD,EAAUb,EAASc,WAAW1D,GACpC,GAAIyD,EACA,OAAOA,EAAQ/F,MAI3B,OAAO,KAEX,oBAAoBsC,GAChB,OAA+B,OAA3BrD,KAAKwuE,kBACExuE,KAAKwuE,kBAEZnrE,QACIrD,KAAKquE,kBACEhrE,EAAUhN,IAAI2J,KAAKsuE,eAGnBjrE,EAAUhN,IAAI,IAAc8lB,QAAQnc,KAAK+uE,gBAGjD,KAEX,mBAAmBQ,GACf,OAAsB,OAAlBvvE,KAAKyuE,SACEzuE,KAAKyuE,SAETc,EAAOmN,YAAY18E,KAAK+2E,cAEnC,sBAAsB4F,GAClBA,EAAiBA,GAAkB,GACnC,MAAMlR,EAAazrE,KAAKyrE,WAClBmR,EAAY,GAClB,IAAK,MAAMh3B,KAAQ+2B,EAAgB,CAE/B,IAAIz3E,EAAQumE,EAAW/5B,UAAUi8B,GAASA,EAAM52E,MAAQ6uD,GACxD,GAAI1gD,GAAS,EAAG,CACZ,MAAO23E,GAAapR,EAAW75D,OAAO1M,EAAO,GAC7C03E,EAAUh3B,GAAQi3B,EAAUpmF,WAK5B,GADAyO,EAAQumE,EAAW/5B,UAAUi8B,QAAuB,IAAdA,EAAM52E,KACxCmO,GAAS,EAAG,CACZ,MAAO23E,GAAapR,EAAW75D,OAAO1M,EAAO,GAC7C03E,EAAUh3B,GAAQi3B,EAAUpmF,OAKxC,IAAK,MAAMomF,KAAapR,EAAWxhE,OAAO0jE,QAAuB,IAAdA,EAAM52E,KACrD6lF,EAAUC,EAAU9lF,KAAO8lF,EAAUpmF,MAEzC,IAAIyO,EAAQy3E,EAAeriF,OAE3B,IAAK,MAAMuiF,KAAapR,EAAWxhE,OAAO0jE,QAAuB,IAAdA,EAAM52E,KAErD6lF,EAAU13E,KAAW23E,EAAUpmF,MAEnC,OAAOmmF,EAEX,mBAAmBD,GACfA,EAAiBA,GAAkB,GACnC,MAAMlR,EAAazrE,KAAKyrE,WAClBqR,EAAS,GACf,IAAK,MAAMl3B,KAAQ+2B,EAAgB,CAE/B,IAAIz3E,EAAQumE,EAAW/5B,UAAUi8B,GAASA,EAAM52E,MAAQ6uD,GACxD,GAAI1gD,GAAS,EAAG,CACZ,MAAM23E,EAAY,IAAKpR,EAAW75D,OAAO1M,EAAO,GAAG,IACnD23E,EAAU9lF,SAAM,EAChB+lF,EAAOj9E,KAAKg9E,QAKZ,GADA33E,EAAQumE,EAAW/5B,UAAUi8B,QAAuB,IAAdA,EAAM52E,KACxCmO,GAAS,EAAG,CACZ,MAAM23E,EAAY,IAAKpR,EAAW75D,OAAO1M,EAAO,GAAG,IACnD43E,EAAOj9E,KAAKg9E,QAIZC,EAAOj9E,KAAK,CAAEpJ,WAAO,IAKjC,MAAMiL,EAAS+pE,EAAWxhE,OAAO0jE,QAAuB,IAAdA,EAAM52E,KAKhD,OAJA2K,EAAOkP,KAAK,CAAC1R,EAAGC,KAAOD,EAAEnI,KAAO,KAAOoI,EAAEpI,KAAO,IAAM,GAAKoI,EAAEpI,KAAO,KAAOmI,EAAEnI,KAAO,KAAO,EAAI,GAC/F+lF,EAAOj9E,QAAQ6B,GAEfo7E,EAAOj9E,QAAQ4rE,EAAWxhE,OAAO0jE,QAAuB,IAAdA,EAAM52E,MACzC+lF,EAEX,cAAcr4B,EAAOs4B,GAAoB,EAAOC,GAAc,GAC1D,QAAID,IAAsB/8E,KAAKi9E,eAAex4B,EAAOu4B,MAG9CA,EAAch9E,KAAKsuE,gBAAkB7pB,EAAM6pB,cAAgBtuE,KAAK+uE,gBAAkBtqB,EAAMsqB,eAGnG,eAAetqB,EAAOu4B,GAAc,GAChC,IAAKh9E,KAAK0uE,cAAcjqB,GAAO,EAAOu4B,GAClC,OAAO,EAEX,MAAM5N,EAAiBpvE,KAAKsuE,cAAgBtuE,KAAKsuE,cAAc7C,WAAa,GACtEyR,EAAOl9E,KAAKqvE,sBAAsBD,GAClC+N,EAAS14B,EAAM4qB,sBAAsBD,GAC3C,OAAOl5E,OAAOsD,KAAK0jF,GAAMtL,MAAM76E,GAAOmmF,EAAKnmF,KAASomF,EAAOpmF,KACpDb,OAAOsD,KAAK2jF,GAAQvL,MAAM76E,GAAOomF,EAAOpmF,KAASmmF,EAAKnmF,IAEjE,aAAa0tD,GACT,OAAsB,OAAlBzkD,KAAKyuE,UAAwC,OAAnBhqB,EAAMgqB,SACzBzuE,KAAKyuE,WAAahqB,EAAMgqB,SAE5BzuE,KAAKyN,QAAUg3C,EAAMh3C,QACvBzN,KAAKyuE,SAAWzuE,KAAKyuE,SAAS14E,KAAOiK,KAAK+2E,iBAAmBtyB,EAAMgqB,SAAWhqB,EAAMgqB,SAAS14E,KAAO0uD,EAAMsyB,gBC1QvH,SAAWgF,GACPA,EAAyB,QAAI,UAC7BA,EAA0B,SAAI,WAC9BA,EAAuB,MAAI,QAC3BA,EAAyB,QAAI,UAJjC,CAKGA,KAAoBA,GAAkB,KEDlC,MAAMqB,GACT,YAAYC,EAAMh/C,EAAS3pB,GACvB1U,KAAKq9E,KAAOA,EACZr9E,KAAK0U,GAAKA,EACV1U,KAAK0hC,KAAO,mBACZ1hC,KAAKs9E,eAAiB,GACtBt9E,KAAKu9E,eAAiB,QACD,IAAjBl/C,EAAQqD,OACR1hC,KAAK0hC,KAAOrD,EAAQqD,MAExB,IAAK,MAAM5nC,KAAUukC,EAAQm/C,SAAW,GACpCx9E,KAAKs9E,eAAez9E,KAAK,IAAI,GAAO/F,IAExC,IAAK,MAAMA,KAAUukC,EAAQo/C,SAAW,GACpCz9E,KAAKu9E,eAAe19E,KAAK,IAAI,GAAO/F,IAG5C,iBACI,OAAOkG,KAAKs9E,eAAehjF,OAAS,GAAK0F,KAAKu9E,eAAejjF,OAAS,EAE1E,QAAQ08E,GACJ,QAAIh3E,KAAKs9E,eAAehjF,SAAW0F,KAAKs9E,eAAeh6B,KAAKxpD,GAAUA,EAAO84C,QAAQokC,QAGjFh3E,KAAKu9E,eAAejjF,SAAU0F,KAAKu9E,eAAej6B,KAAKxpD,GAAUA,EAAO84C,QAAQokC,KAKxF,OAAO0G,EAAuBC,GAE1B,OAAO39E,KAAKq9E,KAAKM,EAAKD,IAG9B,MAAM,GACF,YAAY5jF,GAKR,GAJAkG,KAAKsuE,cAAgB,KACrBtuE,KAAK+uE,cAAgB,KACrB/uE,KAAKyuE,SAAW,KAChBzuE,KAAK+2E,aAAe,KACE,iBAAXj9E,EACPkG,KAAK+uE,cAAgBj1E,OAEpB,GAAImhF,GAA6Bt8D,OAAO7kB,GACzCkG,KAAKsuE,cAAgBx0E,EACrBkG,KAAK+uE,cAAgBkM,GAA6BG,QAAQthF,OAEzD,CACD,MAAM8jF,EAAW9jF,EACb8jF,EAASv7C,YACTriC,KAAKsuE,cAAgB2M,GAA6Bt8D,OAAOi/D,EAASv7C,WAC5D44C,GAA6BI,QAAQuC,EAASv7C,WAC9C,KACNriC,KAAK+uE,cAAgBkM,GAA6BG,QAAQwC,EAASv7C,YAEnEu7C,EAASnP,WACTzuE,KAAKyuE,SAAW8M,GAAuBJ,WAAWyC,EAASnP,UAAYmP,EAASnP,SAAW,KAC3FzuE,KAAK+2E,aAAewE,GAAuBH,QAAQwC,EAASnP,YAIxE,QAAQuI,GACJ,MAAM53C,EAAe43C,EAAqBt4E,QACrC0gC,EAAa9kC,QACd8kC,EAAav/B,KAAK,IAAI,GAAoB,KAE9C,IAAK,MAAMqiC,KAAe9C,EACtB,GAA4B,OAAvBp/B,KAAK+uE,eAA0B/uE,KAAK+uE,gBAAkB7sC,EAAY6sC,eAC3C,OAAvB/uE,KAAKsuE,eAA0BtuE,KAAKsuE,gBAAkBpsC,EAAYosC,eAC5C,OAAtBtuE,KAAK+2E,cAAyB/2E,KAAK+2E,eAAiB70C,EAAY60C,cAC9C,OAAlB/2E,KAAKyuE,UAAqBzuE,KAAKyuE,WAAavsC,EAAYusC,SACzD,OAAO,EAGf,OAAO,ID1Ef,SAAWuN,GACPA,EAA4B,iBAAI,mBAChCA,EAA4B,iBAAI,mBAChCA,EAA0B,eAAI,iBAHlC,CAIGA,KAAcA,GAAY,KAItB,MAAM,GACT,cACIh8E,KAAKu0B,MAAQ,CACTspD,iBAAkB,GAClBC,iBAAkB,GAClBC,eAAgB,IAEpB/9E,KAAKg+E,aAAe,EAExB,QAAQC,EAAc5/C,GAClB,MAAMg/C,EAAO,IAAID,GAAKa,EAAc5/C,GAAW,KAAMr+B,KAAKg+E,cAE1D,OADAh+E,KAAKu0B,MAAM8oD,EAAK37C,MAAM7hC,KAAKw9E,GACpBr9E,KAAKg+E,aAEhB,WAAWtpE,GACP,IAAK,MAAMgtB,KAAQ1hC,KAAKu0B,MACpB,GAAIr+B,OAAOkB,UAAUC,eAAe1B,KAAKqK,KAAKu0B,MAAOmN,GAAO,CACxD,MAAMx8B,EAAQlF,KAAKu0B,MAAMmN,GAAMgQ,UAAU2rC,GAAQA,EAAK3oE,KAAOA,GACzDxP,GAAS,GACTlF,KAAKu0B,MAAMmN,GAAM9vB,OAAO1M,EAAO,IAK/C,uBAAuB8xE,EAAsB0G,GACzC,OAAO19E,KAAKyH,OAAO,mBAA2Ci2E,EAAuB1G,GAEzF,uBAAuB5N,EAAKsU,GACxB,OAAO19E,KAAKyH,OAAO,mBAA2Ci2E,EAAuBtU,GAEzF,qBAAqB1lE,EAAOg6E,GACxB,OAAO19E,KAAKyH,OAAO,iBAAuCi2E,EAAuBh6E,GAErF,aAAag+B,EAAMg8C,EAAuBC,GACtC,IAAK,MAAMN,KAAQr9E,KAAKu0B,MAAMmN,GAC1B,IAAK27C,EAAKa,YAAcb,EAAKzqC,QAAQ+qC,GAAM,CACvC,MAAMQ,QAAgBd,EAAK51E,OAAOi2E,EAAuBC,GACzD,GAAuB,kBAAZQ,GACP,IAAKA,EACD,OAAO,OAIXR,EAAMQ,EAIlB,OAAOR,GExDR,MAAM,GACT,YAAYS,EAAK9L,GACbtyE,KAAKo+E,IAAMA,EACXp+E,KAAKo/B,aAAe,GACpBp/B,KAAKs9B,KAAO,KACZt9B,KAAKq+E,YAAc,KACnBr+E,KAAKs+E,WAAa,KAClBt+E,KAAK+8E,mBAAoB,EACzB/8E,KAAK0+B,SAAW,KAChB1+B,KAAKu+E,SAAU,EACfv+E,KAAKw+E,OAAS,GACdx+E,KAAK8kE,MAAQwN,EAAMxN,MACnB9kE,KAAKy+E,KAAOnM,EAAMmM,KACdnM,EAAMA,QACNtyE,KAAKo/B,aAAep/B,KAAK0+E,WAAWpM,EAAMA,OAC1CtyE,KAAKs9B,KAAOt9B,KAAK2+E,YAAY3+E,KAAKo/B,eAEtCp/B,KAAKs+E,WAAwC,OAA3BhM,EAAMsM,uBAAwD,IAA3BtM,EAAMsM,iBAA8BtM,EAAMsM,iBAAmB5+E,KAAKs9B,KAC/F,OAApBt9B,KAAKs+E,YAA0Bt+E,KAAKs+E,sBAAsB19E,WAAaq6E,GAA6Bt8D,OAAO3e,KAAKs+E,cAChHt+E,KAAKs+E,WAAalF,GAA8BC,uBAAuBr5E,KAAKo+E,IAAI7O,OAAQvvE,KAAKs+E,aAEjGt+E,KAAK6+E,QAAUvM,EAAMuM,QACrB7+E,KAAK+8E,oBAAsBzK,EAAMyK,kBACjC/8E,KAAKq+E,iBAAkCl5E,IAApBmtE,EAAMhyD,WAAiCgyD,EAAMhyD,UAChEtgB,KAAK68D,SAET,kBACI,OAAQ78D,KAAK0+B,UAAY1+B,KAAK0+B,SAASpkC,OAAS,mBAAqB,GAEzE,SACI0F,KAAKu+E,QAAUv+E,KAAK8+E,iBACf9+E,KAAKs9B,MAAQt9B,KAAKs9B,KAAKhjC,QAAW0F,KAAK6+E,QACxC7+E,KAAKw+E,OAASx+E,KAAK++E,gBAGnB/+E,KAAKw+E,OAA0B,eAAhBx+E,KAAKw+E,OAA0B,aAAgBx+E,KAAKg/E,cAAgB,mBAAqB,GAGhH,cAAchxE,GACNhO,KAAK6+E,SACL7+E,KAAK6+E,QAAQ7+E,MAEjBgO,EAAMqlC,kBAEV,eACIrzC,KAAKw+E,OAAUx+E,KAAKw+E,OAAO/7E,WAAW,cAAgB,GAAK,aAE/D,WAAWqvE,GACP,OAAOsH,GAA8BC,uBAAuBr5E,KAAKo+E,IAAI7O,OAAQuC,GAEjF,iBACI,OAAI9xE,KAAKq+E,uBAAuBz9E,SACrBZ,KAAKq+E,YAAYr+E,QAEnBA,KAAKq+E,YAElB,gBACI,IAAKlkF,MAAMC,QAAQ4F,KAAKs+E,YACpB,OAAOt+E,KAAKs+E,WAAWt+E,MAAQ,aAAe,GAElD,MAAMi/E,EAAaj/E,KAAKs+E,WAClBY,EAAmBl/E,KAAKo+E,IAAI7O,OAAO0B,oBAAoBkO,4BAA4Bn/E,KAAKo+E,IAAI7O,OAAO2P,kBACzG,IAAK,MAAM78C,KAAa48C,EACpB,GAAIC,EAAiBtN,MAAO4M,IAAYA,EAAO9P,cAAcrsC,EAAWriC,KAAK+8E,mBAAmD,OAA9B16C,EAAUi6C,kBACxG,MAAO,GAGf,MAAO,aAEX,YAAYl9C,GACR,OAAOp/B,KAAKo+E,IAAI7O,OAAO0B,oBAAoBmO,8BAA8BhgD,GAE7E,cACI,GAAIp/B,KAAK0+B,SACL,IAAK,MAAMyb,KAASn6C,KAAK0+B,SACrB,GAAIyb,EAAMqkC,OAAO/7E,WAAW,eAAiB03C,EAAM6kC,cAC/C,OAAO,EAInB,OAAO,GChFR,MAAM,GACT,YAAYzP,EAAQx5E,EAAM+7E,EAAS,GAAIt/B,EAAU,IAC7CxyC,KAAKuvE,OAASA,EACdvvE,KAAKjK,KAAOA,EACZiK,KAAK8xE,OAASA,EACd9xE,KAAKwyC,QAAUA,EACfxyC,KAAK68D,SAET,UAAUiV,GACN,IAAK,MAAMQ,KAASR,EAChB9xE,KAAKq/E,SAASr/E,KAAK8xE,OAAQQ,GAE/BtyE,KAAK68D,SAET,SACI78D,KAAKs/E,aAAat/E,KAAK8xE,QACvB9xE,KAAK8xE,OAAS9xE,KAAK8xE,OAAOpzE,QAE9B,SAASozE,EAAQQ,GACb,MAAMiN,EAAW,IAAI,GAASv/E,KAAMsyE,GAEpC,GADAR,EAAOjyE,KAAK0/E,GACRjN,EAAM5zC,SAAU,CAChB6gD,EAAS7gD,SAAW,GACpB,IAAK,MAAMyb,KAASm4B,EAAM5zC,SACtB1+B,KAAKq/E,SAASE,EAAS7gD,SAAUyb,IAI7C,aAAa23B,GACT,IAAK,MAAMQ,KAASR,EAChBQ,EAAMzV,SACFyV,EAAM5zC,UAAY4zC,EAAM5zC,SAASpkC,QACjC0F,KAAKs/E,aAAahN,EAAM5zC,WCpCxC,IAMI,GAA0C,SAAUhlC,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAMnG,MAAMw0E,GACT,YAAYntD,EAAW3yB,EAAMurE,EAAO,GAChCjrE,KAAKqyB,UAAYA,EACjBryB,KAAKN,KAAOA,EACZM,KAAKirE,KAAOA,EACZjrE,KAAKu3B,MAAO,EACZv3B,KAAKs4B,QAAU,IAAIZ,QAAQ,CAACvxB,EAASwoD,KACjC3uD,KAAKmG,QAAU,KACXnG,KAAKqyB,UAAUlsB,QAAQnG,KAAMmG,IAEjCnG,KAAK2uD,OAAUyb,IACXpqE,KAAKqyB,UAAUs8B,OAAO3uD,KAAM2uD,EAAQyb,MAIhD,gBACQ,YAAapqE,KAAKN,WACZM,KAAKN,KAAKm/E,QAAQ7+E,YAGlBA,KAAKN,KAAKM,MAGxB,OACI,OAAOA,KAAKs4B,QAEhB,YACI,OAAO,EAEX,WAeG,MAAMmnD,GACT,YAAYjhF,GACRwB,KAAKxB,SAAWA,EAChBwB,KAAKuqE,QAAU,GACfvqE,KAAKwqE,WAAa,KAClBxqE,KAAKyqE,+BAAiC,KACtCzqE,KAAK0qE,kCAAoC,EACzC1qE,KAAK0rB,UAAY,KACjB1rB,KAAK4rB,KAAO,KAEhB,eACI,OAAqB,OAAd5rB,KAAK4rB,KAEhB,aACI,OAAO5rB,KAAKuqE,QAAQjwE,OAExB,SAAS+jC,GACL,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,wCAEpBT,KAAK0rB,UAAY2S,EAAQ3S,UACzB1rB,KAAKyqE,+BAAiCpsC,EAAQosC,+BAC9CzqE,KAAK4rB,KAAO5rB,KAAK0rB,UAAUK,gBAAgB/rB,KAAK2qE,QAAS,CAAE1+C,YAAY,IAE3E,aACI,IAAKjsB,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,oCAEpBT,KAAK4rB,KAAKM,SACVlsB,KAAK4rB,KAAO,KACZ5rB,KAAKyqE,+BAAiC,KACtCzqE,KAAK2sB,QAET,QAAQi+C,EAAaC,GACjB,MAAM1mD,EAAOhqB,MAAMC,QAAQwwE,GACrBlvC,EAASvX,EAAOymD,EAAc,CAACA,GAC/BE,EAAQpvC,EACTvjC,IAAI,CAAC1B,EAAOyO,IAAW/K,MAAMC,QAAQywE,GAA6BA,EAAY3lE,GAA1B2lE,GACpD1yE,IAAK1B,QAAoB0O,IAAV1O,EAAsBA,EAAQ,GAC5CwhC,EAAQ,GACd,IAAK,MAAMv4B,KAAQg8B,EACfzD,EAAMp4B,KAAKH,aAAgB8/E,GACrB9/E,EACAM,KAAK0/E,gBAAgBhgF,EAAMorE,EAAM3jD,UAI3C,OAFAnnB,KAAKuqE,QAAQ1qE,QAAQo4B,GACrBj4B,KAAK2qE,UACExmD,EAAO8T,EAAQA,EAAM,GAEhC,gBAAgBv4B,EAAMurE,GAClB,OAAO,IAAIuU,GAAUx/E,KAAMN,EAAMurE,GAErC,QAAQ9+C,GACoB,OAApBnsB,KAAKwqE,kBAGKrlE,IAAVgnB,IACAnsB,KAAK0qE,kCAAoC,GAExC1qE,KAAKuqE,QAAQjwE,SAG0B,OAAxC0F,KAAKyqE,qCAAqDtlE,IAAVgnB,GAAuBnsB,KAAK0qE,mCAAqC1qE,KAAKuqE,QAAQ,GAAGU,MAAQ,GAAKjrE,KAAKyqE,iCAGvJzqE,KAAKwqE,WAAaxqE,KAAKuqE,QAAQpjD,SAAW,KACtCnnB,KAAKwqE,aACLxqE,KAAK0qE,mCAAqC1qE,KAAKwqE,WAAWS,MAAQ,OAC5C,IAAlBjrE,KAAKxB,SACLwB,KAAKxB,SAASwB,KAAKwqE,YAKnBxqE,KAAKwqE,WAAWqU,UAAUhmD,MAAMl3B,IAAW,MAAMA,QAI7D,QACI3B,KAAKuqE,QAAQ34D,OAAO,EAAG5R,KAAKuqE,QAAQjwE,QAExC,QAAQsxB,EAAMzlB,GACVA,IACAnG,KAAKwqE,WAAa,KAClBxqE,KAAK2qE,UAET,OAAO/+C,EAAM+iC,EAAQyb,GACjBzb,EAAOyb,GACPpqE,KAAKwqE,WAAa,KAClBxqE,KAAK2qE,YAlJiC,SAAU1wE,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GACzIT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,IAiJ5D,CAAW,CACP,IACA,GAAW,cAAesK,UAC1B,GAAW,oBAAqB,CAACyY,SACjC,GAAW,yBAAqB,IACjComE,GAAUroF,UAAW,UAAW,MC1JnC,IAMI,GAA0C,SAAUsC,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAQ3D,IAAI,GAAqB,MACrB,YAAYwgB,EAAW8K,GACnBx2B,KAAK0rB,UAAYA,EACjB1rB,KAAKyqE,+BAAiC,EACtCzqE,KAAKoyC,UAAW,EAChBpyC,KAAKq+B,QAAU,CACX6sC,oBAAoB,EACpB1sE,SAAU,QAEdwB,KAAKmrE,eAAiB,CAAEwU,UAAW,KAAMjU,kBAAkB,GAC3D1rE,KAAKorE,eAAkBp9D,IACnB,MAAM,UAAE2xE,EAAS,iBAAEjU,GAAqB1rE,KAAKmrE,eAE7C,OADAnrE,KAAKmrE,eAAiB,CAAEwU,UAAW,KAAMjU,kBAAkB,GACpD1rE,KAAK4rE,aAAaN,QAAQsU,MAAOh0D,IACpC,MACMy/C,EAAKr9D,EACL6xE,EAASF,EACTG,EAAwBpU,QAHhB1rE,KAIF+/E,SAAS1U,EAAIwU,EAAQC,GACjCl0D,EAAKzlB,WACN,GAAGsxB,QAEVz3B,KAAKm5C,OAAS3iB,EAAI2iB,OAClBn5C,KAAK2rE,QAAUn1C,EAAI2iB,OAAOwyB,QAC1B3rE,KAAK62B,SAAWL,EAAI2iB,OAAOtiB,SAC3B72B,KAAK4rE,aAAe,IAAI6T,GAE5B,SAASphD,GACL,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,iDAEpBT,KAAKoyC,UAAW,EAChBpyC,KAAKq+B,QAAQ7/B,SAAW6/B,EAAQ7/B,SACE,MAA9B6/B,EAAQ6sC,qBACRlrE,KAAKq+B,QAAQ6sC,mBAAqB7sC,EAAQ6sC,oBAE9ClrE,KAAK4rE,aAAa9xC,SAAS,CAAEpO,UAAW1rB,KAAK0rB,UAAW++C,+BAAgCzqE,KAAKyqE,iCAC7FzqE,KAAKm5C,OAAOnkB,iBAAiB,WAAYh1B,KAAKorE,gBAElD,aACI,IAAKprE,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,6CAEpBT,KAAKm5C,OAAO9iB,oBAAoB,WAAYr2B,KAAKorE,gBACjDprE,KAAK4rE,aAAahyC,aAClB55B,KAAKq+B,QAAU,CAAE6sC,oBAAoB,EAAM1sE,SAAU,QACrDwB,KAAKoyC,UAAW,EAEpB,aACI,OAAOpyC,KAAK2rE,QAAQrxE,OAExB,YACI,OAAO0F,KAAK2rE,QAAQjoE,MAExB,kBACI,MAAM,SAAEmoE,EAAQ,OAAEC,EAAM,KAAEC,GAAS/rE,KAAK62B,SACxC,MAAO,CACHuc,KAAMy4B,EACNvtC,MAAOwtC,EACPC,OACA7pC,YAAaliC,KAAKq+B,QAAQ6sC,mBAAqBa,EAAKrtE,MAAM,GAAKmtE,GAGvE,GAAG1/C,EAAO2zD,GAAwB,GAC9B,MAAME,EAAWhgF,KAAK4rE,aAAa8T,gBAAiB9zD,GAASA,EAAKzlB,UAAW,GAgB7E,OAfAnG,KAAK4rE,aAAaN,QAAQ,CACrB1/C,IACG,MACM+zD,EAAYK,EACZtU,EAAmBoU,EAFX9/E,KAGRigF,aAAa,CAAEN,YAAWjU,qBAChC9/C,EAAKzlB,WAERylB,IACG,MAAM+/C,EAAU3rE,KAAK2rE,QACfuU,EAAQ/zD,EACdw/C,EAAQO,GAAGgU,GACXt0D,EAAKzlB,YAEV,CAAC,EAAG,IACA65E,EAASvoD,OAEpB,mBAAmB/zB,GACf,MAAM,MAAEohE,EAAK,KAAE1xB,GAAS1vC,EAAMsoE,aACxBxnC,EAAWxkC,KAAKq+B,QAAQ6sC,mBAAqB,KAAO,GAC1D,OAAOlrE,KAAK4rE,aAAaN,QAAS1/C,IAC9B,MAAM+/C,EAAU3rE,KAAK2rE,QACf16D,EAAOvN,EACPy8E,EAAerb,GAAS,GACxBsE,EAAM,GAAG5kC,IAAW4O,IAC1Bu4B,EAAQyU,UAAUnvE,EAAMkvE,EAAc/W,GACtCx9C,EAAKzlB,WACN,GAAGsxB,OAEV,sBAAsB/zB,GAClB,MAAM,MAAEohE,EAAK,KAAE1xB,GAAS1vC,EAAMsoE,aACxBxnC,EAAWxkC,KAAKq+B,QAAQ6sC,mBAAqB,KAAO,GAC1D,OAAOlrE,KAAK4rE,aAAaN,QAAS1/C,IAC9B,MAAM+/C,EAAU3rE,KAAK2rE,QACf16D,EAAOvN,EACPy8E,EAAerb,GAAS,GACxBsE,EAAM,GAAG5kC,IAAW4O,IAC1Bu4B,EAAQ0U,aAAapvE,EAAMkvE,EAAc/W,GACzCx9C,EAAKzlB,WACN,GAAGsxB,OAEV,oBACI,MAAMuoD,EAAWhgF,KAAK4rE,aAAa8T,gBAAiB9zD,GAASA,EAAKzlB,UAAW,GAO7E,OANAnG,KAAK4rE,aAAaN,QAAQsU,MAAOh0D,IAC7B,MACM+zD,EAAYK,QADJhgF,KAEFsgF,SAASX,GACrB/zD,EAAKzlB,WACN,GACI65E,EAASvoD,OAEpB,eAAeuoD,SACLhgF,KAAKksE,IAAI,GAAG,GAClB,MAAMxoE,EAAQ1D,KAAK2rE,QAAQjoE,MAEvBA,GAASA,EAAMyoE,kBAAoBzoE,EAAMyoE,gBAAgBC,mBACnDpsE,KAAKksE,IAAI,GAAG,SACZlsE,KAAKqsE,mBAAmB3oE,UAE5Bs8E,EAASnB,UAEnB,aAAan7E,GACT1D,KAAKmrE,eAAiBznE,EAE1B,eAAe2nE,EAAIsU,EAAWjU,GAAmB,GACxCA,GACD1rE,KAAKq+B,QAAQ7/B,SAAS,IACfwB,KAAKisE,YAEJj+D,MAAOq9D,EACP3nE,MAAO1D,KAAK2rE,QAAQjoE,QAId,OAAdi8E,SACMA,EAAUd,YAI5B,GAlK8C,SAAU5kF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA8J3C,CAAW,CAC5B,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAACJ,OAAQ,OAC1C,IClJH,MAAMqqF,IAEC,MAAMC,GAAU,IAAG16E,gBAAgB,WAAWP,YAAY2E,GAAKA,EAAEjG,UAAU,KAC3E,MAAM,GACT,YAIAZ,EAIAk6C,EAIAm8B,EAIA+G,EAIAxP,GACIjxE,KAAKqD,UAAYA,EACjBrD,KAAKu9C,UAAYA,EACjBv9C,KAAK05E,WAAaA,EAClB15E,KAAKygF,YAAcA,EACnBzgF,KAAKixE,oBAAsBA,EAC3BjxE,KAAK27E,UAAY,KAIjB37E,KAAK0gF,KAAO,GAIZ1gF,KAAKk/E,iBAAmB,GAIxBl/E,KAAK2gF,qBAAuB,GAI5B3gF,KAAKq+B,QAAU,CACXmuC,SAAS,EACToU,sBAAuB,EACvBC,iBAAiB,EACjBC,qBAAqB,GAEzB9gF,KAAKoyC,UAAW,EAChBpyC,KAAK+gF,aAAc,EACnB/gF,KAAKghF,qBAAuB,KAC5BhhF,KAAKihF,eAAiB,KACtBjhF,KAAKkhF,YAAc,GAMnBlhF,KAAKmhF,aAAgBjzE,IACjB,IAAIg0B,EAAch0B,EAAKg0B,aAAe,GACX,iBAAhBA,GAA4BA,EAAYz/B,WAAW,OAC1Dy/B,EAAcA,EAAYxjC,MAAM,GAE3BwjC,EAAYz/B,WAAW,OACxBy/B,EAAc,IAAIA,MAI1BliC,KAAKktE,KAAKhrC,EAAa,CAAEk/C,OAAQlzE,EAAKy+D,SAAU9zC,MAAMl3B,IAAW,MAAMA,KAO3E3B,KAAKqhF,kBAAqBn/C,IAEtBliC,KAAKshF,mBAAmBp/C,GAAarJ,MAAMl3B,IAAW,MAAMA,KAOhE3B,KAAKuhF,2BAA6B3B,MAAOj8D,EAAO69D,KAC5C,IAAIC,EAAoB,GACxB,IAAK,MAAMC,KAAkBF,EACiB,iBAA/BE,EAAex/C,aACtBu/C,EAAkB5hF,QAAQG,KAAKixE,oBAAoBkO,4BAA4BuC,EAAex/C,aACzFj4B,OAAOi4B,GAAwC,OAAzBA,EAAYusC,UAClCt2E,IAAI+pC,GAAeA,EAAYssC,oBAEW,iBAAxCkT,EAAe3T,sBACtB0T,EAAkB5hF,QAAQG,KAAKixE,oBAAoBkO,4BAA4BuC,EAAe3T,sBACzF9jE,OAAOi4B,GAAwC,OAAzBA,EAAYusC,UAClCt2E,IAAI+pC,GAAeA,EAAYssC,oBAG5CiT,EAAoBA,EAAkBx3E,OAAO,CAACo4B,EAAW7sC,EAAGqJ,IAAsB,OAAdwjC,GAAsBxjC,EAAIoK,QAAQo5B,KAAe7sC,GACrH,MAAMmsF,EAAa,IAAKh+D,GACxB,IAAIyb,EAAe,GACfuiD,EAAW5T,sBAAmE,iBAApC4T,EAAW5T,uBACrD3uC,EAAav/B,QAAQ8hF,EAAW5T,sBAChC4T,EAAW5T,qBAAuB/tE,KAAKixE,oBAAoBmO,8BAA8BuC,EAAW5T,uBAEpG4T,EAAWz/C,aAAiD,iBAA3By/C,EAAWz/C,cAC5C9C,EAAav/B,QAAQ8hF,EAAWz/C,aAChCy/C,EAAWz/C,YAAcliC,KAAKixE,oBAAoBmO,8BAA8BuC,EAAWz/C,cAE/F9C,EAAeA,EAAan1B,OAAO,CAACi4B,EAAa1sC,EAAGqJ,IAAwB,OAAhBqjC,GACnB,OAAlCA,EAAYssC,mBACZ3vE,EAAIoK,QAAQi5B,KAAiB1sC,GACpC,MAAMosF,EAAc,GACpB,IAAK,MAAM1/C,KAAe9C,QAChBp/B,KAAK6hF,eAAe3/C,EAAau/C,EAAmBG,GAE9D,OAAOD,GAOX3hF,KAAK8hF,yBAA4BC,IAC7B,MAAMp+D,EAASo+D,EAAuBr+E,OAASq+E,EAAuBr+E,MAAMsoE,aACtE+V,EAAuBr+E,MAAMsoE,aAC7B,CAAE9pC,YAAa,GAAI6rC,qBAAsB,IAC/CpqD,EAAMue,YAAc6/C,EAAuB7/C,YAC3Cve,EAAMq+D,aAAc,EACpBhiF,KAAKu9C,UAAU0kC,SAASt+D,GAAOkV,MAAMl3B,IAAW,MAAMA,KAO1D3B,KAAKshF,mBAAqB1B,MAAOsC,IAC7B,MAAMhgD,EAAcliC,KAAKghF,qBAAuBkB,EAC5CliF,KAAKq+B,QAAQ8jD,gBACbniF,KAAKq+B,QAAQ8jD,eAAejgD,GAEhC,IAAI6rC,GAAuB,EAC3B,MAAMqU,EAAwBlgD,EAAYw3C,YACrC0I,EAAsBzI,MAAQyI,EAAsBxI,UAAY13C,EAAY6rC,uBAC7EA,GAAuB,GAG3B,IAAIsU,QAAwBriF,KAAKsiF,iBAAiBtiF,KAAK27E,UAAUluE,MAAOy0B,EAAYA,YAAaA,EAAYz0B,OAASzN,KAAK27E,UAAUluE,OAAQsgE,GACzI3uC,EAAeijD,EAAgBjjD,aAC/BmjD,EAAsB,KACtBrgD,EAAYA,YAAY5nC,OAAS,IAAM+nF,EAAgBpJ,qBAAuBoJ,EAAgBG,mBAE9FxiF,KAAKyiF,aAAaJ,EAAgBpQ,WAElCoQ,EAAgBpJ,qBAChB/2C,EAAYkR,KAAOlR,EAAYA,YAAYz/B,WAAW,KAChDy/B,EAAYA,YAAYxjC,MAAM,GAAKwjC,EAAYA,YACrDqgD,EAAsB,GAAGA,GAAuB,KAAKF,EAAgBrQ,WACrEhyE,KAAK27E,UAAUvoC,KAAOmvC,GAG1B,MAAMG,EAAmB,GACzB,IAAIC,EAAsB,GAC1B,IAAK,MAAMC,KAAoBxjD,EAAan1B,OAAO44E,GAAS7iF,KAAKixE,oBAAoBG,+BAA+ByR,IAAS,CACzH,MAAMp1E,EAAQm1E,EAAiBn1E,OAASzN,KAAK27E,UAAUluE,MACvDi1E,EAAiB7iF,QAAQ4N,EAAMixB,SAASz0B,OAAOwD,IAAUA,EAAMgc,MAAM4lC,SAASl3D,IAAIsV,GAASA,EAAMgc,QACrE,OAAxBhc,EAAMsjE,eACN4R,EAAoB9iF,KAAK4N,EAAMsjE,eAGvC3xC,EAAeA,EAAan1B,OAAO44E,IAAU7iF,KAAKixE,oBAAoBG,+BAA+ByR,IACrG,IAAK,MAAMC,KAAkB1jD,EAAan1B,OAAO44E,GAAS7iF,KAAKixE,oBAAoB8R,6BAA6BF,IAC5GC,EAAe/K,aAAa+K,EAAer1E,OAASzN,KAAK27E,UAAUluE,OAAOsjE,cAAch7E,MACxF+sF,EAAer1E,MAAQq1E,EAAer1E,MAAM4iE,YAEhD,MAAM2S,EAAqB,GACrBC,EAA2B,GAEjC,IAAM1yD,MAAOymD,EAAsB/E,UAAWyE,GAA0B12E,KAAKkjF,cAAc9jD,EAAc6jD,GACrGE,EAAQ,IACZ,EAAG,CACC,IAAKA,IAED,MADAC,QAAQC,IAAI,wBAAyB3M,GAC/B,IAAS/0E,MAAM,MAEzB,MAAM2hF,EAAqB,GACrBC,QAAevjF,KAAKwjF,YAAYC,uBAAuBzM,EAAsB90C,GACnF,IAAe,IAAXqhD,EACA,OAAOvjF,KAAK0jF,iBAAiB,IAAIJ,KAAuBN,GAAqB9gD,GAG7E80C,EAAuBuM,EAE3B,IAAK,MAAMvS,KAAuBgG,EAAsB,CACpD,MAAM2M,EAAa3S,EAAoBvnD,MACpB,OAAfk6D,IACAA,EAAWvwC,KAAOmvC,EACdoB,EAAWC,eAAe5S,EAAqB9uC,IAC/CohD,EAAmBzjF,KAAK8jF,GAE5BpW,EAAYmV,EAAkBjsF,GAASA,IAAUktF,IAC5C3jF,KAAKixE,oBAAoBE,2BAA2BH,IACpB,OAA9BA,EAAoBvjE,OACiB,OAArCujE,EAAoBvjE,MAAM1S,QAC1Bi2E,EAAoBvjE,MAAM1S,OAAO+1E,iBACpCvD,EAAYoV,EAAqBlsF,GAASA,IAAUu6E,EAAoBvjE,MAAM1S,OAAOg2E,gBAIjG,IAAItmE,QAAgBitB,QAAQva,IAAImmE,EAAmBnrF,IAAK1B,GAAUA,EAAMi5E,aACxE,GAAIjlE,EAAQ64C,KAAKzmD,IAAqB,IAAXA,GACvB,OAAOmD,KAAK0jF,iBAAiB,IAAIJ,KAAuBN,GAAqB9gD,GAiBjF,GAfAz3B,QAAgBitB,QAAQva,IAAImmE,EAAmBnrF,IAAIynF,MAAOnpF,IACtD,MAAM04E,QAAiB14E,EAAM04E,WAC7B,MAAwB,kBAAbA,IACHA,GACO14E,EAAM0Z,eAMfnQ,KAAKktE,KAAKiC,EAAU,CAAE5pB,QAAQ,UAC9B9uD,EAAMotF,sBAEL,MAEPp5E,EAAQ64C,KAAKzmD,IAAqB,IAAXA,GACvB,OAAOmD,KAAK0jF,iBAAiB,IAAIJ,KAAuBN,GAAqBd,GAEjF,IAAK,MAAMzT,KAAY6U,EACfN,EAAmBpR,MAAMn7E,GAASA,IAAUg4E,IAC5CuU,EAAmBnjF,KAAK4uE,GAOhC,GAHAwU,EAAyBpjF,QAAQm3E,KAC9BzmD,MAAOymD,EAAsB/E,UAAWyE,GAA0B12E,KAAKkjF,cAAcxM,EAAuBuM,IAE3GZ,EAAgByB,cACgB,IAAhC9M,EAAqB18E,QACY,IAAjCo8E,EAAsBp8E,OAAc,CACpC,IAAIypF,EAAa,IAAIhS,EACrB,MAAMiS,EAAmBf,EACpBh5E,OAAO44E,GAAyB,OAAhBA,EAAMp5D,OAAkBo5D,EAAMp5D,MAAM2pB,OAASmvC,GAC7DpqF,IAAI0qF,GAASA,EAAMp5D,OACnBxf,OAAO,CAACxT,EAAOyO,EAAOrG,IAAQA,EAAIoK,QAAQxS,KAAWyO,GAC1D,IAAK,MAAMukB,KAASu6D,EAEhB,GADAD,QAAmB/jF,KAAKsiF,iBAAiB74D,EAAMhc,MAAO40E,EAAgBpQ,UAAWxoD,EAAMhc,OACnFs2E,EAAW9K,mBACX,MAGJ8K,EAAWvB,mBACXH,EAAkB0B,EAClBxB,EAAsB,GAAGA,GAAuB,MAAMF,EAAgBrQ,YAItEhyE,KAAKyiF,aAAasB,EAAW9R,WAEjCjyE,KAAKikF,mBAAmBF,EAAW3kD,cAGnC2uC,IACA/tE,KAAK2gF,qBAAuB3gF,KAAK2gF,qBAAqB12E,OAAOi4B,IAAgBA,EAAYknB,UAG7F,IAAIu3B,EAAuB3gF,KAAK2gF,qBAAqB12E,OAAOi4B,IAAgBA,EAAYknB,SAExF,GADAppD,KAAK2gF,qBAAuB3gF,KAAK2gF,qBAAqB12E,OAAOi4B,GAAeA,EAAYknB,SACpD,IAAhCu3B,EAAqBrmF,OAAc,CACnC,MAAM4K,EAAQlF,KAAK2gF,qBAAqBjvC,UAAUxP,GAAeA,EAAYknB,SACzElkD,GAAS,IACTy7E,EAAuB3gF,KAAK2gF,qBAAqB/uE,OAAO1M,EAAO,IAGvE,KAAOy7E,EAAqBrmF,OAAS,GAAG,CACpC,MAAM4pF,EAAsBvD,EAAqBx5D,QAC3Cg9D,EAAuBlB,EAAyB3/B,KAAKphB,GAAeA,EAAYkiD,aAAaF,IAC7FG,EAAgBrN,EAAqB1uC,KAAK7xC,GAASA,EAAM2tF,aAAaF,IACtEI,EAAoB5N,EAAsBpuC,KAAK7xC,GAASA,EAAM2tF,aAAaF,IAC7EA,EAAoB96B,UACnB+6B,QACsB,IAAlBE,IAA6BA,EAAcj7B,cACrB,IAAtBk7B,IAAiCA,EAAkBl7B,gBAGtC,IAAlBi7B,GACA9W,EAAYyJ,EAAsBvgF,GAASA,IAAU4tF,QAE/B,IAAtBC,GACA/W,EAAYmJ,EAAuBjgF,GAASA,IAAU6tF,GAErB,OAAjCJ,EAAoBzV,SACpBuI,EAAqBn3E,KAAKqkF,GAG1BxN,EAAsB72E,KAAKqkF,IAGC,IAAhClN,EAAqB18E,QAAiD,IAAjCo8E,EAAsBp8E,SAC3D08E,EAAuB0L,EAAiBvqF,IAAIsxB,IACxC,MAAMyY,EAAcliC,KAAKwvE,0BAA0BxvE,KAAKixE,oBAAoBO,yBAA0B/nD,EAAMssD,WAAatsD,OAAQ,GAIjI,OAHIA,EAAMqnD,kBACN5uC,EAAY6uC,cAAgBtnD,GAEzByY,IAEX80C,EAAqBn3E,QAAQ8iF,EAAoBxqF,IAAI44E,IACjD,MAAM8R,EAAQ7iF,KAAKwvE,0BAA0BxvE,KAAKixE,oBAAoBO,0BAEtE,OADAqR,EAAM9R,cAAgBA,EACf8R,KAEXF,EAAsB,UAErB3L,EAAqB18E,OAAS,GAAKo8E,EAAsBp8E,OAAS,SACrEo9B,QAAQva,IAAI6lE,EAAmB7qF,IAAK1B,GAAUA,EAAM8tF,sBACpDvkF,KAAKwkF,aAAatiD,GAGpBkgD,EAAsBqC,MAAQrC,EAAsBsC,QAAUxiD,EAAYyiD,WAAa3B,EAAmBpR,MAAMnD,GAAYA,EAASpwC,QAAQk8C,aAC7Ir4C,EAAY0iD,WAAY,GAE5B5B,EAAmBnyE,QAAS49D,IACxBA,EAASoW,0BAEb7kF,KAAKihF,eAAiBjhF,KAAKghF,qBACvBhhF,KAAKihF,eAAe0D,YACpB3kF,KAAKihF,eAAe0D,WAAY,GAEpC3kF,KAAKghF,qBAAuB,WACtBhhF,KAAKu9C,UAAUu3B,SAAS5yC,IAElCliC,KAAKwjF,YAAc,IAAI,GAK3B,mBACI,OAAqC,OAA9BxjF,KAAKghF,qBAKhB,sBACI,YAA8C,IAAvChhF,KAAKq+B,QAAQuiD,uBAAoC5gF,KAAKq+B,QAAQuiD,sBAAwB,EAKjG,SAASviD,GACL,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,qCAEpBT,KAAKoyC,UAAW,EAChBpyC,KAAKq+B,QAAU,IACRr+B,KAAKq+B,WACLA,QAEoB,IAAvBr+B,KAAKq+B,QAAQ9J,OACbv0B,KAAK8kF,SAAS9kF,KAAKq+B,QAAQ9J,OAE/Bv0B,KAAKixE,oBAAoBn3C,SAAS,CAAEirD,WAAY/kF,KAAKq+B,QAAQ0mD,aAC7D/kF,KAAKu9C,UAAUzjB,SAAS95B,KAAM,CAC1BxB,SAAUwB,KAAKqhF,kBACf7vB,MAAOxxD,KAAK05E,WACZkH,sBAAuB5gF,KAAKq+B,QAAQuiD,sBACpCoE,kBAAmBhlF,KAAK26E,gBAAkB36E,KAAKuhF,gCAA6B,IAEhFvhF,KAAKygF,YAAY3mD,SAAS,CAAEt7B,SAAUwB,KAAKmhF,aAAc3U,QAASxsE,KAAKq+B,QAAQmuC,UAC/ExsE,KAAK05E,WAAW5/C,SAAS,CACrBt7B,SAAUwB,KAAK8hF,yBACf5W,mBAAoBlrE,KAAKq+B,QAAQ6sC,qBAErClrE,KAAKilF,kBAKT,gBACI,MAAMthE,EAAQ,IACP3jB,KAAK05E,WAAWzN,YAEf8B,qBAAsB,GACtBmX,WAAW,EACXlD,aAAa,GAGfnlF,EAASmD,KAAKu9C,UAAU0kC,SAASt+D,GAEvC,OADA3jB,KAAK+gF,aAAc,EACZlkF,EAKX,aACI,IAAKmD,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,iCAEpBT,KAAKygF,YAAY7mD,aACjB55B,KAAKu9C,UAAU3jB,aACf55B,KAAK05E,WAAW9/C,aAKpB,UAAUwnD,GAEN,OAAIA,QACOphF,KAAK27E,UAAUluE,MAEtB2zE,aAAkB,IAASA,aAAkB,GACtCA,EAAO3zE,MAEXzN,KAAKmlF,gBAAgB/D,IAAWphF,KAAK27E,UAAUluE,MAK1D,gBAAgBpK,GACZ,OAAkB,OAAdA,EACOrD,KAAK27E,UAAUluE,MAGtBpK,EAAUlK,IAAIonF,IAAc,IAEV,QADlBl9E,EAAYA,EAAUtI,QAEXiF,KAAK27E,UAAUluE,MAG1BpK,EAAUlK,IAAIonF,IAAc,GACrBl9E,EAAUhN,IAAIkqF,IAElBvgF,KAAK27E,UAAUluE,MAK1B,YAAY1X,GACR,OAAOiK,KAAKo2E,eAAe9tC,KAAKmmC,GAAYA,EAAS14E,OAASA,IAAS,KAK3E,eAAe+B,GACX,MAAM,IAAI2I,MAAM,mBAKpB,qBAAqB3I,GACjB,MAAM,IAAI2I,MAAM,mBAKpB,oBAAoB3I,GAChB,MAAM,IAAI2I,MAAM,mBAKpB,gBAAgB2kF,EAAsB33E,GAClC,MAAMpK,EAAYrD,KAAKqlF,aAAaD,GACpC,IAAa3+E,SAAS85E,GAAc9yE,GAAOhI,SAASpC,GAKxD,gBAAgBiiF,GACZ,MAAMjiF,EAAY,sBAAuBiiF,EACnCA,EACAtlF,KAAKulF,oBAAoBD,GAC/B,OAAkB,OAAdjiF,EACO,KAENA,EAAUlK,IAAIonF,IAAc,IAG1Bl9E,EAAUhN,IAAIkqF,KAFV,KAOf,kBAAkB6E,GACIplF,KAAKqlF,aAAaD,GAE1B18E,UAAU3M,OAAOwkF,IAK/B,gBAAgB9R,EAAUprE,EAAWtN,EAAM8xB,EAASwW,GAChD,MAAMtkB,EAAc/Z,KAAKwlF,gBAAgBniF,GAKzC,OAJiB,OAAborE,IACAA,EAAW10D,EAAY0rE,YAAY1vF,EAAM8xB,EAASxkB,EAAWg7B,GAC7Dr+B,KAAK0lF,gBAAgBriF,EAAWorE,EAASmC,iBAEtCnC,EAKX,mBAAmBA,EAAUprE,EAAWwkB,GACpC,IAAK4mD,EAASmC,eAAe71E,OAAO4qF,eAAelX,EAAU5mD,EAASxkB,GAClE,MAAM,IAAI5C,MAAM,8BAA8BguE,EAAS14E,QAE3DiK,KAAK4lF,kBAAkBviF,GAK3B,qBAAqB0tE,EAAeh7E,EAAMsN,EAAWwkB,EAASwW,GAC1D,MAAMtkB,EAAc/Z,KAAKwlF,gBAAgBniF,GAKzC,OAJsB,OAAlB0tE,IACAA,EAAgBh3D,EAAY8rE,iBAAiB9vF,EAAM8xB,EAASwW,GAC5Dr+B,KAAK0lF,gBAAgBriF,EAAW0tE,EAAcH,iBAE3CG,EAKX,wBAAwBA,EAAe1tE,GACnC,IAAK0tE,EAAcH,eAAe71E,OAAO+qF,oBAAoB/U,GACzD,MAAM,IAAItwE,MAAM,oCAAoCswE,EAAc39B,QAEtEpzC,KAAK4lF,kBAAkBviF,GAK3B,aAAa8yE,GAAkB,EAAOiC,GAAkB,GAEpD,OAAOp4E,KAAK27E,UAAUluE,MAAM2oE,aAAaD,EAAiBiC,GAK9D,KAAKh5C,EAAcf,GAGf,GAFAA,EAAUA,GAAW,GAEO,iBAAjBe,IAA8Bf,EAAQC,MAAO,CACpD,MAAO8U,EAAM04B,GAAU1sC,EAAa3O,MAAM,KAC1C2O,EAAegU,EACf/U,EAAQC,MAAQwtC,EAEpB,MAAMia,EAAY,GACd1nD,EAAQ+iD,SACR2E,EAAU/mF,QAAUq/B,EAAQ+iD,QAEhC,IAAI3zE,EAAQ,KAEZ,KADG2xB,eAAc3xB,SAAU2rE,GAA8BoC,2BAA2Bx7E,KAAMo/B,EAAc2mD,IACpG1nD,EAAQknB,QAAUvlD,KAAKghF,qBAIvB,OAHA5hD,EAAeg6C,GAA8BC,uBAAuBr5E,KAAMo/B,GAC1Ep/B,KAAKikF,mBAAmB7kD,EAAc3xB,GAE/BiqB,QAAQvxB,UAEnB,MAAMwd,EAAQ,CACVue,YAAa9C,EACb2uC,qBAAsB,GACtBtgE,MAAOA,EACPq3D,MAAOzmC,EAAQymC,MACf7zD,KAAMotB,EAAQptB,KACdqtB,MAAOD,EAAQC,MACf4mD,UAAW7mD,EAAQzN,QACnB+zD,UAAWtmD,EAAQknB,OACnBy8B,aAAa,GAEjB,OAAOhiF,KAAKu9C,UAAU0kC,SAASt+D,GAKnC,UACI,OAAO3jB,KAAKu9C,UAAU08B,UAK1B,OACI,OAAOj6E,KAAKu9C,UAAU2uB,IAAI,GAK9B,UACI,OAAOlsE,KAAKu9C,UAAU2uB,GAAG,GAK7B,YAAY9sC,GACR,IAAK,MAAM8C,KAAe9C,EAAc,CACpC,MACM4yC,EADoBhyE,KAAKixE,oBAAoB+U,WAAWhmF,KAAKk/E,iBAAkBh9C,EAAYz0B,OAC9DxD,OAAO44E,GAASA,EAAMnU,cAAcxsC,GAAa,IACpF,GAAwB,IAApB8vC,EAAS13E,OACT,OAAO,EAEX,GAAIH,MAAMC,QAAQ8nC,EAAYy1C,wBACvBz1C,EAAYy1C,sBAAsBr9E,OAAS,IACgJ,IAA3L0F,KAAKixE,oBAAoBgV,cAAc/jD,EAAYy1C,sBAAuB3F,EAAS75E,IAAI0qF,GAAS1oF,MAAMC,QAAQyoF,EAAMlL,uBAAyBkL,EAAMlL,sBAAwB,IAAIuO,QAClL,OAAO,EAGf,OAAO,EAKX,OAAOnwF,EAAM+7E,EAAQt/B,GACjB,MAAM4rC,EAAMp+E,KAAKmmF,QAAQpwF,GACrBqoF,UACAA,EAAItM,OAAS,IAEjB9xE,KAAKomF,OAAOrwF,EAAM+7E,EAAQt/B,GAK9B,OAAOz8C,EAAM+7E,EAAQt/B,GACjB,IAAI4rC,EAAMp+E,KAAK0gF,KAAK3qF,GAChBqoF,UACAA,EAAMp+E,KAAK0gF,KAAK3qF,GAAQ,IAAI,GAAIiK,KAAMjK,EAAM,GAAIy8C,IAEpD4rC,EAAIiI,UAAUvU,GACdsM,EAAIvhB,SAKR,UAAU9mE,GACN,MAAM2qF,EAAO3qF,EACP,CAACA,GACDG,OAAOsD,KAAKwG,KAAK0gF,MACvB,IAAK,MAAMtC,KAAOsC,OACS,IAAnB1gF,KAAK0gF,KAAKtC,IAAsC,OAAnBp+E,KAAK0gF,KAAKtC,IACvCp+E,KAAK0gF,KAAKtC,GAAKvhB,SAO3B,QAAQ9mE,GACJ,OAAOiK,KAAK0gF,KAAK3qF,GAKrB,UAAU+7E,EAAQ9yE,GAGd,MAAO,GAOX,aAAa8yE,EAAQ9yE,IAQrB,SAASu1B,GACL,OAAOA,EAAMp8B,IAAIklF,GAAQr9E,KAAKsmF,QAAQjJ,EAAKA,KAAMA,EAAKh/C,UAE1D,QAAQg/C,EAAMh/C,GACV,OAAOr+B,KAAKwjF,YAAY8C,QAAQjJ,EAAMh/C,GAK1C,YAAY9J,IAMZ,0BAA0B8N,EAAWosC,EAAUhD,EAAY+L,GAAY,EAAMG,EAAwB,MACjG,OAAO33E,KAAKixE,oBAAoBzB,0BAA0BntC,EAAWosC,EAAUhD,EAAY+L,EAAWG,GAE1G,uBAAuBlqE,EAAOy0B,EAAaqkD,EAAkBC,GAAe,GACxE,IAAIlU,EAAQ,IAAIP,EAChB,GAA2B,iBAAhB7vC,EAIP,GAHAA,EAAcskD,QACFxmF,KAAKwjF,YAAYiD,uBAAuBvkD,EAAaliC,KAAKghF,sBAChE9+C,EACF/nC,MAAMC,QAAQ8nC,GACdowC,EAAMlzC,aAAe8C,MAEpB,CAEmB,MAAhBA,IACAA,EAAc,IAElB,MAAM9C,EAAep/B,KAAKixE,oBAAoBuJ,0BAA0Bt4C,GACxE,GAAIliC,KAAKq+B,QAAQyiD,sBAAwB9gF,KAAK0mF,uBAAuBtnD,GAAe,CAChF,MAAMunD,EAAal5E,EAAMgrE,kBAAkBv2C,GAC3C,GAAmB,OAAfykD,GAAuBA,EAAW1N,mBAClC3G,EAAQqU,OAGR,GAAI3mF,KAAKq+B,QAAQwiD,kBACbvO,EAAMlzC,aAAeA,EACjBkzC,EAAMlzC,aAAa9kC,OAAS,GAAG,CAC/B,MAAMssF,EAAmBtU,EAAMlzC,aAAa,GAAGu4C,uBAAyB,GACxErF,EAAML,UAAYjyE,KAAKixE,oBAAoBmO,8BAA8BwH,GACzEtU,EAAMlzC,aAAa,GAAGu4C,sBAAwB,WAKrD33E,KAAKq+B,QAAQwiD,kBAClBvO,EAAMlzC,aAAeA,QAK7BkzC,EAAMlzC,aAAe8C,EAEzB,IAAK,MAAM2gD,KAASvQ,EAAMlzC,aACF,OAAhByjD,EAAMp1E,QACNo1E,EAAMp1E,MAAQ84E,GAGtB,OAAOjU,EAEX,uBAAuBlzC,GACnB,OAAqB,OAAjBA,IAGAA,EAAa9kC,OAAS,GAGnB8kC,EAAakkB,KAAKphB,GAAeliC,KAAK0mF,uBAAuBxkD,EAAYy1C,yBAEpF,mBAAmBv4C,EAAc3xB,EAAQ,MACvB,OAAVA,IACAA,EAAQzN,KAAK27E,UAAUluE,OAE3B,IAAK,MAAMy0B,KAAe9C,EACI,OAAtB8C,EAAYz0B,QACZy0B,EAAYz0B,MAAQA,GAG5BzN,KAAK2gF,qBAAqB9gF,QAAQu/B,GAEtC,WAAWrpC,EAAMqpC,GACb,MAAMynD,EAAa7mF,KAAKkhF,YAAYnrF,GACpC,QAAmB,IAAf8wF,EAEA,OADA7mF,KAAKkhF,YAAYnrF,GAAQqpC,EAAa1gC,SAC/B,EAEX,GAAImoF,EAAWvsF,SAAW8kC,EAAa9kC,OAEnC,OADA0F,KAAKkhF,YAAYnrF,GAAQqpC,EAAa1gC,SAC/B,EAEX,IAAK,IAAIlJ,EAAI,EAAGkS,EAAK03B,EAAa9kC,OAAQ9E,EAAIkS,EAAIlS,IAC9C,GAAIqxF,EAAWrxF,KAAO4pC,EAAa5pC,GAE/B,OADAwK,KAAKkhF,YAAYnrF,GAAQqpC,EAAa1gC,SAC/B,EAGf,OAAO,EAEX,aAAa4zE,GACT,GAAqB,iBAAVA,GAAuC,IAAjBA,EAAMh4E,OAGvC,MAAI0F,KAAKq+B,QAAQyiD,qBAAuB9gF,KAAKq+B,QAAQwiD,gBAE3C,IAAIpgF,MAAM,wDAAwD6xE,MAEnEtyE,KAAKq+B,QAAQyiD,oBAEZ,IAAIrgF,MAAM,2CAA2C6xE,MAIrD,IAAI7xE,MAAM,0CAA0C6xE,MAGlE,cAAclzC,EAAcm3C,EAAcsB,GAAmB,GACzD,MAAMtnD,EAAQ,GACR0hD,EAAY,GAClB,KAAO7yC,EAAa9kC,QAAQ,CACM,OAA1B8kC,EAAa,GAAG3xB,QAChB2xB,EAAa,GAAG3xB,MAAQzN,KAAK27E,UAAUluE,OAE3C,MAAMA,EAAQ2xB,EAAa,GAAG3xB,OACxB,eAAEgpE,EAAc,sBAAEC,GAA0BjpE,EAAMy1E,cAAc9jD,EAAan1B,OAAOi4B,GAAeA,EAAYz0B,QAAUA,GAAQ8oE,EAAcsB,GACrJtnD,EAAM1wB,QAAQ42E,GACdxE,EAAUpyE,QAAQ62E,GAClBt3C,EAAeA,EAAan1B,OAAOi4B,GAAeA,EAAYz0B,QAAUA,GAE5E,MAAO,CAAE8iB,MAAOA,EAAM7xB,QAASuzE,aAEnC,uBAAuB+Q,EAAoBd,GAEvCc,EAAmBnyE,QAAS49D,IACxBA,EAASoV,qBAAqBhrD,MAAMl3B,IAAW,MAAMA,YAEnD3B,KAAKu9C,UAAUrxB,OAAOg2D,GAC5BliF,KAAKghF,qBAAuB,KAC5BkB,EAAa/7E,UAEjB,kBACI,IAAKnG,KAAK27E,UAAW,CACjB,MAAMlzE,EAAOzI,KAAKqD,UAAUhN,IAAI,KAASoS,KAEzCzI,KAAK27E,UAAY,IAAI,EAAc,YAAa37E,KAAMyI,EAAKpE,OAAOk9B,KAAM,MAAM,EAAM94B,EAAKpE,OAAOg+B,WAEpG,OAAOriC,KAAK27E,UAEhB,mBAAmBz5C,GACfliC,KAAK27E,UAAUluE,MAAM6qE,+BACrB,IAAIl5C,EAAep/B,KAAK27E,UAAUluE,MAAM4qE,gBACnCpuE,OAAOwD,GAAuC,OAA9BA,EAAMujE,sBAAiCvjE,EAAMujE,oBAAoB3hB,WACjFl3D,IAAIsV,GAASA,EAAMujE,qBACxB5xC,EAAep/B,KAAKixE,oBAAoBiI,0BAA0B95C,GAAc,GAGhF,MAAMm3C,EAAe,GACrB,IAAI,MAAEhmD,EAAK,UAAE0hD,GAAcjyE,KAAKkjF,cAAc9jD,EAAcm3C,GAAc,GACtE4M,EAAQ,IACZ,KAAOlR,EAAU33E,QAAQ,CAErB,IAAK6oF,IACD,MAAM,IAAI1iF,MAAM,uDAEpB81E,EAAa12E,QAAQ0wB,KAClBA,QAAO0hD,aAAcjyE,KAAKkjF,cAAcjR,EAAWsE,GAAc,IAExEv2E,KAAKk/E,iBAAmB9/C,EACxBp/B,KAAK8mF,YAAc5kD,EAAYowC,MAE/B,IAAI5uE,QAAc1D,KAAKwjF,YAAYuD,qBAAqB3nD,EAAc8C,GACjD,iBAAVx+B,IAEPA,EAAQ1D,KAAKixE,oBAAoBmO,8BAA8B17E,GAAO,GAAO,IAGjFA,QAAc1D,KAAKwjF,YAAYuD,qBAAqBrjF,EAAOw+B,GAC3D,MAAM5D,EAAS4D,EAAY5D,OAAS4D,EAAY5D,MAAMhkC,OAAS,IAAI4nC,EAAY5D,QAAU,GAEzF4D,EAAYkR,KAAO1vC,EAAQ46B,EAE3B,MAAM0oD,EAAqB,CAAChnF,KAAKwvE,0BAA0BxvE,KAAKixE,oBAAoBO,2BAIpF,OAHAwV,EAAmBnnF,QAAQG,KAAKixE,oBAAoBiI,0BAA0B95C,EAAcp/B,KAAK26E,kBACjGz4C,EAAY6rC,qBAAuBiZ,EAE5BtvD,QAAQvxB,UAEnB,qBAAqB+7B,EAAau/C,EAAmBG,GACjD,MAAMv/C,EAAYH,EAAYssC,kBACxBC,EAAWvsC,EAAYusC,SAC7B,GAAkB,OAAdpsC,GAAmC,OAAbosC,IAAqBmT,EAAYt+B,KAAK/rB,GAAQA,IAAS8K,GAAjF,CAGA,IAAKo/C,EAAkBn+B,KAAKm6B,GAAWA,IAAYp7C,GAG/C,aAFMosC,EAASgM,YAAYp4C,QAC3Bu/C,EAAY/hF,KAAKwiC,GAGrB,GAA0C,OAAtCH,EAAYy1C,sBACZ,IAAK,MAAMlI,KAAmBvtC,EAAYy1C,4BAChC33E,KAAK6hF,eAAepS,EAAiBgS,EAAmBG,IAI1E,oBAAoB0D,GAChB,GAAI,YAAaA,EACb,OAAOA,EAAmBtmF,QAE9B,GAAI,gBAAiBsmF,EACjB,OAAOA,EAAmBtuD,YAAYh4B,QAE1C,MAAMiY,EAAajX,KAAKinF,iBAAiB3B,GACzC,YAAmB,IAAfruE,EACO,KAEJA,EAAWjY,QAEtB,aAAaomF,GACT,MAAI,sBAAuBA,EAChBA,EAEP,aAAgBA,GACTA,EAAqB/uF,IAAI,KAEhC,gBAAiB+uF,EACVA,EAAqBpuD,YAAYh4B,QAAQ3I,IAAI,KAEjD,KAKX,iBAAiBq+B,GACb,IAAIrd,EAAMqd,EACV,KAAe,OAARrd,GAAc,CACjB,MAAM6vE,EAAmB7vE,EAAIukC,SAASl+C,cAChCuZ,EAAa,IAAS7a,OAAO,GAAG,IAAcrG,QAAQmxF,IAAoB7vE,IACzE,IAASjb,OAAO,IAAcrG,KAAMshB,GAC3C,QAAmB,IAAfJ,EACA,OAAOA,EAEXI,EAAM,IAAIue,uBAAuBve,KAK7C,GAAO3S,OAAS,CAAC,IC16BV,MACH,cACI1E,KAAK4jB,QAAU,GACf5jB,KAAKq+B,QAAU,CACXuiD,sBAAuB,GAE3B5gF,KAAKoyC,UAAW,EAChBpyC,KAAKshF,mBAAsB6F,IACvB,MAAMxjE,EAAQwjE,EACRC,EAAkB,GACpBpnF,KAAKgsE,eAAiBhsE,KAAKqnF,qBAC3BrnF,KAAKsnF,YACDtnF,KAAKgsE,eAAiBhsE,KAAKqnF,mBAC3BD,EAAgBnN,SAAU,GAG1BmN,EAAgB1C,OAAQ,EACxB0C,EAAgB3C,KAAM,EAEtBzkF,KAAKgsE,aAAe,CAChB9mE,MAAO,EACPg9B,YAAa,GACb6rC,qBAAsB,IAE1B/tE,KAAK4jB,QAAU,UAGH,IAAhBD,EAAMze,OAAqBye,EAAMuhE,WAAcvhE,EAAM4jE,WAWhD5jE,EAAM4jE,YAAcH,EAAgBnN,QACzCt2D,EAAMze,MAAQlF,KAAKgsE,aAAa9mE,MAE3Bye,EAAMuhE,WACXkC,EAAgBx2D,SAAU,EAC1Bw2D,EAAgB3C,KAAM,EACtB9gE,EAAMze,MAAQlF,KAAKgsE,aAAa9mE,QAGhCkiF,EAAgB3C,KAAM,EACtB9gE,EAAMze,WAAoC,IAA5BlF,KAAKgsE,aAAa9mE,MAAmBlF,KAAKgsE,aAAa9mE,MAAQ,EAAIlF,KAAK4jB,QAAQtpB,SApB9FqpB,EAAM6jE,gBAAkB7jE,EAAMze,YAAqC,IAA5BlF,KAAKgsE,aAAa9mE,MAAmBlF,KAAKgsE,aAAa9mE,MAAQ,GACtGye,EAAMue,iBAA4C,IAA9BliC,KAAK4jB,QAAQD,EAAMze,QAAmD,OAA9BlF,KAAK4jB,QAAQD,EAAMze,OAAkBlF,KAAK4jB,QAAQD,EAAMze,OAAO6oE,qBAAuBpqD,EAAMoqD,qBACxJpqD,EAAMuhE,WAAY,EACdvhE,EAAM6jE,gBAAkB,EACxBJ,EAAgBxN,SAAU,EAErBj2D,EAAM6jE,gBAAkB,IAC7BJ,EAAgBzN,MAAO,IAe/B35E,KAAKgR,eAAe2S,EAAOyjE,EAAiBpnF,KAAKgsE,eAErDhsE,KAAKqnF,mBAAqB,CACtBnlD,YAAa,0BACb6rC,qBAAsB,IAE1B/tE,KAAKgsE,aAAehsE,KAAKqnF,mBACzBrnF,KAAKynF,mBAAqB,IAAInd,EAAMtqE,KAAKshF,oBAE7C,aACI,OAAOthF,KAAKynF,mBAAmBntF,OAEnC,SAASi1E,EAAQlxC,GACb,GAAIr+B,KAAKoyC,SACL,MAAM,IAAI3xC,MAAM,wCAEpBT,KAAKoyC,UAAW,EAChBpyC,KAAKuvE,OAASA,EACdvvE,KAAKq+B,QAAU,IAAKA,GAExB,aACI,IAAKr+B,KAAKoyC,SACN,MAAM,IAAI3xC,MAAM,oCAEpBT,KAAKynF,mBAAmB96D,QACxB3sB,KAAKoyC,UAAW,EAEpB,SAASzuB,GACL,OAAO3jB,KAAKynF,mBAAmBnc,QAAQ3nD,GAE3C,UACI,MAAMA,EAAQ3jB,KAAKgsE,aACnB,OAAIroD,IAAU3jB,KAAKqnF,mBACR3vD,QAAQi3B,UAEnBhrC,EAAMuhE,WAAY,EAClBvhE,EAAM4jE,YAAa,EACZvnF,KAAKiiF,SAASt+D,IAEzB,GAAG+jE,GACC,MAAMC,QAAwCxiF,IAA5BnF,KAAKgsE,aAAa9mE,MAAsBlF,KAAKgsE,aAAa9mE,MAAQ,GAAKwiF,EACzF,GAAIC,GAAY3nF,KAAK4jB,QAAQtpB,OACzB,OAAOo9B,QAAQi3B,SAEnB,MAAMhrC,EAAQ3jB,KAAK4jB,QAAQ+jE,GAC3B,OAAO3nF,KAAKiiF,SAASt+D,GAEzB,cAAcmhD,GAEV,OADA9kE,KAAKgsE,aAAalH,MAAQA,EACnB9kE,KAAK4nF,YAEhB,aACI,GAAI5nF,KAAKgsE,cAAgBhsE,KAAKqnF,mBAC1B,MAAO,GAEX,MAAMniF,OAAoC,IAA5BlF,KAAKgsE,aAAa9mE,MAAmBlF,KAAKgsE,aAAa9mE,MAAQ,EAC7E,OAAOlF,KAAK4jB,QAAQllB,MAAM,EAAGwG,EAAQ,GAAG+E,OAAQxT,KAAYA,EAAMquE,OAAO3sE,IAAK1B,GAAUA,EAAMquE,MAAQruE,EAAMquE,MAAQ,IAExH,WACI,MAAMphE,EAAQ1D,KAAKq+B,QAAQmzB,MAAQ,IAAKxxD,KAAKq+B,QAAQmzB,MAAM9tD,OAAU,GAGrE,MAAO,CAAEA,QAAOkgB,QAFClgB,EAAMkgB,SAAW,GAETooD,aADHtoE,EAAMsoE,cAAgBhsE,KAAKqnF,oBAGrD,YACI,MAAM3jF,EAAQ1D,KAAK6nF,WACnB7nF,KAAK4jB,QAAUlgB,EAAMkgB,QACrB5jB,KAAKgsE,aAAetoE,EAAMsoE,aAE9B,gBAAgBnsE,GAAO,GACnB,GAAIG,KAAKgsE,eAAiBhsE,KAAKqnF,mBAC3B,OAAO3vD,QAAQvxB,UAEnB,MAAM2hF,EAAc9nF,KAAK+nF,cAAc/nF,KAAKgsE,cAE5C,GADAhsE,KAAK4jB,aAA8Bze,IAAtB2iF,EAAY5iF,MAAsB4iF,EAAY5iF,MAAQ,GAAK4iF,OACjC,IAAnC9nF,KAAKq+B,QAAQ2mD,mBAAgChlF,KAAKq+B,QAAQuiD,sBAAwB,EAAG,CACrF,MAAM17E,EAAQlF,KAAK4jB,QAAQtpB,OAAS0F,KAAKq+B,QAAQuiD,sBACjD,IAAK,IAAIprF,EAAI,EAAGA,EAAI0P,EAAO1P,IAAK,CAC5B,MAAMmuB,EAAQ3jB,KAAK4jB,QAAQpuB,GACM,iBAAtBmuB,EAAMue,aAAkE,iBAA/Bve,EAAMoqD,uBACtD/tE,KAAK4jB,QAAQpuB,SAAWwK,KAAKq+B,QAAQ2mD,kBAAkBrhE,EAAO3jB,KAAK4jB,QAAQllB,MAAMwG,MAI7F,IAAKlF,KAAKq+B,QAAQmzB,MACd,OAAO95B,QAAQvxB,UAEnB,MAAMzC,EAAQ,CACVkgB,QAAS,GACTooD,aAAc,IAAKhsE,KAAKgoF,iBAAiBF,KAE7C,IAAK,MAAMnkE,KAAS3jB,KAAK4jB,QACrBlgB,EAAMkgB,QAAQ/jB,KAAKG,KAAKgoF,iBAAiBrkE,IAE7C,OAAI9jB,EACOG,KAAKq+B,QAAQmzB,MAAM6a,mBAAmB3oE,GAGtC1D,KAAKq+B,QAAQmzB,MAAMy2B,sBAAsBvkF,GAGxD,cAAcigB,GACV,MAAM,SAAEukE,EAAQ,YAAElG,EAAW,UAAEkD,EAAS,WAAEqC,EAAU,UAAE3C,EAAS,gBAAE4C,EAAe,WAAE9N,EAAU,MAAEjsE,EAAK,QAAEtH,EAAO,OAAEwoD,KAAWw5B,GAAkBxkE,EAC3I,OAAOwkE,EAEX,eAAejmD,GACXliC,KAAKgsE,aAAe9pC,EACpB,IAAIh9B,OAAoCC,IAA5BnF,KAAKgsE,aAAa9mE,MAAsBlF,KAAKgsE,aAAa9mE,MAAQ,EAC9E,GAAIlF,KAAKgsE,aAAa4Y,UACd1iD,EAAY8/C,aAAehiF,KAAKq+B,QAAQmzB,aAClCxxD,KAAKq+B,QAAQmzB,MAAM42B,oBAE7BljF,IACAlF,KAAKgsE,aAAa9mE,MAAQA,EAC1BlF,KAAK4jB,QAAQ1e,GAASlF,KAAK+nF,cAAc/nF,KAAKgsE,oBACxChsE,KAAK4nF,iBAEV,GAAI5nF,KAAKgsE,aAAakZ,UACvBllF,KAAK4jB,QAAQ1e,GAASlF,KAAK+nF,cAAc/nF,KAAKgsE,oBACxChsE,KAAK4nF,gBAEV,CACD,QAAuC,IAAnC5nF,KAAKq+B,QAAQ2mD,mBAAgChlF,KAAKq+B,QAAQuiD,sBAAwB,EAAG,CAErF,MAAMyH,EAAgBroF,KAAK4jB,QAAQtpB,OAAS0F,KAAKq+B,QAAQuiD,sBACzD,IAAK,MAAMj9D,KAAS3jB,KAAK4jB,QAAQllB,MAAMwG,GACF,iBAAtBye,EAAMue,aAAkE,iBAA/Bve,EAAMoqD,4BAChD/tE,KAAKq+B,QAAQ2mD,kBAAkBrhE,EAAO3jB,KAAK4jB,QAAQllB,MAAM2pF,EAAenjF,IAI1FlF,KAAK4jB,QAAU5jB,KAAK4jB,QAAQllB,MAAM,EAAGwG,GACrClF,KAAK4jB,QAAQ/jB,KAAKG,KAAK+nF,cAAc/nF,KAAKgsE,qBACpChsE,KAAK4nF,WAAU,GAErB5nF,KAAKgsE,aAAa7lE,SAClBnG,KAAKgsE,aAAa7lE,UAG1B,aAAa+7B,GACLA,EAAY8/C,aAAehiF,KAAKq+B,QAAQmzB,QACpCtvB,EAAYw3C,YAAcx3C,EAAYw3C,WAAW+K,UAC3CzkF,KAAKq+B,QAAQmzB,MAAM42B,0BAGnBpoF,KAAKq+B,QAAQmzB,MAAM0a,KAAKhqC,EAAYslD,iBAAmB,IAAI,IAGrExnF,KAAKgsE,aAAa7lE,SAClBnG,KAAKgsE,aAAa7lE,UAG1B,eAAewd,EAAOyjE,EAAiBkB,GACnC,MAAMpmD,EAAc,IAAKve,GACzBue,EAAYw3C,WAAa0N,EACzBllD,EAAYgmD,SAAWloF,KAAK+nF,cAAcO,GAC1C,IAASpgF,MAAM,IAAO,WAAYg6B,EAAaA,EAAYgmD,SAAUloF,KAAK4jB,SACtE5jB,KAAKq+B,QAAQ7/B,UACbwB,KAAKq+B,QAAQ7/B,SAAS0jC,GAG9B,iBAAiBve,GACb,MAAM4kE,EAAY,IAAK5kE,GAOvB,OANI4kE,EAAUrmD,aAAgD,iBAA1BqmD,EAAUrmD,cAC1CqmD,EAAUrmD,YAAcliC,KAAKuvE,OAAO0B,oBAAoBmO,8BAA8BmJ,EAAUrmD,cAEhGqmD,EAAUxa,sBAAkE,iBAAnCwa,EAAUxa,uBACnDwa,EAAUxa,qBAAuB/tE,KAAKuvE,OAAO0B,oBAAoBmO,8BAA8BmJ,EAAUxa,uBAEtGwa,ID+sByB,GAAoB,EE96BrD,MACH,cACIvoF,KAAK+kF,WAAa,CACdtW,SAAU,IACVoD,QAAS,IACTpkE,MAAO,IACP+6E,WAAY,IACZC,SAAU,IACVC,QAAS,IACTjd,WAAY,IACZkd,cAAe,IACfC,mBAAoB,IACpBC,sBAAuB,IACvBhM,UAAW,IACXjhF,IAAK,IACL+wB,MAAO,IACPm8D,OAAQ,KAGhB,SAASzqD,GACLA,EAAUA,GAAW,GACrBr+B,KAAK+kF,WAAa,IAAK/kF,KAAK+kF,cAAe1mD,EAAQ0mD,YAEvD,+BACI,OAAO/kF,KAAK+kF,WAAWp4D,MAE3B,6BACI,OAAO3sB,KAAK+kF,WAAWnpF,IAE3B,2BAA2BsmC,GACvB,OAAOA,aAAuB,GACxBA,EAAY6sC,gBAAkB/uE,KAAKwxE,4BAA8BtvC,EAAY60C,aAC7E70C,EAAYz/B,WAAWzC,KAAKwxE,2BAA6BtvC,IAAgBliC,KAAKwxE,yBAExF,yBAAyBtvC,GACrB,OAAOA,aAAuB,GACxBA,EAAY6sC,gBAAkB/uE,KAAKyxE,uBAClCvvC,IAAgBliC,KAAKyxE,wBACjBvvC,EAAYz/B,WAAW,GAAGzC,KAAK+kF,WAAWnpF,MAAMoE,KAAK+kF,WAAWtW,YAE/E,gCAAgCvsC,GAC5B,OAAOA,aAAuB,GACxBA,EAAY6sC,gBAAkB/uE,KAAKwxE,4BAA8BtvC,EAAY6uC,cAC7E7uC,EAAYz/B,WAAWzC,KAAKwxE,2BAA6BtvC,IAAgBliC,KAAKwxE,yBAExF,+BAA+BtvC,GAC3B,OAAOA,aAAuB,GACxBA,EAAY6sC,gBAAkB/uE,KAAKwxE,2BAA6BtvC,EAAY60C,aAC5E70C,IAAgBliC,KAAKwxE,yBAE/B,6BAA6BtvC,GACzB,OAAOA,aAAuB,GACxBA,EAAY6sC,gBAAkB/uE,KAAKyxE,yBAA2BvvC,EAAY60C,aAC1E70C,IAAgBliC,KAAKyxE,uBAE/B,0BAA0BpvC,EAAWosC,EAAUhD,EAAY+L,GAAY,EAAMG,EAAwB,MACjG,MAAMz1C,EAAc,IAAI,GAAoBG,EAAWosC,EAAUhD,EAAY+L,EAAWG,GAExF,OADAz1C,EAAY6mD,uBAAuB/oF,MAC5BkiC,EAEX,0BAA0B9C,GACtB,MAAMyT,EAAQ,SAASmD,KAAK5W,GAC5B,IAAIpgC,EAAU,GACV7E,MAAMC,QAAQy4C,IAAUA,EAAMv4C,OAAS,IACvC0E,EAAU6zC,EAAM,GAChBzT,EAAeA,EAAa1gC,MAAMM,EAAQ1E,SAE9C,MAAM0uF,EAAqBhpF,KAAKipF,gCAAgC7pD,GAAc,GAAMA,aACpF,IAAK,MAAM8C,KAAe8mD,EACtB9mD,EAAYljC,QAAUA,EAE1B,OAAOgqF,EAEX,yBAAyB9mD,GACrB,MAAM9C,EAAep/B,KAAKw6E,0BAA0Bt4C,GACpD,OAAI9C,EAAa9kC,OACN8kC,EAAa,GAEjBp/B,KAAKwvE,0BAA0B,IAE1C,8BAA8BpwC,EAAc8pD,GAAkB,EAAOC,GAAkB,GACnF,OAAO/pD,EACFjnC,IAAI+pC,GAAeliC,KAAKopF,6BAA6BlnD,EAAagnD,EAAiBC,IACnFl/E,OAAOi4B,GAAeA,GAAeA,EAAY5nC,QACjDjC,KAAK2H,KAAK+kF,WAAWlT,SAE9B,6BAA6B3vC,EAAagnD,GAAkB,EAAOC,GAAkB,GACjF,GAA2B,iBAAhBjnD,EACP,OAAOliC,KAAKqpF,8BAA8BnnD,EAAagnD,GAEtD,CACD,IAAII,EAAyBJ,EACzBK,GAA0B,EAC9B,GAAIJ,EAAiB,CACjB,GAAIjnD,EAAYusC,UAAYvsC,EAAYusC,SAASpwC,QAAQi8C,OACrD,MAAO,GAENp4C,EAAYo1C,yBAA0Bp1C,EAAYusC,UAAavsC,EAAYusC,SAASpwC,QAAQmrD,mBAC7FF,GAAyB,GAEzBpnD,EAAYusC,UAAYvsC,EAAYusC,SAASpwC,QAAQuwC,WAAa1sC,EAAY6sC,gBAC9Ewa,GAA0B,IAEzBrnD,EAAYo1C,wBAA0Bp1C,EAAY6uC,gBACnDuY,GAAyB,GAGjC,MAAMhX,EAAQpwC,EAAYowC,MACpBsU,EAAmB1kD,EAAYy1C,sBACrC,IAAI8R,EAAcvnD,EAAYljC,QAE9B,GAAc,OAAVszE,EAAgB,CAEhB,GAAc,KAAVA,EACA,OAAOn4E,MAAMC,QAAQwsF,GACf5mF,KAAKo/E,8BAA8BwH,EAAkBsC,EAAiBC,GACtE,GAEVM,GAAenX,EAAM3hD,SAAS3wB,KAAK+kF,WAAWt3E,OAAS6kE,EAAM5zE,MAAM,GAAIsB,KAAK+kF,WAAWt3E,MAAMnT,QAAUg4E,OAGvGmX,GAAezpF,KAAKqpF,8BAA8BnnD,EAAaonD,EAAwBC,GAE3F,GAAIpvF,MAAMC,QAAQwsF,IAAqBA,EAAiBtsF,OAAQ,CAC5D,MAAMovF,EAAkB1pF,KAAKo/E,8BAA8BwH,EAAkBsC,EAAiBC,GAC1FO,EAAgBpvF,OAAS,IACzBmvF,GAA2C,IAA5B7C,EAAiBtsF,OAC1B,GAAG0F,KAAK+kF,WAAWt3E,QAAQi8E,IAC3B,GAAG1pF,KAAK+kF,WAAWt3E,QAAQzN,KAAK+kF,WAAWyD,aAAakB,IAAkB1pF,KAAK+kF,WAAW0D,YAGxG,OAAOgB,GAGf,oCAAoCrqD,GAChC,OAAKjlC,MAAMC,QAAQglC,GAGZA,EAAajnC,IAAK+pC,GAAgBliC,KAAKopF,6BAA6BlnD,IAAc7pC,KAAK2H,KAAK+kF,WAAWt3E,OAFnGzN,KAAK2pF,oCAAoC,CAACvqD,IAIzD,2BAA2BA,GACvB,OAAOq9B,mBAAmBz8D,KAAKo/E,8BAA8BhgD,IAAexO,QAAQ,MAAO,OAAOA,QAAQ,MAAO,OAErH,2BAA2BwO,GACvB,OAAOp/B,KAAKw6E,0BAA0B5M,mBAAmBxuC,IAE7D,gBAAgBwqD,EAAczc,GAI1B,OAHIyc,IACAzc,EAAO,IAAIyc,IAAe5pF,KAAK+kF,WAAWt3E,QAAQ0/D,KAE/CA,EAEX,qBAAqB/5B,GAGjB,MAAO,CAAEy2C,eAFez2C,IAASpzC,KAAK+kF,WAAWp4D,OAASymB,EAAK3wC,WAAWzC,KAAK+kF,WAAWp4D,MAAQ3sB,KAAK+kF,WAAWnpF,KAEzFkuF,QADT12C,EAAK3wC,WAAWzC,KAAK+kF,WAAWp4D,OAASymB,EAAK10C,MAAM,GAAK00C,GAG7E,0BAA0BhU,GACtB,MAAMkwC,EAAS,GACf,IAAK,IAAIptC,KAAe9C,EAAc,CACP,iBAAhB8C,IACPA,EAAcliC,KAAKkxE,yBAAyBhvC,IAEhD,MAAMh9B,EAAQoqE,EAAO59B,UAAUq4C,GAASA,EAAM3F,aAAaliD,IACvDh9B,GAAS,EACToqE,EAAO19D,OAAO1M,EAAO,EAAGg9B,GAGxBotC,EAAOzvE,KAAKqiC,GAGpB,OAAOotC,EAEX,4BAA4BlwC,GACxB,MAAM8mD,EAAO,GACb,IAAK,MAAMhkD,KAAe9C,EACtB8mD,EAAKrmF,KAAKqiC,GACNA,EAAYy1C,uBACZuO,EAAKrmF,QAAQG,KAAKm/E,4BAA4Bj9C,EAAYy1C,wBAGlE,OAAOuO,EAEX,0BAA0B9mD,EAAc4qD,GAAgB,EAAOhrF,GAAU,GACrE,MAAMirF,EAAS,GACf,IAAK,MAAM/nD,KAAe9C,EAAc,CACpC,MAAMv7B,EAAQ7D,KAAKwvE,2BAA2Bwa,EAAgB9nD,EAAYssC,kBAAoB,OAAStsC,EAAYosC,eAAiBpsC,EAAY6sC,cAAeib,GAAgB9nD,EAAYusC,UAAuCvsC,EAAY60C,aAA8C,OAAhC70C,EAAYo6C,gBAA2Bp6C,EAAYo6C,qBAAkB,GACjUz4E,EAAMyzE,uBAAyBp1C,EAAYo1C,uBAC3CzzE,EAAMyuE,MAAQpwC,EAAYowC,MACtBtzE,IACA6E,EAAM7E,QAAUkjC,EAAYljC,SAEhC6E,EAAMktE,cAAgBiZ,EAAgB9nD,EAAY6uC,cAAgB,KAClEltE,EAAM4J,MAAQu8E,EAAgB9nD,EAAYz0B,MAAQ,KAC9Cy0B,EAAYy1C,wBACZ9zE,EAAM8zE,sBAAwB33E,KAAKk5E,0BAA0Bh3C,EAAYy1C,sBAAuBqS,EAAehrF,IAEnHirF,EAAOpqF,KAAKgE,GAEhB,OAAOomF,EAGX,yBAAyBxe,EAAYye,GAAe,GAChD,GAAIze,SAAyE,IAAtBA,EAAWnxE,OAC9D,MAAO,GAEX,GAA0B,iBAAfmxE,EAAyB,CAChC,MAAMtnD,EAAO,GACPziB,EAAS+pE,EAAWh7C,MAAMzwB,KAAK+kF,WAAW6D,oBAChD,IAAK,MAAMjb,KAASjsE,EAAQ,CACxB,IAAI3K,EACAN,GACHM,EAAKN,GAASk3E,EAAMl9C,MAAMzwB,KAAK+kF,WAAW8D,4BAC7B,IAAVpyF,GACAA,EAAQyzF,EAAetc,mBAAmB72E,GAAOA,EACjDA,OAAM,GAEDmzF,IACLnzF,EAAM62E,mBAAmB72E,GACzBN,EAAQm3E,mBAAmBn3E,IAE/B0tB,EAAKtkB,KAAK,CAAE9I,MAAKN,UAErB,OAAO0tB,EAEX,GAAIhqB,MAAMC,QAAQqxE,GACd,OAAOA,EAAWtzE,IAAIw1E,IAAS,CAAG52E,SAAK,EAAQN,MAAOk3E,KAE1D,MAAMn0E,EAAOtD,OAAOsD,KAAKiyE,GAEzB,OADAjyE,EAAKoX,OACEpX,EAAKrB,IAAIpB,IAAO,CAAGA,MAAKN,MAAOg1E,EAAW10E,MAGrD,6BAA6B00E,EAAYye,GAAe,GACpD,IAAK/vF,MAAMC,QAAQqxE,IAAqC,IAAtBA,EAAWnxE,OACzC,MAAO,GAEX,MAAM6vF,EAAOnqF,KAAK+kF,WAClB,OAAOtZ,EACFtzE,IAAIw1E,IACL,MAAM52E,OAAoB,IAAd42E,EAAM52E,KAAkBmzF,EAAeztB,mBAAmBkR,EAAM52E,KAAO42E,EAAM52E,IACnFN,EAAQyzF,EAAeztB,mBAAmBkR,EAAMl3E,OAASk3E,EAAMl3E,MACrE,YAAe,IAARM,GAAkBA,IAAQN,EAAQM,EAAMozF,EAAKtB,sBAAwBpyF,EAAQA,IAEnF4B,KAAK8xF,EAAKvB,oBAEnB,WAAWxpD,EAAc3xB,GACrB,MAAMukE,EAAW,GAMjB,OALAA,EAASnyE,QAAQu/B,EAAan1B,OAAOi4B,GAAeA,EAAYz0B,QAAUA,IAC1EukE,EAASnyE,QAAQu/B,EACZn1B,OAAO44E,GAASA,EAAMp1E,QAAUA,GAChCtV,IAAI0qF,GAAS1oF,MAAMC,QAAQyoF,EAAMlL,uBAAyB33E,KAAKgmF,WAAWnD,EAAMlL,sBAAuBlqE,GAAS,IAChHy4E,QACElU,EAEX,cAAc5yC,EAAco/C,GACxB,IAAK,MAAMt8C,KAAe9C,EAAc,CACpC,MAAM4yC,EAAWwM,EAAOv0E,OAAO44E,GAASA,EAAMnU,cAAcxsC,IAC5D,GAAwB,IAApB8vC,EAAS13E,OACT,OAAO,EAEX,GAAIH,MAAMC,QAAQ8nC,EAAYy1C,wBACvBz1C,EAAYy1C,sBAAsBr9E,OAAS,IAC4H,IAAvK0F,KAAKimF,cAAc/jD,EAAYy1C,sBAAuB3F,EAAS75E,IAAI0qF,GAAS1oF,MAAMC,QAAQyoF,EAAMlL,uBAAyBkL,EAAMlL,sBAAwB,IAAIuO,QAC9J,OAAO,EAGf,OAAO,EAEX,gCAAgC9mD,EAAcgrD,GAAU,GACpD,IAAKhrD,EACD,MAAO,CAAEA,aAAc,GAAI6yC,UAAW,IAEtC7yC,EAAa38B,WAAWzC,KAAK+kF,WAAWyD,cACxCppD,EAAe,GAAGp/B,KAAK+kF,WAAWt3E,QAAQ2xB,KAE9C,MAAM43C,EAAuB,GAC7B,IAAImM,EAAQ,IACZ,KAAO/jD,EAAa9kC,QAAU6oF,GAE1B,GADAA,IACI/jD,EAAa38B,WAAWzC,KAAK+kF,WAAWt3E,OAAQ,CAEhD,MAAM+6E,GADNppD,EAAeA,EAAa1gC,MAAMsB,KAAK+kF,WAAWt3E,MAAMnT,SACxBmI,WAAWzC,KAAK+kF,WAAWyD,YACvDA,IACAppD,EAAeA,EAAa1gC,MAAMsB,KAAK+kF,WAAWyD,WAAWluF,SAEjE,MAAQ8kC,aAAc7O,EAAK,UAAE0hD,GAAcjyE,KAAKipF,gCAAgC7pD,EAAcopD,GAC1FxR,EAAqB18E,OACrB08E,EAAqBA,EAAqB18E,OAAS,GAAGq9E,sBAAwBpnD,EAG9EymD,EAAqBn3E,QAAQ0wB,GAEjC6O,EAAe6yC,MAEd,IAAI7yC,EAAa38B,WAAWzC,KAAK+kF,WAAW0D,UAI7C,OAHI2B,IACAhrD,EAAeA,EAAa1gC,MAAMsB,KAAK+kF,WAAW0D,SAASnuF,SAExD,CAAE8kC,aAAc43C,EAAsB/E,UAAW7yC,GAEvD,GAAIA,EAAa38B,WAAWzC,KAAK+kF,WAAWlT,WAAa7xE,KAAKqxE,yBAAyBjyC,GAAe,CACvG,IAAKgrD,EACD,MAAO,CAAEhrD,aAAc43C,EAAsB/E,UAAW7yC,GAE5DA,EAAeA,EAAa1gC,MAAMsB,KAAK+kF,WAAWlT,QAAQv3E,YAEzD,CACD,MAAQ4nC,YAAa8uC,EAAmB,UAAEiB,GAAcjyE,KAAKqqF,0BAA0BjrD,GACvF43C,EAAqBn3E,KAAKmxE,GAC1B5xC,EAAe6yC,GAGvB,MAAO,CAAE7yC,aAAc43C,EAAsB/E,UAAW7yC,GAE5D,cAAc8C,EAAaooD,GACvB,MAAM13C,EAAU,GAEhB,IAAK,MAAM+Y,KAAS2+B,EAAQ,CACPpoD,EAAYj5B,QAAQ0iD,IACrB,IACZ/Y,EAAQ+Y,GAASzpB,EAAYj5B,QAAQ0iD,IAG7C,MAAM4+B,EAAMriE,KAAKE,OAAOlyB,OAAOsK,OAAOoyC,IACtC,IAAK,MAAM+Y,KAAS/Y,EAChB,GAAIA,EAAQ+Y,KAAW4+B,EACnB,MAAO,CAAE5+B,QAAO4+B,OAGxB,MAAO,CAAE5+B,MAAO,GAAI4+B,KAAM,GAE9B,0BAA0BroD,GACtB,MAAMioD,EAAOnqF,KAAK+kF,WACZuF,EAAS,CAACH,EAAK1e,WAAY0e,EAAK1b,SAAU0b,EAAKzB,QAASyB,EAAK1B,SAAU0B,EAAK18E,MAAO08E,EAAKtY,SAC9F,IAIIlmB,EACA4+B,EALAloD,OAAY,EACZ45C,OAAmB,EACnBxN,OAAW,EACXhhE,GAAQ,EAGZ,MAAM+8E,EAAW,CAACL,EAAKvuF,IAAKuuF,EAAKx9D,OACjC,IAAK,MAAM89D,KAAWD,EAClB,GAAItoD,IAAgBuoD,EAAS,CACzBpoD,EAAYH,EACZA,EAAc,GACdooD,EAAOnjE,QACPmjE,EAAOnjE,QACPwkC,EAAQw+B,EAAK1b,SACb,MAGR,QAAkB,IAAdpsC,EACA,IAAK,MAAMooD,KAAWD,EAClB,GAAItoD,EAAYz/B,WAAW,GAAGgoF,IAAUN,EAAK1b,YAAa,CACtDpsC,EAAYooD,EACZvoD,EAAcA,EAAYxjC,MAAM,GAAG+rF,IAAUN,EAAK1b,WAAWn0E,QAC7DgwF,EAAOnjE,QACPmjE,EAAOnjE,QACPwkC,EAAQw+B,EAAK1b,SACb,MAgCZ,YA5BkB,IAAdpsC,MACGspB,QAAO4+B,OAAQvqF,KAAK0qF,cAAcxoD,EAAaooD,IAClDjoD,GAAqB,IAATkoD,EAAaroD,EAAYxjC,MAAM,EAAG6rF,GAAOroD,EACrDA,GAAuB,IAATqoD,EAAaroD,EAAYxjC,MAAM6rF,EAAM5+B,EAAMrxD,QAAU,GACnEgwF,EAAOnjE,QACHwkC,IAAUw+B,EAAK1e,eACZ9f,QAAO4+B,OAAQvqF,KAAK0qF,cAAcxoD,EAAa,CAACioD,EAAKxB,iBACxD1M,EAAmB/5C,EAAYxjC,MAAM,EAAG6rF,GACxCroD,EAAcA,EAAYxjC,MAAM6rF,EAAM5+B,EAAMrxD,UACzCqxD,SAAU3rD,KAAK0qF,cAAcxoD,EAAaooD,IAC7CpoD,EAAcA,EAAYxjC,MAAMitD,EAAMrxD,SAE1CgwF,EAAOnjE,SAEPwkC,IAAUw+B,EAAK1b,aACZ9iB,QAAO4+B,OAAQvqF,KAAK0qF,cAAcxoD,EAAaooD,IAClD7b,GAAoB,IAAT8b,EAAaroD,EAAYxjC,MAAM,EAAG6rF,GAAOroD,EACpDA,GAAuB,IAATqoD,EAAaroD,EAAYxjC,MAAM6rF,EAAM5+B,EAAMrxD,QAAU,IAEvEgwF,EAAOnjE,QACHwkC,IAAUw+B,EAAKzB,UACfj7E,GAAQ,GAGRk+C,IAAUw+B,EAAK1B,UAAY98B,IAAUw+B,EAAK18E,OAASk+C,IAAUw+B,EAAKtY,UAClE3vC,EAAc,GAAGypB,IAAQzpB,KAGtB,CAAEA,YADmBliC,KAAKwvE,0BAA0BntC,EAAWosC,EAAUwN,EAAkBxuE,GACvDwkE,UAAW/vC,GAE1D,8BAA8BA,EAAagnD,GAAkB,EAAOyB,GAAmB,GACnF,GAA2B,iBAAhBzoD,EACP,OAAOliC,KAAKopF,6BAA6BppF,KAAKkxE,yBAAyBhvC,GAAcgnD,EAAiByB,GAErG,CACD,IAAIC,EAAqBD,EAA+C,GAA5BzoD,EAAY6sC,cACxD,MAAM8b,EAAgB3oD,EAAYosC,cAAgBpsC,EAAYosC,cAAc7C,WAAa,KACnFA,EAAazrE,KAAKu8E,6BAA6Br6C,EAAY4oD,mBAAmBD,IAYpF,OAXIpf,EAAWnxE,OAAS,IACpBswF,GAAsBD,EAEhBlf,EADA,GAAGzrE,KAAK+kF,WAAWtZ,aAAaA,IAAazrE,KAAK+kF,WAAW4D,iBAGtC,OAA7BzmD,EAAY60C,cAA0BmS,IACtC0B,GAAqB5qF,KAAK+kF,WAAWtW,SAAWvsC,EAAY60C,cAE3D70C,EAAYs1C,YACboT,GAAqB5qF,KAAK+kF,WAAW2D,SAElCkC,GAAqB,OC9ZxC,IAAI,GAA0C,SAAU3wF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAK1G,IAAI+/E,GAAmB,MACnB,YAAYxb,GACRvvE,KAAKuvE,OAASA,EACdvvE,KAAKjK,KAAO,KACZiK,KAAK8xE,OAAS,KACd9xE,KAAKwB,MAAQ,EACbxB,KAAKwyC,QAAU,GAEnB,gBACI,MAAM4rC,EAAMp+E,KAAKuvE,OAAOmR,KAAK1gF,KAAKjK,MAClC,OAAQqoF,QAAiCA,EAAItM,OAAS,GAE1D,iBACI,MAAMsM,EAAMp+E,KAAKuvE,OAAOmR,KAAK1gF,KAAKjK,MAElC,MAAO,CAECqoF,IAAK,GACL4M,GAAI,GACJC,GAAI,GACJ/rF,EAAG,GACHgsF,SAAU,GACVC,SAAU,aACVC,QAAS,MATGhN,QAAiCA,EAAI5rC,QAAU,IAavE,OAAO8/B,GACH,MAAO,WAGf,GAAW,CACP,KACA,GAAW,cAAep8E,SAC3B60F,GAAiB3zF,UAAW,YAAQ,GACvC,GAAW,CACP,KACA,GAAW,cAAelB,SAC3B60F,GAAiB3zF,UAAW,cAAU,GACzC,GAAW,CACP,KACA,GAAW,cAAeiiB,SAC3B0xE,GAAiB3zF,UAAW,aAAS,GACxC,GAAW,CACP,KACA,GAAW,cAAelB,SAC3B60F,GAAiB3zF,UAAW,eAAW,GAC1C2zF,GAAmB,GAAW,CAC1B,YAAOvK,GAAS,KAChB,aAAc,CACVzqF,KAAM,SAAUopC,SAAU,y0CAe9B,GAAW,oBAAqB,CAACjpC,UAClC60F,IC9EH,IAAI,GAA0C,SAAU9wF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAKpD,MAAMmgF,GAAiB,IAAcC,mBAC5C,IAAI,GAAwB,MACxB,YAAY/b,EAAQ1nD,EAASxkB,EAAWkoF,GACpCvrF,KAAKuvE,OAASA,EACdvvE,KAAKqD,UAAYA,EACjBrD,KAAKurF,eAAiBA,EACtBvrF,KAAKjK,KAAO,UACZiK,KAAKq6E,OAAS,GACdr6E,KAAKopD,QAAU,GACfppD,KAAK4uE,SAAW,GAChB5uE,KAAK0oF,SAAU,EACf1oF,KAAKs6E,QAAS,EACdt6E,KAAKu6E,WAAY,EACjBv6E,KAAK2vE,UAAW,EAChB3vE,KAAKyuE,SAAW,KAChBzuE,KAAKwrF,SAAU,EACfxrF,KAAK6nB,QAAUA,EAEnB,aAAa5Q,GACTjX,KAAKqD,UAAY4T,EAAWjY,QAAQ3I,IAAI,KAI5C,cACI2J,KAAKwrF,SAAU,EAEnB,UACI,GAA8B,OAA1BxrF,KAAKuvE,OAAOoM,UACZ,OAEJ,MAAM5lF,EAAOiK,KAAKiwC,aAAa,OAAQjwC,KAAKjK,MAC5C,IAAIU,EAAQuJ,KAAKiwC,aAAa,WAAYjwC,KAAK0oF,SAC/C,MAAMrqD,EAAU,CAAE5wB,WAAiB,IAAVhX,IAAqBA,GAC9CA,EAAQuJ,KAAKiwC,aAAa,UAAWjwC,KAAKq6E,aAC5B,IAAV5jF,IACA4nC,EAAQg8C,OAAS5jF,GAErBA,EAAQuJ,KAAKiwC,aAAa,UAAWjwC,KAAKopD,cAC5B,IAAV3yD,IACA4nC,EAAQ+qB,QAAU3yD,GAEtBA,EAAQuJ,KAAKiwC,aAAa,WAAYjwC,KAAK4uE,eAC7B,IAAVn4E,IACA4nC,EAAQuwC,SAAWn4E,GAEvBA,EAAQuJ,KAAKiwC,aAAa,UAAWjwC,KAAKs6E,QAAQ,QACpC,IAAV7jF,IACA4nC,EAAQi8C,OAAS7jF,GAErBA,EAAQuJ,KAAKiwC,aAAa,aAAcjwC,KAAKu6E,WAAW,QAC1C,IAAV9jF,IACA4nC,EAAQk8C,UAAY9jF,GAExBA,EAAQuJ,KAAKiwC,aAAa,WAAYjwC,KAAK2vE,UAAU,QACvC,IAAVl5E,IACA4nC,EAAQsxC,SAAWl5E,GAEvBuJ,KAAKyuE,SAAWzuE,KAAKuvE,OAAOkc,gBAAgBzrF,KAAKyuE,SAAUzuE,KAAKqD,UAAWtN,EAAMiK,KAAK6nB,QAASwW,GAEnG,aACQr+B,KAAKyuE,UACLzuE,KAAKuvE,OAAOmc,mBAAmB1rF,KAAKyuE,SAAUzuE,KAAKqD,UAAWrD,KAAK6nB,SAEvE7nB,KAAKyuE,SAAW,KAEpB,WAAWp6D,GACPrU,KAAKwrF,SAAU,EACfxrF,KAAKqf,UACDrf,KAAKyuE,UACLzuE,KAAKyuE,SAASjmC,WAAWn0B,GAGjC,aAAaA,GACT,OAAIrU,KAAKyuE,SACEzuE,KAAKyuE,SAASzlC,aAAa30B,GAE/BqjB,QAAQvxB,UAEnB,aAAakO,GACT,OAAIrU,KAAKyuE,SACEzuE,KAAKyuE,SAASvlC,aAAa70B,GAE/BqjB,QAAQvxB,UAEnB,mBAAmBkO,GACXrU,KAAKyuE,iBACCzuE,KAAKyuE,SAAS7lC,aAAav0B,GACjCrU,KAAKwwC,cAGb,aAAaz5C,EAAKN,EAAOk1F,GAAc,GAEnC,GAAI3rF,KAAKwrF,UAAYG,EACjB,OAAOl1F,EAGP,GAAIuJ,KAAK6nB,QAAQwxC,aAAatiE,GAAM,CAChC,GAAI40F,EACA,OAAO,EAIP,IADAl1F,EAAQuJ,KAAK6nB,QAAQooB,aAAal5C,IACxBuD,OAAS,EACf,OAAO7D,KAQ/B,GAAW,CACP,KACA,GAAW,cAAe2B,SAC3B,GAAsBhB,UAAW,YAAQ,GAC5C,GAAW,CACP,KACA,GAAW,cAAegB,SAC3B,GAAsBhB,UAAW,cAAU,GAC9C,GAAW,CACP,KACA,GAAW,cAAegB,SAC3B,GAAsBhB,UAAW,eAAW,GAC/C,GAAW,CACP,KACA,GAAW,cAAegB,SAC3B,GAAsBhB,UAAW,gBAAY,GAChD,GAAW,CACP,KACA,GAAW,cAAe+5B,UAC3B,GAAsB/5B,UAAW,eAAW,GAC/C,GAAW,CACP,KACA,GAAW,cAAe+5B,UAC3B,GAAsB/5B,UAAW,cAAU,GAC9C,GAAW,CACP,KACA,GAAW,cAAe+5B,UAC3B,GAAsB/5B,UAAW,iBAAa,GACjD,GAAW,CACP,KACA,GAAW,cAAe+5B,UAC3B,GAAsB/5B,UAAW,gBAAY,GAChD,GAAwB,GAAW,CAC/B,aAAc,CACVrB,KAAM,cACNspC,WAAYgsD,KAEhB,GAAQ,EAAG7K,IACX,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAQ,EAAG6K,IACX,GAAW,oBAAqB,CAACn1F,OAAQA,OAAQA,OAAQ,MAC1D,ICxKH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAKpD,MAAM0gF,GAAsB,IAAcN,mBACjD,IAAI,GAA6B,MAC7B,YAAY/b,EAAQ1nD,EAASxkB,EAAWtI,EAAQuqC,GAC5CtlC,KAAKuvE,OAASA,EACdvvE,KAAKqD,UAAYA,EACjBrD,KAAKjF,OAASA,EACdiF,KAAKslC,iBAAmBA,EACxBtlC,KAAKjK,KAAO,UACZiK,KAAKuwE,QAAU,GACfvwE,KAAKopB,YAAa,EAClBppB,KAAK4D,OAAS,KACd5D,KAAK+wE,cAAgB,KACrB/wE,KAAKwrF,SAAU,EACfxrF,KAAK6nB,QAAUA,EAEnB,OAAO5Q,EAAYktB,EAAiBv4B,EAAY0W,GAa5C,MAAM3I,EAAO2I,EAAe,QAC5B,OAAO,IAAwBhN,YAAY,IAAKqE,EAAM6lB,eAAe,IAEzE,aAAavoB,GACTjX,KAAKqD,UAAY4T,EAAWjY,QAAQ3I,IAAI,KAI5C,eACI2J,KAAKwrF,SAAU,EAEnB,UACI,GAA8B,OAA1BxrF,KAAKuvE,OAAOoM,UACZ,OAEJ,MAAM5lF,EAAOiK,KAAKiwC,aAAa,OAAQjwC,KAAKjK,MACtCsoC,EAAU,GAChB,IAAI5nC,EAAQuJ,KAAKiwC,aAAa,UAAWjwC,KAAKuwE,cAChC,IAAV95E,IACA4nC,EAAQkyC,QAAU95E,GAEtBA,EAAQuJ,KAAKiwC,aAAa,aAAcjwC,KAAKopB,YAAY,QAC3C,IAAV3yB,IACA4nC,EAAQjV,WAAa3yB,GAGzB4nC,EAAQz6B,OAAS5D,KAAK4D,QAAU,KAChC5D,KAAK+wE,cAAgB/wE,KAAKuvE,OAAOsc,qBAAqB7rF,KAAK+wE,cAAeh7E,EAAMiK,KAAKqD,UAAWrD,KAAK6nB,QAASwW,GAElH,aACQr+B,KAAK+wE,eACL/wE,KAAKuvE,OAAOuc,wBAAwB9rF,KAAK+wE,cAAe/wE,KAAKqD,WAEjErD,KAAK+wE,cAAgB,KAEzB,WAAW18D,GACPrU,KAAKwrF,SAAU,EACfxrF,KAAKg3B,YAAYvpB,MAAQzN,KAAKslC,iBAAiB73B,MAC/CzN,KAAKqf,UACsB,OAAvBrf,KAAK+wE,eACL/wE,KAAK+wE,cAAcvoC,aAG3B,mBAAmBn0B,GAKf,OAJ2B,OAAvBrU,KAAK+wE,eACL/wE,KAAK+wE,cAAcnoC,eAEvB5oC,KAAKwwC,aACE9Y,QAAQvxB,UAEnB,aAAapP,EAAKN,EAAOk1F,GAAc,GAEnC,GAAI3rF,KAAKwrF,QACL,OAAO/0F,EAGP,GAAIuJ,KAAK6nB,QAAQwxC,aAAatiE,GAAM,CAChC,GAAI40F,EACA,OAAO,EAIP,IADAl1F,EAAQuJ,KAAK6nB,QAAQooB,aAAal5C,IACxBuD,OAAS,EACf,OAAO7D,KAQ/B,GAAW,CACP,KACA,GAAW,cAAe2B,SAC3B,GAA2BhB,UAAW,YAAQ,GACjD,GAAW,CACP,KACA,GAAW,cAAegB,SAC3B,GAA2BhB,UAAW,eAAW,GACpD,GAAW,CACP,KACA,GAAW,cAAe+5B,UAC3B,GAA2B/5B,UAAW,kBAAc,GACvD,GAAW,CACP,KACA,GAAW,cAAelB,SAC3B,GAA2BkB,UAAW,cAAU,GACnD,GAA6B,GAAW,CACpC,aAAc,CACVrB,KAAM,oBACNopC,SAAU,wBACVK,eAAe,EACfH,WAAYusD,KAEhB,GAAQ,EAAGpL,IACX,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAQ,EAAGoL,IACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAAC11F,OAAQA,OAAQA,OAAQ,GAA4BA,UACtF,IC/IH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAM3D,IAAI,GAAsB,MACtB,YAAYsrB,EAAK3O,EAAS0nD,EAAQrgC,GAC9BlvC,KAAKw2B,IAAMA,EACXx2B,KAAKuvE,OAASA,EACdvvE,KAAKkvC,aAAeA,EACpBlvC,KAAK0a,SAAW,KAChB1a,KAAK+rF,QAAU,KACf/rF,KAAKgsF,YAAc,cACnBhsF,KAAK6nB,QAAUA,EAEnB,aACI7nB,KAAK0a,SAAW1a,KAAKkvC,aAAala,iBAAiBh1B,KAAKw2B,IAAKx2B,KAAK6nB,QAAS,QAAS7nB,KAAKuvE,OAAOkR,YAAYr6E,QAAS,IAAmBgW,MACxIpc,KAAKisF,cACL,MAAMjvE,EAAkBhd,KAAKuvE,OAAOlsE,UAAUhN,IAAI,KAClD2J,KAAK2c,SAAWK,EAAgBC,YAAY,EAAcjd,KAAKuvE,OAAQ,oBACvEvvE,KAAK2c,SAAS7K,UAAU9R,MAE5B,eAC0B,OAAlBA,KAAK0a,UACL1a,KAAK0a,SAAS9Q,UAElB5J,KAAK2c,SAASrK,YAAYtS,MAE9B,aAAamU,GACTnU,KAAKisF,cAET,cAII,GAHqB,OAAjBjsF,KAAK+rF,UACL/rF,KAAK+rF,QAAU/rF,KAAK6nB,QAAQwxC,aAAa,UAExCr5D,KAAK+rF,QAAS,CAEf,MAAMt1F,EAA8B,iBAAfuJ,KAAKvJ,MAAqBuJ,KAAKvJ,MAAQimE,KAAKC,UAAU38D,KAAKvJ,OAChFuJ,KAAK6nB,QAAQyO,aAAa,OAAQ7/B,IAG1C,eACI,MAAMwgB,EAAa,IAAgBwd,IAAIz0B,KAAK6nB,QAAS,QAAQ9sB,OACvDmxF,EAAU9S,GAA8BoC,2BAA2Bx7E,KAAKuvE,OAAQvvE,KAAKvJ,MAAO,CAAEuI,QAASiY,IACvGmoB,EAAeg6C,GAA8BC,uBAAuBr5E,KAAKuvE,OAAQ2c,EAAQ9sD,cAC/F,IAAK,MAAM8C,KAAe9C,EACI,OAAtB8C,EAAYz0B,QACZy0B,EAAYz0B,MAAQy+E,EAAQz+E,OAIhCzN,KAAKuvE,OAAO4c,YAAY/sD,GACxBp/B,KAAK6nB,QAAQ2nB,UAAU5zC,IAAIoE,KAAKgsF,aAGhChsF,KAAK6nB,QAAQ2nB,UAAUpZ,OAAOp2B,KAAKgsF,eAI/C,GAAW,CACP,aAAS,CAAEr1F,KAAM,IAAYkpB,SAC7B,GAAW,cAAe3pB,SAC3B,GAAoBkB,UAAW,aAAS,GAC3C,GAAsB,GAAW,CAC7B,aAAgB,QAChB,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAQ,EAAGopF,IACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAACtqF,OAAQA,OAAQA,OAAQA,UAC1D,ICjFH,IAAI,GAA0C,SAAU+D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAEtG,GAAoC,SAAUE,EAAY1Q,GAC1D,OAAO,SAAUV,EAAQ/C,GAAOyD,EAAUV,EAAQ/C,EAAKmU,KAM3D,IAAI,GAAsB,MACtB,YAAYsrB,EAAK3O,EAAS0nD,EAAQrgC,GAC9BlvC,KAAKw2B,IAAMA,EACXx2B,KAAKuvE,OAASA,EACdvvE,KAAKkvC,aAAeA,EACpBlvC,KAAKosF,cAAgB,KACrBpsF,KAAK6nB,QAAUA,EAEnB,aACQ7nB,KAAKuvE,OAAOlxC,QAAQmuC,UAAYxsE,KAAKqsF,YACrCrsF,KAAKosF,cAAgBpsF,KAAKkvC,aAAala,iBAAiBh1B,KAAKw2B,IAAKx2B,KAAK6nB,QAAS,QAAS7nB,KAAKuvE,OAAOkR,YAAYr6E,QAAS,IAAmBgW,OAEjJpc,KAAKisF,cAET,eAC+B,OAAvBjsF,KAAKosF,eACLpsF,KAAKosF,cAAcxiF,UAG3B,eACI5J,KAAKisF,cAET,cACIjsF,KAAK6nB,QAAQyO,aAAa,OAAQt2B,KAAKvJ,OAE3C,UACI,MAAMsE,EAASiF,KAAKg3B,YAAYj8B,OAC1B42E,EAA6B,IAAlB52E,EAAO2qC,OAAqC3qC,EAAOkoC,iBAAc,EAClF,YAAoB,IAAb0uC,GACAA,EAASruB,KAAKztD,GAAkB,IAAbA,EAAE6vC,QAAsC7vC,EAAEokC,qBAAqB,MAGjG,GAAW,CACP,aAAS,CAAEtjC,KAAM,IAAYkpB,SAC7B,GAAW,cAAe3pB,SAC3B,GAAoBkB,UAAW,aAAS,GAC3C,GAAsB,GAAW,CAC7B,aAAgB,CACZrB,KAAM,OACNy+B,iBAAiB,IAErB,GAAQ,EAAG,KACX,GAAQ,EAAG,KACX,GAAQ,EAAGgsD,IACX,GAAQ,EAAG,KACX,GAAW,oBAAqB,CAACtqF,OAAQA,OAAQA,OAAQA,UAC1D,ICtDI,MAKM02C,GAAoB,CALC4zC,IAmBrB/yC,GAAmB,CAC5B,GACA,GACAs9C,GACA,GACA,IAEJ,IAAIuB,GAAuB,GACvBC,GAAqBhd,IACrBA,EAAOz1C,SAASwyD,KAKpB,MAAME,GAAsB,CAIxB/mF,SAASpC,GACEA,EAAUoC,YAAYmnC,MAAsBa,GAAkB,KAAUg/C,KAAKjM,IAASh4C,aAAa7yC,KAAK42F,IAAoB,KAAUE,KAAKjM,IAASx3C,eAAerzC,KAAK45E,GAAUA,EAAOmd,YAKpM,kBACI,OAAO1sF,KAAKyF,SAAS,IAAGrB,qBAGnBuoF,GAAsB,CAM/BC,UAAUvoF,SACSc,IAAXd,GACAioF,GAAuB,GACvBC,GAAqBhd,IACjBA,EAAOz1C,SAASwyD,MAGfjoF,aAAkBzD,SACvB2rF,GAAoBloF,EAGpBioF,GAAuBjoF,EAEpB,IAAKmoF,QAEbA,I,wBC5EP,4UCQA,IAAIK,GAAM,MACN,cACI7sF,KAAK8sF,gBAAkB,YAW/BD,GArB8C,SAAU5yF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EAiB1D,CAAW,CACb,aAAc,IACfu2F,I,wBCvBH,u1ECAA,IAAI,GAA0C,SAAU5yF,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAQ1G,IAAI+hF,GAAc,MACd,YAAYllE,GACR7nB,KAAK6nB,QAAUA,EACf7nB,KAAKgtF,YAAc,QACnBhtF,KAAKitF,gBAAkB,QACvBjtF,KAAKktF,OAAS,GACdltF,KAAKmtF,kBAAoB,GACzBntF,KAAKotF,aAAe,GACpBptF,KAAKqtF,WAAY,EAErB,yBACI,OAAOrtF,KAAK6nB,QAAQw2B,cAAc,sBAEtC,gBAAgBivC,GACZttF,KAAKutF,mBAAmB92F,OAAU62F,EAActtF,KAAKwtF,aAAaj9E,SAAY,KAAKjY,WACnF0H,KAAKitF,gBAAkBjtF,KAAKytF,eAAeH,GAE/C,eAAeE,GACPA,EAAaj9E,WACbvQ,KAAKgtF,YAAchtF,KAAKytF,eAAeD,EAAaj9E,UACpDvQ,KAAKqtF,WAAY,GAGzB,kBAAkBG,GACdxtF,KAAKstF,YAAcE,EAAaF,YAEpC,gBAAgBI,GACZ1tF,KAAKstF,YAActtF,KAAKwtF,aAAaj9E,UAAYm9E,EAAU,KAC3D1tF,KAAKwtF,aAAaF,YAActtF,KAAKwtF,aAAaj9E,UAAYm9E,EAAU,KAE5E,aACQ1tF,KAAKwtF,aAAaG,OAClB3tF,KAAKwtF,aAAaI,OAGlB5tF,KAAKwtF,aAAaK,QAG1B,gBACI7tF,KAAKstF,YAAc,EACnBttF,KAAKwtF,aAAaF,YAAc,EAEpC,cACI,MAAMA,EAActtF,KAAKwtF,aAAaF,YACtCttF,KAAKstF,YAAcA,EAActtF,KAAKmtF,kBACtCntF,KAAKwtF,aAAaF,YAAcA,EAActtF,KAAKmtF,kBAEvD,SACI,MAAMG,EAActtF,KAAKwtF,aAAaF,YACtCttF,KAAKstF,YAAcA,EAActtF,KAAKotF,aACtCptF,KAAKwtF,aAAaF,YAAcA,EAActtF,KAAKotF,aAEvD,UACIptF,KAAKstF,YAActtF,KAAKwtF,aAAaj9E,SACrCvQ,KAAKwtF,aAAaF,YAActtF,KAAKwtF,aAAaj9E,SAEtD,aAAa28E,GACTltF,KAAKwtF,aAAaN,OAASA,EAAS,IACpCltF,KAAKktF,OAASA,EAElB,eACwB,IAAhBltF,KAAKktF,QACLltF,KAAK8tF,eAAiB9tF,KAAKktF,OAC3BltF,KAAKktF,OAAS,IAGdltF,KAAKktF,OAASltF,KAAK8tF,eACnB9tF,KAAK8tF,eAAiB,GAG9B,eAAeC,GACX,IAAIC,EAAU9lE,KAAK+lE,MAAMF,EAAgB,IACrCG,EAAUhmE,KAAK+lE,MAAOF,EAAgB,IAC1C,GAAIC,GAAW,GAAI,CACf,IAAIG,EAAQjmE,KAAK+lE,MAAMD,EAAU,IAEjC,OADAA,EAAU9lE,KAAK+lE,MAAMD,EAAU,IACxB,GAAGhuF,KAAKouF,kBAAkBD,MAAUnuF,KAAKouF,kBAAkBJ,MAAYhuF,KAAKouF,kBAAkBF,KAEzG,MAAO,GAAGluF,KAAKouF,kBAAkBJ,MAAYhuF,KAAKouF,kBAAkBF,KAExE,kBAAkBG,GACd,MAAMC,EAAiBD,EAASE,QAAQ,GACxC,OAAiC,IAA1BD,EAAeh0F,OAAe,IAAIg0F,IAAmBA,IAGpE,GAAW,CACP,KACA,GAAW,cAAel2F,SAC3B20F,GAAY31F,UAAW,WAAO,GACjC21F,GAAc,GAAW,CACrB,aAAc,GACd,YAAOnzC,SACP,GAAW,oBAAqB,CAACA,WAClCmzC,I,wBC5GH,8qCCAO,MAAMyB,GACT,aAAY,MAAE1pB,EAAQ,GAAE,KAAE2pB,EAAO,GAAE,KAAEC,EAAI,SAAEn+E,EAAW,GAAE,GAAEmE,EAAE,WAAEi6E,EAAU,OAAE5vF,EAAM,OAAE6vF,IAC9E5uF,KAAK8kE,MAAQA,EACb9kE,KAAKyuF,KAAOA,EACZzuF,KAAK0uF,KAAOA,EACZ1uF,KAAKuQ,SAAWA,EAChBvQ,KAAK0U,GAAKA,EACV1U,KAAK2uF,WAAaA,EAClB3uF,KAAKjB,OAASA,EACdiB,KAAK4uF,OAASA,EAElB,aACI,OAAO5uF,KAAKyuF,KAAKt2F,IAAI02F,GAAOA,EAAIA,MCZjC,IAAIC,IACX,SAAWA,GACPA,EAAQA,EAAiB,QAAI,GAAK,UAClCA,EAAQA,EAAsB,aAAI,GAAK,eACvCA,EAAQA,EAAsB,aAAI,GAAK,eACvCA,EAAQA,EAAsB,aAAI,GAAK,eAJ3C,CAKGA,KAAYA,GAAU,KCNzB,IAMI,GAA0C,SAAUp1F,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAI1G,IAAI,GAAiB,MACjB,YAAY+jF,GACR/uF,KAAK+uF,OAASA,EAElB,eAAer6E,GAEX,MAAM+xD,QAAiBzmE,KAAK+uF,OAAO14F,IAAI,0CAA0Cqe,KAC3EzD,QAAaw1D,EAASuoB,OAC5B,OAAO,IAAIR,GAAM,CACbE,KAAM,IAAIxxF,KAAKA,KAAK4kC,MAAM7wB,EAAKg+E,QAAQ,GAAGP,OAC1Cn+E,SAAUU,EAAKg+E,QAAQ,GAAG1+E,SAC1Bk+E,KAAMx9E,EAAKg+E,QAAQ,GAAGR,KAAKt2F,IAAI+2F,GAASj+E,EAAKw9E,KAAKnmD,KAAKumD,GAAOA,EAAIn6E,KAAOw6E,IACzEpqB,MAAO7zD,EAAKg+E,QAAQ,GAAGnqB,MACvBpwD,GAAIzD,EAAKg+E,QAAQ,GAAGv6E,GACpBi6E,WAAY19E,EAAKg+E,QAAQ,GAAGN,WAC5B5vF,OAAQkS,EAAKg+E,QAAQ,GAAGlwF,OACxB6vF,OAAQ39E,EAAKk+E,QAAQ7mD,KAAKsmD,GAAUA,EAAOl6E,KAAOzD,EAAKg+E,QAAQ,GAAGG,YAG1E,iBAAiBX,GAEb,MAAMhoB,QAAiBzmE,KAAK+uF,OAAO14F,IAAI,uCAAuCo4F,EAAKt2F,IAAI02F,GAAO,QAAQA,KAAOx2F,KAAK,QAC5G4Y,QAAaw1D,EAASuoB,OAC5B,OAAO/9E,EAAKg+E,QACP92F,IAAKk3F,GAAc,IAAIb,GAAM,CAC9BE,KAAM,IAAIxxF,KAAKA,KAAK4kC,MAAMutD,EAAUX,OACpCn+E,SAAU8+E,EAAU9+E,SACpBk+E,KAAMY,EAAUZ,KAAKt2F,IAAI+2F,GAASj+E,EAAKw9E,KAAKnmD,KAAKumD,GAAOA,EAAIn6E,KAAOw6E,IACnEpqB,MAAOuqB,EAAUvqB,MACjBpwD,GAAI26E,EAAU36E,GACdi6E,WAAYU,EAAUV,WACtB5vF,OAAQswF,EAAUtwF,OAClB6vF,OAAQ39E,EAAKk+E,QAAQ7mD,KAAKsmD,GAAUA,EAAOl6E,KAAO26E,EAAUD,eAIxE,GA/C8C,SAAUn1F,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,EA2C/C,CAAW,CACxB,YAAO,GACP,GAAW,oBAAqB,CAAC,KAClC,IClDH,IAAI,GAA0C,SAAU2D,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAK1G,IAAIskF,GAAU,MACV,YAAYC,GACRvvF,KAAKuvF,eAAiBA,EACtBvvF,KAAKivF,QAAU,GACfjvF,KAAKgmB,GAAK,GAEd,YAAYylD,GACR,MAAMgjB,EAAOhjB,EAAWgjB,KAAKh+D,MAAM,KACnCzwB,KAAKivF,cAAgBjvF,KAAKuvF,eAAeC,WAAWf,GAEpD,MAAMgB,EAASzvF,KAAKivF,QACfjtC,OAAO,CAAC0tC,EAAIC,KACTD,EAAGC,EAAGF,OAAO,IACbC,EAAGC,EAAGF,OAAO,IAAI5vF,KAAK8vF,GAGtBD,EAAGC,EAAGF,OAAO,IAAM,CAACE,GAEjBD,GACR,IAEHx5F,OAAOsD,KAAKi2F,GACP5+E,QAAQ9Z,IACT04F,EAAO14F,GAAO04F,EAAO14F,GAAKirD,OAAO,CAAC0tC,EAAIC,KAClC,MAAMC,EAAcD,EAAGF,OAAO,GAuB9B,OAtBIC,EAAGC,EAAG7qB,OACN4qB,EAAGC,EAAG7qB,OAAO9R,SACRnzD,KAAK,CACNgd,QAAS8yE,EAAGF,OAAO,GACnBl/E,SAAUo/E,EAAGp/E,SACbs/E,MAAOF,IAIXD,EAAGC,EAAG7qB,OAAS,CACXpwD,GAAIi7E,EAAGj7E,GACP+6E,OAAQG,EACR9qB,MAAO6qB,EAAG7qB,MACV8pB,OAAQe,EAAGf,OACXF,KAAMiB,EAAGjB,KACT17B,SAAU,CAAC,CACHn2C,QAAS8yE,EAAGF,OAAO,GACnBl/E,SAAUo/E,EAAGp/E,SACbs/E,MAAOF,KAIhBD,GACR,IACHD,EAAO14F,GAAO,GAAG+Q,OAAO5R,OAAOsD,KAAKi2F,EAAO14F,IACtCoB,IAAI23F,GAAQL,EAAO14F,GAAK+4F,KAAQl/E,KAAK5Q,KAAK+vF,kBAEnD/vF,KAAKgmB,GAAK,GAAGle,OAAO5R,OAAOsD,KAAKi2F,GAC3Bt3F,IAAIpB,IAAO,CAAG+tE,MAAO/tE,EAAKk4F,QAASQ,EAAO14F,OAAUuwB,UAE7D,eAAe0oE,EAAIC,GACf,OAAOD,EAAGtB,KAAOuB,EAAGvB,MAAQ,EAAIuB,EAAGvB,KAAOsB,EAAGtB,KAAO,EAAI,EAE5D,cAAcmB,GAEV12C,OAAOtiB,SAASs2C,KAAO,+CAA+C0iB,EAAMn7E,OAGpF46E,GAAQ7jB,WAAa,CAAC,QACtB6jB,GAAU,GAAW,CACjB,aAAc,GACd,GAAW,oBAAqB,CAAC,MAClCA,I,wBC/EH,6mCCAA,IAAI,GAA0C,SAAUr1F,EAAYH,EAAQ/C,EAAK6T,GAC7E,IAA2H9U,EAAvHD,EAAIgV,UAAUvQ,OAAQhE,EAAIT,EAAI,EAAIiE,EAAkB,OAAT8Q,EAAgBA,EAAO1U,OAAO4U,yBAAyBhR,EAAQ/C,GAAO6T,EACrH,GAAuB,iBAAZpO,SAAoD,mBAArBA,QAAQxC,SAAyB1D,EAAIkG,QAAQxC,SAASC,EAAYH,EAAQ/C,EAAK6T,QACpH,IAAK,IAAIpV,EAAIyE,EAAWK,OAAS,EAAG9E,GAAK,EAAGA,KAASM,EAAImE,EAAWzE,MAAIc,GAAKT,EAAI,EAAIC,EAAEQ,GAAKT,EAAI,EAAIC,EAAEgE,EAAQ/C,EAAKT,GAAKR,EAAEgE,EAAQ/C,KAAST,GAChJ,OAAOT,EAAI,GAAKS,GAAKJ,OAAOC,eAAe2D,EAAQ/C,EAAKT,GAAIA,GAE5D,GAA0C,SAAUoD,EAAGsR,GACvD,GAAuB,iBAAZxO,SAAoD,mBAArBA,QAAQ7C,SAAyB,OAAO6C,QAAQ7C,SAASD,EAAGsR,IAK1G,IAAIklF,GAAe,MACf,YAAYX,GACRvvF,KAAKuvF,eAAiBA,EAE1B,MAAM9jB,GACFzrE,KAAKuvF,eACAY,SAAS1kB,EAAW/2D,IACpB+jB,KAAKo3D,GAAS7vF,KAAK6vF,MAAQA,KAGxCK,GAAazkB,WAAa,CAAC,MAC3BykB,GAAe,GAAW,CACtB,aAAc,GACd,GAAW,oBAAqB,CAAC,MAClCA,ICtBH,IAAQzqF,SAAS,IAA6B,cAAc,EAAYknF,GAAoBC,aACvF7oB,IAAI8oB,IACJ/kE","file":"main.d6a9a1bf4b2982b6b59f.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 21);\n","/**\n * Determine whether a value is an object.\n *\n * Uses `typeof` to guarantee this works cross-realm, which is where `instanceof Object` might fail.\n *\n * Some environments where these issues are known to arise:\n * - same-origin iframes (accessing the other realm via `window.top`)\n * - `jest`.\n *\n * The exact test is:\n * ```ts\n * typeof value === 'object' && value !== null || typeof value === 'function'\n * ```\n *\n * @param value - The value to test.\n * @returns `true` if the value is an object, otherwise `false`.\n * Also performs a type assertion that defaults to `value is Object | Function` which, if the input type is a union with an object type, will infer the correct type.\n * This can be overridden with the generic type argument.\n *\n * @example\n *\n * ```ts\n * class Foo {\n *   bar = 42;\n * }\n *\n * function doStuff(input?: Foo | null) {\n *   input.bar; // Object is possibly 'null' or 'undefined'\n *\n *   // input has an object type in its union (Foo) so that type will be extracted for the 'true' condition\n *   if (isObject(input)) {\n *     input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n *\n * function doOtherStuff(input: unknown) {\n *   input.bar; // Object is of type 'unknown'\n *\n *   // input is 'unknown' so there is no union type to match and it will default to 'Object | Function'\n *   if (isObject(input)) {\n *     input.bar; // Property 'bar' does not exist on type 'Object | Function'\n *   }\n *\n *   // if we know for sure that, if input is an object, it must be a specific type, we can explicitly tell the function to assert that for us\n *   if (isObject<Foo>(input)) {\n *    input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n * ```\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isObject(value) {\n    return typeof value === 'object' && value !== null || typeof value === 'function';\n}\n/**\n * Determine whether a value is `null` or `undefined`.\n *\n * @param value - The value to test.\n * @returns `true` if the value is `null` or `undefined`, otherwise `false`.\n * Also performs a type assertion that ensures TypeScript treats the value appropriately in the `if` and `else` branches after this check.\n */\nexport function isNullOrUndefined(value) {\n    return value === null || value === void 0;\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nconst metadataInternalSlot = new WeakMap();\nfunction $typeError(operation, args, paramName, actualValue, expectedType) {\n    return new TypeError(`${operation}(${args.map(String).join(',')}) - Expected '${paramName}' to be of type ${expectedType}, but got: ${Object.prototype.toString.call(actualValue)} (${String(actualValue)})`);\n}\nfunction toPropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction toPropertyKey(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction ensurePropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            throw new TypeError(`Invalid metadata propertyKey: ${propertyKey}.`);\n    }\n}\nfunction GetOrCreateMetadataMap(O, P, Create) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let targetMetadata be the value of O's [[Metadata]] internal slot.\n    let targetMetadata = metadataInternalSlot.get(O);\n    // 3. If targetMetadata is undefined, then\n    if (targetMetadata === void 0) {\n        // 3. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 3. b. Set targetMetadata to be a newly created Map object.\n        targetMetadata = new Map();\n        // 3. c. Set the [[Metadata]] internal slot of O to targetMetadata.\n        metadataInternalSlot.set(O, targetMetadata);\n    }\n    // 4. Let metadataMap be ? Invoke(targetMetadata, \"get\", P).\n    let metadataMap = targetMetadata.get(P);\n    // 5. If metadataMap is undefined, then\n    if (metadataMap === void 0) {\n        // 5. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 5. b. Set metadataMap to be a newly created Map object.\n        metadataMap = new Map();\n        // 5. c. Perform ? Invoke(targetMetadata, \"set\", P, metadataMap).\n        targetMetadata.set(P, metadataMap);\n    }\n    // 6. Return metadataMap.\n    return metadataMap;\n}\n// 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\nfunction OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? ToBoolean(? Invoke(metadataMap, \"has\", MetadataKey)).\n    return metadataMap.has(MetadataKey);\n}\n// 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\nfunction OrdinaryHasMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return true.\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return true;\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, Return ? parent.[[HasMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryHasMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return false.\n    return false;\n}\n// 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\nfunction OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return undefined.\n    if (metadataMap === void 0) {\n        return void 0;\n    }\n    // 4. Return ? Invoke(metadataMap, \"get\", MetadataKey).\n    return metadataMap.get(MetadataKey);\n}\n// 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\nfunction OrdinaryGetMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return ? OrdinaryGetOwnMetadata(MetadataKey, O, P).\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, return ? parent.[[GetMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryGetMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return undefined.\n    return void 0;\n}\n// 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\nfunction OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, true).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ true);\n    // 3. Return ? Invoke(metadataMap, \"set\", MetadataKey, MetadataValue).\n    metadataMap.set(MetadataKey, MetadataValue);\n}\n// 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\nfunction OrdinaryOwnMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 3. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 4. If metadataMap is undefined, return keys.\n    if (metadataMap === void 0) {\n        return keys;\n    }\n    // 5. Let keysObj be ? Invoke(metadataMap, \"keys\").\n    const keysObj = metadataMap.keys();\n    // 6. Let iterator be ? GetIterator(keysObj).\n    // 7. Let k be 0.\n    let k = 0;\n    // 8. Repeat\n    for (const key of keysObj) {\n        // 8. a. Let Pk be ! ToString(k).\n        // 8. b. Let next be ? IteratorStep(iterator).\n        // 8. c. If next is false, then\n        // 8. c. i. Let setStatus be ? Set(keys, \"length\", k, true).\n        // 8. c. ii. Assert: setStatus is true.\n        // 8. c. iii. Return keys.\n        // 8. d. Let nextValue be ? IteratorValue(next).\n        // 8. e. Let defineStatus be CreateDataPropertyOrThrow(keys, Pk, nextValue).\n        keys[k] = key;\n        // 8. f. If defineStatus is an abrupt completion, return ? IteratorClose(iterator, defineStatus).\n        // 8. g. Increase k by 1.\n        ++k;\n    }\n    return keys;\n}\n// 3.1.6.1 OrdinaryMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\nfunction OrdinaryMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let ownKeys be ? OrdinaryOwnMetadataKeys(O, P).\n    const ownKeys = OrdinaryOwnMetadataKeys(O, P);\n    // 3. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 4. If parent is null, then return ownKeys.\n    if (parent === null) {\n        return ownKeys;\n    }\n    // 5. Let parentKeys be ? O.[[OrdinaryMetadataKeys]](P).\n    const parentKeys = OrdinaryMetadataKeys(parent, P);\n    // 6. Let ownKeysLen = ? Get(ownKeys, \"length\").\n    const ownKeysLen = ownKeys.length;\n    // 7. If ownKeysLen is 0, return parentKeys.\n    if (ownKeysLen === 0) {\n        return parentKeys;\n    }\n    // 8. Let parentKeysLen = ? Get(parentKeys, \"length\").\n    const parentKeysLen = parentKeys.length;\n    // 9. If parentKeysLen is 0, return ownKeys.\n    if (parentKeysLen === 0) {\n        return ownKeys;\n    }\n    // 10. Let set be a newly created Set object.\n    const set = new Set();\n    // 11. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 12. Let k be 0.\n    let k = 0;\n    // 13. For each element key of ownKeys\n    let key;\n    for (let i = 0; i < ownKeysLen; ++i) {\n        key = ownKeys[i];\n        // 13. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 13. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 13. b. i. Let Pk be ! ToString(k).\n            // 13. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 13. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 13. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 13. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 14. For each element key of parentKeys\n    for (let i = 0; i < parentKeysLen; ++i) {\n        key = parentKeys[i];\n        // 14. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 14. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 14. b. i. Let Pk be ! ToString(k).\n            // 14. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 14. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 14. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 14. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 15. Perform ? Set(keys, \"length\", k).\n    // 16. return keys.\n    return keys;\n}\n// 3.1.8 DeleteMetadata(MetadataKey, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots-deletemetadata\nfunction OrdinaryDeleteMetadata(O, MetadataKey, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? Invoke(metadataMap, \"delete\", MetadataKey).\n    return metadataMap.delete(MetadataKey);\n}\n// 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n// https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n/**\n * A default metadata decorator factory that can be used on a class, class member, or parameter.\n *\n * @param metadataKey - The key for the metadata entry.\n * If `metadataKey` is already defined for the target and target key, the\n * metadataValue for that key will be overwritten.\n * @param metadataValue - The value for the metadata entry.\n * @returns A decorator function.\n */\nexport function metadata(metadataKey, metadataValue) {\n    function decorator(target, propertyKey) {\n        // 1. Assert: F has a [[MetadataKey]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 2. Assert: F has a [[MetadataValue]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 3. If Type(target) is not Object, throw a TypeError exception.\n        if (!isObject(target)) {\n            throw $typeError('@metadata', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n        }\n        // 4. If key is not undefined and IsPropertyKey(key) is false, throw a TypeError exception.\n        // 5. Let metadataKey be the value of F's [[MetadataKey]] internal slot.\n        // 6. Let metadataValue be the value of F's [[MetadataValue]] internal slot.\n        // 7. Perform ? target.[[DefineMetadata]](metadataKey, metadataValue, target, key).\n        OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, ensurePropertyKeyOrUndefined(propertyKey));\n        // 8. Return undefined.\n    }\n    return decorator;\n}\nfunction decorate(decorators, target, propertyKey, attributes) {\n    if (propertyKey !== void 0) {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (!isObject(target)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Object or Function');\n        }\n        if (!isObject(attributes) && !isNullOrUndefined(attributes)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'attributes', attributes, 'Object, Function, null, or undefined');\n        }\n        if (attributes === null) {\n            attributes = void 0;\n        }\n        propertyKey = toPropertyKey(propertyKey);\n        return DecorateProperty(decorators, target, propertyKey, attributes);\n    }\n    else {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (typeof target !== 'function') {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Function');\n        }\n        return DecorateConstructor(decorators, target);\n    }\n}\nfunction DecorateConstructor(decorators, target) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target);\n        if (!isNullOrUndefined(decorated)) {\n            if (typeof decorated !== 'function') {\n                throw $typeError('DecorateConstructor', [decorators, target], 'decorated', decorated, 'Function, null, or undefined');\n            }\n            target = decorated;\n        }\n    }\n    return target;\n}\nfunction DecorateProperty(decorators, target, propertyKey, descriptor) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target, propertyKey, descriptor);\n        if (!isNullOrUndefined(decorated)) {\n            if (!isObject(decorated)) {\n                throw $typeError('DecorateProperty', [decorators, target, propertyKey, descriptor], 'decorated', decorated, 'Object, Function, null, or undefined');\n            }\n            descriptor = decorated;\n        }\n    }\n    return descriptor;\n}\nfunction $define(metadataKey, metadataValue, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.define', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DefineMetadata]](metadataKey, metadataValue, propertyKey).\n    return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $has(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.has', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasMetadata]](metadataKey, propertyKey).\n    return OrdinaryHasMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $hasOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.hasOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasOwn]](metadataKey, propertyKey).\n    return OrdinaryHasOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $get(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.get', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadataKeys]](propertyKey).\n    return OrdinaryMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwnKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwnKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadataKeys]](propertyKey).\n    return OrdinaryOwnMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $delete(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.delete', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DeleteMetadata]](metadataKey, propertyKey).\n    return OrdinaryDeleteMetadata(target, metadataKey, toPropertyKeyOrUndefined(propertyKey));\n}\nexport const Metadata = {\n    define: $define,\n    has: $has,\n    hasOwn: $hasOwn,\n    get: $get,\n    getOwn: $getOwn,\n    getKeys: $getKeys,\n    getOwnKeys: $getOwnKeys,\n    delete: $delete,\n};\nfunction def(obj, key, value) {\n    Reflect.defineProperty(obj, key, {\n        writable: true,\n        enumerable: false,\n        configurable: true,\n        value,\n    });\n}\nconst internalSlotName = '[[$au]]';\nfunction hasInternalSlot(reflect) {\n    return internalSlotName in reflect;\n}\nexport function applyMetadataPolyfill(reflect) {\n    if (hasInternalSlot(reflect)) {\n        if (reflect[internalSlotName] === metadataInternalSlot) {\n            return;\n        }\n        throw new Error(`Conflicting @aurelia/metadata module import detected. Please make sure you have the same version of all Aurelia packages in your dependency tree.`);\n    }\n    if ('metadata' in reflect ||\n        'decorate' in reflect ||\n        'defineMetadata' in reflect ||\n        'hasMetadata' in reflect ||\n        'hasOwnMetadata' in reflect ||\n        'getMetadata' in reflect ||\n        'getOwnMetadata' in reflect ||\n        'getMetadataKeys' in reflect ||\n        'getOwnMetadataKeys' in reflect ||\n        'deleteMetadata' in reflect) {\n        throw new Error(`Conflicting reflect.metadata polyfill found. If you have 'reflect-metadata' or any other reflect polyfill imported, please remove it, if not (or if you must use a specific polyfill) please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario.`);\n    }\n    def(Metadata, '$Internal', metadataInternalSlot);\n    def(reflect, 'metadata', metadata);\n    def(reflect, 'decorate', decorate);\n    def(reflect, 'defineMetadata', $define);\n    def(reflect, 'hasMetadata', $has);\n    def(reflect, 'hasOwnMetadata', $hasOwn);\n    def(reflect, 'getMetadata', $get);\n    def(reflect, 'getOwnMetadata', $getOwn);\n    def(reflect, 'getMetadataKeys', $getKeys);\n    def(reflect, 'getOwnMetadataKeys', $getOwnKeys);\n    def(reflect, 'deleteMetadata', $delete);\n}\n//# sourceMappingURL=index.js.map","import { PLATFORM } from './platform';\nconst isNumericLookup = {};\n/**\n * Efficiently determine whether the provided property key is numeric\n * (and thus could be an array indexer) or not.\n *\n * Always returns true for values of type `'number'`.\n *\n * Otherwise, only returns true for strings that consist only of positive integers.\n *\n * Results are cached.\n */\nexport function isArrayIndex(value) {\n    switch (typeof value) {\n        case 'number':\n            return value >= 0 && (value | 0) === value;\n        case 'string': {\n            const result = isNumericLookup[value];\n            if (result !== void 0) {\n                return result;\n            }\n            const length = value.length;\n            if (length === 0) {\n                return isNumericLookup[value] = false;\n            }\n            let ch = 0;\n            for (let i = 0; i < length; ++i) {\n                ch = value.charCodeAt(i);\n                if (i === 0 && ch === 0x30 && length > 1 /* must not start with 0 */ || ch < 0x30 /* 0 */ || ch > 0x39 /* 9 */) {\n                    return isNumericLookup[value] = false;\n                }\n            }\n            return isNumericLookup[value] = true;\n        }\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isNumberOrBigInt(value) {\n    switch (typeof value) {\n        case 'number':\n        case 'bigint':\n            return true;\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isStringOrDate(value) {\n    switch (typeof value) {\n        case 'string':\n            return true;\n        case 'object':\n            return value instanceof Date;\n        default:\n            return false;\n    }\n}\n/**\n * Base implementation of camel and kebab cases\n */\nconst baseCase = (function () {\n    let CharKind;\n    (function (CharKind) {\n        CharKind[CharKind[\"none\"] = 0] = \"none\";\n        CharKind[CharKind[\"digit\"] = 1] = \"digit\";\n        CharKind[CharKind[\"upper\"] = 2] = \"upper\";\n        CharKind[CharKind[\"lower\"] = 3] = \"lower\";\n    })(CharKind || (CharKind = {}));\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const isDigit = Object.assign(Object.create(null), {\n        '0': true,\n        '1': true,\n        '2': true,\n        '3': true,\n        '4': true,\n        '5': true,\n        '6': true,\n        '7': true,\n        '8': true,\n        '9': true,\n    });\n    function charToKind(char) {\n        if (char === '') {\n            // We get this if we do charAt() with an index out of range\n            return 0 /* none */;\n        }\n        if (char !== char.toUpperCase()) {\n            return 3 /* lower */;\n        }\n        if (char !== char.toLowerCase()) {\n            return 2 /* upper */;\n        }\n        if (isDigit[char] === true) {\n            return 1 /* digit */;\n        }\n        return 0 /* none */;\n    }\n    return function (input, cb) {\n        const len = input.length;\n        if (len === 0) {\n            return input;\n        }\n        let sep = false;\n        let output = '';\n        let prevKind;\n        let curChar = '';\n        let curKind = 0 /* none */;\n        let nextChar = input.charAt(0);\n        let nextKind = charToKind(nextChar);\n        for (let i = 0; i < len; ++i) {\n            prevKind = curKind;\n            curChar = nextChar;\n            curKind = nextKind;\n            nextChar = input.charAt(i + 1);\n            nextKind = charToKind(nextChar);\n            if (curKind === 0 /* none */) {\n                if (output.length > 0) {\n                    // Only set sep to true if it's not at the beginning of output.\n                    sep = true;\n                }\n            }\n            else {\n                if (!sep && output.length > 0 && curKind === 2 /* upper */) {\n                    // Separate UAFoo into UA Foo.\n                    // Separate uaFOO into ua FOO.\n                    sep = prevKind === 3 /* lower */ || nextKind === 3 /* lower */;\n                }\n                output += cb(curChar, sep);\n                sep = false;\n            }\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to camelCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert DOM attribute names to ViewModel property names.\n *\n * Results are cached.\n */\nexport const camelCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? char.toUpperCase() : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to PascalCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert element names to class names for synthetic types.\n *\n * Results are cached.\n */\nexport const pascalCase = (function () {\n    const cache = Object.create(null);\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = camelCase(input);\n            if (output.length > 0) {\n                output = output[0].toUpperCase() + output.slice(1);\n            }\n            cache[input] = output;\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to kebab-case.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert ViewModel property names to DOM attribute names.\n *\n * Results are cached.\n */\nexport const kebabCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? `-${char.toLowerCase()}` : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently (up to 10x faster than `Array.from`) convert an `ArrayLike` to a real array.\n *\n * Primarily used by Aurelia to convert DOM node lists to arrays.\n */\nexport function toArray(input) {\n    // benchmark: http://jsben.ch/xjsyF\n    const { length } = input;\n    const arr = Array(length);\n    for (let i = 0; i < length; ++i) {\n        arr[i] = input[i];\n    }\n    return arr;\n}\nconst ids = {};\n/**\n * Retrieve the next ID in a sequence for a given string, starting with `1`.\n *\n * Used by Aurelia to assign unique ID's to controllers and resources.\n *\n * Aurelia will always prepend the context name with `au$`, so as long as you avoid\n * using that convention you should be safe from collisions.\n */\nexport function nextId(context) {\n    if (ids[context] === void 0) {\n        ids[context] = 0;\n    }\n    return ++ids[context];\n}\n/**\n * Reset the ID for the given string, so that `nextId` will return `1` again for the next call.\n *\n * Used by Aurelia to reset ID's in between unit tests.\n */\nexport function resetId(context) {\n    ids[context] = 0;\n}\n/**\n * A compare function to pass to `Array.prototype.sort` for sorting numbers.\n * This is needed for numeric sort, since the default sorts them as strings.\n */\nexport function compareNumber(a, b) {\n    return a - b;\n}\nconst emptyArray = PLATFORM.emptyArray;\n/**\n * Efficiently merge and deduplicate the (primitive) values in two arrays.\n *\n * Does not deduplicate existing values in the first array.\n *\n * Guards against null or undefined arrays.\n *\n * Returns `PLATFORM.emptyArray` if both arrays are either `null`, `undefined` or `PLATFORM.emptyArray`\n *\n * @param slice - If `true`, always returns a new array copy (unless neither array is/has a value)\n */\nexport function mergeDistinct(arr1, arr2, slice) {\n    if (arr1 === void 0 || arr1 === null || arr1 === emptyArray) {\n        if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n            return emptyArray;\n        }\n        else {\n            return slice ? arr2.slice(0) : arr2;\n        }\n    }\n    else if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n        return slice ? arr1.slice(0) : arr1;\n    }\n    const lookup = {};\n    const arr3 = slice ? arr1.slice(0) : arr1;\n    let len1 = arr1.length;\n    let len2 = arr2.length;\n    while (len1-- > 0) {\n        lookup[arr1[len1]] = true;\n    }\n    let item;\n    while (len2-- > 0) {\n        item = arr2[len2];\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (lookup[item] === void 0) {\n            arr3.push(item);\n            lookup[item] = true;\n        }\n    }\n    return arr3;\n}\n/**\n * Decorator. (lazily) bind the method to the class instance on first call.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bound(target, key, descriptor) {\n    return {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get() {\n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            const boundFn = descriptor.value.bind(this);\n            Reflect.defineProperty(this, key, {\n                value: boundFn,\n                writable: true,\n                configurable: true,\n                enumerable: descriptor.enumerable,\n            });\n            return boundFn;\n        },\n    };\n}\nexport function mergeArrays(...arrays) {\n    const result = [];\n    let k = 0;\n    const arraysLen = arrays.length;\n    let arrayLen = 0;\n    let array;\n    for (let i = 0; i < arraysLen; ++i) {\n        array = arrays[i];\n        if (array !== void 0) {\n            arrayLen = array.length;\n            for (let j = 0; j < arrayLen; ++j) {\n                result[k++] = array[j];\n            }\n        }\n    }\n    return result;\n}\nexport function mergeObjects(...objects) {\n    const result = {};\n    const objectsLen = objects.length;\n    let object;\n    let key;\n    for (let i = 0; i < objectsLen; ++i) {\n        object = objects[i];\n        if (object !== void 0) {\n            for (key in object) {\n                result[key] = object[key];\n            }\n        }\n    }\n    return result;\n}\nexport function firstDefined(...values) {\n    const len = values.length;\n    let value;\n    for (let i = 0; i < len; ++i) {\n        value = values[i];\n        if (value !== void 0) {\n            return value;\n        }\n    }\n    throw new Error(`No default value found`);\n}\nexport const getPrototypeChain = (function () {\n    const functionPrototype = Function.prototype;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const getPrototypeOf = Object.getPrototypeOf;\n    const cache = new WeakMap();\n    let proto = functionPrototype;\n    let i = 0;\n    let chain = void 0;\n    return function (Type) {\n        chain = cache.get(Type);\n        if (chain === void 0) {\n            cache.set(Type, chain = [proto = Type]);\n            i = 0;\n            while ((proto = getPrototypeOf(proto)) !== functionPrototype) {\n                chain[++i] = proto;\n            }\n        }\n        return chain;\n    };\n})();\nexport function toLookup(...objs) {\n    return Object.assign(Object.create(null), ...objs);\n}\n/**\n * Determine whether the value is a native function.\n *\n * @param fn - The function to check.\n * @returns `true` is the function is a native function, otherwise `false`\n */\nexport const isNativeFunction = (function () {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    const lookup = new WeakMap();\n    let isNative = false;\n    let sourceText = '';\n    let i = 0;\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (fn) {\n        isNative = lookup.get(fn);\n        if (isNative === void 0) {\n            sourceText = fn.toString();\n            i = sourceText.length;\n            // http://www.ecma-international.org/ecma-262/#prod-NativeFunction\n            isNative = (\n            // 29 is the length of 'function () { [native code] }' which is the smallest length of a native function string\n            i >= 29 &&\n                // 100 seems to be a safe upper bound of the max length of a native function. In Chrome and FF it's 56, in Edge it's 61.\n                i <= 100 &&\n                // This whole heuristic *could* be tricked by a comment. Do we need to care about that?\n                sourceText.charCodeAt(i - 1) === 0x7D && // }\n                // TODO: the spec is a little vague about the precise constraints, so we do need to test this across various browsers to make sure just one whitespace is a safe assumption.\n                sourceText.charCodeAt(i - 2) <= 0x20 && // whitespace\n                sourceText.charCodeAt(i - 3) === 0x5D && // ]\n                sourceText.charCodeAt(i - 4) === 0x65 && // e\n                sourceText.charCodeAt(i - 5) === 0x64 && // d\n                sourceText.charCodeAt(i - 6) === 0x6F && // o\n                sourceText.charCodeAt(i - 7) === 0x63 && // c\n                sourceText.charCodeAt(i - 8) === 0x20 && //\n                sourceText.charCodeAt(i - 9) === 0x65 && // e\n                sourceText.charCodeAt(i - 10) === 0x76 && // v\n                sourceText.charCodeAt(i - 11) === 0x69 && // i\n                sourceText.charCodeAt(i - 12) === 0x74 && // t\n                sourceText.charCodeAt(i - 13) === 0x61 && // a\n                sourceText.charCodeAt(i - 14) === 0x6E && // n\n                sourceText.charCodeAt(i - 15) === 0x58 // [\n            );\n            lookup.set(fn, isNative);\n        }\n        return isNative;\n    };\n})();\n//# sourceMappingURL=functions.js.map","export var LogLevel;\n(function (LogLevel) {\n    /**\n     * The most detailed information about internal app state.\n     *\n     * Disabled by default and should never be enabled in a production environment.\n     */\n    LogLevel[LogLevel[\"trace\"] = 0] = \"trace\";\n    /**\n     * Information that is useful for debugging during development and has no long-term value.\n     */\n    LogLevel[LogLevel[\"debug\"] = 1] = \"debug\";\n    /**\n     * Information about the general flow of the application that has long-term value.\n     */\n    LogLevel[LogLevel[\"info\"] = 2] = \"info\";\n    /**\n     * Unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n     */\n    LogLevel[LogLevel[\"warn\"] = 3] = \"warn\";\n    /**\n     * Unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n     */\n    LogLevel[LogLevel[\"error\"] = 4] = \"error\";\n    /**\n     * Unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n     */\n    LogLevel[LogLevel[\"fatal\"] = 5] = \"fatal\";\n    /**\n     * No messages should be written.\n     */\n    LogLevel[LogLevel[\"none\"] = 6] = \"none\";\n})(LogLevel || (LogLevel = {}));\nexport const Reporter = {\n    level: 3 /* warn */,\n    write(code, ...params) { return; },\n    error(code, ...params) { return new Error(`Code ${code}`); }\n};\nexport const Tracer = {\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) { return; },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() { return; },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) { return; },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) { return; },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() { return; }\n};\nfunction enableLiveLogging(optionsOrWriter) { return; }\n//# sourceMappingURL=reporter.js.map","import { Metadata } from '@aurelia/metadata';\nimport { PLATFORM } from './platform';\nconst annotation = {\n    name: 'au:annotation',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    set(target, prop, value) {\n        Metadata.define(annotation.keyFor(prop), value, target);\n    },\n    get(target, prop) {\n        return Metadata.getOwn(annotation.keyFor(prop), target);\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(annotation.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${annotation.name}:${name}`;\n        }\n        return `${annotation.name}:${name}:${context}`;\n    },\n};\nconst resource = {\n    name: 'au:resource',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    has(target) {\n        return Metadata.hasOwn(resource.name, target);\n    },\n    getAll(target) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            return PLATFORM.emptyArray;\n        }\n        else {\n            return keys.map(k => Metadata.getOwn(k, target));\n        }\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(resource.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${resource.name}:${name}`;\n        }\n        return `${resource.name}:${name}:${context}`;\n    },\n};\nexport const Protocol = {\n    annotation,\n    resource,\n};\n// eslint-disable-next-line @typescript-eslint/unbound-method\nconst hasOwn = Object.prototype.hasOwnProperty;\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override the definition as well as static properties on the type.\n * 2. Definition properties (usually set by the customElement decorator object literal) come next. They override static properties on the type.\n * 3. Static properties on the type come last. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 4. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrDefinitionOrTypeOrDefault(name, def, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = def[name];\n        if (value === void 0) {\n            value = Type[name];\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n            if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n                return getDefault();\n            }\n            return value;\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override static properties on the type.\n * 2. Static properties on the typ. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 3. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrTypeOrDefault(name, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = Type[name];\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n            return getDefault();\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Definition properties.\n * 2. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromDefinitionOrDefault(name, def, getDefault) {\n    const value = def[name];\n    if (value === void 0) {\n        return getDefault();\n    }\n    return value;\n}\n//# sourceMappingURL=resource.js.map","import { Metadata, isObject, applyMetadataPolyfill } from '@aurelia/metadata';\napplyMetadataPolyfill(Reflect);\nimport { isArrayIndex, isNativeFunction } from './functions';\nimport { PLATFORM } from './platform';\nimport { Reporter } from './reporter';\nimport { Protocol } from './resource';\nexport class ResolverBuilder {\n    constructor(container, key) {\n        this.container = container;\n        this.key = key;\n    }\n    instance(value) {\n        return this.registerResolver(0 /* instance */, value);\n    }\n    singleton(value) {\n        return this.registerResolver(1 /* singleton */, value);\n    }\n    transient(value) {\n        return this.registerResolver(2 /* transient */, value);\n    }\n    callback(value) {\n        return this.registerResolver(3 /* callback */, value);\n    }\n    cachedCallback(value) {\n        return this.registerResolver(3 /* callback */, cacheCallbackResult(value));\n    }\n    aliasTo(destinationKey) {\n        return this.registerResolver(5 /* alias */, destinationKey);\n    }\n    registerResolver(strategy, state) {\n        const { container, key } = this;\n        this.container = this.key = (void 0);\n        return container.registerResolver(key, new Resolver(key, strategy, state));\n    }\n}\nfunction cloneArrayWithPossibleProps(source) {\n    const clone = source.slice();\n    const keys = Object.keys(source);\n    const len = keys.length;\n    let key;\n    for (let i = 0; i < len; ++i) {\n        key = keys[i];\n        if (!isArrayIndex(key)) {\n            clone[key] = source[key];\n        }\n    }\n    return clone;\n}\nexport const DefaultResolver = {\n    none(key) { throw Error(`${key.toString()} not registered, did you forget to add @singleton()?`); },\n    singleton(key) { return new Resolver(key, 1 /* singleton */, key); },\n    transient(key) { return new Resolver(key, 2 /* transient */, key); },\n};\nexport const DefaultContainerConfiguration = {\n    jitRegisterInRoot: true,\n    defaultResolver: DefaultResolver.singleton,\n};\nexport const DI = {\n    createContainer(config = DefaultContainerConfiguration) {\n        return new Container(null, config);\n    },\n    getDesignParamtypes(Type) {\n        return Metadata.getOwn('design:paramtypes', Type);\n    },\n    getAnnotationParamtypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        return Metadata.getOwn(key, Type);\n    },\n    getOrCreateAnnotationParamTypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        let annotationParamtypes = Metadata.getOwn(key, Type);\n        if (annotationParamtypes === void 0) {\n            Metadata.define(key, annotationParamtypes = [], Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return annotationParamtypes;\n    },\n    getDependencies(Type) {\n        // Note: Every detail of this getDependencies method is pretty deliberate at the moment, and probably not yet 100% tested from every possible angle,\n        // so be careful with making changes here as it can have a huge impact on complex end user apps.\n        // Preferably, only make changes to the dependency resolution process via a RFC.\n        const key = Protocol.annotation.keyFor('di:dependencies');\n        let dependencies = Metadata.getOwn(key, Type);\n        if (dependencies === void 0) {\n            // Type.length is the number of constructor parameters. If this is 0, it could mean the class has an empty constructor\n            // but it could also mean the class has no constructor at all (in which case it inherits the constructor from the prototype).\n            // Non-zero constructor length + no paramtypes means emitDecoratorMetadata is off, or the class has no decorator.\n            // We're not doing anything with the above right now, but it's good to keep in mind for any future issues.\n            const inject = Type.inject;\n            if (inject === void 0) {\n                // design:paramtypes is set by tsc when emitDecoratorMetadata is enabled.\n                const designParamtypes = DI.getDesignParamtypes(Type);\n                // au:annotation:di:paramtypes is set by the parameter decorator from DI.createInterface or by @inject\n                const annotationParamtypes = DI.getAnnotationParamtypes(Type);\n                if (designParamtypes === void 0) {\n                    if (annotationParamtypes === void 0) {\n                        // Only go up the prototype if neither static inject nor any of the paramtypes is defined, as\n                        // there is no sound way to merge a type's deps with its prototype's deps\n                        const Proto = Object.getPrototypeOf(Type);\n                        if (typeof Proto === 'function' && Proto !== Function.prototype) {\n                            dependencies = cloneArrayWithPossibleProps(DI.getDependencies(Proto));\n                        }\n                        else {\n                            dependencies = [];\n                        }\n                    }\n                    else {\n                        // No design:paramtypes so just use the au:annotation:di:paramtypes\n                        dependencies = cloneArrayWithPossibleProps(annotationParamtypes);\n                    }\n                }\n                else if (annotationParamtypes === void 0) {\n                    // No au:annotation:di:paramtypes so just use the design:paramtypes\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                }\n                else {\n                    // We've got both, so merge them (in case of conflict on same index, au:annotation:di:paramtypes take precedence)\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                    let len = annotationParamtypes.length;\n                    let auAnnotationParamtype;\n                    for (let i = 0; i < len; ++i) {\n                        auAnnotationParamtype = annotationParamtypes[i];\n                        if (auAnnotationParamtype !== void 0) {\n                            dependencies[i] = auAnnotationParamtype;\n                        }\n                    }\n                    const keys = Object.keys(annotationParamtypes);\n                    len = keys.length;\n                    let key;\n                    for (let i = 0; i < len; ++i) {\n                        key = keys[i];\n                        if (!isArrayIndex(key)) {\n                            dependencies[key] = annotationParamtypes[key];\n                        }\n                    }\n                }\n            }\n            else {\n                // Ignore paramtypes if we have static inject\n                dependencies = cloneArrayWithPossibleProps(inject);\n            }\n            Metadata.define(key, dependencies, Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return dependencies;\n    },\n    /**\n     * creates a decorator that also matches an interface and can be used as a {@linkcode Key}.\n     * ```ts\n     * const ILogger = DI.createInterface<Logger>('Logger').noDefault();\n     * container.register(Registration.singleton(ILogger, getSomeLogger()));\n     * const log = container.get(ILogger);\n     * log.info('hello world');\n     * class Foo {\n     *   constructor( @ILogger log: ILogger ) {\n     *     log.info('hello world');\n     *   }\n     * }\n     * ```\n     * you can also build default registrations into your interface.\n     * ```ts\n     * export const ILogger = DI.createInterface<Logger>('Logger')\n     *        .withDefault( builder => builder.cachedCallback(LoggerDefault));\n     * const log = container.get(ILogger);\n     * log.info('hello world');\n     * class Foo {\n     *   constructor( @ILogger log: ILogger ) {\n     *     log.info('hello world');\n     *   }\n     * }\n     * ```\n     * but these default registrations won't work the same with other decorators that take keys, for example\n     * ```ts\n     * export const MyStr = DI.createInterface<string>('MyStr')\n     *        .withDefault( builder => builder.instance('somestring'));\n     * class Foo {\n     *   constructor( @optional(MyStr) public readonly str: string ) {\n     *   }\n     * }\n     * container.get(Foo).str; // returns undefined\n     * ```\n     * to fix this add this line somewhere before you do a `get`\n     * ```ts\n     * container.register(MyStr);\n     * container.get(Foo).str; // returns 'somestring'\n     * ```\n     *\n     * - @param friendlyName used to improve error messaging\n     */\n    createInterface(friendlyName) {\n        const Interface = function (target, property, index) {\n            if (target == null || new.target !== undefined) {\n                throw new Error(`No registration for interface: '${Interface.friendlyName}'`); // TODO: add error (trying to resolve an InterfaceSymbol that has no registrations)\n            }\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = Interface;\n            return target;\n        };\n        Interface.$isInterface = true;\n        Interface.friendlyName = friendlyName == null ? 'Interface' : friendlyName;\n        Interface.noDefault = function () {\n            return Interface;\n        };\n        Interface.withDefault = function (configure) {\n            Interface.withDefault = function () {\n                throw Reporter.error(17, Interface);\n            };\n            Interface.register = function (container, key) {\n                return configure(new ResolverBuilder(container, key !== null && key !== void 0 ? key : Interface));\n            };\n            return Interface;\n        };\n        return Interface;\n    },\n    inject(...dependencies) {\n        return function (target, key, descriptor) {\n            if (typeof descriptor === 'number') { // It's a parameter decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[descriptor] = dep;\n                }\n            }\n            else if (key) { // It's a property decorator. Not supported by the container without plugins.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target.constructor);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[key] = dep;\n                }\n            }\n            else if (descriptor) { // It's a function decorator (not a Class constructor)\n                const fn = descriptor.value;\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(fn);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n            else { // It's a class decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n        };\n    },\n    /**\n     * Registers the `target` class as a transient dependency; each time the dependency is resolved\n     * a new instance will be created.\n     *\n     * @param target - The class / constructor function to register as transient.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     *\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.transient(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.transient(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    transient(target) {\n        target.register = function register(container) {\n            const registration = Registration.transient(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    },\n    /**\n     * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n     * consecutive time the dependency is resolved, the same instance will be returned.\n     *\n     * @param target - The class / constructor function to register as a singleton.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.singleton(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.singleton(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    singleton(target) {\n        target.register = function register(container) {\n            const registration = Registration.singleton(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    },\n};\nexport const IContainer = DI.createInterface('IContainer').noDefault();\nexport const IServiceLocator = IContainer;\nfunction createResolver(getter) {\n    return function (key) {\n        const resolver = function (target, property, descriptor) {\n            DI.inject(resolver)(target, property, descriptor);\n        };\n        resolver.$isResolver = true;\n        resolver.resolve = function (handler, requestor) {\n            return getter(key, handler, requestor);\n        };\n        return resolver;\n    };\n}\nexport const inject = DI.inject;\nfunction transientDecorator(target) {\n    return DI.transient(target);\n}\nexport function transient(target) {\n    return target == null ? transientDecorator : transientDecorator(target);\n}\nfunction singletonDecorator(target) {\n    return DI.singleton(target);\n}\nexport function singleton(target) {\n    return target == null ? singletonDecorator : singletonDecorator(target);\n}\nexport const all = createResolver((key, handler, requestor) => requestor.getAll(key));\n/**\n * Lazily inject a dependency depending on whether the [[`Key`]] is present at the time of function call.\n *\n * You need to make your argument a function that returns the type, for example\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => number )\n * }\n * const foo = container.get(Foo); // instanceof Foo\n * foo.random(); // throws\n * ```\n * would throw an exception because you haven't registered `'random'` before calling the method. This, would give you a\n * new [['Math.random()']] number each time.\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => random )\n * }\n * container.register(Registration.callback('random', Math.random ));\n * container.get(Foo).random(); // some random number\n * container.get(Foo).random(); // another random number\n * ```\n * `@lazy` does not manage the lifecycle of the underlying key. If you want a singleton, you have to register as a\n * `singleton`, `transient` would also behave as you would expect, providing you a new instance each time.\n *\n * - @param key [[`Key`]]\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const lazy = createResolver((key, handler, requestor) => {\n    return () => requestor.get(key);\n});\n/**\n * Allows you to optionally inject a dependency depending on whether the [[`Key`]] is present, for example\n * ```ts\n * class Foo {\n *   constructor( @inject('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo); // throws\n * ```\n * would fail\n * ```ts\n * class Foo {\n *   constructor( @optional('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo).str // somestring\n * ```\n * if you use it without a default it will inject `undefined`, so rember to mark your input type as\n * possibly `undefined`!\n *\n * - @param key: [[`Key`]]\n *\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const optional = createResolver((key, handler, requestor) => {\n    if (requestor.has(key, true)) {\n        return requestor.get(key);\n    }\n    else {\n        return undefined;\n    }\n});\n/**\n * ignore tells the container not to try to inject a dependency\n */\nexport function ignore(target, property, descriptor) {\n    DI.inject(ignore)(target, property, descriptor);\n}\nignore.$isResolver = true;\nignore.resolve = () => undefined;\nexport const newInstanceForScope = createResolver((key, handler, requestor) => {\n    const instance = createNewInstance(key, handler);\n    const instanceProvider = new InstanceProvider();\n    instanceProvider.prepare(instance);\n    requestor.registerResolver(key, instanceProvider, true);\n    return instance;\n});\nexport const newInstanceOf = createResolver((key, handler, _requestor) => createNewInstance(key, handler));\nfunction createNewInstance(key, handler) {\n    const factory = handler.getFactory(key);\n    if (factory === null) {\n        throw new Error(`No factory registered for ${key}`);\n    }\n    return factory.construct(handler);\n}\n/** @internal */\nexport var ResolverStrategy;\n(function (ResolverStrategy) {\n    ResolverStrategy[ResolverStrategy[\"instance\"] = 0] = \"instance\";\n    ResolverStrategy[ResolverStrategy[\"singleton\"] = 1] = \"singleton\";\n    ResolverStrategy[ResolverStrategy[\"transient\"] = 2] = \"transient\";\n    ResolverStrategy[ResolverStrategy[\"callback\"] = 3] = \"callback\";\n    ResolverStrategy[ResolverStrategy[\"array\"] = 4] = \"array\";\n    ResolverStrategy[ResolverStrategy[\"alias\"] = 5] = \"alias\";\n})(ResolverStrategy || (ResolverStrategy = {}));\n/** @internal */\nexport class Resolver {\n    constructor(key, strategy, state) {\n        this.key = key;\n        this.strategy = strategy;\n        this.state = state;\n        this.resolving = false;\n    }\n    get $isResolver() { return true; }\n    register(container, key) {\n        return container.registerResolver(key || this.key, this);\n    }\n    resolve(handler, requestor) {\n        switch (this.strategy) {\n            case 0 /* instance */:\n                return this.state;\n            case 1 /* singleton */: {\n                if (this.resolving) {\n                    throw new Error(`Cyclic dependency found: ${this.state.name}`);\n                }\n                this.resolving = true;\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                this.state = factory.construct(requestor);\n                this.strategy = 0 /* instance */;\n                this.resolving = false;\n                return this.state;\n            }\n            case 2 /* transient */: {\n                // Always create transients from the requesting container\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return factory.construct(requestor);\n            }\n            case 3 /* callback */:\n                return this.state(handler, requestor, this);\n            case 4 /* array */:\n                return this.state[0].resolve(handler, requestor);\n            case 5 /* alias */:\n                return handler.get(this.state);\n            default:\n                throw Reporter.error(6, this.strategy);\n        }\n    }\n    getFactory(container) {\n        let resolver;\n        switch (this.strategy) {\n            case 1 /* singleton */:\n            case 2 /* transient */:\n                return container.getFactory(this.state);\n            case 5 /* alias */:\n                resolver = container.getResolver(this.state);\n                if (resolver == null || resolver.getFactory === void 0) {\n                    return null;\n                }\n                return resolver.getFactory(container);\n            default:\n                return null;\n        }\n    }\n}\n/** @internal */\nexport class Factory {\n    constructor(Type, invoker, dependencies) {\n        this.Type = Type;\n        this.invoker = invoker;\n        this.dependencies = dependencies;\n        this.transformers = null;\n    }\n    construct(container, dynamicDependencies) {\n        const transformers = this.transformers;\n        let instance = dynamicDependencies !== void 0\n            ? this.invoker.invokeWithDynamicDependencies(container, this.Type, this.dependencies, dynamicDependencies)\n            : this.invoker.invoke(container, this.Type, this.dependencies);\n        if (transformers == null) {\n            return instance;\n        }\n        for (let i = 0, ii = transformers.length; i < ii; ++i) {\n            instance = transformers[i](instance);\n        }\n        return instance;\n    }\n    registerTransformer(transformer) {\n        if (this.transformers == null) {\n            this.transformers = [];\n        }\n        this.transformers.push(transformer);\n        return true;\n    }\n}\nconst createFactory = (function () {\n    function invokeWithDynamicDependencies(container, Type, staticDependencies, dynamicDependencies) {\n        let i = staticDependencies.length;\n        let args = new Array(i);\n        let lookup;\n        while (i-- > 0) {\n            lookup = staticDependencies[i];\n            if (lookup == null) {\n                throw Reporter.error(7, `Index ${i}.`);\n            }\n            else {\n                args[i] = container.get(lookup);\n            }\n        }\n        if (dynamicDependencies !== void 0) {\n            args = args.concat(dynamicDependencies);\n        }\n        return Reflect.construct(Type, args);\n    }\n    const classInvokers = [\n        {\n            invoke(container, Type) {\n                return new Type();\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));\n            },\n            invokeWithDynamicDependencies\n        }\n    ];\n    const fallbackInvoker = {\n        invoke: invokeWithDynamicDependencies,\n        invokeWithDynamicDependencies\n    };\n    return function (Type) {\n        if (isNativeFunction(Type)) {\n            Reporter.write(5, Type.name);\n        }\n        const dependencies = DI.getDependencies(Type);\n        const invoker = classInvokers.length > dependencies.length ? classInvokers[dependencies.length] : fallbackInvoker;\n        return new Factory(Type, invoker, dependencies);\n    };\n})();\nconst containerResolver = {\n    $isResolver: true,\n    resolve(handler, requestor) {\n        return requestor;\n    }\n};\nfunction isRegistry(obj) {\n    return typeof obj.register === 'function';\n}\nfunction isClass(obj) {\n    return obj.prototype !== void 0;\n}\nfunction isResourceKey(key) {\n    return typeof key === 'string' && key.indexOf(':') > 0;\n}\nconst InstrinsicTypeNames = new Set([\n    'Array',\n    'ArrayBuffer',\n    'Boolean',\n    'DataView',\n    'Date',\n    'Error',\n    'EvalError',\n    'Float32Array',\n    'Float64Array',\n    'Function',\n    'Int8Array',\n    'Int16Array',\n    'Int32Array',\n    'Map',\n    'Number',\n    'Object',\n    'Promise',\n    'RangeError',\n    'ReferenceError',\n    'RegExp',\n    'Set',\n    'SharedArrayBuffer',\n    'String',\n    'SyntaxError',\n    'TypeError',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Uint16Array',\n    'Uint32Array',\n    'URIError',\n    'WeakMap',\n    'WeakSet',\n]);\nconst factoryKey = 'di:factory';\nconst factoryAnnotationKey = Protocol.annotation.keyFor(factoryKey);\n/** @internal */\nexport class Container {\n    constructor(parent, config = DefaultContainerConfiguration) {\n        this.parent = parent;\n        this.config = config;\n        this.registerDepth = 0;\n        this.disposableResolvers = new Set();\n        if (parent === null) {\n            this.root = this;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.create(null);\n        }\n        else {\n            this.root = parent.root;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.assign(Object.create(null), this.root.resourceResolvers);\n        }\n        this.resolvers.set(IContainer, containerResolver);\n    }\n    register(...params) {\n        if (++this.registerDepth === 100) {\n            throw new Error('Unable to autoregister dependency');\n            // TODO: change to reporter.error and add various possible causes in description.\n            // Most likely cause is trying to register a plain object that does not have a\n            // register method and is not a class constructor\n        }\n        let current;\n        let keys;\n        let value;\n        let j;\n        let jj;\n        for (let i = 0, ii = params.length; i < ii; ++i) {\n            current = params[i];\n            if (!isObject(current)) {\n                continue;\n            }\n            if (isRegistry(current)) {\n                current.register(this);\n            }\n            else if (Protocol.resource.has(current)) {\n                const defs = Protocol.resource.getAll(current);\n                if (defs.length === 1) {\n                    // Fast path for the very common case\n                    defs[0].register(this);\n                }\n                else {\n                    const len = defs.length;\n                    for (let d = 0; d < len; ++d) {\n                        defs[d].register(this);\n                    }\n                }\n            }\n            else if (isClass(current)) {\n                Registration.singleton(current, current).register(this);\n            }\n            else {\n                keys = Object.keys(current);\n                j = 0;\n                jj = keys.length;\n                for (; j < jj; ++j) {\n                    value = current[keys[j]];\n                    if (!isObject(value)) {\n                        continue;\n                    }\n                    // note: we could remove this if-branch and call this.register directly\n                    // - the extra check is just a perf tweak to create fewer unnecessary arrays by the spread operator\n                    if (isRegistry(value)) {\n                        value.register(this);\n                    }\n                    else {\n                        this.register(value);\n                    }\n                }\n            }\n        }\n        --this.registerDepth;\n        return this;\n    }\n    registerResolver(key, resolver, isDisposable = false) {\n        validateKey(key);\n        const resolvers = this.resolvers;\n        const result = resolvers.get(key);\n        if (result == null) {\n            resolvers.set(key, resolver);\n            if (isResourceKey(key)) {\n                this.resourceResolvers[key] = resolver;\n            }\n        }\n        else if (result instanceof Resolver && result.strategy === 4 /* array */) {\n            result.state.push(resolver);\n        }\n        else {\n            resolvers.set(key, new Resolver(key, 4 /* array */, [result, resolver]));\n        }\n        if (isDisposable) {\n            this.disposableResolvers.add(resolver);\n        }\n        return resolver;\n    }\n    registerTransformer(key, transformer) {\n        const resolver = this.getResolver(key);\n        if (resolver == null) {\n            return false;\n        }\n        if (resolver.getFactory) {\n            const factory = resolver.getFactory(this);\n            if (factory == null) {\n                return false;\n            }\n            // This type cast is a bit of a hacky one, necessary due to the duplicity of IResolverLike.\n            // Problem is that that interface's type arg can be of type Key, but the getFactory method only works on\n            // type Constructable. So the return type of that optional method has this additional constraint, which\n            // seems to confuse the type checker.\n            return factory.registerTransformer(transformer);\n        }\n        return false;\n    }\n    getResolver(key, autoRegister = true) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key;\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    const handler = this.config.jitRegisterInRoot ? current : this;\n                    return autoRegister ? this.jitRegister(key, handler) : null;\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver;\n            }\n        }\n        return null;\n    }\n    has(key, searchAncestors = false) {\n        return this.resolvers.has(key)\n            ? true\n            : searchAncestors && this.parent != null\n                ? this.parent.has(key, true)\n                : false;\n    }\n    get(key) {\n        validateKey(key);\n        if (key.$isResolver) {\n            return key.resolve(this, this);\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    const handler = this.config.jitRegisterInRoot ? current : this;\n                    resolver = this.jitRegister(key, handler);\n                    return resolver.resolve(current, this);\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver.resolve(current, this);\n            }\n        }\n        throw new Error(`Unable to resolve key: ${key}`);\n    }\n    getAll(key) {\n        validateKey(key);\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (this.parent == null) {\n                    return PLATFORM.emptyArray;\n                }\n                current = current.parent;\n            }\n            else {\n                return buildAllResponse(resolver, current, this);\n            }\n        }\n        return PLATFORM.emptyArray;\n    }\n    getFactory(Type) {\n        let factory = Metadata.getOwn(factoryAnnotationKey, Type);\n        if (factory === void 0) {\n            Metadata.define(factoryAnnotationKey, factory = createFactory(Type), Type);\n            Protocol.annotation.appendTo(Type, factoryAnnotationKey);\n        }\n        return factory;\n    }\n    registerFactory(key, factory) {\n        Protocol.annotation.set(key, factoryKey, factory);\n        Protocol.annotation.appendTo(key, factoryAnnotationKey);\n    }\n    createChild(config) {\n        return new Container(this, config !== null && config !== void 0 ? config : this.config);\n    }\n    disposeResolvers() {\n        var _a;\n        const disposables = Array.from(this.disposableResolvers);\n        while (disposables.length > 0) {\n            (_a = disposables.pop()) === null || _a === void 0 ? void 0 : _a.dispose();\n        }\n    }\n    jitRegister(keyAsValue, handler) {\n        if (typeof keyAsValue !== 'function') {\n            throw new Error(`Attempted to jitRegister something that is not a constructor: '${keyAsValue}'. Did you forget to register this resource?`);\n        }\n        if (InstrinsicTypeNames.has(keyAsValue.name)) {\n            throw new Error(`Attempted to jitRegister an intrinsic type: ${keyAsValue.name}. Did you forget to add @inject(Key)`);\n        }\n        if (isRegistry(keyAsValue)) {\n            const registrationResolver = keyAsValue.register(handler, keyAsValue);\n            if (!(registrationResolver instanceof Object) || registrationResolver.resolve == null) {\n                const newResolver = handler.resolvers.get(keyAsValue);\n                if (newResolver != void 0) {\n                    return newResolver;\n                }\n                throw Reporter.error(40); // did not return a valid resolver from the static register method\n            }\n            return registrationResolver;\n        }\n        else if (Protocol.resource.has(keyAsValue)) {\n            const defs = Protocol.resource.getAll(keyAsValue);\n            if (defs.length === 1) {\n                // Fast path for the very common case\n                defs[0].register(handler);\n            }\n            else {\n                const len = defs.length;\n                for (let d = 0; d < len; ++d) {\n                    defs[d].register(handler);\n                }\n            }\n            const newResolver = handler.resolvers.get(keyAsValue);\n            if (newResolver != void 0) {\n                return newResolver;\n            }\n            throw Reporter.error(40); // did not return a valid resolver from the static register method\n        }\n        else if (keyAsValue.$isInterface) {\n            throw new Error(`Attempted to jitRegister an interface: ${keyAsValue.friendlyName}`);\n        }\n        else {\n            const resolver = this.config.defaultResolver(keyAsValue, handler);\n            handler.resolvers.set(keyAsValue, resolver);\n            return resolver;\n        }\n    }\n}\n/**\n * An implementation of IRegistry that delegates registration to a\n * separately registered class. The ParameterizedRegistry facilitates the\n * passing of parameters to the final registry.\n */\nexport class ParameterizedRegistry {\n    constructor(key, params) {\n        this.key = key;\n        this.params = params;\n    }\n    register(container) {\n        if (container.has(this.key, true)) {\n            const registry = container.get(this.key);\n            registry.register(container, ...this.params);\n        }\n        else {\n            container.register(...this.params.filter(x => typeof x === 'object'));\n        }\n    }\n}\nconst cache = new WeakMap();\nfunction cacheCallbackResult(fun) {\n    return function (handler, requestor, resolver) {\n        if (cache.has(resolver)) {\n            return cache.get(resolver);\n        }\n        const t = fun(handler, requestor, resolver);\n        cache.set(resolver, t);\n        return t;\n    };\n}\n/**\n * you can use the resulting {@linkcode IRegistration} of any of the factory methods\n * to register with the container, e.g.\n * ```\n * class Foo {}\n * const container = DI.createContainer();\n * container.register(Registration.instance(Foo, new Foo()));\n * container.get(Foo);\n * ```\n */\nexport const Registration = {\n    /**\n     * allows you to pass an instance.\n     * Every time you request this {@linkcode Key} you will get this instance back.\n     * ```\n     * Registration.instance(Foo, new Foo()));\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    instance(key, value) {\n        return new Resolver(key, 0 /* instance */, value);\n    },\n    /**\n     * Creates an instance from the class.\n     * Every time you request this {@linkcode Key} you will get the same one back.\n     * ```\n     * Registration.singleton(Foo, Foo);\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    singleton(key, value) {\n        return new Resolver(key, 1 /* singleton */, value);\n    },\n    /**\n     * Creates an instance from a class.\n     * Every time you request this {@linkcode Key} you will get a new instance.\n     * ```\n     * Registration.instance(Foo, Foo);\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    transient(key, value) {\n        return new Resolver(key, 2 /* transient */, value);\n    },\n    /**\n     * Creates an instance from the method passed.\n     * Every time you request this {@linkcode Key} you will get a new instance.\n     * ```\n     * Registration.callback(Foo, () => new Foo());\n     * Registration.callback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n     * ```\n     *\n     * @param key\n     * @param callback\n     */\n    callback(key, callback) {\n        return new Resolver(key, 3 /* callback */, callback);\n    },\n    /**\n     * Creates an instance from the method passed.\n     * On the first request for the {@linkcode Key} your callback is called and returns an instance.\n     * subsequent requests for the {@linkcode Key}, the initial instance returned will be returned.\n     * If you pass the same {@linkcode Registration} to another container the same cached value will be used.\n     * Should all references to the resolver returned be removed, the cache will expire.\n     * ```\n     * Registration.cachedCallback(Foo, () => new Foo());\n     * Registration.cachedCallback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n     * ```\n     *\n     * @param key\n     * @param callback\n     */\n    cachedCallback(key, callback) {\n        return new Resolver(key, 3 /* callback */, cacheCallbackResult(callback));\n    },\n    /**\n     * creates an alternate {@linkcode Key} to retrieve an instance by.\n     * Returns the same scope as the original {@linkcode Key}.\n     * ```\n     * Register.singleton(Foo, Foo)\n     * Register.aliasTo(Foo, MyFoos);\n     *\n     * container.getAll(MyFoos) // contains an instance of Foo\n     * ```\n     *\n     * @param originalKey\n     * @param aliasKey\n     */\n    aliasTo(originalKey, aliasKey) {\n        return new Resolver(aliasKey, 5 /* alias */, originalKey);\n    },\n    /**\n     * @internal\n     * @param key\n     * @param params\n     */\n    defer(key, ...params) {\n        return new ParameterizedRegistry(key, params);\n    }\n};\nexport class InstanceProvider {\n    constructor() {\n        this.instance = null;\n    }\n    prepare(instance) {\n        this.instance = instance;\n    }\n    get $isResolver() { return true; }\n    resolve() {\n        if (this.instance === undefined) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        return this.instance;\n    }\n    dispose() {\n        this.instance = null;\n    }\n}\n/** @internal */\nexport function validateKey(key) {\n    if (key === null || key === void 0) {\n        throw Reporter.error(5);\n    }\n}\nfunction buildAllResponse(resolver, handler, requestor) {\n    if (resolver instanceof Resolver && resolver.strategy === 4 /* array */) {\n        const state = resolver.state;\n        let i = state.length;\n        const results = new Array(i);\n        while (i--) {\n            results[i] = state[i].resolve(handler, requestor);\n        }\n        return results;\n    }\n    return [resolver.resolve(handler, requestor)];\n}\n//# sourceMappingURL=di.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, DI, ignore, optional, Registration } from './di';\nimport { toLookup } from './functions';\nimport { Protocol } from './resource';\nimport { Metadata } from '@aurelia/metadata';\n/**\n * Flags to enable/disable color usage in the logging output.\n */\nexport var ColorOptions;\n(function (ColorOptions) {\n    /**\n     * Do not use ASCII color codes in logging output.\n     */\n    ColorOptions[ColorOptions[\"noColors\"] = 0] = \"noColors\";\n    /**\n     * Use ASCII color codes in logging output. By default, timestamps and the TRC and DBG prefix are colored grey. INF white, WRN yellow, and ERR and FTL red.\n     */\n    ColorOptions[ColorOptions[\"colors\"] = 1] = \"colors\";\n})(ColorOptions || (ColorOptions = {}));\nexport const ILogConfig = DI.createInterface('ILogConfig').withDefault(x => x.instance(new LogConfig(0 /* noColors */, 3 /* warn */)));\nexport const ISink = DI.createInterface('ISink').noDefault();\nexport const ILogEventFactory = DI.createInterface('ILogEventFactory').withDefault(x => x.singleton(DefaultLogEventFactory));\nexport const ILogger = DI.createInterface('ILogger').withDefault(x => x.singleton(DefaultLogger));\nexport const ILogScopes = DI.createInterface('ILogScope').noDefault();\nexport const LoggerSink = Object.freeze({\n    key: Protocol.annotation.keyFor('logger-sink-handles'),\n    define(target, definition) {\n        Metadata.define(this.key, definition.handles, target.prototype);\n        return target;\n    },\n    getHandles(target) {\n        return Metadata.get(this.key, target);\n    },\n});\nexport function sink(definition) {\n    return function (target) {\n        return LoggerSink.define(target, definition);\n    };\n}\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\nexport const format = toLookup({\n    red(str) {\n        return `\\u001b[31m${str}\\u001b[39m`;\n    },\n    green(str) {\n        return `\\u001b[32m${str}\\u001b[39m`;\n    },\n    yellow(str) {\n        return `\\u001b[33m${str}\\u001b[39m`;\n    },\n    blue(str) {\n        return `\\u001b[34m${str}\\u001b[39m`;\n    },\n    magenta(str) {\n        return `\\u001b[35m${str}\\u001b[39m`;\n    },\n    cyan(str) {\n        return `\\u001b[36m${str}\\u001b[39m`;\n    },\n    white(str) {\n        return `\\u001b[37m${str}\\u001b[39m`;\n    },\n    grey(str) {\n        return `\\u001b[90m${str}\\u001b[39m`;\n    },\n});\nexport class LogConfig {\n    constructor(colorOptions, level) {\n        this.colorOptions = colorOptions;\n        this.level = level;\n    }\n}\nconst getLogLevelString = (function () {\n    const logLevelString = [\n        toLookup({\n            TRC: 'TRC',\n            DBG: 'DBG',\n            INF: 'INF',\n            WRN: 'WRN',\n            ERR: 'ERR',\n            FTL: 'FTL',\n            QQQ: '???',\n        }),\n        toLookup({\n            TRC: format.grey('TRC'),\n            DBG: format.grey('DBG'),\n            INF: format.white('INF'),\n            WRN: format.yellow('WRN'),\n            ERR: format.red('ERR'),\n            FTL: format.red('FTL'),\n            QQQ: format.grey('???'),\n        }),\n    ];\n    return function (level, colorOptions) {\n        if (level <= 0 /* trace */) {\n            return logLevelString[colorOptions].TRC;\n        }\n        if (level <= 1 /* debug */) {\n            return logLevelString[colorOptions].DBG;\n        }\n        if (level <= 2 /* info */) {\n            return logLevelString[colorOptions].INF;\n        }\n        if (level <= 3 /* warn */) {\n            return logLevelString[colorOptions].WRN;\n        }\n        if (level <= 4 /* error */) {\n            return logLevelString[colorOptions].ERR;\n        }\n        if (level <= 5 /* fatal */) {\n            return logLevelString[colorOptions].FTL;\n        }\n        return logLevelString[colorOptions].QQQ;\n    };\n})();\nfunction getScopeString(scope, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return scope.join('.');\n    }\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    return scope.map(format.cyan).join('.');\n}\nfunction getIsoString(timestamp, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return new Date(timestamp).toISOString();\n    }\n    return format.grey(new Date(timestamp).toISOString());\n}\nexport class DefaultLogEvent {\n    constructor(severity, message, optionalParams, scope, colorOptions, timestamp) {\n        this.severity = severity;\n        this.message = message;\n        this.optionalParams = optionalParams;\n        this.scope = scope;\n        this.colorOptions = colorOptions;\n        this.timestamp = timestamp;\n    }\n    toString() {\n        const { severity, message, scope, colorOptions, timestamp } = this;\n        if (scope.length === 0) {\n            return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)}] ${message}`;\n        }\n        return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)} ${getScopeString(scope, colorOptions)}] ${message}`;\n    }\n}\nlet DefaultLogEventFactory = class DefaultLogEventFactory {\n    constructor(config) {\n        this.config = config;\n    }\n    createLogEvent(logger, level, message, optionalParams) {\n        return new DefaultLogEvent(level, message, optionalParams, logger.scope, this.config.colorOptions, Date.now());\n    }\n};\nDefaultLogEventFactory = __decorate([\n    __param(0, ILogConfig),\n    __metadata(\"design:paramtypes\", [Object])\n], DefaultLogEventFactory);\nexport { DefaultLogEventFactory };\nexport class ConsoleSink {\n    constructor($console) {\n        this.handleEvent = function emit(event) {\n            const optionalParams = event.optionalParams;\n            if (optionalParams === void 0 || optionalParams.length === 0) {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString());\n                    case 2 /* info */:\n                        return $console.info(event.toString());\n                    case 3 /* warn */:\n                        return $console.warn(event.toString());\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString());\n                }\n            }\n            else {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString(), ...optionalParams);\n                    case 2 /* info */:\n                        return $console.info(event.toString(), ...optionalParams);\n                    case 3 /* warn */:\n                        return $console.warn(event.toString(), ...optionalParams);\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString(), ...optionalParams);\n                }\n            }\n        };\n    }\n}\nlet DefaultLogger = class DefaultLogger {\n    constructor(config, factory, sinks, scope = [], parent = null) {\n        var _a, _b, _c, _d, _e, _f;\n        this.config = config;\n        this.factory = factory;\n        this.scope = scope;\n        this.scopedLoggers = Object.create(null);\n        let traceSinks;\n        let debugSinks;\n        let infoSinks;\n        let warnSinks;\n        let errorSinks;\n        let fatalSinks;\n        if (parent === null) {\n            this.root = this;\n            this.parent = this;\n            traceSinks = this.traceSinks = [];\n            debugSinks = this.debugSinks = [];\n            infoSinks = this.infoSinks = [];\n            warnSinks = this.warnSinks = [];\n            errorSinks = this.errorSinks = [];\n            fatalSinks = this.fatalSinks = [];\n            for (const $sink of sinks) {\n                const handles = LoggerSink.getHandles($sink);\n                if ((_a = handles === null || handles === void 0 ? void 0 : handles.includes(0 /* trace */)) !== null && _a !== void 0 ? _a : true) {\n                    traceSinks.push($sink);\n                }\n                if ((_b = handles === null || handles === void 0 ? void 0 : handles.includes(1 /* debug */)) !== null && _b !== void 0 ? _b : true) {\n                    debugSinks.push($sink);\n                }\n                if ((_c = handles === null || handles === void 0 ? void 0 : handles.includes(2 /* info */)) !== null && _c !== void 0 ? _c : true) {\n                    infoSinks.push($sink);\n                }\n                if ((_d = handles === null || handles === void 0 ? void 0 : handles.includes(3 /* warn */)) !== null && _d !== void 0 ? _d : true) {\n                    warnSinks.push($sink);\n                }\n                if ((_e = handles === null || handles === void 0 ? void 0 : handles.includes(4 /* error */)) !== null && _e !== void 0 ? _e : true) {\n                    errorSinks.push($sink);\n                }\n                if ((_f = handles === null || handles === void 0 ? void 0 : handles.includes(5 /* fatal */)) !== null && _f !== void 0 ? _f : true) {\n                    fatalSinks.push($sink);\n                }\n            }\n        }\n        else {\n            this.root = parent.root;\n            this.parent = parent;\n            traceSinks = this.traceSinks = parent.traceSinks;\n            debugSinks = this.debugSinks = parent.debugSinks;\n            infoSinks = this.infoSinks = parent.infoSinks;\n            warnSinks = this.warnSinks = parent.warnSinks;\n            errorSinks = this.errorSinks = parent.errorSinks;\n            fatalSinks = this.fatalSinks = parent.fatalSinks;\n        }\n        const emit = ($sinks, level, msgOrGetMsg, optionalParams) => {\n            const message = typeof msgOrGetMsg === 'function' ? msgOrGetMsg() : msgOrGetMsg;\n            const event = factory.createLogEvent(this, level, message, optionalParams);\n            for (let i = 0, ii = $sinks.length; i < ii; ++i) {\n                $sinks[i].handleEvent(event);\n            }\n        };\n        this.trace = function trace(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 0 /* trace */) {\n                emit(traceSinks, 0 /* trace */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.debug = function debug(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 1 /* debug */) {\n                emit(debugSinks, 1 /* debug */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.info = function info(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 2 /* info */) {\n                emit(infoSinks, 2 /* info */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.warn = function warn(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 3 /* warn */) {\n                emit(warnSinks, 3 /* warn */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.error = function error(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 4 /* error */) {\n                emit(errorSinks, 4 /* error */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.fatal = function fatal(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 5 /* fatal */) {\n                emit(fatalSinks, 5 /* fatal */, messageOrGetMessage, optionalParams);\n            }\n        };\n    }\n    scopeTo(name) {\n        const scopedLoggers = this.scopedLoggers;\n        let scopedLogger = scopedLoggers[name];\n        if (scopedLogger === void 0) {\n            scopedLogger = scopedLoggers[name] = new DefaultLogger(this.config, this.factory, (void 0), this.scope.concat(name), this);\n        }\n        return scopedLogger;\n    }\n};\nDefaultLogger = __decorate([\n    __param(0, ILogConfig),\n    __param(1, ILogEventFactory),\n    __param(2, all(ISink)),\n    __param(3, optional(ILogScopes)),\n    __param(4, ignore),\n    __metadata(\"design:paramtypes\", [Object, Object, Array, Array, Object])\n], DefaultLogger);\nexport { DefaultLogger };\n/**\n * A basic `ILogger` configuration that configures a single `console` sink based on provided options.\n *\n * NOTE: You *must* register the return value of `.create` with the container / au instance, not this `LoggerConfiguration` object itself.\n *\n * @example\n * ```ts\n * container.register(LoggerConfiguration.create());\n *\n * container.register(LoggerConfiguration.create({$console: console}))\n *\n * container.register(LoggerConfiguration.create({$console: console, level: LogLevel.debug}))\n *\n * container.register(LoggerConfiguration.create({\n *  $console: {\n *     debug: PLATFORM.noop,\n *     info: PLATFORM.noop,\n *     warn: PLATFORM.noop,\n *     error: msg => {\n *       throw new Error(msg);\n *     }\n *  },\n *  level: LogLevel.debug\n * }))\n *\n * ```\n */\nexport const LoggerConfiguration = toLookup({\n    /**\n     * @param $console - The `console` object to use. Can be the native `window.console` / `global.console`, but can also be a wrapper or mock that implements the same interface.\n     * @param level - The global `LogLevel` to configure. Defaults to `warn` or higher.\n     * @param colorOptions - Whether to use colors or not. Defaults to `noColors`. Colors are especially nice in nodejs environments but don't necessarily work (well) in all environments, such as browsers.\n     */\n    create({ $console, level = 3 /* warn */, colorOptions = 0 /* noColors */, sinks = [], } = {}) {\n        return toLookup({\n            register(container) {\n                container.register(Registration.instance(ILogConfig, new LogConfig(colorOptions, level)));\n                if ($console !== void 0 && $console !== null) {\n                    container.register(Registration.instance(ISink, new ConsoleSink($console)));\n                }\n                for (const $sink of sinks) {\n                    container.register(Registration.singleton(ISink, $sink));\n                }\n                return container;\n            },\n        });\n    },\n});\n//# sourceMappingURL=logger.js.map","import { PLATFORM } from './platform';\nexport const Profiler = (function () {\n    const now = PLATFORM.now;\n    const timers = [];\n    let profileMap;\n    const profiler = {\n        createTimer,\n        enable,\n        disable,\n        report,\n        enabled: false\n    };\n    return profiler;\n    function createTimer(name) {\n        timers.push(name);\n        let depth = 0;\n        let mark = 0;\n        return {\n            enter,\n            leave\n        };\n        function enter() {\n            if (++depth === 1) {\n                mark = now();\n                ++profileMap[name].topLevelCount;\n            }\n            ++profileMap[name].totalCount;\n        }\n        function leave() {\n            if (--depth === 0) {\n                profileMap[name].duration += (now() - mark);\n            }\n        }\n    }\n    function enable() {\n        profileMap = {};\n        for (const timer of timers) {\n            profileMap[timer] = {\n                name: timer,\n                duration: 0,\n                topLevelCount: 0,\n                totalCount: 0\n            };\n        }\n        profiler.enabled = true;\n    }\n    function disable() {\n        profiler.enabled = false;\n    }\n    function report(cb) {\n        Object.keys(profileMap).map(key => profileMap[key]).sort((a, b) => b.duration - a.duration).forEach(p => {\n            cb(p.name, p.duration, p.topLevelCount, p.totalCount);\n        });\n    }\n})();\n//# sourceMappingURL=profiler.js.map","import { DI } from './di';\nimport { Reporter } from './reporter';\n/**\n * Represents a handler for an EventAggregator event.\n */\nclass Handler {\n    constructor(\n    /** @internal */\n    messageType, \n    /** @internal */\n    callback) {\n        this.messageType = messageType;\n        this.callback = callback;\n    }\n    handle(message) {\n        if (message instanceof this.messageType) {\n            this.callback.call(null, message);\n        }\n    }\n}\nfunction invokeCallback(callback, data, event) {\n    try {\n        callback(data, event);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nfunction invokeHandler(handler, data) {\n    try {\n        handler.handle(data);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nexport const IEventAggregator = DI.createInterface('IEventAggregator').withDefault(x => x.singleton(EventAggregator));\n/**\n * Enables loosely coupled publish/subscribe messaging.\n */\nexport class EventAggregator {\n    constructor() {\n        /** @internal */\n        this.eventLookup = {};\n        /** @internal */\n        this.messageHandlers = [];\n    }\n    publish(channelOrInstance, data) {\n        let subscribers;\n        let i;\n        if (!channelOrInstance) {\n            throw Reporter.error(0); // TODO: create error code for 'Event was invalid.'\n        }\n        if (typeof channelOrInstance === 'string') {\n            const channel = channelOrInstance;\n            subscribers = this.eventLookup[channel];\n            if (subscribers != null) {\n                subscribers = subscribers.slice();\n                i = subscribers.length;\n                while (i--) {\n                    invokeCallback(subscribers[i], data, channel);\n                }\n            }\n        }\n        else {\n            const instance = channelOrInstance;\n            subscribers = this.messageHandlers.slice();\n            i = subscribers.length;\n            while (i--) {\n                invokeHandler(subscribers[i], instance);\n            }\n        }\n    }\n    subscribe(channelOrType, callback) {\n        let handler;\n        let subscribers;\n        if (!channelOrType) {\n            throw Reporter.error(0); // TODO: create error code for 'Event channel/type was invalid.'\n        }\n        if (typeof channelOrType === 'string') {\n            const channel = channelOrType;\n            handler = callback;\n            if (this.eventLookup[channel] === void 0) {\n                this.eventLookup[channel] = [];\n            }\n            subscribers = this.eventLookup[channel];\n        }\n        else {\n            handler = new Handler(channelOrType, callback);\n            subscribers = this.messageHandlers;\n        }\n        subscribers.push(handler);\n        return {\n            dispose() {\n                const idx = subscribers.indexOf(handler);\n                if (idx !== -1) {\n                    subscribers.splice(idx, 1);\n                }\n            }\n        };\n    }\n    subscribeOnce(channelOrType, callback) {\n        const sub = this.subscribe(channelOrType, (data, event) => {\n            sub.dispose();\n            return callback(data, event);\n        });\n        return sub;\n    }\n}\n//# sourceMappingURL=eventaggregator.js.map","export { all, DI, IContainer, inject, IServiceLocator, lazy, optional, ignore, Registration, singleton, transient, InstanceProvider, newInstanceForScope, newInstanceOf, DefaultContainerConfiguration, DefaultResolver, } from './di';\nexport { metadata, Metadata, isNullOrUndefined, isObject, applyMetadataPolyfill, } from '@aurelia/metadata';\nexport { ColorOptions, ILogConfig, ILogEventFactory, ISink, ILogger, LogConfig, DefaultLogEvent, DefaultLogEventFactory, DefaultLogger, ConsoleSink, LoggerConfiguration, format, sink, } from './logger';\nexport { relativeToFile, join, } from './path';\nexport { PLATFORM } from './platform';\nexport { Reporter, Tracer, LogLevel, } from './reporter';\nexport { Profiler } from './profiler';\nexport { Protocol, fromAnnotationOrDefinitionOrTypeOrDefault, fromAnnotationOrTypeOrDefault, fromDefinitionOrDefault, } from './resource';\nexport { EventAggregator, IEventAggregator, } from './eventaggregator';\nexport { isArrayIndex, camelCase, kebabCase, pascalCase, toArray, nextId, resetId, compareNumber, mergeDistinct, isNumberOrBigInt, isStringOrDate, bound, mergeArrays, mergeObjects, firstDefined, getPrototypeChain, isNativeFunction, } from './functions';\n//# sourceMappingURL=index.js.map","// TODO: see if we can de-duplicate these 3 decorators and their functions without killing performance or readability\nexport function subscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._subscriberFlags = 0 /* None */;\n        proto.addSubscriber = addSubscriber;\n        proto.removeSubscriber = removeSubscriber;\n        proto.hasSubscriber = hasSubscriber;\n        proto.hasSubscribers = hasSubscribers;\n        proto.callSubscribers = callSubscribers;\n        if (proto.subscribe === void 0)\n            proto.subscribe = addSubscriber;\n        if (proto.unsubscribe === void 0)\n            proto.unsubscribe = removeSubscriber;\n    };\n}\nexport function proxySubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._proxySubscriberFlags = 0 /* None */;\n        proto.addProxySubscriber = addProxySubscriber;\n        proto.removeProxySubscriber = removeProxySubscriber;\n        proto.hasProxySubscriber = hasProxySubscriber;\n        proto.hasProxySubscribers = hasProxySubscribers;\n        proto.callProxySubscribers = callProxySubscribers;\n        if (proto.subscribeToProxy === void 0)\n            proto.subscribeToProxy = addProxySubscriber;\n        if (proto.unsubscribeFromProxy === void 0)\n            proto.unsubscribeFromProxy = removeProxySubscriber;\n    };\n}\nexport function collectionSubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._collectionSubscriberFlags = 0 /* None */;\n        proto.addCollectionSubscriber = addCollectionSubscriber;\n        proto.removeCollectionSubscriber = removeCollectionSubscriber;\n        proto.hasCollectionSubscriber = hasCollectionSubscriber;\n        proto.hasCollectionSubscribers = hasCollectionSubscribers;\n        proto.callCollectionSubscribers = callCollectionSubscribers;\n        if (proto.subscribeToCollection === void 0)\n            proto.subscribeToCollection = addCollectionSubscriber;\n        if (proto.unsubscribeFromCollection === void 0)\n            proto.unsubscribeFromCollection = removeCollectionSubscriber;\n    };\n}\nfunction addSubscriber(subscriber) {\n    if (this.hasSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._subscriber0 = subscriber;\n        this._subscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._subscriber1 = subscriber;\n        this._subscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._subscriber2 = subscriber;\n        this._subscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._subscribersRest = [subscriber];\n        this._subscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._subscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addProxySubscriber(subscriber) {\n    if (this.hasProxySubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._proxySubscriber0 = subscriber;\n        this._proxySubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._proxySubscriber1 = subscriber;\n        this._proxySubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._proxySubscriber2 = subscriber;\n        this._proxySubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._proxySubscribersRest = [subscriber];\n        this._proxySubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._proxySubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addCollectionSubscriber(subscriber) {\n    if (this.hasCollectionSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._collectionSubscriber0 = subscriber;\n        this._collectionSubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._collectionSubscriber1 = subscriber;\n        this._collectionSubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._collectionSubscriber2 = subscriber;\n        this._collectionSubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._collectionSubscribersRest = [subscriber];\n        this._collectionSubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._collectionSubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction removeSubscriber(subscriber) {\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        this._subscriber0 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        this._subscriber1 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        this._subscriber2 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._subscriberFlags = (this._subscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        this._proxySubscriber0 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        this._proxySubscriber1 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        this._proxySubscriber2 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._proxySubscriberFlags = (this._proxySubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        this._collectionSubscriber0 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        this._collectionSubscriber1 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        this._collectionSubscriber2 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasSubscribers() {\n    return this._subscriberFlags !== 0 /* None */;\n}\nfunction hasProxySubscribers() {\n    return this._proxySubscriberFlags !== 0 /* None */;\n}\nfunction hasCollectionSubscribers() {\n    return this._collectionSubscriberFlags !== 0 /* None */;\n}\nfunction hasSubscriber(subscriber) {\n    // Flags here is just a perf tweak\n    // Compared to not using flags, it's a moderate speed-up when this collection does not have the subscriber;\n    // and minor slow-down when it does, and the former is more common than the latter.\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction callSubscribers(newValue, previousValue, flags) {\n    /**\n     * Note: change handlers may have the side-effect of adding/removing subscribers to this collection during this\n     * callSubscribers invocation, so we're caching them all before invoking any.\n     * Subscribers added during this invocation are not invoked (and they shouldn't be).\n     * Subscribers removed during this invocation will still be invoked (and they also shouldn't be,\n     * however this is accounted for via $isBound and similar flags on the subscriber objects)\n     */\n    const subscriber0 = this._subscriber0;\n    const subscriber1 = this._subscriber1;\n    const subscriber2 = this._subscriber2;\n    let subscribers = this._subscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        callSubscriber(subscriber0, newValue, previousValue, flags, subscriber0.id === void 0 ? 0 : this[subscriber0.id]);\n    }\n    if (subscriber1 !== void 0) {\n        callSubscriber(subscriber1, newValue, previousValue, flags, subscriber1.id === void 0 ? 0 : this[subscriber1.id]);\n    }\n    if (subscriber2 !== void 0) {\n        callSubscriber(subscriber2, newValue, previousValue, flags, subscriber2.id === void 0 ? 0 : this[subscriber2.id]);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                callSubscriber(subscriber, newValue, previousValue, flags, subscriber.id === void 0 ? 0 : this[subscriber.id]);\n            }\n        }\n    }\n}\nfunction callSubscriber(subscriber, newValue, previousValue, flags, ownFlags) {\n    subscriber.handleChange(newValue, previousValue, ((flags | 48 /* update */) ^ 48 /* update */) | ownFlags);\n}\nfunction callProxySubscribers(key, newValue, previousValue, flags) {\n    const subscriber0 = this._proxySubscriber0;\n    const subscriber1 = this._proxySubscriber1;\n    const subscriber2 = this._proxySubscriber2;\n    let subscribers = this._proxySubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleProxyChange(key, newValue, previousValue, flags);\n            }\n        }\n    }\n}\nfunction callCollectionSubscribers(indexMap, flags) {\n    const subscriber0 = this._collectionSubscriber0;\n    const subscriber1 = this._collectionSubscriber1;\n    const subscriber2 = this._collectionSubscriber2;\n    let subscribers = this._collectionSubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleCollectionChange(indexMap, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleCollectionChange(indexMap, flags);\n            }\n        }\n    }\n}\n//# sourceMappingURL=subscriber-collection.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar ProxyObserver_1;\nimport { PLATFORM } from '@aurelia/kernel';\nimport { proxySubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst lookup = new WeakMap();\nlet ProxySubscriberCollection = class ProxySubscriberCollection {\n    constructor(proxy, raw, key) {\n        this.proxy = proxy;\n        this.raw = raw;\n        this.key = key;\n        this.inBatch = false;\n        this.subscribe = this.addSubscriber;\n        this.unsubscribe = this.removeSubscriber;\n        if (raw[key] instanceof Object) { // Ensure we observe array indices and newly created object properties\n            raw[key] = ProxyObserver.getOrCreate(raw[key]).proxy;\n        }\n    }\n    setValue(value, flags) {\n        const oldValue = this.raw[this.key];\n        if (oldValue !== value) {\n            this.raw[this.key] = value;\n            this.callSubscribers(value, oldValue, flags | 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n    getValue() {\n        return this.raw[this.key];\n    }\n    flushBatch(flags) {\n        return;\n    }\n};\nProxySubscriberCollection = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, Object])\n], ProxySubscriberCollection);\nexport { ProxySubscriberCollection };\nlet ProxyObserver = ProxyObserver_1 = class ProxyObserver {\n    constructor(obj) {\n        this.raw = obj;\n        this.proxy = new Proxy(obj, this);\n        lookup.set(obj, this.proxy);\n        this.subscribers = {};\n    }\n    static getProxyOrSelf(obj) {\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                return obj;\n            }\n            return proxy;\n        }\n        return obj;\n    }\n    static getRawIfProxy(obj) {\n        const raw = obj.$raw;\n        if (raw === void 0) {\n            return obj;\n        }\n        return raw;\n    }\n    static getOrCreate(obj, key) {\n        let proxyObserver;\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                proxyObserver = new ProxyObserver_1(obj);\n            }\n            else {\n                proxyObserver = proxy.$observer;\n            }\n        }\n        else {\n            proxyObserver = obj.$observer;\n        }\n        if (key === void 0) {\n            return proxyObserver;\n        }\n        let subscribers = proxyObserver.subscribers[key];\n        if (subscribers === void 0) {\n            const raw = this.getRawIfProxy(obj);\n            const proxy = proxyObserver.proxy;\n            subscribers = proxyObserver.subscribers[key] = new ProxySubscriberCollection(proxy, raw, key);\n        }\n        return subscribers;\n    }\n    static isProxy(obj) {\n        return obj.$raw !== void 0;\n    }\n    get(target, p, receiver) {\n        if (p === '$observer') {\n            return this;\n        }\n        if (p === '$raw') {\n            return target;\n        }\n        return target[p];\n    }\n    set(target, p, value, receiver) {\n        const oldValue = target[p];\n        if (oldValue !== value) {\n            target[p] = value;\n            this.callPropertySubscribers(value, oldValue, p);\n            this.callProxySubscribers(p, value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n        return true;\n    }\n    deleteProperty(target, p) {\n        const oldValue = target[p];\n        if (Reflect.deleteProperty(target, p)) {\n            if (oldValue !== void 0) {\n                this.callPropertySubscribers(undefined, oldValue, p);\n                this.callProxySubscribers(p, undefined, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    defineProperty(target, p, attributes) {\n        const oldValue = target[p];\n        if (Reflect.defineProperty(target, p, attributes)) {\n            if (attributes.value !== oldValue) {\n                this.callPropertySubscribers(attributes.value, oldValue, p);\n                this.callProxySubscribers(p, attributes.value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    apply(target, thisArg, argArray = PLATFORM.emptyArray) {\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        return Reflect.apply(target, target, argArray); // Reflect API dictates this\n    }\n    subscribe(subscriber, key) {\n        if (key === void 0) {\n            this.addProxySubscriber(subscriber);\n        }\n        else {\n            let subscribers = this.subscribers[key];\n            if (subscribers === void 0) {\n                subscribers = this.subscribers[key] = new ProxySubscriberCollection(this.proxy, this.raw, key);\n            }\n            subscribers.addSubscriber(subscriber);\n        }\n    }\n    unsubscribe(subscriber, key) {\n        if (key === void 0) {\n            this.removeProxySubscriber(subscriber);\n        }\n        else {\n            const subscribers = this.subscribers[key];\n            if (subscribers !== undefined) {\n                subscribers.removeSubscriber(subscriber);\n            }\n        }\n    }\n    callPropertySubscribers(newValue, oldValue, key) {\n        const subscribers = this.subscribers[key];\n        if (subscribers !== void 0) {\n            subscribers.callSubscribers(newValue, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n};\nProxyObserver = ProxyObserver_1 = __decorate([\n    proxySubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object])\n], ProxyObserver);\nexport { ProxyObserver };\n//# sourceMappingURL=proxy-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration, } from '@aurelia/kernel';\nexport var ViewModelKind;\n(function (ViewModelKind) {\n    ViewModelKind[ViewModelKind[\"customElement\"] = 0] = \"customElement\";\n    ViewModelKind[ViewModelKind[\"customAttribute\"] = 1] = \"customAttribute\";\n    ViewModelKind[ViewModelKind[\"synthetic\"] = 2] = \"synthetic\";\n})(ViewModelKind || (ViewModelKind = {}));\nexport const IController = DI.createInterface('IController').noDefault();\n/**\n * Describing characteristics of a mounting operation a controller will perform\n */\nexport var MountStrategy;\n(function (MountStrategy) {\n    MountStrategy[MountStrategy[\"insertBefore\"] = 1] = \"insertBefore\";\n    MountStrategy[MountStrategy[\"append\"] = 2] = \"append\";\n})(MountStrategy || (MountStrategy = {}));\nexport const IViewFactory = DI.createInterface('IViewFactory').noDefault();\nexport const ILifecycle = DI.createInterface('ILifecycle').withDefault(x => x.singleton(Lifecycle));\nlet BoundQueue = class BoundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevBound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextBound = controller; // implied by boundHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevBound !== void 0) {\n            controller.prevBound.nextBound = controller.nextBound;\n        }\n        if (controller.nextBound !== void 0) {\n            controller.nextBound.prevBound = controller.prevBound;\n        }\n        controller.prevBound = void 0;\n        controller.nextBound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevBound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextBound;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterBind(flags);\n                next = cur.nextBound;\n                cur.nextBound = void 0;\n                cur.prevBound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nBoundQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], BoundQueue);\nexport { BoundQueue };\nlet UnboundQueue = class UnboundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnbound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnbound = controller; // implied by unboundHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevUnbound !== void 0) {\n            controller.prevUnbound.nextUnbound = controller.nextUnbound;\n        }\n        if (controller.nextUnbound !== void 0) {\n            controller.nextUnbound.prevUnbound = controller.prevUnbound;\n        }\n        controller.prevUnbound = void 0;\n        controller.nextUnbound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnbound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnbound;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterUnbind(flags);\n                next = cur.nextUnbound;\n                cur.nextUnbound = void 0;\n                cur.prevUnbound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnboundQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], UnboundQueue);\nexport { UnboundQueue };\nlet AttachedQueue = class AttachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.mount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevAttached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextAttached = controller; // implied by attachedHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevAttached !== void 0) {\n            controller.prevAttached.nextAttached = controller.nextAttached;\n        }\n        if (controller.nextAttached !== void 0) {\n            controller.nextAttached.prevAttached = controller.prevAttached;\n        }\n        controller.prevAttached = void 0;\n        controller.nextAttached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevAttached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextAttached;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterAttach(flags);\n                next = cur.nextAttached;\n                cur.nextAttached = void 0;\n                cur.prevAttached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nAttachedQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], AttachedQueue);\nexport { AttachedQueue };\nlet DetachedQueue = class DetachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.unmount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevDetached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextDetached = controller; // implied by detachedHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevDetached !== void 0) {\n            controller.prevDetached.nextDetached = controller.nextDetached;\n        }\n        if (controller.nextDetached !== void 0) {\n            controller.nextDetached.prevDetached = controller.prevDetached;\n        }\n        controller.prevDetached = void 0;\n        controller.nextDetached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevDetached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextDetached;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterDetach(flags);\n                next = cur.nextDetached;\n                cur.nextDetached = void 0;\n                cur.prevDetached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nDetachedQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], DetachedQueue);\nexport { DetachedQueue };\nlet MountQueue = class MountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevMount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextMount = controller; // implied by mountHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevMount !== void 0) {\n            controller.prevMount.nextMount = controller.nextMount;\n        }\n        if (controller.nextMount !== void 0) {\n            controller.nextMount.prevMount = controller.prevMount;\n        }\n        controller.prevMount = void 0;\n        controller.nextMount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevMount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextMount;\n        }\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                ++i;\n                cur.mount(flags);\n                next = cur.nextMount;\n                cur.nextMount = void 0;\n                cur.prevMount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nMountQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], MountQueue);\nexport { MountQueue };\nlet UnmountQueue = class UnmountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnmount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnmount = controller; // implied by unmountHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevUnmount !== void 0) {\n            controller.prevUnmount.nextUnmount = controller.nextUnmount;\n        }\n        if (controller.nextUnmount !== void 0) {\n            controller.nextUnmount.prevUnmount = controller.prevUnmount;\n        }\n        controller.prevUnmount = void 0;\n        controller.nextUnmount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnmount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnmount;\n        }\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                ++i;\n                cur.unmount(flags);\n                next = cur.nextUnmount;\n                cur.nextUnmount = void 0;\n                cur.prevUnmount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnmountQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], UnmountQueue);\nexport { UnmountQueue };\nlet BatchQueue = class BatchQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.queue = [];\n        this.depth = 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(requestor) {\n        this.queue.push(requestor);\n    }\n    remove(requestor) {\n        const index = this.queue.indexOf(requestor);\n        if (index > -1) {\n            this.queue.splice(index, 1);\n        }\n    }\n    process(flags) {\n        flags |= 512 /* fromBatch */;\n        while (this.queue.length > 0) {\n            const batch = this.queue.slice();\n            this.queue = [];\n            const { length } = batch;\n            for (let i = 0; i < length; ++i) {\n                batch[i].flushBatch(flags);\n            }\n        }\n    }\n};\nBatchQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], BatchQueue);\nexport { BatchQueue };\nexport class Lifecycle {\n    constructor() {\n        this.batch = new BatchQueue(this);\n        this.mount = new MountQueue(this);\n        this.unmount = new UnmountQueue(this);\n        this.afterBind = new BoundQueue(this);\n        this.afterUnbind = new UnboundQueue(this);\n        this.afterAttach = new AttachedQueue(this);\n        this.afterDetach = new DetachedQueue(this);\n    }\n    static register(container) {\n        return Registration.singleton(ILifecycle, this).register(container);\n    }\n}\n//# sourceMappingURL=lifecycle.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { subscriberCollection } from './subscriber-collection';\n/**\n * Observer for the mutation of object property value employing getter-setter strategy.\n * This is used for observing object properties that has no decorator.\n */\nlet SetterObserver = class SetterObserver {\n    constructor(lifecycle, flags, obj, propertyKey) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        this.observing = false;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // If subscribe() has been called, the target property descriptor is replaced by these getter/setter methods,\n            // so calling obj[propertyKey] will actually return this.currentValue.\n            // However, if subscribe() was not yet called (indicated by !this.observing), the target descriptor\n            // is unmodified and we need to explicitly set the property value.\n            // This will happen in one-time, to-view and two-way bindings during $bind, meaning that the $bind will not actually update the target value.\n            // This wasn't visible in vCurrent due to connect-queue always doing a delayed update, so in many cases it didn't matter whether $bind updated the target or not.\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const currentValue = this.currentValue;\n        const oldValue = this.oldValue;\n        this.oldValue = currentValue;\n        this.callSubscribers(currentValue, oldValue, this.persistentFlags | flags);\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            this.currentValue = this.obj[this.propertyKey];\n            if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                enumerable: true,\n                configurable: true,\n                get: () => {\n                    return this.getValue();\n                },\n                set: value => {\n                    this.setValue(value, 0 /* none */);\n                },\n            })) {\n                Reporter.write(1, this.propertyKey, this.obj);\n            }\n        }\n        this.addSubscriber(subscriber);\n    }\n};\nSetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, String])\n], SetterObserver);\nexport { SetterObserver };\n//# sourceMappingURL=setter-observer.js.map","import { PLATFORM, Reporter } from '@aurelia/kernel';\nimport { ProxyObserver } from './proxy-observer';\nimport { SetterObserver } from './setter-observer';\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n    RuntimeError[RuntimeError[\"NilOverrideContext\"] = 252] = \"NilOverrideContext\";\n    RuntimeError[RuntimeError[\"NilParentScope\"] = 253] = \"NilParentScope\";\n})(RuntimeError || (RuntimeError = {}));\nconst marker = Object.freeze({});\n/** @internal */\nexport class InternalObserversLookup {\n    getOrCreate(lifecycle, flags, obj, key) {\n        if (this[key] === void 0) {\n            this[key] = new SetterObserver(lifecycle, flags, obj, key);\n        }\n        return this[key];\n    }\n}\nexport class BindingContext {\n    constructor(keyOrObj, value) {\n        this.$synthetic = true;\n        if (keyOrObj !== void 0) {\n            if (value !== void 0) {\n                // if value is defined then it's just a property and a value to initialize with\n                this[keyOrObj] = value;\n            }\n            else {\n                // can either be some random object or another bindingContext to clone from\n                for (const prop in keyOrObj) {\n                    if (Object.prototype.hasOwnProperty.call(keyOrObj, prop)) {\n                        this[prop] = keyOrObj[prop];\n                    }\n                }\n            }\n        }\n    }\n    static create(flags, keyOrObj, value) {\n        const bc = new BindingContext(keyOrObj, value);\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(bc).proxy;\n        }\n        return bc;\n    }\n    static get(scope, name, ancestor, flags, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */);\n        }\n        let overrideContext = scope.overrideContext;\n        if (ancestor > 0) {\n            // jump up the required number of ancestor contexts (eg $parent.$parent requires two jumps)\n            while (ancestor > 0) {\n                if (overrideContext.parentOverrideContext == null) {\n                    return void 0;\n                }\n                ancestor--;\n                overrideContext = overrideContext.parentOverrideContext;\n            }\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // traverse the context and it's ancestors, searching for a context that has the name.\n        while (overrideContext && !(name in overrideContext) && !(overrideContext.bindingContext && name in overrideContext.bindingContext)) {\n            overrideContext = overrideContext.parentOverrideContext;\n        }\n        if (overrideContext) {\n            // we located a context with the property.  return it.\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // the name wasn't found. see if parent scope traversal is allowed and if so, try that\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (parent.scopeParts.includes(part)) {\n                    const result = this.get(parent, name, ancestor, flags\n                        // unset the flag; only allow one level of scope boundary traversal\n                        & ~67108864 /* allowParentScopeTraversal */\n                        // tell the scope to return null if the name could not be found\n                        | 4194304 /* isTraversingParentScope */);\n                    if (result === marker) {\n                        return scope.bindingContext || scope.overrideContext;\n                    }\n                    else {\n                        return result;\n                    }\n                }\n                else {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope could be found for part \"${part}\"`);\n            }\n        }\n        // still nothing found. return the root binding context (or null\n        // if this is a parent scope traversal, to ensure we fall back to the\n        // correct level)\n        if (flags & 4194304 /* isTraversingParentScope */) {\n            return marker;\n        }\n        return scope.bindingContext || scope.overrideContext;\n    }\n    getObservers(flags) {\n        if (this.$observers == null) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\nexport class Scope {\n    constructor(parentScope, bindingContext, overrideContext) {\n        this.parentScope = parentScope;\n        this.scopeParts = PLATFORM.emptyArray;\n        this.bindingContext = bindingContext;\n        this.overrideContext = overrideContext;\n    }\n    static create(flags, bc, oc) {\n        return new Scope(null, bc, oc == null ? OverrideContext.create(flags, bc, oc) : oc);\n    }\n    static fromOverride(flags, oc) {\n        if (oc == null) {\n            throw Reporter.error(252 /* NilOverrideContext */);\n        }\n        return new Scope(null, oc.bindingContext, oc);\n    }\n    static fromParent(flags, ps, bc) {\n        if (ps == null) {\n            throw Reporter.error(253 /* NilParentScope */);\n        }\n        return new Scope(ps, bc, OverrideContext.create(flags, bc, ps.overrideContext));\n    }\n}\nexport class OverrideContext {\n    constructor(bindingContext, parentOverrideContext) {\n        this.$synthetic = true;\n        this.bindingContext = bindingContext;\n        this.parentOverrideContext = parentOverrideContext;\n    }\n    static create(flags, bc, poc) {\n        return new OverrideContext(bc, poc === void 0 ? null : poc);\n    }\n    getObservers() {\n        if (this.$observers === void 0) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\n//# sourceMappingURL=binding-context.js.map","import { DI } from '@aurelia/kernel';\nexport const ISignaler = DI.createInterface('ISignaler').withDefault(x => x.singleton(Signaler));\n/** @internal */\nexport class Signaler {\n    constructor() {\n        this.signals = Object.create(null);\n    }\n    dispatchSignal(name, flags) {\n        const listeners = this.signals[name];\n        if (listeners === undefined) {\n            return;\n        }\n        for (const listener of listeners.keys()) {\n            listener.handleChange(undefined, undefined, flags | 16 /* updateTargetInstance */);\n        }\n    }\n    addSignalListener(name, listener) {\n        const signals = this.signals;\n        const listeners = signals[name];\n        if (listeners === undefined) {\n            signals[name] = new Set([listener]);\n        }\n        else {\n            listeners.add(listener);\n        }\n    }\n    removeSignalListener(name, listener) {\n        const listeners = this.signals[name];\n        if (listeners) {\n            listeners.delete(listener);\n        }\n    }\n}\n//# sourceMappingURL=signaler.js.map","import { DI, Registration, Metadata, Protocol, } from '@aurelia/kernel';\n/**\n * TargetedInstructionType enum values become the property names for the associated renderers when they are injected\n * into the `Renderer`.\n *\n * Additional instruction types can be added as long as they are 2 characters long and do not clash with existing ones.\n *\n * By convention, the instruction types for a particular runtime start with the same first letter, and the second letter\n * starts counting from letter `a`. The standard runtime instruction types all start with the letter `r`.\n */\nexport var TargetedInstructionType;\n(function (TargetedInstructionType) {\n    TargetedInstructionType[\"hydrateElement\"] = \"ra\";\n    TargetedInstructionType[\"hydrateAttribute\"] = \"rb\";\n    TargetedInstructionType[\"hydrateTemplateController\"] = \"rc\";\n    TargetedInstructionType[\"hydrateLetElement\"] = \"rd\";\n    TargetedInstructionType[\"setProperty\"] = \"re\";\n    TargetedInstructionType[\"interpolation\"] = \"rf\";\n    TargetedInstructionType[\"propertyBinding\"] = \"rg\";\n    TargetedInstructionType[\"callBinding\"] = \"rh\";\n    TargetedInstructionType[\"letBinding\"] = \"ri\";\n    TargetedInstructionType[\"refBinding\"] = \"rj\";\n    TargetedInstructionType[\"iteratorBinding\"] = \"rk\";\n})(TargetedInstructionType || (TargetedInstructionType = {}));\nconst parentPartsOwnPartsLookup = new WeakMap();\n/**\n * Efficiently merge parts, performing the minimal amount of work / using the minimal amount of memory.\n *\n * If either of the two part records is undefined, the other will simply be returned.\n *\n * If both are undefined, undefined will be returned.\n *\n * If neither are undefined, a new object will be returned where parts of the second value will be written last (and thus may overwrite duplicate named parts).\n *\n * This function is idempotent via a WeakMap cache: results are cached and if the same two variables are provided again, the same object will be returned.\n */\nexport function mergeParts(parentParts, ownParts) {\n    if (parentParts === ownParts) {\n        return parentParts;\n    }\n    if (parentParts === void 0) {\n        return ownParts;\n    }\n    if (ownParts === void 0) {\n        return parentParts;\n    }\n    let ownPartsLookup = parentPartsOwnPartsLookup.get(parentParts);\n    if (ownPartsLookup === void 0) {\n        parentPartsOwnPartsLookup.set(parentParts, ownPartsLookup = new WeakMap());\n    }\n    let mergedParts = ownPartsLookup.get(ownParts);\n    if (mergedParts === void 0) {\n        ownPartsLookup.set(ownParts, mergedParts = {\n            ...parentParts,\n            ...ownParts,\n        });\n    }\n    return mergedParts;\n}\nexport const ITargetedInstruction = DI.createInterface('ITargetedInstruction').noDefault();\nexport function isTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\nexport class HooksDefinition {\n    constructor(target) {\n        this.hasCreate = 'create' in target;\n        this.hasBeforeCompile = 'beforeCompile' in target;\n        this.hasAfterCompile = 'afterCompile' in target;\n        this.hasAfterCompileChildren = 'afterCompileChildren' in target;\n        this.hasBeforeBind = 'beforeBind' in target;\n        this.hasAfterBind = 'afterBind' in target;\n        this.hasBeforeUnbind = 'beforeUnbind' in target;\n        this.hasAfterUnbind = 'afterUnbind' in target;\n        this.hasBeforeAttach = 'beforeAttach' in target;\n        this.hasAfterAttach = 'afterAttach' in target;\n        this.hasBeforeDetach = 'beforeDetach' in target;\n        this.hasAfterDetach = 'afterDetach' in target;\n        this.hasCaching = 'caching' in target;\n    }\n}\nHooksDefinition.none = new HooksDefinition({});\nexport function alias(...aliases) {\n    return function (target) {\n        const key = Protocol.annotation.keyFor('aliases');\n        const existing = Metadata.getOwn(key, target);\n        if (existing === void 0) {\n            Metadata.define(key, aliases, target);\n        }\n        else {\n            existing.push(...aliases);\n        }\n    };\n}\nexport function registerAliases(aliases, resource, key, container) {\n    for (let i = 0, ii = aliases.length; i < ii; ++i) {\n        Registration.aliasTo(key, resource.keyFrom(aliases[i])).register(container);\n    }\n}\n//# sourceMappingURL=definitions.js.map","// TODO: add connect-queue (or something similar) back in when everything else is working, to improve startup time\nconst slice = Array.prototype.slice;\nconst slotNames = [];\nconst versionSlotNames = [];\nlet lastSlot = -1;\nfunction ensureEnoughSlotNames(currentSlot) {\n    if (currentSlot === lastSlot) {\n        lastSlot += 5;\n        const ii = slotNames.length = versionSlotNames.length = lastSlot + 1;\n        for (let i = currentSlot + 1; i < ii; ++i) {\n            slotNames[i] = `_observer${i}`;\n            versionSlotNames[i] = `_observerVersion${i}`;\n        }\n    }\n}\nensureEnoughSlotNames(-1);\n/** @internal */\nexport function addObserver(observer) {\n    // find the observer.\n    const observerSlots = this.observerSlots == null ? 0 : this.observerSlots;\n    let i = observerSlots;\n    while (i-- && this[slotNames[i]] !== observer)\n        ;\n    // if we are not already observing, put the observer in an open slot and subscribe.\n    if (i === -1) {\n        i = 0;\n        while (this[slotNames[i]]) {\n            i++;\n        }\n        this[slotNames[i]] = observer;\n        observer.subscribe(this);\n        observer[this.id] |= 16 /* updateTargetInstance */;\n        // increment the slot count.\n        if (i === observerSlots) {\n            this.observerSlots = i + 1;\n        }\n    }\n    // set the \"version\" when the observer was used.\n    if (this.version == null) {\n        this.version = 0;\n    }\n    this[versionSlotNames[i]] = this.version;\n    ensureEnoughSlotNames(i);\n}\n/** @internal */\nexport function observeProperty(flags, obj, propertyName) {\n    const observer = this.observerLocator.getObserver(flags, obj, propertyName);\n    /* Note: we need to cast here because we can indeed get an accessor instead of an observer,\n     *  in which case the call to observer.subscribe will throw. It's not very clean and we can solve this in 2 ways:\n     *  1. Fail earlier: only let the locator resolve observers from .getObserver, and throw if no branches are left (e.g. it would otherwise return an accessor)\n     *  2. Fail silently (without throwing): give all accessors a no-op subscribe method\n     *\n     * We'll probably want to implement some global configuration (like a \"strict\" toggle) so users can pick between enforced correctness vs. ease-of-use\n     */\n    this.addObserver(observer);\n}\n/** @internal */\nexport function unobserve(all) {\n    const slots = this.observerSlots;\n    let slotName;\n    let observer;\n    if (all === true) {\n        for (let i = 0; i < slots; ++i) {\n            slotName = slotNames[i];\n            observer = this[slotName];\n            if (observer != null) {\n                this[slotName] = void 0;\n                observer.unsubscribe(this);\n                observer[this.id] &= ~16 /* updateTargetInstance */;\n            }\n        }\n    }\n    else {\n        const version = this.version;\n        for (let i = 0; i < slots; ++i) {\n            if (this[versionSlotNames[i]] !== version) {\n                slotName = slotNames[i];\n                observer = this[slotName];\n                if (observer != null) {\n                    this[slotName] = void 0;\n                    observer.unsubscribe(this);\n                    observer[this.id] &= ~16 /* updateTargetInstance */;\n                }\n            }\n        }\n    }\n}\nfunction connectableDecorator(target) {\n    const proto = target.prototype;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'observeProperty'))\n        proto.observeProperty = observeProperty;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'unobserve'))\n        proto.unobserve = unobserve;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'addObserver'))\n        proto.addObserver = addObserver;\n    return target;\n}\nexport function connectable(target) {\n    return target == null ? connectableDecorator : connectableDecorator(target);\n}\nlet value = 0;\nconnectable.assignIdTo = (instance) => {\n    instance.id = ++value;\n};\n// @connectable\nexport class BindingMediator {\n    constructor(key, binding, observerLocator, locator) {\n        this.key = key;\n        this.binding = binding;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.observeProperty = observeProperty;\n        this.unobserve = unobserve;\n        this.addObserver = addObserver;\n        connectable.assignIdTo(this);\n    }\n    $bind(flags, scope, part) {\n        throw new Error('Method not implemented.');\n    }\n    $unbind(flags) {\n        throw new Error('Method not implemented.');\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.binding[this.key](newValue, previousValue, flags);\n    }\n}\n//# sourceMappingURL=connectable.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Registration, Metadata, Protocol, mergeArrays, firstDefined, DI, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nimport { connectable } from '../binding/connectable';\nexport var BindingBehaviorStrategy;\n(function (BindingBehaviorStrategy) {\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"singleton\"] = 1] = \"singleton\";\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"interceptor\"] = 2] = \"interceptor\";\n})(BindingBehaviorStrategy || (BindingBehaviorStrategy = {}));\nexport function bindingBehavior(nameOrDef) {\n    return function (target) {\n        return BindingBehavior.define(nameOrDef, target);\n    };\n}\nexport class BindingBehaviorDefinition {\n    constructor(Type, name, aliases, key, strategy) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.strategy = strategy;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        const inheritsFromInterceptor = Object.getPrototypeOf(Type) === BindingInterceptor;\n        return new BindingBehaviorDefinition(Type, firstDefined(BindingBehavior.getAnnotation(Type, 'name'), name), mergeArrays(BindingBehavior.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingBehavior.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', def, Type, () => inheritsFromInterceptor ? 2 /* interceptor */ : 1 /* singleton */));\n    }\n    register(container) {\n        const { Type, key, aliases, strategy } = this;\n        switch (strategy) {\n            case 1 /* singleton */:\n                Registration.singleton(key, Type).register(container);\n                break;\n            case 2 /* interceptor */:\n                Registration.instance(key, new BindingBehaviorFactory(container, Type)).register(container);\n                break;\n        }\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, BindingBehavior, key, container);\n    }\n}\nexport class BindingBehaviorFactory {\n    constructor(container, Type) {\n        this.container = container;\n        this.Type = Type;\n        this.deps = DI.getDependencies(Type);\n    }\n    construct(binding, expr) {\n        const container = this.container;\n        const deps = this.deps;\n        switch (deps.length) {\n            case 0:\n            case 1:\n            case 2:\n                return new this.Type(binding, expr);\n            case 3:\n                return new this.Type(container.get(deps[0]), binding, expr);\n            case 4:\n                return new this.Type(container.get(deps[0]), container.get(deps[1]), binding, expr);\n            default:\n                return new this.Type(...deps.map(d => container.get(d)), binding, expr);\n        }\n    }\n}\nlet BindingInterceptor = class BindingInterceptor {\n    constructor(binding, expr) {\n        this.binding = binding;\n        this.expr = expr;\n        this.interceptor = this;\n        let interceptor;\n        while (binding.interceptor !== this) {\n            interceptor = binding.interceptor;\n            binding.interceptor = this;\n            binding = interceptor;\n        }\n    }\n    get id() {\n        return this.binding.id;\n    }\n    get observerLocator() {\n        return this.binding.observerLocator;\n    }\n    get locator() {\n        return this.binding.locator;\n    }\n    get $scope() {\n        return this.binding.$scope;\n    }\n    get part() {\n        return this.binding.part;\n    }\n    get $state() {\n        return this.binding.$state;\n    }\n    updateTarget(value, flags) {\n        this.binding.updateTarget(value, flags);\n    }\n    updateSource(value, flags) {\n        this.binding.updateSource(value, flags);\n    }\n    callSource(args) {\n        return this.binding.callSource(args);\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.binding.handleChange(newValue, previousValue, flags);\n    }\n    $bind(flags, scope, part) {\n        this.binding.$bind(flags, scope, part);\n    }\n    $unbind(flags) {\n        this.binding.$unbind(flags);\n    }\n};\nBindingInterceptor = __decorate([\n    connectable,\n    __metadata(\"design:paramtypes\", [Object, Object])\n], BindingInterceptor);\nexport { BindingInterceptor };\nexport const BindingBehavior = {\n    name: Protocol.resource.keyFor('binding-behavior'),\n    keyFrom(name) {\n        return `${BindingBehavior.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingBehavior.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingBehaviorDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingBehavior.name, definition, definition.Type);\n        Metadata.define(BindingBehavior.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingBehavior.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingBehavior.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=binding-behavior.js.map","import { Registration, Metadata, Protocol, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nexport function valueConverter(nameOrDef) {\n    return function (target) {\n        return ValueConverter.define(nameOrDef, target);\n    };\n}\nexport class ValueConverterDefinition {\n    constructor(Type, name, aliases, key) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new ValueConverterDefinition(Type, firstDefined(ValueConverter.getAnnotation(Type, 'name'), name), mergeArrays(ValueConverter.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), ValueConverter.keyFrom(name));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, ValueConverter, key, container);\n    }\n}\nexport const ValueConverter = {\n    name: Protocol.resource.keyFor('value-converter'),\n    keyFrom(name) {\n        return `${ValueConverter.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(ValueConverter.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = ValueConverterDefinition.create(nameOrDef, Type);\n        Metadata.define(ValueConverter.name, definition, definition.Type);\n        Metadata.define(ValueConverter.name, definition, definition);\n        Protocol.resource.appendTo(Type, ValueConverter.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(ValueConverter.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=value-converter.js.map","import { PLATFORM, Reporter, isNumberOrBigInt, isStringOrDate, } from '@aurelia/kernel';\nimport { BindingContext } from '../observation/binding-context';\nimport { ProxyObserver } from '../observation/proxy-observer';\nimport { ISignaler } from '../observation/signaler';\nimport { BindingBehavior, BindingBehaviorFactory, } from '../resources/binding-behavior';\nimport { ValueConverter, } from '../resources/value-converter';\nexport function connects(expr) {\n    return (expr.$kind & 32 /* Connects */) === 32 /* Connects */;\n}\nexport function observes(expr) {\n    return (expr.$kind & 64 /* Observes */) === 64 /* Observes */;\n}\nexport function callsFunction(expr) {\n    return (expr.$kind & 128 /* CallsFunction */) === 128 /* CallsFunction */;\n}\nexport function hasAncestor(expr) {\n    return (expr.$kind & 256 /* HasAncestor */) === 256 /* HasAncestor */;\n}\nexport function isAssignable(expr) {\n    return (expr.$kind & 8192 /* IsAssignable */) === 8192 /* IsAssignable */;\n}\nexport function isLeftHandSide(expr) {\n    return (expr.$kind & 1024 /* IsLeftHandSide */) === 1024 /* IsLeftHandSide */;\n}\nexport function isPrimary(expr) {\n    return (expr.$kind & 512 /* IsPrimary */) === 512 /* IsPrimary */;\n}\nexport function isResource(expr) {\n    return (expr.$kind & 32768 /* IsResource */) === 32768 /* IsResource */;\n}\nexport function hasBind(expr) {\n    return (expr.$kind & 2048 /* HasBind */) === 2048 /* HasBind */;\n}\nexport function hasUnbind(expr) {\n    return (expr.$kind & 4096 /* HasUnbind */) === 4096 /* HasUnbind */;\n}\nexport function isLiteral(expr) {\n    return (expr.$kind & 16384 /* IsLiteral */) === 16384 /* IsLiteral */;\n}\nexport function arePureLiterals(expressions) {\n    if (expressions === void 0 || expressions.length === 0) {\n        return true;\n    }\n    for (let i = 0; i < expressions.length; ++i) {\n        if (!isPureLiteral(expressions[i])) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function isPureLiteral(expr) {\n    if (isLiteral(expr)) {\n        switch (expr.$kind) {\n            case 17955 /* ArrayLiteral */:\n                return arePureLiterals(expr.elements);\n            case 17956 /* ObjectLiteral */:\n                return arePureLiterals(expr.values);\n            case 17958 /* Template */:\n                return arePureLiterals(expr.expressions);\n            case 17925 /* PrimitiveLiteral */:\n                return true;\n        }\n    }\n    return false;\n}\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NoLocator\"] = 202] = \"NoLocator\";\n    RuntimeError[RuntimeError[\"NoBehaviorFound\"] = 203] = \"NoBehaviorFound\";\n    RuntimeError[RuntimeError[\"BehaviorAlreadyApplied\"] = 204] = \"BehaviorAlreadyApplied\";\n    RuntimeError[RuntimeError[\"NoConverterFound\"] = 205] = \"NoConverterFound\";\n    RuntimeError[RuntimeError[\"NoBinding\"] = 206] = \"NoBinding\";\n    RuntimeError[RuntimeError[\"NotAFunction\"] = 207] = \"NotAFunction\";\n    RuntimeError[RuntimeError[\"UnknownOperator\"] = 208] = \"UnknownOperator\";\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n})(RuntimeError || (RuntimeError = {}));\nexport class CustomExpression {\n    constructor(value) {\n        this.value = value;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n}\nexport class BindingBehaviorExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 38962 /* BindingBehavior */;\n        this.behaviorKey = BindingBehavior.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        if (hasBind(this.expression)) {\n            this.expression.bind(flags, scope, binding);\n        }\n        const behaviorKey = this.behaviorKey;\n        const behavior = locator.get(behaviorKey);\n        if (!behavior) {\n            throw Reporter.error(203 /* NoBehaviorFound */, this);\n        }\n        if (!(behavior instanceof BindingBehaviorFactory)) {\n            if (binding[behaviorKey] === void 0) {\n                binding[behaviorKey] = behavior;\n                behavior.bind.call(behavior, flags, scope, binding, ...evalList(flags, scope, locator, this.args));\n            }\n            else {\n                Reporter.write(204 /* BehaviorAlreadyApplied */, this);\n            }\n        }\n    }\n    unbind(flags, scope, binding) {\n        const behaviorKey = this.behaviorKey;\n        if (binding[behaviorKey] !== void 0) {\n            binding[behaviorKey].unbind(flags, scope, binding);\n            binding[behaviorKey] = void 0;\n        }\n        if (hasUnbind(this.expression)) {\n            this.expression.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitBindingBehavior(this);\n    }\n}\nexport class ValueConverterExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 36913 /* ValueConverter */;\n        this.converterKey = ValueConverter.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('toView' in converter) {\n            const args = this.args;\n            const len = args.length;\n            const result = Array(len + 1);\n            result[0] = this.expression.evaluate(flags, scope, locator, part);\n            for (let i = 0; i < len; ++i) {\n                result[i + 1] = args[i].evaluate(flags, scope, locator, part);\n            }\n            return converter.toView.call(converter, ...result);\n        }\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('fromView' in converter) {\n            value = converter.fromView.call(converter, value, ...(evalList(flags, scope, locator, this.args)));\n        }\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        this.expression.connect(flags, scope, binding, part);\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.addSignalListener(signals[i], binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const locator = binding.locator;\n        const converter = locator.get(this.converterKey);\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.removeSignalListener(signals[i], binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitValueConverter(this);\n    }\n}\nexport class AssignExpression {\n    constructor(target, value) {\n        this.target = target;\n        this.value = value;\n        this.$kind = 8208 /* Assign */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.target.assign(flags, scope, locator, this.value.evaluate(flags, scope, locator), part);\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    assign(flags, scope, locator, value, part) {\n        this.value.assign(flags, scope, locator, value, part);\n        return this.target.assign(flags, scope, locator, value, part);\n    }\n    accept(visitor) {\n        return visitor.visitAssign(this);\n    }\n}\nexport class ConditionalExpression {\n    constructor(condition, yes, no) {\n        this.condition = condition;\n        this.yes = yes;\n        this.no = no;\n        this.$kind = 63 /* Conditional */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return (!!this.condition.evaluate(flags, scope, locator, part))\n            ? this.yes.evaluate(flags, scope, locator, part)\n            : this.no.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const condition = this.condition;\n        if (condition.evaluate(flags, scope, null, part)) {\n            this.condition.connect(flags, scope, binding, part);\n            this.yes.connect(flags, scope, binding, part);\n        }\n        else {\n            this.condition.connect(flags, scope, binding, part);\n            this.no.connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitConditional(this);\n    }\n}\nexport class AccessThisExpression {\n    constructor(ancestor = 0) {\n        this.ancestor = ancestor;\n        this.$kind = 1793 /* AccessThis */;\n    }\n    evaluate(flags, scope, locator, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (!parent.scopeParts.includes(part)) {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope cold be found for part \"${part}\"`);\n            }\n        }\n        let oc = scope.overrideContext;\n        let i = this.ancestor;\n        while (i-- && oc) {\n            oc = oc.parentOverrideContext;\n        }\n        return i < 1 && oc ? oc.bindingContext : void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitAccessThis(this);\n    }\n}\nAccessThisExpression.$this = new AccessThisExpression(0);\nAccessThisExpression.$parent = new AccessThisExpression(1);\nexport class AccessScopeExpression {\n    constructor(name, ancestor = 0) {\n        this.name = name;\n        this.ancestor = ancestor;\n        this.$kind = 10082 /* AccessScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const evaluatedValue = obj[this.name];\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return evaluatedValue;\n        }\n        return evaluatedValue == null ? '' : evaluatedValue;\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n                return value;\n            }\n            else {\n                return obj[this.name] = value;\n            }\n        }\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        binding.observeProperty(flags, context, this.name);\n    }\n    accept(visitor) {\n        return visitor.visitAccessScope(this);\n    }\n}\nexport class AccessMemberExpression {\n    constructor(object, name) {\n        this.object = object;\n        this.name = name;\n        this.$kind = 9323 /* AccessMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return instance == null ? instance : instance[this.name];\n        }\n        return instance ? instance[this.name] : '';\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = this.object.evaluate(flags, scope, locator, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n            }\n            else {\n                obj[this.name] = value;\n            }\n        }\n        else {\n            this.object.assign(flags, scope, locator, { [this.name]: value });\n        }\n        return value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            binding.observeProperty(flags, obj, this.name);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessMember(this);\n    }\n}\nexport class AccessKeyedExpression {\n    constructor(object, key) {\n        this.object = object;\n        this.key = key;\n        this.$kind = 9324 /* AccessKeyed */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (instance instanceof Object) {\n            const key = this.key.evaluate(flags, scope, locator, part);\n            return instance[key];\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, value, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const key = this.key.evaluate(flags, scope, locator, part);\n        return instance[key] = value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            this.key.connect(flags, scope, binding, part);\n            const key = this.key.evaluate(flags, scope, null, part);\n            // (note: string indexers behave the same way as numeric indexers as long as they represent numbers)\n            binding.observeProperty(flags, obj, key);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessKeyed(this);\n    }\n}\nexport class CallScopeExpression {\n    constructor(name, args, ancestor = 0) {\n        this.name = name;\n        this.args = args;\n        this.ancestor = ancestor;\n        this.$kind = 1448 /* CallScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const args = evalList(flags, scope, locator, this.args, part);\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const func = getFunction(flags, context, this.name);\n        if (func) {\n            return func.apply(context, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallScope(this);\n    }\n}\nexport class CallMemberExpression {\n    constructor(object, name, args) {\n        this.object = object;\n        this.name = name;\n        this.args = args;\n        this.$kind = 1161 /* CallMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const args = evalList(flags, scope, locator, this.args, part);\n        const func = getFunction(flags, instance, this.name);\n        if (func) {\n            return func.apply(instance, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (getFunction(flags & ~2097152 /* mustEvaluate */, obj, this.name)) {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallMember(this);\n    }\n}\nexport class CallFunctionExpression {\n    constructor(func, args) {\n        this.func = func;\n        this.args = args;\n        this.$kind = 1162 /* CallFunction */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func === 'function') {\n            return func(...evalList(flags, scope, locator, this.args, part));\n        }\n        if (!(flags & 2097152 /* mustEvaluate */) && (func == null)) {\n            return void 0;\n        }\n        throw Reporter.error(207 /* NotAFunction */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const func = this.func.evaluate(flags, scope, null, part);\n        this.func.connect(flags, scope, binding, part);\n        if (typeof func === 'function') {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallFunction(this);\n    }\n}\nexport class BinaryExpression {\n    constructor(operation, left, right) {\n        this.operation = operation;\n        this.left = left;\n        this.right = right;\n        this.$kind = 46 /* Binary */;\n        // what we're doing here is effectively moving the large switch statement from evaluate to the constructor\n        // so that the check only needs to be done once, and evaluate (which is called many times) will have a lot less\n        // work to do; we can do this because the operation can't change after it's parsed\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.left.connect(flags, scope, binding, part);\n        this.right.connect(flags, scope, binding, part);\n    }\n    ['&&'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) && this.right.evaluate(f, s, l, p);\n    }\n    ['||'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) || this.right.evaluate(f, s, l, p);\n    }\n    ['=='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) == this.right.evaluate(f, s, l, p);\n    }\n    ['==='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) === this.right.evaluate(f, s, l, p);\n    }\n    ['!='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) != this.right.evaluate(f, s, l, p);\n    }\n    ['!=='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) !== this.right.evaluate(f, s, l, p);\n    }\n    ['instanceof'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (typeof right === 'function') {\n            return this.left.evaluate(f, s, l, p) instanceof right;\n        }\n        return false;\n    }\n    ['in'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (right instanceof Object) {\n            return this.left.evaluate(f, s, l, p) in right;\n        }\n        return false;\n    }\n    // note: autoConvertAdd (and the null check) is removed because the default spec behavior is already largely similar\n    // and where it isn't, you kind of want it to behave like the spec anyway (e.g. return NaN when adding a number to undefined)\n    // this makes bugs in user code easier to track down for end users\n    // also, skipping these checks and leaving it to the runtime is a nice little perf boost and simplifies our code\n    ['+'](f, s, l, p) {\n        const left = this.left.evaluate(f, s, l, p);\n        const right = this.right.evaluate(f, s, l, p);\n        if ((f & 4 /* isStrictBindingStrategy */) > 0) {\n            return left + right;\n        }\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (!left || !right) {\n            if (isNumberOrBigInt(left) || isNumberOrBigInt(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || 0) + (right || 0);\n            }\n            if (isStringOrDate(left) || isStringOrDate(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || '') + (right || '');\n            }\n        }\n        return left + right;\n    }\n    ['-'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) - this.right.evaluate(f, s, l, p);\n    }\n    ['*'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) * this.right.evaluate(f, s, l, p);\n    }\n    ['/'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) / this.right.evaluate(f, s, l, p);\n    }\n    ['%'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) % this.right.evaluate(f, s, l, p);\n    }\n    ['<'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) < this.right.evaluate(f, s, l, p);\n    }\n    ['>'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) > this.right.evaluate(f, s, l, p);\n    }\n    ['<='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) <= this.right.evaluate(f, s, l, p);\n    }\n    ['>='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) >= this.right.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitBinary(this);\n    }\n}\nexport class UnaryExpression {\n    constructor(operation, expression) {\n        this.operation = operation;\n        this.expression = expression;\n        this.$kind = 39 /* Unary */;\n        // see Binary (we're doing the same thing here)\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    ['void'](f, s, l, p) {\n        return void this.expression.evaluate(f, s, l, p);\n    }\n    ['typeof'](f, s, l, p) {\n        return typeof this.expression.evaluate(f | 4 /* isStrictBindingStrategy */, s, l, p);\n    }\n    ['!'](f, s, l, p) {\n        return !this.expression.evaluate(f, s, l, p);\n    }\n    ['-'](f, s, l, p) {\n        return -this.expression.evaluate(f, s, l, p);\n    }\n    ['+'](f, s, l, p) {\n        return +this.expression.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitUnary(this);\n    }\n}\nexport class PrimitiveLiteralExpression {\n    constructor(value) {\n        this.value = value;\n        this.$kind = 17925 /* PrimitiveLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitPrimitiveLiteral(this);\n    }\n}\nPrimitiveLiteralExpression.$undefined = new PrimitiveLiteralExpression(void 0);\nPrimitiveLiteralExpression.$null = new PrimitiveLiteralExpression(null);\nPrimitiveLiteralExpression.$true = new PrimitiveLiteralExpression(true);\nPrimitiveLiteralExpression.$false = new PrimitiveLiteralExpression(false);\nPrimitiveLiteralExpression.$empty = new PrimitiveLiteralExpression('');\nexport class HtmlLiteralExpression {\n    constructor(parts) {\n        this.parts = parts;\n        this.$kind = 51 /* HtmlLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.parts;\n        let result = '';\n        let value;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            value = elements[i].evaluate(flags, scope, locator, part);\n            if (value == null) {\n                continue;\n            }\n            result += value;\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        for (let i = 0, ii = this.parts.length; i < ii; ++i) {\n            this.parts[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitHtmlLiteral(this);\n    }\n}\nexport class ArrayLiteralExpression {\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 17955 /* ArrayLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.elements;\n        const length = elements.length;\n        const result = Array(length);\n        for (let i = 0; i < length; ++i) {\n            result[i] = elements[i].evaluate(flags, scope, locator, part);\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const elements = this.elements;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            elements[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitArrayLiteral(this);\n    }\n}\nArrayLiteralExpression.$empty = new ArrayLiteralExpression(PLATFORM.emptyArray);\nexport class ObjectLiteralExpression {\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 17956 /* ObjectLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = {};\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            instance[keys[i]] = values[i].evaluate(flags, scope, locator, part);\n        }\n        return instance;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            values[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitObjectLiteral(this);\n    }\n}\nObjectLiteralExpression.$empty = new ObjectLiteralExpression(PLATFORM.emptyArray, PLATFORM.emptyArray);\nexport class TemplateExpression {\n    constructor(cooked, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.expressions = expressions;\n        this.$kind = 17958 /* Template */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const cooked = this.cooked;\n        let result = cooked[0];\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            result += expressions[i].evaluate(flags, scope, locator, part);\n            result += cooked[i + 1];\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding, part);\n            i++;\n        }\n    }\n    accept(visitor) {\n        return visitor.visitTemplate(this);\n    }\n}\nTemplateExpression.$empty = new TemplateExpression(['']);\nexport class TaggedTemplateExpression {\n    constructor(cooked, raw, func, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.func = func;\n        this.expressions = expressions;\n        this.$kind = 1197 /* TaggedTemplate */;\n        cooked.raw = raw;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const len = expressions.length;\n        const results = Array(len);\n        for (let i = 0, ii = len; i < ii; ++i) {\n            results[i] = expressions[i].evaluate(flags, scope, locator, part);\n        }\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func !== 'function') {\n            throw Reporter.error(207 /* NotAFunction */, this);\n        }\n        return func(this.cooked, ...results);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding);\n        }\n        this.func.connect(flags, scope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitTaggedTemplate(this);\n    }\n}\nexport class ArrayBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 65556 /* ArrayBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitArrayBindingPattern(this);\n    }\n}\nexport class ObjectBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 65557 /* ObjectBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitObjectBindingPattern(this);\n    }\n}\nexport class BindingIdentifier {\n    constructor(name) {\n        this.name = name;\n        this.$kind = 65558 /* BindingIdentifier */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.name;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitBindingIdentifier(this);\n    }\n}\nconst toStringTag = Object.prototype.toString;\n// https://tc39.github.io/ecma262/#sec-iteration-statements\n// https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements\nexport class ForOfStatement {\n    constructor(declaration, iterable) {\n        this.declaration = declaration;\n        this.iterable = iterable;\n        this.$kind = 6199 /* ForOfStatement */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.iterable.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    count(flags, result) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return result.length;\n            case '[object Map]': return result.size;\n            case '[object Set]': return result.size;\n            case '[object Number]': return result;\n            case '[object Null]': return 0;\n            case '[object Undefined]': return 0;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    iterate(flags, result, func) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return $array(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Map]': return $map(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Set]': return $set(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Number]': return $number(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Null]': return;\n            case '[object Undefined]': return;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    connect(flags, scope, binding, part) {\n        this.declaration.connect(flags, scope, binding, part);\n        this.iterable.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (hasBind(this.iterable)) {\n            this.iterable.bind(flags, scope, binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        if (hasUnbind(this.iterable)) {\n            this.iterable.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitForOfStatement(this);\n    }\n}\n/*\n* Note: this implementation is far simpler than the one in vCurrent and might be missing important stuff (not sure yet)\n* so while this implementation is identical to Template and we could reuse that one, we don't want to lock outselves in to potentially the wrong abstraction\n* but this class might be a candidate for removal if it turns out it does provide all we need\n*/\nexport class Interpolation {\n    constructor(parts, expressions = PLATFORM.emptyArray) {\n        this.parts = parts;\n        this.expressions = expressions;\n        this.$kind = 24 /* Interpolation */;\n        this.isMulti = expressions.length > 1;\n        this.firstExpression = expressions[0];\n    }\n    evaluate(flags, scope, locator, part) {\n        if (this.isMulti) {\n            const expressions = this.expressions;\n            const parts = this.parts;\n            let result = parts[0];\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                result += expressions[i].evaluate(flags, scope, locator, part);\n                result += parts[i + 1];\n            }\n            return result;\n        }\n        else {\n            const parts = this.parts;\n            return `${parts[0]}${this.firstExpression.evaluate(flags, scope, locator, part)}${parts[1]}`;\n        }\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitInterpolation(this);\n    }\n}\n/// Evaluate the [list] in context of the [scope].\nfunction evalList(flags, scope, locator, list, part) {\n    const len = list.length;\n    const result = Array(len);\n    for (let i = 0; i < len; ++i) {\n        result[i] = list[i].evaluate(flags, scope, locator, part);\n    }\n    return result;\n}\nfunction getFunction(flags, obj, name) {\n    const func = obj == null ? null : obj[name];\n    if (typeof func === 'function') {\n        return func;\n    }\n    if (!(flags & 2097152 /* mustEvaluate */) && func == null) {\n        return null;\n    }\n    throw Reporter.error(207 /* NotAFunction */, obj, name, func);\n}\nconst proxyAndOriginalArray = 2 /* proxyStrategy */ | 8388608 /* isOriginalArray */;\nfunction $array(flags, result, func) {\n    if ((flags & proxyAndOriginalArray) === proxyAndOriginalArray) {\n        // If we're in proxy mode, and the array is the original \"items\" (and not an array we created here to iterate over e.g. a set)\n        // then replace all items (which are Objects) with proxies so their properties are observed in the source view model even if no\n        // observers are explicitly created\n        const rawArray = ProxyObserver.getRawIfProxy(result);\n        const len = rawArray.length;\n        let item;\n        let i = 0;\n        for (; i < len; ++i) {\n            item = rawArray[i];\n            if (item instanceof Object) {\n                item = rawArray[i] = ProxyObserver.getOrCreate(item).proxy;\n            }\n            func(rawArray, i, item);\n        }\n    }\n    else {\n        for (let i = 0, ii = result.length; i < ii; ++i) {\n            func(result, i, result[i]);\n        }\n    }\n}\nfunction $map(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const entry of result.entries()) {\n        arr[++i] = entry;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $set(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const key of result.keys()) {\n        arr[++i] = key;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $number(flags, result, func) {\n    const arr = Array(result);\n    for (let i = 0; i < result; ++i) {\n        arr[i] = i;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\n//# sourceMappingURL=ast.js.map","/*\n* Note: the oneTime binding now has a non-zero value for 2 reasons:\n*  - plays nicer with bitwise operations (more consistent code, more explicit settings)\n*  - allows for potentially having something like BindingMode.oneTime | BindingMode.fromView, where an initial value is set once to the view but updates from the view also propagate back to the view model\n*\n* Furthermore, the \"default\" mode would be for simple \".bind\" expressions to make it explicit for our logic that the default is being used.\n* This essentially adds extra information which binding could use to do smarter things and allows bindingBehaviors that add a mode instead of simply overwriting it\n*/\nexport var BindingMode;\n(function (BindingMode) {\n    BindingMode[BindingMode[\"oneTime\"] = 1] = \"oneTime\";\n    BindingMode[BindingMode[\"toView\"] = 2] = \"toView\";\n    BindingMode[BindingMode[\"fromView\"] = 4] = \"fromView\";\n    BindingMode[BindingMode[\"twoWay\"] = 6] = \"twoWay\";\n    BindingMode[BindingMode[\"default\"] = 8] = \"default\";\n})(BindingMode || (BindingMode = {}));\nexport var BindingStrategy;\n(function (BindingStrategy) {\n    /**\n     * Configures all components \"below\" this one to operate in getterSetter binding mode.\n     * This is the default; if no strategy is specified, this one is implied.\n     *\n     * This strategy is the most compatible, convenient and has the best performance on frequently updated bindings on components that are infrequently replaced.\n     * However, it also consumes the most resources on initialization.\n     */\n    BindingStrategy[BindingStrategy[\"getterSetter\"] = 1] = \"getterSetter\";\n    /**\n     * Configures all components \"below\" this one to operate in proxy binding mode.\n     * No getters/setters are created.\n     *\n     * This strategy consumes significantly fewer resources than `getterSetter` on initialization and has the best performance on infrequently updated bindings on\n     * components that are frequently replaced.\n     * However, it consumes more resources on updates.\n     */\n    BindingStrategy[BindingStrategy[\"proxies\"] = 2] = \"proxies\";\n})(BindingStrategy || (BindingStrategy = {}));\nconst mandatoryStrategy = 1 /* getterSetter */ | 2 /* proxies */;\nexport function ensureValidStrategy(strategy) {\n    if ((strategy & mandatoryStrategy) === 0) {\n        // TODO: probably want to validate that user isn't trying to mix getterSetter/proxy\n        // TODO: also need to make sure that strategy can be changed away from proxies inside the component tree (not here though, but just making a note)\n        return strategy | 1 /* getterSetter */;\n    }\n    return strategy;\n}\nexport var State;\n(function (State) {\n    State[State[\"none\"] = 0] = \"none\";\n    State[State[\"isBinding\"] = 1] = \"isBinding\";\n    State[State[\"isUnbinding\"] = 2] = \"isUnbinding\";\n    State[State[\"isBound\"] = 4] = \"isBound\";\n    State[State[\"isBoundOrBinding\"] = 5] = \"isBoundOrBinding\";\n    State[State[\"isBoundOrUnbinding\"] = 6] = \"isBoundOrUnbinding\";\n    State[State[\"isAttaching\"] = 8] = \"isAttaching\";\n    State[State[\"isDetaching\"] = 16] = \"isDetaching\";\n    State[State[\"isAttached\"] = 32] = \"isAttached\";\n    State[State[\"isAttachedOrAttaching\"] = 40] = \"isAttachedOrAttaching\";\n    State[State[\"isAttachedOrDetaching\"] = 48] = \"isAttachedOrDetaching\";\n    State[State[\"isMounted\"] = 64] = \"isMounted\";\n    State[State[\"hasLockedScope\"] = 256] = \"hasLockedScope\";\n    State[State[\"canBeCached\"] = 512] = \"canBeCached\";\n})(State || (State = {}));\nexport var LifecycleFlags;\n(function (LifecycleFlags) {\n    LifecycleFlags[LifecycleFlags[\"none\"] = 0] = \"none\";\n    // Bitmask for flags that need to be stored on a binding during $bind for mutation\n    // callbacks outside of $bind\n    LifecycleFlags[LifecycleFlags[\"persistentBindingFlags\"] = 2080374799] = \"persistentBindingFlags\";\n    LifecycleFlags[LifecycleFlags[\"allowParentScopeTraversal\"] = 67108864] = \"allowParentScopeTraversal\";\n    LifecycleFlags[LifecycleFlags[\"observeLeafPropertiesOnly\"] = 134217728] = \"observeLeafPropertiesOnly\";\n    LifecycleFlags[LifecycleFlags[\"targetObserverFlags\"] = 805306383] = \"targetObserverFlags\";\n    LifecycleFlags[LifecycleFlags[\"noTargetObserverQueue\"] = 268435456] = \"noTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"persistentTargetObserverQueue\"] = 536870912] = \"persistentTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"secondaryExpression\"] = 1073741824] = \"secondaryExpression\";\n    LifecycleFlags[LifecycleFlags[\"bindingStrategy\"] = 15] = \"bindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"getterSetterStrategy\"] = 1] = \"getterSetterStrategy\";\n    LifecycleFlags[LifecycleFlags[\"proxyStrategy\"] = 2] = \"proxyStrategy\";\n    LifecycleFlags[LifecycleFlags[\"isStrictBindingStrategy\"] = 4] = \"isStrictBindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"update\"] = 48] = \"update\";\n    LifecycleFlags[LifecycleFlags[\"updateTargetInstance\"] = 16] = \"updateTargetInstance\";\n    LifecycleFlags[LifecycleFlags[\"updateSourceExpression\"] = 32] = \"updateSourceExpression\";\n    LifecycleFlags[LifecycleFlags[\"from\"] = 524224] = \"from\";\n    LifecycleFlags[LifecycleFlags[\"fromFlush\"] = 960] = \"fromFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromAsyncFlush\"] = 64] = \"fromAsyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromSyncFlush\"] = 128] = \"fromSyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromTick\"] = 256] = \"fromTick\";\n    LifecycleFlags[LifecycleFlags[\"fromBatch\"] = 512] = \"fromBatch\";\n    LifecycleFlags[LifecycleFlags[\"fromStartTask\"] = 1024] = \"fromStartTask\";\n    LifecycleFlags[LifecycleFlags[\"fromStopTask\"] = 2048] = \"fromStopTask\";\n    LifecycleFlags[LifecycleFlags[\"fromBind\"] = 4096] = \"fromBind\";\n    LifecycleFlags[LifecycleFlags[\"fromUnbind\"] = 8192] = \"fromUnbind\";\n    LifecycleFlags[LifecycleFlags[\"fromAttach\"] = 16384] = \"fromAttach\";\n    LifecycleFlags[LifecycleFlags[\"fromDetach\"] = 32768] = \"fromDetach\";\n    LifecycleFlags[LifecycleFlags[\"fromCache\"] = 65536] = \"fromCache\";\n    LifecycleFlags[LifecycleFlags[\"fromDOMEvent\"] = 131072] = \"fromDOMEvent\";\n    LifecycleFlags[LifecycleFlags[\"fromLifecycleTask\"] = 262144] = \"fromLifecycleTask\";\n    LifecycleFlags[LifecycleFlags[\"allowPublishRoundtrip\"] = 524288] = \"allowPublishRoundtrip\";\n    LifecycleFlags[LifecycleFlags[\"isPublishing\"] = 1048576] = \"isPublishing\";\n    LifecycleFlags[LifecycleFlags[\"mustEvaluate\"] = 2097152] = \"mustEvaluate\";\n    LifecycleFlags[LifecycleFlags[\"isTraversingParentScope\"] = 4194304] = \"isTraversingParentScope\";\n    LifecycleFlags[LifecycleFlags[\"isOriginalArray\"] = 8388608] = \"isOriginalArray\";\n    LifecycleFlags[LifecycleFlags[\"isCollectionMutation\"] = 16777216] = \"isCollectionMutation\";\n    LifecycleFlags[LifecycleFlags[\"reorderNodes\"] = 33554432] = \"reorderNodes\";\n})(LifecycleFlags || (LifecycleFlags = {}));\nexport var ExpressionKind;\n(function (ExpressionKind) {\n    ExpressionKind[ExpressionKind[\"Connects\"] = 32] = \"Connects\";\n    ExpressionKind[ExpressionKind[\"Observes\"] = 64] = \"Observes\";\n    ExpressionKind[ExpressionKind[\"CallsFunction\"] = 128] = \"CallsFunction\";\n    ExpressionKind[ExpressionKind[\"HasAncestor\"] = 256] = \"HasAncestor\";\n    ExpressionKind[ExpressionKind[\"IsPrimary\"] = 512] = \"IsPrimary\";\n    ExpressionKind[ExpressionKind[\"IsLeftHandSide\"] = 1024] = \"IsLeftHandSide\";\n    ExpressionKind[ExpressionKind[\"HasBind\"] = 2048] = \"HasBind\";\n    ExpressionKind[ExpressionKind[\"HasUnbind\"] = 4096] = \"HasUnbind\";\n    ExpressionKind[ExpressionKind[\"IsAssignable\"] = 8192] = \"IsAssignable\";\n    ExpressionKind[ExpressionKind[\"IsLiteral\"] = 16384] = \"IsLiteral\";\n    ExpressionKind[ExpressionKind[\"IsResource\"] = 32768] = \"IsResource\";\n    ExpressionKind[ExpressionKind[\"IsForDeclaration\"] = 65536] = \"IsForDeclaration\";\n    ExpressionKind[ExpressionKind[\"Type\"] = 31] = \"Type\";\n    // ---------------------------------------------------------------------------------------------------------------------------\n    ExpressionKind[ExpressionKind[\"AccessThis\"] = 1793] = \"AccessThis\";\n    ExpressionKind[ExpressionKind[\"AccessScope\"] = 10082] = \"AccessScope\";\n    ExpressionKind[ExpressionKind[\"ArrayLiteral\"] = 17955] = \"ArrayLiteral\";\n    ExpressionKind[ExpressionKind[\"ObjectLiteral\"] = 17956] = \"ObjectLiteral\";\n    ExpressionKind[ExpressionKind[\"PrimitiveLiteral\"] = 17925] = \"PrimitiveLiteral\";\n    ExpressionKind[ExpressionKind[\"Template\"] = 17958] = \"Template\";\n    ExpressionKind[ExpressionKind[\"Unary\"] = 39] = \"Unary\";\n    ExpressionKind[ExpressionKind[\"CallScope\"] = 1448] = \"CallScope\";\n    ExpressionKind[ExpressionKind[\"CallMember\"] = 1161] = \"CallMember\";\n    ExpressionKind[ExpressionKind[\"CallFunction\"] = 1162] = \"CallFunction\";\n    ExpressionKind[ExpressionKind[\"AccessMember\"] = 9323] = \"AccessMember\";\n    ExpressionKind[ExpressionKind[\"AccessKeyed\"] = 9324] = \"AccessKeyed\";\n    ExpressionKind[ExpressionKind[\"TaggedTemplate\"] = 1197] = \"TaggedTemplate\";\n    ExpressionKind[ExpressionKind[\"Binary\"] = 46] = \"Binary\";\n    ExpressionKind[ExpressionKind[\"Conditional\"] = 63] = \"Conditional\";\n    ExpressionKind[ExpressionKind[\"Assign\"] = 8208] = \"Assign\";\n    ExpressionKind[ExpressionKind[\"ValueConverter\"] = 36913] = \"ValueConverter\";\n    ExpressionKind[ExpressionKind[\"BindingBehavior\"] = 38962] = \"BindingBehavior\";\n    ExpressionKind[ExpressionKind[\"HtmlLiteral\"] = 51] = \"HtmlLiteral\";\n    ExpressionKind[ExpressionKind[\"ArrayBindingPattern\"] = 65556] = \"ArrayBindingPattern\";\n    ExpressionKind[ExpressionKind[\"ObjectBindingPattern\"] = 65557] = \"ObjectBindingPattern\";\n    ExpressionKind[ExpressionKind[\"BindingIdentifier\"] = 65558] = \"BindingIdentifier\";\n    ExpressionKind[ExpressionKind[\"ForOfStatement\"] = 6199] = \"ForOfStatement\";\n    ExpressionKind[ExpressionKind[\"Interpolation\"] = 24] = \"Interpolation\"; //\n})(ExpressionKind || (ExpressionKind = {}));\n//# sourceMappingURL=flags.js.map","/** @internal */\nexport var SubscriberFlags;\n(function (SubscriberFlags) {\n    SubscriberFlags[SubscriberFlags[\"None\"] = 0] = \"None\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber0\"] = 1] = \"Subscriber0\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber1\"] = 2] = \"Subscriber1\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber2\"] = 4] = \"Subscriber2\";\n    SubscriberFlags[SubscriberFlags[\"SubscribersRest\"] = 8] = \"SubscribersRest\";\n    SubscriberFlags[SubscriberFlags[\"Any\"] = 15] = \"Any\";\n})(SubscriberFlags || (SubscriberFlags = {}));\nexport var DelegationStrategy;\n(function (DelegationStrategy) {\n    DelegationStrategy[DelegationStrategy[\"none\"] = 0] = \"none\";\n    DelegationStrategy[DelegationStrategy[\"capturing\"] = 1] = \"capturing\";\n    DelegationStrategy[DelegationStrategy[\"bubbling\"] = 2] = \"bubbling\";\n})(DelegationStrategy || (DelegationStrategy = {}));\nexport var CollectionKind;\n(function (CollectionKind) {\n    CollectionKind[CollectionKind[\"indexed\"] = 8] = \"indexed\";\n    CollectionKind[CollectionKind[\"keyed\"] = 4] = \"keyed\";\n    CollectionKind[CollectionKind[\"array\"] = 9] = \"array\";\n    CollectionKind[CollectionKind[\"map\"] = 6] = \"map\";\n    CollectionKind[CollectionKind[\"set\"] = 7] = \"set\";\n})(CollectionKind || (CollectionKind = {}));\nexport function copyIndexMap(existing, deletedItems) {\n    const { length } = existing;\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = existing[i];\n        ++i;\n    }\n    if (deletedItems !== void 0) {\n        arr.deletedItems = deletedItems.slice(0);\n    }\n    else if (existing.deletedItems !== void 0) {\n        arr.deletedItems = existing.deletedItems.slice(0);\n    }\n    else {\n        arr.deletedItems = [];\n    }\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function createIndexMap(length = 0) {\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = i++;\n    }\n    arr.deletedItems = [];\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function cloneIndexMap(indexMap) {\n    const clone = indexMap.slice();\n    clone.deletedItems = indexMap.deletedItems.slice();\n    clone.isIndexMap = true;\n    return clone;\n}\nexport function isIndexMap(value) {\n    return value instanceof Array && value.isIndexMap === true;\n}\n//# sourceMappingURL=observation.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionLengthObserver = class CollectionLengthObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.length;\n    }\n    getValue() {\n        return this.obj.length;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionLengthObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Array])\n], CollectionLengthObserver);\nexport { CollectionLengthObserver };\n//# sourceMappingURL=collection-length-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionLengthObserver } from './collection-length-observer';\nimport { collectionSubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\n// https://tc39.github.io/ecma262/#sec-sortcompare\nfunction sortCompare(x, y) {\n    if (x === y) {\n        return 0;\n    }\n    x = x === null ? 'null' : x.toString();\n    y = y === null ? 'null' : y.toString();\n    return x < y ? -1 : 1;\n}\nfunction preSortCompare(x, y) {\n    if (x === void 0) {\n        if (y === void 0) {\n            return 0;\n        }\n        else {\n            return 1;\n        }\n    }\n    if (y === void 0) {\n        return -1;\n    }\n    return 0;\n}\nfunction insertionSort(arr, indexMap, from, to, compareFn) {\n    let velement, ielement, vtmp, itmp, order;\n    let i, j;\n    for (i = from + 1; i < to; i++) {\n        velement = arr[i];\n        ielement = indexMap[i];\n        for (j = i - 1; j >= from; j--) {\n            vtmp = arr[j];\n            itmp = indexMap[j];\n            order = compareFn(vtmp, velement);\n            if (order > 0) {\n                arr[j + 1] = vtmp;\n                indexMap[j + 1] = itmp;\n            }\n            else {\n                break;\n            }\n        }\n        arr[j + 1] = velement;\n        indexMap[j + 1] = ielement;\n    }\n}\nfunction quickSort(arr, indexMap, from, to, compareFn) {\n    let thirdIndex = 0, i = 0;\n    let v0, v1, v2;\n    let i0, i1, i2;\n    let c01, c02, c12;\n    let vtmp, itmp;\n    let vpivot, ipivot, lowEnd, highStart;\n    let velement, ielement, order, vtopElement;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        if (to - from <= 10) {\n            insertionSort(arr, indexMap, from, to, compareFn);\n            return;\n        }\n        thirdIndex = from + ((to - from) >> 1);\n        v0 = arr[from];\n        i0 = indexMap[from];\n        v1 = arr[to - 1];\n        i1 = indexMap[to - 1];\n        v2 = arr[thirdIndex];\n        i2 = indexMap[thirdIndex];\n        c01 = compareFn(v0, v1);\n        if (c01 > 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v1;\n            i0 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        c02 = compareFn(v0, v2);\n        if (c02 >= 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v2;\n            i0 = i2;\n            v2 = v1;\n            i2 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        else {\n            c12 = compareFn(v1, v2);\n            if (c12 > 0) {\n                vtmp = v1;\n                itmp = i1;\n                v1 = v2;\n                i1 = i2;\n                v2 = vtmp;\n                i2 = itmp;\n            }\n        }\n        arr[from] = v0;\n        indexMap[from] = i0;\n        arr[to - 1] = v2;\n        indexMap[to - 1] = i2;\n        vpivot = v1;\n        ipivot = i1;\n        lowEnd = from + 1;\n        highStart = to - 1;\n        arr[thirdIndex] = arr[lowEnd];\n        indexMap[thirdIndex] = indexMap[lowEnd];\n        arr[lowEnd] = vpivot;\n        indexMap[lowEnd] = ipivot;\n        partition: for (i = lowEnd + 1; i < highStart; i++) {\n            velement = arr[i];\n            ielement = indexMap[i];\n            order = compareFn(velement, vpivot);\n            if (order < 0) {\n                arr[i] = arr[lowEnd];\n                indexMap[i] = indexMap[lowEnd];\n                arr[lowEnd] = velement;\n                indexMap[lowEnd] = ielement;\n                lowEnd++;\n            }\n            else if (order > 0) {\n                do {\n                    highStart--;\n                    // eslint-disable-next-line eqeqeq\n                    if (highStart == i) {\n                        break partition;\n                    }\n                    vtopElement = arr[highStart];\n                    order = compareFn(vtopElement, vpivot);\n                } while (order > 0);\n                arr[i] = arr[highStart];\n                indexMap[i] = indexMap[highStart];\n                arr[highStart] = velement;\n                indexMap[highStart] = ielement;\n                if (order < 0) {\n                    velement = arr[i];\n                    ielement = indexMap[i];\n                    arr[i] = arr[lowEnd];\n                    indexMap[i] = indexMap[lowEnd];\n                    arr[lowEnd] = velement;\n                    indexMap[lowEnd] = ielement;\n                    lowEnd++;\n                }\n            }\n        }\n        if (to - highStart < lowEnd - from) {\n            quickSort(arr, indexMap, highStart, to, compareFn);\n            to = lowEnd;\n        }\n        else {\n            quickSort(arr, indexMap, from, lowEnd, compareFn);\n            from = highStart;\n        }\n    }\n}\nconst proto = Array.prototype;\nconst $push = proto.push;\nconst $unshift = proto.unshift;\nconst $pop = proto.pop;\nconst $shift = proto.shift;\nconst $splice = proto.splice;\nconst $reverse = proto.reverse;\nconst $sort = proto.sort;\nconst native = { push: $push, unshift: $unshift, pop: $pop, shift: $shift, splice: $splice, reverse: $reverse, sort: $sort };\nconst methods = ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'];\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-array.prototype.push\n    push: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $push.apply($this, args);\n        }\n        const len = $this.length;\n        const argCount = args.length;\n        if (argCount === 0) {\n            return len;\n        }\n        $this.length = o.indexMap.length = len + argCount;\n        let i = len;\n        while (i < $this.length) {\n            $this[i] = args[i - len];\n            o.indexMap[i] = -2;\n            i++;\n        }\n        o.notify();\n        return $this.length;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.unshift\n    unshift: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $unshift.apply($this, args);\n        }\n        const argCount = args.length;\n        const inserts = new Array(argCount);\n        let i = 0;\n        while (i < argCount) {\n            inserts[i++] = -2;\n        }\n        $unshift.apply(o.indexMap, inserts);\n        const len = $unshift.apply($this, args);\n        o.notify();\n        return len;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.pop\n    pop: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $pop.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $pop.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        const index = indexMap.length - 1;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        $pop.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.shift\n    shift: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $shift.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $shift.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        if (indexMap[0] > -1) {\n            indexMap.deletedItems.push(indexMap[0]);\n        }\n        $shift.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.splice\n    splice: function (...args) {\n        const start = args[0];\n        const deleteCount = args[1];\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $splice.apply($this, args);\n        }\n        const len = this.length;\n        const relativeStart = start | 0;\n        const actualStart = relativeStart < 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);\n        const indexMap = o.indexMap;\n        const argCount = args.length;\n        const actualDeleteCount = argCount === 0 ? 0 : argCount === 1 ? len - actualStart : deleteCount;\n        if (actualDeleteCount > 0) {\n            let i = actualStart;\n            const to = i + actualDeleteCount;\n            while (i < to) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n        }\n        if (argCount > 2) {\n            const itemCount = argCount - 2;\n            const inserts = new Array(itemCount);\n            let i = 0;\n            while (i < itemCount) {\n                inserts[i++] = -2;\n            }\n            $splice.call(indexMap, start, deleteCount, ...inserts);\n        }\n        else {\n            $splice.apply(indexMap, args);\n        }\n        const deleted = $splice.apply($this, args);\n        o.notify();\n        return deleted;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.reverse\n    reverse: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $reverse.call($this);\n            return this;\n        }\n        const len = $this.length;\n        const middle = (len / 2) | 0;\n        let lower = 0;\n        while (lower !== middle) {\n            const upper = len - lower - 1;\n            const lowerValue = $this[lower];\n            const lowerIndex = o.indexMap[lower];\n            const upperValue = $this[upper];\n            const upperIndex = o.indexMap[upper];\n            $this[lower] = upperValue;\n            o.indexMap[lower] = upperIndex;\n            $this[upper] = lowerValue;\n            o.indexMap[upper] = lowerIndex;\n            lower++;\n        }\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.sort\n    // https://github.com/v8/v8/blob/master/src/js/array.js\n    sort: function (compareFn) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $sort.call($this, compareFn);\n            return this;\n        }\n        const len = $this.length;\n        if (len < 2) {\n            return this;\n        }\n        quickSort($this, o.indexMap, 0, len, preSortCompare);\n        let i = 0;\n        while (i < len) {\n            if ($this[i] === void 0) {\n                break;\n            }\n            i++;\n        }\n        if (compareFn === void 0 || typeof compareFn !== 'function' /* spec says throw a TypeError, should we do that too? */) {\n            compareFn = sortCompare;\n        }\n        quickSort($this, o.indexMap, 0, i, compareFn);\n        o.notify();\n        return this;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableArrayObservationCalled = false;\nexport function enableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nlet ArrayObserver = class ArrayObserver {\n    constructor(flags, lifecycle, array) {\n        if (!enableArrayObservationCalled) {\n            enableArrayObservationCalled = true;\n            enableArrayObservation();\n        }\n        this.inBatch = false;\n        this.indexObservers = {};\n        this.collection = array;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(array.length);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(array, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionLengthObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        return this.getOrCreateIndexObserver(index);\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const indexMap = this.indexMap;\n        const length = this.collection.length;\n        this.indexMap = createIndexMap(length);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(length, 16 /* updateTargetInstance */);\n        }\n    }\n    /**\n     * @internal used by friend class ArrayIndexObserver only\n     */\n    addIndexObserver(indexObserver) {\n        this.addCollectionSubscriber(indexObserver);\n    }\n    /**\n     * @internal used by friend class ArrayIndexObserver only\n     */\n    removeIndexObserver(indexObserver) {\n        this.removeCollectionSubscriber(indexObserver);\n    }\n    /**\n     * @internal\n     */\n    getOrCreateIndexObserver(index) {\n        const indexObservers = this.indexObservers;\n        let observer = indexObservers[index];\n        if (observer === void 0) {\n            observer = indexObservers[index] = new ArrayIndexObserver(this, index);\n        }\n        return observer;\n    }\n};\nArrayObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], ArrayObserver);\nexport { ArrayObserver };\nlet ArrayIndexObserver = class ArrayIndexObserver {\n    constructor(owner, index) {\n        this.owner = owner;\n        this.index = index;\n        this.subscriberCount = 0;\n        this.currentValue = this.getValue();\n    }\n    getValue() {\n        return this.owner.collection[this.index];\n    }\n    setValue(newValue, flags) {\n        if (newValue === this.getValue()) {\n            return;\n        }\n        const arrayObserver = this.owner;\n        const index = this.index;\n        const indexMap = arrayObserver.indexMap;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        indexMap[index] = -2;\n        // do not need to update current value here\n        // as it will be updated inside handle collection change\n        arrayObserver.collection[index] = newValue;\n        arrayObserver.notify();\n    }\n    /**\n     * From interface `ICollectionSubscriber`\n     */\n    handleCollectionChange(indexMap, flags) {\n        const index = this.index;\n        const noChange = indexMap[index] === index;\n        if (noChange) {\n            return;\n        }\n        const prevValue = this.currentValue;\n        const currValue = this.currentValue = this.getValue();\n        // hmm\n        if (prevValue !== currValue) {\n            this.callSubscribers(currValue, prevValue, flags);\n        }\n    }\n    subscribe(subscriber) {\n        if (this.addSubscriber(subscriber) && ++this.subscriberCount === 1) {\n            this.owner.addIndexObserver(this);\n        }\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && --this.subscriberCount === 0) {\n            this.owner.removeIndexObserver(this);\n        }\n    }\n};\nArrayIndexObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [ArrayObserver, Number])\n], ArrayIndexObserver);\nexport { ArrayIndexObserver };\nexport function getArrayObserver(flags, lifecycle, array) {\n    const observer = observerLookup.get(array);\n    if (observer === void 0) {\n        return new ArrayObserver(flags, lifecycle, array);\n    }\n    return observer;\n}\n/**\n * Applies offsets to the non-negative indices in the IndexMap\n * based on added and deleted items relative to those indices.\n *\n * e.g. turn `[-2, 0, 1]` into `[-2, 1, 2]`, allowing the values at the indices to be\n * used for sorting/reordering items if needed\n */\nexport function applyMutationsToIndices(indexMap) {\n    let offset = 0;\n    let j = 0;\n    const len = indexMap.length;\n    for (let i = 0; i < len; ++i) {\n        while (indexMap.deletedItems[j] <= i - offset) {\n            ++j;\n            --offset;\n        }\n        if (indexMap[i] === -2) {\n            ++offset;\n        }\n        else {\n            indexMap[i] += offset;\n        }\n    }\n}\n/**\n * After `applyMutationsToIndices`, this function can be used to reorder items in a derived\n * array (e.g.  the items in the `views` in the repeater are derived from the `items` property)\n */\nexport function synchronizeIndices(items, indexMap) {\n    const copy = items.slice();\n    const len = indexMap.length;\n    let to = 0;\n    let from = 0;\n    while (to < len) {\n        from = indexMap[to];\n        if (from !== -2) {\n            items[to] = copy[from];\n        }\n        ++to;\n    }\n}\n//# sourceMappingURL=array-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n/* eslint-disable eqeqeq, compat/compat */\nimport { PLATFORM, Reporter, isArrayIndex } from '@aurelia/kernel';\nimport { IObserverLocator } from './observer-locator';\nimport { subscriberCollection } from './subscriber-collection';\nexport function computed(config) {\n    return function (target, key) {\n        /**\n         * The 'computed' property defined on prototype needs to be non-enumerable to prevent getting this in loops,\n         * iterating over object properties, such as for..in.\n         *\n         * The 'value' of the property should not have any prototype. Otherwise if by mistake the target passed\n         * here is `Object`, then we are in soup. Because then every instance of `Object` will have the `computed`\n         * property, including the `value` (in the descriptor of the property), when assigned `{}`. This might\n         * lead to infinite recursion for the cases as mentioned above.\n         */\n        if (target.computed == null) {\n            Reflect.defineProperty(target, 'computed', {\n                writable: true,\n                configurable: true,\n                enumerable: false,\n                value: Object.create(null)\n            });\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        target.computed[key] = config;\n    };\n}\nconst computedOverrideDefaults = { static: false, volatile: false };\n/* @internal */\nexport function createComputedObserver(flags, observerLocator, dirtyChecker, lifecycle, instance, propertyName, descriptor) {\n    if (descriptor.configurable === false) {\n        return dirtyChecker.createProperty(instance, propertyName);\n    }\n    if (descriptor.get != null) {\n        const { constructor: { prototype: { computed: givenOverrides } } } = instance;\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-type-assertion\n        const overrides = givenOverrides && givenOverrides[propertyName] || computedOverrideDefaults;\n        if (descriptor.set != null) {\n            if (overrides.volatile) {\n                return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n            }\n            return new CustomSetterObserver(instance, propertyName, descriptor);\n        }\n        return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n    }\n    throw Reporter.error(18, propertyName);\n}\n// Used when the getter is dependent solely on changes that happen within the setter.\nlet CustomSetterObserver = class CustomSetterObserver {\n    constructor(obj, propertyKey, descriptor) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.observing = false;\n    }\n    setValue(newValue) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion, @typescript-eslint/no-unnecessary-type-assertion\n        this.descriptor.set.call(this.obj, newValue); // Non-null is implied because descriptors without setters won't end up here\n        if (this.currentValue !== newValue) {\n            this.oldValue = this.currentValue;\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, this.oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.observing) {\n            this.convertProperty();\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n    }\n    convertProperty() {\n        this.observing = true;\n        this.currentValue = this.obj[this.propertyKey];\n        const set = (newValue) => { this.setValue(newValue); };\n        Reflect.defineProperty(this.obj, this.propertyKey, { set, get: this.descriptor.get });\n    }\n};\nCustomSetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, String, Object])\n], CustomSetterObserver);\nexport { CustomSetterObserver };\n// Used when there is no setter, and the getter is dependent on other properties of the object;\n// Used when there is a setter but the value of the getter can change based on properties set outside of the setter.\nlet GetterObserver = class GetterObserver {\n    constructor(flags, overrides, obj, propertyKey, descriptor, observerLocator) {\n        this.overrides = overrides;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.propertyDeps = [];\n        this.collectionDeps = [];\n        this.subscriberCount = 0;\n        this.isCollecting = false;\n        this.proxy = new Proxy(obj, createGetterTraps(flags, observerLocator, this));\n        const get = () => this.getValue();\n        Reflect.defineProperty(obj, propertyKey, { get, set: descriptor.set });\n    }\n    addPropertyDep(subscribable) {\n        if (!this.propertyDeps.includes(subscribable)) {\n            this.propertyDeps.push(subscribable);\n        }\n    }\n    addCollectionDep(subscribable) {\n        if (!this.collectionDeps.includes(subscribable)) {\n            this.collectionDeps.push(subscribable);\n        }\n    }\n    getValue() {\n        if (this.subscriberCount > 0 || this.isCollecting) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.proxy, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.obj, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        return this.currentValue;\n    }\n    subscribe(subscriber) {\n        this.addSubscriber(subscriber);\n        if (++this.subscriberCount === 1) {\n            this.getValueAndCollectDependencies(true);\n        }\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (--this.subscriberCount === 0) {\n            this.unsubscribeAllDependencies();\n        }\n    }\n    handleChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    handleCollectionChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    getValueAndCollectDependencies(requireCollect) {\n        const dynamicDependencies = !this.overrides.static || requireCollect;\n        if (dynamicDependencies) {\n            this.unsubscribeAllDependencies();\n            this.isCollecting = true;\n        }\n        this.currentValue = this.getValue();\n        if (dynamicDependencies) {\n            this.propertyDeps.forEach(x => { x.subscribe(this); });\n            this.collectionDeps.forEach(x => { x.subscribeToCollection(this); });\n            this.isCollecting = false;\n        }\n        return this.currentValue;\n    }\n    doNotCollect(target, key, receiver) {\n        return !this.isCollecting\n            || key === '$observers'\n            || key === '$synthetic'\n            || key === 'constructor';\n    }\n    unsubscribeAllDependencies() {\n        this.propertyDeps.forEach(x => { x.unsubscribe(this); });\n        this.propertyDeps.length = 0;\n        this.collectionDeps.forEach(x => { x.unsubscribeFromCollection(this); });\n        this.collectionDeps.length = 0;\n    }\n};\nGetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object, String, Object, Object])\n], GetterObserver);\nexport { GetterObserver };\nconst toStringTag = Object.prototype.toString;\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction createGetterTraps(flags, observerLocator, observer) {\n    return {\n        get: function (target, key, receiver) {\n            if (observer.doNotCollect(target, key, receiver)) {\n                return Reflect.get(target, key, receiver);\n            }\n            // The length and iterator properties need to be invoked on the original object\n            // (for Map and Set at least) or they will throw.\n            switch (toStringTag.call(target)) {\n                case '[object Array]':\n                    if (key === 'length' || isArrayIndex(key)) {\n                        observer.addCollectionDep(observerLocator.getArrayObserver(flags, target));\n                        return proxyOrValue(flags, target, key, observerLocator, observer);\n                    }\n                    break;\n                case '[object Map]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getMapObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n                case '[object Set]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getSetObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n            }\n            observer.addPropertyDep(observerLocator.getObserver(flags, target, key));\n            return proxyOrValue(flags, target, key, observerLocator, observer);\n        }\n    };\n}\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction proxyOrValue(flags, target, key, observerLocator, observer) {\n    const value = Reflect.get(target, key, target);\n    if (typeof value !== 'object' || typeof value === 'function' || value === null) {\n        return value;\n    }\n    return new Proxy(value, createGetterTraps(flags, observerLocator, observer));\n}\n//# sourceMappingURL=computed-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\nimport { IScheduler } from '@aurelia/scheduler';\nexport const IDirtyChecker = DI.createInterface('IDirtyChecker').withDefault(x => x.singleton(DirtyChecker));\nexport const DirtyCheckSettings = {\n    /**\n     * Default: `6`\n     *\n     * Adjust the global dirty check frequency.\n     * Measures in \"frames per check\", such that (given an FPS of 60):\n     * - A value of 1 will result in 60 dirty checks per second\n     * - A value of 6 will result in 10 dirty checks per second\n     */\n    framesPerCheck: 6,\n    /**\n     * Default: `false`\n     *\n     * Disable dirty-checking entirely. Properties that cannot be observed without dirty checking\n     * or an adapter, will simply not be observed.\n     */\n    disabled: false,\n    /**\n     * Default: `true`\n     *\n     * Log a warning message to the console if a property is being dirty-checked.\n     */\n    warn: true,\n    /**\n     * Default: `false`\n     *\n     * Throw an error if a property is being dirty-checked.\n     */\n    throw: false,\n    /**\n     * Resets all dirty checking settings to the framework's defaults.\n     */\n    resetToDefault() {\n        this.framesPerCheck = 6;\n        this.disabled = false;\n        this.warn = true;\n        this.throw = false;\n    }\n};\n/** @internal */\nlet DirtyChecker = class DirtyChecker {\n    constructor(scheduler) {\n        this.scheduler = scheduler;\n        this.tracked = [];\n        this.task = null;\n        this.elapsedFrames = 0;\n    }\n    createProperty(obj, propertyName) {\n        if (DirtyCheckSettings.throw) {\n            throw Reporter.error(800, propertyName); // TODO: create/organize error code\n        }\n        if (DirtyCheckSettings.warn) {\n            Reporter.write(801, propertyName);\n        }\n        return new DirtyCheckProperty(this, obj, propertyName);\n    }\n    addProperty(property) {\n        this.tracked.push(property);\n        if (this.tracked.length === 1) {\n            this.task = this.scheduler.queueRenderTask(() => this.check(), { persistent: true });\n        }\n    }\n    removeProperty(property) {\n        this.tracked.splice(this.tracked.indexOf(property), 1);\n        if (this.tracked.length === 0) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    check(delta) {\n        if (DirtyCheckSettings.disabled) {\n            return;\n        }\n        if (++this.elapsedFrames < DirtyCheckSettings.framesPerCheck) {\n            return;\n        }\n        this.elapsedFrames = 0;\n        const tracked = this.tracked;\n        const len = tracked.length;\n        let current;\n        let i = 0;\n        for (; i < len; ++i) {\n            current = tracked[i];\n            if (current.isDirty()) {\n                current.flush(256 /* fromTick */);\n            }\n        }\n    }\n};\nDirtyChecker = __decorate([\n    __param(0, IScheduler),\n    __metadata(\"design:paramtypes\", [Object])\n], DirtyChecker);\nexport { DirtyChecker };\nlet DirtyCheckProperty = class DirtyCheckProperty {\n    constructor(dirtyChecker, obj, propertyKey) {\n        this.dirtyChecker = dirtyChecker;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n    }\n    isDirty() {\n        return this.oldValue !== this.obj[this.propertyKey];\n    }\n    flush(flags) {\n        const oldValue = this.oldValue;\n        const newValue = this.obj[this.propertyKey];\n        this.callSubscribers(newValue, oldValue, flags | 16 /* updateTargetInstance */);\n        this.oldValue = newValue;\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.oldValue = this.obj[this.propertyKey];\n            this.dirtyChecker.addProperty(this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && !this.hasSubscribers()) {\n            this.dirtyChecker.removeProperty(this);\n        }\n    }\n};\nDirtyCheckProperty = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, String])\n], DirtyCheckProperty);\nexport { DirtyCheckProperty };\n//# sourceMappingURL=dirty-checker.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionSizeObserver = class CollectionSizeObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.size;\n    }\n    getValue() {\n        return this.obj.size;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionSizeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object])\n], CollectionSizeObserver);\nexport { CollectionSizeObserver };\n//# sourceMappingURL=collection-size-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Map.prototype;\nconst $set = proto.set;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { set: $set, clear: $clear, delete: $delete };\nconst methods = ['set', 'clear', 'delete'];\n// note: we can't really do much with Map due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, map/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-map.prototype.map\n    set: function (key, value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $set.call($this, key, value);\n            return this;\n        }\n        const oldValue = $this.get(key);\n        const oldSize = $this.size;\n        $set.call($this, key, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            let i = 0;\n            for (const entry of $this.entries()) {\n                if (entry[0] === key) {\n                    if (entry[1] !== oldValue) {\n                        o.indexMap.deletedItems.push(o.indexMap[i]);\n                        o.indexMap[i] = -2;\n                        o.notify();\n                    }\n                    return this;\n                }\n                i++;\n            }\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            ++i;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableMapObservationCalled = false;\nexport function enableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet MapObserver = class MapObserver {\n    constructor(flags, lifecycle, map) {\n        if (!enableMapObservationCalled) {\n            enableMapObservationCalled = true;\n            enableMapObservation();\n        }\n        this.inBatch = false;\n        this.collection = map;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(map.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(map, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        throw new Error('Map index observation not supported');\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nMapObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], MapObserver);\nexport { MapObserver };\nexport function getMapObserver(flags, lifecycle, map) {\n    const observer = observerLookup.get(map);\n    if (observer === void 0) {\n        return new MapObserver(flags, lifecycle, map);\n    }\n    return observer;\n}\n//# sourceMappingURL=map-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nconst slice = Array.prototype.slice;\nconst noop = PLATFORM.noop;\n// note: string.length is the only property of any primitive that is not a function,\n// so we can hardwire it to that and simply return undefined for anything else\n// note#2: a modified primitive constructor prototype would not work (and really, it shouldn't..)\nexport class PrimitiveObserver {\n    constructor(obj, propertyKey) {\n        this.doNotCache = true;\n        // we don't need to store propertyName because only 'length' can return a useful value\n        if (propertyKey === 'length') {\n            // deliberately not checking for typeof string as users probably still want to know via an error that their string is undefined\n            this.obj = obj;\n            this.getValue = this.getStringLength;\n        }\n        else {\n            this.getValue = this.returnUndefined;\n        }\n    }\n    getStringLength() {\n        return this.obj.length;\n    }\n    returnUndefined() {\n        return undefined;\n    }\n}\nPrimitiveObserver.prototype.setValue = noop;\nPrimitiveObserver.prototype.subscribe = noop;\nPrimitiveObserver.prototype.unsubscribe = noop;\nPrimitiveObserver.prototype.dispose = noop;\n//# sourceMappingURL=primitive-observer.js.map","export class PropertyAccessor {\n    constructor(obj, propertyKey) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        if (obj.$observers !== void 0\n            && obj.$observers[propertyKey] !== void 0\n            && obj.$observers[propertyKey].setValue !== void 0) {\n            this.setValue = this.setValueDirect;\n        }\n    }\n    getValue() {\n        return this.obj[this.propertyKey];\n    }\n    setValue(value, flags) {\n        this.obj[this.propertyKey] = value;\n    }\n    setValueDirect(value, flags) {\n        this.obj.$observers[this.propertyKey].setValue(value, flags);\n    }\n}\n//# sourceMappingURL=property-accessor.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Set.prototype;\nconst $add = proto.add;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { add: $add, clear: $clear, delete: $delete };\nconst methods = ['add', 'clear', 'delete'];\n// note: we can't really do much with Set due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, add/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-set.prototype.add\n    add: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $add.call($this, value);\n            return this;\n        }\n        const oldSize = $this.size;\n        $add.call($this, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            i++;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableSetObservationCalled = false;\nexport function enableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet SetObserver = class SetObserver {\n    constructor(flags, lifecycle, observedSet) {\n        if (!enableSetObservationCalled) {\n            enableSetObservationCalled = true;\n            enableSetObservation();\n        }\n        this.inBatch = false;\n        this.collection = observedSet;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(observedSet.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(observedSet, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        throw new Error('Set index observation not supported');\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nSetObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], SetObserver);\nexport { SetObserver };\nexport function getSetObserver(flags, lifecycle, observedSet) {\n    const observer = observerLookup.get(observedSet);\n    if (observer === void 0) {\n        return new SetObserver(flags, lifecycle, observedSet);\n    }\n    return observer;\n}\n//# sourceMappingURL=set-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration, Reporter, isArrayIndex, } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { getArrayObserver } from './array-observer';\nimport { createComputedObserver } from './computed-observer';\nimport { IDirtyChecker } from './dirty-checker';\nimport { getMapObserver } from './map-observer';\nimport { PrimitiveObserver } from './primitive-observer';\nimport { PropertyAccessor } from './property-accessor';\nimport { ProxyObserver } from './proxy-observer';\nimport { getSetObserver } from './set-observer';\nimport { SetterObserver } from './setter-observer';\nimport { IScheduler } from '@aurelia/scheduler';\nconst toStringTag = Object.prototype.toString;\nexport const IObserverLocator = DI.createInterface('IObserverLocator').noDefault();\nexport const ITargetObserverLocator = DI.createInterface('ITargetObserverLocator').noDefault();\nexport const ITargetAccessorLocator = DI.createInterface('ITargetAccessorLocator').noDefault();\nfunction getPropertyDescriptor(subject, name) {\n    let pd = Object.getOwnPropertyDescriptor(subject, name);\n    let proto = Object.getPrototypeOf(subject);\n    while (pd == null && proto != null) {\n        pd = Object.getOwnPropertyDescriptor(proto, name);\n        proto = Object.getPrototypeOf(proto);\n    }\n    return pd;\n}\n/** @internal */\nlet ObserverLocator = class ObserverLocator {\n    constructor(lifecycle, scheduler, dirtyChecker, targetObserverLocator, targetAccessorLocator) {\n        this.lifecycle = lifecycle;\n        this.scheduler = scheduler;\n        this.dirtyChecker = dirtyChecker;\n        this.targetObserverLocator = targetObserverLocator;\n        this.targetAccessorLocator = targetAccessorLocator;\n        this.adapters = [];\n    }\n    static register(container) {\n        return Registration.singleton(IObserverLocator, this).register(container);\n    }\n    getObserver(flags, obj, propertyName) {\n        if (flags & 2 /* proxyStrategy */ && typeof obj === 'object') {\n            return ProxyObserver.getOrCreate(obj, propertyName); // TODO: fix typings (and ensure proper contracts ofc)\n        }\n        if (isBindingContext(obj)) {\n            return obj.getObservers(flags).getOrCreate(this.lifecycle, flags, obj, propertyName);\n        }\n        let observersLookup = obj.$observers;\n        if (observersLookup && propertyName in observersLookup) {\n            return observersLookup[propertyName];\n        }\n        const observer = this.createPropertyObserver(flags, obj, propertyName);\n        if (!observer.doNotCache) {\n            if (observersLookup === void 0) {\n                observersLookup = this.getOrCreateObserversLookup(obj);\n            }\n            observersLookup[propertyName] = observer;\n        }\n        return observer;\n    }\n    addAdapter(adapter) {\n        this.adapters.push(adapter);\n    }\n    getAccessor(flags, obj, propertyName) {\n        if (this.targetAccessorLocator.handles(flags, obj)) {\n            if (this.targetObserverLocator.overridesAccessor(flags, obj, propertyName)) {\n                return this.getObserver(flags, obj, propertyName);\n            }\n            return this.targetAccessorLocator.getAccessor(flags, this.scheduler, this.lifecycle, obj, propertyName);\n        }\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(obj, propertyName);\n        }\n        return new PropertyAccessor(obj, propertyName);\n    }\n    getArrayObserver(flags, observedArray) {\n        return getArrayObserver(flags, this.lifecycle, observedArray);\n    }\n    getMapObserver(flags, observedMap) {\n        return getMapObserver(flags, this.lifecycle, observedMap);\n    }\n    getSetObserver(flags, observedSet) {\n        return getSetObserver(flags, this.lifecycle, observedSet);\n    }\n    getOrCreateObserversLookup(obj) {\n        return obj.$observers || this.createObserversLookup(obj);\n    }\n    createObserversLookup(obj) {\n        const value = {};\n        if (!Reflect.defineProperty(obj, '$observers', {\n            enumerable: false,\n            configurable: false,\n            writable: false,\n            value: value\n        })) {\n            Reporter.write(0, obj);\n        }\n        return value;\n    }\n    getAdapterObserver(flags, obj, propertyName, descriptor) {\n        for (let i = 0, ii = this.adapters.length; i < ii; i++) {\n            const adapter = this.adapters[i];\n            const observer = adapter.getObserver(flags, obj, propertyName, descriptor);\n            if (observer != null) {\n                return observer;\n            }\n        }\n        return null;\n    }\n    createPropertyObserver(flags, obj, propertyName) {\n        if (!(obj instanceof Object)) {\n            return new PrimitiveObserver(obj, propertyName);\n        }\n        let isNode = false;\n        if (this.targetObserverLocator.handles(flags, obj)) {\n            const observer = this.targetObserverLocator.getObserver(flags, this.scheduler, this.lifecycle, this, obj, propertyName);\n            if (observer != null) {\n                return observer;\n            }\n            isNode = true;\n        }\n        const tag = toStringTag.call(obj);\n        switch (tag) {\n            case '[object Array]':\n                if (propertyName === 'length') {\n                    return this.getArrayObserver(flags, obj).getLengthObserver();\n                }\n                // is numer only returns true for integer\n                if (isArrayIndex(propertyName)) {\n                    return this.getArrayObserver(flags, obj).getIndexObserver(Number(propertyName));\n                }\n                break;\n            case '[object Map]':\n                if (propertyName === 'size') {\n                    return this.getMapObserver(flags, obj).getLengthObserver();\n                }\n                break;\n            case '[object Set]':\n                if (propertyName === 'size') {\n                    return this.getSetObserver(flags, obj).getLengthObserver();\n                }\n                break;\n        }\n        const descriptor = getPropertyDescriptor(obj, propertyName);\n        if (descriptor != null && (descriptor.get != null || descriptor.set != null)) {\n            if (descriptor.get != null && descriptor.get.getObserver != null) {\n                return descriptor.get.getObserver(obj);\n            }\n            // attempt to use an adapter before resorting to dirty checking.\n            const adapterObserver = this.getAdapterObserver(flags, obj, propertyName, descriptor);\n            if (adapterObserver != null) {\n                return adapterObserver;\n            }\n            if (isNode) {\n                // TODO: use MutationObserver\n                return this.dirtyChecker.createProperty(obj, propertyName);\n            }\n            return createComputedObserver(flags, this, this.dirtyChecker, this.lifecycle, obj, propertyName, descriptor);\n        }\n        return new SetterObserver(this.lifecycle, flags, obj, propertyName);\n    }\n};\nObserverLocator = __decorate([\n    __param(0, ILifecycle),\n    __param(1, IScheduler),\n    __param(2, IDirtyChecker),\n    __param(3, ITargetObserverLocator),\n    __param(4, ITargetAccessorLocator),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object, Object])\n], ObserverLocator);\nexport { ObserverLocator };\nexport function getCollectionObserver(flags, lifecycle, collection) {\n    // If the collection is wrapped by a proxy then `$observer` will return the proxy observer instead of the collection observer, which is not what we want\n    // when we ask for getCollectionObserver\n    const rawCollection = collection instanceof Object ? ProxyObserver.getRawIfProxy(collection) : collection;\n    switch (toStringTag.call(collection)) {\n        case '[object Array]':\n            return getArrayObserver(flags, lifecycle, rawCollection);\n        case '[object Map]':\n            return getMapObserver(flags, lifecycle, rawCollection);\n        case '[object Set]':\n            return getSetObserver(flags, lifecycle, rawCollection);\n    }\n    return void 0;\n}\nfunction isBindingContext(obj) {\n    return obj.$synthetic === true;\n}\n//# sourceMappingURL=observer-locator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { ILifecycle } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { hasBind, hasUnbind, } from './ast';\nimport { connectable, } from './connectable';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nlet PropertyBinding = class PropertyBinding {\n    constructor(sourceExpression, target, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.targetObserver = void 0;\n        this.persistentFlags = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    ;\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags, this.$scope, this.locator, value, this.part);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if ((this.$state & 4 /* isBound */) === 0) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if ((flags & 16 /* updateTargetInstance */) > 0) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.interceptor.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n                this.interceptor.unobserve(false);\n            }\n            return;\n        }\n        if ((flags & 32 /* updateSourceExpression */) > 0) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.interceptor.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Force property binding to always be strict\n        flags |= 4 /* isStrictBindingStrategy */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            if (this.mode & fromView) {\n                targetObserver = this.targetObserver = this.observerLocator.getObserver(flags, this.target, this.targetProperty);\n            }\n            else {\n                targetObserver = this.targetObserver = this.observerLocator.getAccessor(flags, this.target, this.targetProperty);\n            }\n        }\n        if (this.mode !== BindingMode.oneTime && targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this.interceptor, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver.subscribe(this.interceptor);\n            if ((this.mode & toView) === 0) {\n                this.interceptor.updateSource(targetObserver.getValue(), flags);\n            }\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this.interceptor);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nPropertyBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, String, Number, Object, Object])\n], PropertyBinding);\nexport { PropertyBinding };\n//# sourceMappingURL=property-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class CallBinding {\n    constructor(sourceExpression, target, targetProperty, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.targetObserver = observerLocator.getObserver(0 /* none */, target, targetProperty);\n    }\n    callSource(args) {\n        const overrideContext = this.$scope.overrideContext;\n        Object.assign(overrideContext, args);\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        for (const prop in args) {\n            Reflect.deleteProperty(overrideContext, prop);\n        }\n        return result;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        this.targetObserver.setValue(($args) => this.interceptor.callSource($args), flags);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.targetObserver.setValue(null, flags);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=call-binding.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nimport { AccessMemberExpression, AccessScopeExpression, CallMemberExpression, CallScopeExpression, PrimitiveLiteralExpression, } from './ast';\nexport const IExpressionParser = DI.createInterface('IExpressionParser').withDefault(x => x.singleton(ExpressionParser));\n/** @internal */\nexport class ExpressionParser {\n    constructor() {\n        this.expressionLookup = Object.create(null);\n        this.forOfLookup = Object.create(null);\n        this.interpolationLookup = Object.create(null);\n    }\n    parse(expression, bindingType) {\n        switch (bindingType) {\n            case 2048 /* Interpolation */: {\n                let found = this.interpolationLookup[expression];\n                if (found === void 0) {\n                    found = this.interpolationLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            case 539 /* ForCommand */: {\n                let found = this.forOfLookup[expression];\n                if (found === void 0) {\n                    found = this.forOfLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            default: {\n                // Allow empty strings for normal bindings and those that are empty by default (such as a custom attribute without an equals sign)\n                // But don't cache it, because empty strings are always invalid for any other type of binding\n                if (expression.length === 0 && (bindingType & (53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */))) {\n                    return PrimitiveLiteralExpression.$empty;\n                }\n                let found = this.expressionLookup[expression];\n                if (found === void 0) {\n                    found = this.expressionLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n        }\n    }\n    cache(expressions) {\n        const { forOfLookup, expressionLookup, interpolationLookup } = this;\n        for (const expression in expressions) {\n            const expr = expressions[expression];\n            switch (expr.$kind) {\n                case 24 /* Interpolation */:\n                    interpolationLookup[expression] = expr;\n                    break;\n                case 6199 /* ForOfStatement */:\n                    forOfLookup[expression] = expr;\n                    break;\n                default:\n                    expressionLookup[expression] = expr;\n            }\n        }\n    }\n    parseCore(expression, bindingType) {\n        try {\n            const parts = expression.split('.');\n            const firstPart = parts[0];\n            let current;\n            if (firstPart.endsWith('()')) {\n                current = new CallScopeExpression(firstPart.replace('()', ''), PLATFORM.emptyArray);\n            }\n            else {\n                current = new AccessScopeExpression(parts[0]);\n            }\n            let index = 1;\n            while (index < parts.length) {\n                const currentPart = parts[index];\n                if (currentPart.endsWith('()')) {\n                    current = new CallMemberExpression(current, currentPart.replace('()', ''), PLATFORM.emptyArray);\n                }\n                else {\n                    current = new AccessMemberExpression(current, parts[index]);\n                }\n                index++;\n            }\n            return current;\n        }\n        catch (e) {\n            throw Reporter.error(3, e);\n        }\n    }\n}\n/* eslint-disable @typescript-eslint/indent */\nexport var BindingType;\n(function (BindingType) {\n    BindingType[BindingType[\"None\"] = 0] = \"None\";\n    BindingType[BindingType[\"IgnoreCustomAttr\"] = 4096] = \"IgnoreCustomAttr\";\n    BindingType[BindingType[\"Interpolation\"] = 2048] = \"Interpolation\";\n    BindingType[BindingType[\"IsRef\"] = 5376] = \"IsRef\";\n    BindingType[BindingType[\"IsIterator\"] = 512] = \"IsIterator\";\n    BindingType[BindingType[\"IsCustom\"] = 256] = \"IsCustom\";\n    BindingType[BindingType[\"IsFunction\"] = 128] = \"IsFunction\";\n    BindingType[BindingType[\"IsEvent\"] = 64] = \"IsEvent\";\n    BindingType[BindingType[\"IsProperty\"] = 32] = \"IsProperty\";\n    BindingType[BindingType[\"IsCommand\"] = 16] = \"IsCommand\";\n    BindingType[BindingType[\"IsPropertyCommand\"] = 48] = \"IsPropertyCommand\";\n    BindingType[BindingType[\"IsEventCommand\"] = 80] = \"IsEventCommand\";\n    BindingType[BindingType[\"DelegationStrategyDelta\"] = 6] = \"DelegationStrategyDelta\";\n    BindingType[BindingType[\"Command\"] = 15] = \"Command\";\n    BindingType[BindingType[\"OneTimeCommand\"] = 49] = \"OneTimeCommand\";\n    BindingType[BindingType[\"ToViewCommand\"] = 50] = \"ToViewCommand\";\n    BindingType[BindingType[\"FromViewCommand\"] = 51] = \"FromViewCommand\";\n    BindingType[BindingType[\"TwoWayCommand\"] = 52] = \"TwoWayCommand\";\n    BindingType[BindingType[\"BindCommand\"] = 53] = \"BindCommand\";\n    BindingType[BindingType[\"TriggerCommand\"] = 4182] = \"TriggerCommand\";\n    BindingType[BindingType[\"CaptureCommand\"] = 4183] = \"CaptureCommand\";\n    BindingType[BindingType[\"DelegateCommand\"] = 4184] = \"DelegateCommand\";\n    BindingType[BindingType[\"CallCommand\"] = 153] = \"CallCommand\";\n    BindingType[BindingType[\"OptionsCommand\"] = 26] = \"OptionsCommand\";\n    BindingType[BindingType[\"ForCommand\"] = 539] = \"ForCommand\";\n    BindingType[BindingType[\"CustomCommand\"] = 284] = \"CustomCommand\";\n})(BindingType || (BindingType = {}));\n/* eslint-enable @typescript-eslint/indent */\n//# sourceMappingURL=expression-parser.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nconst { toView, oneTime } = BindingMode;\nexport class MultiInterpolationBinding {\n    constructor(observerLocator, interpolation, target, targetProperty, mode, locator) {\n        this.observerLocator = observerLocator;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        // Note: the child expressions of an Interpolation expression are full Aurelia expressions, meaning they may include\n        // value converters and binding behaviors.\n        // Each expression represents one ${interpolation}, and for each we create a child TextBinding unless there is only one,\n        // in which case the renderer will create the TextBinding directly\n        const expressions = interpolation.expressions;\n        const parts = this.parts = Array(expressions.length);\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            parts[i] = new InterpolationBinding(expressions[i], interpolation, target, targetProperty, mode, observerLocator, locator, i === 0);\n        }\n    }\n    ;\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$bind(flags, scope, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        this.$scope = void 0;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$unbind(flags);\n        }\n    }\n}\nlet InterpolationBinding = class InterpolationBinding {\n    constructor(sourceExpression, interpolation, target, targetProperty, mode, observerLocator, locator, isFirst) {\n        this.sourceExpression = sourceExpression;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.isFirst = isFirst;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.targetObserver = observerLocator.getAccessor(0 /* none */, target, targetProperty);\n    }\n    updateTarget(value, flags) {\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        const previousValue = this.targetObserver.getValue();\n        const newValue = this.interpolation.evaluate(flags, this.$scope, this.locator, this.part);\n        if (newValue !== previousValue) {\n            this.interceptor.updateTarget(newValue, flags);\n        }\n        if ((this.mode & oneTime) === 0) {\n            this.version++;\n            this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n            this.interceptor.unobserve(false);\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        if (this.mode !== BindingMode.oneTime && this.targetObserver.bind) {\n            this.targetObserver.bind(flags);\n        }\n        // since the interpolation already gets the whole value, we only need to let the first\n        // text binding do the update if there are multiple\n        if (this.isFirst) {\n            this.interceptor.updateTarget(this.interpolation.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this.interceptor, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        this.$scope = void 0;\n        this.interceptor.unobserve(true);\n    }\n};\nInterpolationBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, String, Number, Object, Object, Boolean])\n], InterpolationBinding);\nexport { InterpolationBinding };\n//# sourceMappingURL=interpolation-binding.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { ILifecycle, } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nlet LetBinding = class LetBinding {\n    constructor(sourceExpression, targetProperty, observerLocator, locator, toBindingContext = false) {\n        this.sourceExpression = sourceExpression;\n        this.targetProperty = targetProperty;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.toBindingContext = toBindingContext;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.target = null;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const { target, targetProperty } = this;\n            const previousValue = target[targetProperty];\n            const newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            if (newValue !== previousValue) {\n                target[targetProperty] = newValue;\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        this.target = (this.toBindingContext ? scope.bindingContext : scope.overrideContext);\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        // sourceExpression might have been changed during bind\n        this.target[this.targetProperty] = this.sourceExpression.evaluate(flags | 4096 /* fromBind */, scope, this.locator, part);\n        this.sourceExpression.connect(flags, scope, this.interceptor, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nLetBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, String, Object, Object, Boolean])\n], LetBinding);\nexport { LetBinding };\n//# sourceMappingURL=let-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class RefBinding {\n    constructor(sourceExpression, target, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this);\n        }\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, this.target, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        let sourceExpression = this.sourceExpression;\n        if (sourceExpression.evaluate(flags, this.$scope, this.locator, this.part) === this.target) {\n            sourceExpression.assign(flags, this.$scope, this.locator, null, this.part);\n        }\n        // source expression might have been modified durring assign, via a BB\n        sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=ref-binding.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar BindableObserver_1;\nimport { Reporter, PLATFORM } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { ProxyObserver } from './proxy-observer';\nimport { subscriberCollection } from './subscriber-collection';\nlet BindableObserver = BindableObserver_1 = class BindableObserver {\n    constructor(lifecycle, flags, obj, propertyKey, cbName, $set) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.$set = $set;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        let isProxy = false;\n        if (ProxyObserver.isProxy(obj)) {\n            isProxy = true;\n            obj.$observer.subscribe(this, propertyKey);\n            this.obj = obj.$raw;\n        }\n        this.callback = this.obj[cbName];\n        const propertyChangedCallback = this.propertyChangedCallback = this.obj.propertyChanged;\n        const hasPropertyChangedCallback = this.hasPropertyChangedCallback = typeof propertyChangedCallback === 'function';\n        const shouldInterceptSet = this.shouldInterceptSet = $set !== PLATFORM.noop;\n        // when user declare @bindable({ set })\n        // it's expected to work from the start,\n        // regardless where the assignment comes from: either direct view model assignment or from binding during render\n        // so if either getter/setter config is present, alter the accessor straight await\n        if (this.callback === void 0 && !hasPropertyChangedCallback && !shouldInterceptSet) {\n            this.observing = false;\n        }\n        else {\n            this.observing = true;\n            const currentValue = obj[propertyKey];\n            this.currentValue = shouldInterceptSet && currentValue !== void 0\n                ? $set(currentValue)\n                : currentValue;\n            if (!isProxy) {\n                this.createGetterSetter();\n            }\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    handleChange(newValue, oldValue, flags) {\n        this.setValue(newValue, flags);\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.shouldInterceptSet) {\n            newValue = this.$set(newValue);\n        }\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            // eslint-disable-next-line compat/compat\n            if (Object.is(newValue, currentValue)) {\n                return;\n            }\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n                if ((flags & 4096 /* fromBind */) === 0 || (flags & 32 /* updateSourceExpression */) > 0) {\n                    const callback = this.callback;\n                    if (callback !== void 0) {\n                        callback.call(this.obj, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                    if (this.hasPropertyChangedCallback) {\n                        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                        this.propertyChangedCallback.call(this.obj, this.propertyKey, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                }\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // See SetterObserver.setValue for explanation\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            const currentValue = this.obj[this.propertyKey];\n            this.currentValue = this.shouldInterceptSet\n                ? this.$set(currentValue)\n                : currentValue;\n            this.createGetterSetter();\n        }\n        this.addSubscriber(subscriber);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.currentValue,\n            set: (value) => {\n                this.setValue(value, 0 /* none */);\n            }\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nBindableObserver = BindableObserver_1 = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, String, String, Function])\n], BindableObserver);\nexport { BindableObserver };\n//# sourceMappingURL=bindable-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { BindingMode } from '../../flags';\nimport { bindingBehavior } from '../binding-behavior';\nexport class BindingModeBehavior {\n    constructor(mode) {\n        this.mode = mode;\n        this.originalModes = new WeakMap();\n    }\n    bind(flags, scope, binding) {\n        this.originalModes.set(binding, binding.mode);\n        binding.mode = this.mode;\n    }\n    unbind(flags, scope, binding) {\n        binding.mode = this.originalModes.get(binding);\n    }\n}\nlet OneTimeBindingBehavior = class OneTimeBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.oneTime);\n    }\n};\nOneTimeBindingBehavior = __decorate([\n    bindingBehavior('oneTime'),\n    __metadata(\"design:paramtypes\", [])\n], OneTimeBindingBehavior);\nexport { OneTimeBindingBehavior };\nlet ToViewBindingBehavior = class ToViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.toView);\n    }\n};\nToViewBindingBehavior = __decorate([\n    bindingBehavior('toView'),\n    __metadata(\"design:paramtypes\", [])\n], ToViewBindingBehavior);\nexport { ToViewBindingBehavior };\nlet FromViewBindingBehavior = class FromViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.fromView);\n    }\n};\nFromViewBindingBehavior = __decorate([\n    bindingBehavior('fromView'),\n    __metadata(\"design:paramtypes\", [])\n], FromViewBindingBehavior);\nexport { FromViewBindingBehavior };\nlet TwoWayBindingBehavior = class TwoWayBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.twoWay);\n    }\n};\nTwoWayBindingBehavior = __decorate([\n    bindingBehavior('twoWay'),\n    __metadata(\"design:paramtypes\", [])\n], TwoWayBindingBehavior);\nexport { TwoWayBindingBehavior };\n//# sourceMappingURL=binding-mode.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler } from '@aurelia/scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet DebounceBindingBehavior = class DebounceBindingBehavior extends BindingInterceptor {\n    constructor(binding, expr) {\n        super(binding, expr);\n        this.opts = { delay: 0 };\n        this.firstArg = null;\n        this.task = null;\n        this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        if (expr.args.length > 0) {\n            this.firstArg = expr.args[0];\n        }\n    }\n    callSource(args) {\n        this.queueTask(() => this.binding.callSource(args));\n        return void 0;\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n    }\n    queueTask(callback) {\n        if (this.task !== null) {\n            this.task.cancel();\n        }\n        this.task = this.taskQueue.queueTask(callback, this.opts);\n    }\n    $bind(flags, scope, part) {\n        if (this.firstArg !== null) {\n            const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, part));\n            if (!isNaN(delay)) {\n                this.opts.delay = delay;\n            }\n        }\n        this.binding.$bind(flags, scope, part);\n    }\n};\nDebounceBindingBehavior = __decorate([\n    bindingBehavior('debounce'),\n    __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n], DebounceBindingBehavior);\nexport { DebounceBindingBehavior };\n//# sourceMappingURL=debounce.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { ISignaler } from '../../observation/signaler';\nimport { bindingBehavior } from '../binding-behavior';\nlet SignalBindingBehavior = class SignalBindingBehavior {\n    constructor(signaler) {\n        this.signaler = signaler;\n    }\n    bind(flags, scope, binding, ...args) {\n        if (!binding.updateTarget) {\n            throw Reporter.error(11);\n        }\n        if (arguments.length === 4) {\n            const name = args[0];\n            this.signaler.addSignalListener(name, binding);\n            binding.signal = name;\n        }\n        else if (arguments.length > 4) {\n            const names = Array.prototype.slice.call(args.length + 3, 3);\n            let i = names.length;\n            while (i--) {\n                const name = names[i];\n                this.signaler.addSignalListener(name, binding);\n            }\n            binding.signal = names;\n        }\n        else {\n            throw Reporter.error(12);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const name = binding.signal;\n        binding.signal = null;\n        if (Array.isArray(name)) {\n            const names = name;\n            let i = names.length;\n            while (i--) {\n                this.signaler.removeSignalListener(names[i], binding);\n            }\n        }\n        else {\n            this.signaler.removeSignalListener(name, binding);\n        }\n    }\n};\nSignalBindingBehavior = __decorate([\n    bindingBehavior('signal'),\n    __param(0, ISignaler),\n    __metadata(\"design:paramtypes\", [Object])\n], SignalBindingBehavior);\nexport { SignalBindingBehavior };\n//# sourceMappingURL=signals.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler, Now } from '@aurelia/scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet ThrottleBindingBehavior = class ThrottleBindingBehavior extends BindingInterceptor {\n    constructor(binding, expr) {\n        super(binding, expr);\n        this.opts = { delay: 0 };\n        this.firstArg = null;\n        this.task = null;\n        this.lastCall = 0;\n        this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        this.now = binding.locator.get(Now);\n        if (expr.args.length > 0) {\n            this.firstArg = expr.args[0];\n        }\n    }\n    callSource(args) {\n        this.queueTask(() => this.binding.callSource(args));\n        return void 0;\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n    }\n    queueTask(callback) {\n        const opts = this.opts;\n        const now = this.now;\n        const nextDelay = this.lastCall + opts.delay - now();\n        if (nextDelay > 0) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            opts.delay = nextDelay;\n            this.task = this.taskQueue.queueTask(() => {\n                this.lastCall = now();\n                callback();\n            }, opts);\n        }\n        else {\n            this.lastCall = now();\n            callback();\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.firstArg !== null) {\n            const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, part));\n            if (!isNaN(delay)) {\n                this.opts.delay = delay;\n            }\n        }\n        this.binding.$bind(flags, scope, part);\n    }\n};\nThrottleBindingBehavior = __decorate([\n    bindingBehavior('throttle'),\n    __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n], ThrottleBindingBehavior);\nexport { ThrottleBindingBehavior };\n//# sourceMappingURL=throttle.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { kebabCase, Metadata, Protocol, firstDefined, getPrototypeChain, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nexport function bindable(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @bindable\n            // Invocation with or w/o opts:\n            // - @bindable()\n            // - @bindable({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Bindable.name, BindableDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Bindable.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @bindable\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @bindable('bar')\n        // Direct call:\n        // - @bindable('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @bindable()\n    // - @bindable({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isBindableAnnotation(key) {\n    return key.startsWith(Bindable.name);\n}\nexport const Bindable = {\n    name: Protocol.annotation.keyFor('bindable'),\n    keyFrom(name) {\n        return `${Bindable.name}:${name}`;\n    },\n    from(...bindableLists) {\n        const bindables = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            bindables[name] = BindableDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            bindables[name] = def instanceof BindableDefinition ? def : BindableDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof BindableDefinition) {\n                bindables[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList[name]));\n            }\n        }\n        bindableLists.forEach(addList);\n        return bindables;\n    },\n    for(Type) {\n        let def;\n        const builder = {\n            add(configOrProp) {\n                let prop;\n                let config;\n                if (typeof configOrProp === 'string') {\n                    prop = configOrProp;\n                    config = { property: prop };\n                }\n                else {\n                    prop = configOrProp.property;\n                    config = configOrProp;\n                }\n                def = BindableDefinition.create(prop, config);\n                if (!Metadata.hasOwn(Bindable.name, Type, prop)) {\n                    Protocol.annotation.appendTo(Type, Bindable.keyFrom(prop));\n                }\n                Metadata.define(Bindable.name, def, Type, prop);\n                return builder;\n            },\n            mode(mode) {\n                def.mode = mode;\n                return builder;\n            },\n            callback(callback) {\n                def.callback = callback;\n                return builder;\n            },\n            attribute(attribute) {\n                def.attribute = attribute;\n                return builder;\n            },\n            primary() {\n                def.primary = true;\n                return builder;\n            },\n            set(setInterpreter) {\n                def.set = setInterpreter;\n                return builder;\n            }\n        };\n        return builder;\n    },\n    getAll(Type) {\n        const propStart = Bindable.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isBindableAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Bindable.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class BindableDefinition {\n    constructor(attribute, callback, mode, primary, property, set) {\n        this.attribute = attribute;\n        this.callback = callback;\n        this.mode = mode;\n        this.primary = primary;\n        this.property = property;\n        this.set = set;\n    }\n    static create(prop, def = {}) {\n        return new BindableDefinition(firstDefined(def.attribute, kebabCase(prop)), firstDefined(def.callback, `${prop}Changed`), firstDefined(def.mode, BindingMode.toView), firstDefined(def.primary, false), firstDefined(def.property, prop), firstDefined(def.set, PLATFORM.noop));\n    }\n}\n/* eslint-disable @typescript-eslint/no-unused-vars,spaced-comment */\n/**\n * This function serves two purposes:\n * - A playground for contributors to try their changes to the APIs.\n * - Cause the API surface to be properly type-checked and protected against accidental type regressions.\n *\n * It will be automatically removed by dead code elimination.\n */\nfunction apiTypeCheck() {\n    let Foo = \n    // > expected error - class decorator only accepts a string\n    //@bindable({})\n    class Foo {\n    };\n    __decorate([\n        bindable,\n        bindable(),\n        bindable({})\n        // > expected error - 'property' does not exist on decorator input object\n        //@bindable({ property: 'prop' })\n        ,\n        bindable({ mode: BindingMode.twoWay }),\n        bindable({ callback: 'propChanged' }),\n        bindable({ attribute: 'prop' }),\n        bindable({ primary: true }),\n        bindable({ set: value => String(value) }),\n        bindable({ set: value => Number(value) }),\n        bindable({\n            mode: BindingMode.twoWay,\n            callback: 'propChanged',\n            attribute: 'prop',\n            primary: true,\n            set: value => String(value)\n        }),\n        __metadata(\"design:type\", Object)\n    ], Foo.prototype, \"prop\", void 0);\n    Foo = __decorate([\n        bindable('prop')\n        // > expected error - class decorator only accepts a string\n        //@bindable({})\n    ], Foo);\n    Bindable.for(Foo)\n        // > expected error - there is no add() function with only optional params on the fluent api\n        //.add()\n        // > expected error - 'property' is a required property on the fluent api\n        //.add({})\n        .add({ property: 'prop' })\n        .add({ property: 'prop', mode: BindingMode.twoWay })\n        .add({ property: 'prop', callback: 'propChanged' })\n        .add({ property: 'prop', attribute: 'prop' })\n        .add({ property: 'prop', primary: true })\n        .add({ property: 'prop', mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n        .add('prop')\n        // > expected error - the add() method that accepts an object literal does not return a fluent api\n        //.add({ property: 'prop' }).mode(BindingMode.twoWay)\n        //.add({ property: 'prop' }).callback('propChanged')\n        //.add({ property: 'prop' }).attribute('prop')\n        //.add({ property: 'prop' }).primary()\n        // > expected error - fluent api methods can only be invoked once per bindable\n        //.add('prop').mode(BindingMode.twoWay).mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').callback('propChanged') // etc\n        // > expected error - wrong invocation order\n        //.add('prop').callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').primary().mode(BindingMode.twoWay)  // etc\n        .add('prop').mode(BindingMode.twoWay)\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop').primary()\n        .add('prop').mode(BindingMode.twoWay).set((value) => Number(value))\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').set(value => Number(value))\n        .add('prop').callback('propChanged')\n        .add('prop').callback('propChanged').attribute('prop')\n        .add('prop').callback('propChanged').attribute('prop').primary()\n        .add('prop').attribute('prop')\n        .add('prop').attribute('prop').primary()\n        .add('prop').primary();\n}\n/* eslint-enable @typescript-eslint/no-unused-vars,spaced-comment */\n//# sourceMappingURL=bindable.js.map","import { Registration, Protocol, Metadata, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { HooksDefinition, registerAliases, } from '../definitions';\nimport { BindingMode, } from '../flags';\nimport { Bindable } from '../templating/bindable';\nexport function customAttribute(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(nameOrDef, target);\n    };\n}\nexport function templateController(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(typeof nameOrDef === 'string'\n            ? { isTemplateController: true, name: nameOrDef }\n            : { isTemplateController: true, ...nameOrDef }, target);\n    };\n}\nexport class CustomAttributeDefinition {\n    constructor(Type, name, aliases, key, defaultBindingMode, isTemplateController, bindables, strategy, hooks, noMultiBindings) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.defaultBindingMode = defaultBindingMode;\n        this.isTemplateController = isTemplateController;\n        this.bindables = bindables;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.noMultiBindings = noMultiBindings;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new CustomAttributeDefinition(Type, firstDefined(CustomAttribute.getAnnotation(Type, 'name'), name), mergeArrays(CustomAttribute.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), CustomAttribute.keyFrom(name), firstDefined(CustomAttribute.getAnnotation(Type, 'defaultBindingMode'), def.defaultBindingMode, Type.defaultBindingMode, BindingMode.toView), firstDefined(CustomAttribute.getAnnotation(Type, 'isTemplateController'), def.isTemplateController, Type.isTemplateController, false), Bindable.from(...Bindable.getAll(Type), CustomAttribute.getAnnotation(Type, 'bindables'), Type.bindables, def.bindables), firstDefined(CustomAttribute.getAnnotation(Type, 'strategy'), def.strategy, Type.strategy, 1 /* getterSetter */), firstDefined(CustomAttribute.getAnnotation(Type, 'hooks'), def.hooks, Type.hooks, new HooksDefinition(Type.prototype)), firstDefined(CustomAttribute.getAnnotation(Type, 'noMultiBindings'), def.noMultiBindings, Type.noMultiBindings, false));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, CustomAttribute, key, container);\n    }\n}\nexport const CustomAttribute = {\n    name: Protocol.resource.keyFor('custom-attribute'),\n    keyFrom(name) {\n        return `${CustomAttribute.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomAttribute.name, value);\n    },\n    for(node, name) {\n        return Metadata.getOwn(CustomAttribute.keyFrom(name), node);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomAttributeDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomAttribute.name, definition, definition.Type);\n        Metadata.define(CustomAttribute.name, definition, definition);\n        Protocol.resource.appendTo(Type, CustomAttribute.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomAttribute.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=custom-attribute.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nexport const INode = DI.createInterface('INode').noDefault();\nexport const IRenderLocation = DI.createInterface('IRenderLocation').noDefault();\nexport const IDOM = DI.createInterface('IDOM').noDefault();\nconst ni = function (...args) {\n    throw Reporter.error(1000); // TODO: create error code (not implemented exception)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n}; // this function doesn't need typing because it is never directly called\nconst niDOM = {\n    addEventListener: ni,\n    appendChild: ni,\n    cloneNode: ni,\n    convertToRenderLocation: ni,\n    createDocumentFragment: ni,\n    createNodeSequence: ni,\n    createElement: ni,\n    createCustomEvent: ni,\n    dispatchEvent: ni,\n    createNodeObserver: ni,\n    createTemplate: ni,\n    createTextNode: ni,\n    getEffectiveParentNode: ni,\n    setEffectiveParentNode: ni,\n    insertBefore: ni,\n    isMarker: ni,\n    isNodeInstance: ni,\n    isRenderLocation: ni,\n    makeTarget: ni,\n    registerElementResolver: ni,\n    remove: ni,\n    removeEventListener: ni,\n    setAttribute: ni\n};\nexport const DOM = {\n    ...niDOM,\n    scheduler: (void 0),\n    get isInitialized() {\n        return Reflect.get(this, '$initialized') === true;\n    },\n    initialize(dom) {\n        if (this.isInitialized) {\n            throw Reporter.error(1001); // TODO: create error code (already initialized, check isInitialized property and call destroy() if you want to assign a different dom)\n        }\n        const descriptors = {};\n        const protos = [dom];\n        let proto = Object.getPrototypeOf(dom);\n        while (proto && proto !== Object.prototype) {\n            protos.unshift(proto);\n            proto = Object.getPrototypeOf(proto);\n        }\n        for (proto of protos) {\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(proto));\n        }\n        const keys = [];\n        let key;\n        let descriptor;\n        for (key in descriptors) {\n            descriptor = descriptors[key];\n            if (descriptor.configurable && descriptor.writable) {\n                Reflect.defineProperty(this, key, descriptor);\n                keys.push(key);\n            }\n        }\n        Reflect.set(this, '$domKeys', keys);\n        Reflect.set(this, '$initialized', true);\n    },\n    destroy() {\n        if (!this.isInitialized) {\n            throw Reporter.error(1002); // TODO: create error code (already destroyed)\n        }\n        const keys = Reflect.get(this, '$domKeys');\n        keys.forEach(key => {\n            Reflect.deleteProperty(this, key);\n        });\n        Object.assign(this, niDOM);\n        Reflect.set(this, '$domKeys', PLATFORM.emptyArray);\n        Reflect.set(this, '$initialized', false);\n    }\n};\n// This is an implementation of INodeSequence that represents \"no DOM\" to render.\n// It's used in various places to avoid null and to encode\n// the explicit idea of \"no view\".\nconst emptySequence = {\n    isMounted: false,\n    isLinked: false,\n    next: void 0,\n    childNodes: PLATFORM.emptyArray,\n    firstChild: null,\n    lastChild: null,\n    findTargets() { return PLATFORM.emptyArray; },\n    insertBefore(refNode) { },\n    appendTo(parent) { },\n    remove() { },\n    addToLinked() { },\n    unlink() { },\n    link(next) { },\n};\nexport const NodeSequence = {\n    empty: emptySequence\n};\n//# sourceMappingURL=dom.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nclass FlagsTemplateController {\n    constructor(factory, location, flags) {\n        this.factory = factory;\n        this.flags = flags;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | this.flags, this.$controller.scope);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n}\nlet InfrequentMutations = class InfrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 268435456 /* noTargetObserverQueue */);\n    }\n};\nInfrequentMutations = __decorate([\n    templateController('infrequent-mutations'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], InfrequentMutations);\nexport { InfrequentMutations };\nlet FrequentMutations = class FrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 536870912 /* persistentTargetObserverQueue */);\n    }\n};\nFrequentMutations = __decorate([\n    templateController('frequent-mutations'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], FrequentMutations);\nexport { FrequentMutations };\nlet ObserveShallow = class ObserveShallow extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 134217728 /* observeLeafPropertiesOnly */);\n    }\n};\nObserveShallow = __decorate([\n    templateController('observe-shallow'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], ObserveShallow);\nexport { ObserveShallow };\n//# sourceMappingURL=flags.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, IServiceLocator, Registration, } from '@aurelia/kernel';\nexport const LifecycleTask = {\n    done: {\n        done: true,\n        canCancel() { return false; },\n        cancel() { return; },\n        wait() { return Promise.resolve(); }\n    }\n};\nexport var TaskSlot;\n(function (TaskSlot) {\n    TaskSlot[TaskSlot[\"beforeCreate\"] = 0] = \"beforeCreate\";\n    TaskSlot[TaskSlot[\"beforeRender\"] = 1] = \"beforeRender\";\n    TaskSlot[TaskSlot[\"beforeBind\"] = 2] = \"beforeBind\";\n    TaskSlot[TaskSlot[\"beforeAttach\"] = 3] = \"beforeAttach\";\n})(TaskSlot || (TaskSlot = {}));\nexport const IStartTask = DI.createInterface('IStartTask').noDefault();\nvar TaskType;\n(function (TaskType) {\n    TaskType[TaskType[\"with\"] = 0] = \"with\";\n    TaskType[TaskType[\"from\"] = 1] = \"from\";\n})(TaskType || (TaskType = {}));\n// eslint-disable-next-line @typescript-eslint/class-name-casing\nexport const StartTask = class $StartTask {\n    constructor(type) {\n        this.type = type;\n        this._slot = void 0;\n        this._promiseOrTask = void 0;\n        this._container = void 0;\n        this._key = void 0;\n        this._callback = void 0;\n        this._task = void 0;\n    }\n    get slot() {\n        if (this._slot === void 0) {\n            throw new Error('StartTask.slot is not set');\n        }\n        return this._slot;\n    }\n    get promiseOrTask() {\n        if (this._promiseOrTask === void 0) {\n            throw new Error('StartTask.promiseOrTask is not set');\n        }\n        return this._promiseOrTask;\n    }\n    get container() {\n        if (this._container === void 0) {\n            throw new Error('StartTask.container is not set');\n        }\n        return this._container;\n    }\n    get key() {\n        if (this._key === void 0) {\n            throw new Error('StartTask.key is not set');\n        }\n        return this._key;\n    }\n    get callback() {\n        if (this._callback === void 0) {\n            throw new Error('StartTask.callback is not set');\n        }\n        return this._callback;\n    }\n    get task() {\n        if (this._task === void 0) {\n            throw new Error('StartTask.task is not set');\n        }\n        return this._task;\n    }\n    static with(key) {\n        const task = new $StartTask(0 /* with */);\n        task._key = key;\n        return task;\n    }\n    static from(promiseOrTask) {\n        const task = new $StartTask(1 /* from */);\n        task._promiseOrTask = promiseOrTask;\n        return task;\n    }\n    beforeCreate() {\n        return this.at(0 /* beforeCreate */);\n    }\n    beforeRender() {\n        return this.at(1 /* beforeRender */);\n    }\n    beforeBind() {\n        return this.at(2 /* beforeBind */);\n    }\n    beforeAttach() {\n        return this.at(3 /* beforeAttach */);\n    }\n    at(slot) {\n        this._slot = slot;\n        return this;\n    }\n    call(fn) {\n        this._callback = fn;\n        return this;\n    }\n    register(container) {\n        return this._container = container.register(Registration.instance(IStartTask, this));\n    }\n    resolveTask() {\n        if (this._task === void 0) {\n            switch (this.type) {\n                case 0 /* with */:\n                    this._task = new ProviderTask(this.container, this.key, this.callback);\n                    break;\n                case 1 /* from */:\n                    this._task = new TerminalTask(this.promiseOrTask);\n                    break;\n            }\n        }\n        return this.task;\n    }\n};\nexport const IStartTaskManager = DI.createInterface('IStartTaskManager').noDefault();\nlet StartTaskManager = class StartTaskManager {\n    constructor(locator) {\n        this.locator = locator;\n    }\n    static register(container) {\n        return Registration.singleton(IStartTaskManager, this).register(container);\n    }\n    runBeforeCreate(locator = this.locator) {\n        return this.run(0 /* beforeCreate */, locator);\n    }\n    runBeforeRender(locator = this.locator) {\n        return this.run(1 /* beforeRender */, locator);\n    }\n    runBeforeBind(locator = this.locator) {\n        return this.run(2 /* beforeBind */, locator);\n    }\n    runBeforeAttach(locator = this.locator) {\n        return this.run(3 /* beforeAttach */, locator);\n    }\n    run(slot, locator = this.locator) {\n        const tasks = locator.getAll(IStartTask)\n            .filter(startTask => startTask.slot === slot)\n            .map(startTask => startTask.resolveTask())\n            .filter(task => !task.done);\n        if (tasks.length === 0) {\n            return LifecycleTask.done;\n        }\n        return new AggregateTerminalTask(tasks);\n    }\n};\nStartTaskManager = __decorate([\n    __param(0, IServiceLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], StartTaskManager);\nexport { StartTaskManager };\nexport class PromiseTask {\n    constructor(promise, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = promise.then(value => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            if (next !== null) {\n                const nextResult = next.call(context, value, ...args);\n                if (nextResult === void 0) {\n                    this.done = true;\n                }\n                else {\n                    const nextPromise = nextResult.then instanceof Function\n                        ? nextResult\n                        : nextResult.wait();\n                    return nextPromise.then(() => {\n                        this.done = true;\n                    });\n                }\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class ProviderTask {\n    constructor(container, key, callback) {\n        this.container = container;\n        this.key = key;\n        this.callback = callback;\n        this.done = false;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        if (this.promise === void 0) {\n            const instance = this.container.get(this.key);\n            const maybePromiseOrTask = this.callback.call(void 0, instance);\n            this.promise = maybePromiseOrTask === void 0\n                ? Promise.resolve()\n                : maybePromiseOrTask.then instanceof Function\n                    ? maybePromiseOrTask\n                    : maybePromiseOrTask.wait();\n            this.promise = this.promise.then(() => {\n                this.done = true;\n                this.container = (void 0);\n                this.key = (void 0);\n                this.callback = (void 0);\n            }).catch(e => { throw e; });\n        }\n        return this.promise;\n    }\n}\nexport class ContinuationTask {\n    constructor(antecedent, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        const promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise = promise.then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                const nextPromise = nextResult.then instanceof Function\n                    ? nextResult\n                    : nextResult.wait();\n                return nextPromise.then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class TerminalTask {\n    constructor(antecedent) {\n        this.done = false;\n        this.promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise.then(() => {\n            this.done = true;\n        }).catch(e => { throw e; });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateContinuationTask {\n    constructor(antecedents, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                return nextResult.wait().then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateTerminalTask {\n    constructor(antecedents) {\n        this.done = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            this.done = true;\n        });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport function hasAsyncWork(value) {\n    return !(value === void 0 || value.done === true);\n}\n//# sourceMappingURL=lifecycle-task.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { ContinuationTask, LifecycleTask, PromiseTask } from '../../lifecycle-task';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet If = class If {\n    constructor(ifFactory, location) {\n        this.ifFactory = ifFactory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.elseFactory = void 0;\n        this.elseView = void 0;\n        this.ifView = void 0;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.value = false;\n    }\n    ;\n    beforeBind(flags) {\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    beforeUnbind(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        if (this.ifView !== void 0 && this.ifView.release(flags)) {\n            this.ifView = void 0;\n        }\n        if (this.elseView !== void 0 && this.elseView.release(flags)) {\n            this.elseView = void 0;\n        }\n        this.view = void 0;\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n    }\n    /** @internal */\n    updateView(value, flags) {\n        let view;\n        if (value) {\n            view = this.ifView = this.ensureView(this.ifView, this.ifFactory, flags);\n        }\n        else if (this.elseFactory != void 0) {\n            view = this.elseView = this.ensureView(this.elseView, this.elseFactory, flags);\n        }\n        else {\n            view = void 0;\n        }\n        return view;\n    }\n    /** @internal */\n    ensureView(view, factory, flags) {\n        if (view === void 0) {\n            view = factory.create(flags);\n        }\n        view.hold(this.location, 1 /* insertBefore */);\n        return view;\n    }\n    swap(value, flags) {\n        let task = LifecycleTask.done;\n        if ((value === true && this.elseView !== void 0)\n            || (value !== true && this.ifView !== void 0)) {\n            task = this.deactivate(flags);\n        }\n        if (task.done) {\n            const view = this.updateView(value, flags);\n            task = this.activate(view, flags);\n        }\n        else {\n            task = new PromiseTask(task.wait().then(() => this.updateView(value, flags)), this.activate, this, flags);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags); // TODO: link this up with unbind\n        const task = view.unbind(flags);\n        view.parent = void 0;\n        return task;\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if ((this.$controller.state & 32 /* isAttached */) === 0) {\n            return task;\n        }\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.view.parent = this.$controller;\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n            this.view.attach(flags);\n        }\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], If.prototype, \"value\", void 0);\nIf = __decorate([\n    templateController('if'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], If);\nexport { If };\nlet Else = class Else {\n    constructor(factory) {\n        this.factory = factory;\n        this.id = nextId('au$component');\n    }\n    link(ifBehavior) {\n        if (ifBehavior instanceof If) {\n            ifBehavior.elseFactory = this.factory;\n        }\n        else if (ifBehavior.viewModel instanceof If) {\n            ifBehavior.viewModel.elseFactory = this.factory;\n        }\n        else {\n            throw new Error(`Unsupported IfBehavior`); // TODO: create error code\n        }\n    }\n};\nElse = __decorate([\n    templateController('else'),\n    __param(0, IViewFactory),\n    __metadata(\"design:paramtypes\", [Object])\n], Else);\nexport { Else };\n//# sourceMappingURL=if.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { compareNumber, nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory, IController } from '../../lifecycle';\nimport { AggregateContinuationTask, ContinuationTask, LifecycleTask, } from '../../lifecycle-task';\nimport { applyMutationsToIndices, synchronizeIndices } from '../../observation/array-observer';\nimport { BindingContext, Scope } from '../../observation/binding-context';\nimport { getCollectionObserver } from '../../observation/observer-locator';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet Repeat = class Repeat {\n    constructor(location, renderable, factory) {\n        this.location = location;\n        this.renderable = renderable;\n        this.factory = factory;\n        this.id = nextId('au$component');\n        this.hasPendingInstanceMutation = false;\n        this.observer = void 0;\n        this.views = [];\n        this.key = void 0;\n        this.task = LifecycleTask.done;\n        this.normalizedItems = void 0;\n    }\n    beforeBind(flags) {\n        this.checkCollectionObserver(flags);\n        const bindings = this.renderable.bindings;\n        const { length } = bindings;\n        let binding;\n        for (let i = 0; i < length; ++i) {\n            binding = bindings[i];\n            if (binding.target === this && binding.targetProperty === 'items') {\n                this.forOf = binding.sourceExpression;\n                break;\n            }\n        }\n        this.local = this.forOf.declaration.evaluate(flags, this.$controller.scope, null);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachViews(void 0, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachViews, this, void 0, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.task.done) {\n            this.detachViewsByRange(0, this.views.length, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.detachViewsByRange, this, 0, this.views.length, flags);\n        }\n    }\n    beforeUnbind(flags) {\n        this.checkCollectionObserver(flags);\n        if (this.task.done) {\n            this.task = this.unbindAndRemoveViewsByRange(0, this.views.length, flags, false);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, this.views.length, flags, false);\n        }\n        return this.task;\n    }\n    // called by SetterObserver\n    itemsChanged(flags) {\n        flags |= this.$controller.flags;\n        this.checkCollectionObserver(flags);\n        flags |= 16 /* updateTargetInstance */;\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n    }\n    // called by a CollectionObserver\n    handleCollectionChange(indexMap, flags) {\n        flags |= this.$controller.flags;\n        flags |= (960 /* fromFlush */ | 16 /* updateTargetInstance */);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(indexMap, flags);\n    }\n    processViewsKeyed(indexMap, flags) {\n        const oldLength = this.views.length;\n        if (indexMap === void 0) {\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                this.detachViewsByRange(0, oldLength, flags);\n                if (this.task.done) {\n                    this.task = this.unbindAndRemoveViewsByRange(0, oldLength, flags, false);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, oldLength, flags, false);\n                }\n                if (this.task.done) {\n                    this.task = this.createAndBindAllViews(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindAllViews, this, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.attachViewsKeyed(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.attachViewsKeyed, this, flags);\n                }\n            }\n        }\n        else {\n            applyMutationsToIndices(indexMap);\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                // first detach+unbind+(remove from array) the deleted view indices\n                if (indexMap.deletedItems.length > 0) {\n                    indexMap.deletedItems.sort(compareNumber);\n                    if (this.task.done) {\n                        this.detachViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.detachViewsByKey, this, indexMap, flags);\n                    }\n                    if (this.task.done) {\n                        this.task = this.unbindAndRemoveViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByKey, this, indexMap, flags);\n                    }\n                }\n                // then insert new views at the \"added\" indices to bring the views array in aligment with indexMap size\n                if (this.task.done) {\n                    this.task = this.createAndBindNewViewsByKey(indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindNewViewsByKey, this, indexMap, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.sortViewsByKey(oldLength, indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.sortViewsByKey, this, oldLength, indexMap, flags);\n                }\n            }\n        }\n    }\n    // todo: subscribe to collection from inner expression\n    checkCollectionObserver(flags) {\n        const oldObserver = this.observer;\n        if ((flags & 8192 /* fromUnbind */)) {\n            if (oldObserver !== void 0) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n        }\n        else if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            const newObserver = this.observer = getCollectionObserver(flags, this.$controller.lifecycle, this.items);\n            if (oldObserver !== newObserver && oldObserver) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n            if (newObserver) {\n                newObserver.subscribeToCollection(this);\n            }\n        }\n    }\n    normalizeToArray(flags) {\n        const items = this.items;\n        if (items instanceof Array) {\n            this.normalizedItems = items;\n            return;\n        }\n        const forOf = this.forOf;\n        if (forOf === void 0) {\n            return;\n        }\n        const normalizedItems = [];\n        this.forOf.iterate(flags, items, (arr, index, item) => {\n            normalizedItems[index] = item;\n        });\n        this.normalizedItems = normalizedItems;\n    }\n    detachViewsByRange(iStart, iEnd, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.afterDetach.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.afterDetach.end(flags);\n    }\n    unbindAndRemoveViewsByRange(iStart, iEnd, flags, adjustLength) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.afterUnbind.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        if (adjustLength) {\n            this.views.length = iStart;\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.afterUnbind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.afterUnbind.end, this.$controller.lifecycle.afterUnbind, flags);\n    }\n    detachViewsByKey(indexMap, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.afterDetach.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        for (let i = 0; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.afterDetach.end(flags);\n    }\n    unbindAndRemoveViewsByKey(indexMap, flags) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.afterUnbind.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        let i = 0;\n        for (; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        i = 0;\n        let j = 0;\n        for (; i < deletedLen; ++i) {\n            j = deleted[i] - i;\n            this.views.splice(j, 1);\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.afterUnbind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.afterUnbind.end, this.$controller.lifecycle.afterUnbind, flags);\n    }\n    createAndBindAllViews(flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.afterBind.begin();\n        const part = $controller.part;\n        const factory = this.factory;\n        const local = this.local;\n        const items = this.items;\n        const newLen = this.forOf.count(flags, items);\n        const views = this.views = Array(newLen);\n        this.forOf.iterate(flags, items, (arr, i, item) => {\n            view = views[i] = factory.create(flags);\n            view.parent = $controller;\n            viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, item));\n            setContextualProperties(viewScope.overrideContext, i, newLen);\n            task = view.bind(flags, viewScope, part);\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        });\n        if (tasks === undefined) {\n            lifecycle.afterBind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.afterBind.end, lifecycle.afterBind, flags);\n    }\n    createAndBindNewViewsByKey(indexMap, flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const factory = this.factory;\n        const views = this.views;\n        const local = this.local;\n        const normalizedItems = this.normalizedItems;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.afterBind.begin();\n        const part = $controller.part;\n        const mapLen = indexMap.length;\n        for (let i = 0; i < mapLen; ++i) {\n            if (indexMap[i] === -2) {\n                view = factory.create(flags);\n                // TODO: test with map/set/undefined/null, make sure we can use strong typing here as well, etc\n                view.parent = $controller;\n                viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, normalizedItems[i]));\n                setContextualProperties(viewScope.overrideContext, i, mapLen);\n                // update all the rest oc\n                task = view.bind(flags, viewScope, part);\n                views.splice(i, 0, view);\n                if (!task.done) {\n                    if (tasks === undefined) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (views.length !== mapLen) {\n            // TODO: create error code and use reporter with more informative message\n            throw new Error(`viewsLen=${views.length}, mapLen=${mapLen}`);\n        }\n        if (tasks === undefined) {\n            lifecycle.afterBind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.afterBind.end, lifecycle.afterBind, flags);\n    }\n    attachViews(indexMap, flags) {\n        let view;\n        const views = this.views;\n        const location = this.location;\n        const lifecycle = this.$controller.lifecycle;\n        lifecycle.afterAttach.begin();\n        if (indexMap === void 0) {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                view = views[i];\n                view.hold(location, 1 /* insertBefore */);\n                view.nodes.unlink();\n                view.attach(flags);\n            }\n        }\n        else {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                if (indexMap[i] !== i) {\n                    view = views[i];\n                    view.hold(location, 1 /* insertBefore */);\n                    view.nodes.unlink();\n                    view.attach(flags);\n                }\n            }\n        }\n        lifecycle.afterAttach.end(flags);\n    }\n    attachViewsKeyed(flags) {\n        let view;\n        const { views, location } = this;\n        this.$controller.lifecycle.afterAttach.begin();\n        for (let i = 0, ii = views.length; i < ii; ++i) {\n            view = views[i];\n            view.hold(location, 1 /* insertBefore */);\n            view.nodes.unlink();\n            view.attach(flags);\n        }\n        this.$controller.lifecycle.afterAttach.end(flags);\n    }\n    sortViewsByKey(oldLength, indexMap, flags) {\n        // TODO: integrate with tasks\n        const location = this.location;\n        const views = this.views;\n        const newLen = indexMap.length;\n        synchronizeIndices(views, indexMap);\n        // this algorithm retrieves the indices of the longest increasing subsequence of items in the repeater\n        // the items on those indices are not moved; this minimizes the number of DOM operations that need to be performed\n        const seq = longestIncreasingSubsequence(indexMap);\n        const seqLen = seq.length;\n        this.$controller.lifecycle.afterAttach.begin();\n        flags |= 33554432 /* reorderNodes */;\n        let next;\n        let j = seqLen - 1;\n        let i = newLen - 1;\n        let view;\n        for (; i >= 0; --i) {\n            view = views[i];\n            if (indexMap[i] === -2) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.hold(location, 1 /* insertBefore */);\n                view.attach(flags);\n            }\n            else if (j < 0 || seqLen === 1 || i !== seq[j]) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.attach(flags);\n            }\n            else {\n                if (oldLength !== newLen) {\n                    setContextualProperties(view.scope.overrideContext, i, newLen);\n                }\n                --j;\n            }\n            next = views[i + 1];\n            if (next !== void 0) {\n                view.nodes.link(next.nodes);\n            }\n            else {\n                view.nodes.link(location);\n            }\n        }\n        this.$controller.lifecycle.afterAttach.end(flags);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], Repeat.prototype, \"items\", void 0);\nRepeat = __decorate([\n    templateController('repeat'),\n    __param(0, IRenderLocation),\n    __param(1, IController),\n    __param(2, IViewFactory),\n    __metadata(\"design:paramtypes\", [Object, Object, Object])\n], Repeat);\nexport { Repeat };\nlet maxLen = 16;\nlet prevIndices = new Int32Array(maxLen);\nlet tailIndices = new Int32Array(maxLen);\n// Based on inferno's lis_algorithm @ https://github.com/infernojs/inferno/blob/master/packages/inferno/src/DOM/patching.ts#L732\n// with some tweaks to make it just a bit faster + account for IndexMap (and some names changes for readability)\n/** @internal */\nexport function longestIncreasingSubsequence(indexMap) {\n    const len = indexMap.length;\n    if (len > maxLen) {\n        maxLen = len;\n        prevIndices = new Int32Array(len);\n        tailIndices = new Int32Array(len);\n    }\n    let cursor = 0;\n    let cur = 0;\n    let prev = 0;\n    let i = 0;\n    let j = 0;\n    let low = 0;\n    let high = 0;\n    let mid = 0;\n    for (; i < len; i++) {\n        cur = indexMap[i];\n        if (cur !== -2) {\n            j = prevIndices[cursor];\n            prev = indexMap[j];\n            if (prev !== -2 && prev < cur) {\n                tailIndices[i] = j;\n                prevIndices[++cursor] = i;\n                continue;\n            }\n            low = 0;\n            high = cursor;\n            while (low < high) {\n                mid = (low + high) >> 1;\n                prev = indexMap[prevIndices[mid]];\n                if (prev !== -2 && prev < cur) {\n                    low = mid + 1;\n                }\n                else {\n                    high = mid;\n                }\n            }\n            prev = indexMap[prevIndices[low]];\n            if (cur < prev || prev === -2) {\n                if (low > 0) {\n                    tailIndices[i] = prevIndices[low - 1];\n                }\n                prevIndices[low] = i;\n            }\n        }\n    }\n    i = ++cursor;\n    const result = new Int32Array(i);\n    cur = prevIndices[cursor - 1];\n    while (cursor-- > 0) {\n        result[cursor] = cur;\n        cur = tailIndices[cur];\n    }\n    while (i-- > 0)\n        prevIndices[i] = 0;\n    return result;\n}\nfunction setContextualProperties(oc, index, length) {\n    const isFirst = index === 0;\n    const isLast = index === length - 1;\n    const isEven = index % 2 === 0;\n    oc.$index = index;\n    oc.$first = isFirst;\n    oc.$last = isLast;\n    oc.$middle = !isFirst && !isLast;\n    oc.$even = isEven;\n    oc.$odd = !isEven;\n    oc.$length = length;\n}\n//# sourceMappingURL=repeat.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nlet Replaceable = class Replaceable {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | 67108864 /* allowParentScopeTraversal */, this.$controller.scope, this.factory.name);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n};\nReplaceable = __decorate([\n    templateController('replaceable'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], Replaceable);\nexport { Replaceable };\n//# sourceMappingURL=replaceable.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nimport { bindable } from '../../templating/bindable';\nimport { Scope } from '../../observation/binding-context';\nlet With = class With {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.bindChild(4096 /* fromBind */);\n        }\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        this.bindChild(flags);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        this.view.unbind(flags);\n        this.view.parent = void 0;\n    }\n    bindChild(flags) {\n        const scope = Scope.fromParent(flags, this.$controller.scope, this.value === void 0 ? {} : this.value);\n        this.view.bind(flags, scope, this.$controller.part);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], With.prototype, \"value\", void 0);\nWith = __decorate([\n    templateController('with'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], With);\nexport { With };\n//# sourceMappingURL=with.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar ChildrenObserver_1;\n/* eslint-disable @typescript-eslint/no-use-before-define */\nimport { Protocol, Metadata, firstDefined, getPrototypeChain, Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '../resources/custom-element';\nimport { subscriberCollection } from '../observation/subscriber-collection';\nexport function children(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @children\n            // Invocation with or w/o opts:\n            // - @children()\n            // - @children({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Children.name, ChildrenDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Children.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @children\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @children('bar')\n        // Direct call:\n        // - @children('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @children()\n    // - @children({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isChildrenObserverAnnotation(key) {\n    return key.startsWith(Children.name);\n}\nexport const Children = {\n    name: Protocol.annotation.keyFor('children-observer'),\n    keyFrom(name) {\n        return `${Children.name}:${name}`;\n    },\n    from(...childrenObserverLists) {\n        const childrenObservers = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            childrenObservers[name] = ChildrenDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            childrenObservers[name] = ChildrenDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof ChildrenDefinition) {\n                childrenObservers[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList));\n            }\n        }\n        childrenObserverLists.forEach(addList);\n        return childrenObservers;\n    },\n    getAll(Type) {\n        const propStart = Children.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isChildrenObserverAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Children.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class ChildrenDefinition {\n    constructor(callback, property, options, query, filter, map) {\n        this.callback = callback;\n        this.property = property;\n        this.options = options;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n    }\n    static create(prop, def = {}) {\n        return new ChildrenDefinition(firstDefined(def.callback, `${prop}Changed`), firstDefined(def.property, prop), def.options, def.query, def.filter, def.map);\n    }\n}\n/** @internal */\nlet ChildrenObserver = ChildrenObserver_1 = class ChildrenObserver {\n    constructor(controller, obj, flags, propertyKey, cbName, query = defaultChildQuery, filter = defaultChildFilter, map = defaultChildMap, options) {\n        this.controller = controller;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n        this.options = options;\n        this.observing = false;\n        this.children = (void 0);\n        this.callback = obj[cbName];\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.createGetterSetter();\n    }\n    getValue() {\n        this.tryStartObserving();\n        return this.children;\n    }\n    setValue(newValue) { }\n    subscribe(subscriber) {\n        this.tryStartObserving();\n        this.addSubscriber(subscriber);\n    }\n    tryStartObserving() {\n        if (!this.observing) {\n            this.observing = true;\n            const projector = this.controller.projector;\n            this.children = filterChildren(projector, this.query, this.filter, this.map);\n            projector.subscribeToChildrenChange(() => { this.onChildrenChanged(); }, this.options);\n        }\n    }\n    onChildrenChanged() {\n        this.children = filterChildren(this.controller.projector, this.query, this.filter, this.map);\n        if (this.callback !== void 0) {\n            this.callback.call(this.obj);\n        }\n        this.callSubscribers(this.children, undefined, this.persistentFlags | 16 /* updateTargetInstance */);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.getValue(),\n            set: () => { return; },\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nChildrenObserver = ChildrenObserver_1 = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, Number, String, String, Object, Object, Object, Object])\n], ChildrenObserver);\nexport { ChildrenObserver };\nfunction defaultChildQuery(projector) {\n    return projector.children;\n}\nfunction defaultChildFilter(node, controller, viewModel) {\n    return !!viewModel;\n}\nfunction defaultChildMap(node, controller, viewModel) {\n    return viewModel;\n}\n/** @internal */\nexport function filterChildren(projector, query, filter, map) {\n    const nodes = query(projector);\n    const children = [];\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n        const node = nodes[i];\n        const controller = CustomElement.for(node);\n        const viewModel = controller ? controller.viewModel : null;\n        if (filter(node, controller, viewModel)) {\n            children.push(map(node, controller, viewModel));\n        }\n    }\n    return children;\n}\n//# sourceMappingURL=children.js.map","import { DI, Registration, Protocol, Metadata, mergeArrays, fromDefinitionOrDefault, pascalCase, fromAnnotationOrTypeOrDefault, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases, HooksDefinition, } from '../definitions';\nimport { DOM } from '../dom';\nimport { Bindable } from '../templating/bindable';\nimport { Children } from '../templating/children';\nexport function customElement(nameOrDef) {\n    return function (target) {\n        return CustomElement.define(nameOrDef, target);\n    };\n}\nexport function useShadowDOM(targetOrOptions) {\n    if (targetOrOptions === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', { mode: 'open' });\n        };\n    }\n    if (typeof targetOrOptions !== 'function') {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', targetOrOptions);\n        };\n    }\n    CustomElement.annotate(targetOrOptions, 'shadowOptions', { mode: 'open' });\n}\nexport function containerless(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'containerless', true);\n        };\n    }\n    CustomElement.annotate(target, 'containerless', true);\n}\nexport function strict(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'isStrictBinding', true);\n        };\n    }\n    CustomElement.annotate(target, 'isStrictBinding', true);\n}\nconst definitionLookup = new WeakMap();\nexport class CustomElementDefinition {\n    constructor(Type, name, aliases, key, cache, template, instructions, dependencies, injectable, needsCompile, surrogates, bindables, childrenObservers, containerless, isStrictBinding, shadowOptions, hasSlots, strategy, hooks, scopeParts) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.cache = cache;\n        this.template = template;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.injectable = injectable;\n        this.needsCompile = needsCompile;\n        this.surrogates = surrogates;\n        this.bindables = bindables;\n        this.childrenObservers = childrenObservers;\n        this.containerless = containerless;\n        this.isStrictBinding = isStrictBinding;\n        this.shadowOptions = shadowOptions;\n        this.hasSlots = hasSlots;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.scopeParts = scopeParts;\n    }\n    static create(nameOrDef, Type = null) {\n        if (Type === null) {\n            const def = nameOrDef;\n            if (typeof def === 'string') {\n                throw new Error(`Cannot create a custom element definition with only a name and no type: ${nameOrDef}`);\n            }\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const name = fromDefinitionOrDefault('name', def, CustomElement.generateName);\n            if (typeof def.Type === 'function') {\n                // This needs to be a clone (it will usually be the compiler calling this signature)\n                // TODO: we need to make sure it's documented that passing in the type via the definition (while passing in null\n                // as the \"Type\" parameter) effectively skips type analysis, so it should only be used this way for cloning purposes.\n                Type = def.Type;\n            }\n            else {\n                Type = CustomElement.generateType(pascalCase(name));\n            }\n            return new CustomElementDefinition(Type, name, mergeArrays(def.aliases), fromDefinitionOrDefault('key', def, () => CustomElement.keyFrom(name)), fromDefinitionOrDefault('cache', def, () => 0), fromDefinitionOrDefault('template', def, () => null), mergeArrays(def.instructions), mergeArrays(def.dependencies), fromDefinitionOrDefault('injectable', def, () => null), fromDefinitionOrDefault('needsCompile', def, () => true), mergeArrays(def.surrogates), Bindable.from(def.bindables), Children.from(def.childrenObservers), fromDefinitionOrDefault('containerless', def, () => false), fromDefinitionOrDefault('isStrictBinding', def, () => false), fromDefinitionOrDefault('shadowOptions', def, () => null), fromDefinitionOrDefault('hasSlots', def, () => false), fromDefinitionOrDefault('strategy', def, () => 1 /* getterSetter */), fromDefinitionOrDefault('hooks', def, () => HooksDefinition.none), mergeArrays(def.scopeParts));\n        }\n        // If a type is passed in, we ignore the Type property on the definition if it exists.\n        // TODO: document this behavior\n        if (typeof nameOrDef === 'string') {\n            return new CustomElementDefinition(Type, nameOrDef, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), Type.aliases), CustomElement.keyFrom(nameOrDef), fromAnnotationOrTypeOrDefault('cache', Type, () => 0), fromAnnotationOrTypeOrDefault('template', Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), Type.dependencies), fromAnnotationOrTypeOrDefault('injectable', Type, () => null), fromAnnotationOrTypeOrDefault('needsCompile', Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers), fromAnnotationOrTypeOrDefault('containerless', Type, () => false), fromAnnotationOrTypeOrDefault('isStrictBinding', Type, () => false), fromAnnotationOrTypeOrDefault('shadowOptions', Type, () => null), fromAnnotationOrTypeOrDefault('hasSlots', Type, () => false), fromAnnotationOrTypeOrDefault('strategy', Type, () => 1 /* getterSetter */), \n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), Type.scopeParts));\n        }\n        // This is the typical default behavior, e.g. from regular CustomElement.define invocations or from @customElement deco\n        // The ViewValueConverter also uses this signature and passes in a definition where everything except for the 'hooks'\n        // property needs to be copied. So we have that exception for 'hooks', but we may need to revisit that default behavior\n        // if this turns out to be too opinionated.\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const name = fromDefinitionOrDefault('name', nameOrDef, CustomElement.generateName);\n        return new CustomElementDefinition(Type, name, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), nameOrDef.aliases, Type.aliases), CustomElement.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('cache', nameOrDef, Type, () => 0), fromAnnotationOrDefinitionOrTypeOrDefault('template', nameOrDef, Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), nameOrDef.instructions, Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), nameOrDef.dependencies, Type.dependencies), fromAnnotationOrDefinitionOrTypeOrDefault('injectable', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('needsCompile', nameOrDef, Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), nameOrDef.surrogates, Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables, nameOrDef.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers, nameOrDef.childrenObservers), fromAnnotationOrDefinitionOrTypeOrDefault('containerless', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('isStrictBinding', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('shadowOptions', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('hasSlots', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', nameOrDef, Type, () => 1 /* getterSetter */), \n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), nameOrDef.scopeParts, Type.scopeParts));\n    }\n    static getOrCreate(partialDefinition) {\n        if (partialDefinition instanceof CustomElementDefinition) {\n            return partialDefinition;\n        }\n        if (definitionLookup.has(partialDefinition)) {\n            return definitionLookup.get(partialDefinition);\n        }\n        const definition = CustomElementDefinition.create(partialDefinition);\n        definitionLookup.set(partialDefinition, definition);\n        // Make sure the full definition can be retrieved from dynamically created classes as well\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        return definition;\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, CustomElement, key, container);\n    }\n}\nexport const CustomElement = {\n    name: Protocol.resource.keyFor('custom-element'),\n    keyFrom(name) {\n        return `${CustomElement.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomElement.name, value);\n    },\n    for(node, nameOrSearchParents, searchParents) {\n        if (nameOrSearchParents === void 0) {\n            return Metadata.getOwn(CustomElement.name, node);\n        }\n        if (typeof nameOrSearchParents === 'string') {\n            if (searchParents !== true) {\n                const controller = Metadata.getOwn(CustomElement.name, node);\n                if (controller === void 0) {\n                    return (void 0);\n                }\n                if (controller.is(nameOrSearchParents)) {\n                    return controller;\n                }\n                return (void 0);\n            }\n            let cur = node;\n            while (cur !== null) {\n                const controller = Metadata.getOwn(CustomElement.name, cur);\n                if (controller !== void 0 && controller.is(nameOrSearchParents)) {\n                    return controller;\n                }\n                cur = DOM.getEffectiveParentNode(cur);\n            }\n            return (void 0);\n        }\n        let cur = node;\n        while (cur !== null) {\n            const controller = Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        return (void 0);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomElementDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        Metadata.define(CustomElement.name, definition, definition);\n        Protocol.resource.appendTo(definition.Type, CustomElement.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomElement.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n    generateName: (function () {\n        let id = 0;\n        return function () {\n            return `unnamed-${++id}`;\n        };\n    })(),\n    createInjectable() {\n        const $injectable = function (target, property, index) {\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = $injectable;\n            return target;\n        };\n        $injectable.register = function (container) {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            return {\n                resolve(container, requestor) {\n                    if (requestor.has($injectable, true)) {\n                        return requestor.get($injectable);\n                    }\n                    else {\n                        return null;\n                    }\n                },\n            };\n        };\n        return $injectable;\n    },\n    generateType: (function () {\n        const nameDescriptor = {\n            value: '',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const defaultProto = {};\n        return function (name, proto = defaultProto) {\n            // Anonymous class ensures that minification cannot cause unintended side-effects, and keeps the class\n            // looking similarly from the outside (when inspected via debugger, etc).\n            const Type = class {\n            };\n            // Define the name property so that Type.name can be used by end users / plugin authors if they really need to,\n            // even when minified.\n            nameDescriptor.value = name;\n            Reflect.defineProperty(Type, 'name', nameDescriptor);\n            // Assign anything from the prototype that was passed in\n            if (proto !== defaultProto) {\n                Object.assign(Type.prototype, proto);\n            }\n            return Type;\n        };\n    })(),\n};\nexport const IProjectorLocator = DI.createInterface('IProjectorLocator').noDefault();\n//# sourceMappingURL=custom-element.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI } from '@aurelia/kernel';\nimport { valueConverter } from '../value-converter';\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\nexport const ISanitizer = DI.createInterface('ISanitizer').withDefault(x => x.singleton(class {\n    sanitize(input) {\n        return input.replace(SCRIPT_REGEX, '');\n    }\n}));\n/**\n * Simple html sanitization converter to preserve whitelisted elements and attributes on a bound property containing html.\n */\nlet SanitizeValueConverter = class SanitizeValueConverter {\n    constructor(sanitizer) {\n        this.sanitizer = sanitizer;\n    }\n    /**\n     * Process the provided markup that flows to the view.\n     *\n     * @param untrustedMarkup - The untrusted markup to be sanitized.\n     */\n    toView(untrustedMarkup) {\n        if (untrustedMarkup == null) {\n            return null;\n        }\n        return this.sanitizer.sanitize(untrustedMarkup);\n    }\n};\nSanitizeValueConverter = __decorate([\n    valueConverter('sanitize'),\n    __param(0, ISanitizer),\n    __metadata(\"design:paramtypes\", [Object])\n], SanitizeValueConverter);\nexport { SanitizeValueConverter };\n//# sourceMappingURL=sanitize.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, Registration, Metadata, DI, } from '@aurelia/kernel';\nimport { CallBinding } from './binding/call-binding';\nimport { IExpressionParser } from './binding/expression-parser';\nimport { InterpolationBinding, MultiInterpolationBinding } from './binding/interpolation-binding';\nimport { LetBinding } from './binding/let-binding';\nimport { PropertyBinding } from './binding/property-binding';\nimport { RefBinding } from './binding/ref-binding';\nimport { mergeParts } from './definitions';\nimport { BindingMode } from './flags';\nimport { ILifecycle, } from './lifecycle';\nimport { IObserverLocator } from './observation/observer-locator';\nimport { CustomAttribute, } from './resources/custom-attribute';\nimport { CustomElement, } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nimport { getRenderContext } from './templating/render-context';\nimport { BindingBehaviorExpression } from './binding/ast';\nimport { BindingBehaviorFactory } from './resources/binding-behavior';\nexport const ITemplateCompiler = DI.createInterface('ITemplateCompiler').noDefault();\nexport const IInstructionRenderer = DI.createInterface('IInstructionRenderer').noDefault();\nexport const IRenderer = DI.createInterface('IRenderer').noDefault();\nexport function instructionRenderer(instructionType) {\n    return function decorator(target) {\n        // wrap the constructor to set the instructionType to the instance (for better performance than when set on the prototype)\n        const decoratedTarget = function (...args) {\n            const instance = new target(...args);\n            instance.instructionType = instructionType;\n            return instance;\n        };\n        // make sure we register the decorated constructor with DI\n        decoratedTarget.register = function register(container) {\n            Registration.singleton(IInstructionRenderer, decoratedTarget).register(container);\n        };\n        // copy over any metadata such as annotations (set by preceding decorators) as well as static properties set by the user\n        // also copy the name, to be less confusing to users (so they can still use constructor.name for whatever reason)\n        // the length (number of ctor arguments) is copied for the same reason\n        const metadataKeys = Metadata.getOwnKeys(target);\n        for (const key of metadataKeys) {\n            Metadata.define(key, Metadata.getOwn(key, target), decoratedTarget);\n        }\n        const ownProperties = Object.getOwnPropertyDescriptors(target);\n        Object.keys(ownProperties).filter(prop => prop !== 'prototype').forEach(prop => {\n            Reflect.defineProperty(decoratedTarget, prop, ownProperties[prop]);\n        });\n        return decoratedTarget;\n    };\n}\n/* @internal */\nlet Renderer = class Renderer {\n    constructor(instructionRenderers) {\n        const record = this.instructionRenderers = {};\n        instructionRenderers.forEach(item => {\n            // Binding the functions to the renderer instances and calling the functions directly,\n            // prevents the `render` call sites from going megamorphic.\n            // Consumes slightly more memory but significantly less CPU.\n            record[item.instructionType] = item.render.bind(item);\n        });\n    }\n    static register(container) {\n        return Registration.singleton(IRenderer, this).register(container);\n    }\n    render(flags, context, controller, targets, definition, host, parts) {\n        const targetInstructions = definition.instructions;\n        if (targets.length !== targetInstructions.length) {\n            throw new Error(`The compiled template is not aligned with the render instructions. There are ${targets.length} targets and ${targetInstructions.length} instructions.`);\n        }\n        for (let i = 0, ii = targets.length; i < ii; ++i) {\n            this.renderInstructions(\n            /* flags        */ flags, \n            /* context      */ context, \n            /* instructions */ targetInstructions[i], \n            /* controller   */ controller, \n            /* target       */ targets[i], \n            /* parts        */ parts);\n        }\n        if (host !== void 0 && host !== null) {\n            this.renderInstructions(\n            /* flags        */ flags, \n            /* context      */ context, \n            /* instructions */ definition.surrogates, \n            /* controller   */ controller, \n            /* target       */ host, \n            /* parts        */ parts);\n        }\n    }\n    renderInstructions(flags, context, instructions, controller, target, parts) {\n        const instructionRenderers = this.instructionRenderers;\n        let current;\n        for (let i = 0, ii = instructions.length; i < ii; ++i) {\n            current = instructions[i];\n            instructionRenderers[current.type](flags, context, controller, target, current, parts);\n        }\n    }\n};\nRenderer = __decorate([\n    __param(0, all(IInstructionRenderer)),\n    __metadata(\"design:paramtypes\", [Array])\n], Renderer);\nexport { Renderer };\nexport function ensureExpression(parser, srcOrExpr, bindingType) {\n    if (typeof srcOrExpr === 'string') {\n        return parser.parse(srcOrExpr, bindingType);\n    }\n    return srcOrExpr;\n}\nexport function getTarget(potentialTarget) {\n    if (potentialTarget.bindingContext !== void 0) {\n        return potentialTarget.bindingContext;\n    }\n    return potentialTarget;\n}\nexport function getRefTarget(refHost, refTargetName) {\n    if (refTargetName === 'element') {\n        return refHost;\n    }\n    switch (refTargetName) {\n        case 'controller':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost);\n        case 'view':\n            // todo: returns node sequences for fun?\n            throw new Error('Not supported API');\n        case 'view-model':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost).viewModel;\n        default: {\n            const caController = CustomAttribute.for(refHost, refTargetName);\n            if (caController !== void 0) {\n                return caController.viewModel;\n            }\n            const ceController = CustomElement.for(refHost, refTargetName);\n            if (ceController === void 0) {\n                throw new Error(`Attempted to reference \"${refTargetName}\", but it was not found amongst the target's API.`);\n            }\n            return ceController.viewModel;\n        }\n    }\n}\nlet SetPropertyRenderer = \n/** @internal */\nclass SetPropertyRenderer {\n    render(flags, context, controller, target, instruction) {\n        const obj = getTarget(target);\n        if (obj.$observers !== void 0 && obj.$observers[instruction.to] !== void 0) {\n            obj.$observers[instruction.to].setValue(instruction.value, 4096 /* fromBind */);\n        }\n        else {\n            obj[instruction.to] = instruction.value;\n        }\n    }\n};\nSetPropertyRenderer = __decorate([\n    instructionRenderer(\"re\" /* setProperty */)\n    /** @internal */\n], SetPropertyRenderer);\nexport { SetPropertyRenderer };\nlet CustomElementRenderer = \n/** @internal */\nclass CustomElementRenderer {\n    render(flags, context, controller, target, instruction, parts) {\n        parts = mergeParts(parts, instruction.parts);\n        const factory = context.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ void 0, \n        /* location         */ target);\n        const key = CustomElement.keyFrom(instruction.res);\n        const component = factory.createComponent(key);\n        const lifecycle = context.get(ILifecycle);\n        const childController = Controller.forCustomElement(\n        /* viewModel       */ component, \n        /* lifecycle       */ lifecycle, \n        /* host            */ target, \n        /* parentContainer */ context, \n        /* parts           */ parts, \n        /* flags           */ flags);\n        flags = childController.flags;\n        Metadata.define(key, childController, target);\n        context.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        factory.dispose();\n    }\n};\nCustomElementRenderer = __decorate([\n    instructionRenderer(\"ra\" /* hydrateElement */)\n    /** @internal */\n], CustomElementRenderer);\nexport { CustomElementRenderer };\nlet CustomAttributeRenderer = \n/** @internal */\nclass CustomAttributeRenderer {\n    render(flags, context, controller, target, instruction, parts) {\n        const factory = context.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ void 0, \n        /* location         */ void 0);\n        const key = CustomAttribute.keyFrom(instruction.res);\n        const component = factory.createComponent(key);\n        const lifecycle = context.get(ILifecycle);\n        const childController = Controller.forCustomAttribute(\n        /* viewModel */ component, \n        /* lifecycle */ lifecycle, \n        /* host      */ target, \n        /* flags     */ flags);\n        Metadata.define(key, childController, target);\n        context.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        factory.dispose();\n    }\n};\nCustomAttributeRenderer = __decorate([\n    instructionRenderer(\"rb\" /* hydrateAttribute */)\n    /** @internal */\n], CustomAttributeRenderer);\nexport { CustomAttributeRenderer };\nlet TemplateControllerRenderer = \n/** @internal */\nclass TemplateControllerRenderer {\n    render(flags, parentContext, controller, target, instruction, parts) {\n        parts = mergeParts(parts, instruction.parts);\n        const viewFactory = getRenderContext(instruction.def, parentContext, parts).getViewFactory();\n        const renderLocation = parentContext.dom.convertToRenderLocation(target);\n        const componentFactory = parentContext.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ viewFactory, \n        /* location         */ renderLocation);\n        const key = CustomAttribute.keyFrom(instruction.res);\n        const component = componentFactory.createComponent(key);\n        const lifecycle = parentContext.get(ILifecycle);\n        const childController = Controller.forCustomAttribute(\n        /* viewModel */ component, \n        /* lifecycle */ lifecycle, \n        /* host      */ target, \n        /* flags     */ flags);\n        Metadata.define(key, childController, renderLocation);\n        if (instruction.link) {\n            const controllers = controller.controllers;\n            component.link(controllers[controllers.length - 1]);\n        }\n        parentContext.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        componentFactory.dispose();\n    }\n};\nTemplateControllerRenderer = __decorate([\n    instructionRenderer(\"rc\" /* hydrateTemplateController */)\n    /** @internal */\n], TemplateControllerRenderer);\nexport { TemplateControllerRenderer };\nlet LetElementRenderer = \n/** @internal */\nclass LetElementRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        context.dom.remove(target);\n        const childInstructions = instruction.instructions;\n        const toBindingContext = instruction.toBindingContext;\n        let childInstruction;\n        let expr;\n        let binding;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            childInstruction = childInstructions[i];\n            expr = ensureExpression(this.parser, childInstruction.from, 48 /* IsPropertyCommand */);\n            binding = applyBindingBehavior(new LetBinding(expr, childInstruction.to, this.observerLocator, context, toBindingContext), expr, context);\n            controller.addBinding(binding);\n        }\n    }\n};\nLetElementRenderer = __decorate([\n    instructionRenderer(\"rd\" /* hydrateLetElement */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], LetElementRenderer);\nexport { LetElementRenderer };\nlet CallBindingRenderer = \n/** @internal */\nclass CallBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 153 /* CallCommand */);\n        const binding = applyBindingBehavior(new CallBinding(expr, getTarget(target), instruction.to, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nCallBindingRenderer = __decorate([\n    instructionRenderer(\"rh\" /* callBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], CallBindingRenderer);\nexport { CallBindingRenderer };\nlet RefBindingRenderer = \n/** @internal */\nclass RefBindingRenderer {\n    constructor(parser) {\n        this.parser = parser;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 5376 /* IsRef */);\n        const binding = applyBindingBehavior(new RefBinding(expr, getRefTarget(target, instruction.to), context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nRefBindingRenderer = __decorate([\n    instructionRenderer(\"rj\" /* refBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __metadata(\"design:paramtypes\", [Object])\n], RefBindingRenderer);\nexport { RefBindingRenderer };\nlet InterpolationBindingRenderer = \n/** @internal */\nclass InterpolationBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, getTarget(target), instruction.to, BindingMode.toView, context), expr, context);\n        }\n        else {\n            binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context, true), expr, context);\n        }\n        controller.addBinding(binding);\n    }\n};\nInterpolationBindingRenderer = __decorate([\n    instructionRenderer(\"rf\" /* interpolation */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], InterpolationBindingRenderer);\nexport { InterpolationBindingRenderer };\nlet PropertyBindingRenderer = \n/** @internal */\nclass PropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | instruction.mode);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, instruction.mode, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nPropertyBindingRenderer = __decorate([\n    instructionRenderer(\"rg\" /* propertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], PropertyBindingRenderer);\nexport { PropertyBindingRenderer };\nlet IteratorBindingRenderer = \n/** @internal */\nclass IteratorBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 539 /* ForCommand */);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nIteratorBindingRenderer = __decorate([\n    instructionRenderer(\"rk\" /* iteratorBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], IteratorBindingRenderer);\nexport { IteratorBindingRenderer };\nlet behaviorExpressionIndex = 0;\nconst behaviorExpressions = [];\nexport function applyBindingBehavior(binding, expression, locator) {\n    while (expression instanceof BindingBehaviorExpression) {\n        behaviorExpressions[behaviorExpressionIndex++] = expression;\n        expression = expression.expression;\n    }\n    while (behaviorExpressionIndex > 0) {\n        const behaviorExpression = behaviorExpressions[--behaviorExpressionIndex];\n        const behaviorOrFactory = locator.get(behaviorExpression.behaviorKey);\n        if (behaviorOrFactory instanceof BindingBehaviorFactory) {\n            binding = behaviorOrFactory.construct(binding, behaviorExpression);\n        }\n    }\n    behaviorExpressions.length = 0;\n    return binding;\n}\n//# sourceMappingURL=renderer.js.map","import { InstanceProvider, Reporter, } from '@aurelia/kernel';\nimport { ITargetedInstruction, mergeParts, } from '../definitions';\nimport { IDOM, IRenderLocation } from '../dom';\nimport { IController, ILifecycle, IViewFactory, } from '../lifecycle';\nimport { IRenderer, ITemplateCompiler } from '../renderer';\nimport { CustomElementDefinition } from '../resources/custom-element';\nimport { ViewFactory } from './view';\nconst definitionContainerLookup = new WeakMap();\nconst definitionContainerPartsLookup = new WeakMap();\nconst fragmentCache = new WeakMap();\nexport function isRenderContext(value) {\n    return value instanceof RenderContext;\n}\nexport function getRenderContext(partialDefinition, parentContainer, parts) {\n    const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n    if (isRenderContext(parentContainer)) {\n        parts = mergeParts(parentContainer.parts, parts);\n    }\n    // injectable completely prevents caching, ensuring that each instance gets a new render context\n    if (definition.injectable !== null) {\n        return new RenderContext(definition, parentContainer, parts);\n    }\n    if (parts === void 0) {\n        let containerLookup = definitionContainerLookup.get(definition);\n        if (containerLookup === void 0) {\n            definitionContainerLookup.set(definition, containerLookup = new WeakMap());\n        }\n        let context = containerLookup.get(parentContainer);\n        if (context === void 0) {\n            containerLookup.set(parentContainer, context = new RenderContext(definition, parentContainer, parts));\n        }\n        return context;\n    }\n    let containerPartsLookup = definitionContainerPartsLookup.get(definition);\n    if (containerPartsLookup === void 0) {\n        definitionContainerPartsLookup.set(definition, containerPartsLookup = new WeakMap());\n    }\n    let partsLookup = containerPartsLookup.get(parentContainer);\n    if (partsLookup === void 0) {\n        containerPartsLookup.set(parentContainer, partsLookup = new WeakMap());\n    }\n    let context = partsLookup.get(parts);\n    if (context === void 0) {\n        partsLookup.set(parts, context = new RenderContext(definition, parentContainer, parts));\n    }\n    return context;\n}\nexport class RenderContext {\n    constructor(definition, parentContainer, parts) {\n        this.definition = definition;\n        this.parentContainer = parentContainer;\n        this.parts = parts;\n        this.viewModelProvider = void 0;\n        this.fragment = null;\n        this.factory = void 0;\n        this.isCompiled = false;\n        this.compiledDefinition = (void 0);\n        const container = this.container = parentContainer.createChild();\n        this.renderer = container.get(IRenderer);\n        container.registerResolver(IViewFactory, this.factoryProvider = new ViewFactoryProvider(), true);\n        container.registerResolver(IController, this.parentControllerProvider = new InstanceProvider(), true);\n        container.registerResolver(ITargetedInstruction, this.instructionProvider = new InstanceProvider(), true);\n        container.registerResolver(IRenderLocation, this.renderLocationProvider = new InstanceProvider(), true);\n        (this.dom = container.get(IDOM)).registerElementResolver(container, this.elementProvider = new InstanceProvider());\n        container.register(...definition.dependencies);\n    }\n    // #region IServiceLocator api\n    has(key, searchAncestors) {\n        return this.container.has(key, searchAncestors);\n    }\n    get(key) {\n        return this.container.get(key);\n    }\n    getAll(key) {\n        return this.container.getAll(key);\n    }\n    // #endregion\n    // #region IContainer api\n    register(...params) {\n        return this.container.register(...params);\n    }\n    registerResolver(key, resolver) {\n        return this.container.registerResolver(key, resolver);\n    }\n    registerTransformer(key, transformer) {\n        return this.container.registerTransformer(key, transformer);\n    }\n    getResolver(key, autoRegister) {\n        return this.container.getResolver(key, autoRegister);\n    }\n    getFactory(key) {\n        return this.container.getFactory(key);\n    }\n    registerFactory(key, factory) {\n        this.container.registerFactory(key, factory);\n    }\n    createChild() {\n        return this.container.createChild();\n    }\n    disposeResolvers() {\n        this.container.disposeResolvers();\n    }\n    // #endregion\n    // #region IRenderContext api\n    compile() {\n        let compiledDefinition;\n        if (this.isCompiled) {\n            return this;\n        }\n        this.isCompiled = true;\n        const definition = this.definition;\n        if (definition.needsCompile) {\n            const container = this.container;\n            const compiler = container.get(ITemplateCompiler);\n            compiledDefinition = this.compiledDefinition = compiler.compile(definition, container);\n        }\n        else {\n            compiledDefinition = this.compiledDefinition = definition;\n        }\n        // Support Recursive Components by adding self to own context\n        compiledDefinition.register(this);\n        if (fragmentCache.has(compiledDefinition)) {\n            this.fragment = fragmentCache.get(compiledDefinition);\n        }\n        else {\n            const template = compiledDefinition.template;\n            if (template === null) {\n                fragmentCache.set(compiledDefinition, null);\n            }\n            else {\n                fragmentCache.set(compiledDefinition, this.fragment = this.dom.createDocumentFragment(template));\n            }\n        }\n        return this;\n    }\n    getViewFactory(name) {\n        let factory = this.factory;\n        if (factory === void 0) {\n            if (name === void 0) {\n                name = this.definition.name;\n            }\n            const lifecycle = this.parentContainer.get(ILifecycle);\n            factory = this.factory = new ViewFactory(name, this, lifecycle, this.parts);\n        }\n        return factory;\n    }\n    beginChildComponentOperation(instance) {\n        const definition = this.definition;\n        if (definition.injectable !== null) {\n            if (this.viewModelProvider === void 0) {\n                this.container.registerResolver(definition.injectable, this.viewModelProvider = new InstanceProvider());\n            }\n            this.viewModelProvider.prepare(instance);\n        }\n        return this;\n    }\n    // #endregion\n    // #region ICompiledRenderContext api\n    createNodes() {\n        return this.dom.createNodeSequence(this.fragment);\n    }\n    // TODO: split up into 2 methods? getComponentFactory + getSyntheticFactory or something\n    getComponentFactory(parentController, host, instruction, viewFactory, location) {\n        if (parentController !== void 0) {\n            this.parentControllerProvider.prepare(parentController);\n        }\n        if (host !== void 0) {\n            // TODO: fix provider input type, Key is probably not a good constraint\n            this.elementProvider.prepare(host);\n        }\n        if (instruction !== void 0) {\n            this.instructionProvider.prepare(instruction);\n        }\n        if (location !== void 0) {\n            this.renderLocationProvider.prepare(location);\n        }\n        if (viewFactory !== void 0) {\n            this.factoryProvider.prepare(viewFactory);\n        }\n        return this;\n    }\n    // #endregion\n    // #region IComponentFactory api\n    createComponent(resourceKey) {\n        return this.container.get(resourceKey);\n    }\n    render(flags, controller, targets, templateDefinition, host, parts) {\n        this.renderer.render(flags, this, controller, targets, templateDefinition, host, parts);\n    }\n    renderInstructions(flags, instructions, controller, target, parts) {\n        this.renderer.renderInstructions(flags, this, instructions, controller, target, parts);\n    }\n    dispose() {\n        this.elementProvider.dispose();\n        this.container.disposeResolvers();\n    }\n}\n/** @internal */\nexport class ViewFactoryProvider {\n    constructor() {\n        this.factory = null;\n    }\n    prepare(factory) {\n        this.factory = factory;\n    }\n    get $isResolver() { return true; }\n    resolve(handler, requestor) {\n        const factory = this.factory;\n        if (factory === null) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        if (typeof factory.name !== 'string' || factory.name.length === 0) { // unmet invariant: factory must have a name\n            throw Reporter.error(51); // TODO: organize error codes\n        }\n        return factory.resolve(requestor);\n    }\n    dispose() {\n        this.factory = null;\n    }\n}\n//# sourceMappingURL=render-context.js.map","import { mergeDistinct, nextId, } from '@aurelia/kernel';\nimport { HooksDefinition, } from '../definitions';\nimport { AggregateContinuationTask, ContinuationTask, hasAsyncWork, LifecycleTask, } from '../lifecycle-task';\nimport { Scope, } from '../observation/binding-context';\nimport { ProxyObserver, } from '../observation/proxy-observer';\nimport { BindableObserver, } from '../observation/bindable-observer';\nimport { IProjectorLocator, CustomElementDefinition, CustomElement, } from '../resources/custom-element';\nimport { CustomAttribute, } from '../resources/custom-attribute';\nimport { getRenderContext, } from './render-context';\nimport { ChildrenObserver } from './children';\nconst controllerLookup = new WeakMap();\nexport class Controller {\n    constructor(vmKind, flags, lifecycle, hooks, \n    /**\n     * The viewFactory. Only present for synthetic views.\n     */\n    viewFactory, \n    /**\n     * The backing viewModel. This is never a proxy. Only present for custom attributes and elements.\n     */\n    viewModel, \n    /**\n     * The binding context. This may be a proxy. If it is not, then it is the same instance as the viewModel. Only present for custom attributes and elements.\n     */\n    bindingContext, \n    /**\n     * The physical host dom node. Only present for custom elements.\n     */\n    host) {\n        this.vmKind = vmKind;\n        this.flags = flags;\n        this.lifecycle = lifecycle;\n        this.hooks = hooks;\n        this.viewFactory = viewFactory;\n        this.viewModel = viewModel;\n        this.bindingContext = bindingContext;\n        this.host = host;\n        this.id = nextId('au$component');\n        this.nextBound = void 0;\n        this.nextUnbound = void 0;\n        this.prevBound = void 0;\n        this.prevUnbound = void 0;\n        this.nextAttached = void 0;\n        this.nextDetached = void 0;\n        this.prevAttached = void 0;\n        this.prevDetached = void 0;\n        this.nextMount = void 0;\n        this.nextUnmount = void 0;\n        this.prevMount = void 0;\n        this.prevUnmount = void 0;\n        this.parent = void 0;\n        this.bindings = void 0;\n        this.controllers = void 0;\n        this.state = 0 /* none */;\n        this.scopeParts = void 0;\n        this.isStrictBinding = false;\n        this.scope = void 0;\n        this.part = void 0;\n        this.projector = void 0;\n        this.nodes = void 0;\n        this.context = void 0;\n        this.location = void 0;\n        this.mountStrategy = 1 /* insertBefore */;\n    }\n    static getCached(viewModel) {\n        return controllerLookup.get(viewModel);\n    }\n    static getCachedOrThrow(viewModel) {\n        const controller = Controller.getCached(viewModel);\n        if (controller === void 0) {\n            throw new Error(`There is no cached controller for the provided ViewModel: ${String(viewModel)}`);\n        }\n        return controller;\n    }\n    static forCustomElement(viewModel, lifecycle, host, parentContainer, parts, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomElement.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(0 /* customElement */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomElement(definition, parentContainer, parts);\n        return controller;\n    }\n    static forCustomAttribute(viewModel, lifecycle, host, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomAttribute.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(1 /* customAttribute */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomAttribute(definition);\n        return controller;\n    }\n    static forSyntheticView(viewFactory, lifecycle, context, flags = 0 /* none */) {\n        const controller = new Controller(2 /* synthetic */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ HooksDefinition.none, \n        /* viewFactory    */ viewFactory, \n        /* viewModel      */ void 0, \n        /* bindingContext */ void 0, \n        /* host           */ void 0);\n        controller.hydrateSynthetic(context, viewFactory.parts);\n        return controller;\n    }\n    hydrateCustomElement(definition, parentContainer, parts) {\n        const flags = this.flags |= definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        createChildrenObservers(this, definition, flags, instance);\n        this.scope = Scope.create(flags, this.bindingContext, null);\n        const hooks = this.hooks;\n        if (hooks.hasCreate) {\n            const result = instance.create(\n            /* controller      */ this, \n            /* parentContainer */ parentContainer, \n            /* definition      */ definition, \n            /* parts           */ parts);\n            if (result !== void 0 && result !== definition) {\n                definition = CustomElementDefinition.getOrCreate(result);\n            }\n        }\n        const context = this.context = getRenderContext(definition, parentContainer, parts);\n        // Support Recursive Components by adding self to own context\n        definition.register(context);\n        if (definition.injectable !== null) {\n            // If the element is registered as injectable, support injecting the instance into children\n            context.beginChildComponentOperation(instance);\n        }\n        if (hooks.hasBeforeCompile) {\n            instance.beforeCompile(this);\n        }\n        const compiledContext = context.compile();\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.scopeParts = compiledDefinition.scopeParts;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const projectorLocator = parentContainer.get(IProjectorLocator);\n        this.projector = projectorLocator.getElementProjector(context.dom, this, this.host, compiledDefinition);\n        instance.$controller = this;\n        const nodes = this.nodes = compiledContext.createNodes();\n        if (hooks.hasAfterCompile) {\n            instance.afterCompile(this);\n        }\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ this.host, \n        /* parts      */ parts);\n        if (hooks.hasAfterCompileChildren) {\n            instance.afterCompileChildren(this);\n        }\n    }\n    hydrateCustomAttribute(definition) {\n        const flags = this.flags | definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        instance.$controller = this;\n    }\n    hydrateSynthetic(context, parts) {\n        this.context = context;\n        const compiledContext = context.compile();\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.scopeParts = compiledDefinition.scopeParts;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const nodes = this.nodes = compiledContext.createNodes();\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ void 0, \n        /* parts      */ parts);\n    }\n    addBinding(binding) {\n        if (this.bindings === void 0) {\n            this.bindings = [binding];\n        }\n        else {\n            this.bindings[this.bindings.length] = binding;\n        }\n    }\n    addController(controller) {\n        if (this.controllers === void 0) {\n            this.controllers = [controller];\n        }\n        else {\n            this.controllers[this.controllers.length] = controller;\n        }\n    }\n    is(name) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */: {\n                const def = CustomAttribute.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 0 /* customElement */: {\n                const def = CustomElement.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 2 /* synthetic */:\n                return this.viewFactory.name === name;\n        }\n    }\n    lockScope(scope) {\n        this.scope = scope;\n        this.state |= 256 /* hasLockedScope */;\n    }\n    hold(location, mountStrategy) {\n        this.state = (this.state | 512 /* canBeCached */) ^ 512 /* canBeCached */;\n        this.location = location;\n        this.mountStrategy = mountStrategy;\n    }\n    release(flags) {\n        this.state |= 512 /* canBeCached */;\n        if ((this.state & 32 /* isAttached */) > 0) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            return this.viewFactory.canReturnToCache(this); // non-null is implied by the hook\n        }\n        return this.unmountSynthetic(flags);\n    }\n    bind(flags, scope, part) {\n        this.part = part;\n        // TODO: benchmark which of these techniques is fastest:\n        // - the current one (enum with switch)\n        // - set the name of the method in the constructor, e.g. this.bindMethod = 'bindCustomElement'\n        //    and then doing this[this.bindMethod](flags, scope) instead of switch (eliminates branching\n        //    but computed property access might be harmful to browser optimizations)\n        // - make bind() a property and set it to one of the 3 methods in the constructor,\n        //    e.g. this.bind = this.bindCustomElement (eliminates branching + reduces call stack depth by 1,\n        //    but might make the call site megamorphic)\n        flags |= 4096 /* fromBind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.bindCustomElement(flags, scope);\n            case 1 /* customAttribute */:\n                return this.bindCustomAttribute(flags, scope);\n            case 2 /* synthetic */:\n                return this.bindSynthetic(flags, scope);\n        }\n    }\n    unbind(flags) {\n        flags |= 8192 /* fromUnbind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.unbindCustomElement(flags);\n            case 1 /* customAttribute */:\n                return this.unbindCustomAttribute(flags);\n            case 2 /* synthetic */:\n                return this.unbindSynthetic(flags);\n        }\n    }\n    afterBind(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterBind(flags); // non-null is implied by the hook\n    }\n    afterUnbind(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterUnbind(flags); // non-null is implied by the hook\n    }\n    attach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) > 0 && (flags & 33554432 /* reorderNodes */) === 0) {\n            return;\n        }\n        flags |= 16384 /* fromAttach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.attachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.attachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.attachSynthetic(flags);\n        }\n    }\n    detach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return;\n        }\n        flags |= 32768 /* fromDetach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.detachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.detachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.detachSynthetic(flags);\n        }\n    }\n    afterAttach(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterAttach(flags); // non-null is implied by the hook\n    }\n    afterDetach(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterDetach(flags); // non-null is implied by the hook\n    }\n    mount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.mountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.mountSynthetic(flags);\n        }\n    }\n    unmount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.unmountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.unmountSynthetic(flags);\n        }\n    }\n    cache(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.cacheCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.cacheCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.cacheSynthetic(flags);\n        }\n    }\n    getTargetAccessor(propertyName) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const binding = bindings.find(b => b.targetProperty === propertyName);\n            if (binding !== void 0) {\n                return binding.targetObserver;\n            }\n        }\n        return void 0;\n    }\n    // #region bind/unbind\n    bindCustomElement(flags, scope) {\n        const $scope = this.scope;\n        $scope.parentScope = scope === void 0 ? null : scope;\n        $scope.scopeParts = this.scopeParts;\n        if ((this.state & 4 /* isBound */) > 0) {\n            return LifecycleTask.done;\n        }\n        flags |= 4096 /* fromBind */;\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.afterBind.begin();\n        if (this.hooks.hasBeforeBind) {\n            const ret = this.bindingContext.beforeBind(flags);\n            if (hasAsyncWork(ret)) {\n                // this.scope could be reassigned during beforeBind so reference that instead of $scope.\n                return new ContinuationTask(ret, this.bindBindings, this, flags, this.scope);\n            }\n        }\n        return this.bindBindings(flags, this.scope);\n    }\n    bindCustomAttribute(flags, scope) {\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        this.state |= 1 /* isBinding */;\n        this.scope = scope;\n        this.lifecycle.afterBind.begin();\n        if (this.hooks.hasBeforeBind) {\n            const ret = this.bindingContext.beforeBind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endBind, this, flags);\n            }\n        }\n        this.endBind(flags);\n        return LifecycleTask.done;\n    }\n    bindSynthetic(flags, scope) {\n        if (scope == void 0) {\n            throw new Error(`Scope is null or undefined`); // TODO: create error code\n        }\n        scope.scopeParts = mergeDistinct(scope.scopeParts, this.scopeParts, false);\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope || (this.state & 256 /* hasLockedScope */) > 0) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        if ((this.state & 256 /* hasLockedScope */) === 0) {\n            this.scope = scope;\n        }\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.afterBind.begin();\n        return this.bindBindings(flags, this.scope);\n    }\n    bindBindings(flags, scope) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const { length } = bindings;\n            if (this.isStrictBinding) {\n                flags |= 4 /* isStrictBindingStrategy */;\n            }\n            for (let i = 0; i < length; ++i) {\n                bindings[i].$bind(flags, scope, this.part);\n            }\n        }\n        return this.bindControllers(flags, this.scope);\n    }\n    bindControllers(flags, scope) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].parent = this;\n                task = controllers[i].bind(flags, scope, this.part);\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.endBind(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.endBind, this, flags);\n    }\n    endBind(flags) {\n        if (this.hooks.hasAfterBind) {\n            this.lifecycle.afterBind.add(this);\n        }\n        this.state = this.state ^ 1 /* isBinding */ | 4 /* isBound */;\n        this.lifecycle.afterBind.end(flags);\n    }\n    unbindCustomElement(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.scope.parentScope = null;\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        if (this.hooks.hasBeforeUnbind) {\n            const ret = this.bindingContext.beforeUnbind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.unbindControllers, this, flags);\n            }\n        }\n        return this.unbindControllers(flags);\n    }\n    unbindCustomAttribute(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        if (this.hooks.hasBeforeUnbind) {\n            const ret = this.bindingContext.beforeUnbind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endUnbind, this, flags);\n            }\n        }\n        this.endUnbind(flags);\n        return LifecycleTask.done;\n    }\n    unbindSynthetic(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        return this.unbindControllers(flags);\n    }\n    unbindBindings(flags) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            for (let i = bindings.length - 1; i >= 0; --i) {\n                bindings[i].$unbind(flags);\n            }\n        }\n        this.endUnbind(flags);\n    }\n    unbindControllers(flags) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                task = controllers[i].unbind(flags);\n                controllers[i].parent = void 0;\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.unbindBindings(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.unbindBindings, this, flags);\n    }\n    endUnbind(flags) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */:\n                this.scope = void 0;\n                break;\n            case 2 /* synthetic */:\n                if ((this.state & 256 /* hasLockedScope */) === 0) {\n                    this.scope = void 0;\n                }\n        }\n        if (this.hooks.hasAfterUnbind) {\n            this.lifecycle.afterUnbind.add(this);\n        }\n        this.state = (this.state | 6 /* isBoundOrUnbinding */) ^ 6 /* isBoundOrUnbinding */;\n        this.lifecycle.afterUnbind.end(flags);\n    }\n    // #endregion\n    // #region attach/detach\n    attachCustomElement(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.mount.add(this);\n        this.lifecycle.afterAttach.begin();\n        if (this.hooks.hasBeforeAttach) {\n            this.bindingContext.beforeAttach(flags);\n        }\n        this.attachControllers(flags);\n        if (this.hooks.hasAfterAttach) {\n            this.lifecycle.afterAttach.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.afterAttach.end(flags);\n    }\n    attachCustomAttribute(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.afterAttach.begin();\n        if (this.hooks.hasBeforeAttach) {\n            this.bindingContext.beforeAttach(flags);\n        }\n        if (this.hooks.hasAfterAttach) {\n            this.lifecycle.afterAttach.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.afterAttach.end(flags);\n    }\n    attachSynthetic(flags) {\n        if (((this.state & 32 /* isAttached */) > 0 && flags & 33554432 /* reorderNodes */) > 0) {\n            this.lifecycle.mount.add(this);\n        }\n        else {\n            flags |= 16384 /* fromAttach */;\n            this.state |= 8 /* isAttaching */;\n            this.lifecycle.mount.add(this);\n            this.lifecycle.afterAttach.begin();\n            this.attachControllers(flags);\n            this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n            this.lifecycle.afterAttach.end(flags);\n        }\n    }\n    detachCustomElement(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        this.lifecycle.unmount.add(this);\n        if (this.hooks.hasBeforeDetach) {\n            this.bindingContext.beforeDetach(flags);\n        }\n        this.detachControllers(flags);\n        if (this.hooks.hasAfterDetach) {\n            this.lifecycle.afterDetach.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    detachCustomAttribute(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        if (this.hooks.hasBeforeDetach) {\n            this.bindingContext.beforeDetach(flags);\n        }\n        if (this.hooks.hasAfterDetach) {\n            this.lifecycle.afterDetach.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    detachSynthetic(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        this.lifecycle.unmount.add(this);\n        this.detachControllers(flags);\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    attachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].attach(flags);\n            }\n        }\n    }\n    detachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                controllers[i].detach(flags);\n            }\n        }\n    }\n    // #endregion\n    // #region mount/unmount/cache\n    mountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) > 0) {\n            return;\n        }\n        this.state |= 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.project(this.nodes); // non-null is implied by the hook\n    }\n    mountSynthetic(flags) {\n        const nodes = this.nodes; // non null is implied by the hook\n        const location = this.location; // non null is implied by the hook\n        this.state |= 64 /* isMounted */;\n        switch (this.mountStrategy) {\n            case 2 /* append */:\n                nodes.appendTo(location);\n                break;\n            default:\n                nodes.insertBefore(location);\n        }\n    }\n    unmountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.take(this.nodes); // non-null is implied by the hook\n    }\n    unmountSynthetic(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return false;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.nodes.remove(); // non-null is implied by the hook\n        this.nodes.unlink();\n        if ((this.state & 512 /* canBeCached */) > 0) {\n            this.state = (this.state | 512 /* canBeCached */) ^ 512 /* canBeCached */;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            if (this.viewFactory.tryReturnToCache(this)) { // non-null is implied by the hook\n                return true;\n            }\n        }\n        return false;\n    }\n    cacheCustomElement(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n    }\n    cacheCustomAttribute(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n    cacheSynthetic(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n}\nfunction getBindingContext(flags, instance) {\n    if (instance.noProxy === true || (flags & 2 /* proxyStrategy */) === 0) {\n        return instance;\n    }\n    return ProxyObserver.getOrCreate(instance).proxy;\n}\nfunction getLookup(instance) {\n    let lookup = instance.$observers;\n    if (lookup === void 0) {\n        Reflect.defineProperty(instance, '$observers', {\n            enumerable: false,\n            value: lookup = {},\n        });\n    }\n    return lookup;\n}\nfunction createObservers(lifecycle, definition, flags, instance) {\n    const bindables = definition.bindables;\n    const observableNames = Object.getOwnPropertyNames(bindables);\n    const length = observableNames.length;\n    if (length > 0) {\n        let name;\n        let bindable;\n        if ((flags & 2 /* proxyStrategy */) > 0) {\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                bindable = bindables[name];\n                new BindableObserver(lifecycle, flags, ProxyObserver.getOrCreate(instance).proxy, name, bindable.callback, bindable.set);\n            }\n        }\n        else {\n            const observers = getLookup(instance);\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                if (observers[name] === void 0) {\n                    bindable = bindables[name];\n                    observers[name] = new BindableObserver(lifecycle, flags, instance, name, bindable.callback, bindable.set);\n                }\n            }\n        }\n    }\n}\nfunction createChildrenObservers(controller, definition, flags, instance) {\n    const childrenObservers = definition.childrenObservers;\n    const childObserverNames = Object.getOwnPropertyNames(childrenObservers);\n    const length = childObserverNames.length;\n    if (length > 0) {\n        const observers = getLookup(instance);\n        let name;\n        for (let i = 0; i < length; ++i) {\n            name = childObserverNames[i];\n            if (observers[name] == void 0) {\n                const childrenDescription = childrenObservers[name];\n                observers[name] = new ChildrenObserver(controller, instance, flags, name, childrenDescription.callback, childrenDescription.query, childrenDescription.filter, childrenDescription.map, childrenDescription.options);\n            }\n        }\n    }\n}\n//# sourceMappingURL=controller.js.map","import { DI, Registration, Metadata, Protocol } from '@aurelia/kernel';\nimport { Scope } from '../observation/binding-context';\nimport { CustomElement, CustomElementDefinition } from '../resources/custom-element';\nimport { Controller } from './controller';\nimport { mergeParts } from '../definitions';\nimport { getRenderContext } from './render-context';\nexport class ViewFactory {\n    constructor(name, context, lifecycle, parts) {\n        this.name = name;\n        this.context = context;\n        this.lifecycle = lifecycle;\n        this.parts = parts;\n        this.isCaching = false;\n        this.cache = null;\n        this.cacheSize = -1;\n    }\n    setCacheSize(size, doNotOverrideIfAlreadySet) {\n        if (size) {\n            if (size === '*') {\n                size = ViewFactory.maxCacheSize;\n            }\n            else if (typeof size === 'string') {\n                size = parseInt(size, 10);\n            }\n            if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n                this.cacheSize = size;\n            }\n        }\n        if (this.cacheSize > 0) {\n            this.cache = [];\n        }\n        else {\n            this.cache = null;\n        }\n        this.isCaching = this.cacheSize > 0;\n    }\n    canReturnToCache(controller) {\n        return this.cache != null && this.cache.length < this.cacheSize;\n    }\n    tryReturnToCache(controller) {\n        if (this.canReturnToCache(controller)) {\n            controller.cache(0 /* none */);\n            this.cache.push(controller);\n            return true;\n        }\n        return false;\n    }\n    create(flags) {\n        const cache = this.cache;\n        let controller;\n        if (cache != null && cache.length > 0) {\n            controller = cache.pop();\n            return controller;\n        }\n        controller = Controller.forSyntheticView(this, this.lifecycle, this.context, flags);\n        return controller;\n    }\n    resolve(requestor, parts) {\n        parts = mergeParts(this.parts, parts);\n        if (parts === void 0) {\n            return this;\n        }\n        const part = parts[this.name];\n        if (part === void 0) {\n            return this;\n        }\n        return getRenderContext(part, requestor, parts).getViewFactory(this.name);\n    }\n}\nViewFactory.maxCacheSize = 0xFFFF;\nconst seenViews = new WeakSet();\nfunction notYetSeen($view) {\n    return !seenViews.has($view);\n}\nfunction toCustomElementDefinition($view) {\n    seenViews.add($view);\n    return CustomElementDefinition.create($view);\n}\nexport const Views = {\n    name: Protocol.resource.keyFor('views'),\n    has(value) {\n        return typeof value === 'function' && (Metadata.hasOwn(Views.name, value) || '$views' in value);\n    },\n    get(value) {\n        if (typeof value === 'function' && '$views' in value) {\n            // TODO: a `get` operation with side effects is not a good thing. Should refactor this to a proper resource kind.\n            const $views = value.$views;\n            const definitions = $views.filter(notYetSeen).map(toCustomElementDefinition);\n            for (const def of definitions) {\n                Views.add(value, def);\n            }\n        }\n        let views = Metadata.getOwn(Views.name, value);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [], value);\n        }\n        return views;\n    },\n    add(Type, partialDefinition) {\n        const definition = CustomElementDefinition.create(partialDefinition);\n        let views = Metadata.getOwn(Views.name, Type);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [definition], Type);\n        }\n        else {\n            views.push(definition);\n        }\n        return views;\n    },\n};\nexport function view(v) {\n    return function (target) {\n        Views.add(target, v);\n    };\n}\nexport const IViewLocator = DI.createInterface('IViewLocator')\n    .noDefault();\nexport class ViewLocator {\n    constructor() {\n        this.modelInstanceToBoundComponent = new WeakMap();\n        this.modelTypeToUnboundComponent = new Map();\n    }\n    static register(container) {\n        return Registration.singleton(IViewLocator, this).register(container);\n    }\n    getViewComponentForObject(object, viewNameOrSelector) {\n        if (object) {\n            const availableViews = Views.has(object.constructor) ? Views.get(object.constructor) : [];\n            const resolvedViewName = typeof viewNameOrSelector === 'function'\n                ? viewNameOrSelector(object, availableViews)\n                : this.getViewName(availableViews, viewNameOrSelector);\n            return this.getOrCreateBoundComponent(object, availableViews, resolvedViewName);\n        }\n        return null;\n    }\n    getOrCreateBoundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelInstanceToBoundComponent.get(object);\n        let BoundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelInstanceToBoundComponent.set(object, lookup);\n        }\n        else {\n            BoundComponent = lookup[resolvedViewName];\n        }\n        if (BoundComponent === void 0) {\n            const UnboundComponent = this.getOrCreateUnboundComponent(object, availableViews, resolvedViewName);\n            BoundComponent = CustomElement.define(CustomElement.getDefinition(UnboundComponent), class extends UnboundComponent {\n                constructor() {\n                    super(object);\n                }\n            });\n            lookup[resolvedViewName] = BoundComponent;\n        }\n        return BoundComponent;\n    }\n    getOrCreateUnboundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelTypeToUnboundComponent.get(object.constructor);\n        let UnboundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelTypeToUnboundComponent.set(object.constructor, lookup);\n        }\n        else {\n            UnboundComponent = lookup[resolvedViewName];\n        }\n        if (UnboundComponent === void 0) {\n            UnboundComponent = CustomElement.define(this.getView(availableViews, resolvedViewName), class {\n                constructor(viewModel) {\n                    this.viewModel = viewModel;\n                }\n                create(controller, parentContainer, definition, parts) {\n                    const vm = this.viewModel;\n                    controller.scope = Scope.fromParent(controller.flags, controller.scope, vm);\n                    if (vm.create !== void 0) {\n                        return vm.create(controller, parentContainer, definition, parts);\n                    }\n                }\n            });\n            const proto = UnboundComponent.prototype;\n            if ('beforeCompile' in object) {\n                proto.beforeCompile = function beforeCompile(controller) {\n                    this.viewModel.beforeCompile(controller);\n                };\n            }\n            if ('afterCompile' in object) {\n                proto.afterCompile = function afterCompile(controller) {\n                    this.viewModel.afterCompile(controller);\n                };\n            }\n            if ('afterCompileChildren' in object) {\n                proto.afterCompileChildren = function afterCompileChildren(controller) {\n                    this.viewModel.afterCompileChildren(controller);\n                };\n            }\n            if ('beforeBind' in object) {\n                proto.beforeBind = function beforeBind(flags) {\n                    return this.viewModel.beforeBind(flags);\n                };\n            }\n            if ('afterBind' in object) {\n                proto.afterBind = function afterBind(flags) {\n                    this.viewModel.afterBind(flags);\n                };\n            }\n            if ('beforeUnbind' in object) {\n                proto.beforeUnbind = function beforeUnbind(flags) {\n                    return this.viewModel.beforeUnbind(flags);\n                };\n            }\n            if ('afterUnbind' in object) {\n                proto.afterUnbind = function afterUnbind(flags) {\n                    this.viewModel.afterUnbind(flags);\n                };\n            }\n            if ('beforeAttach' in object) {\n                proto.beforeAttach = function beforeAttach(flags) {\n                    this.viewModel.beforeAttach(flags);\n                };\n            }\n            if ('afterAttach' in object) {\n                proto.afterAttach = function afterAttach(flags) {\n                    this.viewModel.afterAttach(flags);\n                };\n            }\n            if ('beforeDetach' in object) {\n                proto.beforeDetach = function beforeDetach(flags) {\n                    this.viewModel.beforeDetach(flags);\n                };\n            }\n            if ('afterDetach' in object) {\n                proto.afterDetach = function afterDetach(flags) {\n                    this.viewModel.afterDetach(flags);\n                };\n            }\n            if ('caching' in object) {\n                proto.caching = function caching(flags) {\n                    this.viewModel.caching(flags);\n                };\n            }\n            lookup[resolvedViewName] = UnboundComponent;\n        }\n        return UnboundComponent;\n    }\n    getViewName(views, requestedName) {\n        if (requestedName) {\n            return requestedName;\n        }\n        if (views.length === 1) {\n            return views[0].name;\n        }\n        return 'default-view';\n    }\n    getView(views, name) {\n        const v = views.find(x => x.name === name);\n        if (v === void 0) {\n            // TODO: Use Reporter\n            throw new Error(`Could not find view: ${name}`);\n        }\n        return v;\n    }\n}\n//# sourceMappingURL=view.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IViewLocator } from '../../templating/view';\nimport { valueConverter } from '../value-converter';\nlet ViewValueConverter = class ViewValueConverter {\n    constructor(viewLocator) {\n        this.viewLocator = viewLocator;\n    }\n    toView(object, viewNameOrSelector) {\n        return this.viewLocator.getViewComponentForObject(object, viewNameOrSelector);\n    }\n};\nViewValueConverter = __decorate([\n    valueConverter('view'),\n    __param(0, IViewLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], ViewValueConverter);\nexport { ViewValueConverter };\n//# sourceMappingURL=view.js.map","import { DI, Registration, } from '@aurelia/kernel';\nimport { ILifecycle } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, } from './lifecycle-task';\nimport { Controller } from './templating/controller';\nexport const IActivator = DI.createInterface('IActivator').withDefault(x => x.singleton(Activator));\n/** @internal */\nexport class Activator {\n    constructor(taskManager) {\n        this.taskManager = taskManager;\n    }\n    static register(container) {\n        return Registration.singleton(IActivator, this).register(container);\n    }\n    activate(host, component, container, flags = 1024 /* fromStartTask */, parentScope) {\n        flags = flags === void 0 ? 0 /* none */ : flags;\n        const mgr = this.taskManager;\n        let task = mgr.runBeforeRender();\n        if (task.done) {\n            this.render(host, component, container, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.render, this, host, component, container, flags);\n        }\n        if (task.done) {\n            task = mgr.runBeforeBind();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeBind, mgr);\n        }\n        if (task.done) {\n            task = this.bind(component, flags, parentScope);\n        }\n        else {\n            task = new ContinuationTask(task, this.bind, this, component, flags, parentScope);\n        }\n        if (task.done) {\n            task = mgr.runBeforeAttach();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeAttach, mgr);\n        }\n        if (task.done) {\n            this.attach(component, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attach, this, component, flags);\n        }\n        return task;\n    }\n    deactivate(component, flags = 2048 /* fromStopTask */) {\n        const controller = Controller.getCachedOrThrow(component);\n        controller.detach(flags | 32768 /* fromDetach */);\n        return controller.unbind(flags | 8192 /* fromUnbind */);\n    }\n    render(host, component, container, flags) {\n        const lifecycle = container.get(ILifecycle);\n        Controller.forCustomElement(component, lifecycle, host, container, void 0, flags);\n    }\n    bind(component, flags, parentScope) {\n        return Controller.getCachedOrThrow(component).bind(flags | 4096 /* fromBind */, parentScope);\n    }\n    attach(component, flags) {\n        Controller.getCachedOrThrow(component).attach(flags | 16384 /* fromAttach */);\n    }\n}\nActivator.inject = [IStartTaskManager];\n//# sourceMappingURL=activator.js.map","import { DI, PLATFORM, Registration } from '@aurelia/kernel';\nimport { IActivator } from './activator';\nimport { INode } from './dom';\nimport { ILifecycle, } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, LifecycleTask, } from './lifecycle-task';\nimport { CustomElement } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nexport class CompositionRoot {\n    constructor(config, container) {\n        this.config = config;\n        if (config.host != void 0) {\n            if (container.has(INode, false)) {\n                this.container = container.createChild();\n            }\n            else {\n                this.container = container;\n            }\n            Registration.instance(INode, config.host).register(this.container);\n            this.host = config.host;\n        }\n        else if (container.has(INode, true)) {\n            this.container = container;\n            this.host = container.get(INode);\n        }\n        else {\n            throw new Error(`No host element found.`);\n        }\n        this.strategy = config.strategy != void 0 ? config.strategy : 1 /* getterSetter */;\n        const initializer = this.container.get(IDOMInitializer);\n        this.dom = initializer.initialize(config);\n        this.lifecycle = this.container.get(ILifecycle);\n        this.activator = this.container.get(IActivator);\n        const taskManager = this.container.get(IStartTaskManager);\n        const beforeCreateTask = taskManager.runBeforeCreate();\n        if (beforeCreateTask.done) {\n            this.task = LifecycleTask.done;\n            this.create();\n        }\n        else {\n            this.task = new ContinuationTask(beforeCreateTask, this.create, this);\n        }\n    }\n    activate(antecedent) {\n        const { task, host, viewModel, container, activator, strategy } = this;\n        const flags = strategy | 1024 /* fromStartTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.activate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.activate(host, viewModel, container, flags, void 0);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        return this.task;\n    }\n    deactivate(antecedent) {\n        const { task, viewModel, activator, strategy } = this;\n        const flags = strategy | 2048 /* fromStopTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.deactivate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.deactivate(viewModel, flags);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.deactivate, activator, viewModel, flags);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        return this.task;\n    }\n    create() {\n        const config = this.config;\n        const instance = this.viewModel = CustomElement.isType(config.component)\n            ? this.container.get(config.component)\n            : config.component;\n        const container = this.container;\n        const lifecycle = container.get(ILifecycle);\n        this.controller = Controller.forCustomElement(instance, lifecycle, this.host, container, void 0, this.strategy);\n    }\n}\nexport class Aurelia {\n    constructor(container = DI.createContainer()) {\n        this.container = container;\n        this.task = LifecycleTask.done;\n        this._isRunning = false;\n        this._isStarting = false;\n        this._isStopping = false;\n        this._root = void 0;\n        this.next = (void 0);\n        Registration.instance(Aurelia, this).register(container);\n    }\n    get isRunning() {\n        return this._isRunning;\n    }\n    get isStarting() {\n        return this._isStarting;\n    }\n    get isStopping() {\n        return this._isStopping;\n    }\n    get root() {\n        if (this._root == void 0) {\n            if (this.next == void 0) {\n                throw new Error(`root is not defined`); // TODO: create error code\n            }\n            return this.next;\n        }\n        return this._root;\n    }\n    register(...params) {\n        this.container.register(...params);\n        return this;\n    }\n    app(config) {\n        this.next = new CompositionRoot(config, this.container);\n        if (this.isRunning) {\n            this.start();\n        }\n        return this;\n    }\n    start(root = this.next) {\n        if (root == void 0) {\n            throw new Error(`There is no composition root`); // TODO: create error code\n        }\n        this.stop(root);\n        if (this.task.done) {\n            this.onBeforeStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onBeforeStart, this, root);\n        }\n        this.task = this.root.activate(this.task);\n        if (this.task.done) {\n            this.task = this.onAfterStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onAfterStart, this, root);\n        }\n        return this.task;\n    }\n    stop(root = this._root) {\n        if (this._isRunning && root != void 0) {\n            if (this.task.done) {\n                this.onBeforeStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onBeforeStop, this, root);\n            }\n            this.task = root.deactivate(this.task);\n            if (this.task.done) {\n                this.task = this.onAfterStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onAfterStop, this, root);\n            }\n        }\n        return this.task;\n    }\n    wait() {\n        return this.task.wait();\n    }\n    onBeforeStart(root) {\n        Reflect.set(root.host, '$aurelia', this);\n        this._root = root;\n        this._isStarting = true;\n    }\n    onAfterStart(root) {\n        this._isRunning = true;\n        this._isStarting = false;\n        this.dispatchEvent(root, 'aurelia-composed', root.dom);\n        this.dispatchEvent(root, 'au-started', root.host);\n        return LifecycleTask.done;\n    }\n    onBeforeStop(root) {\n        this._isRunning = false;\n        this._isStopping = true;\n    }\n    onAfterStop(root) {\n        Reflect.deleteProperty(root.host, '$aurelia');\n        this._root = void 0;\n        this._isStopping = false;\n        this.dispatchEvent(root, 'au-stopped', root.host);\n        return LifecycleTask.done;\n    }\n    dispatchEvent(root, name, target) {\n        target = 'dispatchEvent' in target ? target : root.dom;\n        target.dispatchEvent(root.dom.createCustomEvent(name, { detail: this, bubbles: true, cancelable: true }));\n    }\n}\nPLATFORM.global.Aurelia = Aurelia;\nexport const IDOMInitializer = DI.createInterface('IDOMInitializer').noDefault();\n//# sourceMappingURL=aurelia.js.map","import { DI } from '@aurelia/kernel';\nimport { Lifecycle } from './lifecycle';\nimport { StartTaskManager } from './lifecycle-task';\nimport { ObserverLocator } from './observation/observer-locator';\nimport { CallBindingRenderer, CustomAttributeRenderer, CustomElementRenderer, InterpolationBindingRenderer, IteratorBindingRenderer, LetElementRenderer, PropertyBindingRenderer, RefBindingRenderer, Renderer, SetPropertyRenderer, TemplateControllerRenderer } from './renderer';\nimport { FromViewBindingBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nimport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nimport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nimport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nimport { FrequentMutations, InfrequentMutations, ObserveShallow } from './resources/custom-attributes/flags';\nimport { Else, If } from './resources/custom-attributes/if';\nimport { Repeat } from './resources/custom-attributes/repeat';\nimport { Replaceable } from './resources/custom-attributes/replaceable';\nimport { With } from './resources/custom-attributes/with';\nimport { SanitizeValueConverter } from './resources/value-converters/sanitize';\nimport { ViewValueConverter } from './resources/value-converters/view';\nimport { ViewLocator } from './templating/view';\nimport { Now } from '@aurelia/scheduler';\nexport const IObserverLocatorRegistration = ObserverLocator;\nexport const ILifecycleRegistration = Lifecycle;\nexport const IRendererRegistration = Renderer;\nexport const IStartTaskManagerRegistration = StartTaskManager;\nexport const IViewLocatorRegistration = ViewLocator;\n/**\n * Default implementations for the following interfaces:\n * - `IObserverLocator`\n * - `ILifecycle`\n * - `IRenderer`\n * - `IStartTaskManager`\n * - `IViewLocator`\n * - `IClockRegistration`\n * - `ISchedulerRegistration`\n */\nexport const DefaultComponents = [\n    IObserverLocatorRegistration,\n    ILifecycleRegistration,\n    IRendererRegistration,\n    IStartTaskManagerRegistration,\n    IViewLocatorRegistration,\n    Now,\n];\nexport const FrequentMutationsRegistration = FrequentMutations;\nexport const InfrequentMutationsRegistration = InfrequentMutations;\nexport const ObserveShallowRegistration = ObserveShallow;\nexport const IfRegistration = If;\nexport const ElseRegistration = Else;\nexport const RepeatRegistration = Repeat;\nexport const ReplaceableRegistration = Replaceable;\nexport const WithRegistration = With;\nexport const SanitizeValueConverterRegistration = SanitizeValueConverter;\nexport const ViewValueConverterRegistration = ViewValueConverter;\nexport const DebounceBindingBehaviorRegistration = DebounceBindingBehavior;\nexport const OneTimeBindingBehaviorRegistration = OneTimeBindingBehavior;\nexport const ToViewBindingBehaviorRegistration = ToViewBindingBehavior;\nexport const FromViewBindingBehaviorRegistration = FromViewBindingBehavior;\nexport const SignalBindingBehaviorRegistration = SignalBindingBehavior;\nexport const ThrottleBindingBehaviorRegistration = ThrottleBindingBehavior;\nexport const TwoWayBindingBehaviorRegistration = TwoWayBindingBehavior;\n/**\n * Default resources:\n * - Template controllers (`if`/`else`, `repeat`, `replaceable`, `with`)\n * - Value Converters (`sanitize`)\n * - Binding Behaviors (`oneTime`, `toView`, `fromView`, `twoWay`, `signal`, `debounce`, `throttle`)\n */\nexport const DefaultResources = [\n    FrequentMutationsRegistration,\n    InfrequentMutationsRegistration,\n    ObserveShallowRegistration,\n    IfRegistration,\n    ElseRegistration,\n    RepeatRegistration,\n    ReplaceableRegistration,\n    WithRegistration,\n    SanitizeValueConverterRegistration,\n    ViewValueConverterRegistration,\n    DebounceBindingBehaviorRegistration,\n    OneTimeBindingBehaviorRegistration,\n    ToViewBindingBehaviorRegistration,\n    FromViewBindingBehaviorRegistration,\n    SignalBindingBehaviorRegistration,\n    ThrottleBindingBehaviorRegistration,\n    TwoWayBindingBehaviorRegistration\n];\nexport const CallBindingRendererRegistration = CallBindingRenderer;\nexport const CustomAttributeRendererRegistration = CustomAttributeRenderer;\nexport const CustomElementRendererRegistration = CustomElementRenderer;\nexport const InterpolationBindingRendererRegistration = InterpolationBindingRenderer;\nexport const IteratorBindingRendererRegistration = IteratorBindingRenderer;\nexport const LetElementRendererRegistration = LetElementRenderer;\nexport const PropertyBindingRendererRegistration = PropertyBindingRenderer;\nexport const RefBindingRendererRegistration = RefBindingRenderer;\nexport const SetPropertyRendererRegistration = SetPropertyRenderer;\nexport const TemplateControllerRendererRegistration = TemplateControllerRenderer;\n/**\n * Default renderers for:\n * - PropertyBinding: `bind`, `one-time`, `to-view`, `from-view`, `two-way`\n * - IteratorBinding: `for`\n * - CallBinding: `call`\n * - RefBinding: `ref`\n * - InterpolationBinding: `${}`\n * - SetProperty\n * - `customElement` hydration\n * - `customAttribute` hydration\n * - `templateController` hydration\n * - `let` element hydration\n */\nexport const DefaultRenderers = [\n    PropertyBindingRendererRegistration,\n    IteratorBindingRendererRegistration,\n    CallBindingRendererRegistration,\n    RefBindingRendererRegistration,\n    InterpolationBindingRendererRegistration,\n    SetPropertyRendererRegistration,\n    CustomElementRendererRegistration,\n    CustomAttributeRendererRegistration,\n    TemplateControllerRendererRegistration,\n    LetElementRendererRegistration\n];\n/**\n * A DI configuration object containing environment/runtime-agnostic registrations:\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { BindingMode } from './flags';\nexport class InterpolationInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rf\" /* interpolation */;\n    }\n}\nexport class OneTimeBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.oneTime;\n        this.oneTime = true;\n    }\n}\nexport class ToViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.toView;\n        this.oneTime = false;\n    }\n}\nexport class FromViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.fromView;\n        this.oneTime = false;\n    }\n}\nexport class TwoWayBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.twoWay;\n        this.oneTime = false;\n    }\n}\nexport class IteratorBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rk\" /* iteratorBinding */;\n    }\n}\nexport class CallBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rh\" /* callBinding */;\n    }\n}\nexport class RefBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rj\" /* refBinding */;\n        this.type = \"rj\" /* refBinding */;\n    }\n}\nexport class SetPropertyInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"re\" /* setProperty */;\n    }\n}\nexport class HydrateElementInstruction {\n    constructor(res, instructions, parts) {\n        this.res = res;\n        this.instructions = instructions;\n        this.parts = parts;\n        this.type = \"ra\" /* hydrateElement */;\n    }\n}\nexport class HydrateAttributeInstruction {\n    constructor(res, instructions) {\n        this.res = res;\n        this.instructions = instructions;\n        this.type = \"rb\" /* hydrateAttribute */;\n    }\n}\nexport class HydrateTemplateController {\n    constructor(def, res, instructions, link, parts) {\n        this.def = def;\n        this.res = res;\n        this.instructions = instructions;\n        this.link = link;\n        this.parts = parts;\n        this.type = \"rc\" /* hydrateTemplateController */;\n    }\n}\nexport class LetElementInstruction {\n    constructor(instructions, toBindingContext) {\n        this.instructions = instructions;\n        this.toBindingContext = toBindingContext;\n        this.type = \"rd\" /* hydrateLetElement */;\n    }\n}\nexport class LetBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"ri\" /* letBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","export { CallFunctionExpression, connects, observes, callsFunction, hasAncestor, isAssignable, isLeftHandSide, isPrimary, isResource, hasBind, hasUnbind, isLiteral, arePureLiterals, isPureLiteral, CustomExpression, BindingBehaviorExpression, ValueConverterExpression, AssignExpression, ConditionalExpression, AccessThisExpression, AccessScopeExpression, AccessMemberExpression, AccessKeyedExpression, CallScopeExpression, CallMemberExpression, BinaryExpression, UnaryExpression, PrimitiveLiteralExpression, HtmlLiteralExpression, ArrayLiteralExpression, ObjectLiteralExpression, TemplateExpression, TaggedTemplateExpression, ArrayBindingPattern, ObjectBindingPattern, BindingIdentifier, ForOfStatement, Interpolation } from './binding/ast';\nexport { PropertyBinding } from './binding/property-binding';\nexport { CallBinding } from './binding/call-binding';\nexport { connectable, BindingMediator } from './binding/connectable';\nexport { IExpressionParser, BindingType } from './binding/expression-parser';\nexport { MultiInterpolationBinding, InterpolationBinding } from './binding/interpolation-binding';\nexport { LetBinding } from './binding/let-binding';\nexport { RefBinding } from './binding/ref-binding';\nexport { ArrayObserver, ArrayIndexObserver, enableArrayObservation, disableArrayObservation, applyMutationsToIndices, synchronizeIndices, } from './observation/array-observer';\nexport { MapObserver, enableMapObservation, disableMapObservation } from './observation/map-observer';\nexport { SetObserver, enableSetObservation, disableSetObservation } from './observation/set-observer';\nexport { BindingContext, Scope, OverrideContext } from './observation/binding-context';\nexport { CollectionLengthObserver, } from './observation/collection-length-observer';\nexport { CollectionSizeObserver, } from './observation/collection-size-observer';\nexport { computed, createComputedObserver, CustomSetterObserver, GetterObserver } from './observation/computed-observer';\nexport { IDirtyChecker, DirtyCheckProperty, DirtyCheckSettings } from './observation/dirty-checker';\nexport { IObserverLocator, ITargetObserverLocator, ITargetAccessorLocator, getCollectionObserver, ObserverLocator } from './observation/observer-locator';\nexport { PrimitiveObserver } from './observation/primitive-observer';\nexport { PropertyAccessor } from './observation/property-accessor';\nexport { ProxyObserver } from './observation/proxy-observer';\nexport { BindableObserver } from './observation/bindable-observer';\nexport { SetterObserver } from './observation/setter-observer';\nexport { ISignaler } from './observation/signaler';\nexport { subscriberCollection, collectionSubscriberCollection, proxySubscriberCollection, } from './observation/subscriber-collection';\nexport { bindingBehavior, BindingBehavior, BindingBehaviorDefinition, BindingInterceptor } from './resources/binding-behavior';\nexport { BindingModeBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, FromViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nexport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nexport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nexport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nexport { customAttribute, CustomAttribute, CustomAttributeDefinition, templateController, } from './resources/custom-attribute';\nexport { FrequentMutations, InfrequentMutations, ObserveShallow, } from './resources/custom-attributes/flags';\nexport { If, Else } from './resources/custom-attributes/if';\nexport { Repeat } from './resources/custom-attributes/repeat';\nexport { Replaceable } from './resources/custom-attributes/replaceable';\nexport { With } from './resources/custom-attributes/with';\nexport { containerless, customElement, CustomElement, CustomElementDefinition, IProjectorLocator, useShadowDOM } from './resources/custom-element';\nexport { ValueConverter, ValueConverterDefinition, valueConverter, } from './resources/value-converter';\nexport { ISanitizer, SanitizeValueConverter } from './resources/value-converters/sanitize';\nexport { ViewValueConverter } from './resources/value-converters/view';\nexport { Now, IScheduler, Task, TaskAbortError, TaskQueue, TaskQueuePriority, } from '@aurelia/scheduler';\nexport { bindable, BindableDefinition, Bindable, } from './templating/bindable';\nexport { ChildrenDefinition, Children, children, ChildrenObserver, } from './templating/children';\n// These exports are temporary until we have a proper way to unit test them\nexport { Controller, } from './templating/controller';\nexport { ViewFactory, IViewLocator, ViewLocator, view, Views, } from './templating/view';\nexport { Aurelia, IDOMInitializer, CompositionRoot, } from './aurelia';\nexport { IfRegistration, ElseRegistration, RepeatRegistration, ReplaceableRegistration, WithRegistration, SanitizeValueConverterRegistration, DebounceBindingBehaviorRegistration, OneTimeBindingBehaviorRegistration, ToViewBindingBehaviorRegistration, FromViewBindingBehaviorRegistration, SignalBindingBehaviorRegistration, ThrottleBindingBehaviorRegistration, TwoWayBindingBehaviorRegistration, RefBindingRendererRegistration, CallBindingRendererRegistration, CustomAttributeRendererRegistration, CustomElementRendererRegistration, InterpolationBindingRendererRegistration, IteratorBindingRendererRegistration, LetElementRendererRegistration, PropertyBindingRendererRegistration, SetPropertyRendererRegistration, TemplateControllerRendererRegistration, DefaultResources, IObserverLocatorRegistration, ILifecycleRegistration, IRendererRegistration, RuntimeConfiguration } from './configuration';\nexport { HooksDefinition, isTargetedInstruction, ITargetedInstruction, TargetedInstructionType, alias, registerAliases } from './definitions';\nexport { DOM, INode, IRenderLocation, IDOM, NodeSequence } from './dom';\nexport { BindingMode, BindingStrategy, ExpressionKind, LifecycleFlags, State } from './flags';\nexport { CallBindingInstruction, FromViewBindingInstruction, HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, InterpolationInstruction, IteratorBindingInstruction, LetBindingInstruction, LetElementInstruction, OneTimeBindingInstruction, RefBindingInstruction, SetPropertyInstruction, ToViewBindingInstruction, TwoWayBindingInstruction } from './instructions';\nexport { ViewModelKind, ILifecycle, IController, IViewFactory, MountStrategy, } from './lifecycle';\nexport { getRenderContext, isRenderContext, } from './templating/render-context';\nexport { AggregateContinuationTask, TerminalTask, AggregateTerminalTask, ContinuationTask, LifecycleTask, PromiseTask, TaskSlot, StartTask, IStartTask, IStartTaskManager, ProviderTask, } from './lifecycle-task';\nexport { CollectionKind, DelegationStrategy, isIndexMap, copyIndexMap, cloneIndexMap, createIndexMap, } from './observation';\nexport { applyBindingBehavior, IInstructionRenderer, IRenderer, ITemplateCompiler, instructionRenderer, ensureExpression, } from './renderer';\n//# sourceMappingURL=index.js.map","import { hasBind, hasUnbind } from '@aurelia/runtime';\n/**\n * Listener binding. Handle event binding between view and view model\n */\nexport class Listener {\n    constructor(dom, targetEvent, delegationStrategy, sourceExpression, target, preventDefault, eventManager, locator) {\n        this.dom = dom;\n        this.targetEvent = targetEvent;\n        this.delegationStrategy = delegationStrategy;\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.preventDefault = preventDefault;\n        this.eventManager = eventManager;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n    }\n    callSource(event) {\n        const overrideContext = this.$scope.overrideContext;\n        overrideContext.$event = event;\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        Reflect.deleteProperty(overrideContext, '$event');\n        if (result !== true && this.preventDefault) {\n            event.preventDefault();\n        }\n        return result;\n    }\n    handleEvent(event) {\n        this.interceptor.callSource(event);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        this.handler = this.eventManager.addEventListener(this.dom, this.target, this.targetEvent, this, this.delegationStrategy);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = null;\n        this.handler.dispose();\n        this.handler = null;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=listener.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { DOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\n/**\n * Observer for handling two-way binding with attributes\n * Has different strategy for class/style and normal attributes\n * TODO: handle SVG/attributes with namespace\n */\nlet AttributeObserver = class AttributeObserver {\n    constructor(scheduler, flags, observerLocator, obj, propertyKey, targetAttribute) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.targetAttribute = targetAttribute;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            switch (this.targetAttribute) {\n                case 'class': {\n                    // Why is class attribute observer setValue look different with class attribute accessor?\n                    // ==============\n                    // For class list\n                    // newValue is simply checked if truthy or falsy\n                    // and toggle the class accordingly\n                    // -- the rule of this is quite different to normal attribute\n                    //\n                    // for class attribute, observer is different in a way that it only observe a particular class at a time\n                    // this also comes from syntax, where it would typically be my-class.class=\"someProperty\"\n                    //\n                    // so there is no need for separating class by space and add all of them like class accessor\n                    if (!!currentValue) {\n                        this.obj.classList.add(this.propertyKey);\n                    }\n                    else {\n                        this.obj.classList.remove(this.propertyKey);\n                    }\n                    break;\n                }\n                case 'style': {\n                    let priority = '';\n                    let newValue = currentValue;\n                    if (typeof newValue === 'string' && newValue.includes('!important')) {\n                        priority = 'important';\n                        newValue = newValue.replace('!important', '');\n                    }\n                    this.obj.style.setProperty(this.propertyKey, newValue, priority);\n                }\n            }\n        }\n    }\n    handleMutation(mutationRecords) {\n        let shouldProcess = false;\n        for (let i = 0, ii = mutationRecords.length; ii > i; ++i) {\n            const record = mutationRecords[i];\n            if (record.type === 'attributes' && record.attributeName === this.propertyKey) {\n                shouldProcess = true;\n                break;\n            }\n        }\n        if (shouldProcess) {\n            let newValue;\n            switch (this.targetAttribute) {\n                case 'class':\n                    newValue = this.obj.classList.contains(this.propertyKey);\n                    break;\n                case 'style':\n                    newValue = this.obj.style.getPropertyValue(this.propertyKey);\n                    break;\n                default:\n                    throw new Error(`Unsupported targetAttribute: ${this.targetAttribute}`);\n            }\n            if (newValue !== this.currentValue) {\n                const { currentValue } = this;\n                this.currentValue = this.oldValue = newValue;\n                this.hasChanges = false;\n                this.callSubscribers(newValue, currentValue, 131072 /* fromDOMEvent */);\n            }\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n            startObservation(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            stopObservation(this.obj, this);\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nAttributeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String, String])\n], AttributeObserver);\nexport { AttributeObserver };\nconst startObservation = (element, subscription) => {\n    if (element.$eMObservers === undefined) {\n        element.$eMObservers = new Set();\n    }\n    if (element.$mObserver === undefined) {\n        element.$mObserver = DOM.createNodeObserver(element, handleMutation, { attributes: true });\n    }\n    element.$eMObservers.add(subscription);\n};\nconst stopObservation = (element, subscription) => {\n    const $eMObservers = element.$eMObservers;\n    if ($eMObservers && $eMObservers.delete(subscription)) {\n        if ($eMObservers.size === 0) {\n            element.$mObserver.disconnect();\n            element.$mObserver = undefined;\n        }\n        return true;\n    }\n    return false;\n};\nconst handleMutation = (mutationRecords) => {\n    mutationRecords[0].target.$eMObservers.forEach(invokeHandleMutation, mutationRecords);\n};\nfunction invokeHandleMutation(s) {\n    s.handleMutation(this);\n}\n//# sourceMappingURL=element-attribute-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { BindingMode, connectable, hasBind, hasUnbind, IObserverLocator, IScheduler, INode, } from '@aurelia/runtime';\nimport { AttributeObserver, } from '../observation/element-attribute-observer';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\n/**\n * Attribute binding. Handle attribute binding betwen view/view model. Understand Html special attributes\n */\nlet AttributeBinding = class AttributeBinding {\n    constructor(sourceExpression, target, \n    // some attributes may have inner structure\n    // such as class -> collection of class names\n    // such as style -> collection of style rules\n    //\n    // for normal attributes, targetAttribute and targetProperty are the same and can be ignore\n    targetAttribute, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.targetAttribute = targetAttribute;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = null;\n        this.persistentFlags = 0 /* none */;\n        this.target = target;\n        connectable.assignIdTo(this);\n        this.$scheduler = locator.get(IScheduler);\n    }\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, value);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if (this.mode === BindingMode.fromView) {\n            flags &= ~16 /* updateTargetInstance */;\n            flags |= 32 /* updateSourceExpression */;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.interceptor.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n                this.interceptor.unobserve(false);\n            }\n            return;\n        }\n        if (flags & 32 /* updateSourceExpression */) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.interceptor.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            targetObserver = this.targetObserver = new AttributeObserver(this.$scheduler, flags, this.observerLocator, this.target, this.targetProperty, this.targetAttribute);\n        }\n        if (targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n            targetObserver.subscribe(this.interceptor);\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = null;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this.interceptor);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    connect(flags) {\n        if (this.$state & 4 /* isBound */) {\n            flags |= this.persistentFlags;\n            this.sourceExpression.connect(flags | 2097152 /* mustEvaluate */, this.$scope, this.interceptor, this.part); // why do we have a connect method here in the first place? will this be called after bind?\n        }\n    }\n};\nAttributeBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, String, String, Number, Object, Object])\n], AttributeBinding);\nexport { AttributeBinding };\n//# sourceMappingURL=attribute.js.map","/**\n * Attribute accessor in a XML document/element that can be accessed via a namespace.\n * Wraps [`getAttributeNS`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS).\n */\nexport class AttributeNSAccessor {\n    constructor(scheduler, flags, obj, propertyKey, namespace) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.namespace = namespace;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttributeNS(this.namespace, this.propertyKey);\n            }\n            else {\n                this.obj.setAttributeNS(this.namespace, this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttributeNS(this.namespace, this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=attribute-ns-accessor.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection, IScheduler, getCollectionObserver, ILifecycle, } from '@aurelia/runtime';\nconst toStringTag = Object.prototype.toString;\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet CheckedObserver = class CheckedObserver {\n    constructor(scheduler, flags, lifecycle, handler, obj) {\n        this.scheduler = scheduler;\n        this.lifecycle = lifecycle;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.collectionObserver = void 0;\n        this.valueObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) === 4096 /* fromBind */ || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.oldValue = this.currentValue;\n            if (this.valueObserver === void 0) {\n                if (this.obj.$observers !== void 0) {\n                    if (this.obj.$observers.model !== void 0) {\n                        this.valueObserver = this.obj.$observers.model;\n                    }\n                    else if (this.obj.$observers.value !== void 0) {\n                        this.valueObserver = this.obj.$observers.value;\n                    }\n                }\n                if (this.valueObserver !== void 0) {\n                    this.valueObserver.subscribe(this);\n                }\n            }\n            if (this.collectionObserver !== void 0) {\n                this.collectionObserver.unsubscribeFromCollection(this);\n                this.collectionObserver = void 0;\n            }\n            if (this.obj.type === 'checkbox') {\n                this.collectionObserver = getCollectionObserver(flags, this.lifecycle, currentValue);\n                if (this.collectionObserver !== void 0) {\n                    this.collectionObserver.subscribeToCollection(this);\n                }\n            }\n            this.synchronizeElement();\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        const { currentValue, oldValue } = this;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.oldValue = currentValue;\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(currentValue, oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags));\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    synchronizeElement() {\n        const currentValue = this.currentValue;\n        const obj = this.obj;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        const isRadio = obj.type === 'radio';\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (isRadio) {\n            obj.checked = !!matcher(currentValue, elementValue);\n        }\n        else if (currentValue === true) {\n            obj.checked = true;\n        }\n        else {\n            let hasMatch = false;\n            switch (toStringTag.call(currentValue)) {\n                case '[object Array]':\n                    hasMatch = currentValue.findIndex(item => !!matcher(item, elementValue)) !== -1;\n                    break;\n                case '[object Set]':\n                    for (const v of currentValue) {\n                        if (matcher(v, elementValue)) {\n                            hasMatch = true;\n                            break;\n                        }\n                    }\n                    break;\n                case '[object Map]':\n                    for (const pair of currentValue) {\n                        const existingItem = pair[0];\n                        const $isChecked = pair[1];\n                        // a potential complain, when only `true` is supported\n                        // but it's consistent with array\n                        if (matcher(existingItem, elementValue) && $isChecked === true) {\n                            hasMatch = true;\n                            break;\n                        }\n                    }\n            }\n            obj.checked = hasMatch;\n        }\n    }\n    handleEvent() {\n        let currentValue = this.oldValue = this.currentValue;\n        const obj = this.obj;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        const isChecked = obj.checked;\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (obj.type === 'checkbox') {\n            const toStringRet = toStringTag.call(currentValue);\n            if (toStringRet === '[object Array]') {\n                // Array binding steps on a change event:\n                // 1. find corresponding item INDEX in the Set based on current model/value and matcher\n                // 2. is the checkbox checked?\n                //    2.1. Yes: is the corresponding item in the Array (index === -1)?\n                //        2.1.1 No: push the current model/value to the Array\n                //    2.2. No: is the corresponding item in the Array (index !== -1)?\n                //        2.2.1: Yes: remove the corresponding item\n                // =================================================\n                const index = currentValue.findIndex(item => !!matcher(item, elementValue));\n                // if the checkbox is checkde, and there's no matching value in the existing array\n                // add the checkbox model/value to the array\n                if (isChecked && index === -1) {\n                    currentValue.push(elementValue);\n                }\n                else if (!isChecked && index !== -1) {\n                    // if the checkbox is not checked, and found a matching item in the array\n                    // based on the checkbox model/value\n                    // remove the existing item\n                    currentValue.splice(index, 1);\n                }\n                // when existing currentValue is an array,\n                // do not invoke callback as only the array obj has changed\n                return;\n            }\n            else if (toStringRet === '[object Set]') {\n                // Set binding steps on a change event:\n                // 1. find corresponding item in the Set based on current model/value and matcher\n                // 2. is the checkbox checked?\n                //    2.1. Yes: is the corresponding item in the Set?\n                //        2.1.1 No: add the current model/value to the Set\n                //    2.2. No: is the corresponding item in the Set?\n                //        2.2.1: Yes: remove the corresponding item\n                // =================================================\n                // 1. find corresponding item\n                const unset = {};\n                let existingItem = unset;\n                for (const value of currentValue) {\n                    if (matcher(value, elementValue) === true) {\n                        existingItem = value;\n                        break;\n                    }\n                }\n                // 2.1. Checkbox is checked, is the corresponding item in the Set?\n                //\n                // if checkbox is checked and there's no value in the existing Set\n                // add the checkbox model/value to the Set\n                if (isChecked && existingItem === unset) {\n                    // 2.1.1. add the current model/value to the Set\n                    currentValue.add(elementValue);\n                }\n                else if (!isChecked && existingItem !== unset) {\n                    // 2.2.1 Checkbox is unchecked, corresponding is in the Set\n                    //\n                    // if checkbox is not checked, and found a matching item in the Set\n                    // based on the checkbox model/value\n                    // remove the existing item\n                    currentValue.delete(existingItem);\n                }\n                // when existing value is a Set,\n                // do not invoke callback as only the Set has been mutated\n                return;\n            }\n            else if (toStringRet === '[object Map]') {\n                // Map binding steps on a change event\n                // 1. find corresponding item in the Map based on current model/value and matcher\n                // 2. Set the value of the corresponding item in the Map based on checked state of the checkbox\n                // =================================================\n                // 1. find the corresponding item\n                let existingItem;\n                for (const pair of currentValue) {\n                    const currItem = pair[0];\n                    if (matcher(currItem, elementValue) === true) {\n                        existingItem = currItem;\n                        break;\n                    }\n                }\n                // 2. set the value of the corresponding item in the map\n                // if checkbox is checked and there's no value in the existing Map\n                // add the checkbox model/value to the Map as key,\n                // and value will be checked state of the checkbox\n                currentValue.set(existingItem, isChecked);\n                // when existing value is a Map,\n                // do not invoke callback as only the Map has been mutated\n                return;\n            }\n            currentValue = isChecked;\n        }\n        else if (isChecked) {\n            currentValue = elementValue;\n        }\n        else {\n            // if it's a radio and it has been unchecked\n            // do nothing, as the radio that was checked will fire change event and it will be handle there\n            // a radio cannot be unchecked by user\n            return;\n        }\n        this.currentValue = currentValue;\n        this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.obj.checked;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    unbind(flags) {\n        if (this.collectionObserver !== void 0) {\n            this.collectionObserver.unsubscribeFromCollection(this);\n            this.collectionObserver = void 0;\n        }\n        if (this.valueObserver !== void 0) {\n            this.valueObserver.unsubscribe(this);\n        }\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\nCheckedObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object])\n], CheckedObserver);\nexport { CheckedObserver };\n//# sourceMappingURL=checked-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nexport class ClassAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.doNotCache = true;\n        this.nameIndex = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.isActive = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, nameIndex } = this;\n            let { version } = this;\n            this.oldValue = currentValue;\n            const classesToAdd = getClassesToAdd(currentValue);\n            // Get strings split on a space not including empties\n            if (classesToAdd.length > 0) {\n                this.addClassesAndUpdateIndex(classesToAdd);\n            }\n            this.version += 1;\n            // First call to setValue?  We're done.\n            if (version === 0) {\n                return;\n            }\n            // Remove classes from previous version.\n            version -= 1;\n            for (const name in nameIndex) {\n                if (!Object.prototype.hasOwnProperty.call(nameIndex, name) || nameIndex[name] !== version) {\n                    continue;\n                }\n                // TODO: this has the side-effect that classes already present which are added again,\n                // will be removed if they're not present in the next update.\n                // Better would be do have some configurability for this behavior, allowing the user to\n                // decide whether initial classes always need to be kept, always removed, or something in between\n                this.obj.classList.remove(name);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    addClassesAndUpdateIndex(classes) {\n        const node = this.obj;\n        for (let i = 0, ii = classes.length; i < ii; i++) {\n            const className = classes[i];\n            if (className.length === 0) {\n                continue;\n            }\n            this.nameIndex[className] = this.version;\n            node.classList.add(className);\n        }\n    }\n}\nexport function getClassesToAdd(object) {\n    function splitClassString(classString) {\n        const matches = classString.match(/\\S+/g);\n        if (matches === null) {\n            return PLATFORM.emptyArray;\n        }\n        return matches;\n    }\n    if (typeof object === 'string') {\n        return splitClassString(object);\n    }\n    if (object instanceof Array) {\n        const len = object.length;\n        if (len > 0) {\n            const classes = [];\n            for (let i = 0; i < len; ++i) {\n                classes.push(...getClassesToAdd(object[i]));\n            }\n            return classes;\n        }\n        else {\n            return PLATFORM.emptyArray;\n        }\n    }\n    else if (object instanceof Object) {\n        const classes = [];\n        for (const property in object) {\n            // Let non typical values also evaluate true so disable bool check\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, no-extra-boolean-cast\n            if (Boolean(object[property])) {\n                // We must do this in case object property has a space in the name which results in two classes\n                if (property.includes(' ')) {\n                    classes.push(...splitClassString(property));\n                }\n                else {\n                    classes.push(property);\n                }\n            }\n        }\n        return classes;\n    }\n    return PLATFORM.emptyArray;\n}\n//# sourceMappingURL=class-attribute-accessor.js.map","/**\n * Attribute accessor for HTML elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see ElementPropertyAccessor\n */\nexport class DataAttributeAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttribute(this.propertyKey);\n            }\n            else {\n                this.obj.setAttribute(this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=data-attribute-accessor.js.map","/**\n * Property accessor for HTML Elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see DataAttributeAccessor\n */\nexport class ElementPropertyAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            this.obj[this.propertyKey] = currentValue;\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj[this.propertyKey];\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=element-property-accessor.js.map","import { DI } from '@aurelia/kernel';\nimport { DelegationStrategy } from '@aurelia/runtime';\n// Note: path and deepPath are designed to handle v0 and v1 shadow dom specs respectively\n/** @internal */\nexport function findOriginalEventTarget(event) {\n    return (event.composedPath && event.composedPath()[0]) || (event.deepPath && event.deepPath()[0]) || (event.path && event.path[0]) || event.target;\n}\nfunction stopPropagation() {\n    this.standardStopPropagation();\n    this.propagationStopped = true;\n}\nfunction handleCapturedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    const orderedCallbacks = [];\n    /**\n     * During capturing phase, event 'bubbles' down from parent. Needs to reorder callback from root down to target\n     */\n    while (target) {\n        if (target.capturedCallbacks) {\n            const callback = target.capturedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                orderedCallbacks.push(callback);\n            }\n        }\n        target = target.parentNode;\n    }\n    for (let i = orderedCallbacks.length - 1; i >= 0 && !event.propagationStopped; i--) {\n        const orderedCallback = orderedCallbacks[i];\n        if ('handleEvent' in orderedCallback) {\n            orderedCallback.handleEvent(event);\n        }\n        else {\n            orderedCallback(event);\n        }\n    }\n}\nfunction handleDelegatedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    while (target && !event.propagationStopped) {\n        if (target.delegatedCallbacks) {\n            const callback = target.delegatedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                if ('handleEvent' in callback) {\n                    callback.handleEvent(event);\n                }\n                else {\n                    callback(event);\n                }\n            }\n        }\n        target = target.parentNode;\n    }\n}\nexport class ListenerTracker {\n    constructor(dom, eventName, listener, capture) {\n        this.dom = dom;\n        this.eventName = eventName;\n        this.listener = listener;\n        this.capture = capture;\n        this.count = 0;\n    }\n    increment() {\n        this.count++;\n        if (this.count === 1) {\n            this.dom.addEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    decrement() {\n        this.count--;\n        if (this.count === 0) {\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    /* @internal */\n    dispose() {\n        if (this.count > 0) {\n            this.count = 0;\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n}\n/**\n * Enable dispose() pattern for `delegate` & `capture` commands\n */\nexport class DelegateOrCaptureSubscription {\n    constructor(entry, lookup, targetEvent, callback) {\n        this.entry = entry;\n        this.lookup = lookup;\n        this.targetEvent = targetEvent;\n        lookup[targetEvent] = callback;\n    }\n    dispose() {\n        this.entry.decrement();\n        this.lookup[this.targetEvent] = null;\n    }\n}\n/**\n * Enable dispose() pattern for addEventListener for `trigger`\n */\nexport class TriggerSubscription {\n    constructor(dom, target, targetEvent, callback) {\n        this.dom = dom;\n        this.target = target;\n        this.targetEvent = targetEvent;\n        this.callback = callback;\n        dom.addEventListener(targetEvent, callback, target);\n    }\n    dispose() {\n        this.dom.removeEventListener(this.targetEvent, this.callback, this.target);\n    }\n}\nexport class EventSubscriber {\n    constructor(dom, events) {\n        this.dom = dom;\n        this.events = events;\n        this.target = null;\n        this.handler = null;\n    }\n    subscribe(node, callbackOrListener) {\n        this.target = node;\n        this.handler = callbackOrListener;\n        const add = this.dom.addEventListener;\n        const events = this.events;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            add(events[i], callbackOrListener, node);\n        }\n    }\n    dispose() {\n        const node = this.target;\n        const callbackOrListener = this.handler;\n        const events = this.events;\n        const dom = this.dom;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            dom.removeEventListener(events[i], callbackOrListener, node);\n        }\n        this.target = this.handler = null;\n    }\n}\nexport const IEventManager = DI.createInterface('IEventManager').withDefault(x => x.singleton(EventManager));\n/** @internal */\nexport class EventManager {\n    constructor() {\n        this.delegatedHandlers = {};\n        this.capturedHandlers = {};\n    }\n    addEventListener(dom, target, targetEvent, callbackOrListener, strategy) {\n        let delegatedHandlers;\n        let capturedHandlers;\n        let handlerEntry;\n        if (strategy === DelegationStrategy.bubbling) {\n            delegatedHandlers = this.delegatedHandlers;\n            handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleDelegatedEvent, false));\n            handlerEntry.increment();\n            const delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, delegatedCallbacks, targetEvent, callbackOrListener);\n        }\n        if (strategy === DelegationStrategy.capturing) {\n            capturedHandlers = this.capturedHandlers;\n            handlerEntry = capturedHandlers[targetEvent] || (capturedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleCapturedEvent, true));\n            handlerEntry.increment();\n            const capturedCallbacks = target.capturedCallbacks || (target.capturedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, capturedCallbacks, targetEvent, callbackOrListener);\n        }\n        return new TriggerSubscription(dom, target, targetEvent, callbackOrListener);\n    }\n    dispose() {\n        let key;\n        const { delegatedHandlers, capturedHandlers } = this;\n        for (key in delegatedHandlers) {\n            delegatedHandlers[key].dispose();\n        }\n        for (key in capturedHandlers) {\n            capturedHandlers[key].dispose();\n        }\n    }\n}\n//# sourceMappingURL=event-manager.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IDOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\nimport { bound } from '@aurelia/kernel';\nconst childObserverOptions = {\n    childList: true,\n    subtree: true,\n    characterData: true\n};\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet SelectValueObserver = class SelectValueObserver {\n    constructor(scheduler, flags, observerLocator, dom, handler, obj) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.dom = dom;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.arrayObserver = void 0;\n        this.nodeObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const isArray = Array.isArray(currentValue);\n            if (!isArray && currentValue != void 0 && this.obj.multiple) {\n                throw new Error('Only null or Array instances can be bound to a multi-select.');\n            }\n            if (this.arrayObserver) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = void 0;\n            }\n            if (isArray) {\n                this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                this.arrayObserver.subscribeToCollection(this);\n            }\n            this.synchronizeOptions();\n            this.notify(flags);\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(this.currentValue, this.oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    notify(flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            return;\n        }\n        const oldValue = this.oldValue;\n        const newValue = this.currentValue;\n        if (newValue === oldValue) {\n            return;\n        }\n        this.callSubscribers(newValue, oldValue, flags);\n    }\n    handleEvent() {\n        // \"from-view\" changes are always synchronous now, so immediately sync the value and notify subscribers\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    synchronizeOptions(indexMap) {\n        const { currentValue, obj } = this;\n        const isArray = Array.isArray(currentValue);\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        const options = obj.options;\n        let i = options.length;\n        while (i-- > 0) {\n            const option = options[i];\n            const optionValue = Object.prototype.hasOwnProperty.call(option, 'model') ? option.model : option.value;\n            if (isArray) {\n                option.selected = currentValue.findIndex(item => !!matcher(optionValue, item)) !== -1;\n                continue;\n            }\n            option.selected = !!matcher(optionValue, currentValue);\n        }\n    }\n    synchronizeValue() {\n        // Spec for synchronizing value from `SelectObserver` to `<select/>`\n        // When synchronizing value to observed <select/> element, do the following steps:\n        // A. If `<select/>` is multiple\n        //    1. Check if current value, called `currentValue` is an array\n        //      a. If not an array, return true to signal value has changed\n        //      b. If is an array:\n        //        i. gather all current selected <option/>, in to array called `values`\n        //        ii. loop through the `currentValue` array and remove items that are nolonger selected based on matcher\n        //        iii. loop through the `values` array and add items that are selected based on matcher\n        //        iv. Return false to signal value hasn't changed\n        // B. If the select is single\n        //    1. Let `value` equal the first selected option, if no option selected, then `value` is `null`\n        //    2. assign `this.currentValue` to `this.oldValue`\n        //    3. assign `value` to `this.currentValue`\n        //    4. return `true` to signal value has changed\n        const obj = this.obj;\n        const options = obj.options;\n        const len = options.length;\n        const currentValue = this.currentValue;\n        let i = 0;\n        if (obj.multiple) {\n            // A.\n            if (!Array.isArray(currentValue)) {\n                // A.1.a\n                return true;\n            }\n            // A.1.b\n            // multi select\n            let option;\n            const matcher = obj.matcher || defaultMatcher;\n            // A.1.b.i\n            const values = [];\n            while (i < len) {\n                option = options[i];\n                if (option.selected) {\n                    values.push(Object.prototype.hasOwnProperty.call(option, 'model')\n                        ? option.model\n                        : option.value);\n                }\n                ++i;\n            }\n            // A.1.b.ii\n            i = 0;\n            while (i < currentValue.length) {\n                const a = currentValue[i];\n                // Todo: remove arrow fn\n                if (values.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.splice(i, 1);\n                }\n                else {\n                    ++i;\n                }\n            }\n            // A.1.b.iii\n            i = 0;\n            while (i < values.length) {\n                const a = values[i];\n                // Todo: remove arrow fn\n                if (currentValue.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.push(a);\n                }\n                ++i;\n            }\n            // A.1.b.iv\n            return false;\n        }\n        // B. single select\n        // B.1\n        let value = null;\n        while (i < len) {\n            const option = options[i];\n            if (option.selected) {\n                value = Object.prototype.hasOwnProperty.call(option, 'model')\n                    ? option.model\n                    : option.value;\n                break;\n            }\n            ++i;\n        }\n        // B.2\n        this.oldValue = this.currentValue;\n        // B.3\n        this.currentValue = value;\n        // B.4\n        return true;\n    }\n    bind(flags) {\n        this.nodeObserver = this.dom.createNodeObserver(this.obj, this.handleNodeChange, childObserverOptions);\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        this.nodeObserver.disconnect();\n        this.nodeObserver = null;\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n        if (this.arrayObserver) {\n            this.arrayObserver.unsubscribeFromCollection(this);\n            this.arrayObserver = null;\n        }\n    }\n    handleNodeChange() {\n        this.synchronizeOptions();\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.notify(131072 /* fromDOMEvent */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], SelectValueObserver.prototype, \"handleNodeChange\", null);\nSelectValueObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object, Object])\n], SelectValueObserver);\nexport { SelectValueObserver };\n//# sourceMappingURL=select-value-observer.js.map","import { PLATFORM, kebabCase } from '@aurelia/kernel';\nexport class StyleAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.styles = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.obj.style.cssText;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    getStyleTuplesFromString(currentValue) {\n        const styleTuples = [];\n        const rx = /\\s*([\\w-]+)\\s*:\\s*((?:(?:[\\w-]+\\(\\s*(?:\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[\\w-]+\\(\\s*(?:[^\"](?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^)]*)\\),?|[^)]*)\\),?|\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^;]*),?\\s*)+);?/g;\n        let pair;\n        let name;\n        while ((pair = rx.exec(currentValue)) !== null) {\n            name = pair[1];\n            if (name.length === 0) {\n                continue;\n            }\n            styleTuples.push([name, pair[2]]);\n        }\n        return styleTuples;\n    }\n    getStyleTuplesFromObject(currentValue) {\n        let value;\n        const styles = [];\n        for (const property in currentValue) {\n            value = currentValue[property];\n            if (value == null) {\n                continue;\n            }\n            if (typeof value === 'string') {\n                styles.push([kebabCase(property), value]);\n                continue;\n            }\n            styles.push(...this.getStyleTuples(value));\n        }\n        return styles;\n    }\n    getStyleTuplesFromArray(currentValue) {\n        const len = currentValue.length;\n        if (len > 0) {\n            const styles = [];\n            for (let i = 0; i < len; ++i) {\n                styles.push(...this.getStyleTuples(currentValue[i]));\n            }\n            return styles;\n        }\n        return PLATFORM.emptyArray;\n    }\n    getStyleTuples(currentValue) {\n        if (typeof currentValue === 'string') {\n            return this.getStyleTuplesFromString(currentValue);\n        }\n        if (currentValue instanceof Array) {\n            return this.getStyleTuplesFromArray(currentValue);\n        }\n        if (currentValue instanceof Object) {\n            return this.getStyleTuplesFromObject(currentValue);\n        }\n        return PLATFORM.emptyArray;\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const styles = this.styles;\n            let style;\n            let version = this.version;\n            const styleTuples = this.getStyleTuples(currentValue);\n            let tuple;\n            let name;\n            let value;\n            const len = styleTuples.length;\n            for (let i = 0; i < len; ++i) {\n                tuple = styleTuples[i];\n                name = tuple[0];\n                value = tuple[1];\n                this.setProperty(name, value);\n                styles[name] = version;\n            }\n            this.styles = styles;\n            this.version += 1;\n            if (version === 0) {\n                return;\n            }\n            version -= 1;\n            for (style in styles) {\n                if (!Object.prototype.hasOwnProperty.call(styles, style) || styles[style] !== version) {\n                    continue;\n                }\n                this.obj.style.removeProperty(style);\n            }\n        }\n    }\n    setProperty(style, value) {\n        let priority = '';\n        if (value != null && typeof value.indexOf === 'function' && value.includes('!important')) {\n            priority = 'important';\n            value = value.replace('!important', '');\n        }\n        this.obj.style.setProperty(style, value, priority);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.oldValue = this.currentValue = this.obj.style.cssText;\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=style-attribute-accessor.js.map","import { DI } from '@aurelia/kernel';\nexport const ISVGAnalyzer = DI.createInterface('ISVGAnalyzer').withDefault(x => x.singleton(class {\n    isStandardSvgAttribute(node, attributeName) {\n        return false;\n    }\n}));\n//# sourceMappingURL=svg-analyzer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection, IScheduler, } from '@aurelia/runtime';\n// TODO: handle file attribute properly again, etc\n/**\n * Observer for non-radio, non-checkbox input.\n */\nlet ValueAttributeObserver = class ValueAttributeObserver {\n    constructor(scheduler, flags, handler, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.handler = handler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, oldValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj[this.propertyKey] = '';\n            }\n            else {\n                this.obj[this.propertyKey] = currentValue;\n            }\n            if ((flags & 4096 /* fromBind */) === 0) {\n                this.callSubscribers(currentValue, oldValue, flags);\n            }\n        }\n    }\n    handleEvent() {\n        const oldValue = this.oldValue = this.currentValue;\n        const currentValue = this.currentValue = this.obj[this.propertyKey];\n        if (oldValue !== currentValue) {\n            this.oldValue = currentValue;\n            this.callSubscribers(currentValue, oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n            this.currentValue = this.oldValue = this.obj[this.propertyKey];\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nValueAttributeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String])\n], ValueAttributeObserver);\nexport { ValueAttributeObserver };\n//# sourceMappingURL=value-attribute-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registration } from '@aurelia/kernel';\nimport { IDOM, ITargetAccessorLocator, ITargetObserverLocator, SetterObserver } from '@aurelia/runtime';\nimport { AttributeNSAccessor } from './attribute-ns-accessor';\nimport { CheckedObserver } from './checked-observer';\nimport { ClassAttributeAccessor } from './class-attribute-accessor';\nimport { DataAttributeAccessor } from './data-attribute-accessor';\nimport { ElementPropertyAccessor } from './element-property-accessor';\nimport { EventSubscriber } from './event-manager';\nimport { SelectValueObserver } from './select-value-observer';\nimport { StyleAttributeAccessor } from './style-attribute-accessor';\nimport { ISVGAnalyzer } from './svg-analyzer';\nimport { ValueAttributeObserver } from './value-attribute-observer';\n// https://infra.spec.whatwg.org/#namespaces\nconst htmlNS = 'http://www.w3.org/1999/xhtml';\nconst mathmlNS = 'http://www.w3.org/1998/Math/MathML';\nconst svgNS = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink';\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace';\nconst xmlnsNS = 'http://www.w3.org/2000/xmlns/';\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\nconst nsAttributes = Object.assign(Object.create(null), {\n    'xlink:actuate': ['actuate', xlinkNS],\n    'xlink:arcrole': ['arcrole', xlinkNS],\n    'xlink:href': ['href', xlinkNS],\n    'xlink:role': ['role', xlinkNS],\n    'xlink:show': ['show', xlinkNS],\n    'xlink:title': ['title', xlinkNS],\n    'xlink:type': ['type', xlinkNS],\n    'xml:lang': ['lang', xmlNS],\n    'xml:space': ['space', xmlNS],\n    'xmlns': ['xmlns', xmlnsNS],\n    'xmlns:xlink': ['xlink', xmlnsNS],\n});\nconst inputEvents = ['change', 'input'];\nconst selectEvents = ['change'];\nconst contentEvents = ['change', 'input', 'blur', 'keyup', 'paste'];\nconst scrollEvents = ['scroll'];\nconst overrideProps = Object.assign(Object.create(null), {\n    'class': true,\n    'style': true,\n    'css': true,\n    'checked': true,\n    'value': true,\n    'model': true,\n    'xlink:actuate': true,\n    'xlink:arcrole': true,\n    'xlink:href': true,\n    'xlink:role': true,\n    'xlink:show': true,\n    'xlink:title': true,\n    'xlink:type': true,\n    'xml:lang': true,\n    'xml:space': true,\n    'xmlns': true,\n    'xmlns:xlink': true,\n});\nlet TargetObserverLocator = class TargetObserverLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetObserverLocator, this).register(container);\n    }\n    getObserver(flags, scheduler, lifecycle, observerLocator, obj, propertyName) {\n        switch (propertyName) {\n            case 'checked':\n                return new CheckedObserver(scheduler, flags, lifecycle, new EventSubscriber(this.dom, inputEvents), obj);\n            case 'value':\n                if (obj.tagName === 'SELECT') {\n                    return new SelectValueObserver(scheduler, flags, observerLocator, this.dom, new EventSubscriber(this.dom, selectEvents), obj);\n                }\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'files':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'textContent':\n            case 'innerHTML':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, contentEvents), obj, propertyName);\n            case 'scrollTop':\n            case 'scrollLeft':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, scrollEvents), obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            case 'model':\n                return new SetterObserver(lifecycle, flags, obj, propertyName);\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n        }\n        return null;\n    }\n    overridesAccessor(flags, obj, propertyName) {\n        return overrideProps[propertyName] === true;\n    }\n    // consider a scenario where user would want to provide a Date object observation via patching a few mutation method on it\n    // then this extension point of this default implementaion cannot be used,\n    // and a new implementation of ITargetObserverLocator should be used instead\n    // This default implementation only accounts for the most common target scenarios\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetObserverLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TargetObserverLocator);\nexport { TargetObserverLocator };\nlet TargetAccessorLocator = class TargetAccessorLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetAccessorLocator, this).register(container);\n    }\n    getAccessor(flags, scheduler, lifecycle, obj, propertyName) {\n        switch (propertyName) {\n            case 'textContent':\n                // note: this case is just an optimization (textContent is the most often used property)\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            // TODO: there are (many) more situation where we want to default to DataAttributeAccessor,\n            // but for now stick to what vCurrent does\n            case 'src':\n            case 'href':\n            // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n        }\n    }\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetAccessorLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TargetAccessorLocator);\nexport { TargetAccessorLocator };\nconst IsDataAttribute = {};\nfunction isDataAttribute(obj, propertyName, svgAnalyzer) {\n    if (IsDataAttribute[propertyName] === true) {\n        return true;\n    }\n    const prefix = propertyName.slice(0, 5);\n    // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n    // https://html.spec.whatwg.org/multipage/dom.html#custom-data-attribute\n    return IsDataAttribute[propertyName] =\n        prefix === 'aria-' ||\n            prefix === 'data-' ||\n            svgAnalyzer.isStandardSvgAttribute(obj, propertyName);\n}\n//# sourceMappingURL=observer-locator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { bindingBehavior, IScheduler } from '@aurelia/runtime';\nimport { DataAttributeAccessor } from '../../observation/data-attribute-accessor';\nlet AttrBindingBehavior = class AttrBindingBehavior {\n    bind(flags, scope, binding) {\n        binding.targetObserver = new DataAttributeAccessor(binding.locator.get(IScheduler), flags, binding.target, binding.targetProperty);\n    }\n    unbind(flags, scope, binding) {\n        return;\n    }\n};\nAttrBindingBehavior = __decorate([\n    bindingBehavior('attr')\n], AttrBindingBehavior);\nexport { AttrBindingBehavior };\n//# sourceMappingURL=attr.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { bindingBehavior } from '@aurelia/runtime';\nimport { findOriginalEventTarget } from '../../observation/event-manager';\n/** @internal */\nexport function handleSelfEvent(event) {\n    const target = findOriginalEventTarget(event);\n    if (this.target !== target) {\n        return;\n    }\n    return this.selfEventCallSource(event);\n}\nlet SelfBindingBehavior = class SelfBindingBehavior {\n    bind(flags, scope, binding) {\n        if (!binding.callSource || !binding.targetEvent) {\n            throw Reporter.error(8);\n        }\n        binding.selfEventCallSource = binding.callSource;\n        binding.callSource = handleSelfEvent;\n    }\n    unbind(flags, scope, binding) {\n        binding.callSource = binding.selfEventCallSource;\n        binding.selfEventCallSource = null;\n    }\n};\nSelfBindingBehavior = __decorate([\n    bindingBehavior('self')\n], SelfBindingBehavior);\nexport { SelfBindingBehavior };\n//# sourceMappingURL=self.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { BindingMode, IDOM, IObserverLocator, bindingBehavior } from '@aurelia/runtime';\nimport { EventSubscriber } from '../../observation/event-manager';\nlet UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\n    constructor(observerLocator) {\n        this.observerLocator = observerLocator;\n    }\n    bind(flags, scope, binding, ...events) {\n        if (events.length === 0) {\n            throw Reporter.error(9);\n        }\n        if (binding.mode !== BindingMode.twoWay && binding.mode !== BindingMode.fromView) {\n            throw Reporter.error(10);\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        // ensure the binding's target observer has been set.\n        const targetObserver = this.observerLocator.getObserver(this.persistentFlags | flags, binding.target, binding.targetProperty);\n        if (!targetObserver.handler) {\n            throw Reporter.error(10);\n        }\n        binding.targetObserver = targetObserver;\n        // stash the original element subscribe function.\n        targetObserver.originalHandler = binding.targetObserver.handler;\n        // replace the element subscribe function with one that uses the correct events.\n        targetObserver.handler = new EventSubscriber(binding.locator.get(IDOM), events);\n    }\n    unbind(flags, scope, binding) {\n        // restore the state of the binding.\n        binding.targetObserver.handler.dispose();\n        binding.targetObserver.handler = binding.targetObserver.originalHandler;\n        binding.targetObserver.originalHandler = null;\n    }\n};\nUpdateTriggerBindingBehavior = __decorate([\n    bindingBehavior('updateTrigger'),\n    __param(0, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], UpdateTriggerBindingBehavior);\nexport { UpdateTriggerBindingBehavior };\n//# sourceMappingURL=update-trigger.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nexport const noopShadowDOMStyles = Object.freeze({\n    applyTo: PLATFORM.noop\n});\nexport const IShadowDOMStyles = DI.createInterface('IShadowDOMStyles').noDefault();\nexport const IShadowDOMGlobalStyles = DI.createInterface('IShadowDOMGlobalStyles')\n    .withDefault(x => x.instance(noopShadowDOMStyles));\nexport class AdoptedStyleSheetsStyles {\n    constructor(dom, localStyles, styleSheetCache, sharedStyles = null) {\n        this.sharedStyles = sharedStyles;\n        this.styleSheets = localStyles.map(x => {\n            let sheet;\n            if (x instanceof dom.CSSStyleSheet) {\n                sheet = x;\n            }\n            else {\n                sheet = styleSheetCache.get(x);\n                if (!sheet) {\n                    sheet = new dom.CSSStyleSheet();\n                    sheet.replaceSync(x);\n                    styleSheetCache.set(x, sheet);\n                }\n            }\n            return sheet;\n        });\n    }\n    static supported(dom) {\n        return 'adoptedStyleSheets' in dom.ShadowRoot.prototype;\n    }\n    applyTo(shadowRoot) {\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n        // https://wicg.github.io/construct-stylesheets/\n        // https://developers.google.com/web/updates/2019/02/constructable-stylesheets\n        shadowRoot.adoptedStyleSheets = [\n            ...shadowRoot.adoptedStyleSheets,\n            ...this.styleSheets\n        ];\n    }\n}\nexport class StyleElementStyles {\n    constructor(dom, localStyles, sharedStyles = null) {\n        this.dom = dom;\n        this.localStyles = localStyles;\n        this.sharedStyles = sharedStyles;\n    }\n    applyTo(shadowRoot) {\n        const styles = this.localStyles;\n        const dom = this.dom;\n        for (let i = styles.length - 1; i > -1; --i) {\n            const element = dom.createElement('style');\n            element.innerHTML = styles[i];\n            shadowRoot.prepend(element);\n        }\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n    }\n}\n//# sourceMappingURL=shadow-dom-styles.js.map","import { PLATFORM, Registration, Reporter, toArray, Metadata } from '@aurelia/kernel';\nimport { IProjectorLocator, CustomElement, } from '@aurelia/runtime';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\nconst defaultShadowOptions = {\n    mode: 'open'\n};\nexport class HTMLProjectorLocator {\n    static register(container) {\n        return Registration.singleton(IProjectorLocator, this).register(container);\n    }\n    getElementProjector(dom, $component, host, def) {\n        if (def.shadowOptions || def.hasSlots) {\n            if (def.containerless) {\n                throw Reporter.error(21);\n            }\n            return new ShadowDOMProjector(dom, $component, host, def);\n        }\n        if (def.containerless) {\n            return new ContainerlessProjector(dom, $component, host);\n        }\n        return new HostProjector($component, host);\n    }\n}\nconst childObserverOptions = { childList: true };\n/** @internal */\nexport class ShadowDOMProjector {\n    constructor(dom, \n    // eslint-disable-next-line @typescript-eslint/prefer-readonly\n    $controller, host, definition) {\n        this.dom = dom;\n        this.$controller = $controller;\n        this.host = host;\n        let shadowOptions;\n        if (definition.shadowOptions instanceof Object &&\n            'mode' in definition.shadowOptions) {\n            shadowOptions = definition.shadowOptions;\n        }\n        else {\n            shadowOptions = defaultShadowOptions;\n        }\n        this.shadowRoot = host.attachShadow(shadowOptions);\n        Metadata.define(CustomElement.name, $controller, this.host);\n        Metadata.define(CustomElement.name, $controller, this.shadowRoot);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback, options = childObserverOptions) {\n        // TODO: add a way to dispose/disconnect\n        this.dom.createNodeObserver(this.host, callback, options);\n    }\n    provideEncapsulationSource() {\n        return this.shadowRoot;\n    }\n    project(nodes) {\n        const context = this.$controller.context;\n        const styles = context.has(IShadowDOMStyles, false)\n            ? context.get(IShadowDOMStyles)\n            : context.get(IShadowDOMGlobalStyles);\n        styles.applyTo(this.shadowRoot);\n        nodes.appendTo(this.shadowRoot);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class ContainerlessProjector {\n    constructor(dom, $controller, host) {\n        if (host.childNodes.length) {\n            this.childNodes = toArray(host.childNodes);\n        }\n        else {\n            this.childNodes = PLATFORM.emptyArray;\n        }\n        this.host = dom.convertToRenderLocation(host);\n        Metadata.define(CustomElement.name, $controller, this.host);\n    }\n    get children() {\n        return this.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // TODO: turn this into an error\n        // Containerless does not have a container node to observe children on.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.insertBefore(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class HostProjector {\n    constructor($controller, host) {\n        this.host = host;\n        Metadata.define(CustomElement.name, $controller, host);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // Do nothing since this scenario will never have children.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.appendTo(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n//# sourceMappingURL=projectors.js.map","import { PLATFORM, Registration, Reporter } from '@aurelia/kernel';\nimport { DOM, IDOM, INode, CustomElement } from '@aurelia/runtime';\nimport { ShadowDOMProjector } from './projectors';\nexport var NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Element\"] = 1] = \"Element\";\n    NodeType[NodeType[\"Attr\"] = 2] = \"Attr\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATASection\"] = 4] = \"CDATASection\";\n    NodeType[NodeType[\"EntityReference\"] = 5] = \"EntityReference\";\n    NodeType[NodeType[\"Entity\"] = 6] = \"Entity\";\n    NodeType[NodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    NodeType[NodeType[\"Comment\"] = 8] = \"Comment\";\n    NodeType[NodeType[\"Document\"] = 9] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    NodeType[NodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n    NodeType[NodeType[\"Notation\"] = 12] = \"Notation\";\n})(NodeType || (NodeType = {}));\nconst effectiveParentNodeOverrides = new WeakMap();\n/**\n * IDOM implementation for Html.\n */\nexport class HTMLDOM {\n    constructor(window, document, TNode, TElement, THTMLElement, TCustomEvent, TCSSStyleSheet, TShadowRoot) {\n        this.window = window;\n        this.document = document;\n        this.Node = TNode;\n        this.Element = TElement;\n        this.HTMLElement = THTMLElement;\n        this.CustomEvent = TCustomEvent;\n        this.CSSStyleSheet = TCSSStyleSheet;\n        this.ShadowRoot = TShadowRoot;\n        if (DOM.isInitialized) {\n            Reporter.write(1001); // TODO: create reporters code // DOM already initialized (just info)\n            DOM.destroy();\n        }\n        DOM.initialize(this);\n        this.emptyNodes = new FragmentNodeSequence(this, document.createDocumentFragment());\n    }\n    static register(container) {\n        return Registration.aliasTo(IDOM, this).register(container);\n    }\n    addEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).addEventListener(eventName, subscriber, options);\n    }\n    appendChild(parent, child) {\n        parent.appendChild(child);\n    }\n    cloneNode(node, deep) {\n        return node.cloneNode(deep !== false);\n    }\n    convertToRenderLocation(node) {\n        if (this.isRenderLocation(node)) {\n            return node; // it's already a IRenderLocation (converted by FragmentNodeSequence)\n        }\n        if (node.parentNode == null) {\n            throw Reporter.error(52);\n        }\n        const locationEnd = this.document.createComment('au-end');\n        const locationStart = this.document.createComment('au-start');\n        node.parentNode.replaceChild(locationEnd, node);\n        locationEnd.parentNode.insertBefore(locationStart, locationEnd);\n        locationEnd.$start = locationStart;\n        locationStart.$nodes = null;\n        return locationEnd;\n    }\n    createDocumentFragment(markupOrNode) {\n        if (markupOrNode == null) {\n            return this.document.createDocumentFragment();\n        }\n        if (this.isNodeInstance(markupOrNode)) {\n            if (markupOrNode.content !== undefined) {\n                return markupOrNode.content;\n            }\n            const fragment = this.document.createDocumentFragment();\n            fragment.appendChild(markupOrNode);\n            return fragment;\n        }\n        return this.createTemplate(markupOrNode).content;\n    }\n    createNodeSequence(fragment) {\n        if (fragment === null) {\n            return this.emptyNodes;\n        }\n        return new FragmentNodeSequence(this, fragment.cloneNode(true));\n    }\n    createElement(name) {\n        return this.document.createElement(name);\n    }\n    fetch(input, init) {\n        return this.window.fetch(input, init);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    createCustomEvent(eventType, options) {\n        return new this.CustomEvent(eventType, options);\n    }\n    dispatchEvent(evt) {\n        this.document.dispatchEvent(evt);\n    }\n    createNodeObserver(node, cb, init) {\n        if (typeof MutationObserver === 'undefined') {\n            // TODO: find a proper response for this scenario\n            return {\n                disconnect() { },\n                observe() { },\n                takeRecords() { return PLATFORM.emptyArray; }\n            };\n        }\n        const observer = new MutationObserver(cb);\n        observer.observe(node, init);\n        return observer;\n    }\n    createTemplate(markup) {\n        if (markup == null) {\n            return this.document.createElement('template');\n        }\n        const template = this.document.createElement('template');\n        template.innerHTML = markup.toString();\n        return template;\n    }\n    createTextNode(text) {\n        return this.document.createTextNode(text);\n    }\n    /**\n     * Returns the effective parentNode according to Aurelia's component hierarchy.\n     *\n     * Used by Aurelia to find the closest parent controller relative to a node.\n     *\n     * This method supports 3 additional scenarios that `node.parentNode` does not support:\n     * - Containerless elements. The parentNode in this case is a comment precending the element under specific conditions, rather than a node wrapping the element.\n     * - ShadowDOM. If a `ShadowRoot` is encountered, this method retrieves the associated controller via the metadata api to locate the original host.\n     * - Portals. If the provided node was moved to a different location in the DOM by a `portal` attribute, then the original parent of the node will be returned.\n     *\n     * @param node - The node to get the parent for.\n     * @returns Either the closest parent node, the closest `IRenderLocation` (comment node that is the containerless host), original portal host, or `null` if this is either the absolute document root or a disconnected node.\n     */\n    getEffectiveParentNode(node) {\n        // TODO: this method needs more tests!\n        // First look for any overrides\n        if (effectiveParentNodeOverrides.has(node)) {\n            return effectiveParentNodeOverrides.get(node);\n        }\n        // Then try to get the nearest au-start render location, which would be the containerless parent,\n        // again looking for any overrides along the way.\n        // otherwise return the normal parent node\n        let containerlessOffset = 0;\n        let next = node.nextSibling;\n        while (next !== null) {\n            if (next.nodeType === 8 /* Comment */) {\n                switch (next.textContent) {\n                    case 'au-start':\n                        // If we see an au-start before we see au-end, it will precede the host of a sibling containerless element rather than a parent.\n                        // So we use the offset to ignore the next au-end\n                        ++containerlessOffset;\n                        break;\n                    case 'au-end':\n                        if (containerlessOffset-- === 0) {\n                            return next;\n                        }\n                }\n            }\n            next = next.nextSibling;\n        }\n        if (node.parentNode === null && node.nodeType === 11 /* DocumentFragment */) {\n            // Could be a shadow root; see if there's a controller and if so, get the original host via the projector\n            const controller = CustomElement.for(node);\n            if (controller === void 0) {\n                // Not a shadow root (or at least, not one created by Aurelia)\n                // Nothing more we can try, just return null\n                return null;\n            }\n            const projector = controller.projector;\n            if (projector instanceof ShadowDOMProjector) {\n                // Now we can use the original host to traverse further up\n                return this.getEffectiveParentNode(projector.host);\n            }\n        }\n        return node.parentNode;\n    }\n    setEffectiveParentNode(childNodeOrNodeSequence, parentNode) {\n        if (this.isNodeInstance(childNodeOrNodeSequence)) {\n            effectiveParentNodeOverrides.set(childNodeOrNodeSequence, parentNode);\n        }\n        else {\n            const nodes = childNodeOrNodeSequence.childNodes;\n            for (let i = 0, ii = nodes.length; i < ii; ++i) {\n                effectiveParentNodeOverrides.set(nodes[i], parentNode);\n            }\n        }\n    }\n    insertBefore(nodeToInsert, referenceNode) {\n        referenceNode.parentNode.insertBefore(nodeToInsert, referenceNode);\n    }\n    isMarker(node) {\n        return node.nodeName === 'AU-M';\n    }\n    isNodeInstance(potentialNode) {\n        return potentialNode != null && potentialNode.nodeType > 0;\n    }\n    isRenderLocation(node) {\n        return node.textContent === 'au-end';\n    }\n    makeTarget(node) {\n        node.className = 'au';\n    }\n    registerElementResolver(container, resolver) {\n        container.registerResolver(INode, resolver);\n        container.registerResolver(this.Node, resolver);\n        container.registerResolver(this.Element, resolver);\n        container.registerResolver(this.HTMLElement, resolver);\n    }\n    remove(node) {\n        if (node.remove) {\n            node.remove();\n        }\n        else {\n            node.parentNode.removeChild(node);\n        }\n    }\n    removeEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).removeEventListener(eventName, subscriber, options);\n    }\n    setAttribute(node, name, value) {\n        node.setAttribute(name, value);\n    }\n}\nconst $DOM = DOM;\nexport { $DOM as DOM };\n/* eslint-enable @typescript-eslint/no-explicit-any */\n// This is the most common form of INodeSequence.\n// Every custom element or template controller whose node sequence is based on an HTML template\n// has an instance of this under the hood. Anyone who wants to create a node sequence from\n// a string of markup would also receive an instance of this.\n// CompiledTemplates create instances of FragmentNodeSequence.\n/**\n * This is the most common form of INodeSequence.\n *\n * @internal\n */\nexport class FragmentNodeSequence {\n    constructor(dom, fragment) {\n        this.dom = dom;\n        this.fragment = fragment;\n        this.isMounted = false;\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n        const targetNodeList = fragment.querySelectorAll('.au');\n        let i = 0;\n        let ii = targetNodeList.length;\n        const targets = this.targets = Array(ii);\n        while (i < ii) {\n            // eagerly convert all markers to RenderLocations (otherwise the renderer\n            // will do it anyway) and store them in the target list (since the comments\n            // can't be queried)\n            const target = targetNodeList[i];\n            if (target.nodeName === 'AU-M') {\n                // note the renderer will still call this method, but it will just return the\n                // location if it sees it's already a location\n                targets[i] = this.dom.convertToRenderLocation(target);\n            }\n            else {\n                // also store non-markers for consistent ordering\n                targets[i] = target;\n            }\n            ++i;\n        }\n        const childNodeList = fragment.childNodes;\n        i = 0;\n        ii = childNodeList.length;\n        const childNodes = this.childNodes = Array(ii);\n        while (i < ii) {\n            childNodes[i] = childNodeList[i];\n            ++i;\n        }\n        this.firstChild = fragment.firstChild;\n        this.lastChild = fragment.lastChild;\n    }\n    findTargets() {\n        return this.targets;\n    }\n    insertBefore(refNode) {\n        if (this.isLinked && !!this.refNode) {\n            this.addToLinked();\n        }\n        else {\n            const parent = refNode.parentNode;\n            if (this.isMounted) {\n                let current = this.firstChild;\n                const end = this.lastChild;\n                let next;\n                while (current != null) {\n                    next = current.nextSibling;\n                    parent.insertBefore(current, refNode);\n                    if (current === end) {\n                        break;\n                    }\n                    current = next;\n                }\n            }\n            else {\n                this.isMounted = true;\n                refNode.parentNode.insertBefore(this.fragment, refNode);\n            }\n        }\n    }\n    appendTo(parent) {\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.appendChild(this.fragment);\n        }\n    }\n    remove() {\n        if (this.isMounted) {\n            this.isMounted = false;\n            const fragment = this.fragment;\n            const end = this.lastChild;\n            let next;\n            let current = this.firstChild;\n            while (current !== null) {\n                next = current.nextSibling;\n                fragment.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n    }\n    addToLinked() {\n        const refNode = this.refNode;\n        const parent = refNode.parentNode;\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.insertBefore(current, refNode);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.insertBefore(this.fragment, refNode);\n        }\n    }\n    unlink() {\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n    }\n    link(next) {\n        this.isLinked = true;\n        if (this.dom.isRenderLocation(next)) {\n            this.refNode = next;\n        }\n        else {\n            this.next = next;\n            this.obtainRefNode();\n        }\n    }\n    obtainRefNode() {\n        if (this.next !== void 0) {\n            this.refNode = this.next.firstChild;\n        }\n        else {\n            this.refNode = void 0;\n        }\n    }\n}\n/** @internal */\nexport class AuMarker {\n    constructor(nextSibling) {\n        this.nextSibling = nextSibling;\n        this.textContent = '';\n    }\n    get parentNode() {\n        return this.nextSibling.parentNode;\n    }\n    remove() { }\n}\n(proto => {\n    proto.previousSibling = null;\n    proto.childNodes = PLATFORM.emptyArray;\n    proto.nodeName = 'AU-M';\n    proto.nodeType = 1 /* Element */;\n})(AuMarker.prototype);\n//# sourceMappingURL=dom.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { PLATFORM } from '@aurelia/kernel';\nimport { bindable, customAttribute, IDOM, INode, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\nconst unset = Symbol();\n// Using passive to help with performance\nconst defaultCaptureEventInit = {\n    passive: true,\n    capture: true\n};\n// Using passive to help with performance\nconst defaultBubbleEventInit = {\n    passive: true\n};\n// weakly connect a document to a blur manager\n// to avoid polluting the document properties\nconst blurDocMap = new WeakMap();\nexport class BlurManager {\n    constructor(dom, scheduler) {\n        this.dom = dom;\n        this.scheduler = scheduler;\n        this.blurs = [];\n        blurDocMap.set(dom.document, this);\n        this.handler = createHandler(this, this.blurs);\n    }\n    static createFor(dom, scheduler) {\n        return blurDocMap.get(dom.document) || new BlurManager(dom, scheduler);\n    }\n    register(blur) {\n        const blurs = this.blurs;\n        if (!blurs.includes(blur) && blurs.push(blur) === 1) {\n            this.addListeners();\n        }\n    }\n    unregister(blur) {\n        const blurs = this.blurs;\n        const index = blurs.indexOf(blur);\n        if (index > -1) {\n            blurs.splice(index, 1);\n        }\n        if (blurs.length === 0) {\n            this.removeListeners();\n        }\n    }\n    addListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.addEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.addEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.addEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.addEventListener('focus', handler, defaultCaptureEventInit);\n        win.addEventListener('blur', handler, defaultBubbleEventInit);\n    }\n    removeListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.removeEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.removeEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.removeEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.removeEventListener('focus', handler, defaultCaptureEventInit);\n        win.removeEventListener('blur', handler, defaultBubbleEventInit);\n    }\n}\nlet Blur = class Blur {\n    constructor(element, dom, scheduler) {\n        this.dom = dom;\n        this.element = element;\n        /**\n         * By default, the behavior should be least surprise possible, that:\n         *\n         * it searches for anything from root context,\n         * and root context is document body\n         */\n        this.linkedMultiple = true;\n        this.searchSubTree = true;\n        this.linkingContext = null;\n        this.value = unset;\n        this.manager = BlurManager.createFor(dom, scheduler);\n    }\n    afterAttach() {\n        this.manager.register(this);\n    }\n    beforeDetach() {\n        this.manager.unregister(this);\n    }\n    handleEventTarget(target) {\n        if (this.value === false) {\n            return;\n        }\n        const dom = this.dom;\n        if (target === dom.window || target === dom.document || !this.contains(target)) {\n            this.triggerBlur();\n        }\n    }\n    contains(target) {\n        if (!this.value) {\n            return false;\n        }\n        let els;\n        let i;\n        let j, jj;\n        let link;\n        const element = this.element;\n        if (containsElementOrShadowRoot(element, target)) {\n            return true;\n        }\n        if (!this.linkedWith) {\n            return false;\n        }\n        const doc = this.dom.document;\n        const linkedWith = this.linkedWith;\n        const linkingContext = this.linkingContext;\n        const searchSubTree = this.searchSubTree;\n        const linkedMultiple = this.linkedMultiple;\n        const links = Array.isArray(linkedWith) ? linkedWith : [linkedWith];\n        const contextNode = (typeof linkingContext === 'string'\n            ? doc.querySelector(linkingContext)\n            : linkingContext)\n            || doc.body;\n        const ii = links.length;\n        for (i = 0; ii > i; ++i) {\n            link = links[i];\n            // When user specify to link with something by a string, it acts as a CSS selector\n            // We need to do some querying stuff to determine if target above is contained.\n            if (typeof link === 'string') {\n                // Default behavior, search the whole tree, from context that user specified, which default to document body\n                if (searchSubTree) {\n                    // todo: are there too many knobs?? Consider remove \"linkedMultiple\"??\n                    if (!linkedMultiple) {\n                        const el = contextNode.querySelector(link);\n                        els = el !== null ? [el] : PLATFORM.emptyArray;\n                    }\n                    else {\n                        els = contextNode.querySelectorAll(link);\n                    }\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].contains(target)) {\n                            return true;\n                        }\n                    }\n                }\n                else {\n                    // default to document body, if user didn't define a linking context, and wanted to ignore subtree.\n                    // This is specifically performant and useful for dialogs, plugins\n                    // that usually generate contents to document body\n                    els = contextNode.children;\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].matches(link)) {\n                            return true;\n                        }\n                    }\n                }\n            }\n            else {\n                // When user passed in something that is not a string,\n                // simply check if has method `contains` (allow duck typing)\n                // and call it against target.\n                // This enables flexible usages\n                if (link && link.contains(target)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    triggerBlur() {\n        this.value = false;\n        if (typeof this.onBlur === 'function') {\n            this.onBlur.call(null);\n        }\n    }\n};\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"value\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Blur.prototype, \"onBlur\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"linkedWith\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Blur.prototype, \"linkedMultiple\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Blur.prototype, \"searchSubTree\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"linkingContext\", void 0);\nBlur = __decorate([\n    customAttribute('blur'),\n    __param(0, INode), __param(1, IDOM), __param(2, IScheduler),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM, Object])\n], Blur);\nexport { Blur };\nconst containsElementOrShadowRoot = (container, target) => {\n    if (container.contains(target)) {\n        return true;\n    }\n    let parentNode = null;\n    while (target != null) {\n        if (target === container) {\n            return true;\n        }\n        parentNode = target.parentNode;\n        if (parentNode === null && target.nodeType === 11 /* DocumentFragment */) {\n            target = target.host;\n            continue;\n        }\n        target = parentNode;\n    }\n    return false;\n};\nconst createHandler = (manager, checkTargets) => {\n    // *******************************\n    // EVENTS ORDER\n    // -----------------------------\n    // pointerdown\n    // touchstart\n    // pointerup\n    // touchend\n    // mousedown\n    // --------------\n    // BLUR\n    // FOCUS\n    // --------------\n    // mouseup\n    // click\n    //\n    // ******************************\n    //\n    // There are cases focus happens without mouse interaction (keyboard)\n    // So it needs to capture both mouse / focus movement\n    //\n    // ******************************\n    let hasChecked = false;\n    const revertCheckage = () => {\n        hasChecked = false;\n    };\n    const markChecked = () => {\n        hasChecked = true;\n        manager.scheduler.queueRenderTask(revertCheckage, { preempt: true });\n    };\n    const handleMousedown = (e) => {\n        if (!hasChecked) {\n            handleEvent(e);\n            markChecked();\n        }\n    };\n    /**\n     * Handle globally captured focus event\n     * This can happen via a few way:\n     * User clicks on a focusable element\n     * User uses keyboard to navigate to a focusable element\n     * User goes back to the window from another browser tab\n     * User clicks on a non-focusable element\n     * User clicks on the window, outside of the document\n     */\n    const handleFocus = (e) => {\n        if (hasChecked) {\n            return;\n        }\n        // there are two way a focus gets captured on window\n        // when the windows itself got focus\n        // and when an element in the document gets focus\n        // when the window itself got focus, reacting to it is quite unnecessary\n        // as it doesn't really affect element inside the document\n        // Do a simple check and bail immediately\n        const isWindow = e.target === manager.dom.window;\n        if (isWindow) {\n            for (let i = 0, ii = checkTargets.length; ii > i; ++i) {\n                checkTargets[i].triggerBlur();\n            }\n        }\n        else {\n            handleEvent(e);\n        }\n        markChecked();\n    };\n    const handleWindowBlur = () => {\n        hasChecked = false;\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].triggerBlur();\n        }\n    };\n    const handleEvent = (e) => {\n        const target = e.composed ? e.composedPath()[0] : e.target;\n        if (target === null) {\n            return;\n        }\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].handleEventTarget(target);\n        }\n    };\n    return {\n        onpointerdown: handleMousedown,\n        ontouchstart: handleMousedown,\n        onmousedown: handleMousedown,\n        onfocus: handleFocus,\n        onblur: handleWindowBlur,\n        handleEvent(e) {\n            this[`on${e.type}`](e);\n        }\n    };\n};\n//# sourceMappingURL=blur.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, BindingMode, customAttribute, IDOM, INode } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\n/**\n * Focus attribute for element focus binding\n */\nlet Focus = class Focus {\n    constructor(element, dom) {\n        this.dom = dom;\n        /**\n         * Indicates whether `apply` should be called when `afterAttach` callback is invoked\n         */\n        this.needsApply = false;\n        this.element = element;\n    }\n    beforeBind() {\n        this.valueChanged();\n    }\n    /**\n     * Invoked everytime the bound value changes.\n     *\n     * @param newValue - The new value.\n     */\n    valueChanged() {\n        // In theory, we could/should react immediately\n        // but focus state of an element cannot be achieved\n        // while it's disconnected from the document\n        // thus, there neesd to be a check if it's currently connected or not\n        // before applying the value to the element\n        if (this.$controller.state & 32 /* isAttached */) {\n            this.apply();\n        }\n        else {\n            // If the element is not currently connect\n            // toggle the flag to add pending work for later\n            // in afterAttach lifecycle\n            this.needsApply = true;\n        }\n    }\n    /**\n     * Invoked when the attribute is afterAttach to the DOM.\n     */\n    afterAttach() {\n        if (this.needsApply) {\n            this.needsApply = false;\n            this.apply();\n        }\n        const el = this.element;\n        el.addEventListener('focus', this);\n        el.addEventListener('blur', this);\n    }\n    /**\n     * Invoked when the attribute is afterDetach from the DOM.\n     */\n    afterDetach() {\n        const el = this.element;\n        el.removeEventListener('focus', this);\n        el.removeEventListener('blur', this);\n    }\n    /**\n     * EventTarget interface handler for better memory usage\n     */\n    handleEvent(e) {\n        // there are only two event listened to\n        // if the even is focus, it menans the element is focused\n        // only need to switch the value to true\n        if (e.type === 'focus') {\n            this.value = true;\n        }\n        else if (this.dom.document.activeElement !== this.element) {\n            // else, it's blur event\n            // when a blur event happens, there are two situations\n            // 1. the element itself lost the focus\n            // 2. window lost the focus\n            // To handle both (1) and (2), only need to check if\n            // current active element is still the same element of this focus custom attribute\n            // If it's not, it's a blur event happened on Window because the browser tab lost focus\n            this.value = false;\n        }\n    }\n    /**\n     * Focus/blur based on current value\n     */\n    apply() {\n        const el = this.element;\n        if (this.value) {\n            el.focus();\n        }\n        else {\n            el.blur();\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.twoWay }),\n    __metadata(\"design:type\", Object)\n], Focus.prototype, \"value\", void 0);\nFocus = __decorate([\n    customAttribute('focus'),\n    __param(0, INode), __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], Focus);\nexport { Focus };\n//# sourceMappingURL=focus.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, } from '@aurelia/kernel';\nimport { bindable, ContinuationTask, IDOM, IRenderLocation, IViewFactory, LifecycleTask, templateController, TerminalTask, } from '@aurelia/runtime';\nimport { HTMLDOM, } from '../../dom';\nfunction toTask(maybePromiseOrTask) {\n    if (maybePromiseOrTask == null) {\n        return LifecycleTask.done;\n    }\n    if (typeof maybePromiseOrTask.then === 'function') {\n        return new TerminalTask(maybePromiseOrTask);\n    }\n    return maybePromiseOrTask;\n}\nlet Portal = class Portal {\n    constructor(factory, originalLoc, dom) {\n        this.factory = factory;\n        this.originalLoc = originalLoc;\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.strict = false;\n        this.task = LifecycleTask.done;\n        // to make the shape of this object consistent.\n        // todo: is this necessary\n        this.currentTarget = dom.createElement('div');\n        this.view = this.factory.create();\n        dom.setEffectiveParentNode(this.view.nodes, originalLoc);\n        this.view.hold(originalLoc, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        if (this.callbackContext == null) {\n            this.callbackContext = this.$controller.scope.bindingContext;\n        }\n        return this.view.bind(flags, this.$controller.scope);\n    }\n    afterAttach(flags) {\n        this.targetChanged();\n    }\n    beforeDetach(flags) {\n        this.task = this.deactivate(flags);\n    }\n    beforeUnbind(flags) {\n        this.callbackContext = null;\n        return this.view.unbind(flags);\n    }\n    targetChanged() {\n        const $controller = this.$controller;\n        if (($controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        this.project($controller.flags);\n    }\n    project(flags) {\n        const oldTarget = this.currentTarget;\n        const newTarget = this.currentTarget = this.resolveTarget();\n        if (oldTarget === newTarget) {\n            return;\n        }\n        this.task = this.deactivate(flags);\n        this.task = this.activate(newTarget, flags);\n    }\n    activate(target, flags) {\n        const { activating, activated, callbackContext, view } = this;\n        let task = this.task;\n        view.hold(target, 2 /* append */);\n        if ((this.$controller.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return task;\n        }\n        if (typeof activating === 'function') {\n            if (task.done) {\n                task = toTask(activating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.attach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.attach, view, flags);\n        }\n        if (typeof activated === 'function') {\n            if (task.done) {\n                // TODO: chain this up with RAF queue mount callback so activated is called only when\n                // node is actually mounted (is this needed as per the spec of this resource?)\n                task = toTask(activated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const { deactivating, deactivated, callbackContext, view, target: target } = this;\n        let task = this.task;\n        if (typeof deactivating === 'function') {\n            if (task.done) {\n                task = toTask(deactivating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.detach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.detach, view, flags);\n        }\n        if (typeof deactivated === 'function') {\n            if (task.done) {\n                task = toTask(deactivated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    resolveTarget() {\n        const dom = this.dom;\n        // with a $ in front to make it less confusing/error prone\n        const $document = dom.document;\n        let target = this.target;\n        let context = this.renderContext;\n        if (typeof target === 'string') {\n            let queryContext = $document;\n            if (typeof context === 'string') {\n                context = $document.querySelector(context);\n            }\n            if (dom.isNodeInstance(context)) {\n                queryContext = context;\n            }\n            target = queryContext.querySelector(target);\n        }\n        if (dom.isNodeInstance(target)) {\n            return target;\n        }\n        if (target == null) {\n            if (this.strict) {\n                throw new Error('Render target not found');\n            }\n            else {\n                target = $document.body;\n            }\n        }\n        return target;\n    }\n};\n__decorate([\n    bindable({ primary: true }),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"target\", void 0);\n__decorate([\n    bindable({ callback: 'targetChanged' }),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"renderContext\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Portal.prototype, \"strict\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"deactivating\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"activating\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"deactivated\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"activated\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"callbackContext\", void 0);\nPortal = __decorate([\n    templateController('portal'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __param(2, IDOM),\n    __metadata(\"design:paramtypes\", [Object, Object, HTMLDOM])\n], Portal);\nexport { Portal };\n//# sourceMappingURL=portal.js.map","export var HTMLTargetedInstructionType;\n(function (HTMLTargetedInstructionType) {\n    HTMLTargetedInstructionType[\"textBinding\"] = \"ha\";\n    HTMLTargetedInstructionType[\"listenerBinding\"] = \"hb\";\n    HTMLTargetedInstructionType[\"attributeBinding\"] = \"hc\";\n    HTMLTargetedInstructionType[\"stylePropertyBinding\"] = \"hd\";\n    HTMLTargetedInstructionType[\"setAttribute\"] = \"he\";\n    HTMLTargetedInstructionType[\"setClassAttribute\"] = \"hf\";\n    HTMLTargetedInstructionType[\"setStyleAttribute\"] = \"hg\";\n})(HTMLTargetedInstructionType || (HTMLTargetedInstructionType = {}));\nexport function isHTMLTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\n//# sourceMappingURL=definitions.js.map","import { DelegationStrategy } from '@aurelia/runtime';\nexport class TextBindingInstruction {\n    constructor(from) {\n        this.from = from;\n        this.type = \"ha\" /* textBinding */;\n    }\n}\nexport class TriggerBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = true;\n        this.strategy = DelegationStrategy.none;\n    }\n}\nexport class DelegateBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.bubbling;\n    }\n}\nexport class CaptureBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.capturing;\n    }\n}\nexport class StylePropertyBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hd\" /* stylePropertyBinding */;\n    }\n}\nexport class SetAttributeInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"he\" /* setAttribute */;\n    }\n}\nexport class SetClassAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hf\" /* setClassAttribute */;\n    }\n}\nexport class SetStyleAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hg\" /* setStyleAttribute */;\n    }\n}\nexport class AttributeBindingInstruction {\n    constructor(\n    /**\n     * `attr` and `to` have the same value on a normal attribute\n     * Will be different on `class` and `style`\n     * on `class`: attr = `class` (from binding command), to = attribute name\n     * on `style`: attr = `style` (from binding command), to = attribute name\n     */\n    attr, from, to) {\n        this.attr = attr;\n        this.from = from;\n        this.to = to;\n        this.type = \"hc\" /* attributeBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","import { CustomElement, HydrateElementInstruction, CustomElementDefinition, getRenderContext, } from '@aurelia/runtime';\nimport { isHTMLTargetedInstruction } from './definitions';\nimport { SetAttributeInstruction } from './instructions';\nexport function createElement(dom, tagOrType, props, children) {\n    if (typeof tagOrType === 'string') {\n        return createElementForTag(dom, tagOrType, props, children);\n    }\n    else if (CustomElement.isType(tagOrType)) {\n        return createElementForType(dom, tagOrType, props, children);\n    }\n    else {\n        throw new Error(`Invalid tagOrType.`);\n    }\n}\n/**\n * RenderPlan. Todo: describe goal of this class\n */\nexport class RenderPlan {\n    constructor(dom, node, instructions, dependencies) {\n        this.dom = dom;\n        this.node = node;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.lazyDefinition = void 0;\n    }\n    get definition() {\n        if (this.lazyDefinition === void 0) {\n            this.lazyDefinition = CustomElementDefinition.create({\n                name: CustomElement.generateName(),\n                template: this.node,\n                needsCompile: typeof this.node === 'string',\n                instructions: this.instructions,\n                dependencies: this.dependencies,\n            });\n        }\n        return this.lazyDefinition;\n    }\n    getContext(parentContainer) {\n        return getRenderContext(this.definition, parentContainer, void 0);\n    }\n    createView(parentContainer) {\n        return this.getViewFactory(parentContainer).create();\n    }\n    getViewFactory(parentContainer) {\n        return this.getContext(parentContainer).getViewFactory();\n    }\n    /** @internal */\n    mergeInto(parent, instructions, dependencies) {\n        this.dom.appendChild(parent, this.node);\n        instructions.push(...this.instructions);\n        dependencies.push(...this.dependencies);\n    }\n}\nfunction createElementForTag(dom, tagName, props, children) {\n    const instructions = [];\n    const allInstructions = [];\n    const dependencies = [];\n    const element = dom.createElement(tagName);\n    let hasInstructions = false;\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                hasInstructions = true;\n                instructions.push(value);\n            }\n            else {\n                dom.setAttribute(element, to, value);\n            }\n        });\n    }\n    if (hasInstructions) {\n        dom.makeTarget(element);\n        allInstructions.push(instructions);\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction createElementForType(dom, Type, props, children) {\n    const definition = CustomElement.getDefinition(Type);\n    const tagName = definition.name;\n    const instructions = [];\n    const allInstructions = [instructions];\n    const dependencies = [];\n    const childInstructions = [];\n    const bindables = definition.bindables;\n    const element = dom.createElement(tagName);\n    dom.makeTarget(element);\n    if (!dependencies.includes(Type)) {\n        dependencies.push(Type);\n    }\n    instructions.push(new HydrateElementInstruction(tagName, childInstructions));\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                childInstructions.push(value);\n            }\n            else {\n                const bindable = bindables[to];\n                if (bindable !== void 0) {\n                    childInstructions.push({\n                        type: \"re\" /* setProperty */,\n                        to,\n                        value\n                    });\n                }\n                else {\n                    childInstructions.push(new SetAttributeInstruction(value, to));\n                }\n            }\n        });\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction addChildren(dom, parent, children, allInstructions, dependencies) {\n    for (let i = 0, ii = children.length; i < ii; ++i) {\n        const current = children[i];\n        switch (typeof current) {\n            case 'string':\n                dom.appendChild(parent, dom.createTextNode(current));\n                break;\n            case 'object':\n                if (dom.isNodeInstance(current)) {\n                    dom.appendChild(parent, current);\n                }\n                else if ('mergeInto' in current) {\n                    current.mergeInto(parent, allInstructions, dependencies);\n                }\n        }\n    }\n}\n//# sourceMappingURL=create-element.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, ContinuationTask, IDOM, ITargetedInstruction, LifecycleTask, PromiseTask, CustomElementDefinition, bindable, customElement, getRenderContext, } from '@aurelia/runtime';\nimport { createElement, } from '../../create-element';\nconst bindables = ['subject', 'composing'];\nlet Compose = class Compose {\n    constructor(dom, instruction) {\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.subject = void 0;\n        this.composing = false;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.lastSubject = void 0;\n        this.properties = instruction.instructions\n            .filter((x) => !bindables.includes(x.to))\n            .reduce((acc, item) => {\n            if (item.to) {\n                acc[item.to] = item;\n            }\n            return acc;\n        }, {});\n    }\n    beforeBind(flags) {\n        if (this.task.done) {\n            this.task = this.compose(this.subject, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, this.subject, flags);\n        }\n        if (this.task.done) {\n            this.task = this.bindView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.bindView, this, flags);\n        }\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n    }\n    beforeUnbind(flags) {\n        this.lastSubject = void 0;\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        this.view = void 0;\n    }\n    subjectChanged(newValue, previousValue, flags) {\n        flags |= this.$controller.flags;\n        if (this.task.done) {\n            this.task = this.compose(newValue, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, newValue, flags);\n        }\n    }\n    compose(subject, flags) {\n        if (this.lastSubject === subject) {\n            return LifecycleTask.done;\n        }\n        this.lastSubject = subject;\n        this.composing = true;\n        let task = this.deactivate(flags);\n        if (subject instanceof Promise) {\n            let viewPromise;\n            if (task.done) {\n                viewPromise = subject.then(s => this.resolveView(s, flags));\n            }\n            else {\n                viewPromise = task.wait().then(() => subject.then(s => this.resolveView(s, flags)));\n            }\n            task = new PromiseTask(viewPromise, this.activate, this, flags);\n        }\n        else {\n            const view = this.resolveView(subject, flags);\n            if (task.done) {\n                task = this.activate(view, flags);\n            }\n            else {\n                task = new ContinuationTask(task, this.activate, this, view, flags);\n            }\n        }\n        if (task.done) {\n            this.onComposed();\n        }\n        else {\n            task = new ContinuationTask(task, this.onComposed, this);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags);\n        return view.unbind(flags);\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (5 /* isBoundOrBinding */)) > 0) {\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (40 /* isAttachedOrAttaching */)) > 0) {\n            this.view.attach(flags);\n        }\n    }\n    onComposed() {\n        this.composing = false;\n    }\n    resolveView(subject, flags) {\n        const view = this.provideViewFor(subject, flags);\n        if (view) {\n            view.hold(this.$controller.projector.host, 1 /* insertBefore */);\n            view.lockScope(this.$controller.scope);\n            return view;\n        }\n        return void 0;\n    }\n    provideViewFor(subject, flags) {\n        if (!subject) {\n            return void 0;\n        }\n        if (isController(subject)) { // IController\n            return subject;\n        }\n        if ('createView' in subject) { // RenderPlan\n            return subject.createView(this.$controller.context);\n        }\n        if ('create' in subject) { // IViewFactory\n            return subject.create(flags);\n        }\n        if ('template' in subject) { // Raw Template Definition\n            const definition = CustomElementDefinition.getOrCreate(subject);\n            return getRenderContext(definition, this.$controller.context, void 0).getViewFactory().create(flags);\n        }\n        // Constructable (Custom Element Constructor)\n        return createElement(this.dom, subject, this.properties, this.$controller.projector === void 0\n            ? PLATFORM.emptyArray\n            : this.$controller.projector.children).createView(this.$controller.context);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], Compose.prototype, \"subject\", void 0);\n__decorate([\n    bindable({ mode: BindingMode.fromView }),\n    __metadata(\"design:type\", Boolean)\n], Compose.prototype, \"composing\", void 0);\nCompose = __decorate([\n    customElement({ name: 'au-compose', template: null, containerless: true }),\n    __param(0, IDOM),\n    __param(1, ITargetedInstruction),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], Compose);\nexport { Compose };\nfunction isController(subject) {\n    return 'lockScope' in subject;\n}\n//# sourceMappingURL=compose.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { BindingMode, ensureExpression, IExpressionParser, instructionRenderer, InterpolationBinding, IObserverLocator, MultiInterpolationBinding, PropertyBinding, applyBindingBehavior, } from '@aurelia/runtime';\nimport { AttributeBinding } from './binding/attribute';\nimport { Listener } from './binding/listener';\nimport { IEventManager } from './observation/event-manager';\nlet TextBindingRenderer = \n/** @internal */\nclass TextBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const next = target.nextSibling;\n        if (context.dom.isMarker(target)) {\n            context.dom.remove(target);\n        }\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, next, 'textContent', BindingMode.toView, context), expr, context);\n        }\n        else {\n            binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, next, 'textContent', BindingMode.toView, this.observerLocator, context, true), expr, context);\n        }\n        controller.addBinding(binding);\n    }\n};\nTextBindingRenderer = __decorate([\n    instructionRenderer(\"ha\" /* textBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TextBindingRenderer);\nexport { TextBindingRenderer };\nlet ListenerBindingRenderer = \n/** @internal */\nclass ListenerBindingRenderer {\n    constructor(parser, eventManager) {\n        this.parser = parser;\n        this.eventManager = eventManager;\n    }\n    render(flags, context, controller, target, instruction) {\n        // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n        const expr = ensureExpression(this.parser, instruction.from, 80 /* IsEventCommand */ | (instruction.strategy + 6 /* DelegationStrategyDelta */));\n        const binding = applyBindingBehavior(new Listener(context.dom, instruction.to, instruction.strategy, expr, target, instruction.preventDefault, this.eventManager, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nListenerBindingRenderer = __decorate([\n    instructionRenderer(\"hb\" /* listenerBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], ListenerBindingRenderer);\nexport { ListenerBindingRenderer };\nlet SetAttributeRenderer = \n/** @internal */\nclass SetAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        target.setAttribute(instruction.to, instruction.value);\n    }\n};\nSetAttributeRenderer = __decorate([\n    instructionRenderer(\"he\" /* setAttribute */)\n    /** @internal */\n], SetAttributeRenderer);\nexport { SetAttributeRenderer };\nlet SetClassAttributeRenderer = class SetClassAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        addClasses(target.classList, instruction.value);\n    }\n};\nSetClassAttributeRenderer = __decorate([\n    instructionRenderer(\"hf\" /* setClassAttribute */)\n], SetClassAttributeRenderer);\nexport { SetClassAttributeRenderer };\nlet SetStyleAttributeRenderer = class SetStyleAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        target.style.cssText += instruction.value;\n    }\n};\nSetStyleAttributeRenderer = __decorate([\n    instructionRenderer(\"hg\" /* setStyleAttribute */)\n], SetStyleAttributeRenderer);\nexport { SetStyleAttributeRenderer };\nlet StylePropertyBindingRenderer = \n/** @internal */\nclass StylePropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, target.style, instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nStylePropertyBindingRenderer = __decorate([\n    instructionRenderer(\"hd\" /* stylePropertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], StylePropertyBindingRenderer);\nexport { StylePropertyBindingRenderer };\nlet AttributeBindingRenderer = \n/** @internal */\nclass AttributeBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = applyBindingBehavior(new AttributeBinding(expr, target, instruction.attr /* targetAttribute */, instruction.to /* targetKey */, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nAttributeBindingRenderer = __decorate([\n    instructionRenderer(\"hc\" /* attributeBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], AttributeBindingRenderer);\nexport { AttributeBindingRenderer };\n// http://jsben.ch/7n5Kt\nfunction addClasses(classList, className) {\n    const len = className.length;\n    let start = 0;\n    for (let i = 0; i < len; ++i) {\n        if (className.charCodeAt(i) === 0x20) {\n            if (i !== start) {\n                classList.add(className.slice(start, i));\n            }\n            start = i + 1;\n        }\n        else if (i + 1 === len) {\n            classList.add(className.slice(start));\n        }\n    }\n}\n//# sourceMappingURL=html-renderer.js.map","import { DI } from '@aurelia/kernel';\nimport { RuntimeConfiguration } from '@aurelia/runtime';\nimport { AttributeBindingRenderer, ListenerBindingRenderer, SetAttributeRenderer, StylePropertyBindingRenderer, TextBindingRenderer, SetClassAttributeRenderer, SetStyleAttributeRenderer } from './html-renderer';\nimport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nimport { HTMLProjectorLocator } from './projectors';\nimport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nimport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nimport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nimport { Blur } from './resources/custom-attributes/blur';\nimport { Focus } from './resources/custom-attributes/focus';\nimport { Portal } from './resources/custom-attributes/portal';\nimport { Compose } from './resources/custom-elements/compose';\nexport const IProjectorLocatorRegistration = HTMLProjectorLocator;\nexport const ITargetAccessorLocatorRegistration = TargetAccessorLocator;\nexport const ITargetObserverLocatorRegistration = TargetObserverLocator;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `IProjectorLocator`\n * - `ITargetAccessorLocator`\n * - `ITargetObserverLocator`\n * - `ITemplateFactory`\n */\nexport const DefaultComponents = [\n    IProjectorLocatorRegistration,\n    ITargetAccessorLocatorRegistration,\n    ITargetObserverLocatorRegistration,\n];\nexport const AttrBindingBehaviorRegistration = AttrBindingBehavior;\nexport const SelfBindingBehaviorRegistration = SelfBindingBehavior;\nexport const UpdateTriggerBindingBehaviorRegistration = UpdateTriggerBindingBehavior;\nexport const ComposeRegistration = Compose;\nexport const PortalRegistration = Portal;\nexport const FocusRegistration = Focus;\nexport const BlurRegistration = Blur;\n/**\n * Default HTML-specific (but environment-agnostic) resources:\n * - Binding Behaviors: `attr`, `self`, `updateTrigger`\n * - Custom Elements: `au-compose`\n * - Custom Attributes: `blur`, `focus`, `portal`\n */\nexport const DefaultResources = [\n    AttrBindingBehaviorRegistration,\n    SelfBindingBehaviorRegistration,\n    UpdateTriggerBindingBehaviorRegistration,\n    ComposeRegistration,\n    PortalRegistration,\n    FocusRegistration,\n    BlurRegistration\n];\nexport const ListenerBindingRendererRegistration = ListenerBindingRenderer;\nexport const AttributeBindingRendererRegistration = AttributeBindingRenderer;\nexport const SetAttributeRendererRegistration = SetAttributeRenderer;\nexport const SetClassAttributeRendererRegistration = SetClassAttributeRenderer;\nexport const SetStyleAttributeRendererRegistration = SetStyleAttributeRenderer;\nexport const StylePropertyBindingRendererRegistration = StylePropertyBindingRenderer;\nexport const TextBindingRendererRegistration = TextBindingRenderer;\n/**\n * Default HTML-specfic (but environment-agnostic) renderers for:\n * - Listener Bindings: `trigger`, `capture`, `delegate`\n * - SetAttribute\n * - StyleProperty: `style`, `css`\n * - TextBinding: `${}`\n */\nexport const DefaultRenderers = [\n    ListenerBindingRendererRegistration,\n    AttributeBindingRendererRegistration,\n    SetAttributeRendererRegistration,\n    SetClassAttributeRendererRegistration,\n    SetStyleAttributeRendererRegistration,\n    StylePropertyBindingRendererRegistration,\n    TextBindingRendererRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registration, DI } from '@aurelia/kernel';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles, AdoptedStyleSheetsStyles, StyleElementStyles } from './shadow-dom-styles';\nimport { HTMLDOM } from '../dom';\nimport { IDOM } from '@aurelia/runtime';\nexport function shadowCSS(...css) {\n    return new ShadowDOMRegistry(css);\n}\nconst factoryCache = new WeakMap();\nexport const IShadowDOMStyleFactory = DI.createInterface('IShadowDOMStyleFactory')\n    .withDefault(x => x.callback((handler, requestor, resolver) => {\n    let factory = factoryCache.get(resolver);\n    if (factory === void 0) {\n        factoryCache.set(resolver, factory = ShadowDOMRegistry.createStyleFactory(handler));\n    }\n    return factory;\n}));\nexport class ShadowDOMRegistry {\n    constructor(css) {\n        this.css = css;\n    }\n    register(container) {\n        const sharedStyles = container.get(IShadowDOMGlobalStyles);\n        const factory = container.get(IShadowDOMStyleFactory);\n        container.register(Registration.instance(IShadowDOMStyles, factory.createStyles(this.css, sharedStyles)));\n    }\n    static createStyleFactory(container) {\n        if (AdoptedStyleSheetsStyles.supported(container.get(HTMLDOM))) {\n            return container.get(AdoptedStyleSheetsStylesFactory);\n        }\n        return container.get(StyleElementStylesFactory);\n    }\n}\nlet AdoptedStyleSheetsStylesFactory = class AdoptedStyleSheetsStylesFactory {\n    constructor(dom) {\n        this.dom = dom;\n        this.cache = new Map();\n    }\n    createStyles(localStyles, sharedStyles) {\n        return new AdoptedStyleSheetsStyles(this.dom, localStyles, this.cache, sharedStyles);\n    }\n};\nAdoptedStyleSheetsStylesFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], AdoptedStyleSheetsStylesFactory);\nlet StyleElementStylesFactory = class StyleElementStylesFactory {\n    constructor(dom) {\n        this.dom = dom;\n    }\n    createStyles(localStyles, sharedStyles) {\n        if (localStyles.some(x => typeof x !== 'string')) {\n            // TODO: use reporter\n            throw new Error('Shadow DOM CSS must be a string.');\n        }\n        return new StyleElementStyles(this.dom, localStyles, sharedStyles);\n    }\n};\nStyleElementStylesFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], StyleElementStylesFactory);\n//# sourceMappingURL=shadow-dom-registry.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, customAttribute, INode } from '@aurelia/runtime';\nimport { getClassesToAdd } from '../observation/class-attribute-accessor';\nexport function cssModules(...cssModules) {\n    return new CSSModulesProcessorRegistry(cssModules);\n}\nexport class CSSModulesProcessorRegistry {\n    constructor(cssModules) {\n        this.cssModules = cssModules;\n    }\n    register(container) {\n        const classLookup = Object.assign({}, ...this.cssModules);\n        let ClassCustomAttribute = class ClassCustomAttribute {\n            constructor(element /* TODO(fkleuver): fix this type annotation reflection issue in AOT */) {\n                this.element = element;\n            }\n            beforeBind() {\n                this.valueChanged();\n            }\n            valueChanged() {\n                if (!this.value) {\n                    this.element.className = '';\n                    return;\n                }\n                this.element.className = getClassesToAdd(this.value)\n                    .map(x => classLookup[x] || x)\n                    .join(' ');\n            }\n        };\n        __decorate([\n            bindable,\n            __metadata(\"design:type\", String)\n        ], ClassCustomAttribute.prototype, \"value\", void 0);\n        ClassCustomAttribute = __decorate([\n            customAttribute('class'),\n            __param(0, INode),\n            __metadata(\"design:paramtypes\", [Object])\n        ], ClassCustomAttribute);\n        container.register(ClassCustomAttribute);\n    }\n}\n//# sourceMappingURL=css-modules-registry.js.map","export { Listener } from './binding/listener';\nexport { AttributeBinding } from './binding/attribute';\nexport { AttributeNSAccessor } from './observation/attribute-ns-accessor';\nexport { CheckedObserver } from './observation/checked-observer';\nexport { ClassAttributeAccessor } from './observation/class-attribute-accessor';\nexport { DataAttributeAccessor } from './observation/data-attribute-accessor';\nexport { ElementPropertyAccessor } from './observation/element-property-accessor';\nexport { ListenerTracker, DelegateOrCaptureSubscription, TriggerSubscription, IEventManager, EventSubscriber, EventManager } from './observation/event-manager';\nexport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nexport { SelectValueObserver } from './observation/select-value-observer';\nexport { StyleAttributeAccessor } from './observation/style-attribute-accessor';\nexport { ISVGAnalyzer } from './observation/svg-analyzer';\nexport { ValueAttributeObserver } from './observation/value-attribute-observer';\nexport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nexport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nexport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nexport { Blur, BlurManager } from './resources/custom-attributes/blur';\nexport { Focus } from './resources/custom-attributes/focus';\nexport { Portal } from './resources/custom-attributes/portal';\nexport { Compose } from './resources/custom-elements/compose';\nexport { IProjectorLocatorRegistration, ITargetAccessorLocatorRegistration, ITargetObserverLocatorRegistration, DefaultComponents, AttrBindingBehaviorRegistration, SelfBindingBehaviorRegistration, UpdateTriggerBindingBehaviorRegistration, ComposeRegistration, DefaultResources, AttributeBindingRendererRegistration, ListenerBindingRendererRegistration, SetAttributeRendererRegistration, SetClassAttributeRendererRegistration, SetStyleAttributeRendererRegistration, StylePropertyBindingRendererRegistration, TextBindingRendererRegistration, DefaultRenderers, RuntimeHtmlConfiguration } from './configuration';\nexport { createElement, RenderPlan } from './create-element';\nexport { HTMLTargetedInstructionType, isHTMLTargetedInstruction } from './definitions';\nexport { NodeType, HTMLDOM, DOM, FragmentNodeSequence } from './dom';\nexport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, SetAttributeInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, StylePropertyBindingInstruction, TextBindingInstruction, TriggerBindingInstruction } from './instructions';\nexport { ContainerlessProjector, HostProjector, HTMLProjectorLocator, ShadowDOMProjector } from './projectors';\nexport { StyleConfiguration } from './styles/style-configuration';\nexport { CSSModulesProcessorRegistry, cssModules } from './styles/css-modules-registry';\nexport { ShadowDOMRegistry, IShadowDOMStyleFactory, shadowCSS } from './styles/shadow-dom-registry';\nexport { AdoptedStyleSheetsStyles, StyleElementStyles, IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\n//# sourceMappingURL=index.js.map","export class AttrSyntax {\n    constructor(rawName, rawValue, target, command) {\n        this.rawName = rawName;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.command = command;\n    }\n}\n//# sourceMappingURL=ast.js.map","import { DI, Metadata, PLATFORM, Protocol, Registration, Reporter } from '@aurelia/kernel';\n/** @internal */\nexport class CharSpec {\n    constructor(chars, repeat, isSymbol, isInverted) {\n        this.chars = chars;\n        this.repeat = repeat;\n        this.isSymbol = isSymbol;\n        this.isInverted = isInverted;\n        if (isInverted) {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNoneInverse;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingleInverse;\n                    break;\n                default:\n                    this.has = this.hasOfMultipleInverse;\n            }\n        }\n        else {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNone;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingle;\n                    break;\n                default:\n                    this.has = this.hasOfMultiple;\n            }\n        }\n    }\n    equals(other) {\n        return this.chars === other.chars\n            && this.repeat === other.repeat\n            && this.isSymbol === other.isSymbol\n            && this.isInverted === other.isInverted;\n    }\n    hasOfMultiple(char) {\n        return this.chars.includes(char);\n    }\n    hasOfSingle(char) {\n        return this.chars === char;\n    }\n    hasOfNone(char) {\n        return false;\n    }\n    hasOfMultipleInverse(char) {\n        return !this.chars.includes(char);\n    }\n    hasOfSingleInverse(char) {\n        return this.chars !== char;\n    }\n    hasOfNoneInverse(char) {\n        return true;\n    }\n}\nexport class Interpretation {\n    constructor() {\n        this.parts = PLATFORM.emptyArray;\n        this._pattern = '';\n        this.currentRecord = {};\n        this.partsRecord = {};\n    }\n    get pattern() {\n        const value = this._pattern;\n        if (value === '') {\n            return null;\n        }\n        else {\n            return value;\n        }\n    }\n    set pattern(value) {\n        if (value == null) {\n            this._pattern = '';\n            this.parts = PLATFORM.emptyArray;\n        }\n        else {\n            this._pattern = value;\n            this.parts = this.partsRecord[value];\n        }\n    }\n    append(pattern, ch) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] === undefined) {\n            currentRecord[pattern] = ch;\n        }\n        else {\n            currentRecord[pattern] += ch;\n        }\n    }\n    next(pattern) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] !== undefined) {\n            const { partsRecord } = this;\n            if (partsRecord[pattern] === undefined) {\n                partsRecord[pattern] = [currentRecord[pattern]];\n            }\n            else {\n                partsRecord[pattern].push(currentRecord[pattern]);\n            }\n            currentRecord[pattern] = undefined;\n        }\n    }\n}\n/** @internal */\nexport class State {\n    constructor(charSpec, ...patterns) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n        this.types = null;\n        this.isEndpoint = false;\n        this.patterns = patterns;\n    }\n    get pattern() {\n        return this.isEndpoint ? this.patterns[0] : null;\n    }\n    findChild(charSpec) {\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let child = null;\n        for (let i = 0; i < len; ++i) {\n            child = nextStates[i];\n            if (charSpec.equals(child.charSpec)) {\n                return child;\n            }\n        }\n        return null;\n    }\n    append(charSpec, pattern) {\n        const { patterns } = this;\n        if (!patterns.includes(pattern)) {\n            patterns.push(pattern);\n        }\n        let state = this.findChild(charSpec);\n        if (state == null) {\n            state = new State(charSpec, pattern);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n    findMatches(ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const results = [];\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let childLen = 0;\n        let child = null;\n        let i = 0;\n        let j = 0;\n        for (; i < len; ++i) {\n            child = nextStates[i];\n            if (child.charSpec.has(ch)) {\n                results.push(child);\n                childLen = child.patterns.length;\n                j = 0;\n                if (child.charSpec.isSymbol) {\n                    for (; j < childLen; ++j) {\n                        interpretation.next(child.patterns[j]);\n                    }\n                }\n                else {\n                    for (; j < childLen; ++j) {\n                        interpretation.append(child.patterns[j], ch);\n                    }\n                }\n            }\n        }\n        return results;\n    }\n}\n/** @internal */\nexport class StaticSegment {\n    constructor(text) {\n        this.text = text;\n        this.text = text;\n        const len = this.len = text.length;\n        const specs = this.specs = [];\n        for (let i = 0; i < len; ++i) {\n            specs.push(new CharSpec(text[i], false, false, false));\n        }\n    }\n    eachChar(callback) {\n        const { len, specs } = this;\n        for (let i = 0; i < len; ++i) {\n            callback(specs[i]);\n        }\n    }\n}\n/** @internal */\nexport class DynamicSegment {\n    constructor(symbols) {\n        this.text = 'PART';\n        this.spec = new CharSpec(symbols, true, false, true);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SymbolSegment {\n    constructor(text) {\n        this.text = text;\n        this.spec = new CharSpec(text, false, true, false);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SegmentTypes {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.symbols = 0;\n    }\n}\nexport const ISyntaxInterpreter = DI.createInterface('ISyntaxInterpreter').withDefault(x => x.singleton(SyntaxInterpreter));\n/** @internal */\nexport class SyntaxInterpreter {\n    constructor() {\n        this.rootState = new State(null);\n        this.initialStates = [this.rootState];\n    }\n    add(defOrDefs) {\n        let i = 0;\n        if (Array.isArray(defOrDefs)) {\n            const ii = defOrDefs.length;\n            for (; i < ii; ++i) {\n                this.add(defOrDefs[i]);\n            }\n            return;\n        }\n        let currentState = this.rootState;\n        const def = defOrDefs;\n        const pattern = def.pattern;\n        const types = new SegmentTypes();\n        const segments = this.parse(def, types);\n        const len = segments.length;\n        const callback = (ch) => {\n            currentState = currentState.append(ch, pattern);\n        };\n        for (i = 0; i < len; ++i) {\n            segments[i].eachChar(callback);\n        }\n        currentState.types = types;\n        currentState.isEndpoint = true;\n    }\n    interpret(name) {\n        const interpretation = new Interpretation();\n        let states = this.initialStates;\n        const len = name.length;\n        for (let i = 0; i < len; ++i) {\n            states = this.getNextStates(states, name.charAt(i), interpretation);\n            if (states.length === 0) {\n                break;\n            }\n        }\n        states.sort((a, b) => {\n            if (a.isEndpoint) {\n                if (!b.isEndpoint) {\n                    return -1;\n                }\n            }\n            else if (b.isEndpoint) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n            const aTypes = a.types;\n            const bTypes = b.types;\n            if (aTypes.statics !== bTypes.statics) {\n                return bTypes.statics - aTypes.statics;\n            }\n            if (aTypes.dynamics !== bTypes.dynamics) {\n                return bTypes.dynamics - aTypes.dynamics;\n            }\n            if (aTypes.symbols !== bTypes.symbols) {\n                return bTypes.symbols - aTypes.symbols;\n            }\n            return 0;\n        });\n        if (states.length > 0) {\n            const state = states[0];\n            if (!state.charSpec.isSymbol) {\n                interpretation.next(state.pattern);\n            }\n            interpretation.pattern = state.pattern;\n        }\n        return interpretation;\n    }\n    getNextStates(states, ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const nextStates = [];\n        let state = null;\n        const len = states.length;\n        for (let i = 0; i < len; ++i) {\n            state = states[i];\n            nextStates.push(...state.findMatches(ch, interpretation));\n        }\n        return nextStates;\n    }\n    parse(def, types) {\n        const result = [];\n        const pattern = def.pattern;\n        const len = pattern.length;\n        let i = 0;\n        let start = 0;\n        let c = '';\n        while (i < len) {\n            c = pattern.charAt(i);\n            if (!def.symbols.includes(c)) {\n                if (i === start) {\n                    if (c === 'P' && pattern.slice(i, i + 4) === 'PART') {\n                        start = i = (i + 4);\n                        result.push(new DynamicSegment(def.symbols));\n                        ++types.dynamics;\n                    }\n                    else {\n                        ++i;\n                    }\n                }\n                else {\n                    ++i;\n                }\n            }\n            else if (i !== start) {\n                result.push(new StaticSegment(pattern.slice(start, i)));\n                ++types.statics;\n                start = i;\n            }\n            else {\n                result.push(new SymbolSegment(pattern.slice(start, i + 1)));\n                ++types.symbols;\n                start = ++i;\n            }\n        }\n        if (start !== i) {\n            result.push(new StaticSegment(pattern.slice(start, i)));\n            ++types.statics;\n        }\n        return result;\n    }\n}\nfunction validatePrototype(handler, patternDefs) {\n    for (const def of patternDefs) {\n        // note: we're intentionally not throwing here\n        if (!(def.pattern in handler)) {\n            Reporter.write(401, def.pattern); // TODO: organize error codes\n        }\n        else if (typeof handler[def.pattern] !== 'function') {\n            Reporter.write(402, def.pattern); // TODO: organize error codes\n        }\n    }\n}\nexport const IAttributePattern = DI.createInterface('IAttributePattern').noDefault();\nexport function attributePattern(...patternDefs) {\n    return function decorator(target) {\n        return AttributePattern.define(patternDefs, target);\n    };\n}\nexport class AttributePatternResourceDefinition {\n    constructor(Type) {\n        this.Type = Type;\n        this.name = (void 0);\n    }\n    register(container) {\n        Registration.singleton(IAttributePattern, this.Type).register(container);\n    }\n}\nexport const AttributePattern = Object.freeze({\n    name: Protocol.resource.keyFor('attribute-pattern'),\n    definitionAnnotationKey: 'attribute-pattern-definitions',\n    define(patternDefs, Type) {\n        validatePrototype(Type.prototype, patternDefs);\n        const definition = new AttributePatternResourceDefinition(Type);\n        const { name, definitionAnnotationKey } = AttributePattern;\n        Metadata.define(name, definition, Type);\n        Protocol.resource.appendTo(Type, name);\n        Protocol.annotation.set(Type, definitionAnnotationKey, patternDefs);\n        Protocol.annotation.appendTo(Type, definitionAnnotationKey);\n        return Type;\n    },\n    getPatternDefinitions(Type) {\n        return Protocol.annotation.get(Type, AttributePattern.definitionAnnotationKey);\n    }\n});\n//# sourceMappingURL=attribute-pattern.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, DI } from '@aurelia/kernel';\nimport { AttrSyntax } from './ast';\nimport { AttributePattern, IAttributePattern, ISyntaxInterpreter } from './attribute-pattern';\nexport const IAttributeParser = DI.createInterface('IAttributeParser').withDefault(x => x.singleton(AttributeParser));\n/** @internal */\nlet AttributeParser = class AttributeParser {\n    constructor(interpreter, attrPatterns) {\n        this.interpreter = interpreter;\n        this.cache = {};\n        this.interpreter = interpreter;\n        const patterns = this.patterns = {};\n        attrPatterns.forEach(attrPattern => {\n            const defs = AttributePattern.getPatternDefinitions(attrPattern.constructor);\n            interpreter.add(defs);\n            defs.forEach(def => {\n                patterns[def.pattern] = attrPattern;\n            });\n        });\n    }\n    parse(name, value) {\n        let interpretation = this.cache[name];\n        if (interpretation == null) {\n            interpretation = this.cache[name] = this.interpreter.interpret(name);\n        }\n        const pattern = interpretation.pattern;\n        if (pattern == null) {\n            return new AttrSyntax(name, value, name, null);\n        }\n        else {\n            return this.patterns[pattern][pattern](name, value, interpretation.parts);\n        }\n    }\n};\nAttributeParser = __decorate([\n    __param(0, ISyntaxInterpreter),\n    __param(1, all(IAttributePattern)),\n    __metadata(\"design:paramtypes\", [Object, Array])\n], AttributeParser);\nexport { AttributeParser };\n//# sourceMappingURL=attribute-parser.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { AttrSyntax } from './ast';\nimport { attributePattern } from './attribute-pattern';\nlet DotSeparatedAttributePattern = class DotSeparatedAttributePattern {\n    ['PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[1]);\n    }\n    ['PART.PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[2]);\n    }\n};\nDotSeparatedAttributePattern = __decorate([\n    attributePattern({ pattern: 'PART.PART', symbols: '.' }, { pattern: 'PART.PART.PART', symbols: '.' })\n], DotSeparatedAttributePattern);\nexport { DotSeparatedAttributePattern };\nlet RefAttributePattern = class RefAttributePattern {\n    ['ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, 'element', 'ref');\n    }\n    ['PART.ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'ref');\n    }\n};\nRefAttributePattern = __decorate([\n    attributePattern({ pattern: 'ref', symbols: '' }, { pattern: 'PART.ref', symbols: '.' })\n], RefAttributePattern);\nexport { RefAttributePattern };\nlet ColonPrefixedBindAttributePattern = class ColonPrefixedBindAttributePattern {\n    [':PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'bind');\n    }\n};\nColonPrefixedBindAttributePattern = __decorate([\n    attributePattern({ pattern: ':PART', symbols: ':' })\n], ColonPrefixedBindAttributePattern);\nexport { ColonPrefixedBindAttributePattern };\nlet AtPrefixedTriggerAttributePattern = class AtPrefixedTriggerAttributePattern {\n    ['@PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'trigger');\n    }\n};\nAtPrefixedTriggerAttributePattern = __decorate([\n    attributePattern({ pattern: '@PART', symbols: '@' })\n], AtPrefixedTriggerAttributePattern);\nexport { AtPrefixedTriggerAttributePattern };\n//# sourceMappingURL=attribute-patterns.js.map","import { camelCase, Registration, mergeArrays, Protocol, firstDefined, Metadata } from '@aurelia/kernel';\nimport { registerAliases } from '@aurelia/runtime';\nexport function bindingCommand(nameOrDefinition) {\n    return function (target) {\n        return BindingCommand.define(nameOrDefinition, target);\n    };\n}\nexport class BindingCommandDefinition {\n    constructor(Type, name, aliases, key, type) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.type = type;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new BindingCommandDefinition(Type, firstDefined(BindingCommand.getAnnotation(Type, 'name'), name), mergeArrays(BindingCommand.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingCommand.keyFrom(name), firstDefined(BindingCommand.getAnnotation(Type, 'type'), def.type, Type.type, null));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, BindingCommand, key, container);\n    }\n}\nexport const BindingCommand = {\n    name: Protocol.resource.keyFor('binding-command'),\n    keyFrom(name) {\n        return `${BindingCommand.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingCommand.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingCommandDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingCommand.name, definition, definition.Type);\n        Metadata.define(BindingCommand.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingCommand.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingCommand.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\nexport function getTarget(binding, makeCamelCase) {\n    if (binding.flags & 256 /* isBinding */) {\n        return binding.bindable.propName;\n    }\n    else if (makeCamelCase) {\n        return camelCase(binding.syntax.target);\n    }\n    else {\n        return binding.syntax.target;\n    }\n}\n//# sourceMappingURL=binding-command.js.map","export var SymbolFlags;\n(function (SymbolFlags) {\n    SymbolFlags[SymbolFlags[\"type\"] = 511] = \"type\";\n    SymbolFlags[SymbolFlags[\"isTemplateController\"] = 1] = \"isTemplateController\";\n    SymbolFlags[SymbolFlags[\"isReplacePart\"] = 2] = \"isReplacePart\";\n    SymbolFlags[SymbolFlags[\"isCustomAttribute\"] = 4] = \"isCustomAttribute\";\n    SymbolFlags[SymbolFlags[\"isPlainAttribute\"] = 8] = \"isPlainAttribute\";\n    SymbolFlags[SymbolFlags[\"isCustomElement\"] = 16] = \"isCustomElement\";\n    SymbolFlags[SymbolFlags[\"isLetElement\"] = 32] = \"isLetElement\";\n    SymbolFlags[SymbolFlags[\"isPlainElement\"] = 64] = \"isPlainElement\";\n    SymbolFlags[SymbolFlags[\"isText\"] = 128] = \"isText\";\n    SymbolFlags[SymbolFlags[\"isBinding\"] = 256] = \"isBinding\";\n    SymbolFlags[SymbolFlags[\"hasMarker\"] = 512] = \"hasMarker\";\n    SymbolFlags[SymbolFlags[\"hasTemplate\"] = 1024] = \"hasTemplate\";\n    SymbolFlags[SymbolFlags[\"hasAttributes\"] = 2048] = \"hasAttributes\";\n    SymbolFlags[SymbolFlags[\"hasBindings\"] = 4096] = \"hasBindings\";\n    SymbolFlags[SymbolFlags[\"hasChildNodes\"] = 8192] = \"hasChildNodes\";\n    SymbolFlags[SymbolFlags[\"hasParts\"] = 16384] = \"hasParts\";\n})(SymbolFlags || (SymbolFlags = {}));\nfunction createMarker(dom) {\n    const marker = dom.createElement('au-m');\n    dom.makeTarget(marker);\n    return marker;\n}\n/**\n * A html attribute that is associated with a registered resource, specifically a template controller.\n */\nexport class TemplateControllerSymbol {\n    constructor(dom, syntax, info, partName, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 1 /* isTemplateController */ | 512 /* hasMarker */;\n        this.physicalNode = null;\n        this.template = null;\n        this.templateController = null;\n        this._bindings = null;\n        this._parts = null;\n        this.partName = info.name === 'replaceable' ? partName : null;\n        this.marker = createMarker(dom);\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\n/**\n * Wrapper for an element (with all of its attributes, regardless of the order in which they are declared)\n * that has a replace attribute on it.\n *\n * This element will be lifted from the DOM just like a template controller.\n */\nexport class ReplacePartSymbol {\n    constructor(name, physicalNode = null, parent = null, template = null) {\n        this.name = name;\n        this.physicalNode = physicalNode;\n        this.parent = parent;\n        this.template = template;\n        this.flags = 2 /* isReplacePart */;\n    }\n}\n/**\n * A html attribute that is associated with a registered resource, but not a template controller.\n */\nexport class CustomAttributeSymbol {\n    constructor(syntax, info, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 4 /* isCustomAttribute */;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * An attribute, with either a binding command or an interpolation, whose target is the html\n * attribute of the element.\n *\n * This will never target a bindable property of a custom attribute or element;\n */\nexport class PlainAttributeSymbol {\n    constructor(syntax, command, expression) {\n        this.syntax = syntax;\n        this.command = command;\n        this.expression = expression;\n        this.flags = 8 /* isPlainAttribute */;\n    }\n}\n/**\n * Either an attribute on an custom element that maps to a declared bindable property of that element,\n * a single-value bound custom attribute, or one of several bindables that were extracted from the attribute\n * value of a custom attribute with multiple bindings usage.\n *\n * This will always target a bindable property of a custom attribute or element;\n */\nexport class BindingSymbol {\n    constructor(command, bindable, expression, rawValue, target) {\n        this.command = command;\n        this.bindable = bindable;\n        this.expression = expression;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.flags = 256 /* isBinding */;\n    }\n}\n/**\n * A html element that is associated with a registered resource either via its (lowerCase) `nodeName`\n * or the value of its `as-element` attribute.\n */\nexport class CustomElementSymbol {\n    constructor(dom, physicalNode, info, res = info.name, bindables = info.bindables) {\n        this.physicalNode = physicalNode;\n        this.info = info;\n        this.res = res;\n        this.bindables = bindables;\n        this.flags = 16 /* isCustomElement */;\n        this.isTarget = true;\n        this.templateController = null;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._bindings = null;\n        this._childNodes = null;\n        this._parts = null;\n        if (info.containerless) {\n            this.isContainerless = true;\n            this.marker = createMarker(dom);\n            this.flags |= 512 /* hasMarker */;\n        }\n        else {\n            this.isContainerless = false;\n            this.marker = null;\n        }\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\nexport class LetElementSymbol {\n    constructor(dom, physicalNode, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.marker = marker;\n        this.flags = 32 /* isLetElement */ | 512 /* hasMarker */;\n        this.toBindingContext = false;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * A normal html element that may or may not have attribute behaviors and/or child node behaviors.\n *\n * It is possible for a PlainElementSymbol to not yield any instructions during compilation.\n */\nexport class PlainElementSymbol {\n    constructor(dom, physicalNode) {\n        this.physicalNode = physicalNode;\n        this.flags = 64 /* isPlainElement */;\n        this.isTarget = false;\n        this.templateController = null;\n        this.hasSlots = false;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._childNodes = null;\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n}\n/**\n * A standalone text node that has an interpolation.\n */\nexport class TextSymbol {\n    constructor(dom, physicalNode, interpolation, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.interpolation = interpolation;\n        this.marker = marker;\n        this.flags = 128 /* isText */ | 512 /* hasMarker */;\n    }\n}\n//# sourceMappingURL=semantic-model.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { BindingMode, CallBindingInstruction, FromViewBindingInstruction, IteratorBindingInstruction, OneTimeBindingInstruction, ToViewBindingInstruction, TwoWayBindingInstruction, } from '@aurelia/runtime';\nimport { bindingCommand, getTarget, } from './binding-command';\nimport { BindingSymbol, } from './semantic-model';\nlet OneTimeBindingCommand = class OneTimeBindingCommand {\n    constructor() {\n        this.bindingType = 49 /* OneTimeCommand */;\n    }\n    compile(binding) {\n        return new OneTimeBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nOneTimeBindingCommand = __decorate([\n    bindingCommand('one-time')\n], OneTimeBindingCommand);\nexport { OneTimeBindingCommand };\nlet ToViewBindingCommand = class ToViewBindingCommand {\n    constructor() {\n        this.bindingType = 50 /* ToViewCommand */;\n    }\n    compile(binding) {\n        return new ToViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nToViewBindingCommand = __decorate([\n    bindingCommand('to-view')\n], ToViewBindingCommand);\nexport { ToViewBindingCommand };\nlet FromViewBindingCommand = class FromViewBindingCommand {\n    constructor() {\n        this.bindingType = 51 /* FromViewCommand */;\n    }\n    compile(binding) {\n        return new FromViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nFromViewBindingCommand = __decorate([\n    bindingCommand('from-view')\n], FromViewBindingCommand);\nexport { FromViewBindingCommand };\nlet TwoWayBindingCommand = class TwoWayBindingCommand {\n    constructor() {\n        this.bindingType = 52 /* TwoWayCommand */;\n    }\n    compile(binding) {\n        return new TwoWayBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTwoWayBindingCommand = __decorate([\n    bindingCommand('two-way')\n], TwoWayBindingCommand);\nexport { TwoWayBindingCommand };\nlet DefaultBindingCommand = class DefaultBindingCommand {\n    constructor() {\n        this.bindingType = 53 /* BindCommand */;\n    }\n    compile(binding) {\n        let mode = BindingMode.default;\n        if (binding instanceof BindingSymbol) {\n            mode = binding.bindable.mode;\n        }\n        else {\n            const command = binding.syntax.command;\n            switch (command) {\n                case 'bind':\n                case 'to-view':\n                    mode = BindingMode.toView;\n                    break;\n                case 'one-time':\n                    mode = BindingMode.oneTime;\n                    break;\n                case 'from-view':\n                    mode = BindingMode.fromView;\n                    break;\n                case 'two-way':\n                    mode = BindingMode.twoWay;\n                    break;\n            }\n        }\n        switch (mode) {\n            case BindingMode.default:\n            case BindingMode.toView:\n                return ToViewBindingCommand.prototype.compile(binding);\n            case BindingMode.oneTime:\n                return OneTimeBindingCommand.prototype.compile(binding);\n            case BindingMode.fromView:\n                return FromViewBindingCommand.prototype.compile(binding);\n            case BindingMode.twoWay:\n                return TwoWayBindingCommand.prototype.compile(binding);\n        }\n    }\n};\nDefaultBindingCommand = __decorate([\n    bindingCommand('bind')\n], DefaultBindingCommand);\nexport { DefaultBindingCommand };\nlet CallBindingCommand = class CallBindingCommand {\n    constructor() {\n        this.bindingType = 153 /* CallCommand */;\n    }\n    compile(binding) {\n        return new CallBindingInstruction(binding.expression, getTarget(binding, true));\n    }\n};\nCallBindingCommand = __decorate([\n    bindingCommand('call')\n], CallBindingCommand);\nexport { CallBindingCommand };\nlet ForBindingCommand = class ForBindingCommand {\n    constructor() {\n        this.bindingType = 539 /* ForCommand */;\n    }\n    compile(binding) {\n        return new IteratorBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nForBindingCommand = __decorate([\n    bindingCommand('for')\n], ForBindingCommand);\nexport { ForBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","export function unescapeCode(code) {\n    switch (code) {\n        case 98 /* LowerB */: return 8 /* Backspace */;\n        case 116 /* LowerT */: return 9 /* Tab */;\n        case 110 /* LowerN */: return 10 /* LineFeed */;\n        case 118 /* LowerV */: return 11 /* VerticalTab */;\n        case 102 /* LowerF */: return 12 /* FormFeed */;\n        case 114 /* LowerR */: return 13 /* CarriageReturn */;\n        case 34 /* DoubleQuote */: return 34 /* DoubleQuote */;\n        case 39 /* SingleQuote */: return 39 /* SingleQuote */;\n        case 92 /* Backslash */: return 92 /* Backslash */;\n        default: return code;\n    }\n}\nexport var Access;\n(function (Access) {\n    Access[Access[\"Reset\"] = 0] = \"Reset\";\n    Access[Access[\"Ancestor\"] = 511] = \"Ancestor\";\n    Access[Access[\"This\"] = 512] = \"This\";\n    Access[Access[\"Scope\"] = 1024] = \"Scope\";\n    Access[Access[\"Member\"] = 2048] = \"Member\";\n    Access[Access[\"Keyed\"] = 4096] = \"Keyed\";\n})(Access || (Access = {}));\nexport var Precedence;\n(function (Precedence) {\n    Precedence[Precedence[\"Variadic\"] = 61] = \"Variadic\";\n    Precedence[Precedence[\"Assign\"] = 62] = \"Assign\";\n    Precedence[Precedence[\"Conditional\"] = 63] = \"Conditional\";\n    Precedence[Precedence[\"LogicalOR\"] = 64] = \"LogicalOR\";\n    Precedence[Precedence[\"LogicalAND\"] = 128] = \"LogicalAND\";\n    Precedence[Precedence[\"Equality\"] = 192] = \"Equality\";\n    Precedence[Precedence[\"Relational\"] = 256] = \"Relational\";\n    Precedence[Precedence[\"Additive\"] = 320] = \"Additive\";\n    Precedence[Precedence[\"Multiplicative\"] = 384] = \"Multiplicative\";\n    Precedence[Precedence[\"Binary\"] = 448] = \"Binary\";\n    Precedence[Precedence[\"LeftHandSide\"] = 449] = \"LeftHandSide\";\n    Precedence[Precedence[\"Primary\"] = 450] = \"Primary\";\n    Precedence[Precedence[\"Unary\"] = 451] = \"Unary\";\n})(Precedence || (Precedence = {}));\n/** @internal */\nexport var Token;\n(function (Token) {\n    Token[Token[\"EOF\"] = 1572864] = \"EOF\";\n    Token[Token[\"ExpressionTerminal\"] = 1048576] = \"ExpressionTerminal\";\n    Token[Token[\"AccessScopeTerminal\"] = 524288] = \"AccessScopeTerminal\";\n    Token[Token[\"ClosingToken\"] = 262144] = \"ClosingToken\";\n    Token[Token[\"OpeningToken\"] = 131072] = \"OpeningToken\";\n    Token[Token[\"BinaryOp\"] = 65536] = \"BinaryOp\";\n    Token[Token[\"UnaryOp\"] = 32768] = \"UnaryOp\";\n    Token[Token[\"LeftHandSide\"] = 16384] = \"LeftHandSide\";\n    Token[Token[\"StringOrNumericLiteral\"] = 12288] = \"StringOrNumericLiteral\";\n    Token[Token[\"NumericLiteral\"] = 8192] = \"NumericLiteral\";\n    Token[Token[\"StringLiteral\"] = 4096] = \"StringLiteral\";\n    Token[Token[\"IdentifierName\"] = 3072] = \"IdentifierName\";\n    Token[Token[\"Keyword\"] = 2048] = \"Keyword\";\n    Token[Token[\"Identifier\"] = 1024] = \"Identifier\";\n    Token[Token[\"Contextual\"] = 512] = \"Contextual\";\n    Token[Token[\"Precedence\"] = 448] = \"Precedence\";\n    Token[Token[\"Type\"] = 63] = \"Type\";\n    Token[Token[\"FalseKeyword\"] = 2048] = \"FalseKeyword\";\n    Token[Token[\"TrueKeyword\"] = 2049] = \"TrueKeyword\";\n    Token[Token[\"NullKeyword\"] = 2050] = \"NullKeyword\";\n    Token[Token[\"UndefinedKeyword\"] = 2051] = \"UndefinedKeyword\";\n    Token[Token[\"ThisScope\"] = 3076] = \"ThisScope\";\n    Token[Token[\"ParentScope\"] = 3077] = \"ParentScope\";\n    Token[Token[\"OpenParen\"] = 671750] = \"OpenParen\";\n    Token[Token[\"OpenBrace\"] = 131079] = \"OpenBrace\";\n    Token[Token[\"Dot\"] = 16392] = \"Dot\";\n    Token[Token[\"CloseBrace\"] = 1835017] = \"CloseBrace\";\n    Token[Token[\"CloseParen\"] = 1835018] = \"CloseParen\";\n    Token[Token[\"Comma\"] = 1572875] = \"Comma\";\n    Token[Token[\"OpenBracket\"] = 671756] = \"OpenBracket\";\n    Token[Token[\"CloseBracket\"] = 1835021] = \"CloseBracket\";\n    Token[Token[\"Colon\"] = 1572878] = \"Colon\";\n    Token[Token[\"Question\"] = 1572879] = \"Question\";\n    Token[Token[\"Ampersand\"] = 1572880] = \"Ampersand\";\n    Token[Token[\"Bar\"] = 1572883] = \"Bar\";\n    Token[Token[\"BarBar\"] = 1638548] = \"BarBar\";\n    Token[Token[\"AmpersandAmpersand\"] = 1638613] = \"AmpersandAmpersand\";\n    Token[Token[\"EqualsEquals\"] = 1638678] = \"EqualsEquals\";\n    Token[Token[\"ExclamationEquals\"] = 1638679] = \"ExclamationEquals\";\n    Token[Token[\"EqualsEqualsEquals\"] = 1638680] = \"EqualsEqualsEquals\";\n    Token[Token[\"ExclamationEqualsEquals\"] = 1638681] = \"ExclamationEqualsEquals\";\n    Token[Token[\"LessThan\"] = 1638746] = \"LessThan\";\n    Token[Token[\"GreaterThan\"] = 1638747] = \"GreaterThan\";\n    Token[Token[\"LessThanEquals\"] = 1638748] = \"LessThanEquals\";\n    Token[Token[\"GreaterThanEquals\"] = 1638749] = \"GreaterThanEquals\";\n    Token[Token[\"InKeyword\"] = 1640798] = \"InKeyword\";\n    Token[Token[\"InstanceOfKeyword\"] = 1640799] = \"InstanceOfKeyword\";\n    Token[Token[\"Plus\"] = 623008] = \"Plus\";\n    Token[Token[\"Minus\"] = 623009] = \"Minus\";\n    Token[Token[\"TypeofKeyword\"] = 34850] = \"TypeofKeyword\";\n    Token[Token[\"VoidKeyword\"] = 34851] = \"VoidKeyword\";\n    Token[Token[\"Asterisk\"] = 1638884] = \"Asterisk\";\n    Token[Token[\"Percent\"] = 1638885] = \"Percent\";\n    Token[Token[\"Slash\"] = 1638886] = \"Slash\";\n    Token[Token[\"Equals\"] = 1048615] = \"Equals\";\n    Token[Token[\"Exclamation\"] = 32808] = \"Exclamation\";\n    Token[Token[\"TemplateTail\"] = 540713] = \"TemplateTail\";\n    Token[Token[\"TemplateContinuation\"] = 540714] = \"TemplateContinuation\";\n    Token[Token[\"OfKeyword\"] = 1051179] = \"OfKeyword\";\n})(Token || (Token = {}));\nexport var Char;\n(function (Char) {\n    Char[Char[\"Null\"] = 0] = \"Null\";\n    Char[Char[\"Backspace\"] = 8] = \"Backspace\";\n    Char[Char[\"Tab\"] = 9] = \"Tab\";\n    Char[Char[\"LineFeed\"] = 10] = \"LineFeed\";\n    Char[Char[\"VerticalTab\"] = 11] = \"VerticalTab\";\n    Char[Char[\"FormFeed\"] = 12] = \"FormFeed\";\n    Char[Char[\"CarriageReturn\"] = 13] = \"CarriageReturn\";\n    Char[Char[\"Space\"] = 32] = \"Space\";\n    Char[Char[\"Exclamation\"] = 33] = \"Exclamation\";\n    Char[Char[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    Char[Char[\"Dollar\"] = 36] = \"Dollar\";\n    Char[Char[\"Percent\"] = 37] = \"Percent\";\n    Char[Char[\"Ampersand\"] = 38] = \"Ampersand\";\n    Char[Char[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    Char[Char[\"OpenParen\"] = 40] = \"OpenParen\";\n    Char[Char[\"CloseParen\"] = 41] = \"CloseParen\";\n    Char[Char[\"Asterisk\"] = 42] = \"Asterisk\";\n    Char[Char[\"Plus\"] = 43] = \"Plus\";\n    Char[Char[\"Comma\"] = 44] = \"Comma\";\n    Char[Char[\"Minus\"] = 45] = \"Minus\";\n    Char[Char[\"Dot\"] = 46] = \"Dot\";\n    Char[Char[\"Slash\"] = 47] = \"Slash\";\n    Char[Char[\"Semicolon\"] = 59] = \"Semicolon\";\n    Char[Char[\"Backtick\"] = 96] = \"Backtick\";\n    Char[Char[\"OpenBracket\"] = 91] = \"OpenBracket\";\n    Char[Char[\"Backslash\"] = 92] = \"Backslash\";\n    Char[Char[\"CloseBracket\"] = 93] = \"CloseBracket\";\n    Char[Char[\"Caret\"] = 94] = \"Caret\";\n    Char[Char[\"Underscore\"] = 95] = \"Underscore\";\n    Char[Char[\"OpenBrace\"] = 123] = \"OpenBrace\";\n    Char[Char[\"Bar\"] = 124] = \"Bar\";\n    Char[Char[\"CloseBrace\"] = 125] = \"CloseBrace\";\n    Char[Char[\"Colon\"] = 58] = \"Colon\";\n    Char[Char[\"LessThan\"] = 60] = \"LessThan\";\n    Char[Char[\"Equals\"] = 61] = \"Equals\";\n    Char[Char[\"GreaterThan\"] = 62] = \"GreaterThan\";\n    Char[Char[\"Question\"] = 63] = \"Question\";\n    Char[Char[\"Zero\"] = 48] = \"Zero\";\n    Char[Char[\"One\"] = 49] = \"One\";\n    Char[Char[\"Two\"] = 50] = \"Two\";\n    Char[Char[\"Three\"] = 51] = \"Three\";\n    Char[Char[\"Four\"] = 52] = \"Four\";\n    Char[Char[\"Five\"] = 53] = \"Five\";\n    Char[Char[\"Six\"] = 54] = \"Six\";\n    Char[Char[\"Seven\"] = 55] = \"Seven\";\n    Char[Char[\"Eight\"] = 56] = \"Eight\";\n    Char[Char[\"Nine\"] = 57] = \"Nine\";\n    Char[Char[\"UpperA\"] = 65] = \"UpperA\";\n    Char[Char[\"UpperB\"] = 66] = \"UpperB\";\n    Char[Char[\"UpperC\"] = 67] = \"UpperC\";\n    Char[Char[\"UpperD\"] = 68] = \"UpperD\";\n    Char[Char[\"UpperE\"] = 69] = \"UpperE\";\n    Char[Char[\"UpperF\"] = 70] = \"UpperF\";\n    Char[Char[\"UpperG\"] = 71] = \"UpperG\";\n    Char[Char[\"UpperH\"] = 72] = \"UpperH\";\n    Char[Char[\"UpperI\"] = 73] = \"UpperI\";\n    Char[Char[\"UpperJ\"] = 74] = \"UpperJ\";\n    Char[Char[\"UpperK\"] = 75] = \"UpperK\";\n    Char[Char[\"UpperL\"] = 76] = \"UpperL\";\n    Char[Char[\"UpperM\"] = 77] = \"UpperM\";\n    Char[Char[\"UpperN\"] = 78] = \"UpperN\";\n    Char[Char[\"UpperO\"] = 79] = \"UpperO\";\n    Char[Char[\"UpperP\"] = 80] = \"UpperP\";\n    Char[Char[\"UpperQ\"] = 81] = \"UpperQ\";\n    Char[Char[\"UpperR\"] = 82] = \"UpperR\";\n    Char[Char[\"UpperS\"] = 83] = \"UpperS\";\n    Char[Char[\"UpperT\"] = 84] = \"UpperT\";\n    Char[Char[\"UpperU\"] = 85] = \"UpperU\";\n    Char[Char[\"UpperV\"] = 86] = \"UpperV\";\n    Char[Char[\"UpperW\"] = 87] = \"UpperW\";\n    Char[Char[\"UpperX\"] = 88] = \"UpperX\";\n    Char[Char[\"UpperY\"] = 89] = \"UpperY\";\n    Char[Char[\"UpperZ\"] = 90] = \"UpperZ\";\n    Char[Char[\"LowerA\"] = 97] = \"LowerA\";\n    Char[Char[\"LowerB\"] = 98] = \"LowerB\";\n    Char[Char[\"LowerC\"] = 99] = \"LowerC\";\n    Char[Char[\"LowerD\"] = 100] = \"LowerD\";\n    Char[Char[\"LowerE\"] = 101] = \"LowerE\";\n    Char[Char[\"LowerF\"] = 102] = \"LowerF\";\n    Char[Char[\"LowerG\"] = 103] = \"LowerG\";\n    Char[Char[\"LowerH\"] = 104] = \"LowerH\";\n    Char[Char[\"LowerI\"] = 105] = \"LowerI\";\n    Char[Char[\"LowerJ\"] = 106] = \"LowerJ\";\n    Char[Char[\"LowerK\"] = 107] = \"LowerK\";\n    Char[Char[\"LowerL\"] = 108] = \"LowerL\";\n    Char[Char[\"LowerM\"] = 109] = \"LowerM\";\n    Char[Char[\"LowerN\"] = 110] = \"LowerN\";\n    Char[Char[\"LowerO\"] = 111] = \"LowerO\";\n    Char[Char[\"LowerP\"] = 112] = \"LowerP\";\n    Char[Char[\"LowerQ\"] = 113] = \"LowerQ\";\n    Char[Char[\"LowerR\"] = 114] = \"LowerR\";\n    Char[Char[\"LowerS\"] = 115] = \"LowerS\";\n    Char[Char[\"LowerT\"] = 116] = \"LowerT\";\n    Char[Char[\"LowerU\"] = 117] = \"LowerU\";\n    Char[Char[\"LowerV\"] = 118] = \"LowerV\";\n    Char[Char[\"LowerW\"] = 119] = \"LowerW\";\n    Char[Char[\"LowerX\"] = 120] = \"LowerX\";\n    Char[Char[\"LowerY\"] = 121] = \"LowerY\";\n    Char[Char[\"LowerZ\"] = 122] = \"LowerZ\";\n})(Char || (Char = {}));\n//# sourceMappingURL=common.js.map","import { Reporter } from '@aurelia/kernel';\nimport { AccessKeyedExpression, AccessMemberExpression, AccessScopeExpression, AccessThisExpression, ArrayBindingPattern, ArrayLiteralExpression, AssignExpression, BinaryExpression, BindingBehaviorExpression, BindingIdentifier, CallFunctionExpression, CallMemberExpression, CallScopeExpression, ConditionalExpression, CustomExpression, ForOfStatement, Interpolation, ObjectBindingPattern, ObjectLiteralExpression, PrimitiveLiteralExpression, TaggedTemplateExpression, TemplateExpression, UnaryExpression, ValueConverterExpression } from '@aurelia/runtime';\nimport { unescapeCode } from './common';\nconst $false = PrimitiveLiteralExpression.$false;\nconst $true = PrimitiveLiteralExpression.$true;\nconst $null = PrimitiveLiteralExpression.$null;\nconst $undefined = PrimitiveLiteralExpression.$undefined;\nconst $this = AccessThisExpression.$this;\nconst $parent = AccessThisExpression.$parent;\n/** @internal */\nexport class ParserState {\n    constructor(input) {\n        this.input = input;\n        this.index = 0;\n        this.startIndex = 0;\n        this.lastIndex = 0;\n        this.currentToken = 1572864 /* EOF */;\n        this.tokenValue = '';\n        this.assignable = true;\n        this.length = input.length;\n        this.currentChar = input.charCodeAt(0);\n    }\n    get tokenRaw() {\n        return this.input.slice(this.startIndex, this.index);\n    }\n}\nconst $state = new ParserState('');\nvar SyntaxError;\n(function (SyntaxError) {\n    SyntaxError[SyntaxError[\"InvalidExpressionStart\"] = 100] = \"InvalidExpressionStart\";\n    SyntaxError[SyntaxError[\"UnconsumedToken\"] = 101] = \"UnconsumedToken\";\n    SyntaxError[SyntaxError[\"DoubleDot\"] = 102] = \"DoubleDot\";\n    SyntaxError[SyntaxError[\"InvalidMemberExpression\"] = 103] = \"InvalidMemberExpression\";\n    SyntaxError[SyntaxError[\"UnexpectedEndOfExpression\"] = 104] = \"UnexpectedEndOfExpression\";\n    SyntaxError[SyntaxError[\"ExpectedIdentifier\"] = 105] = \"ExpectedIdentifier\";\n    SyntaxError[SyntaxError[\"InvalidForDeclaration\"] = 106] = \"InvalidForDeclaration\";\n    SyntaxError[SyntaxError[\"InvalidObjectLiteralPropertyDefinition\"] = 107] = \"InvalidObjectLiteralPropertyDefinition\";\n    SyntaxError[SyntaxError[\"UnterminatedQuote\"] = 108] = \"UnterminatedQuote\";\n    SyntaxError[SyntaxError[\"UnterminatedTemplate\"] = 109] = \"UnterminatedTemplate\";\n    SyntaxError[SyntaxError[\"MissingExpectedToken\"] = 110] = \"MissingExpectedToken\";\n    SyntaxError[SyntaxError[\"UnexpectedCharacter\"] = 111] = \"UnexpectedCharacter\";\n    SyntaxError[SyntaxError[\"MissingValueConverter\"] = 112] = \"MissingValueConverter\";\n    SyntaxError[SyntaxError[\"MissingBindingBehavior\"] = 113] = \"MissingBindingBehavior\";\n})(SyntaxError || (SyntaxError = {}));\nvar SemanticError;\n(function (SemanticError) {\n    SemanticError[SemanticError[\"NotAssignable\"] = 150] = \"NotAssignable\";\n    SemanticError[SemanticError[\"UnexpectedForOf\"] = 151] = \"UnexpectedForOf\";\n})(SemanticError || (SemanticError = {}));\nexport function parseExpression(input, bindingType) {\n    $state.input = input;\n    $state.length = input.length;\n    $state.index = 0;\n    $state.currentChar = input.charCodeAt(0);\n    return parse($state, 0 /* Reset */, 61 /* Variadic */, bindingType === void 0 ? 53 /* BindCommand */ : bindingType);\n}\n/** @internal */\n// JUSTIFICATION: This is performance-critical code which follows a subset of the well-known ES spec.\n// Knowing the spec, or parsers in general, will help with understanding this code and it is therefore not the\n// single source of information for being able to figure it out.\n// It generally does not need to change unless the spec changes or spec violations are found, or optimization\n// opportunities are found (which would likely not fix these warnings in any case).\n// It's therefore not considered to have any tangible impact on the maintainability of the code base.\n// For reference, most of the parsing logic is based on: https://tc39.github.io/ecma262/#sec-ecmascript-language-expressions\n// eslint-disable-next-line max-lines-per-function\nexport function parse(state, access, minPrecedence, bindingType) {\n    if (bindingType === 284 /* CustomCommand */) {\n        return new CustomExpression(state.input);\n    }\n    if (state.index === 0) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseInterpolation(state);\n        }\n        nextToken(state);\n        if (state.currentToken & 1048576 /* ExpressionTerminal */) {\n            throw Reporter.error(100 /* InvalidExpressionStart */, { state });\n        }\n    }\n    state.assignable = 448 /* Binary */ > minPrecedence;\n    let result = void 0;\n    if (state.currentToken & 32768 /* UnaryOp */) {\n        /** parseUnaryExpression\n         * https://tc39.github.io/ecma262/#sec-unary-operators\n         *\n         * UnaryExpression :\n         * 1. LeftHandSideExpression\n         * 2. void UnaryExpression\n         * 3. typeof UnaryExpression\n         * 4. + UnaryExpression\n         * 5. - UnaryExpression\n         * 6. ! UnaryExpression\n         *\n         * IsValidAssignmentTarget\n         * 2,3,4,5,6 = false\n         * 1 = see parseLeftHandSideExpression\n         *\n         * Note: technically we should throw on ++ / -- / +++ / ---, but there's nothing to gain from that\n         */\n        const op = TokenValues[state.currentToken & 63 /* Type */];\n        nextToken(state);\n        result = new UnaryExpression(op, parse(state, access, 449 /* LeftHandSide */, bindingType));\n        state.assignable = false;\n    }\n    else {\n        /** parsePrimaryExpression\n         * https://tc39.github.io/ecma262/#sec-primary-expression\n         *\n         * PrimaryExpression :\n         * 1. this\n         * 2. IdentifierName\n         * 3. Literal\n         * 4. ArrayLiteralExpression\n         * 5. ObjectLiteralExpression\n         * 6. TemplateLiteral\n         * 7. ParenthesizedExpression\n         *\n         * Literal :\n         * NullLiteral\n         * BooleanLiteral\n         * NumericLiteral\n         * StringLiteral\n         *\n         * ParenthesizedExpression :\n         * ( AssignmentExpression )\n         *\n         * IsValidAssignmentTarget\n         * 1,3,4,5,6,7 = false\n         * 2 = true\n         */\n        primary: switch (state.currentToken) {\n            case 3077 /* ParentScope */: // $parent\n                state.assignable = false;\n                do {\n                    nextToken(state);\n                    access++; // ancestor\n                    if (consumeOpt(state, 16392 /* Dot */)) {\n                        if (state.currentToken === 16392 /* Dot */) {\n                            throw Reporter.error(102 /* DoubleDot */, { state });\n                        }\n                        else if (state.currentToken === 1572864 /* EOF */) {\n                            throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                        }\n                    }\n                    else if (state.currentToken & 524288 /* AccessScopeTerminal */) {\n                        const ancestor = access & 511 /* Ancestor */;\n                        result = ancestor === 0 ? $this : ancestor === 1 ? $parent : new AccessThisExpression(ancestor);\n                        access = 512 /* This */;\n                        break primary;\n                    }\n                    else {\n                        throw Reporter.error(103 /* InvalidMemberExpression */, { state });\n                    }\n                } while (state.currentToken === 3077 /* ParentScope */);\n            // falls through\n            case 1024 /* Identifier */: // identifier\n                if (bindingType & 512 /* IsIterator */) {\n                    result = new BindingIdentifier(state.tokenValue);\n                }\n                else {\n                    result = new AccessScopeExpression(state.tokenValue, access & 511 /* Ancestor */);\n                    access = 1024 /* Scope */;\n                }\n                state.assignable = true;\n                nextToken(state);\n                break;\n            case 3076 /* ThisScope */: // $this\n                state.assignable = false;\n                nextToken(state);\n                result = $this;\n                access = 512 /* This */;\n                break;\n            case 671750 /* OpenParen */: // parenthesized expression\n                nextToken(state);\n                result = parse(state, 0 /* Reset */, 62 /* Assign */, bindingType);\n                consume(state, 1835018 /* CloseParen */);\n                access = 0 /* Reset */;\n                break;\n            case 671756 /* OpenBracket */:\n                result = parseArrayLiteralExpression(state, access, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 131079 /* OpenBrace */:\n                result = parseObjectLiteralExpression(state, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 540713 /* TemplateTail */:\n                result = new TemplateExpression([state.tokenValue]);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 540714 /* TemplateContinuation */:\n                result = parseTemplate(state, access, bindingType, result, false);\n                access = 0 /* Reset */;\n                break;\n            case 4096 /* StringLiteral */:\n            case 8192 /* NumericLiteral */:\n                result = new PrimitiveLiteralExpression(state.tokenValue);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 2050 /* NullKeyword */:\n            case 2051 /* UndefinedKeyword */:\n            case 2049 /* TrueKeyword */:\n            case 2048 /* FalseKeyword */:\n                result = TokenValues[state.currentToken & 63 /* Type */];\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            default:\n                if (state.index >= state.length) {\n                    throw Reporter.error(104 /* UnexpectedEndOfExpression */, { state });\n                }\n                else {\n                    throw Reporter.error(101 /* UnconsumedToken */, { state });\n                }\n        }\n        if (bindingType & 512 /* IsIterator */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseForOfStatement(state, result);\n        }\n        if (449 /* LeftHandSide */ < minPrecedence) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        /** parseMemberExpression (Token.Dot, Token.OpenBracket, Token.TemplateContinuation)\n         * MemberExpression :\n         * 1. PrimaryExpression\n         * 2. MemberExpression [ AssignmentExpression ]\n         * 3. MemberExpression . IdentifierName\n         * 4. MemberExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,4 = false\n         * 2,3 = true\n         *\n         *\n         * parseCallExpression (Token.OpenParen)\n         * CallExpression :\n         * 1. MemberExpression Arguments\n         * 2. CallExpression Arguments\n         * 3. CallExpression [ AssignmentExpression ]\n         * 4. CallExpression . IdentifierName\n         * 5. CallExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,2,5 = false\n         * 3,4 = true\n         */\n        let name = state.tokenValue;\n        while ((state.currentToken & 16384 /* LeftHandSide */) > 0) {\n            const args = [];\n            let strings;\n            switch (state.currentToken) {\n                case 16392 /* Dot */:\n                    state.assignable = true;\n                    nextToken(state);\n                    if ((state.currentToken & 3072 /* IdentifierName */) === 0) {\n                        throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                    }\n                    name = state.tokenValue;\n                    nextToken(state);\n                    // Change $This to $Scope, change $Scope to $Member, keep $Member as-is, change $Keyed to $Member, disregard other flags\n                    access = ((access & (512 /* This */ | 1024 /* Scope */)) << 1) | (access & 2048 /* Member */) | ((access & 4096 /* Keyed */) >> 1);\n                    if (state.currentToken === 671750 /* OpenParen */) {\n                        if (access === 0 /* Reset */) { // if the left hand side is a literal, make sure we parse a CallMemberExpression\n                            access = 2048 /* Member */;\n                        }\n                        continue;\n                    }\n                    if (access & 1024 /* Scope */) {\n                        result = new AccessScopeExpression(name, result.ancestor);\n                    }\n                    else { // if it's not $Scope, it's $Member\n                        result = new AccessMemberExpression(result, name);\n                    }\n                    continue;\n                case 671756 /* OpenBracket */:\n                    state.assignable = true;\n                    nextToken(state);\n                    access = 4096 /* Keyed */;\n                    result = new AccessKeyedExpression(result, parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                    consume(state, 1835021 /* CloseBracket */);\n                    break;\n                case 671750 /* OpenParen */:\n                    state.assignable = false;\n                    nextToken(state);\n                    while (state.currentToken !== 1835018 /* CloseParen */) {\n                        args.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                        if (!consumeOpt(state, 1572875 /* Comma */)) {\n                            break;\n                        }\n                    }\n                    consume(state, 1835018 /* CloseParen */);\n                    if (access & 1024 /* Scope */) {\n                        result = new CallScopeExpression(name, args, result.ancestor);\n                    }\n                    else if (access & 2048 /* Member */) {\n                        result = new CallMemberExpression(result, name, args);\n                    }\n                    else {\n                        result = new CallFunctionExpression(result, args);\n                    }\n                    access = 0;\n                    break;\n                case 540713 /* TemplateTail */:\n                    state.assignable = false;\n                    strings = [state.tokenValue];\n                    result = new TaggedTemplateExpression(strings, strings, result);\n                    nextToken(state);\n                    break;\n                case 540714 /* TemplateContinuation */:\n                    result = parseTemplate(state, access, bindingType, result, true);\n                default:\n            }\n        }\n    }\n    if (448 /* Binary */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseBinaryExpression\n     * https://tc39.github.io/ecma262/#sec-multiplicative-operators\n     *\n     * MultiplicativeExpression : (local precedence 6)\n     * UnaryExpression\n     * MultiplicativeExpression * / % UnaryExpression\n     *\n     * AdditiveExpression : (local precedence 5)\n     * MultiplicativeExpression\n     * AdditiveExpression + - MultiplicativeExpression\n     *\n     * RelationalExpression : (local precedence 4)\n     * AdditiveExpression\n     * RelationalExpression < > <= >= instanceof in AdditiveExpression\n     *\n     * EqualityExpression : (local precedence 3)\n     * RelationalExpression\n     * EqualityExpression == != === !== RelationalExpression\n     *\n     * LogicalANDExpression : (local precedence 2)\n     * EqualityExpression\n     * LogicalANDExpression && EqualityExpression\n     *\n     * LogicalORExpression : (local precedence 1)\n     * LogicalANDExpression\n     * LogicalORExpression || LogicalANDExpression\n     */\n    while ((state.currentToken & 65536 /* BinaryOp */) > 0) {\n        const opToken = state.currentToken;\n        if ((opToken & 448 /* Precedence */) <= minPrecedence) {\n            break;\n        }\n        nextToken(state);\n        result = new BinaryExpression(TokenValues[opToken & 63 /* Type */], result, parse(state, access, opToken & 448 /* Precedence */, bindingType));\n        state.assignable = false;\n    }\n    if (63 /* Conditional */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /**\n     * parseConditionalExpression\n     * https://tc39.github.io/ecma262/#prod-ConditionalExpression\n     *\n     * ConditionalExpression :\n     * 1. BinaryExpression\n     * 2. BinaryExpression ? AssignmentExpression : AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1572879 /* Question */)) {\n        const yes = parse(state, access, 62 /* Assign */, bindingType);\n        consume(state, 1572878 /* Colon */);\n        result = new ConditionalExpression(result, yes, parse(state, access, 62 /* Assign */, bindingType));\n        state.assignable = false;\n    }\n    if (62 /* Assign */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseAssignmentExpression\n     * https://tc39.github.io/ecma262/#prod-AssignmentExpression\n     * Note: AssignmentExpression here is equivalent to ES Expression because we don't parse the comma operator\n     *\n     * AssignmentExpression :\n     * 1. ConditionalExpression\n     * 2. LeftHandSideExpression = AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1048615 /* Equals */)) {\n        if (!state.assignable) {\n            throw Reporter.error(150 /* NotAssignable */, { state });\n        }\n        result = new AssignExpression(result, parse(state, access, 62 /* Assign */, bindingType));\n    }\n    if (61 /* Variadic */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseValueConverter\n     */\n    while (consumeOpt(state, 1572883 /* Bar */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(112);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new ValueConverterExpression(result, name, args);\n    }\n    /** parseBindingBehavior\n     */\n    while (consumeOpt(state, 1572880 /* Ampersand */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(113);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new BindingBehaviorExpression(result, name, args);\n    }\n    if (state.currentToken !== 1572864 /* EOF */) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        if (state.tokenRaw === 'of') {\n            throw Reporter.error(151 /* UnexpectedForOf */, { state });\n        }\n        throw Reporter.error(101 /* UnconsumedToken */, { state });\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return result;\n}\n/**\n * parseArrayLiteralExpression\n * https://tc39.github.io/ecma262/#prod-ArrayLiteralExpression\n *\n * ArrayLiteralExpression :\n * [ Elision(opt) ]\n * [ ElementList ]\n * [ ElementList, Elision(opt) ]\n *\n * ElementList :\n * Elision(opt) AssignmentExpression\n * ElementList, Elision(opt) AssignmentExpression\n *\n * Elision :\n * ,\n * Elision ,\n */\nfunction parseArrayLiteralExpression(state, access, bindingType) {\n    nextToken(state);\n    const elements = new Array();\n    while (state.currentToken !== 1835021 /* CloseBracket */) {\n        if (consumeOpt(state, 1572875 /* Comma */)) {\n            elements.push($undefined);\n            if (state.currentToken === 1835021 /* CloseBracket */) {\n                break;\n            }\n        }\n        else {\n            elements.push(parse(state, access, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            if (consumeOpt(state, 1572875 /* Comma */)) {\n                if (state.currentToken === 1835021 /* CloseBracket */) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n    }\n    consume(state, 1835021 /* CloseBracket */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ArrayBindingPattern(elements);\n    }\n    else {\n        state.assignable = false;\n        return new ArrayLiteralExpression(elements);\n    }\n}\nfunction parseForOfStatement(state, result) {\n    if ((result.$kind & 65536 /* IsForDeclaration */) === 0) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    if (state.currentToken !== 1051179 /* OfKeyword */) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    nextToken(state);\n    const declaration = result;\n    const statement = parse(state, 0 /* Reset */, 61 /* Variadic */, 0 /* None */);\n    return new ForOfStatement(declaration, statement);\n}\n/**\n * parseObjectLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * ObjectLiteralExpression :\n * { }\n * { PropertyDefinitionList }\n *\n * PropertyDefinitionList :\n * PropertyDefinition\n * PropertyDefinitionList, PropertyDefinition\n *\n * PropertyDefinition :\n * IdentifierName\n * PropertyName : AssignmentExpression\n *\n * PropertyName :\n * IdentifierName\n * StringLiteral\n * NumericLiteral\n */\nfunction parseObjectLiteralExpression(state, bindingType) {\n    const keys = new Array();\n    const values = new Array();\n    nextToken(state);\n    while (state.currentToken !== 1835017 /* CloseBrace */) {\n        keys.push(state.tokenValue);\n        // Literal = mandatory colon\n        if (state.currentToken & 12288 /* StringOrNumericLiteral */) {\n            nextToken(state);\n            consume(state, 1572878 /* Colon */);\n            values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n        }\n        else if (state.currentToken & 3072 /* IdentifierName */) {\n            // IdentifierName = optional colon\n            const { currentChar, currentToken, index } = state;\n            nextToken(state);\n            if (consumeOpt(state, 1572878 /* Colon */)) {\n                values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            }\n            else {\n                // Shorthand\n                state.currentChar = currentChar;\n                state.currentToken = currentToken;\n                state.index = index;\n                values.push(parse(state, 0 /* Reset */, 450 /* Primary */, bindingType & ~512 /* IsIterator */));\n            }\n        }\n        else {\n            throw Reporter.error(107 /* InvalidObjectLiteralPropertyDefinition */, { state });\n        }\n        if (state.currentToken !== 1835017 /* CloseBrace */) {\n            consume(state, 1572875 /* Comma */);\n        }\n    }\n    consume(state, 1835017 /* CloseBrace */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ObjectBindingPattern(keys, values);\n    }\n    else {\n        state.assignable = false;\n        return new ObjectLiteralExpression(keys, values);\n    }\n}\nfunction parseInterpolation(state) {\n    const parts = [];\n    const expressions = [];\n    const length = state.length;\n    let result = '';\n    while (state.index < length) {\n        switch (state.currentChar) {\n            case 36 /* Dollar */:\n                if (state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                    parts.push(result);\n                    result = '';\n                    state.index += 2;\n                    state.currentChar = state.input.charCodeAt(state.index);\n                    nextToken(state);\n                    const expression = parse(state, 0 /* Reset */, 61 /* Variadic */, 2048 /* Interpolation */);\n                    expressions.push(expression);\n                    continue;\n                }\n                else {\n                    result += '$';\n                }\n                break;\n            case 92 /* Backslash */:\n                result += String.fromCharCode(unescapeCode(nextChar(state)));\n                break;\n            default:\n                result += String.fromCharCode(state.currentChar);\n        }\n        nextChar(state);\n    }\n    if (expressions.length) {\n        parts.push(result);\n        return new Interpolation(parts, expressions);\n    }\n    return null;\n}\n/**\n * parseTemplateLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * TemplateExpression :\n * NoSubstitutionTemplate\n * TemplateHead\n *\n * NoSubstitutionTemplate :\n * ` TemplateCharacters(opt) `\n *\n * TemplateHead :\n * ` TemplateCharacters(opt) ${\n *\n * TemplateSubstitutionTail :\n * TemplateMiddle\n * TemplateTail\n *\n * TemplateMiddle :\n * } TemplateCharacters(opt) ${\n *\n * TemplateTail :\n * } TemplateCharacters(opt) `\n *\n * TemplateCharacters :\n * TemplateCharacter TemplateCharacters(opt)\n *\n * TemplateCharacter :\n * $ [lookahead ≠ {]\n * \\ EscapeSequence\n * SourceCharacter (but not one of ` or \\ or $)\n */\nfunction parseTemplate(state, access, bindingType, result, tagged) {\n    const cooked = [state.tokenValue];\n    // TODO: properly implement raw parts / decide whether we want this\n    consume(state, 540714 /* TemplateContinuation */);\n    const expressions = [parse(state, access, 62 /* Assign */, bindingType)];\n    while ((state.currentToken = scanTemplateTail(state)) !== 540713 /* TemplateTail */) {\n        cooked.push(state.tokenValue);\n        consume(state, 540714 /* TemplateContinuation */);\n        expressions.push(parse(state, access, 62 /* Assign */, bindingType));\n    }\n    cooked.push(state.tokenValue);\n    state.assignable = false;\n    if (tagged) {\n        nextToken(state);\n        return new TaggedTemplateExpression(cooked, cooked, result, expressions);\n    }\n    else {\n        nextToken(state);\n        return new TemplateExpression(cooked, expressions);\n    }\n}\nfunction nextToken(state) {\n    while (state.index < state.length) {\n        state.startIndex = state.index;\n        if ((state.currentToken = (CharScanners[state.currentChar](state))) != null) { // a null token means the character must be skipped\n            return;\n        }\n    }\n    state.currentToken = 1572864 /* EOF */;\n}\nfunction nextChar(state) {\n    return state.currentChar = state.input.charCodeAt(++state.index);\n}\nfunction scanIdentifier(state) {\n    // run to the next non-idPart\n    while (IdParts[nextChar(state)])\n        ;\n    const token = KeywordLookup[state.tokenValue = state.tokenRaw];\n    return token === undefined ? 1024 /* Identifier */ : token;\n}\nfunction scanNumber(state, isFloat) {\n    let char = state.currentChar;\n    if (isFloat === false) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n        if (char !== 46 /* Dot */) {\n            state.tokenValue = parseInt(state.tokenRaw, 10);\n            return 8192 /* NumericLiteral */;\n        }\n        // past this point it's always a float\n        char = nextChar(state);\n        if (state.index >= state.length) {\n            // unless the number ends with a dot - that behaves a little different in native ES expressions\n            // but in our AST that behavior has no effect because numbers are always stored in variables\n            state.tokenValue = parseInt(state.tokenRaw.slice(0, -1), 10);\n            return 8192 /* NumericLiteral */;\n        }\n    }\n    if (char <= 57 /* Nine */ && char >= 48 /* Zero */) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n    }\n    else {\n        state.currentChar = state.input.charCodeAt(--state.index);\n    }\n    state.tokenValue = parseFloat(state.tokenRaw);\n    return 8192 /* NumericLiteral */;\n}\nfunction scanString(state) {\n    const quote = state.currentChar;\n    nextChar(state); // Skip initial quote.\n    let unescaped = 0;\n    const buffer = new Array();\n    let marker = state.index;\n    while (state.currentChar !== quote) {\n        if (state.currentChar === 92 /* Backslash */) {\n            buffer.push(state.input.slice(marker, state.index));\n            nextChar(state);\n            unescaped = unescapeCode(state.currentChar);\n            nextChar(state);\n            buffer.push(String.fromCharCode(unescaped));\n            marker = state.index;\n        }\n        else if (state.index >= state.length) {\n            throw Reporter.error(108 /* UnterminatedQuote */, { state });\n        }\n        else {\n            nextChar(state);\n        }\n    }\n    const last = state.input.slice(marker, state.index);\n    nextChar(state); // Skip terminating quote.\n    // Compute the unescaped string value.\n    buffer.push(last);\n    const unescapedStr = buffer.join('');\n    state.tokenValue = unescapedStr;\n    return 4096 /* StringLiteral */;\n}\nfunction scanTemplate(state) {\n    let tail = true;\n    let result = '';\n    while (nextChar(state) !== 96 /* Backtick */) {\n        if (state.currentChar === 36 /* Dollar */) {\n            if ((state.index + 1) < state.length && state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                state.index++;\n                tail = false;\n                break;\n            }\n            else {\n                result += '$';\n            }\n        }\n        else if (state.currentChar === 92 /* Backslash */) {\n            result += String.fromCharCode(unescapeCode(nextChar(state)));\n        }\n        else {\n            if (state.index >= state.length) {\n                throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n            }\n            result += String.fromCharCode(state.currentChar);\n        }\n    }\n    nextChar(state);\n    state.tokenValue = result;\n    if (tail) {\n        return 540713 /* TemplateTail */;\n    }\n    return 540714 /* TemplateContinuation */;\n}\nfunction scanTemplateTail(state) {\n    if (state.index >= state.length) {\n        throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n    }\n    state.index--;\n    return scanTemplate(state);\n}\nfunction consumeOpt(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n        return true;\n    }\n    return false;\n}\nfunction consume(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n    }\n    else {\n        throw Reporter.error(110 /* MissingExpectedToken */, { state, expected: token });\n    }\n}\n/**\n * Array for mapping tokens to token values. The indices of the values\n * correspond to the token bits 0-38.\n * For this to work properly, the values in the array must be kept in\n * the same order as the token bits.\n * Usage: TokenValues[token & Token.Type]\n */\nconst TokenValues = [\n    $false, $true, $null, $undefined, '$this', '$parent',\n    '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"',\n    '&', '|', '||', '&&', '==', '!=', '===', '!==', '<', '>',\n    '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!',\n    540713 /* TemplateTail */, 540714 /* TemplateContinuation */,\n    'of'\n];\nconst KeywordLookup = Object.create(null);\nKeywordLookup.true = 2049 /* TrueKeyword */;\nKeywordLookup.null = 2050 /* NullKeyword */;\nKeywordLookup.false = 2048 /* FalseKeyword */;\nKeywordLookup.undefined = 2051 /* UndefinedKeyword */;\nKeywordLookup.$this = 3076 /* ThisScope */;\nKeywordLookup.$parent = 3077 /* ParentScope */;\nKeywordLookup.in = 1640798 /* InKeyword */;\nKeywordLookup.instanceof = 1640799 /* InstanceOfKeyword */;\nKeywordLookup.typeof = 34850 /* TypeofKeyword */;\nKeywordLookup.void = 34851 /* VoidKeyword */;\nKeywordLookup.of = 1051179 /* OfKeyword */;\n/**\n * Ranges of code points in pairs of 2 (eg 0x41-0x5B, 0x61-0x7B, ...) where the second value is not inclusive (5-7 means 5 and 6)\n * Single values are denoted by the second value being a 0\n *\n * Copied from output generated with \"node build/generate-unicode.js\"\n *\n * See also: https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF\n */\nconst codes = {\n    /* [$0-9A-Za_a-z] */\n    AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n    IdStart: /* IdentifierStart */ [0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n    Digit: /* DecimalNumber */ [0x30, 0x3A],\n    Skip: /* Skippable */ [0, 0x21, 0x7F, 0xA1]\n};\n/**\n * Decompress the ranges into an array of numbers so that the char code\n * can be used as an index to the lookup\n */\nfunction decompress(lookup, $set, compressed, value) {\n    const rangeCount = compressed.length;\n    for (let i = 0; i < rangeCount; i += 2) {\n        const start = compressed[i];\n        let end = compressed[i + 1];\n        end = end > 0 ? end : start + 1;\n        if (lookup) {\n            lookup.fill(value, start, end);\n        }\n        if ($set) {\n            for (let ch = start; ch < end; ch++) {\n                $set.add(ch);\n            }\n        }\n    }\n}\n// CharFuncLookup functions\nfunction returnToken(token) {\n    return s => {\n        nextChar(s);\n        return token;\n    };\n}\nconst unexpectedCharacter = s => {\n    throw Reporter.error(111 /* UnexpectedCharacter */, { state: s });\n};\nunexpectedCharacter.notMapped = true;\n// ASCII IdentifierPart lookup\nconst AsciiIdParts = new Set();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n// IdentifierPart lookup\nconst IdParts = new Uint8Array(0xFFFF);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.IdStart, 1);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.Digit, 1);\n// Character scanning function lookup\nconst CharScanners = new Array(0xFFFF);\nCharScanners.fill(unexpectedCharacter, 0, 0xFFFF);\ndecompress(CharScanners, null, codes.Skip, s => {\n    nextChar(s);\n    return null;\n});\ndecompress(CharScanners, null, codes.IdStart, scanIdentifier);\ndecompress(CharScanners, null, codes.Digit, s => scanNumber(s, false));\nCharScanners[34 /* DoubleQuote */] =\n    CharScanners[39 /* SingleQuote */] = s => {\n        return scanString(s);\n    };\nCharScanners[96 /* Backtick */] = s => {\n    return scanTemplate(s);\n};\n// !, !=, !==\nCharScanners[33 /* Exclamation */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 32808 /* Exclamation */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638679 /* ExclamationEquals */;\n    }\n    nextChar(s);\n    return 1638681 /* ExclamationEqualsEquals */;\n};\n// =, ==, ===\nCharScanners[61 /* Equals */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1048615 /* Equals */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638678 /* EqualsEquals */;\n    }\n    nextChar(s);\n    return 1638680 /* EqualsEqualsEquals */;\n};\n// &, &&\nCharScanners[38 /* Ampersand */] = s => {\n    if (nextChar(s) !== 38 /* Ampersand */) {\n        return 1572880 /* Ampersand */;\n    }\n    nextChar(s);\n    return 1638613 /* AmpersandAmpersand */;\n};\n// |, ||\nCharScanners[124 /* Bar */] = s => {\n    if (nextChar(s) !== 124 /* Bar */) {\n        return 1572883 /* Bar */;\n    }\n    nextChar(s);\n    return 1638548 /* BarBar */;\n};\n// .\nCharScanners[46 /* Dot */] = s => {\n    if (nextChar(s) <= 57 /* Nine */ && s.currentChar >= 48 /* Zero */) {\n        return scanNumber(s, true);\n    }\n    return 16392 /* Dot */;\n};\n// <, <=\nCharScanners[60 /* LessThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638746 /* LessThan */;\n    }\n    nextChar(s);\n    return 1638748 /* LessThanEquals */;\n};\n// >, >=\nCharScanners[62 /* GreaterThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638747 /* GreaterThan */;\n    }\n    nextChar(s);\n    return 1638749 /* GreaterThanEquals */;\n};\nCharScanners[37 /* Percent */] = returnToken(1638885 /* Percent */);\nCharScanners[40 /* OpenParen */] = returnToken(671750 /* OpenParen */);\nCharScanners[41 /* CloseParen */] = returnToken(1835018 /* CloseParen */);\nCharScanners[42 /* Asterisk */] = returnToken(1638884 /* Asterisk */);\nCharScanners[43 /* Plus */] = returnToken(623008 /* Plus */);\nCharScanners[44 /* Comma */] = returnToken(1572875 /* Comma */);\nCharScanners[45 /* Minus */] = returnToken(623009 /* Minus */);\nCharScanners[47 /* Slash */] = returnToken(1638886 /* Slash */);\nCharScanners[58 /* Colon */] = returnToken(1572878 /* Colon */);\nCharScanners[63 /* Question */] = returnToken(1572879 /* Question */);\nCharScanners[91 /* OpenBracket */] = returnToken(671756 /* OpenBracket */);\nCharScanners[93 /* CloseBracket */] = returnToken(1835021 /* CloseBracket */);\nCharScanners[123 /* OpenBrace */] = returnToken(131079 /* OpenBrace */);\nCharScanners[125 /* CloseBrace */] = returnToken(1835017 /* CloseBrace */);\n//# sourceMappingURL=expression-parser.js.map","import { DI } from '@aurelia/kernel';\nimport { IExpressionParser, RuntimeConfiguration } from '@aurelia/runtime';\nimport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern } from './attribute-patterns';\nimport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nimport { parseExpression } from './expression-parser';\nexport const IExpressionParserRegistration = {\n    register(container) {\n        container.registerTransformer(IExpressionParser, parser => {\n            Reflect.set(parser, 'parseCore', parseExpression);\n            return parser;\n        });\n    }\n};\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IExpressionParser`\n */\nexport const DefaultComponents = [\n    IExpressionParserRegistration\n];\nexport const AtPrefixedTriggerAttributePatternRegistration = AtPrefixedTriggerAttributePattern;\nexport const ColonPrefixedBindAttributePatternRegistration = ColonPrefixedBindAttributePattern;\nexport const RefAttributePatternRegistration = RefAttributePattern;\nexport const DotSeparatedAttributePatternRegistration = DotSeparatedAttributePattern;\n/**\n * Default binding syntax for the following attribute name patterns:\n * - `ref`\n * - `target.command` (dot-separated)\n */\nexport const DefaultBindingSyntax = [\n    RefAttributePatternRegistration,\n    DotSeparatedAttributePatternRegistration\n];\n/**\n * Binding syntax for short-hand attribute name patterns:\n * - `@target` (short-hand for `target.trigger`)\n * - `:target` (short-hand for `target.bind`)\n */\nexport const ShortHandBindingSyntax = [\n    AtPrefixedTriggerAttributePatternRegistration,\n    ColonPrefixedBindAttributePatternRegistration\n];\nexport const CallBindingCommandRegistration = CallBindingCommand;\nexport const DefaultBindingCommandRegistration = DefaultBindingCommand;\nexport const ForBindingCommandRegistration = ForBindingCommand;\nexport const FromViewBindingCommandRegistration = FromViewBindingCommand;\nexport const OneTimeBindingCommandRegistration = OneTimeBindingCommand;\nexport const ToViewBindingCommandRegistration = ToViewBindingCommand;\nexport const TwoWayBindingCommandRegistration = TwoWayBindingCommand;\n/**\n * Default runtime/environment-agnostic binding commands:\n * - Property observation: `.bind`, `.one-time`, `.from-view`, `.to-view`, `.two-way`\n * - Function call: `.call`\n * - Collection observation: `.for`\n */\nexport const DefaultBindingLanguage = [\n    DefaultBindingCommandRegistration,\n    OneTimeBindingCommandRegistration,\n    FromViewBindingCommandRegistration,\n    ToViewBindingCommandRegistration,\n    TwoWayBindingCommandRegistration,\n    CallBindingCommandRegistration,\n    ForBindingCommandRegistration\n];\n/**\n * A DI configuration object containing runtime/environment-agnostic registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultBindingSyntax`\n * - `DefaultBindingLanguage`\n */\nexport const JitConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultBindingSyntax, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { kebabCase, Metadata, } from '@aurelia/kernel';\nimport { BindingMode, CustomAttribute, CustomElement, } from '@aurelia/runtime';\nimport { BindingCommand } from './binding-command';\n/**\n * A pre-processed piece of information about a defined bindable property on a custom\n * element or attribute, optimized for consumption by the template compiler.\n */\nexport class BindableInfo {\n    constructor(\n    /**\n     * The pre-processed *property* (not attribute) name of the bindable, which is\n     * (in order of priority):\n     *\n     * 1. The `property` from the description (if defined)\n     * 2. The name of the property of the bindable itself\n     */\n    propName, \n    /**\n     * The pre-processed (default) bindingMode of the bindable, which is (in order of priority):\n     *\n     * 1. The `mode` from the bindable (if defined and not bindingMode.default)\n     * 2. The `defaultBindingMode` (if it's an attribute, defined, and not bindingMode.default)\n     * 3. `bindingMode.toView`\n     */\n    mode) {\n        this.propName = propName;\n        this.mode = mode;\n    }\n}\n/**\n * Pre-processed information about a custom element resource, optimized\n * for consumption by the template compiler.\n */\nexport class ElementInfo {\n    constructor(name, containerless) {\n        this.name = name;\n        this.containerless = containerless;\n        /**\n         * A lookup of the bindables of this element, indexed by the (pre-processed)\n         * attribute names as they would be found in parsed markup.\n         */\n        this.bindables = Object.create(null);\n    }\n    static from(def) {\n        const info = new ElementInfo(def.name, def.containerless);\n        const bindables = def.bindables;\n        const defaultBindingMode = BindingMode.toView;\n        let bindable;\n        let prop;\n        let attr;\n        let mode;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            // explicitly provided attribute name has priority over the derived implicit attribute name\n            if (bindable.attribute !== void 0) {\n                attr = bindable.attribute;\n            }\n            else {\n                // derive the attribute name from the resolved property name\n                attr = kebabCase(prop);\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            info.bindables[attr] = new BindableInfo(prop, mode);\n        }\n        return info;\n    }\n}\n/**\n * Pre-processed information about a custom attribute resource, optimized\n * for consumption by the template compiler.\n */\nexport class AttrInfo {\n    constructor(name, isTemplateController, noMultiBindings) {\n        this.name = name;\n        this.isTemplateController = isTemplateController;\n        this.noMultiBindings = noMultiBindings;\n        /**\n         * A lookup of the bindables of this attribute, indexed by the (pre-processed)\n         * bindable names as they would be found in the attribute value.\n         *\n         * Only applicable to multi attribute bindings (semicolon-separated).\n         */\n        this.bindables = Object.create(null);\n        /**\n         * The single or first bindable of this attribute, or a default 'value'\n         * bindable if no bindables were defined on the attribute.\n         *\n         * Only applicable to single attribute bindings (where the attribute value\n         * contains no semicolons)\n         */\n        this.bindable = null;\n    }\n    static from(def) {\n        const info = new AttrInfo(def.name, def.isTemplateController, def.noMultiBindings);\n        const bindables = def.bindables;\n        const defaultBindingMode = def.defaultBindingMode !== void 0 && def.defaultBindingMode !== BindingMode.default\n            ? def.defaultBindingMode\n            : BindingMode.toView;\n        let bindable;\n        let prop;\n        let mode;\n        let hasPrimary = false;\n        let isPrimary = false;\n        let bindableInfo;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            isPrimary = bindable.primary === true;\n            bindableInfo = info.bindables[prop] = new BindableInfo(prop, mode);\n            if (isPrimary) {\n                if (hasPrimary) {\n                    throw new Error('primary already exists');\n                }\n                hasPrimary = true;\n                info.bindable = bindableInfo;\n            }\n            // set to first bindable by convention\n            if (info.bindable === null) {\n                info.bindable = bindableInfo;\n            }\n        }\n        // if no bindables are present, default to \"value\"\n        if (info.bindable === null) {\n            info.bindable = new BindableInfo('value', defaultBindingMode);\n        }\n        return info;\n    }\n}\nconst contextLookup = new WeakMap();\n/**\n * A pre-processed piece of information about declared custom elements, attributes and\n * binding commands, optimized for consumption by the template compiler.\n */\nexport class ResourceModel {\n    constructor(container) {\n        this.elementLookup = Object.create(null);\n        this.attributeLookup = Object.create(null);\n        this.commandLookup = Object.create(null);\n        // Note: don't do this sort of thing elsewhere, this is purely for perf reasons\n        this.container = container;\n        const rootContainer = container.root;\n        this.resourceResolvers = container.resourceResolvers;\n        this.rootResourceResolvers = rootContainer.resourceResolvers;\n    }\n    static getOrCreate(context) {\n        let model = contextLookup.get(context);\n        if (model === void 0) {\n            contextLookup.set(context, model = new ResourceModel(context));\n        }\n        return model;\n    }\n    /**\n     * Retrieve information about a custom element resource.\n     *\n     * @param element - The original DOM element.\n     *\n     * @returns The resource information if the element exists, or `null` if it does not exist.\n     */\n    getElementInfo(name) {\n        let result = this.elementLookup[name];\n        if (result === void 0) {\n            const def = this.find(CustomElement, name);\n            this.elementLookup[name] = result = def === null ? null : ElementInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve information about a custom attribute resource.\n     *\n     * @param syntax - The parsed `AttrSyntax`\n     *\n     * @returns The resource information if the attribute exists, or `null` if it does not exist.\n     */\n    getAttributeInfo(syntax) {\n        let result = this.attributeLookup[syntax.target];\n        if (result === void 0) {\n            const def = this.find(CustomAttribute, syntax.target);\n            this.attributeLookup[syntax.target] = result = def === null ? null : AttrInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve a binding command resource.\n     *\n     * @param name - The parsed `AttrSyntax`\n     *\n     * @returns An instance of the command if it exists, or `null` if it does not exist.\n     */\n    getBindingCommand(syntax, optional) {\n        const name = syntax.command;\n        if (name === null) {\n            return null;\n        }\n        let result = this.commandLookup[name];\n        if (result === void 0) {\n            result = this.create(BindingCommand, name);\n            if (result === null) {\n                if (optional) {\n                    return null;\n                }\n                throw new Error(`Unknown binding command: ${name}`);\n            }\n            this.commandLookup[name] = result;\n        }\n        return result;\n    }\n    find(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        if (typeof resolver.getFactory === 'function') {\n            const factory = resolver.getFactory(this.container);\n            if (factory === null || factory === void 0) {\n                return null;\n            }\n            const definition = Metadata.getOwn(kind.name, factory.Type);\n            if (definition === void 0) {\n                // TODO: we may want to log a warning here, or even throw. This would happen if a dependency is registered with a resource-like key\n                // but does not actually have a definition associated via the type's metadata. That *should* generally not happen.\n                return null;\n            }\n            return definition;\n        }\n        return null;\n    }\n    create(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        const instance = resolver.resolve(this.container, this.container);\n        if (instance === void 0) {\n            return null;\n        }\n        return instance;\n    }\n}\n//# sourceMappingURL=resource-model.js.map","export { AttrSyntax } from './ast';\nexport { IAttributeParser } from './attribute-parser';\nexport { attributePattern, IAttributePattern, AttributePattern, Interpretation, ISyntaxInterpreter, } from './attribute-pattern';\nexport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern, } from './attribute-patterns';\nexport { bindingCommand, BindingCommand, BindingCommandDefinition, getTarget, } from './binding-command';\nexport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nexport { IExpressionParserRegistration, DefaultComponents, RefAttributePatternRegistration, DotSeparatedAttributePatternRegistration, DefaultBindingSyntax, AtPrefixedTriggerAttributePatternRegistration, ColonPrefixedBindAttributePatternRegistration, ShortHandBindingSyntax, CallBindingCommandRegistration, DefaultBindingCommandRegistration, ForBindingCommandRegistration, FromViewBindingCommandRegistration, OneTimeBindingCommandRegistration, ToViewBindingCommandRegistration, TwoWayBindingCommandRegistration, DefaultBindingLanguage, JitConfiguration } from './configuration';\nexport { Access, Precedence, Char, } from './common';\nexport { parseExpression, parse, ParserState, } from './expression-parser';\nexport { ResourceModel, BindableInfo, ElementInfo, AttrInfo } from './resource-model';\nexport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, ReplacePartSymbol, SymbolFlags, TemplateControllerSymbol, TextSymbol, } from './semantic-model';\n//# sourceMappingURL=index.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nconst defaultNow = PLATFORM.now.bind(PLATFORM);\nexport const Now = DI.createInterface('Now').withDefault(x => x.instance(defaultNow));\n//# sourceMappingURL=now.js.map","export var TaskQueuePriority;\n(function (TaskQueuePriority) {\n    TaskQueuePriority[TaskQueuePriority[\"microTask\"] = 0] = \"microTask\";\n    TaskQueuePriority[TaskQueuePriority[\"render\"] = 1] = \"render\";\n    TaskQueuePriority[TaskQueuePriority[\"macroTask\"] = 2] = \"macroTask\";\n    TaskQueuePriority[TaskQueuePriority[\"postRender\"] = 3] = \"postRender\";\n    TaskQueuePriority[TaskQueuePriority[\"idle\"] = 4] = \"idle\";\n})(TaskQueuePriority || (TaskQueuePriority = {}));\nexport const defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    persistent: false,\n    reusable: true,\n};\nlet $resolve;\nlet $reject;\nfunction executor(resolve, reject) {\n    $resolve = resolve;\n    $reject = reject;\n}\nexport function createExposedPromise() {\n    const p = new Promise(executor);\n    p.resolve = $resolve;\n    p.reject = $reject;\n    return p;\n}\n//# sourceMappingURL=types.js.map","import { createExposedPromise, } from './types';\nexport class TaskAbortError extends Error {\n    constructor(task) {\n        super('Task was canceled.');\n        this.task = task;\n    }\n}\nlet id = 0;\nexport class Task {\n    constructor(taskQueue, createdTime, queueTime, preempt, persistent, reusable, callback) {\n        this.taskQueue = taskQueue;\n        this.createdTime = createdTime;\n        this.queueTime = queueTime;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.reusable = reusable;\n        this.callback = callback;\n        this.id = ++id;\n        this.next = void 0;\n        this.prev = void 0;\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        this._status = 'pending';\n        this.priority = taskQueue.priority;\n    }\n    get result() {\n        const result = this._result;\n        if (result === void 0) {\n            switch (this._status) {\n                case 'pending': {\n                    const promise = this._result = createExposedPromise();\n                    this.resolve = promise.resolve;\n                    this.reject = promise.reject;\n                    return promise;\n                }\n                case 'running':\n                    throw new Error('Trying to await task from within task will cause a deadlock.');\n                case 'completed':\n                    return this._result = Promise.resolve();\n                case 'canceled':\n                    return this._result = Promise.reject(new TaskAbortError(this));\n            }\n        }\n        return result;\n    }\n    get status() {\n        return this._status;\n    }\n    run() {\n        if (this._status !== 'pending') {\n            throw new Error(`Cannot run task in ${this._status} state`);\n        }\n        // this.persistent could be changed while the task is running (this can only be done by the task itself if canceled, and is a valid way of stopping a loop)\n        // so we deliberately reference this.persistent instead of the local variable, but we keep it around to know whether the task *was* persistent before running it,\n        // so we can set the correct cancelation state.\n        const persistent = this.persistent;\n        const reusable = this.reusable;\n        const taskQueue = this.taskQueue;\n        const callback = this.callback;\n        const resolve = this.resolve;\n        const reject = this.reject;\n        const createdTime = this.createdTime;\n        taskQueue.remove(this);\n        this._status = 'running';\n        try {\n            const ret = callback(taskQueue.now() - createdTime);\n            if (this.persistent) {\n                taskQueue.resetPersistentTask(this);\n            }\n            else if (persistent) {\n                // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n                this._status = 'canceled';\n            }\n            else {\n                this._status = 'completed';\n            }\n            if (resolve !== void 0) {\n                resolve(ret);\n            }\n        }\n        catch (err) {\n            if (reject !== void 0) {\n                reject(err);\n            }\n            else {\n                throw err;\n            }\n        }\n        finally {\n            if (!this.persistent) {\n                this.dispose();\n                if (reusable) {\n                    taskQueue.returnToPool(this);\n                }\n            }\n        }\n    }\n    cancel() {\n        if (this._status === 'pending') {\n            const taskQueue = this.taskQueue;\n            const reusable = this.reusable;\n            const reject = this.reject;\n            taskQueue.remove(this);\n            if (taskQueue.isEmpty) {\n                taskQueue.cancel();\n            }\n            this._status = 'canceled';\n            if (reject !== void 0) {\n                reject(new TaskAbortError(this));\n            }\n            this.dispose();\n            if (reusable) {\n                taskQueue.returnToPool(this);\n            }\n            return true;\n        }\n        else if (this._status === 'running' && this.persistent) {\n            this.persistent = false;\n            return true;\n        }\n        return false;\n    }\n    reset(time) {\n        const delay = this.queueTime - this.createdTime;\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this._status = 'pending';\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n    reuse(time, delay, preempt, persistent, callback) {\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.callback = callback;\n        this._status = 'pending';\n    }\n    dispose() {\n        this.prev = void 0;\n        this.next = void 0;\n        this.callback = (void 0);\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n}\n//# sourceMappingURL=task.js.map","import { createExposedPromise, defaultQueueTaskOptions, } from './types';\nimport { Task, } from './task';\nexport class TaskQueue {\n    constructor(now, priority, scheduler, flushRequestorFactory) {\n        this.now = now;\n        this.priority = priority;\n        this.scheduler = scheduler;\n        this.processingSize = 0;\n        this.processingHead = void 0;\n        this.processingTail = void 0;\n        this.pendingSize = 0;\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.delayedSize = 0;\n        this.delayedHead = void 0;\n        this.delayedTail = void 0;\n        this.flushRequested = false;\n        this.yieldPromise = void 0;\n        this.taskPool = [];\n        this.taskPoolSize = 0;\n        this.lastRequest = 0;\n        this.microTaskRequestFlushTask = null;\n        this.flushRequestor = flushRequestorFactory.create(this);\n        this.requestFlush = this.requestFlush.bind(this);\n    }\n    get isEmpty() {\n        return this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0;\n    }\n    flush() {\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.flushRequested = false;\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        while (this.processingSize > 0) {\n            this.processingHead.run();\n        }\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        if (this.processingSize > 0) {\n            this.requestFlush();\n        }\n        else if (this.delayedSize > 0) {\n            if (this.priority <= 0 /* microTask */) {\n                // MicroTasks are not clamped so we have to clamp them with setTimeout or they'll block forever\n                this.microTaskRequestFlushTask = this.scheduler.getTaskQueue(2 /* macroTask */).queueTask(this.requestFlush);\n            }\n            else {\n                // Otherwise just let this queue handle itself\n                this.requestFlush();\n            }\n        }\n        if (this.yieldPromise !== void 0) {\n            let noMoreFiniteWork = true;\n            let cur = this.processingHead;\n            while (cur !== void 0) {\n                if (!cur.persistent) {\n                    noMoreFiniteWork = false;\n                    break;\n                }\n                cur = cur.next;\n            }\n            if (noMoreFiniteWork) {\n                cur = this.pendingHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                cur = this.delayedHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                const p = this.yieldPromise;\n                this.yieldPromise = void 0;\n                p.resolve();\n            }\n        }\n    }\n    cancel() {\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.flushRequestor.cancel();\n        this.flushRequested = false;\n    }\n    async yield() {\n        if (this.processingSize > 0 || this.pendingSize > 0 || this.delayedSize > 0) {\n            if (this.yieldPromise === void 0) {\n                this.yieldPromise = createExposedPromise();\n            }\n            await this.yieldPromise;\n        }\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        if (preempt) {\n            if (delay > 0) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with a greater-than-zero delay`);\n            }\n            if (persistent) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with persistent`);\n            }\n        }\n        if (persistent && this.priority === 0 /* microTask */) {\n            throw new Error(`Invalid arguments: cannot queue persistent tasks on the micro task queue`);\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        const time = this.now();\n        let task;\n        if (reusable) {\n            const taskPool = this.taskPool;\n            const index = this.taskPoolSize - 1;\n            if (index >= 0) {\n                task = taskPool[index];\n                taskPool[index] = (void 0);\n                this.taskPoolSize = index;\n                task.reuse(time, delay, preempt, persistent, callback);\n            }\n            else {\n                task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n            }\n        }\n        else {\n            task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n        }\n        if (preempt) {\n            if (this.processingSize++ === 0) {\n                this.processingHead = this.processingTail = task;\n            }\n            else {\n                this.processingTail = (task.prev = this.processingTail).next = task;\n            }\n        }\n        else if (delay === 0) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n            }\n        }\n        return task;\n    }\n    take(task) {\n        if (task.status !== 'pending') {\n            throw new Error('Can only take pending tasks.');\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        task.taskQueue.remove(task);\n        if (task.preempt) {\n            this.addToProcessing(task);\n        }\n        else if (task.queueTime <= this.now()) {\n            this.addToPending(task);\n        }\n        else {\n            this.addToDelayed(task);\n        }\n    }\n    remove(task) {\n        if (task.preempt) {\n            // Fast path - preempt task can only ever end up in the processing queue\n            this.removeFromProcessing(task);\n            return;\n        }\n        if (task.queueTime > this.now()) {\n            // Fast path - task with queueTime in the future can only ever be in the delayed queue\n            this.removeFromDelayed(task);\n            return;\n        }\n        // Scan everything (we can make this faster by using the queueTime property, but this is good enough for now)\n        let cur = this.processingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromProcessing(task);\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.pendingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromPending(task);\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.delayedHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromDelayed(task);\n                return;\n            }\n            cur = cur.next;\n        }\n        throw new Error(`Task #${task.id} could not be found`);\n    }\n    returnToPool(task) {\n        this.taskPool[this.taskPoolSize++] = task;\n    }\n    resetPersistentTask(task) {\n        task.reset(this.now());\n        if (task.createdTime === task.queueTime) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n                task.next = void 0;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n                task.next = void 0;\n            }\n        }\n    }\n    finish(task) {\n        if (task.next !== void 0) {\n            task.next.prev = task.prev;\n        }\n        if (task.prev !== void 0) {\n            task.prev.next = task.next;\n        }\n    }\n    removeFromProcessing(task) {\n        if (this.processingHead === task) {\n            this.processingHead = task.next;\n        }\n        if (this.processingTail === task) {\n            this.processingTail = task.prev;\n        }\n        --this.processingSize;\n        this.finish(task);\n    }\n    removeFromPending(task) {\n        if (this.pendingHead === task) {\n            this.pendingHead = task.next;\n        }\n        if (this.pendingTail === task) {\n            this.pendingTail = task.prev;\n        }\n        --this.pendingSize;\n        this.finish(task);\n    }\n    removeFromDelayed(task) {\n        if (this.delayedHead === task) {\n            this.delayedHead = task.next;\n        }\n        if (this.delayedTail === task) {\n            this.delayedTail = task.prev;\n        }\n        --this.delayedSize;\n        this.finish(task);\n    }\n    addToProcessing(task) {\n        if (this.processingSize++ === 0) {\n            this.processingHead = this.processingTail = task;\n        }\n        else {\n            this.processingTail = (task.prev = this.processingTail).next = task;\n        }\n    }\n    addToPending(task) {\n        if (this.pendingSize++ === 0) {\n            this.pendingHead = this.pendingTail = task;\n        }\n        else {\n            this.pendingTail = (task.prev = this.pendingTail).next = task;\n        }\n    }\n    addToDelayed(task) {\n        if (this.delayedSize++ === 0) {\n            this.delayedHead = this.delayedTail = task;\n        }\n        else {\n            this.delayedTail = (task.prev = this.delayedTail).next = task;\n        }\n    }\n    movePendingToProcessing() {\n        // Add the previously pending tasks to the currently processing tasks\n        if (this.processingSize === 0) {\n            this.processingHead = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize = this.pendingSize;\n        }\n        else {\n            this.processingTail.next = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize += this.pendingSize;\n        }\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.pendingSize = 0;\n    }\n    moveDelayedToProcessing() {\n        const time = this.now();\n        // Add any delayed tasks whose delay have expired to the currently processing tasks\n        const delayedHead = this.delayedHead;\n        if (delayedHead.queueTime <= time) {\n            let delayedTail = delayedHead;\n            let next = delayedTail.next;\n            let count = 1;\n            while (next !== void 0 && next.queueTime <= time) {\n                delayedTail = next;\n                next = delayedTail.next;\n                ++count;\n            }\n            if (this.processingSize === 0) {\n                this.processingHead = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize = count;\n            }\n            else {\n                this.processingTail.next = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize += count;\n            }\n            this.delayedHead = next;\n            this.delayedSize -= count;\n            if (this.delayedSize === 0) {\n                this.delayedTail = void 0;\n            }\n        }\n    }\n    requestFlush() {\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        if (!this.flushRequested) {\n            this.flushRequested = true;\n            this.lastRequest = this.now();\n            this.flushRequestor.request();\n        }\n    }\n}\n//# sourceMappingURL=task-queue.js.map","import { DI } from '@aurelia/kernel';\nimport { defaultQueueTaskOptions, } from './types';\nimport { TaskQueue, } from './task-queue';\nconst store = new WeakMap();\nexport const IScheduler = DI.createInterface('IScheduler').noDefault();\nexport class Scheduler {\n    constructor(now, microtaskFactory, renderFactory, macroTaskFactory, postRenderFactory, idleFactory) {\n        this.taskQueues = [\n            this.microtask = (new TaskQueue(now, 0 /* microTask */, this, microtaskFactory)),\n            this.render = (new TaskQueue(now, 1 /* render */, this, renderFactory)),\n            this.macroTask = (new TaskQueue(now, 2 /* macroTask */, this, macroTaskFactory)),\n            this.postRender = (new TaskQueue(now, 3 /* postRender */, this, postRenderFactory)),\n            this.idle = (new TaskQueue(now, 4 /* idle */, this, idleFactory)),\n        ];\n        this.yieldMicroTask = this.yieldMicroTask.bind(this);\n        this.yieldRenderTask = this.yieldRenderTask.bind(this);\n        this.yieldMacroTask = this.yieldMacroTask.bind(this);\n        this.yieldPostRenderTask = this.yieldPostRenderTask.bind(this);\n        this.yieldIdleTask = this.yieldIdleTask.bind(this);\n        this.yieldAll = this.yieldAll.bind(this);\n    }\n    static get(key) {\n        return store.get(key);\n    }\n    static set(key, instance) {\n        store.set(key, instance);\n    }\n    getTaskQueue(priority) {\n        return this.taskQueues[priority];\n    }\n    yield(priority) {\n        return this.taskQueues[priority].yield();\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, priority, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        return this.taskQueues[priority].queueTask(callback, { delay, preempt, persistent, reusable });\n    }\n    getMicroTaskQueue() {\n        return this.microtask;\n    }\n    getRenderTaskQueue() {\n        return this.render;\n    }\n    getMacroTaskQueue() {\n        return this.macroTask;\n    }\n    getPostRenderTaskQueue() {\n        return this.postRender;\n    }\n    getIdleTaskQueue() {\n        return this.idle;\n    }\n    yieldMicroTask() {\n        return this.microtask.yield();\n    }\n    yieldRenderTask() {\n        return this.render.yield();\n    }\n    yieldMacroTask() {\n        return this.macroTask.yield();\n    }\n    yieldPostRenderTask() {\n        return this.postRender.yield();\n    }\n    yieldIdleTask() {\n        return this.idle.yield();\n    }\n    async yieldAll(repeat = 1) {\n        while (repeat-- > 0) {\n            await this.yieldIdleTask();\n            await this.yieldPostRenderTask();\n            await this.yieldMacroTask();\n            await this.yieldRenderTask();\n            await this.yieldMicroTask();\n        }\n    }\n    queueMicroTask(callback, opts) {\n        return this.microtask.queueTask(callback, opts);\n    }\n    queueRenderTask(callback, opts) {\n        return this.render.queueTask(callback, opts);\n    }\n    queueMacroTask(callback, opts) {\n        return this.macroTask.queueTask(callback, opts);\n    }\n    queuePostRenderTask(callback, opts) {\n        return this.postRender.queueTask(callback, opts);\n    }\n    queueIdleTask(callback, opts) {\n        return this.idle.queueTask(callback, opts);\n    }\n}\n//# sourceMappingURL=scheduler.js.map","export { Now, } from './now';\nexport { IScheduler, Scheduler, } from './scheduler';\nexport { TaskQueue, } from './task-queue';\nexport { Task, TaskAbortError, } from './task';\nexport { createExposedPromise, TaskQueuePriority, } from './types';\n//# sourceMappingURL=index.js.map","function $noop() { return; }\nconst $global = (function () {\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    try {\n        // Not all environments allow eval and Function. Use only as a last resort:\n        // eslint-disable-next-line no-new-func\n        return new Function('return this')();\n    }\n    catch (_a) {\n        // If all fails, give up and create an object.\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return {};\n    }\n})();\nconst isBrowserLike = (typeof window !== 'undefined'\n    && typeof window.document !== 'undefined');\nconst isWebWorkerLike = (typeof self === 'object'\n    && self.constructor != null\n    && self.constructor.name === 'DedicatedWorkerGlobalScope');\nconst isNodeLike = (typeof process !== 'undefined'\n    && process.versions != null\n    && process.versions.node != null);\n// performance.now polyfill for non-browser envs based on https://github.com/myrne/performance-now\nconst $now = (function () {\n    var _a, _b;\n    let getNanoSeconds;\n    let hrtime;\n    let moduleLoadTime;\n    let nodeLoadTime;\n    let upTime;\n    if (((_a = $global.performance) === null || _a === void 0 ? void 0 : _a.now) != null) {\n        const $performance = $global.performance;\n        return function () {\n            return $performance.now();\n        };\n    }\n    else if (((_b = $global.process) === null || _b === void 0 ? void 0 : _b.hrtime) != null) {\n        const now = function () {\n            return (getNanoSeconds() - nodeLoadTime) / 1e6;\n        };\n        hrtime = $global.process.hrtime;\n        getNanoSeconds = function () {\n            const hr = hrtime();\n            return hr[0] * 1e9 + hr[1];\n        };\n        moduleLoadTime = getNanoSeconds();\n        upTime = $global.process.uptime() * 1e9;\n        nodeLoadTime = moduleLoadTime - upTime;\n        return now;\n    }\n    else {\n        const now = function () {\n            return Date.now() - nodeLoadTime;\n        };\n        nodeLoadTime = Date.now();\n        return now;\n    }\n})();\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst emptyArray = Object.freeze([]);\nconst emptyObject = Object.freeze({});\nconst $PLATFORM = {\n    /**\n     * `true` if there is a `window` variable in the global scope with a `document` property.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a browser, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `window` global is available and likely behaves similar to how it would in a browser.\n     */\n    isBrowserLike,\n    /**\n     * `true` if there is a `self` variable (of type `object`) in the global scope with constructor name `'DedicatedWorkerGlobalScope'`.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a web worker, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `self` global is available and likely behaves similar to how it would in a web worker.\n     */\n    isWebWorkerLike,\n    /**\n     * `true` if there is a `process` variable in the global scope with a `versions` property which has a `node` property.\n     *\n     * NOTE: this is not a guarantee that the code is actually running in nodejs, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `process` global is available and likely behaves similar to how it would in nodejs.\n     */\n    isNodeLike,\n    global: $global,\n    emptyArray,\n    emptyObject,\n    noop: $noop,\n    now: $now,\n    hasOwnProperty,\n    restore() {\n        Object.assign(PLATFORM, $PLATFORM);\n    },\n};\nexport const PLATFORM = { ...$PLATFORM };\n//# sourceMappingURL=platform.js.map","import { DI } from '@aurelia/kernel';\nexport const IAttrSyntaxTransformer = DI\n    .createInterface('IAttrSyntaxTransformer')\n    .noDefault();\n//# sourceMappingURL=attribute-syntax-transformer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { bindingCommand, getTarget, } from '@aurelia/jit';\nimport { RefBindingInstruction } from '@aurelia/runtime';\nimport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, TriggerBindingInstruction } from '@aurelia/runtime-html';\n/**\n * Trigger binding command. Compile attr with binding symbol with command `trigger` to `TriggerBindingInstruction`\n */\nlet TriggerBindingCommand = class TriggerBindingCommand {\n    constructor() {\n        this.bindingType = 4182 /* TriggerCommand */;\n    }\n    compile(binding) {\n        return new TriggerBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTriggerBindingCommand = __decorate([\n    bindingCommand('trigger')\n], TriggerBindingCommand);\nexport { TriggerBindingCommand };\n/**\n * Delegate binding command. Compile attr with binding symbol with command `delegate` to `DelegateBindingInstruction`\n */\nlet DelegateBindingCommand = class DelegateBindingCommand {\n    constructor() {\n        this.bindingType = 4184 /* DelegateCommand */;\n    }\n    compile(binding) {\n        return new DelegateBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nDelegateBindingCommand = __decorate([\n    bindingCommand('delegate')\n], DelegateBindingCommand);\nexport { DelegateBindingCommand };\n/**\n * Capture binding command. Compile attr with binding symbol with command `capture` to `CaptureBindingInstruction`\n */\nlet CaptureBindingCommand = class CaptureBindingCommand {\n    constructor() {\n        this.bindingType = 4183 /* CaptureCommand */;\n    }\n    compile(binding) {\n        return new CaptureBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nCaptureBindingCommand = __decorate([\n    bindingCommand('capture')\n], CaptureBindingCommand);\nexport { CaptureBindingCommand };\n/**\n * Attr binding command. Compile attr with binding symbol with command `attr` to `AttributeBindingInstruction`\n */\nlet AttrBindingCommand = class AttrBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        const target = getTarget(binding, false);\n        return new AttributeBindingInstruction(target, binding.expression, target);\n    }\n};\nAttrBindingCommand = __decorate([\n    bindingCommand('attr')\n], AttrBindingCommand);\nexport { AttrBindingCommand };\n/**\n * Style binding command. Compile attr with binding symbol with command `style` to `AttributeBindingInstruction`\n */\nlet StyleBindingCommand = class StyleBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('style', binding.expression, getTarget(binding, false));\n    }\n};\nStyleBindingCommand = __decorate([\n    bindingCommand('style')\n], StyleBindingCommand);\nexport { StyleBindingCommand };\n/**\n * Class binding command. Compile attr with binding symbol with command `class` to `AttributeBindingInstruction`\n */\nlet ClassBindingCommand = class ClassBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('class', binding.expression, getTarget(binding, false));\n    }\n};\nClassBindingCommand = __decorate([\n    bindingCommand('class')\n], ClassBindingCommand);\nexport { ClassBindingCommand };\n/**\n * Binding command to refer different targets (element, custom element/attribute view models, controller) afterAttach to an element\n */\nlet RefBindingCommand = class RefBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */ | 4096 /* IgnoreCustomAttr */;\n    }\n    compile(binding) {\n        return new RefBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nRefBindingCommand = __decorate([\n    bindingCommand('ref')\n], RefBindingCommand);\nexport { RefBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","import { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol as $CustomElementSymbol, LetElementSymbol as $LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol as $PlainElementSymbol, ReplacePartSymbol as $ReplacePartSymbol, TemplateControllerSymbol as $TemplateControllerSymbol, TextSymbol as $TextSymbol, } from '@aurelia/jit';\nexport const CustomElementSymbol = $CustomElementSymbol;\nexport const LetElementSymbol = $LetElementSymbol;\nexport const PlainElementSymbol = $PlainElementSymbol;\nexport const ReplacePartSymbol = $ReplacePartSymbol;\nexport const TemplateControllerSymbol = $TemplateControllerSymbol;\nexport const TextSymbol = $TextSymbol;\nexport { BindingSymbol, CustomAttributeSymbol, PlainAttributeSymbol, };\n//# sourceMappingURL=semantic-model.js.map","/* eslint-disable compat/compat */\nimport { BindableInfo, } from '@aurelia/jit';\nimport { camelCase, } from '@aurelia/kernel';\nimport { BindingMode } from '@aurelia/runtime';\nimport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, ReplacePartSymbol, TemplateControllerSymbol, TextSymbol, } from './semantic-model';\nconst invalidSurrogateAttribute = Object.assign(Object.create(null), {\n    'id': true,\n    'replace': true\n});\nconst attributesToIgnore = Object.assign(Object.create(null), {\n    'as-element': true,\n    'replace': true\n});\nfunction hasInlineBindings(rawValue) {\n    const len = rawValue.length;\n    let ch = 0;\n    for (let i = 0; i < len; ++i) {\n        ch = rawValue.charCodeAt(i);\n        if (ch === 92 /* Backslash */) {\n            ++i;\n            // Ignore whatever comes next because it's escaped\n        }\n        else if (ch === 58 /* Colon */) {\n            return true;\n        }\n        else if (ch === 36 /* Dollar */ && rawValue.charCodeAt(i + 1) === 123 /* OpenBrace */) {\n            return false;\n        }\n    }\n    return false;\n}\nfunction processInterpolationText(symbol) {\n    const node = symbol.physicalNode;\n    const parentNode = node.parentNode;\n    while (node.nextSibling !== null && node.nextSibling.nodeType === 3 /* Text */) {\n        parentNode.removeChild(node.nextSibling);\n    }\n    node.textContent = '';\n    parentNode.insertBefore(symbol.marker, node);\n}\nfunction isTemplateControllerOf(proxy, manifest) {\n    return proxy !== manifest;\n}\n/**\n * A (temporary) standalone function that purely does the DOM processing (lifting) related to template controllers.\n * It's a first refactoring step towards separating DOM parsing/binding from mutations.\n */\nfunction processTemplateControllers(dom, manifestProxy, manifest) {\n    const manifestNode = manifest.physicalNode;\n    let current = manifestProxy;\n    let currentTemplate;\n    while (isTemplateControllerOf(current, manifest)) {\n        if (current.template === manifest) {\n            // the DOM linkage is still in its original state here so we can safely assume the parentNode is non-null\n            manifestNode.parentNode.replaceChild(current.marker, manifestNode);\n            // if the manifest is a template element (e.g. <template repeat.for=\"...\">) then we can skip one lift operation\n            // and simply use the template directly, saving a bit of work\n            if (manifestNode.nodeName === 'TEMPLATE') {\n                current.physicalNode = manifestNode;\n                // the template could safely stay without affecting anything visible, but let's keep the DOM tidy\n                manifestNode.remove();\n            }\n            else {\n                // the manifest is not a template element so we need to wrap it in one\n                currentTemplate = current.physicalNode = dom.createTemplate();\n                currentTemplate.content.appendChild(manifestNode);\n            }\n        }\n        else {\n            currentTemplate = current.physicalNode = dom.createTemplate();\n            currentTemplate.content.appendChild(current.marker);\n        }\n        manifestNode.removeAttribute(current.syntax.rawName);\n        current = current.template;\n    }\n}\nfunction processReplacePart(dom, replacePart, manifestProxy) {\n    let proxyNode;\n    let currentTemplate;\n    if ((manifestProxy.flags & 512 /* hasMarker */) > 0) {\n        proxyNode = manifestProxy.marker;\n    }\n    else {\n        proxyNode = manifestProxy.physicalNode;\n    }\n    if (proxyNode.nodeName === 'TEMPLATE') {\n        // if it's a template element, no need to do anything special, just assign it to the replacePart\n        replacePart.physicalNode = proxyNode;\n    }\n    else {\n        // otherwise wrap the replace in a template\n        currentTemplate = replacePart.physicalNode = dom.createTemplate();\n        currentTemplate.content.appendChild(proxyNode);\n    }\n}\n/**\n * TemplateBinder. Todo: describe goal of this class\n */\nexport class TemplateBinder {\n    constructor(dom, resources, attrParser, exprParser, attrSyntaxTransformer) {\n        this.dom = dom;\n        this.resources = resources;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxTransformer = attrSyntaxTransformer;\n    }\n    bind(node) {\n        const surrogate = new PlainElementSymbol(this.dom, node);\n        const resources = this.resources;\n        const attrSyntaxTransformer = this.attrSyntaxTransformer;\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            if (invalidSurrogateAttribute[attrSyntax.target] === true) {\n                throw new Error(`Invalid surrogate attribute: ${attrSyntax.target}`);\n                // TODO: use reporter\n            }\n            const bindingCommand = resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ surrogate);\n                }\n                else if (attrInfo.isTemplateController) {\n                    throw new Error('Cannot have template controller on surrogate element.');\n                    // TODO: use reporter\n                }\n                else {\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ surrogate);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ surrogate);\n            }\n            ++i;\n        }\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ surrogate, \n        /* manifestRoot       */ null, \n        /* parentManifestRoot */ null, \n        /* partName           */ null);\n        return surrogate;\n    }\n    bindManifest(parentManifest, node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        switch (node.nodeName) {\n            case 'LET':\n                // let cannot have children and has some different processing rules, so return early\n                this.bindLetElement(\n                /* parentManifest */ parentManifest, \n                /* node           */ node);\n                return;\n            case 'SLOT':\n                surrogate.hasSlots = true;\n        }\n        // get the part name to override the name of the compiled definition\n        partName = node.getAttribute('replaceable');\n        if (partName === '') {\n            partName = 'default';\n        }\n        let name = node.getAttribute('as-element');\n        if (name === null) {\n            name = node.nodeName.toLowerCase();\n        }\n        const elementInfo = this.resources.getElementInfo(name);\n        if (elementInfo === null) {\n            // there is no registered custom element with this name\n            manifest = new PlainElementSymbol(this.dom, node);\n        }\n        else {\n            // it's a custom element so we set the manifestRoot as well (for storing replaces)\n            parentManifestRoot = manifestRoot;\n            manifestRoot = manifest = new CustomElementSymbol(this.dom, node, elementInfo);\n        }\n        // lifting operations done by template controllers and replaces effectively unlink the nodes, so start at the bottom\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        // the parentManifest will receive either the direct child nodes, or the template controllers / replaces\n        // wrapping them\n        this.bindAttributes(\n        /* node               */ node, \n        /* parentManifest     */ parentManifest, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        if (manifestRoot === manifest && manifest.isContainerless) {\n            node.parentNode.replaceChild(manifest.marker, node);\n        }\n        else if (manifest.isTarget) {\n            node.classList.add('au');\n        }\n    }\n    bindLetElement(parentManifest, node) {\n        const symbol = new LetElementSymbol(this.dom, node);\n        parentManifest.childNodes.push(symbol);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            if (attr.name === 'to-binding-context') {\n                node.removeAttribute('to-binding-context');\n                symbol.toBindingContext = true;\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const command = this.resources.getBindingCommand(attrSyntax, false);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrSyntax.rawValue, bindingType);\n            const to = camelCase(attrSyntax.target);\n            const info = new BindableInfo(to, BindingMode.toView);\n            symbol.bindings.push(new BindingSymbol(command, info, expr, attrSyntax.rawValue, to));\n            ++i;\n        }\n        node.parentNode.replaceChild(symbol.marker, node);\n    }\n    bindAttributes(node, parentManifest, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        // This is the top-level symbol for the current depth.\n        // If there are no template controllers or replaces, it is always the manifest itself.\n        // If there are template controllers, then this will be the outer-most TemplateControllerSymbol.\n        let manifestProxy = manifest;\n        let previousController = (void 0);\n        let currentController = (void 0);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            ++i;\n            if (attributesToIgnore[attr.name] === true) {\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const bindingCommand = this.resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = this.resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    this.attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ manifest);\n                }\n                else if (attrInfo.isTemplateController) {\n                    // the manifest is wrapped by the inner-most template controller (if there are multiple on the same element)\n                    // so keep setting manifest.templateController to the latest template controller we find\n                    currentController = manifest.templateController = this.declareTemplateController(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* partName   */ partName);\n                    // the proxy and the manifest are only identical when we're at the first template controller (since the controller\n                    // is assigned to the proxy), so this evaluates to true at most once per node\n                    if (manifestProxy === manifest) {\n                        currentController.template = manifest;\n                        manifestProxy = currentController;\n                    }\n                    else {\n                        currentController.templateController = previousController;\n                        currentController.template = previousController.template;\n                        previousController.template = currentController;\n                    }\n                    previousController = currentController;\n                }\n                else {\n                    // a regular custom attribute\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ manifest);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                this.attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ manifest);\n            }\n        }\n        if (node.tagName === 'INPUT') {\n            const type = node.type;\n            if (type === 'checkbox' || type === 'radio') {\n                this.ensureAttributeOrder(manifest);\n            }\n        }\n        processTemplateControllers(this.dom, manifestProxy, manifest);\n        let replace = node.getAttribute('replace');\n        if (replace === '' || (replace === null && manifestRoot !== null && manifestRoot.isContainerless && ((parentManifest.flags & 16 /* isCustomElement */) > 0))) {\n            replace = 'default';\n        }\n        const partOwner = manifest === manifestRoot ? parentManifestRoot : manifestRoot;\n        if (replace === null || partOwner === null) {\n            // the proxy is either the manifest itself or the outer-most controller; add it directly to the parent\n            parentManifest.childNodes.push(manifestProxy);\n        }\n        else {\n            // there is a replace attribute on this node, so add it to the parts collection of the manifestRoot\n            // instead of to the childNodes\n            const replacePart = new ReplacePartSymbol(replace);\n            replacePart.parent = parentManifest;\n            replacePart.template = manifestProxy;\n            partOwner.parts.push(replacePart);\n            if (parentManifest.templateController != null) {\n                parentManifest.templateController.parts.push(replacePart);\n            }\n            processReplacePart(this.dom, replacePart, manifestProxy);\n        }\n    }\n    // TODO: refactor to use render priority slots (this logic shouldn't be in the template binder)\n    ensureAttributeOrder(manifest) {\n        // swap the order of checked and model/value attribute, so that the required observers are prepared for checked-observer\n        const attributes = manifest.plainAttributes;\n        let modelOrValueIndex = void 0;\n        let checkedIndex = void 0;\n        let found = 0;\n        for (let i = 0; i < attributes.length && found < 3; i++) {\n            switch (attributes[i].syntax.target) {\n                case 'model':\n                case 'value':\n                case 'matcher':\n                    modelOrValueIndex = i;\n                    found++;\n                    break;\n                case 'checked':\n                    checkedIndex = i;\n                    found++;\n                    break;\n            }\n        }\n        if (checkedIndex !== void 0 && modelOrValueIndex !== void 0 && checkedIndex < modelOrValueIndex) {\n            [attributes[modelOrValueIndex], attributes[checkedIndex]] = [attributes[checkedIndex], attributes[modelOrValueIndex]];\n        }\n    }\n    bindChildNodes(node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        let childNode;\n        if (node.nodeName === 'TEMPLATE') {\n            childNode = node.content.firstChild;\n        }\n        else {\n            childNode = node.firstChild;\n        }\n        let nextChild;\n        while (childNode !== null) {\n            switch (childNode.nodeType) {\n                case 1 /* Element */:\n                    nextChild = childNode.nextSibling;\n                    this.bindManifest(\n                    /* parentManifest     */ manifest, \n                    /* node               */ childNode, \n                    /* surrogate          */ surrogate, \n                    /* manifest           */ manifest, \n                    /* manifestRoot       */ manifestRoot, \n                    /* parentManifestRoot */ parentManifestRoot, \n                    /* partName           */ partName);\n                    childNode = nextChild;\n                    break;\n                case 3 /* Text */:\n                    childNode = this.bindText(\n                    /* textNode */ childNode, \n                    /* manifest */ manifest).nextSibling;\n                    break;\n                case 4 /* CDATASection */:\n                case 7 /* ProcessingInstruction */:\n                case 8 /* Comment */:\n                case 10 /* DocumentType */:\n                    childNode = childNode.nextSibling;\n                    break;\n                case 9 /* Document */:\n                case 11 /* DocumentFragment */:\n                    childNode = childNode.firstChild;\n            }\n        }\n    }\n    bindText(textNode, manifest) {\n        const interpolation = this.exprParser.parse(textNode.wholeText, 2048 /* Interpolation */);\n        if (interpolation !== null) {\n            const symbol = new TextSymbol(this.dom, textNode, interpolation);\n            manifest.childNodes.push(symbol);\n            processInterpolationText(symbol);\n        }\n        let next = textNode;\n        while (next.nextSibling !== null && next.nextSibling.nodeType === 3 /* Text */) {\n            next = next.nextSibling;\n        }\n        return next;\n    }\n    declareTemplateController(attrSyntax, attrInfo, partName) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        // multi-bindings logic here is similar to (and explained in) bindCustomAttribute\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        return symbol;\n    }\n    bindCustomAttribute(attrSyntax, attrInfo, command, manifest) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax. Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            // a multiple-bindings attribute usage (semicolon separated binding) is only valid without a binding command;\n            // the binding commands must be declared in each of the property bindings\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        manifest.customAttributes.push(symbol);\n        manifest.isTarget = true;\n    }\n    bindMultiAttribute(symbol, attrInfo, value) {\n        const bindables = attrInfo.bindables;\n        const valueLength = value.length;\n        let attrName = void 0;\n        let attrValue = void 0;\n        let start = 0;\n        let ch = 0;\n        for (let i = 0; i < valueLength; ++i) {\n            ch = value.charCodeAt(i);\n            if (ch === 92 /* Backslash */) {\n                ++i;\n                // Ignore whatever comes next because it's escaped\n            }\n            else if (ch === 58 /* Colon */) {\n                attrName = value.slice(start, i);\n                // Skip whitespace after colon\n                while (value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                for (; i < valueLength; ++i) {\n                    ch = value.charCodeAt(i);\n                    if (ch === 92 /* Backslash */) {\n                        ++i;\n                        // Ignore whatever comes next because it's escaped\n                    }\n                    else if (ch === 59 /* Semicolon */) {\n                        attrValue = value.slice(start, i);\n                        break;\n                    }\n                }\n                if (attrValue === void 0) {\n                    // No semicolon found, so just grab the rest of the value\n                    attrValue = value.slice(start);\n                }\n                const attrSyntax = this.attrParser.parse(attrName, attrValue);\n                const attrTarget = camelCase(attrSyntax.target);\n                const command = this.resources.getBindingCommand(attrSyntax, false);\n                const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n                const expr = this.exprParser.parse(attrValue, bindingType);\n                let bindable = bindables[attrTarget];\n                if (bindable === undefined) {\n                    // everything in a multi-bindings expression must be used,\n                    // so if it's not a bindable then we create one on the spot\n                    bindable = bindables[attrTarget] = new BindableInfo(attrTarget, BindingMode.toView);\n                }\n                symbol.bindings.push(new BindingSymbol(command, bindable, expr, attrValue, attrTarget));\n                // Skip whitespace after semicolon\n                while (i < valueLength && value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                attrName = void 0;\n                attrValue = void 0;\n            }\n        }\n    }\n    bindPlainAttribute(attrSyntax, attr, surrogate, manifest) {\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n        const attrTarget = attrSyntax.target;\n        const attrRawValue = attrSyntax.rawValue;\n        let expr;\n        if (attrRawValue.length === 0\n            && (bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n            if ((bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n                // Default to the name of the attr for empty binding commands\n                expr = this.exprParser.parse(camelCase(attrTarget), bindingType);\n            }\n            else {\n                return;\n            }\n        }\n        else {\n            expr = this.exprParser.parse(attrRawValue, bindingType);\n        }\n        if ((manifest.flags & 16 /* isCustomElement */) > 0) {\n            const bindable = manifest.bindables[attrTarget];\n            if (bindable != null) {\n                // if the attribute name matches a bindable property name, add it regardless of whether it's a command, interpolation, or just a plain string;\n                // the template compiler will translate it to the correct instruction\n                manifest.bindings.push(new BindingSymbol(command, bindable, expr, attrRawValue, attrTarget));\n                manifest.isTarget = true;\n            }\n            else if (expr != null) {\n                // if it does not map to a bindable, only add it if we were able to parse an expression (either a command or interpolation)\n                manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n                manifest.isTarget = true;\n            }\n        }\n        else if (expr != null) {\n            // either a binding command, an interpolation, or a ref\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n            manifest.isTarget = true;\n        }\n        else if (manifest === surrogate) {\n            // any attributes, even if they are plain (no command/interpolation etc), should be added if they\n            // are on the surrogate element\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n        }\n        if (command == null && expr != null) {\n            // if it's an interpolation, clear the attribute value\n            attr.value = '';\n        }\n    }\n}\n//# sourceMappingURL=template-binder.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration } from '@aurelia/kernel';\nimport { IDOM } from '@aurelia/runtime';\n// For some reason rollup complains about `DI.createInterface<ITemplateElementFactory>().noDefault()` with this message:\n// \"semantic error TS2742 The inferred type of 'ITemplateElementFactory' cannot be named without a reference to '@aurelia/jit/node_modules/@aurelia/kernel'. This is likely not portable. A type annotation is necessary\"\n// So.. investigate why that happens (or rather, why it *only* happens here and not for the other 50)\nexport const ITemplateElementFactory = DI.createInterface('ITemplateElementFactory').noDefault();\nconst markupCache = {};\n/**\n * Default implementation for `ITemplateFactory` for use in an HTML based runtime.\n *\n * @internal\n */\nlet HTMLTemplateElementFactory = class HTMLTemplateElementFactory {\n    constructor(dom) {\n        this.dom = dom;\n        this.template = dom.createTemplate();\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateElementFactory, this).register(container);\n    }\n    createTemplate(input) {\n        if (typeof input === 'string') {\n            let result = markupCache[input];\n            if (result === void 0) {\n                const template = this.template;\n                template.innerHTML = input;\n                const node = template.content.firstElementChild;\n                // if the input is either not wrapped in a template or there is more than one node,\n                // return the whole template that wraps it/them (and create a new one for the next input)\n                if (node == null || node.nodeName !== 'TEMPLATE' || node.nextElementSibling != null) {\n                    this.template = this.dom.createTemplate();\n                    result = template;\n                }\n                else {\n                    // the node to return is both a template and the only node, so return just the node\n                    // and clean up the template for the next input\n                    template.content.removeChild(node);\n                    result = node;\n                }\n                markupCache[input] = result;\n            }\n            return result.cloneNode(true);\n        }\n        if (input.nodeName !== 'TEMPLATE') {\n            // if we get one node that is not a template, wrap it in one\n            const template = this.dom.createTemplate();\n            template.content.appendChild(input);\n            return template;\n        }\n        // we got a template element, remove it from the DOM if it's present there and don't\n        // do any other processing\n        if (input.parentNode != null) {\n            input.parentNode.removeChild(input);\n        }\n        return input;\n    }\n};\nHTMLTemplateElementFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [Object])\n], HTMLTemplateElementFactory);\nexport { HTMLTemplateElementFactory };\n//# sourceMappingURL=template-element-factory.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IAttributeParser, ResourceModel, } from '@aurelia/jit';\nimport { mergeDistinct, PLATFORM, Registration, mergeArrays, } from '@aurelia/kernel';\nimport { HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, IExpressionParser, InterpolationInstruction, ITemplateCompiler, LetBindingInstruction, LetElementInstruction, SetPropertyInstruction, CustomElementDefinition, IDOM } from '@aurelia/runtime';\nimport { SetAttributeInstruction, TextBindingInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, } from '@aurelia/runtime-html';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nimport { TemplateBinder } from './template-binder';\nimport { ITemplateElementFactory } from './template-element-factory';\nclass CustomElementCompilationUnit {\n    constructor(partialDefinition, surrogate, template) {\n        this.partialDefinition = partialDefinition;\n        this.surrogate = surrogate;\n        this.template = template;\n        this.instructions = [];\n        this.surrogates = [];\n        this.scopeParts = [];\n        this.parts = {};\n    }\n    toDefinition() {\n        const def = this.partialDefinition;\n        return CustomElementDefinition.create({\n            ...def,\n            instructions: mergeArrays(def.instructions, this.instructions),\n            surrogates: mergeArrays(def.surrogates, this.surrogates),\n            scopeParts: mergeArrays(def.scopeParts, this.scopeParts),\n            template: this.template,\n            needsCompile: false,\n            hasSlots: this.surrogate.hasSlots,\n        });\n    }\n}\n/**\n * Default (runtime-agnostic) implementation for `ITemplateCompiler`.\n *\n * @internal\n */\nlet TemplateCompiler = class TemplateCompiler {\n    constructor(factory, attrParser, exprParser, attrSyntaxModifier) {\n        this.factory = factory;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxModifier = attrSyntaxModifier;\n    }\n    get name() {\n        return 'default';\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateCompiler, this).register(container);\n    }\n    compile(partialDefinition, context) {\n        const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n        if (definition.template === null || definition.template === void 0) {\n            return definition;\n        }\n        const resources = ResourceModel.getOrCreate(context);\n        const { attrParser, exprParser, attrSyntaxModifier, factory } = this;\n        const binder = new TemplateBinder(context.get(IDOM), resources, attrParser, exprParser, attrSyntaxModifier);\n        const template = factory.createTemplate(definition.template);\n        const surrogate = binder.bind(template);\n        const compilation = this.compilation = new CustomElementCompilationUnit(definition, surrogate, template);\n        const customAttributes = surrogate.customAttributes;\n        const plainAttributes = surrogate.plainAttributes;\n        const customAttributeLength = customAttributes.length;\n        const plainAttributeLength = plainAttributes.length;\n        if (customAttributeLength + plainAttributeLength > 0) {\n            let offset = 0;\n            for (let i = 0; customAttributeLength > i; ++i) {\n                compilation.surrogates[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; i < plainAttributeLength; ++i) {\n                compilation.surrogates[offset] = this.compilePlainAttribute(plainAttributes[i], true);\n                offset++;\n            }\n        }\n        this.compileChildNodes(surrogate, compilation.instructions, compilation.scopeParts);\n        const compiledDefinition = compilation.toDefinition();\n        this.compilation = null;\n        return compiledDefinition;\n    }\n    compileChildNodes(parent, instructionRows, scopeParts) {\n        if ((parent.flags & 8192 /* hasChildNodes */) > 0) {\n            const childNodes = parent.childNodes;\n            const ii = childNodes.length;\n            let childNode;\n            for (let i = 0; i < ii; ++i) {\n                childNode = childNodes[i];\n                if ((childNode.flags & 128 /* isText */) > 0) {\n                    instructionRows.push([new TextBindingInstruction(childNode.interpolation)]);\n                }\n                else if ((childNode.flags & 32 /* isLetElement */) > 0) {\n                    const bindings = childNode.bindings;\n                    const instructions = [];\n                    let binding;\n                    const jj = bindings.length;\n                    for (let j = 0; j < jj; ++j) {\n                        binding = bindings[j];\n                        instructions[j] = new LetBindingInstruction(binding.expression, binding.target);\n                    }\n                    instructionRows.push([new LetElementInstruction(instructions, childNode.toBindingContext)]);\n                }\n                else {\n                    this.compileParentNode(childNode, instructionRows, scopeParts);\n                }\n            }\n        }\n    }\n    compileCustomElement(symbol, instructionRows, scopeParts) {\n        // offset 1 to leave a spot for the hydrate instruction so we don't need to create 2 arrays with a spread etc\n        const instructionRow = this.compileAttributes(symbol, 1);\n        instructionRow[0] = new HydrateElementInstruction(symbol.res, this.compileBindings(symbol), this.compileParts(symbol, scopeParts));\n        instructionRows.push(instructionRow);\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compilePlainElement(symbol, instructionRows, scopeParts) {\n        const attributes = this.compileAttributes(symbol, 0);\n        if (attributes.length > 0) {\n            instructionRows.push(attributes);\n        }\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compileParentNode(symbol, instructionRows, scopeParts) {\n        switch (symbol.flags & 511 /* type */) {\n            case 16 /* isCustomElement */:\n                this.compileCustomElement(symbol, instructionRows, scopeParts);\n                break;\n            case 64 /* isPlainElement */:\n                this.compilePlainElement(symbol, instructionRows, scopeParts);\n                break;\n            case 1 /* isTemplateController */:\n                this.compileTemplateController(symbol, instructionRows, scopeParts);\n        }\n    }\n    compileTemplateController(symbol, instructionRows, scopeParts) {\n        const bindings = this.compileBindings(symbol);\n        const controllerInstructionRows = [];\n        const controllerScopeParts = [];\n        this.compileParentNode(symbol.template, controllerInstructionRows, controllerScopeParts);\n        mergeDistinct(scopeParts, controllerScopeParts, false);\n        const def = CustomElementDefinition.create({\n            name: symbol.partName === null ? symbol.res : symbol.partName,\n            scopeParts: controllerScopeParts,\n            template: symbol.physicalNode,\n            instructions: controllerInstructionRows,\n            needsCompile: false,\n        });\n        let parts = void 0;\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            parts = {};\n            for (const part of symbol.parts) {\n                parts[part.name] = this.compilation.parts[part.name];\n            }\n        }\n        instructionRows.push([new HydrateTemplateController(def, symbol.res, bindings, symbol.res === 'else', parts)]);\n    }\n    compileBindings(symbol) {\n        let bindingInstructions;\n        if ((symbol.flags & 4096 /* hasBindings */) > 0) {\n            // either a custom element with bindings, a custom attribute / template controller with dynamic options,\n            // or a single value custom attribute binding\n            const { bindings } = symbol;\n            const len = bindings.length;\n            bindingInstructions = Array(len);\n            let i = 0;\n            for (; i < len; ++i) {\n                bindingInstructions[i] = this.compileBinding(bindings[i]);\n            }\n        }\n        else {\n            bindingInstructions = PLATFORM.emptyArray;\n        }\n        return bindingInstructions;\n    }\n    compileBinding(symbol) {\n        if (symbol.command === null) {\n            // either an interpolation or a normal string value assigned to an element or attribute binding\n            if (symbol.expression === null) {\n                // the template binder already filtered out non-bindables, so we know we need a setProperty here\n                return new SetPropertyInstruction(symbol.rawValue, symbol.bindable.propName);\n            }\n            else {\n                // either an element binding interpolation or a dynamic options attribute binding interpolation\n                return new InterpolationInstruction(symbol.expression, symbol.bindable.propName);\n            }\n        }\n        else {\n            // either an element binding command, dynamic options attribute binding command,\n            // or custom attribute / template controller (single value) binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    compileAttributes(symbol, offset) {\n        let attributeInstructions;\n        if ((symbol.flags & 2048 /* hasAttributes */) > 0) {\n            // any attributes on a custom element (which are not bindables) or a plain element\n            const customAttributes = symbol.customAttributes;\n            const plainAttributes = symbol.plainAttributes;\n            const customAttributeLength = customAttributes.length;\n            const plainAttributesLength = plainAttributes.length;\n            attributeInstructions = Array(offset + customAttributeLength + plainAttributesLength);\n            for (let i = 0; customAttributeLength > i; ++i) {\n                attributeInstructions[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; plainAttributesLength > i; ++i) {\n                attributeInstructions[offset] = this.compilePlainAttribute(plainAttributes[i], false);\n                offset++;\n            }\n        }\n        else if (offset > 0) {\n            attributeInstructions = Array(offset);\n        }\n        else {\n            attributeInstructions = PLATFORM.emptyArray;\n        }\n        return attributeInstructions;\n    }\n    compileCustomAttribute(symbol) {\n        // a normal custom attribute (not template controller)\n        const bindings = this.compileBindings(symbol);\n        return new HydrateAttributeInstruction(symbol.res, bindings);\n    }\n    compilePlainAttribute(symbol, isOnSurrogate) {\n        if (symbol.command === null) {\n            const syntax = symbol.syntax;\n            if (symbol.expression === null) {\n                const attrRawValue = syntax.rawValue;\n                if (isOnSurrogate) {\n                    switch (syntax.target) {\n                        case 'class':\n                            return new SetClassAttributeInstruction(attrRawValue);\n                        case 'style':\n                            return new SetStyleAttributeInstruction(attrRawValue);\n                        // todo:  define how to merge other attribute peacefully\n                        //        this is an existing feature request\n                    }\n                }\n                // a plain attribute on a surrogate\n                return new SetAttributeInstruction(attrRawValue, syntax.target);\n            }\n            else {\n                // a plain attribute with an interpolation\n                return new InterpolationInstruction(symbol.expression, syntax.target);\n            }\n        }\n        else {\n            // a plain attribute with a binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    // private compileAttribute(symbol: IAttributeSymbol): HTMLAttributeInstruction {\n    //   // any attribute on a custom element (which is not a bindable) or a plain element\n    //   if (symbol.flags & SymbolFlags.isCustomAttribute) {\n    //     return this.compileCustomAttribute(symbol as CustomAttributeSymbol);\n    //   } else {\n    //     return this.compilePlainAttribute(symbol as PlainAttributeSymbol);\n    //   }\n    // }\n    compileParts(symbol, scopeParts) {\n        const parts = {};\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            const replaceParts = symbol.parts;\n            const len = replaceParts.length;\n            let s = scopeParts.length;\n            for (let i = 0; i < len; ++i) {\n                const replacePart = replaceParts[i];\n                if (!scopeParts.includes(replacePart.name)) {\n                    scopeParts[s++] = replacePart.name;\n                }\n                const partScopeParts = [];\n                const partInstructionRows = [];\n                this.compileParentNode(replacePart.template, partInstructionRows, partScopeParts);\n                // TODO: the assignment to `this.compilation.parts[replacePart.name]` might be the cause of replaceable bug reported by rluba\n                // need to verify this\n                this.compilation.parts[replacePart.name] = parts[replacePart.name] = CustomElementDefinition.create({\n                    name: replacePart.name,\n                    scopeParts: partScopeParts,\n                    template: replacePart.physicalNode,\n                    instructions: partInstructionRows,\n                    needsCompile: false,\n                });\n            }\n        }\n        return parts;\n    }\n};\nTemplateCompiler = __decorate([\n    __param(0, ITemplateElementFactory),\n    __param(1, IAttributeParser),\n    __param(2, IExpressionParser),\n    __param(3, IAttrSyntaxTransformer),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], TemplateCompiler);\nexport { TemplateCompiler };\n//# sourceMappingURL=template-compiler.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DI } from '@aurelia/kernel';\nimport { RuntimeHtmlConfiguration } from '@aurelia/runtime-html';\nimport { AttrBindingCommand, CaptureBindingCommand, ClassBindingCommand, DelegateBindingCommand, RefBindingCommand, StyleBindingCommand, TriggerBindingCommand } from './binding-commands';\nimport { HtmlAttrSyntaxTransformer } from './html-attribute-syntax-transformer';\nimport { TemplateCompiler } from './template-compiler';\nimport { HTMLTemplateElementFactory } from './template-element-factory';\nexport const ITemplateCompilerRegistration = TemplateCompiler;\nexport const ITemplateElementFactoryRegistration = HTMLTemplateElementFactory;\nexport const IAttrSyntaxTransformerRegistation = HtmlAttrSyntaxTransformer;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `ITemplateCompiler`\n * - `ITemplateElementFactory`\n */\nexport const DefaultComponents = [\n    ITemplateCompilerRegistration,\n    ITemplateElementFactoryRegistration,\n    IAttrSyntaxTransformerRegistation\n];\nexport const RefBindingCommandRegistration = RefBindingCommand;\nexport const TriggerBindingCommandRegistration = TriggerBindingCommand;\nexport const DelegateBindingCommandRegistration = DelegateBindingCommand;\nexport const CaptureBindingCommandRegistration = CaptureBindingCommand;\nexport const AttrBindingCommandRegistration = AttrBindingCommand;\nexport const ClassBindingCommandRegistration = ClassBindingCommand;\nexport const StyleBindingCommandRegistration = StyleBindingCommand;\n/**\n * Default HTML-specific (but environment-agnostic) binding commands:\n * - Event listeners: `.trigger`, `.delegate`, `.capture`\n */\nexport const DefaultBindingLanguage = [\n    RefBindingCommandRegistration,\n    TriggerBindingCommandRegistration,\n    DelegateBindingCommandRegistration,\n    CaptureBindingCommandRegistration,\n    ClassBindingCommandRegistration,\n    StyleBindingCommandRegistration,\n    AttrBindingCommandRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents`\n * - `DefaultBindingLanguage`\n */\nexport const JitHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...JitDefaultComponents, ...JitDefaultBindingSyntax, ...JitDefaultBindingLanguage, ...DefaultComponents, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { Registration } from '@aurelia/kernel';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nexport class HtmlAttrSyntaxTransformer {\n    static register(container) {\n        return Registration.singleton(IAttrSyntaxTransformer, this).register(container);\n    }\n    transform(node, attrSyntax) {\n        if (attrSyntax.command === 'bind' && shouldDefaultToTwoWay(node, attrSyntax)) {\n            attrSyntax.command = 'two-way';\n        }\n        attrSyntax.target = this.map(node.tagName, attrSyntax.target);\n    }\n    map(tagName, attr) {\n        switch (tagName) {\n            case 'LABEL':\n                switch (attr) {\n                    case 'for':\n                        return 'htmlFor';\n                    default:\n                        return attr;\n                }\n            case 'IMG':\n                switch (attr) {\n                    case 'usemap':\n                        return 'useMap';\n                    default:\n                        return attr;\n                }\n            case 'INPUT':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    case 'minlength':\n                        return 'minLength';\n                    case 'formaction':\n                        return 'formAction';\n                    case 'formenctype':\n                        return 'formEncType';\n                    case 'formmethod':\n                        return 'formMethod';\n                    case 'formnovalidate':\n                        return 'formNoValidate';\n                    case 'formtarget':\n                        return 'formTarget';\n                    case 'inputmode':\n                        return 'inputMode';\n                    default:\n                        return attr;\n                }\n            case 'TEXTAREA':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    default:\n                        return attr;\n                }\n            case 'TD':\n            case 'TH':\n                switch (attr) {\n                    case 'rowspan':\n                        return 'rowSpan';\n                    case 'colspan':\n                        return 'colSpan';\n                    default:\n                        return attr;\n                }\n            default:\n                switch (attr) {\n                    case 'accesskey':\n                        return 'accessKey';\n                    case 'contenteditable':\n                        return 'contentEditable';\n                    case 'tabindex':\n                        return 'tabIndex';\n                    case 'textcontent':\n                        return 'textContent';\n                    case 'innerhtml':\n                        return 'innerHTML';\n                    case 'scrolltop':\n                        return 'scrollTop';\n                    case 'scrollleft':\n                        return 'scrollLeft';\n                    case 'readonly':\n                        return 'readOnly';\n                    default:\n                        return attr;\n                }\n        }\n    }\n}\nfunction shouldDefaultToTwoWay(element, attr) {\n    switch (element.tagName) {\n        case 'INPUT':\n            switch (element.type) {\n                case 'checkbox':\n                case 'radio':\n                    return attr.target === 'checked';\n                default:\n                    return attr.target === 'value' || attr.target === 'files';\n            }\n        case 'TEXTAREA':\n        case 'SELECT':\n            return attr.target === 'value';\n        default:\n            switch (attr.target) {\n                case 'textcontent':\n                case 'innerhtml':\n                    return element.hasAttribute('contenteditable');\n                case 'scrolltop':\n                case 'scrollleft':\n                    return true;\n                default:\n                    return false;\n            }\n    }\n}\n//# sourceMappingURL=html-attribute-syntax-transformer.js.map","import { Scheduler, Now, } from '@aurelia/scheduler';\nimport { isNativeFunction, PLATFORM, } from '@aurelia/kernel';\nfunction createMicroTaskFlushRequestorFactory() {\n    return {\n        create(taskQueue) {\n            let requested = false;\n            let canceled = false;\n            const p = Promise.resolve();\n            function flush() {\n                if (canceled) {\n                    canceled = false;\n                }\n                else {\n                    requested = false;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                request() {\n                    if (!requested) {\n                        canceled = false;\n                        requested = true;\n                        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                        p.then(flush);\n                    }\n                },\n                cancel() {\n                    canceled = true;\n                    requested = false;\n                },\n            };\n        },\n    };\n}\nfunction createSetTimeoutFlushRequestorFactory(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                cancel() {\n                    if (handle > -1) {\n                        w.clearTimeout(handle);\n                        handle = -1;\n                    }\n                },\n                request() {\n                    if (handle === -1) {\n                        handle = w.setTimeout(flush, 0);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createRequestAnimationFrameFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                cancel() {\n                    if (handle > -1) {\n                        w.cancelAnimationFrame(handle);\n                        handle = -1;\n                    }\n                },\n                request() {\n                    if (handle === -1) {\n                        handle = w.requestAnimationFrame(flush);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createPostRequestAnimationFrameFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let rafHandle = -1;\n            let timeoutHandle = -1;\n            function flush() {\n                if (timeoutHandle > -1) {\n                    timeoutHandle = -1;\n                    taskQueue.flush();\n                }\n            }\n            function queueFlush() {\n                if (rafHandle > -1) {\n                    rafHandle = -1;\n                    if (timeoutHandle === -1) {\n                        timeoutHandle = w.setTimeout(flush, 0);\n                    }\n                }\n            }\n            return {\n                cancel() {\n                    if (rafHandle > -1) {\n                        w.cancelAnimationFrame(rafHandle);\n                        rafHandle = -1;\n                    }\n                    if (timeoutHandle > -1) {\n                        w.clearTimeout(timeoutHandle);\n                        timeoutHandle = -1;\n                    }\n                },\n                request() {\n                    if (rafHandle === -1) {\n                        rafHandle = w.requestAnimationFrame(queueFlush);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createRequestIdleCallbackFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            if (typeof w.requestIdleCallback === 'function' &&\n                isNativeFunction(w.requestIdleCallback)) {\n                return {\n                    cancel() {\n                        if (handle > -1) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            w.cancelIdleCallback(handle);\n                            handle = -1;\n                        }\n                    },\n                    request() {\n                        if (handle === -1) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            handle = w.requestIdleCallback(flush);\n                        }\n                    },\n                };\n            }\n            else {\n                return {\n                    cancel() {\n                        if (handle > -1) {\n                            w.clearTimeout(handle);\n                            handle = -1;\n                        }\n                    },\n                    request() {\n                        if (handle === -1) {\n                            // Instead of trying anything fancy with event handler debouncers (we could do that if there was a request for it),\n                            // we just wait 45ms which is approximately the interval in a native idleCallback loop in chrome, to at least make it look\n                            // the same from a timing perspective\n                            handle = w.setTimeout(flush, 45);\n                        }\n                    },\n                };\n            }\n        },\n    };\n}\nexport function createDOMScheduler(container, w) {\n    let scheduler = Scheduler.get(PLATFORM.global);\n    if (scheduler === void 0) {\n        Scheduler.set(PLATFORM.global, scheduler = new Scheduler(container.get(Now), createMicroTaskFlushRequestorFactory(), createRequestAnimationFrameFlushRequestor(w), createSetTimeoutFlushRequestorFactory(w), createPostRequestAnimationFrameFlushRequestor(w), createRequestIdleCallbackFlushRequestor(w)));\n    }\n    return scheduler;\n}\n//# sourceMappingURL=index.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, IContainer, Registration } from '@aurelia/kernel';\nimport { IDOM, IDOMInitializer, IScheduler } from '@aurelia/runtime';\nimport { RuntimeHtmlConfiguration, HTMLDOM } from '@aurelia/runtime-html';\nimport { createDOMScheduler } from '@aurelia/scheduler-dom';\nlet BrowserDOMInitializer = class BrowserDOMInitializer {\n    constructor(container) {\n        this.container = container;\n    }\n    static register(container) {\n        return Registration.singleton(IDOMInitializer, this).register(container);\n    }\n    initialize(config) {\n        if (this.container.has(IDOM, false)) {\n            return this.container.get(IDOM);\n        }\n        let dom;\n        if (config !== undefined) {\n            if (config.dom !== undefined) {\n                dom = config.dom;\n            }\n            else if (config.host.ownerDocument !== null) {\n                dom = new HTMLDOM(window, config.host.ownerDocument, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n            else {\n                dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n        }\n        else {\n            dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n        }\n        Registration.instance(IDOM, dom).register(this.container);\n        Registration.instance(IScheduler, createDOMScheduler(this.container, window)).register(this.container);\n        return dom;\n    }\n};\nBrowserDOMInitializer = __decorate([\n    __param(0, IContainer),\n    __metadata(\"design:paramtypes\", [Object])\n], BrowserDOMInitializer);\nexport const IDOMInitializerRegistration = BrowserDOMInitializer;\n/**\n * Default HTML-specific, browser-specific implementations for the following interfaces:\n * - `IDOMInitializer`\n */\nexport const DefaultComponents = [\n    IDOMInitializerRegistration,\n];\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents`\n */\nexport const RuntimeHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...DefaultComponents);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport { BrowserDOMInitializer, };\n//# sourceMappingURL=index.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DefaultBindingLanguage as JitHtmlDefaultBindingLanguage, DefaultComponents as JitHtmlDefaultComponents } from '@aurelia/jit-html';\nimport { DI, Profiler } from '@aurelia/kernel';\nimport { RuntimeHtmlBrowserConfiguration } from '@aurelia/runtime-html-browser';\nconst { enter, leave } = Profiler.createTimer('JitHtmlBrowserConfiguration');\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlBrowserConfiguration` from `@aurelia/runtime-html-browser`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents` from `@aurelia/jit-html`\n * - `DefaultBindingLanguage` from `@aurelia/jit-html`\n */\nexport const JitHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        RuntimeHtmlBrowserConfiguration\n            .register(container)\n            .register(...JitDefaultBindingLanguage, ...JitDefaultBindingSyntax, ...JitDefaultComponents, ...JitHtmlDefaultBindingLanguage, ...JitHtmlDefaultComponents);\n        return container;\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=index.js.map","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","import * as AST from '@aurelia/runtime';\nconst astTypeMap = [\n    { type: AST.AccessKeyedExpression, name: 'AccessKeyedExpression' },\n    { type: AST.AccessMemberExpression, name: 'AccessMemberExpression' },\n    { type: AST.AccessScopeExpression, name: 'AccessScopeExpression' },\n    { type: AST.AccessThisExpression, name: 'AccessThisExpression' },\n    { type: AST.ArrayBindingPattern, name: 'ArrayBindingPattern' },\n    { type: AST.ArrayLiteralExpression, name: 'ArrayLiteralExpression' },\n    { type: AST.AssignExpression, name: 'AssignExpression' },\n    { type: AST.BinaryExpression, name: 'BinaryExpression' },\n    { type: AST.BindingBehaviorExpression, name: 'BindingBehaviorExpression' },\n    { type: AST.BindingIdentifier, name: 'BindingIdentifier' },\n    { type: AST.CallFunctionExpression, name: 'CallFunctionExpression' },\n    { type: AST.CallMemberExpression, name: 'CallMemberExpression' },\n    { type: AST.CallScopeExpression, name: 'CallScopeExpression' },\n    { type: AST.ConditionalExpression, name: 'ConditionalExpression' },\n    { type: AST.ForOfStatement, name: 'ForOfStatement' },\n    { type: AST.HtmlLiteralExpression, name: 'HtmlLiteralExpression' },\n    { type: AST.Interpolation, name: 'Interpolation' },\n    { type: AST.ObjectBindingPattern, name: 'ObjectBindingPattern' },\n    { type: AST.ObjectLiteralExpression, name: 'ObjectLiteralExpression' },\n    { type: AST.PrimitiveLiteralExpression, name: 'PrimitiveLiteralExpression' },\n    { type: AST.TaggedTemplateExpression, name: 'TaggedTemplateExpression' },\n    { type: AST.TemplateExpression, name: 'TemplateExpression' },\n    { type: AST.UnaryExpression, name: 'UnaryExpression' },\n    { type: AST.ValueConverterExpression, name: 'ValueConverterExpression' }\n];\nexport function enableImprovedExpressionDebugging() {\n    astTypeMap.forEach(x => { adoptDebugMethods(x.type, x.name); });\n}\n/** @internal */\nexport function adoptDebugMethods($type, name) {\n    $type.prototype.toString = function () { return Unparser.unparse(this); };\n}\nexport class Unparser {\n    constructor() {\n        this.text = '';\n    }\n    static unparse(expr) {\n        const visitor = new Unparser();\n        expr.accept(visitor);\n        return visitor.text;\n    }\n    visitAccessMember(expr) {\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n    }\n    visitAccessKeyed(expr) {\n        expr.object.accept(this);\n        this.text += '[';\n        expr.key.accept(this);\n        this.text += ']';\n    }\n    visitAccessThis(expr) {\n        if (expr.ancestor === 0) {\n            this.text += '$this';\n            return;\n        }\n        this.text += '$parent';\n        let i = expr.ancestor - 1;\n        while (i--) {\n            this.text += '.$parent';\n        }\n    }\n    visitAccessScope(expr) {\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n    }\n    visitArrayLiteral(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectLiteral(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitPrimitiveLiteral(expr) {\n        this.text += '(';\n        if (typeof expr.value === 'string') {\n            const escaped = expr.value.replace(/'/g, '\\\\\\'');\n            this.text += `'${escaped}'`;\n        }\n        else {\n            this.text += `${expr.value}`;\n        }\n        this.text += ')';\n    }\n    visitCallFunction(expr) {\n        this.text += '(';\n        expr.func.accept(this);\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallMember(expr) {\n        this.text += '(';\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallScope(expr) {\n        this.text += '(';\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitTaggedTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        expr.func.accept(this);\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitUnary(expr) {\n        this.text += `(${expr.operation}`;\n        if (expr.operation.charCodeAt(0) >= /* a */ 97) {\n            this.text += ' ';\n        }\n        expr.expression.accept(this);\n        this.text += ')';\n    }\n    visitBinary(expr) {\n        this.text += '(';\n        expr.left.accept(this);\n        if (expr.operation.charCodeAt(0) === /* i */ 105) {\n            this.text += ` ${expr.operation} `;\n        }\n        else {\n            this.text += expr.operation;\n        }\n        expr.right.accept(this);\n        this.text += ')';\n    }\n    visitConditional(expr) {\n        this.text += '(';\n        expr.condition.accept(this);\n        this.text += '?';\n        expr.yes.accept(this);\n        this.text += ':';\n        expr.no.accept(this);\n        this.text += ')';\n    }\n    visitAssign(expr) {\n        this.text += '(';\n        expr.target.accept(this);\n        this.text += '=';\n        expr.value.accept(this);\n        this.text += ')';\n    }\n    visitValueConverter(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `|${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitBindingBehavior(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `&${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitArrayBindingPattern(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectBindingPattern(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitBindingIdentifier(expr) {\n        this.text += expr.name;\n    }\n    visitHtmlLiteral(expr) { throw new Error('visitHtmlLiteral'); }\n    visitForOfStatement(expr) {\n        expr.declaration.accept(this);\n        this.text += ' of ';\n        expr.iterable.accept(this);\n    }\n    visitInterpolation(expr) {\n        const { parts, expressions } = expr;\n        const length = expressions.length;\n        this.text += '${';\n        this.text += parts[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += parts[i + 1];\n        }\n        this.text += '}';\n    }\n    writeArgs(args) {\n        this.text += '(';\n        for (let i = 0, length = args.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            args[i].accept(this);\n        }\n        this.text += ')';\n    }\n}\n//# sourceMappingURL=unparser.js.map","import { Reporter as RuntimeReporter } from '@aurelia/kernel';\nfunction applyFormat(message, ...params) {\n    while (message.includes('%s')) {\n        message = message.replace('%s', String(params.shift()));\n    }\n    return message;\n}\nexport const Reporter = {\n    ...RuntimeReporter,\n    get level() {\n        return RuntimeReporter.level;\n    },\n    write(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const message = `Code ${code}: ${info.message}`;\n        switch (info.level) {\n            case 1 /* debug */:\n                if (this.level <= 1 /* debug */) {\n                    console.debug(message, ...params);\n                }\n                break;\n            case 2 /* info */:\n                if (this.level <= 2 /* info */) {\n                    console.info(message, ...params);\n                }\n                break;\n            case 3 /* warn */:\n                if (this.level <= 3 /* warn */) {\n                    console.warn(message, ...params);\n                }\n                break;\n            case 4 /* error */: {\n                throw this.error(code, ...params);\n            }\n        }\n    },\n    error(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const error = new Error(`Code ${code}: ${applyFormat(info.message, ...params)}`);\n        error.data = params;\n        return error;\n    }\n};\nfunction getMessageInfoForCode(code) {\n    const info = codeLookup[code];\n    return info !== undefined ? info : createInvalidCodeMessageInfo(code);\n}\nfunction createInvalidCodeMessageInfo(code) {\n    return {\n        level: 4 /* error */,\n        message: `Attempted to report with unknown code ${code}.`\n    };\n}\nconst codeLookup = {\n    0: {\n        level: 3 /* warn */,\n        message: 'Cannot add observers to object.'\n    },\n    1: {\n        level: 3 /* warn */,\n        message: 'Cannot observe property of object.'\n    },\n    2: {\n        level: 2 /* info */,\n        message: 'Starting application in debug mode.'\n    },\n    3: {\n        level: 4 /* error */,\n        message: 'Runtime expression compilation is only available when including JIT support.'\n    },\n    4: {\n        level: 4 /* error */,\n        message: 'Invalid animation direction.'\n    },\n    5: {\n        level: 4 /* error */,\n        message: 'key/value cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    6: {\n        level: 4 /* error */,\n        message: 'Invalid resolver strategy specified.'\n    },\n    7: {\n        level: 4 /* error */,\n        message: 'Constructor Parameter with index cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    8: {\n        level: 4 /* error */,\n        message: 'Self binding behavior only supports events.'\n    },\n    9: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">'\n    },\n    10: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.'\n    },\n    11: {\n        level: 4 /* error */,\n        message: 'Only property bindings and string interpolation bindings can be signaled. Trigger, delegate and call bindings cannot be signaled.'\n    },\n    12: {\n        level: 4 /* error */,\n        message: 'Signal name is required.'\n    },\n    14: {\n        level: 4 /* error */,\n        message: 'Property cannot be assigned.'\n    },\n    15: {\n        level: 4 /* error */,\n        message: 'Unexpected call context.'\n    },\n    16: {\n        level: 4 /* error */,\n        message: 'A dependency registration is missing for the interface %s.'\n    },\n    17: {\n        level: 4 /* error */,\n        message: 'You can only define one default implementation for an interface.'\n    },\n    18: {\n        level: 4 /* error */,\n        message: 'You cannot observe a setter only property.'\n    },\n    19: {\n        level: 4 /* error */,\n        message: 'Value for expression is non-repeatable.'\n    },\n    20: {\n        level: 4 /* error */,\n        message: 'No template compiler found with the specified name. JIT support or a custom compiler is required.'\n    },\n    21: {\n        level: 4 /* error */,\n        message: 'You cannot combine the containerless custom element option with Shadow DOM.'\n    },\n    22: {\n        level: 4 /* error */,\n        message: 'A containerless custom element cannot be the root component of an application.'\n    },\n    30: {\n        level: 4 /* error */,\n        message: 'There are more targets than there are target instructions.'\n    },\n    31: {\n        level: 4 /* error */,\n        message: 'There are more target instructions than there are targets.'\n    },\n    100: {\n        level: 4 /* error */,\n        message: 'Invalid start of expression.'\n    },\n    101: {\n        level: 4 /* error */,\n        message: 'Unconsumed token.'\n    },\n    102: {\n        level: 4 /* error */,\n        message: 'Double dot and spread operators are not supported.'\n    },\n    103: {\n        level: 4 /* error */,\n        message: 'Invalid member expression.'\n    },\n    104: {\n        level: 4 /* error */,\n        message: 'Unexpected end of expression.'\n    },\n    105: {\n        level: 4 /* error */,\n        message: 'Expected identifier.'\n    },\n    106: {\n        level: 4 /* error */,\n        message: 'Invalid BindingIdentifier at left hand side of \"of\".'\n    },\n    107: {\n        level: 4 /* error */,\n        message: 'Invalid or unsupported property definition in object literal.'\n    },\n    108: {\n        level: 4 /* error */,\n        message: 'Unterminated quote in string literal.'\n    },\n    109: {\n        level: 4 /* error */,\n        message: 'Unterminated template string.'\n    },\n    110: {\n        level: 4 /* error */,\n        message: 'Missing expected token.'\n    },\n    111: {\n        level: 4 /* error */,\n        message: 'Unexpected character.'\n    },\n    150: {\n        level: 4 /* error */,\n        message: 'Left hand side of expression is not assignable.'\n    },\n    151: {\n        level: 4 /* error */,\n        message: 'Unexpected keyword \"of\"'\n    },\n    401: {\n        level: 3 /* warn */,\n        message: `AttributePattern is missing a handler for '%s'.`\n    },\n    402: {\n        level: 3 /* warn */,\n        message: `AttributePattern handler for '%s' is not a function.`\n    },\n    800: {\n        level: 4 /* error */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    801: {\n        level: 3 /* warn */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    2000: {\n        level: 4 /* error */,\n        message: 'Router has not been activated.'\n    },\n    2001: {\n        level: 4 /* error */,\n        message: 'Router has already been activated.'\n    },\n    2002: {\n        level: 4 /* error */,\n        message: 'Failed to resolve all viewports.'\n    },\n    2003: {\n        level: 4 /* error */,\n        message: 'Browser navigation has already been activated.'\n    },\n    2004: {\n        level: 4 /* error */,\n        message: 'LinkHandler has already been activated.'\n    },\n    1001: {\n        level: 2 /* info */,\n        message: 'DOM already initialized. Destroying and re-initializing..'\n    },\n    10000: {\n        level: 1 /* debug */,\n        message: '%s'\n    }\n};\n//# sourceMappingURL=reporter.js.map","import { PLATFORM, Reporter, Tracer } from '@aurelia/kernel';\nconst marker = {\n    objName: 'marker',\n    methodName: 'noop',\n    params: PLATFORM.emptyArray,\n    depth: -1,\n    prev: null,\n    next: null\n};\nclass TraceInfo {\n    constructor(objName, methodName, params) {\n        this.objName = objName;\n        this.methodName = methodName;\n        this.params = params;\n        this.objName = objName;\n        this.methodName = methodName;\n        this.depth = TraceInfo.stack.length;\n        this.params = params;\n        this.next = marker;\n        this.prev = TraceInfo.tail;\n        TraceInfo.tail.next = this;\n        TraceInfo.tail = this;\n        TraceInfo.stack.push(this);\n    }\n    static reset() {\n        let current = TraceInfo.head;\n        let next = null;\n        while (current != null) {\n            next = current.next;\n            current.next = null;\n            current.prev = null;\n            current.params = null;\n            current = next;\n        }\n        TraceInfo.head = marker;\n        TraceInfo.tail = marker;\n        TraceInfo.stack = [];\n    }\n    static enter(objName, methodName, params) {\n        return new TraceInfo(objName, methodName, params);\n    }\n    static leave() {\n        return TraceInfo.stack.pop();\n    }\n}\nTraceInfo.head = marker;\nTraceInfo.tail = marker;\nTraceInfo.stack = [];\nexport const DebugTracer = {\n    ...Tracer,\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) {\n        if (this.enabled) {\n            const info = TraceInfo.enter(objName, methodName, args);\n            if (this.liveLoggingEnabled) {\n                this.liveWriter.write(info);\n            }\n        }\n    },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() {\n        if (this.enabled) {\n            TraceInfo.leave();\n        }\n    },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) {\n        let i = 0;\n        const stack = TraceInfo.stack;\n        const len = stack.length;\n        while (i < len) {\n            writer.write(stack[i]);\n            ++i;\n        }\n    },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) {\n        if (writer != null) {\n            let current = TraceInfo.head.next; // skip the marker\n            while (current != null && current !== marker) {\n                writer.write(current);\n                current = current.next;\n            }\n        }\n        TraceInfo.reset();\n    },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() {\n        this.liveLoggingEnabled = false;\n        this.liveWriter = null;\n    }\n};\nconst defaultOptions = {\n    rendering: true,\n    binding: true,\n    observation: true,\n    beforeAttach: true,\n    mounting: true,\n    di: true,\n    lifecycle: true,\n    jit: true\n};\nfunction enableLiveLogging(optionsOrWriter) {\n    this.liveLoggingEnabled = true;\n    if (optionsOrWriter && 'write' in optionsOrWriter) {\n        this.liveWriter = optionsOrWriter;\n    }\n    else {\n        const options = optionsOrWriter !== undefined ? optionsOrWriter : defaultOptions;\n        this.liveWriter = createLiveTraceWriter(options);\n    }\n}\nconst toString = Object.prototype.toString;\nfunction flagsText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return stringifyLifecycleFlags(info.params[i]);\n    }\n    return 'none';\n}\nfunction _ctorName(obj) {\n    let name;\n    if (obj === undefined) {\n        name = 'undefined';\n    }\n    else if (obj === null) {\n        name = 'null';\n    }\n    else if (obj.constructor !== undefined) {\n        if (obj.constructor.description) {\n            name = `Resource{'${obj.constructor.description.name}'}`;\n        }\n        else {\n            name = obj.constructor.name;\n        }\n    }\n    else if (typeof obj === 'string') {\n        name = `'${obj}'`;\n    }\n    else {\n        name = toString.call(obj);\n    }\n    return name;\n}\nfunction ctorName(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return _ctorName(info.params[i]);\n    }\n    return 'undefined';\n}\nfunction scopeText(info, i = 0) {\n    let $ctorName;\n    if (info.params != null && info.params.length > i) {\n        const $scope = info.params[i];\n        if ($scope != null && $scope.bindingContext != null) {\n            $ctorName = _ctorName($scope.bindingContext);\n        }\n        else {\n            $ctorName = 'undefined';\n        }\n        return `Scope{${$ctorName}}`;\n    }\n    return 'undefined';\n}\nfunction keyText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        if ($key !== undefined && Reflect.has($key, 'friendlyName')) {\n            return $key['friendlyName'];\n        }\n        return _ctorName($key);\n    }\n    return 'undefined';\n}\nfunction primitive(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        return $key.toString();\n    }\n    return 'undefined';\n}\nconst RenderingArgsProcessor = {\n    $hydrate(info) {\n        return flagsText(info);\n    },\n    render(info) {\n        return `${flagsText(info)},IDOM,IContainer,${ctorName(info, 3)}`;\n    },\n    addBinding(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    },\n    addComponent(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    }\n};\nconst BindingArgsProcessor = {\n    $bind(info) {\n        return flagsText(info);\n    },\n    $unbind(info) {\n        return flagsText(info);\n    },\n    connect(info) {\n        return flagsText(info);\n    },\n    // currently only observers trace constructor calls but keep an eye on this if others are added, then we'd need additional filtering\n    constructor(info) {\n        switch (info.objName) {\n            case 'ArrayObserver':\n            case 'MapObserver':\n            case 'SetObserver':\n                return flagsText(info);\n            case 'SetterObserver':\n            case 'BindableObserver':\n                return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'ProxyObserver':\n                return ctorName(info);\n            case 'ProxySubscriberCollection':\n            case 'DirtyCheckProperty':\n                return `${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'PrimitiveObserver':\n            case 'PropertyAccessor':\n                return `${ctorName(info)},${primitive(info, 1)}`;\n            default:\n                return '';\n        }\n    },\n    lockedBind(info) {\n        return flagsText(info);\n    },\n    lockedUnbind(info) {\n        return flagsText(info);\n    },\n    InternalObserversLookup(info) {\n        return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n    },\n    BindingContext(info) {\n        switch (info.methodName) {\n            case 'get':\n                return `${scopeText(info)},${primitive(info, 1)},${primitive(info, 2)},${flagsText(info, 3)}`;\n            case 'getObservers':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    Scope(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'fromOverride':\n                return `${flagsText(info)},${ctorName(info, 1)}`;\n            case 'fromParent':\n                return `${flagsText(info)},${scopeText(info, 1)},${ctorName(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    },\n    OverrideContext(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'getObservers':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst ObservationArgsProcessor = {\n    callSource(info) {\n        const names = [];\n        switch (info.objName) {\n            case 'Listener':\n                return (info.params[0]).type;\n            case 'CallBinding':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(ctorName(info, i));\n                    }\n                }\n                return names.join(',');\n            default:\n                return 'unknown';\n        }\n    },\n    setValue(info) {\n        let valueText;\n        const value = info.params[0];\n        switch (typeof value) {\n            case 'undefined':\n                valueText = 'undefined';\n                break;\n            case 'object':\n                if (value === null) {\n                    valueText = 'null';\n                }\n                else {\n                    valueText = _ctorName(value);\n                }\n                break;\n            case 'string':\n                valueText = `'${value}'`;\n                break;\n            case 'number':\n                valueText = value.toString();\n                break;\n            default:\n                valueText = _ctorName(value);\n        }\n        return `${valueText},${flagsText(info, 1)}`;\n    },\n    flush(info) {\n        return flagsText(info);\n    },\n    handleChange(info) {\n        return `${primitive(info)},${primitive(info, 1)},${flagsText(info, 2)}`;\n    },\n    lockScope(info) {\n        return scopeText(info);\n    }\n};\nconst AttachingArgsProcessor = {\n    $attach(info) {\n        return flagsText(info);\n    },\n    $detach(info) {\n        return flagsText(info);\n    },\n    $cache(info) {\n        return flagsText(info);\n    },\n    hold(info) {\n        return `Node{'${(info.params[0]).textContent}'}`;\n    },\n    release(info) {\n        return flagsText(info);\n    }\n};\nconst MountingArgsProcessor = {\n    $mount(info) {\n        return flagsText(info);\n    },\n    $unmount(info) {\n        return flagsText(info);\n    },\n    project(info) {\n        return ctorName(info);\n    },\n    take(info) {\n        return ctorName(info);\n    }\n};\nconst DIArgsProcessor = {\n    construct(info) {\n        return ctorName(info);\n    },\n    Container(info) {\n        const names = [];\n        switch (info.methodName) {\n            case 'get':\n            case 'getAll':\n                return keyText(info);\n            case 'register':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(keyText(info, i));\n                    }\n                }\n                return names.join(',');\n            case 'createChild':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst LifecycleArgsProcessor = {\n    Lifecycle(info) {\n        switch (info.methodName.slice(0, 3)) {\n            case 'beg':\n                return '';\n            case 'enq':\n                return ctorName(info);\n            case 'end':\n            case 'pro':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    CompositionCoordinator(info) {\n        switch (info.methodName) {\n            case 'enqueue':\n                return 'IController';\n            case 'swap':\n                return `IController,${flagsText(info, 1)}`;\n            case 'processNext':\n                return '';\n            default:\n                return 'unknown';\n        }\n    },\n    AggregateLifecycleTask(info) {\n        switch (info.methodName) {\n            case 'addTask':\n            case 'removeTask':\n                return ctorName(info);\n            case 'complete':\n                return `${primitive(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst JitArgsProcessor = {\n    TemplateBinder(info) {\n        return ''; // TODO\n    }\n};\nfunction createLiveTraceWriter(options) {\n    const Processors = {};\n    if (options.rendering) {\n        Object.assign(Processors, RenderingArgsProcessor);\n    }\n    if (options.binding) {\n        Object.assign(Processors, BindingArgsProcessor);\n    }\n    if (options.observation) {\n        Object.assign(Processors, ObservationArgsProcessor);\n    }\n    if (options.beforeAttach) {\n        Object.assign(Processors, AttachingArgsProcessor);\n    }\n    if (options.mounting) {\n        Object.assign(Processors, MountingArgsProcessor);\n    }\n    if (options.di) {\n        Object.assign(Processors, DIArgsProcessor);\n    }\n    if (options.lifecycle) {\n        Object.assign(Processors, LifecycleArgsProcessor);\n    }\n    if (options.jit) {\n        Object.assign(Processors, JitArgsProcessor);\n    }\n    return {\n        write(info) {\n            let output;\n            if (Processors[info.methodName] !== undefined) {\n                output = Processors[info.methodName](info);\n            }\n            else if (Processors[info.objName] !== undefined) {\n                output = Processors[info.objName](info);\n            }\n            else {\n                return;\n            }\n            Reporter.write(10000, `${'-'.repeat(info.depth)}${info.objName}.${info.methodName}(${output})`);\n        }\n    };\n}\nexport function stringifyLifecycleFlags(flags) {\n    const flagNames = [];\n    if (flags & 2097152 /* mustEvaluate */) {\n        flagNames.push('mustEvaluate');\n    }\n    if (flags & 16777216 /* isCollectionMutation */) {\n        flagNames.push('isCollectionMutation');\n    }\n    if (flags & 16 /* updateTargetInstance */) {\n        flagNames.push('updateTargetInstance');\n    }\n    if (flags & 32 /* updateSourceExpression */) {\n        flagNames.push('updateSourceExpression');\n    }\n    if (flags & 64 /* fromAsyncFlush */) {\n        flagNames.push('fromAsyncFlush');\n    }\n    if (flags & 128 /* fromSyncFlush */) {\n        flagNames.push('fromSyncFlush');\n    }\n    if (flags & 256 /* fromTick */) {\n        flagNames.push('fromTick');\n    }\n    if (flags & 1024 /* fromStartTask */) {\n        flagNames.push('fromStartTask');\n    }\n    if (flags & 2048 /* fromStopTask */) {\n        flagNames.push('fromStopTask');\n    }\n    if (flags & 4096 /* fromBind */) {\n        flagNames.push('fromBind');\n    }\n    if (flags & 8192 /* fromUnbind */) {\n        flagNames.push('fromUnbind');\n    }\n    if (flags & 16384 /* fromAttach */) {\n        flagNames.push('fromAttach');\n    }\n    if (flags & 32768 /* fromDetach */) {\n        flagNames.push('fromDetach');\n    }\n    if (flags & 65536 /* fromCache */) {\n        flagNames.push('fromCache');\n    }\n    if (flags & 131072 /* fromDOMEvent */) {\n        flagNames.push('fromDOMEvent');\n    }\n    if (flags & 262144 /* fromLifecycleTask */) {\n        flagNames.push('fromLifecycleTask');\n    }\n    if (flags & 4194304 /* isTraversingParentScope */) {\n        flagNames.push('isTraversingParentScope');\n    }\n    if (flags & 67108864 /* allowParentScopeTraversal */) {\n        flagNames.push('allowParentScopeTraversal');\n    }\n    if (flags & 1 /* getterSetterStrategy */) {\n        flagNames.push('getterSetterStrategy');\n    }\n    if (flags & 2 /* proxyStrategy */) {\n        flagNames.push('proxyStrategy');\n    }\n    if (flags & 1073741824 /* secondaryExpression */) {\n        flagNames.push('secondaryExpression');\n    }\n    if (flagNames.length === 0) {\n        return 'none';\n    }\n    return flagNames.join('|');\n}\n//# sourceMappingURL=tracer.js.map","import { DebugConfiguration } from '@aurelia/debug';\nimport { JitHtmlBrowserConfiguration } from '@aurelia/jit-html-browser';\nimport { DI } from '@aurelia/kernel';\nimport { Aurelia as $Aurelia, CustomElement } from '@aurelia/runtime';\n// TODO: SSR?? abstract HTMLElement and document.\nfunction createAurelia() {\n    const au = new Aurelia();\n    au.register(JitHtmlBrowserConfiguration);\n    // eslint-disable-next-line sonarjs/no-collapsible-if\n    if (typeof process !== 'undefined' && typeof process.env === 'object') {\n        // Just use NODE_ENV to control build process.\n        // Bundlers (at least webpack/dumber/parcel) have feature to remove this branch in production.\n        // Then tree-shaking/minifier will remove unused DebugConfiguration import.\n        if (process.env.NODE_ENV !== 'production') {\n            au.register(DebugConfiguration);\n        }\n    }\n    return au;\n}\nexport class Aurelia extends $Aurelia {\n    constructor(container = DI.createContainer()) {\n        super(container);\n    }\n    static start(root) {\n        return createAurelia().start(root);\n    }\n    static app(config) {\n        return createAurelia().app(config);\n    }\n    static register(...params) {\n        return createAurelia().register(...params);\n    }\n    app(config) {\n        if (CustomElement.isType(config)) {\n            // Default to custom element element name\n            const definition = CustomElement.getDefinition(config);\n            let host = document.querySelector(definition.name);\n            if (host === null) {\n                // When no target is found, default to body.\n                // For example, when user forgot to write <my-app></my-app> in html.\n                host = document.body;\n            }\n            return super.app({\n                host: host,\n                component: config\n            });\n        }\n        return super.app(config);\n    }\n}\n//# sourceMappingURL=quick-start.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var api = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--4-1!../node_modules/postcss-loader/src/index.js??ref--4-2!../node_modules/sass-loader/dist/cjs.js??ref--4-3!./app.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--4-1!../../node_modules/postcss-loader/src/index.js??ref--4-2!../../node_modules/sass-loader/dist/cjs.js??ref--4-3!./audio-player.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--4-1!../../node_modules/postcss-loader/src/index.js??ref--4-2!../../node_modules/sass-loader/dist/cjs.js??ref--4-3!./shiurim.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--4-1!../../node_modules/postcss-loader/src/index.js??ref--4-2!../../node_modules/sass-loader/dist/cjs.js??ref--4-3!./shiur-details.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"button{--button-color: 239, 239, 239;--text-color: 0, 0, 0;--box-shadow-color: 94, 94, 94;--hover-button-color: 150, 150, 150;background-color:RGB(var(--button-color));border:1px solid transparent;border-radius:5px;color:RGB(var(--text-color));font-size:.8em;margin:0.5em;padding:0.33em 0.66em;align-items:center;display:flex;flex-direction:column;justify-content:center;box-shadow:0 0.75em 0.5em -0.5em RGBA(var(--box-shadow-color), 0.9);cursor:pointer;transition:all 0.5s}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._3icd3udZreCB9Y2vONJsLw{margin:0;width:100%;margin-top:1em}._5rLzezeIcV2G2m8rALoSu{margin-bottom:1em}._34kxRt-vhz1zugIFlMokJl button{display:flex;flex-direction:column;border-radius:5px;border:1px solid transparent;padding:5px 10px;font-size:.8em;min-width:100px;flex:1 1 5em;margin:.5rem;box-shadow:0 0.75rem 0.5rem -0.5rem #5e5e5e;cursor:pointer;transition:all .5s;align-items:center}._34kxRt-vhz1zugIFlMokJl button:hover,._34kxRt-vhz1zugIFlMokJl button:focus{background-color:rgba(179,156,95,0.5);box-shadow:0 0.75rem 0.5rem -0.5rem rgba(179,156,95,0.5)}._1iq93nZ4_g-UUU0hA0ECtA{font-style:normal}._34kxRt-vhz1zugIFlMokJl{display:flex;flex-wrap:wrap}._1HK-SuC1amdLG03zrKMXu5{margin-right:1em;flex:3 1 20em}._35HwURU7pma-UI5jcJICNU{display:flex;align-items:center}._35HwURU7pma-UI5jcJICNU i{cursor:pointer;line-height:1em;height:1em;width:1em}._1GV-QlWHqqrDs7lUbUehko{top:3.75em;bottom:0;right:0;left:0;height:calc(100vh - 5.75em);width:100vw;position:absolute;background-color:rgba(0,0,0,0.4)}._29JkaRQBHfVVtA5ubAL_O1{top:5rem;left:50vw;width:40px;height:40px;position:absolute;transform:rotateZ(45deg)}._29JkaRQBHfVVtA5ubAL_O1 ._1-Yr2QfzOt0yayfxUBg4FW{float:left;width:50%;height:50%;position:relative;transform:scale(1.1)}._29JkaRQBHfVVtA5ubAL_O1 ._1-Yr2QfzOt0yayfxUBg4FW:before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:#333;-webkit-animation:_28hFGkEfaDbfe6lLvxSSYE 2.4s infinite linear both;animation:_28hFGkEfaDbfe6lLvxSSYE 2.4s infinite linear both;transform-origin:100% 100%}._29JkaRQBHfVVtA5ubAL_O1 ._2C39XIvLW_WQTaiz4mdFf8{transform:scale(1.1) rotateZ(90deg)}._29JkaRQBHfVVtA5ubAL_O1 ._1EqJjwDbgH1h2QzwDQd3J0{transform:scale(1.1) rotateZ(180deg)}._29JkaRQBHfVVtA5ubAL_O1 ._3TIA6dGoLTd8yuNHLSvf8F{transform:scale(1.1) rotateZ(270deg)}._29JkaRQBHfVVtA5ubAL_O1 ._2C39XIvLW_WQTaiz4mdFf8:before{-webkit-animation-delay:0.3s;animation-delay:0.3s}._29JkaRQBHfVVtA5ubAL_O1 ._1EqJjwDbgH1h2QzwDQd3J0:before{-webkit-animation-delay:0.6s;animation-delay:0.6s}._29JkaRQBHfVVtA5ubAL_O1 ._3TIA6dGoLTd8yuNHLSvf8F:before{-webkit-animation-delay:0.9s;animation-delay:0.9s}@-webkit-keyframes _28hFGkEfaDbfe6lLvxSSYE{0%,10%{transform:perspective(140px) rotateX(-180deg);opacity:0}25%,75%{transform:perspective(140px) rotateX(0deg);opacity:1}90%,100%{transform:perspective(140px) rotateY(180deg);opacity:0}}@keyframes _28hFGkEfaDbfe6lLvxSSYE{0%,10%{transform:perspective(140px) rotateX(-180deg);opacity:0}25%,75%{transform:perspective(140px) rotateX(0deg);opacity:1}90%,100%{transform:perspective(140px) rotateY(180deg);opacity:0}}\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"current-time\": \"_3icd3udZreCB9Y2vONJsLw\",\n\t\"duration\": \"_5rLzezeIcV2G2m8rALoSu\",\n\t\"controls\": \"_34kxRt-vhz1zugIFlMokJl\",\n\t\"icon\": \"_1iq93nZ4_g-UUU0hA0ECtA\",\n\t\"play\": \"_1HK-SuC1amdLG03zrKMXu5\",\n\t\"volume\": \"_35HwURU7pma-UI5jcJICNU\",\n\t\"loading-container\": \"_1GV-QlWHqqrDs7lUbUehko\",\n\t\"sk-folding-cube\": \"_29JkaRQBHfVVtA5ubAL_O1\",\n\t\"sk-cube\": \"_1-Yr2QfzOt0yayfxUBg4FW\",\n\t\"sk-foldCubeAngle\": \"_28hFGkEfaDbfe6lLvxSSYE\",\n\t\"sk-cube2\": \"_2C39XIvLW_WQTaiz4mdFf8\",\n\t\"sk-cube3\": \"_1EqJjwDbgH1h2QzwDQd3J0\",\n\t\"sk-cube4\": \"_3TIA6dGoLTd8yuNHLSvf8F\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._1SRu0I-A7ak1mYXxJu7910._34lz24tpirKcJ79ZwLVddm{display:grid;grid-template-columns:repeat(auto-fit, minmax(210px, 1fr));grid-gap:32px;grid-auto-flow:dense;justify-items:center;padding:16px}.D_c2hrjBFFA_4zwQF-Rjj{--card-height: 175px;--card-width: 230px;align-items:center;background:linear-gradient(rgba(179,156,95,0.5), rgba(150,117,24,0.75)),no-repeat center url(\\\"/assets/img/talmud_scroll.jpg\\\");border-radius:5px;box-shadow:1.5rem 0 2rem #222;color:#000;display:flex;flex-direction:column;height:var(--card-height);justify-content:center;min-width:var(--card-width);position:relative;text-align:center;transition:all .5s ease-in-out;width:var(--card-width);padding:1.25em 1em}.D_c2hrjBFFA_4zwQF-Rjj:hover{box-shadow:1.5rem 0 1rem #222}.D_c2hrjBFFA_4zwQF-Rjj>.zru5knTPZLRSvnuMiDObO{bottom:initial;border-radius:5px;border:1px solid var(--inverse-txt-color);height:calc(var(--card-height) - 1.25em);pointer-events:none;position:absolute;right:initial;width:calc(var(--card-width) - 1.25em)}._3mR-n7CPdk60lDMgjbkcd_{display:flex;font-size:1.25rem;font-weight:900;margin:0;padding:0;flex-direction:column;align-items:center;justify-content:center}._3mR-n7CPdk60lDMgjbkcd_:after{content:\\\"\\\";background-color:#38362f;display:inline-block;height:5px;opacity:.01;transition:all 0.2s ease-in-out;transition-duration:0.75s;width:5%}.D_c2hrjBFFA_4zwQF-Rjj:hover>._3mR-n7CPdk60lDMgjbkcd_:after{opacity:1;width:100%}.St7Q9xZrNUhFuKzMBQwpa{align-items:center;display:flex;font-size:.75em;justify-content:center;font-style:italic;transition:all .15s ease-in-out}.St7Q9xZrNUhFuKzMBQwpa a{color:#000}.St7Q9xZrNUhFuKzMBQwpa a:hover{color:#38362f}.St7Q9xZrNUhFuKzMBQwpa button{margin:.25em 0.5em;padding:0 0.66em;font-size:1em;font-weight:900}._1VjhildPPdSdZ70xGwscQd{display:flex;flex-direction:column;align-content:center;justify-content:center}._2H7-fW7LQ2QMjUqt3YV1P0{flex-grow:1;display:flex;align-items:center}._2-rFiO6xzVGo-9Dp2gIANY{font-size:.75rem}._1SRu0I-A7ak1mYXxJu7910._3mR-n7CPdk60lDMgjbkcd_{position:-webkit-sticky;position:sticky;top:0;background-color:var(--main-bg-color);color:#fff;border-top:1px dotted #fff;z-index:10}\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"series\": \"_1SRu0I-A7ak1mYXxJu7910\",\n\t\"grid\": \"_34lz24tpirKcJ79ZwLVddm\",\n\t\"card\": \"D_c2hrjBFFA_4zwQF-Rjj\",\n\t\"inner-border\": \"zru5knTPZLRSvnuMiDObO\",\n\t\"title\": \"_3mR-n7CPdk60lDMgjbkcd_\",\n\t\"version\": \"St7Q9xZrNUhFuKzMBQwpa\",\n\t\"versions-container\": \"_1VjhildPPdSdZ70xGwscQd\",\n\t\"author\": \"_2H7-fW7LQ2QMjUqt3YV1P0\",\n\t\"date\": \"_2-rFiO6xzVGo-9Dp2gIANY\"\n};\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._2lYRunsbxy9XaIUz7feBUd{background-color:#efefef;padding:1em;flex-grow:1;display:flex}._1smDhwIgIyUbSscBd8HVER{flex-grow:1;text-align:center;padding:1em;background-color:#fff;border-radius:5px;display:flex;flex-direction:column}.EcW_tPCCDiztUCv6FFexO{display:flex;justify-content:space-between}audio-player{flex-grow:1}.iD4187F6w2Qt2wlKLAg10{margin-bottom:0}._2_w26EJgmTjYfFcz71_7Jm{margin-top:0;font-style:italic}._2hpyMWDpYcyNyhWrOxlghF{font-size:.8rem}\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"shiurim-details-outer-container\": \"_2lYRunsbxy9XaIUz7feBUd\",\n\t\"shiurim-details-inner-container\": \"_1smDhwIgIyUbSscBd8HVER\",\n\t\"pager\": \"EcW_tPCCDiztUCv6FFexO\",\n\t\"title\": \"iD4187F6w2Qt2wlKLAg10\",\n\t\"series\": \"_2_w26EJgmTjYfFcz71_7Jm\",\n\t\"date\": \"_2hpyMWDpYcyNyhWrOxlghF\"\n};\nmodule.exports = exports;\n","import { DOM } from '@aurelia/runtime-html';\nexport const retryStrategy = {\n    fixed: 0,\n    incremental: 1,\n    exponential: 2,\n    random: 3\n};\nconst defaultRetryConfig = {\n    maxRetries: 3,\n    interval: 1000,\n    strategy: retryStrategy.fixed\n};\n/**\n * Interceptor that retries requests on error, based on a given RetryConfiguration.\n */\nexport class RetryInterceptor {\n    /**\n     * Creates an instance of RetryInterceptor.\n     */\n    constructor(retryConfig) {\n        this.retryConfig = { ...defaultRetryConfig, ...(retryConfig !== undefined ? retryConfig : {}) };\n        if (this.retryConfig.strategy === retryStrategy.exponential &&\n            this.retryConfig.interval <= 1000) {\n            throw new Error('An interval less than or equal to 1 second is not allowed when using the exponential retry strategy');\n        }\n    }\n    /**\n     * Called with the request before it is sent. It remembers the request so it can be retried on error.\n     *\n     * @param request - The request to be sent.\n     * @returns The existing request, a new request or a response; or a Promise for any of these.\n     */\n    request(request) {\n        if (!request.retryConfig) {\n            request.retryConfig = { ...this.retryConfig };\n            request.retryConfig.counter = 0;\n        }\n        // do this on every request\n        request.retryConfig.requestClone = request.clone();\n        return request;\n    }\n    /**\n     * Called with the response after it is received. Clears the remembered request, as it was succesfull.\n     *\n     * @param response - The response.\n     * @returns The response; or a Promise for one.\n     */\n    response(response, request) {\n        // retry was successful, so clean up after ourselves\n        Reflect.deleteProperty(request, 'retryConfig');\n        return response;\n    }\n    /**\n     * Handles fetch errors and errors generated by previous interceptors. This\n     * function acts as a Promise rejection handler. It wil retry the remembered request based on the\n     * configured RetryConfiguration.\n     *\n     * @param error - The rejection value from the fetch request or from a\n     * previous interceptor.\n     * @returns The response of the retry; or a Promise for one.\n     */\n    responseError(error, request, httpClient) {\n        const { retryConfig } = request;\n        const { requestClone } = retryConfig;\n        return Promise.resolve().then(() => {\n            if (retryConfig.counter < retryConfig.maxRetries) {\n                const result = retryConfig.doRetry !== undefined ? retryConfig.doRetry(error, request) : true;\n                return Promise.resolve(result).then(doRetry => {\n                    if (doRetry) {\n                        retryConfig.counter++;\n                        const delay = calculateDelay(retryConfig);\n                        return new Promise((resolve) => DOM.window.setTimeout(resolve, !isNaN(delay) ? delay : 0))\n                            .then(() => {\n                            const newRequest = requestClone.clone();\n                            if (typeof (retryConfig.beforeRetry) === 'function') {\n                                return retryConfig.beforeRetry(newRequest, httpClient);\n                            }\n                            return newRequest;\n                        })\n                            .then(newRequest => {\n                            const retryableRequest = { ...newRequest, retryConfig };\n                            return httpClient.fetch(retryableRequest);\n                        });\n                    }\n                    // no more retries, so clean up\n                    Reflect.deleteProperty(request, 'retryConfig');\n                    throw error;\n                });\n            }\n            // no more retries, so clean up\n            Reflect.deleteProperty(request, 'retryConfig');\n            throw error;\n        });\n    }\n}\nfunction calculateDelay(retryConfig) {\n    const { interval, strategy, minRandomInterval, maxRandomInterval, counter } = retryConfig;\n    if (typeof (strategy) === 'function') {\n        return retryConfig.strategy(counter);\n    }\n    switch (strategy) {\n        case (retryStrategy.fixed):\n            return retryStrategies[retryStrategy.fixed](interval);\n        case (retryStrategy.incremental):\n            return retryStrategies[retryStrategy.incremental](counter, interval);\n        case (retryStrategy.exponential):\n            return retryStrategies[retryStrategy.exponential](counter, interval);\n        case (retryStrategy.random):\n            return retryStrategies[retryStrategy.random](counter, interval, minRandomInterval, maxRandomInterval);\n        default:\n            throw new Error('Unrecognized retry strategy');\n    }\n}\nconst retryStrategies = [\n    // fixed\n    interval => interval,\n    // incremental\n    (retryCount, interval) => interval * retryCount,\n    // exponential\n    (retryCount, interval) => retryCount === 1 ? interval : interval ** retryCount / 1000,\n    // random\n    (retryCount, interval, minRandomInterval = 0, maxRandomInterval = 60000) => {\n        return Math.random() * (maxRandomInterval - minRandomInterval) + minRandomInterval;\n    }\n];\n//# sourceMappingURL=retry-interceptor.js.map","import { RetryInterceptor } from './retry-interceptor';\n/**\n * A class for configuring HttpClients.\n */\nexport class HttpClientConfiguration {\n    constructor() {\n        /**\n         * The base URL to be prepended to each Request's url before sending.\n         */\n        this.baseUrl = '';\n        /**\n         * Default values to apply to init objects when creating Requests. Note that\n         * defaults cannot be applied when Request objects are manually created because\n         * Request provides its own defaults and discards the original init object.\n         * See also https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n         */\n        this.defaults = {};\n        /**\n         * Interceptors to be added to the HttpClient.\n         */\n        this.interceptors = [];\n    }\n    /**\n     * Sets the baseUrl.\n     *\n     * @param baseUrl - The base URL.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withBaseUrl(baseUrl) {\n        this.baseUrl = baseUrl;\n        return this;\n    }\n    /**\n     * Sets the defaults.\n     *\n     * @param defaults - The defaults.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withDefaults(defaults) {\n        this.defaults = defaults;\n        return this;\n    }\n    /**\n     * Adds an interceptor to be run on all requests or responses.\n     *\n     * @param interceptor - An object with request, requestError,\n     * response, or responseError methods. request and requestError act as\n     * resolve and reject handlers for the Request before it is sent.\n     * response and responseError act as resolve and reject handlers for\n     * the Response after it has been received.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withInterceptor(interceptor) {\n        this.interceptors.push(interceptor);\n        return this;\n    }\n    /**\n     * Applies a configuration that addresses common application needs, including\n     * configuring same-origin credentials, and using rejectErrorResponses.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    useStandardConfiguration() {\n        const standardConfig = { credentials: 'same-origin' };\n        Object.assign(this.defaults, standardConfig, this.defaults);\n        return this.rejectErrorResponses();\n    }\n    /**\n     * Causes Responses whose status codes fall outside the range 200-299 to reject.\n     * The fetch API only rejects on network errors or other conditions that prevent\n     * the request from completing, meaning consumers must inspect Response.ok in the\n     * Promise continuation to determine if the server responded with a success code.\n     * This method adds a response interceptor that causes Responses with error codes\n     * to be rejected, which is common behavior in HTTP client libraries.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    rejectErrorResponses() {\n        return this.withInterceptor({ response: rejectOnError });\n    }\n    withRetry(config) {\n        const interceptor = new RetryInterceptor(config);\n        return this.withInterceptor(interceptor);\n    }\n}\nfunction rejectOnError(response) {\n    if (!response.ok) {\n        throw response;\n    }\n    return response;\n}\n//# sourceMappingURL=http-client-configuration.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IDOM } from '@aurelia/runtime';\nimport { DOM, HTMLDOM } from '@aurelia/runtime-html';\nimport { HttpClientConfiguration } from './http-client-configuration';\nimport { RetryInterceptor } from './retry-interceptor';\nconst absoluteUrlRegexp = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n/**\n * An HTTP client based on the Fetch API.\n */\nlet HttpClient = class HttpClient {\n    /**\n     * Creates an instance of HttpClient.\n     */\n    constructor(dom) {\n        this.dom = dom;\n        if (dom.window.fetch === undefined) {\n            throw new Error('HttpClient requires a Fetch API implementation, but the current environment doesn\\'t support it. You may need to load a polyfill such as https://github.com/github/fetch');\n        }\n        this.dom = dom;\n        this.activeRequestCount = 0;\n        this.isRequesting = false;\n        this.isConfigured = false;\n        this.baseUrl = '';\n        this.defaults = null;\n        this.interceptors = [];\n    }\n    /**\n     * Configure this client with default settings to be used by all requests.\n     *\n     * @param config - A configuration object, or a function that takes a config\n     * object and configures it.\n     * @returns The chainable instance of this HttpClient.\n     * @chainable\n     */\n    configure(config) {\n        let normalizedConfig;\n        if (typeof config === 'object') {\n            const requestInitConfiguration = { defaults: config };\n            normalizedConfig = requestInitConfiguration;\n        }\n        else if (typeof config === 'function') {\n            normalizedConfig = new HttpClientConfiguration();\n            normalizedConfig.baseUrl = this.baseUrl;\n            normalizedConfig.defaults = { ...this.defaults };\n            normalizedConfig.interceptors = this.interceptors;\n            const c = config(normalizedConfig);\n            if (Object.prototype.isPrototypeOf.call(HttpClientConfiguration.prototype, c)) {\n                normalizedConfig = c;\n            }\n        }\n        else {\n            throw new Error('invalid config');\n        }\n        const defaults = normalizedConfig.defaults;\n        if (defaults !== undefined && Object.prototype.isPrototypeOf.call(Headers.prototype, defaults.headers)) {\n            // Headers instances are not iterable in all browsers. Require a plain\n            // object here to allow default headers to be merged into request headers.\n            throw new Error('Default headers must be a plain object.');\n        }\n        const interceptors = normalizedConfig.interceptors;\n        if (interceptors !== undefined && interceptors.length) {\n            // find if there is a RetryInterceptor\n            if (interceptors.filter(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x)).length > 1) {\n                throw new Error('Only one RetryInterceptor is allowed.');\n            }\n            const retryInterceptorIndex = interceptors.findIndex(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x));\n            if (retryInterceptorIndex >= 0 && retryInterceptorIndex !== interceptors.length - 1) {\n                throw new Error('The retry interceptor must be the last interceptor defined.');\n            }\n        }\n        this.baseUrl = normalizedConfig.baseUrl;\n        this.defaults = defaults;\n        this.interceptors = normalizedConfig.interceptors !== undefined ? normalizedConfig.interceptors : [];\n        this.isConfigured = true;\n        return this;\n    }\n    /**\n     * Starts the process of fetching a resource. Default configuration parameters\n     * will be applied to the Request. The constructed Request will be passed to\n     * registered request interceptors before being sent. The Response will be passed\n     * to registered Response interceptors before it is returned.\n     *\n     * See also https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    fetch(input, init) {\n        this.trackRequestStart();\n        let request = this.buildRequest(input, init);\n        return this.processRequest(request, this.interceptors).then(result => {\n            let response;\n            if (Object.prototype.isPrototypeOf.call(Response.prototype, result)) {\n                response = Promise.resolve(result);\n            }\n            else if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                request = result;\n                response = fetch(request);\n            }\n            else {\n                throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${result}]`);\n            }\n            return this.processResponse(response, this.interceptors, request);\n        })\n            .then(result => {\n            if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                return this.fetch(result);\n            }\n            return result;\n        })\n            .then(result => {\n            this.trackRequestEnd();\n            return result;\n        }, error => {\n            this.trackRequestEnd();\n            throw error;\n        });\n    }\n    buildRequest(input, init) {\n        const defaults = this.defaults !== null ? this.defaults : {};\n        let request;\n        let body;\n        let requestContentType;\n        const parsedDefaultHeaders = parseHeaderValues(defaults.headers);\n        if (Object.prototype.isPrototypeOf.call(Request.prototype, input)) {\n            request = input;\n            requestContentType = new Headers(request.headers).get('Content-Type');\n        }\n        else {\n            if (!init) {\n                init = {};\n            }\n            body = init.body;\n            const bodyObj = body !== undefined ? { body: body } : null;\n            const requestInit = { ...defaults, headers: {}, ...init, ...bodyObj };\n            requestContentType = new Headers(requestInit.headers).get('Content-Type');\n            request = new Request(getRequestUrl(this.baseUrl, input), requestInit);\n        }\n        if (!requestContentType) {\n            if (new Headers(parsedDefaultHeaders).has('content-type')) {\n                request.headers.set('Content-Type', new Headers(parsedDefaultHeaders).get('content-type'));\n            }\n            else if (body !== undefined && isJSON(body)) {\n                request.headers.set('Content-Type', 'application/json');\n            }\n        }\n        setDefaultHeaders(request.headers, parsedDefaultHeaders);\n        if (body !== undefined && Object.prototype.isPrototypeOf.call(Blob.prototype, body) && body.type) {\n            // work around bug in IE & Edge where the Blob type is ignored in the request\n            // https://connect.microsoft.com/IE/feedback/details/2136163\n            request.headers.set('Content-Type', body.type);\n        }\n        return request;\n    }\n    /**\n     * Calls fetch as a GET request.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    get(input, init) {\n        return this.fetch(input, init);\n    }\n    /**\n     * Calls fetch with request method set to POST.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    post(input, body, init) {\n        return this.callFetch(input, body, init, 'POST');\n    }\n    /**\n     * Calls fetch with request method set to PUT.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    put(input, body, init) {\n        return this.callFetch(input, body, init, 'PUT');\n    }\n    /**\n     * Calls fetch with request method set to PATCH.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    patch(input, body, init) {\n        return this.callFetch(input, body, init, 'PATCH');\n    }\n    /**\n     * Calls fetch with request method set to DELETE.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    delete(input, body, init) {\n        return this.callFetch(input, body, init, 'DELETE');\n    }\n    trackRequestStart() {\n        this.isRequesting = !!(++this.activeRequestCount);\n        if (this.isRequesting) {\n            const evt = DOM.createCustomEvent('aurelia-fetch-client-request-started', { bubbles: true, cancelable: true });\n            DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n        }\n    }\n    trackRequestEnd() {\n        this.isRequesting = !!(--this.activeRequestCount);\n        if (!this.isRequesting) {\n            const evt = DOM.createCustomEvent('aurelia-fetch-client-requests-drained', { bubbles: true, cancelable: true });\n            DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n        }\n    }\n    processRequest(request, interceptors) {\n        return this.applyInterceptors(request, interceptors, 'request', 'requestError', this);\n    }\n    processResponse(response, interceptors, request) {\n        return this.applyInterceptors(response, interceptors, 'response', 'responseError', request, this);\n    }\n    applyInterceptors(input, interceptors, successName, errorName, ...interceptorArgs) {\n        return (interceptors !== undefined ? interceptors : [])\n            .reduce((chain, interceptor) => {\n            const successHandler = interceptor[successName];\n            const errorHandler = interceptor[errorName];\n            // TODO: Fix this, as it violates `strictBindCallApply`.\n            return chain.then(successHandler ? (value => successHandler.call(interceptor, value, ...interceptorArgs)) : identity, errorHandler ? (reason => errorHandler.call(interceptor, reason, ...interceptorArgs)) : thrower);\n        }, Promise.resolve(input));\n    }\n    callFetch(input, body, init, method) {\n        if (!init) {\n            init = {};\n        }\n        init.method = method;\n        if (body) {\n            init.body = body;\n        }\n        return this.fetch(input, init);\n    }\n};\nHttpClient = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], HttpClient);\nexport { HttpClient };\nfunction parseHeaderValues(headers) {\n    const parsedHeaders = {};\n    const $headers = headers !== undefined ? headers : {};\n    for (const name in $headers) {\n        if (Object.prototype.hasOwnProperty.call($headers, name)) {\n            parsedHeaders[name] = (typeof $headers[name] === 'function')\n                ? $headers[name]()\n                : $headers[name];\n        }\n    }\n    return parsedHeaders;\n}\nfunction getRequestUrl(baseUrl, url) {\n    if (absoluteUrlRegexp.test(url)) {\n        return url;\n    }\n    return (baseUrl !== undefined ? baseUrl : '') + url;\n}\nfunction setDefaultHeaders(headers, defaultHeaders) {\n    const $defaultHeaders = defaultHeaders !== undefined ? defaultHeaders : {};\n    for (const name in $defaultHeaders) {\n        if (Object.prototype.hasOwnProperty.call($defaultHeaders, name) && !headers.has(name)) {\n            headers.set(name, $defaultHeaders[name]);\n        }\n    }\n}\nfunction isJSON(str) {\n    try {\n        JSON.parse(str);\n    }\n    catch (err) {\n        return false;\n    }\n    return true;\n}\nfunction identity(x) {\n    return x;\n}\nfunction thrower(x) {\n    throw x;\n}\n//# sourceMappingURL=http-client.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bound } from '@aurelia/kernel';\n/**\n * A first-in-first-out queue that only processes the next queued item\n * when the current one has been resolved or rejected. Sends queued items\n * one at a time to a specified callback function. The callback function\n * should resolve or reject the queued item when processing is done.\n * Enqueued items can be awaited. Enqueued items can specify an (arbitrary)\n * execution cost and the queue can be set up (activated) to only process\n * a specific amount of execution cost per RAF/tick.\n *\n * @internal - Shouldn't be used directly.\n */\nexport class Queue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Queue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Queue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = list ? itemOrItems : [itemOrItems];\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map(value => value !== undefined ? value : 1);\n        const promises = [];\n        for (const item of items) {\n            const qItem = { ...item };\n            qItem.cost = costs.shift();\n            promises.push(new Promise((resolve, reject) => {\n                qItem.resolve = () => {\n                    resolve();\n                    this.processing = null;\n                    this.dequeue();\n                };\n                qItem.reject = (reason) => {\n                    reject(reason);\n                    this.processing = null;\n                    this.dequeue();\n                };\n            }));\n            this.pending.push(qItem);\n        }\n        this.dequeue();\n        return list ? promises : promises[0];\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            this.callback(this.processing);\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", void 0)\n], Queue.prototype, \"dequeue\", null);\n//# sourceMappingURL=queue.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { Queue } from './queue';\n/**\n * @internal - Will be removed\n */\nlet BrowserNavigator = class BrowserNavigator {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { return; },\n        };\n        this.forwardedState = {};\n        this.handlePopstate = (ev) => {\n            return this.enqueue(this, 'popstate', [ev]);\n        };\n        this.processCalls = (qCall) => {\n            const call = qCall;\n            if (call.target === this && call.methodName !== 'forwardState') {\n                call.parameters.push(this.forwardedState.resolve);\n                this.forwardedState.resolve = null;\n                // Should we suppress this popstate event?\n                if (call.methodName === 'popstate' && this.forwardedState.suppressPopstate) {\n                    call.parameters.push(true);\n                    this.forwardedState.suppressPopstate = false;\n                }\n            }\n            // eslint-disable-next-line @typescript-eslint/ban-types\n            const method = call.target[call.methodName];\n            Reporter.write(10000, 'DEQUEUE', call.methodName, call.parameters);\n            if (method) {\n                method.apply(call.target, call.parameters);\n            }\n            qCall.resolve();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new Queue(this.processCalls);\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstate = false) {\n        return this.enqueue(this.history, 'go', [delta], suppressPopstate);\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'pushState', [state, title, `${fragment}${path}`]);\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'replaceState', [state, title, `${fragment}${path}`]);\n    }\n    popNavigatorState() {\n        return this.enqueue(this, 'popState', []);\n    }\n    popstate(ev, resolve, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (resolve !== null && resolve !== void 0) {\n            resolve();\n        }\n    }\n    async popState(resolve) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            return this.pushNavigatorState(state);\n        }\n        resolve();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    // Everything that wants to await a browser event should pass suppressPopstate param\n    // Events NOT resulting in popstate events should NOT pass suppressPopstate param\n    enqueue(target, methodName, parameters, suppressPopstate) {\n        const calls = [];\n        const costs = [];\n        const promises = [];\n        if (suppressPopstate !== undefined) {\n            // Due to (browser) events not having a promise, we create and propagate one\n            let resolve = null;\n            promises.push(new Promise(_resolve => {\n                resolve = _resolve;\n            }));\n            calls.push({\n                target: this,\n                methodName: 'forwardState',\n                parameters: [\n                    {\n                        resolve,\n                        suppressPopstate,\n                    }\n                ],\n            });\n            costs.push(0);\n        }\n        calls.push({\n            target: target,\n            methodName: methodName,\n            parameters: parameters,\n        });\n        costs.push(1);\n        // The first promise is the relevant one since it's either a) the propagated one (in\n        // case of a browser action), or b) the only one since there's only one call\n        promises.push(this.pendingCalls.enqueue(calls, costs)[0]);\n        return promises[0];\n    }\n};\nBrowserNavigator = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserNavigator);\nexport { BrowserNavigator };\n//# sourceMappingURL=browser-navigator.js.map","import { IDOM, CustomAttribute } from '@aurelia/runtime';\n/**\n * Class responsible for handling interactions that should trigger navigation.\n *\n * @internal - Shouldn't be used directly.\n */\nexport class LinkHandler {\n    constructor(dom) {\n        this.options = {\n            useHref: true,\n            callback: () => { return; }\n        };\n        this.isActive = false;\n        this.handler = (e) => {\n            const info = LinkHandler.getEventInfo(e, this.window, this.options);\n            if (info.shouldHandleEvent) {\n                e.preventDefault();\n                this.options.callback(info);\n            }\n        };\n        this.window = dom.window;\n        this.document = dom.document;\n    }\n    /**\n     * Gets the href and a \"should handle\" recommendation, given an Event.\n     *\n     * @param event - The Event to inspect for target anchor and href.\n     */\n    static getEventInfo(event, win, options) {\n        const info = {\n            shouldHandleEvent: false,\n            instruction: null,\n            anchor: null\n        };\n        const target = info.anchor = event.currentTarget;\n        // Switch to this for delegation:\n        // const target = info.anchor = LinkHandler.closestAnchor(event.target as Element);\n        if (!target || !LinkHandler.targetIsThisWindow(target, win)) {\n            return info;\n        }\n        if (target.hasAttribute('external')) {\n            return info;\n        }\n        if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\n            return info;\n        }\n        const gotoAttr = CustomAttribute.for(target, 'goto');\n        const goto = gotoAttr !== void 0 ? gotoAttr.viewModel.value : null;\n        const href = options.useHref && target.hasAttribute('href') ? target.getAttribute('href') : null;\n        if ((goto === null || goto.length === 0) && (href === null || href.length === 0)) {\n            return info;\n        }\n        info.anchor = target;\n        info.instruction = goto || href;\n        const leftButtonClicked = event.button === 0;\n        info.shouldHandleEvent = leftButtonClicked;\n        return info;\n    }\n    /**\n     * Finds the closest ancestor that's an anchor element.\n     *\n     * @param el - The element to search upward from.\n     * @returns The link element that is the closest ancestor.\n     */\n    // private static closestAnchor(el: Element): Element | null {\n    //   while (el !== null && el !== void 0) {\n    //     if (el.tagName === 'A') {\n    //       return el;\n    //     }\n    //     el = el.parentNode as Element;\n    //   }\n    //   return null;\n    // }\n    /**\n     * Gets a value indicating whether or not an anchor targets the current window.\n     *\n     * @param target - The anchor element whose target should be inspected.\n     * @returns True if the target of the link element is this window; false otherwise.\n     */\n    static targetIsThisWindow(target, win) {\n        const targetWindow = target.getAttribute('target');\n        return !targetWindow ||\n            targetWindow === win.name ||\n            targetWindow === '_self';\n    }\n    /**\n     * Activate the instance.\n     *\n     */\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Link handler has already been activated');\n        }\n        this.isActive = true;\n        this.options = { ...options };\n    }\n    /**\n     * Deactivate the instance. Event handlers and other resources should be cleaned up here.\n     */\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Link handler has not been activated');\n        }\n        this.isActive = false;\n    }\n}\nLinkHandler.inject = [IDOM];\n//# sourceMappingURL=link-handler.js.map","/**\n * @internal - Shouldn't be used directly\n */\nexport function arrayRemove(arr, func) {\n    const removed = [];\n    let arrIndex = arr.findIndex(func);\n    while (arrIndex >= 0) {\n        removed.push(arr.splice(arrIndex, 1)[0]);\n        arrIndex = arr.findIndex(func);\n    }\n    return removed;\n}\n//# sourceMappingURL=utils.js.map","/**\n * @internal - Shouldn't be used directly\n */\nexport function parseQuery(query) {\n    if (!query || !query.length) {\n        return {};\n    }\n    const parameters = {};\n    // TODO: Deal with complex parameters such as lists and objects\n    const params = query.replace('+', ' ').split('&');\n    for (const param of params) {\n        const [key, value] = param.split('=');\n        parameters[decodeURIComponent(key)] = decodeURIComponent(value !== void 0 ? value : key);\n    }\n    return parameters;\n}\n//# sourceMappingURL=parser.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Controller, ILifecycle, CustomElement } from '@aurelia/runtime';\nimport { parseQuery } from './parser';\nimport { ViewportInstruction } from './viewport-instruction';\n/**\n * @internal - Shouldn't be used directly\n */\nexport var ContentStatus;\n(function (ContentStatus) {\n    ContentStatus[ContentStatus[\"none\"] = 0] = \"none\";\n    ContentStatus[ContentStatus[\"created\"] = 1] = \"created\";\n    ContentStatus[ContentStatus[\"loaded\"] = 2] = \"loaded\";\n    ContentStatus[ContentStatus[\"initialized\"] = 3] = \"initialized\";\n    ContentStatus[ContentStatus[\"added\"] = 4] = \"added\";\n})(ContentStatus || (ContentStatus = {}));\n/**\n * @internal - Shouldn't be used directly\n */\nexport class ViewportContent {\n    constructor(\n    // Can (and wants) be a (resolved) type or a string (to be resolved later)\n    content = new ViewportInstruction(''), instruction = {\n        instruction: '',\n        fullStateInstruction: '',\n    }, container = null) {\n        this.content = content;\n        this.instruction = instruction;\n        this.contentStatus = 0 /* none */;\n        this.entered = false;\n        this.fromCache = false;\n        this.fromHistory = false;\n        this.reentry = false;\n        // If we've got a container, we're good to resolve type\n        if (!this.content.isComponentType() && container !== null) {\n            this.content.componentType = this.toComponentType(container);\n        }\n    }\n    get componentInstance() {\n        return this.content.componentInstance;\n    }\n    get viewport() {\n        return this.content.viewport;\n    }\n    equalComponent(other) {\n        return this.content.sameComponent(other.content);\n    }\n    equalParameters(other) {\n        return this.content.sameComponent(other.content, true) &&\n            // TODO: Review whether query is relevant\n            this.instruction.query === other.instruction.query;\n    }\n    reentryBehavior() {\n        return (this.content.componentInstance !== null &&\n            'reentryBehavior' in this.content.componentInstance &&\n            this.content.componentInstance.reentryBehavior !== void 0)\n            ? this.content.componentInstance.reentryBehavior\n            : \"default\" /* default */;\n    }\n    isCacheEqual(other) {\n        return this.content.sameComponent(other.content, true);\n    }\n    createComponent(container, fallback) {\n        if (this.contentStatus !== 0 /* none */) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache && !this.fromHistory) {\n            try {\n                this.content.componentInstance = this.toComponentInstance(container);\n            }\n            catch (e) {\n                if (fallback !== void 0) {\n                    this.content.setParameters({ id: this.content.componentName });\n                    this.content.setComponent(fallback);\n                    try {\n                        this.content.componentInstance = this.toComponentInstance(container);\n                    }\n                    catch (ee) {\n                        throw e;\n                    }\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        this.contentStatus = 1 /* created */;\n    }\n    destroyComponent() {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 1 /* created */) {\n            return;\n        }\n        // Don't destroy components when stateful\n        this.contentStatus = 0 /* none */;\n    }\n    async canEnter(viewport, previousInstruction) {\n        if (!this.content.componentInstance) {\n            return false;\n        }\n        if (!this.content.componentInstance.canEnter) {\n            return true;\n        }\n        const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n        this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n        const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n        const result = this.content.componentInstance.canEnter(merged, this.instruction, previousInstruction);\n        Reporter.write(10000, 'viewport canEnter', result);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        if (typeof result === 'string') {\n            return [viewport.router.createViewportInstruction(result, viewport)];\n        }\n        return result;\n    }\n    async canLeave(nextInstruction) {\n        if (!this.content.componentInstance || !this.content.componentInstance.canLeave) {\n            return true;\n        }\n        const result = this.content.componentInstance.canLeave(nextInstruction, this.instruction);\n        Reporter.write(10000, 'viewport canLeave', result);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        return result;\n    }\n    async enter(previousInstruction) {\n        // if (!this.reentry && (this.contentStatus !== ContentStatus.created || this.entered)) {\n        if (!this.reentry && (this.contentStatus !== 2 /* loaded */ || this.entered)) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.enter) {\n            const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n            this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n            const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n            await this.content.componentInstance.enter(merged, this.instruction, previousInstruction);\n        }\n        this.entered = true;\n    }\n    async leave(nextInstruction) {\n        if (this.contentStatus !== 4 /* added */ || !this.entered) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.leave) {\n            await this.content.componentInstance.leave(nextInstruction, this.instruction);\n        }\n        this.entered = false;\n    }\n    // eslint-disable-next-line @typescript-eslint/require-await\n    async loadComponent(container, element, viewport) {\n        // if (this.contentStatus !== ContentStatus.created || !this.entered || !this.content.componentInstance) {\n        if (this.contentStatus !== 1 /* created */ || this.entered || !this.content.componentInstance) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache || !this.fromHistory) {\n            const host = element;\n            const controller = Controller.forCustomElement(this.content.componentInstance, container.get(ILifecycle), host, container, void 0, void 0);\n            controller.parent = CustomElement.for(element);\n        }\n        this.contentStatus = 2 /* loaded */;\n    }\n    unloadComponent(cache, stateful = false) {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't unload components when stateful\n        if (!stateful) {\n            this.contentStatus = 1 /* created */;\n        }\n        else {\n            cache.push(this);\n        }\n    }\n    initializeComponent(parent) {\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't initialize cached content or instantiated history content\n        // if (!this.fromCache || !this.fromHistory) {\n        // ((this.content.componentInstance as IRouteableComponent).$controller as IController).parent = parent;\n        this.content.componentInstance.$controller.bind(1024 /* fromStartTask */ | 4096 /* fromBind */);\n        // }\n        this.contentStatus = 3 /* initialized */;\n    }\n    async terminateComponent(stateful = false) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        // Don't terminate cached content\n        // if (!stateful) {\n        await this.content.componentInstance.$controller.unbind(2048 /* fromStopTask */ | 8192 /* fromUnbind */).wait();\n        // ((this.content.componentInstance as IRouteableComponent).$controller as IController).parent = void 0;\n        // }\n        this.contentStatus = 2 /* loaded */;\n    }\n    addComponent(element) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        this.content.componentInstance.$controller.attach(1024 /* fromStartTask */);\n        if (this.fromCache || this.fromHistory) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                const attr = el.getAttribute('au-element-scroll');\n                if (attr) {\n                    const [top, left] = attr.split(',');\n                    el.removeAttribute('au-element-scroll');\n                    el.scrollTo(+left, +top);\n                }\n            }\n        }\n        this.contentStatus = 4 /* added */;\n    }\n    removeComponent(element, stateful = false) {\n        if (this.contentStatus !== 4 /* added */ || this.entered) {\n            return;\n        }\n        if (stateful && element !== null) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                if (el.scrollTop > 0 || el.scrollLeft) {\n                    el.setAttribute('au-element-scroll', `${el.scrollTop},${el.scrollLeft}`);\n                }\n            }\n        }\n        this.content.componentInstance.$controller.detach(2048 /* fromStopTask */);\n        this.contentStatus = 3 /* initialized */;\n    }\n    async freeContent(element, nextInstruction, cache, stateful = false) {\n        switch (this.contentStatus) {\n            case 4 /* added */:\n                await this.leave(nextInstruction);\n                this.removeComponent(element, stateful);\n            case 3 /* initialized */:\n                await this.terminateComponent(stateful);\n            case 2 /* loaded */:\n                this.unloadComponent(cache, stateful);\n            case 1 /* created */:\n                this.destroyComponent();\n        }\n    }\n    toComponentName() {\n        return this.content.componentName;\n    }\n    toComponentType(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentType(container);\n    }\n    toComponentInstance(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentInstance(container);\n    }\n}\n//# sourceMappingURL=viewport-content.js.map","/* eslint-disable @typescript-eslint/no-unnecessary-type-assertion */\nexport class ConfigurableRoute {\n    constructor(path, caseSensitive, handler) {\n        this.path = path;\n        this.caseSensitive = caseSensitive;\n        this.handler = handler;\n    }\n}\nexport class Endpoint {\n    constructor(route, paramNames) {\n        this.route = route;\n        this.paramNames = paramNames;\n    }\n}\nexport class RecognizedRoute {\n    constructor(endpoint, params, searchParams, isDynamic, queryString) {\n        this.endpoint = endpoint;\n        this.params = params;\n        this.searchParams = searchParams;\n        this.isDynamic = isDynamic;\n        this.queryString = queryString;\n    }\n}\nclass Candidate {\n    constructor(chars, states, skippedStates, result) {\n        var _a;\n        this.chars = chars;\n        this.states = states;\n        this.skippedStates = skippedStates;\n        this.result = result;\n        this.head = states[states.length - 1];\n        this.endpoint = (_a = this.head) === null || _a === void 0 ? void 0 : _a.endpoint;\n    }\n    advance(ch) {\n        const { chars, states, skippedStates, result } = this;\n        let stateToAdd = null;\n        let matchCount = 0;\n        const state = states[states.length - 1];\n        function $process(nextState, skippedState) {\n            if (nextState.isMatch(ch)) {\n                if (++matchCount === 1) {\n                    stateToAdd = nextState;\n                }\n                else {\n                    result.add(new Candidate(chars.concat(ch), states.concat(nextState), skippedState === null ? skippedStates : skippedStates.concat(skippedState), result));\n                }\n            }\n            if (state.segment === null && nextState.isOptional && nextState.nextStates !== null) {\n                if (nextState.nextStates.length > 1) {\n                    throw new Error(`${nextState.nextStates.length} nextStates`);\n                }\n                const separator = nextState.nextStates[0];\n                if (!separator.isSeparator) {\n                    throw new Error(`Not a separator`);\n                }\n                if (separator.nextStates !== null) {\n                    for (const $nextState of separator.nextStates) {\n                        $process($nextState, nextState);\n                    }\n                }\n            }\n        }\n        if (state.isDynamic) {\n            $process(state, null);\n        }\n        if (state.nextStates !== null) {\n            for (const nextState of state.nextStates) {\n                $process(nextState, null);\n            }\n        }\n        if (stateToAdd !== null) {\n            states.push(this.head = stateToAdd);\n            chars.push(ch);\n            if (stateToAdd.endpoint !== null) {\n                this.endpoint = stateToAdd.endpoint;\n            }\n        }\n        if (matchCount === 0) {\n            result.remove(this);\n        }\n    }\n    finalize() {\n        function collectSkippedStates(skippedStates, state) {\n            const nextStates = state.nextStates;\n            if (nextStates !== null) {\n                if (nextStates.length === 1 && nextStates[0].segment === null) {\n                    collectSkippedStates(skippedStates, nextStates[0]);\n                }\n                else {\n                    for (const nextState of nextStates) {\n                        if (nextState.isOptional && nextState.endpoint !== null) {\n                            skippedStates.push(nextState);\n                            if (nextState.nextStates !== null) {\n                                for (const $nextState of nextState.nextStates) {\n                                    collectSkippedStates(skippedStates, $nextState);\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        collectSkippedStates(this.skippedStates, this.head);\n    }\n    getParams() {\n        const { states, chars, endpoint } = this;\n        const params = {};\n        // First initialize all properties with undefined so they all exist (even if they're not filled, e.g. non-matched optional params)\n        for (const name of endpoint.paramNames) {\n            params[name] = void 0;\n        }\n        for (let i = 0, ii = states.length; i < ii; ++i) {\n            const state = states[i];\n            if (state.isDynamic) {\n                const name = state.segment.name;\n                if (params[name] === void 0) {\n                    params[name] = chars[i];\n                }\n                else {\n                    params[name] += chars[i];\n                }\n            }\n        }\n        return params;\n    }\n    /**\n     * Compares this candidate to another candidate to determine the correct sorting order.\n     *\n     * This algorithm is different from `sortSolutions` in v1's route-recognizer in that it compares\n     * the candidates segment-by-segment, rather than merely comparing the cumulative of segment types\n     *\n     * This resolves v1's ambiguity in situations like `/foo/:id/bar` vs. `/foo/bar/:id`, which had the\n     * same sorting value because they both consist of two static segments and one dynamic segment.\n     *\n     * With this algorithm, `/foo/bar/:id` would always be sorted first because the second segment is different,\n     * and static wins over dynamic.\n     *\n     * ### NOTE\n     * This algorithm violates some of the invariants of v1's algorithm,\n     * but those invariants were arguably not very sound to begin with. Example:\n     *\n     * `/foo/*path/bar/baz` vs. `/foo/bar/*path1/*path2`\n     * - in v1, the first would win because that match has fewer stars\n     * - in v2, the second will win because there is a bigger static match at the start of the pattern\n     *\n     * The algorithm should be more logical and easier to reason about in v2, but it's important to be aware of\n     * subtle difference like this which might surprise some users who happened to rely on this behavior from v1,\n     * intentionally or unintentionally.\n     *\n     * @param b - The candidate to compare this to.\n     * Parameter name is `b` because the method should be used like so: `states.sort((a, b) => a.compareTo(b))`.\n     * This will bring the candidate with the highest score to the first position of the array.\n     */\n    compareTo(b) {\n        const statesA = this.states;\n        const statesB = b.states;\n        for (let iA = 0, iB = 0, ii = Math.max(statesA.length, statesB.length); iA < ii; ++iA) {\n            let stateA = statesA[iA];\n            if (stateA === void 0) {\n                return 1;\n            }\n            let stateB = statesB[iB];\n            if (stateB === void 0) {\n                return -1;\n            }\n            let segmentA = stateA.segment;\n            let segmentB = stateB.segment;\n            if (segmentA === null) {\n                if (segmentB === null) {\n                    ++iB;\n                    continue;\n                }\n                if ((stateA = statesA[++iA]) === void 0) {\n                    return 1;\n                }\n                segmentA = stateA.segment;\n            }\n            else if (segmentB === null) {\n                if ((stateB = statesB[++iB]) === void 0) {\n                    return -1;\n                }\n                segmentB = stateB.segment;\n            }\n            if (segmentA.kind < segmentB.kind) {\n                return 1;\n            }\n            if (segmentA.kind > segmentB.kind) {\n                return -1;\n            }\n            ++iB;\n        }\n        const skippedStatesA = this.skippedStates;\n        const skippedStatesB = b.skippedStates;\n        const skippedStatesALen = skippedStatesA.length;\n        const skippedStatesBLen = skippedStatesB.length;\n        if (skippedStatesALen < skippedStatesBLen) {\n            return 1;\n        }\n        if (skippedStatesALen > skippedStatesBLen) {\n            return -1;\n        }\n        for (let i = 0; i < skippedStatesALen; ++i) {\n            const skippedStateA = skippedStatesA[i];\n            const skippedStateB = skippedStatesB[i];\n            if (skippedStateA.length < skippedStateB.length) {\n                return 1;\n            }\n            if (skippedStateA.length > skippedStateB.length) {\n                return -1;\n            }\n        }\n        // This should only be possible with a single pattern with multiple consecutive star segments.\n        // TODO: probably want to warn or even throw here, but leave it be for now.\n        return 0;\n    }\n}\nfunction hasEndpoint(candidate) {\n    return candidate.head.endpoint !== null;\n}\nfunction compareChains(a, b) {\n    return a.compareTo(b);\n}\nclass RecognizeResult {\n    constructor(rootState) {\n        this.candidates = [];\n        this.candidates = [new Candidate([''], [rootState], [], this)];\n    }\n    get isEmpty() {\n        return this.candidates.length === 0;\n    }\n    getSolution() {\n        const candidates = this.candidates.filter(hasEndpoint);\n        if (candidates.length === 0) {\n            return null;\n        }\n        for (const candidate of candidates) {\n            candidate.finalize();\n        }\n        candidates.sort(compareChains);\n        return candidates[0];\n    }\n    add(candidate) {\n        this.candidates.push(candidate);\n    }\n    remove(candidate) {\n        this.candidates.splice(this.candidates.indexOf(candidate), 1);\n    }\n    advance(ch) {\n        const candidates = this.candidates.slice();\n        for (const candidate of candidates) {\n            candidate.advance(ch);\n        }\n    }\n}\nexport class RouteRecognizer {\n    constructor() {\n        this.rootState = new State(null, null, '');\n    }\n    add(routeOrRoutes) {\n        if (routeOrRoutes instanceof Array) {\n            for (const route of routeOrRoutes) {\n                this.add(route);\n            }\n            return;\n        }\n        const route = routeOrRoutes;\n        const $route = new ConfigurableRoute(route.path, route.caseSensitive === true, route.handler);\n        const parts = parsePath($route.path);\n        const paramNames = [];\n        let state = this.rootState;\n        for (const part of parts) {\n            // Each segment always begins with a slash, so we represent this with a non-segment state\n            state = state.append(null, '/');\n            switch (part.charAt(0)) {\n                case ':': { // route parameter\n                    const isOptional = part.endsWith('?');\n                    const name = isOptional ? part.slice(1, -1) : part.slice(1);\n                    paramNames.push(name);\n                    state = new DynamicSegment(name, isOptional).appendTo(state);\n                    break;\n                }\n                case '*': { // dynamic route\n                    const name = part.slice(1);\n                    paramNames.push(name);\n                    state = new StarSegment(name).appendTo(state);\n                    break;\n                }\n                default: { // standard path route\n                    state = new StaticSegment(part, $route.caseSensitive).appendTo(state);\n                    break;\n                }\n            }\n        }\n        const endpoint = new Endpoint($route, paramNames);\n        state.setEndpoint(endpoint);\n    }\n    recognize(path) {\n        let searchParams;\n        let queryString = '';\n        const queryStart = path.indexOf('?');\n        if (queryStart >= 0) {\n            queryString = path.slice(queryStart + 1);\n            path = path.slice(0, queryStart);\n            searchParams = new URLSearchParams(queryString);\n        }\n        else {\n            searchParams = new URLSearchParams();\n        }\n        path = decodeURI(path);\n        if (!path.startsWith('/')) {\n            path = `/${path}`;\n        }\n        if (path.length > 1 && path.endsWith('/')) {\n            path = path.slice(0, -1);\n        }\n        const result = new RecognizeResult(this.rootState);\n        for (let i = 0, ii = path.length; i < ii; ++i) {\n            const ch = path.charAt(i);\n            result.advance(ch);\n            if (result.isEmpty) {\n                return null;\n            }\n        }\n        const candidate = result.getSolution();\n        if (candidate === null) {\n            return null;\n        }\n        const { endpoint } = candidate;\n        const params = candidate.getParams();\n        const isDynamic = candidate.endpoint.paramNames.length > 0;\n        return new RecognizedRoute(endpoint, params, searchParams, isDynamic, queryString);\n    }\n}\nclass State {\n    constructor(prevState, segment, value) {\n        this.prevState = prevState;\n        this.segment = segment;\n        this.value = value;\n        this.nextStates = null;\n        this.endpoint = null;\n        switch (segment === null || segment === void 0 ? void 0 : segment.kind) {\n            case 2 /* dynamic */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = true;\n                this.isOptional = segment.optional;\n                break;\n            case 1 /* star */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = true;\n                this.isOptional = false;\n                break;\n            case 3 /* static */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = false;\n                this.isOptional = false;\n                break;\n            case undefined:\n                this.length = prevState === null ? 0 : prevState.length;\n                this.isSeparator = true;\n                this.isDynamic = false;\n                this.isOptional = false;\n                break;\n        }\n    }\n    append(segment, value) {\n        let state;\n        let nextStates = this.nextStates;\n        if (nextStates === null) {\n            state = void 0;\n            nextStates = this.nextStates = [];\n        }\n        else if (segment === null) {\n            state = nextStates.find(s => s.value === value);\n        }\n        else {\n            state = nextStates.find(s => { var _a; return (_a = s.segment) === null || _a === void 0 ? void 0 : _a.equals(segment); });\n        }\n        if (state === void 0) {\n            nextStates.push(state = new State(this, segment, value));\n        }\n        return state;\n    }\n    setEndpoint(endpoint) {\n        if (this.endpoint !== null) {\n            throw new Error(`Cannot add ambiguous route. The pattern ${endpoint.route.path} clashes with ${this.endpoint.route.path}`);\n        }\n        this.endpoint = endpoint;\n        if (this.isOptional) {\n            this.prevState.setEndpoint(endpoint);\n            if (this.prevState.isSeparator && this.prevState.prevState !== null) {\n                this.prevState.prevState.setEndpoint(endpoint);\n            }\n        }\n    }\n    isMatch(ch) {\n        const segment = this.segment;\n        switch (segment === null || segment === void 0 ? void 0 : segment.kind) {\n            case 2 /* dynamic */:\n                return !this.value.includes(ch);\n            case 1 /* star */:\n                return true;\n            case 3 /* static */:\n            case undefined:\n                // segment separators (slashes) are non-segments. We could say return ch === '/' as well, technically.\n                return this.value.includes(ch);\n        }\n    }\n}\nfunction isNotEmpty(segment) {\n    return segment.length > 0;\n}\nfunction parsePath(path) {\n    // Normalize leading, trailing and double slashes by ignoring empty segments\n    return path.split('/').filter(isNotEmpty);\n}\nvar SegmentKind;\n(function (SegmentKind) {\n    SegmentKind[SegmentKind[\"star\"] = 1] = \"star\";\n    SegmentKind[SegmentKind[\"dynamic\"] = 2] = \"dynamic\";\n    SegmentKind[SegmentKind[\"static\"] = 3] = \"static\";\n})(SegmentKind || (SegmentKind = {}));\nclass StaticSegment {\n    constructor(value, caseSensitive) {\n        this.value = value;\n        this.caseSensitive = caseSensitive;\n    }\n    get kind() { return 3 /* static */; }\n    appendTo(state) {\n        const { value, value: { length } } = this;\n        if (this.caseSensitive) {\n            for (let i = 0; i < length; ++i) {\n                state = state.append(\n                /* segment */ this, \n                /* value   */ value.charAt(i));\n            }\n        }\n        else {\n            for (let i = 0; i < length; ++i) {\n                const ch = value.charAt(i);\n                state = state.append(\n                /* segment */ this, \n                /* value   */ ch.toUpperCase() + ch.toLowerCase());\n            }\n        }\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 3 /* static */ &&\n            b.caseSensitive === this.caseSensitive &&\n            b.value === this.value);\n    }\n}\nclass DynamicSegment {\n    constructor(name, optional) {\n        this.name = name;\n        this.optional = optional;\n    }\n    get kind() { return 2 /* dynamic */; }\n    appendTo(state) {\n        state = state.append(\n        /* segment */ this, \n        /* value   */ '/');\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 2 /* dynamic */ &&\n            b.optional === this.optional &&\n            b.name === this.name);\n    }\n}\nclass StarSegment {\n    constructor(name) {\n        this.name = name;\n    }\n    get kind() { return 1 /* star */; }\n    appendTo(state) {\n        state = state.append(\n        /* segment */ this, \n        /* value   */ '');\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 1 /* star */ &&\n            b.name === this.name);\n    }\n}\n//# sourceMappingURL=index.js.map","import { ViewportInstruction } from './viewport-instruction';\nimport { Scope } from './scope';\nimport { arrayRemove } from './utils';\nexport class ViewportScope {\n    constructor(name, router, element, owningScope, scope, rootComponentType = null, // temporary. Metadata will probably eliminate it\n    options = {\n        catches: [],\n        source: null,\n    }) {\n        this.name = name;\n        this.router = router;\n        this.element = element;\n        this.rootComponentType = rootComponentType;\n        this.options = options;\n        this.path = null;\n        this.content = null;\n        this.nextContent = null;\n        this.available = true;\n        this.sourceItem = null;\n        this.sourceItemIndex = -1;\n        this.remove = false;\n        this.add = false;\n        this.connectedScope = new Scope(router, scope, owningScope, null, this);\n        if (this.catches.length > 0) {\n            this.content = router.createViewportInstruction(this.catches[0], this.name);\n        }\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return false;\n    }\n    get isViewportScope() {\n        return true;\n    }\n    get isEmpty() {\n        return this.content === null;\n    }\n    get passThroughScope() {\n        return this.rootComponentType === null && this.catches.length === 0;\n    }\n    get siblings() {\n        const parent = this.connectedScope.parent;\n        if (parent === null) {\n            return [this];\n        }\n        return parent.enabledChildren\n            .filter(child => child.isViewportScope && child.viewportScope.name === this.name)\n            .map(child => child.viewportScope);\n    }\n    get source() {\n        return this.options.source || null;\n    }\n    get catches() {\n        let catches = this.options.catches || [];\n        if (typeof catches === 'string') {\n            catches = catches.split(',');\n        }\n        return catches;\n    }\n    get default() {\n        if (this.catches.length > 0) {\n            return this.catches[0];\n        }\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = this.router.createViewportInstruction(content);\n            }\n        }\n        viewportInstruction.viewportScope = this;\n        this.remove = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction)\n            || this.router.instructionResolver.isClearAllViewportsInstruction(viewportInstruction);\n        this.add = this.router.instructionResolver.isAddViewportInstruction(viewportInstruction)\n            && Array.isArray(this.source);\n        if (this.add) {\n            viewportInstruction.componentName = null;\n        }\n        if (this.default !== void 0 && viewportInstruction.componentName === null) {\n            viewportInstruction.componentName = this.default;\n        }\n        this.nextContent = viewportInstruction;\n        return true;\n    }\n    canLeave() {\n        return Promise.resolve(true);\n    }\n    canEnter() {\n        return Promise.resolve(true);\n    }\n    enter() {\n        return Promise.resolve(true);\n    }\n    loadContent() {\n        this.content = !this.remove ? this.nextContent : null;\n        this.nextContent = null;\n        return Promise.resolve(true);\n    }\n    finalizeContentChange() {\n        // console.log('ViewportScope finalizing', this.content);\n        if (this.remove && Array.isArray(this.source)) {\n            this.removeSourceItem();\n        }\n    }\n    abortContentChange() {\n        this.nextContent = null;\n        if (this.add) {\n            const index = this.source.indexOf(this.sourceItem);\n            this.source.splice(index, 1);\n            this.sourceItem = null;\n        }\n        return Promise.resolve();\n    }\n    acceptSegment(segment) {\n        if (segment === null && segment === void 0 || segment.length === 0) {\n            return true;\n        }\n        if (segment === this.router.instructionResolver.clearViewportInstruction\n            || segment === this.router.instructionResolver.addViewportInstruction\n            || segment === this.name) {\n            return true;\n        }\n        if (this.catches.length === 0) {\n            return true;\n        }\n        if (this.catches.includes(segment)) {\n            return true;\n        }\n        if (this.catches.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind() {\n        const source = this.source || [];\n        if (source.length > 0 && this.sourceItem === null) {\n            this.sourceItem = this.getAvailableSourceItem();\n        }\n    }\n    beforeUnbind() {\n        if (this.sourceItem !== null && this.source !== null) {\n            arrayRemove(this.source, (item) => item === this.sourceItem);\n        }\n        this.sourceItem = null;\n    }\n    getAvailableSourceItem() {\n        if (this.source === null) {\n            return null;\n        }\n        const siblings = this.siblings;\n        for (const item of this.source) {\n            if (siblings.every(sibling => sibling.sourceItem !== item)) {\n                return item;\n            }\n        }\n        return null;\n    }\n    addSourceItem() {\n        const item = {};\n        this.source.push(item);\n        return item;\n    }\n    removeSourceItem() {\n        this.sourceItemIndex = this.source.indexOf(this.sourceItem);\n        if (this.sourceItemIndex >= 0) {\n            this.source.splice(this.sourceItemIndex, 1);\n        }\n    }\n    getRoutes() {\n        if (this.rootComponentType !== null) {\n            return this.rootComponentType.routes;\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=viewport-scope.js.map","/**\n * @internal - Used when founding route/instructions\n */\nexport class FoundRoute {\n    constructor(match = null, matching = '', instructions = [], remaining = '') {\n        this.match = match;\n        this.matching = matching;\n        this.instructions = instructions;\n        this.remaining = remaining;\n    }\n    get foundConfiguration() {\n        return this.match !== null;\n    }\n    get foundInstructions() {\n        return this.instructions.length > 0;\n    }\n    get hasRemaining() {\n        return this.remaining !== null && this.remaining.length > 0;\n    }\n}\n//# sourceMappingURL=found-route.js.map","import { arrayRemove } from './utils';\n/**\n * @internal - Helper class\n */\nexport class Collection extends Array {\n    constructor() {\n        super(...arguments);\n        this.currentIndex = -1;\n    }\n    next() {\n        if (this.length > this.currentIndex + 1) {\n            return this[++this.currentIndex];\n        }\n        else {\n            this.currentIndex = -1;\n            return null;\n        }\n    }\n    removeCurrent() {\n        this.splice(this.currentIndex--, 1);\n    }\n    remove(instruction) {\n        arrayRemove(this, value => value === instruction);\n    }\n}\n//# sourceMappingURL=collection.js.map","import { RouteRecognizer as $RouteRecognizer, ConfigurableRoute as $ConfigurableRoute, RecognizedRoute as $RecognizedRoute, Endpoint as $Endpoint, } from '@aurelia/route-recognizer';\nexport const RouteRecognizer = $RouteRecognizer;\nexport const ConfigurableRoute = $ConfigurableRoute;\nexport const RecognizedRoute = $RecognizedRoute;\nexport const Endpoint = $Endpoint;\n//# sourceMappingURL=route-recognizer.js.map","import { ViewportScope } from './viewport-scope';\nimport { FoundRoute } from './found-route';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { Viewport } from './viewport';\nimport { arrayRemove } from './utils';\nimport { Collection } from './collection';\nimport { RouteRecognizer } from './route-recognizer';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Scope {\n    constructor(router, hasScope, owningScope, viewport = null, viewportScope = null, rootComponentType = null) {\n        this.router = router;\n        this.hasScope = hasScope;\n        this.owningScope = owningScope;\n        this.viewport = viewport;\n        this.viewportScope = viewportScope;\n        this.rootComponentType = rootComponentType;\n        this.id = '.';\n        this.parent = null;\n        this.children = [];\n        this.replacedChildren = [];\n        this.path = null;\n        this.enabled = true;\n        // Support collection feature in viewport scopes\n        this.childCollections = {};\n        this.owningScope = owningScope || this;\n        this.scope = this.hasScope ? this : this.owningScope;\n    }\n    get isViewport() {\n        return this.viewport !== null;\n    }\n    get isViewportScope() {\n        return this.viewportScope !== null;\n    }\n    get passThroughScope() {\n        return this.isViewportScope && this.viewportScope.passThroughScope;\n    }\n    get owner() {\n        if (this.isViewport) {\n            return this.viewport;\n        }\n        if (this.isViewportScope) {\n            return this.viewportScope;\n        }\n        return null;\n    }\n    get enabledChildren() {\n        return this.children.filter(scope => scope.enabled);\n    }\n    get hoistedChildren() {\n        const scopes = this.enabledChildren;\n        while (scopes.some(scope => scope.passThroughScope)) {\n            for (const scope of scopes.slice()) {\n                if (scope.passThroughScope) {\n                    const index = scopes.indexOf(scope);\n                    scopes.splice(index, 1, ...scope.enabledChildren);\n                }\n            }\n        }\n        return scopes;\n    }\n    get enabledViewports() {\n        return this.children.filter(scope => scope.isViewport && scope.enabled)\n            .map(scope => scope.viewport);\n    }\n    get viewportInstruction() {\n        if (this.isViewportScope) {\n            return this.viewportScope.content;\n        }\n        if (this.isViewport) {\n            return this.viewport.content.content;\n        }\n        return null;\n    }\n    getEnabledViewports(viewportScopes) {\n        return viewportScopes.filter(scope => !scope.isViewportScope).map(scope => scope.viewport).reduce((viewports, viewport) => {\n            viewports[viewport.name] = viewport;\n            return viewports;\n        }, {});\n    }\n    getOwnedViewports(includeDisabled = false) {\n        return this.allViewports(includeDisabled).filter(viewport => viewport.owningScope === this);\n    }\n    getOwnedScopes(includeDisabled = false) {\n        const scopes = this.allScopes(includeDisabled).filter(scope => scope.owningScope === this);\n        // Hoist children to pass through scopes\n        for (const scope of scopes.slice()) {\n            if (scope.passThroughScope) {\n                const index = scopes.indexOf(scope);\n                scopes.splice(index, 1, ...scope.getOwnedScopes());\n            }\n        }\n        return scopes;\n    }\n    // Note: This can't change state other than the instructions!\n    findViewports(instructions, alreadyFound, disregardViewports = false) {\n        const foundViewports = [];\n        let remainingInstructions = [];\n        const ownedScopes = this.getOwnedScopes();\n        // Get a shallow copy of all available manual viewport scopes\n        const viewportScopes = ownedScopes.filter(scope => scope.isViewportScope).map(scope => scope.viewportScope);\n        const availableViewportScopes = viewportScopes.filter(viewportScope => alreadyFound.every(found => found.viewportScope !== viewportScope));\n        // Get a shallow copy of all available viewports\n        const availableViewports = { ...this.getEnabledViewports(ownedScopes) };\n        for (const instruction of alreadyFound.filter(found => found.scope === this)) {\n            availableViewports[instruction.viewportName] = null;\n        }\n        const viewportInstructions = new Collection(...instructions.slice());\n        let instruction = null;\n        // The viewport scope is already known\n        while ((instruction = viewportInstructions.next()) !== null) {\n            if (instruction.viewportScope !== null && !this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                remainingInstructions.push(...this.foundViewportScope(instruction, instruction.viewportScope));\n                foundViewports.push(instruction);\n                arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // The viewport is already known\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                if (instruction.viewport) {\n                    remainingInstructions.push(...this.foundViewport(instruction, instruction.viewport, disregardViewports));\n                    foundViewports.push(instruction);\n                    availableViewports[instruction.viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Viewport scopes have priority\n        while ((instruction = viewportInstructions.next()) !== null) {\n            for (let viewportScope of viewportScopes) {\n                if (viewportScope.acceptSegment(instruction.componentName)) {\n                    if (Array.isArray(viewportScope.source)) {\n                        // console.log('available', viewportScope.available, source);\n                        let available = availableViewportScopes.find(available => available.name === viewportScope.name);\n                        if (available === void 0 || this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                            const item = viewportScope.addSourceItem();\n                            available = this.getOwnedScopes()\n                                .filter(scope => scope.isViewportScope)\n                                .map(scope => scope.viewportScope)\n                                .find(viewportScope => viewportScope.sourceItem === item);\n                        }\n                        viewportScope = available;\n                    }\n                    remainingInstructions.push(...this.foundViewportScope(instruction, viewportScope));\n                    foundViewports.push(instruction);\n                    arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                    viewportInstructions.removeCurrent();\n                    break;\n                }\n            }\n        }\n        // Configured viewport is ruling\n        while ((instruction = viewportInstructions.next()) !== null) {\n            instruction.needsViewportDescribed = true;\n            for (const name in availableViewports) {\n                if (Object.prototype.hasOwnProperty.call(availableViewports, name)) {\n                    const viewport = availableViewports[name];\n                    // TODO: Also check if (resolved) component wants a specific viewport\n                    if (viewport && viewport.wantComponent(instruction.componentName)) {\n                        const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                        foundViewports.push(instruction);\n                        remainingInstructions.push(...remaining);\n                        availableViewports[name] = null;\n                        viewportInstructions.removeCurrent();\n                        break;\n                    }\n                }\n            }\n        }\n        // Next in line is specified viewport (but not if we're disregarding viewports)\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                const name = instruction.viewportName;\n                if (!name || !name.length) {\n                    continue;\n                }\n                const newScope = instruction.ownsScope;\n                if (!this.getEnabledViewports(ownedScopes)[name]) {\n                    continue;\n                    // TODO: No longer pre-creating viewports. Evaluate!\n                    this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                    availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                }\n                const viewport = availableViewports[name];\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Finally, only one accepting viewport left?\n        while ((instruction = viewportInstructions.next()) !== null) {\n            const remainingViewports = [];\n            for (const name in availableViewports) {\n                if (Object.prototype.hasOwnProperty.call(availableViewports, name)) {\n                    const viewport = availableViewports[name];\n                    if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                        remainingViewports.push(viewport);\n                    }\n                }\n            }\n            if (remainingViewports.length === 1) {\n                const viewport = remainingViewports.shift();\n                const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                foundViewports.push(instruction);\n                remainingInstructions.push(...remaining);\n                availableViewports[viewport.name] = null;\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // If we're ignoring viewports, we now match them anyway\n        if (disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                let viewport = instruction.viewport;\n                if (!viewport) {\n                    const name = instruction.viewportName;\n                    if (!name || !name.length) {\n                        continue;\n                    }\n                    const newScope = instruction.ownsScope;\n                    if (!this.getEnabledViewports(ownedScopes)[name]) {\n                        continue;\n                        // TODO: No longer pre-creating viewports. Evaluate!\n                        this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                        availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                    }\n                    viewport = availableViewports[name];\n                }\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        remainingInstructions = [...viewportInstructions, ...remainingInstructions];\n        return {\n            foundViewports,\n            remainingInstructions,\n        };\n    }\n    foundViewportScope(instruction, viewportScope) {\n        instruction.viewportScope = viewportScope;\n        instruction.needsViewportDescribed = false;\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewportScope.scope.scope;\n            }\n        }\n        return remaining;\n    }\n    foundViewport(instruction, viewport, withoutViewports, doesntNeedViewportDescribed = false) {\n        instruction.setViewport(viewport);\n        if (doesntNeedViewportDescribed) {\n            instruction.needsViewportDescribed = false;\n        }\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewport.scope;\n            }\n        }\n        return remaining;\n    }\n    addViewport(name, element, container, options = {}) {\n        let viewport = this.getEnabledViewports(this.getOwnedScopes())[name];\n        // Each au-viewport element has its own Viewport\n        if (element && viewport && viewport.element !== null && viewport.element !== element) {\n            viewport.enabled = false;\n            viewport = this.getOwnedViewports(true).find(child => child.name === name && child.element === element) || null;\n            if (viewport) {\n                viewport.enabled = true;\n            }\n        }\n        if (!viewport) {\n            viewport = new Viewport(this.router, name, null, null, this.scope, !!options.scope, options);\n            this.addChild(viewport.connectedScope);\n        }\n        // TODO: Either explain why || instead of && here (might only need one) or change it to && if that should turn out to not be relevant\n        if (element || container) {\n            viewport.setElement(element, container, options);\n        }\n        return viewport;\n    }\n    removeViewport(viewport, element, container) {\n        if ((!element && !container) || viewport.remove(element, container)) {\n            this.removeChild(viewport.connectedScope);\n            return true;\n        }\n        return false;\n    }\n    addViewportScope(name, element, options = {}) {\n        const viewportScope = new ViewportScope(name, this.router, element, this.scope, true, null, options);\n        this.addChild(viewportScope.connectedScope);\n        return viewportScope;\n    }\n    removeViewportScope(viewportScope) {\n        // viewportScope.remove();\n        this.removeChild(viewportScope.connectedScope);\n        return true;\n    }\n    addChild(scope) {\n        if (!this.children.some(vp => vp === scope)) {\n            if (scope.parent !== null) {\n                scope.parent.removeChild(scope);\n            }\n            this.children.push(scope);\n            scope.parent = this;\n        }\n    }\n    removeChild(scope) {\n        const index = this.children.indexOf(scope);\n        if (index >= 0) {\n            this.children.splice(index, 1);\n            scope.parent = null;\n        }\n    }\n    clearReplacedChildren() {\n        this.replacedChildren = [];\n    }\n    disableReplacedChildren() {\n        this.replacedChildren = this.enabledChildren;\n        for (const scope of this.replacedChildren) {\n            scope.enabled = false;\n        }\n    }\n    reenableReplacedChildren() {\n        for (const scope of this.replacedChildren) {\n            scope.enabled = true;\n        }\n    }\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        return this.allScopes(includeDisabled, includeReplaced).filter(scope => scope.isViewport).map(scope => scope.viewport);\n    }\n    allScopes(includeDisabled = false, includeReplaced = false) {\n        const scopes = includeDisabled ? this.children.slice() : this.enabledChildren;\n        for (const scope of scopes.slice()) {\n            scopes.push(...scope.allScopes(includeDisabled, includeReplaced));\n        }\n        return scopes;\n    }\n    reparentViewportInstructions() {\n        const scopes = this.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && scope.viewportInstruction.componentName);\n        if (!scopes.length) {\n            return null;\n        }\n        for (const scope of scopes) {\n            const childInstructions = scope.reparentViewportInstructions();\n            scope.viewportInstruction.nextScopeInstructions =\n                childInstructions !== null && childInstructions.length > 0 ? childInstructions : null;\n        }\n        return scopes.map(scope => scope.viewportInstruction);\n    }\n    findMatchingRoute(path) {\n        if (this.isViewportScope && !this.passThroughScope) {\n            return this.findMatchingRouteInRoutes(path, this.viewportScope.getRoutes());\n        }\n        if (this.isViewport) {\n            return this.findMatchingRouteInRoutes(path, this.viewport.getRoutes());\n        }\n        // TODO: Match specified names here\n        for (const child of this.enabledChildren) {\n            const found = child.findMatchingRoute(path);\n            if (found !== null) {\n                return found;\n            }\n        }\n        return null;\n    }\n    async canLeave() {\n        const results = await Promise.all(this.children.map(child => child.viewport !== null\n            ? child.viewport.canLeave()\n            : child.canLeave()));\n        return !results.some(result => result === false);\n    }\n    findMatchingRouteInRoutes(path, routes) {\n        if (!Array.isArray(routes)) {\n            return null;\n        }\n        routes = routes.map(route => this.ensureProperRoute(route));\n        const cRoutes = routes.map(route => ({\n            path: route.path,\n            handler: route,\n        }));\n        for (let i = 0, ii = cRoutes.length; i < ii; ++i) {\n            const cRoute = cRoutes[i];\n            cRoutes.push({\n                ...cRoute,\n                path: `${cRoute.path}/*remainingPath`,\n            });\n        }\n        const found = new FoundRoute();\n        let params = {};\n        if (path.startsWith('/') || path.startsWith('+')) {\n            path = path.slice(1);\n        }\n        const recognizer = new RouteRecognizer();\n        recognizer.add(cRoutes);\n        const result = recognizer.recognize(path);\n        if (result !== null) {\n            found.match = result.endpoint.route.handler;\n            found.matching = path;\n            const $params = { ...result.params };\n            if ($params.remainingPath !== void 0) {\n                found.remaining = $params.remainingPath;\n                Reflect.deleteProperty($params, 'remainingPath');\n                found.matching = found.matching.slice(0, found.matching.indexOf(found.remaining));\n            }\n            params = $params;\n        }\n        if (found.foundConfiguration) {\n            // clone it so config doesn't get modified\n            found.instructions = this.router.instructionResolver.cloneViewportInstructions(found.match.instructions, false, true);\n            const instructions = found.instructions.slice();\n            while (instructions.length > 0) {\n                const instruction = instructions.shift();\n                instruction.addParameters(params);\n                instruction.route = '';\n                if (instruction.nextScopeInstructions !== null) {\n                    instructions.unshift(...instruction.nextScopeInstructions);\n                }\n            }\n            if (found.instructions.length > 0) {\n                found.instructions[0].route = found.matching;\n            }\n        }\n        return found;\n    }\n    ensureProperRoute(route) {\n        if (route.id === void 0) {\n            route.id = route.path;\n        }\n        route.instructions = NavigationInstructionResolver.toViewportInstructions(this.router, route.instructions);\n        return route;\n    }\n}\n//# sourceMappingURL=scope.js.map","import { Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '@aurelia/runtime';\nimport { arrayRemove } from './utils';\nimport { ViewportContent } from './viewport-content';\nimport { ViewportInstruction } from './viewport-instruction';\nimport { Scope } from './scope';\nexport class Viewport {\n    constructor(router, name, element, container, owningScope, scope, options = {}) {\n        this.router = router;\n        this.name = name;\n        this.element = element;\n        this.container = container;\n        this.options = options;\n        this.nextContent = null;\n        this.forceRemove = false;\n        this.path = null;\n        this.clear = false;\n        this.elementResolve = null;\n        this.previousViewportState = null;\n        this.cache = [];\n        this.historyCache = [];\n        this.content = new ViewportContent();\n        this.connectedScope = new Scope(router, scope, owningScope, this);\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return true;\n    }\n    get isViewportScope() {\n        return false;\n    }\n    get isEmpty() {\n        return this.content.componentInstance === null;\n    }\n    get doForceRemove() {\n        let scope = this.connectedScope;\n        while (scope !== null) {\n            if (scope.viewport !== null && scope.viewport.forceRemove) {\n                return true;\n            }\n            scope = scope.parent;\n        }\n        return false;\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = this.router.createViewportInstruction(content);\n            }\n        }\n        viewportInstruction.setViewport(this);\n        this.clear = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction);\n        // Can have a (resolved) type or a string (to be resolved later)\n        this.nextContent = new ViewportContent(!this.clear ? viewportInstruction : void 0, instruction, this.container);\n        this.nextContent.fromHistory = this.nextContent.componentInstance && instruction.navigation\n            ? !!instruction.navigation.back || !!instruction.navigation.forward\n            : false;\n        if (this.options.stateful) {\n            // TODO: Add a parameter here to decide required equality\n            const cached = this.cache.find((item) => this.nextContent.isCacheEqual(item));\n            if (cached) {\n                this.nextContent = cached;\n                this.nextContent.fromCache = true;\n            }\n            else {\n                this.cache.push(this.nextContent);\n            }\n        }\n        // Children that will be replaced (unless added again) by next content. Will\n        // be re-enabled on cancel\n        this.connectedScope.clearReplacedChildren();\n        // If we get the same _instance_, don't do anything (happens with cached and history)\n        if (this.nextContent.componentInstance !== null && this.content.componentInstance === this.nextContent.componentInstance) {\n            this.nextContent = null;\n            return false;\n        }\n        // ReentryBehavior 'refresh' takes precedence\n        if (!this.content.equalComponent(this.nextContent) ||\n            instruction.navigation.refresh ||\n            this.content.reentryBehavior() === \"refresh\" /* refresh */) {\n            this.connectedScope.disableReplacedChildren();\n            return true;\n        }\n        // Explicitly don't allow navigation back to the same component again\n        if (this.content.reentryBehavior() === \"disallow\" /* disallow */) {\n            this.nextContent = null;\n            return false;\n        }\n        // Explicitly re-enter same component again\n        if (this.content.reentryBehavior() === \"enter\" /* enter */) {\n            this.content.reentry = true;\n            this.nextContent.content.setComponent(this.content.componentInstance);\n            this.nextContent.contentStatus = this.content.contentStatus;\n            this.nextContent.reentry = this.content.reentry;\n            return true;\n        }\n        // ReentryBehavior is now 'default'\n        // Requires updated parameters if viewport stateful\n        if (this.options.stateful &&\n            this.content.equalParameters(this.nextContent)) {\n            this.nextContent = null;\n            return false;\n        }\n        // Default is to trigger a refresh (without a check of parameters)\n        this.connectedScope.disableReplacedChildren();\n        return true;\n    }\n    setElement(element, container, options) {\n        options = options || {};\n        if (this.element !== element) {\n            // TODO: Restore this state on navigation cancel\n            this.previousViewportState = { ...this };\n            this.clearState();\n            this.element = element;\n            if (options.usedBy) {\n                this.options.usedBy = options.usedBy;\n            }\n            if (options.default) {\n                this.options.default = options.default;\n            }\n            if (options.fallback) {\n                this.options.fallback = options.fallback;\n            }\n            if (options.noLink) {\n                this.options.noLink = options.noLink;\n            }\n            if (options.noHistory) {\n                this.options.noHistory = options.noHistory;\n            }\n            if (options.stateful) {\n                this.options.stateful = options.stateful;\n            }\n            if (this.elementResolve) {\n                this.elementResolve();\n            }\n        }\n        // TODO: Might not need this? Figure it out\n        // if (container) {\n        //   container['viewportName'] = this.name;\n        // }\n        if (this.container !== container) {\n            this.container = container;\n        }\n        if (!this.content.componentInstance && (!this.nextContent || !this.nextContent.componentInstance) && this.options.default) {\n            const instructions = this.router.instructionResolver.parseViewportInstructions(this.options.default);\n            for (const instruction of instructions) {\n                // Set to name to be delayed one turn\n                instruction.setViewport(this.name);\n                instruction.scope = this.owningScope;\n                instruction.default = true;\n            }\n            this.router.goto(instructions, { append: true }).catch(error => { throw error; });\n        }\n    }\n    async remove(element, container) {\n        if (this.element === element && this.container === container) {\n            if (this.content.componentInstance) {\n                await this.content.freeContent(this.element, (this.nextContent ? this.nextContent.instruction : null), this.historyCache, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful); // .catch(error => { throw error; });\n            }\n            if (this.doForceRemove) {\n                await Promise.all(this.historyCache.map(content => content.freeContent(null, null, this.historyCache, false)));\n                this.historyCache = [];\n            }\n            return true;\n        }\n        return false;\n    }\n    async canLeave() {\n        const canLeaveChildren = await this.connectedScope.canLeave();\n        if (!canLeaveChildren) {\n            return false;\n        }\n        return this.content.canLeave(this.nextContent ? this.nextContent.instruction : null);\n    }\n    async canEnter() {\n        if (this.clear) {\n            return true;\n        }\n        if ((this.nextContent.content || null) === null) {\n            return false;\n        }\n        await this.waitForElement();\n        this.nextContent.createComponent(this.container, this.options.fallback);\n        await this.nextContent.loadComponent(this.container, this.element, this);\n        return this.nextContent.canEnter(this, this.content.instruction);\n    }\n    async enter() {\n        Reporter.write(10000, 'Viewport enter', this.name);\n        if (this.clear) {\n            return true;\n        }\n        if (!this.nextContent || !this.nextContent.componentInstance) {\n            return false;\n        }\n        await this.nextContent.enter(this.content.instruction);\n        // await this.nextContent.loadComponent(this.container as IContainer, this.element as Element, this);\n        this.nextContent.initializeComponent(CustomElement.for(this.element));\n        return true;\n    }\n    async loadContent() {\n        Reporter.write(10000, 'Viewport loadContent', this.name);\n        // No need to wait for next component activation\n        if (this.content.componentInstance && !this.nextContent.componentInstance) {\n            await this.content.leave(this.nextContent.instruction);\n            await this.unloadContent();\n        }\n        if (this.nextContent.componentInstance) {\n            if (this.content.componentInstance !== this.nextContent.componentInstance) {\n                this.nextContent.addComponent(this.element);\n            }\n            else {\n                this.connectedScope.reenableReplacedChildren();\n            }\n            // Only when next component activation is done\n            if (this.content.componentInstance) {\n                await this.content.leave(this.nextContent.instruction);\n                if (!this.content.reentry && this.content.componentInstance !== this.nextContent.componentInstance) {\n                    await this.unloadContent();\n                }\n            }\n            this.content = this.nextContent;\n            this.content.reentry = false;\n        }\n        if (this.clear) {\n            this.content = new ViewportContent(void 0, this.nextContent.instruction);\n        }\n        this.nextContent = null;\n        return true;\n    }\n    finalizeContentChange() {\n        this.previousViewportState = null;\n        this.connectedScope.clearReplacedChildren();\n    }\n    async abortContentChange() {\n        this.connectedScope.reenableReplacedChildren();\n        await this.nextContent.freeContent(this.element, this.nextContent.instruction, this.historyCache, this.router.statefulHistory || this.options.stateful);\n        if (this.previousViewportState) {\n            Object.assign(this, this.previousViewportState);\n        }\n    }\n    // TODO: Deal with non-string components\n    wantComponent(component) {\n        let usedBy = this.options.usedBy || [];\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        return usedBy.includes(component);\n    }\n    // TODO: Deal with non-string components\n    acceptComponent(component) {\n        if (component === '-' || component === null) {\n            return true;\n        }\n        let usedBy = this.options.usedBy;\n        if (!usedBy || !usedBy.length) {\n            return true;\n        }\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        if (usedBy.includes(component)) {\n            return true;\n        }\n        if (usedBy.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind(flags) {\n        if (this.content.componentInstance) {\n            this.content.initializeComponent(CustomElement.for(this.element));\n        }\n    }\n    async beforeAttach(flags) {\n        this.enabled = true;\n        if (this.content.componentInstance) {\n            // Only acts if not already entered\n            await this.content.enter(this.content.instruction);\n            this.content.addComponent(this.element);\n        }\n    }\n    async beforeDetach(flags) {\n        if (this.content.componentInstance) {\n            // Only acts if not already left\n            await this.content.leave(this.content.instruction);\n            this.content.removeComponent(this.element, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n        this.enabled = false;\n    }\n    async beforeUnbind(flags) {\n        if (this.content.componentInstance) {\n            await this.content.terminateComponent(this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n    }\n    async freeContent(component) {\n        const content = this.historyCache.find(cached => cached.componentInstance === component);\n        if (content !== void 0) {\n            this.forceRemove = true;\n            await content.freeContent(null, null, this.historyCache, false);\n            this.forceRemove = false;\n            arrayRemove(this.historyCache, (cached => cached === content));\n        }\n    }\n    getRoutes() {\n        let componentType = this.nextContent !== null\n            && this.nextContent.content !== null\n            ? this.nextContent.content.componentType\n            : this.content.content.componentType;\n        // TODO: This is going away once Metadata is in!\n        if (componentType === null || componentType === void 0) {\n            const controller = CustomElement.for(this.element);\n            componentType = controller.context.componentType;\n        }\n        if (componentType === null || componentType === void 0) {\n            return null;\n        }\n        const routes = componentType.routes;\n        return Array.isArray(routes) ? routes : null;\n    }\n    async unloadContent() {\n        this.content.removeComponent(this.element, this.router.statefulHistory || this.options.stateful);\n        await this.content.terminateComponent(this.router.statefulHistory || this.options.stateful);\n        this.content.unloadComponent(this.historyCache, this.router.statefulHistory || this.options.stateful);\n        this.content.destroyComponent();\n    }\n    clearState() {\n        this.options = {};\n        this.content = new ViewportContent();\n        this.cache = [];\n    }\n    async waitForElement() {\n        if (this.element) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n            this.elementResolve = resolve;\n        });\n    }\n}\n//# sourceMappingURL=viewport.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nexport const ComponentAppellationResolver = {\n    isName: function (component) {\n        return typeof component === 'string';\n    },\n    isType: function (component) {\n        return CustomElement.isType(component);\n    },\n    isInstance: function (component) {\n        return !ComponentAppellationResolver.isName(component) && !ComponentAppellationResolver.isType(component);\n    },\n    getName: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return component;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return CustomElement.getDefinition(component).name;\n        }\n        else {\n            return ComponentAppellationResolver.getName(component.constructor);\n        }\n    },\n    getType: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return component;\n        }\n        else {\n            return component.constructor;\n        }\n    },\n    getInstance: function (component) {\n        if (ComponentAppellationResolver.isName(component) || ComponentAppellationResolver.isType(component)) {\n            return null;\n        }\n        else {\n            return component;\n        }\n    },\n};\nexport const ViewportHandleResolver = {\n    isName: function (viewport) {\n        return typeof viewport === 'string';\n    },\n    isInstance: function (viewport) {\n        return viewport instanceof Viewport;\n    },\n    getName: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return viewport;\n        }\n        else {\n            return viewport ? (viewport).name : null;\n        }\n    },\n    getInstance: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return null;\n        }\n        else {\n            return viewport;\n        }\n    },\n};\nexport const NavigationInstructionResolver = {\n    createViewportInstructions: function (router, navigationInstructions, options) {\n        options = options || {};\n        let scope = null;\n        if (options.context) {\n            scope = router.findScope(options.context);\n            if (typeof navigationInstructions === 'string') {\n                // If it's not from scope root, figure out which scope\n                if (!navigationInstructions.startsWith('/')) {\n                    // Scope modifications\n                    if (navigationInstructions.startsWith('.')) {\n                        // The same as no scope modification\n                        if (navigationInstructions.startsWith('./')) {\n                            navigationInstructions = navigationInstructions.slice(2);\n                        }\n                        // Find out how many scopes upwards we should move\n                        while (navigationInstructions.startsWith('../')) {\n                            scope = scope.parent || scope;\n                            navigationInstructions = navigationInstructions.slice(3);\n                        }\n                    }\n                    if (scope.path !== null) {\n                        navigationInstructions = `${scope.path}/${navigationInstructions}`;\n                        scope = router.rootScope.scope;\n                    }\n                }\n                else { // Specified root scope with /\n                    scope = router.rootScope.scope;\n                }\n            }\n            else {\n                navigationInstructions = NavigationInstructionResolver.toViewportInstructions(router, navigationInstructions);\n                for (const instruction of navigationInstructions) {\n                    if (instruction.scope === null) {\n                        instruction.scope = scope;\n                    }\n                }\n            }\n        }\n        return {\n            instructions: navigationInstructions,\n            scope,\n        };\n    },\n    toViewportInstructions: function (router, navigationInstructions) {\n        if (!Array.isArray(navigationInstructions)) {\n            return NavigationInstructionResolver.toViewportInstructions(router, [navigationInstructions]);\n        }\n        const instructions = [];\n        for (const instruction of navigationInstructions) {\n            if (typeof instruction === 'string') {\n                instructions.push(...router.instructionResolver.parseViewportInstructions(instruction));\n            }\n            else if (instruction instanceof ViewportInstruction) {\n                instructions.push(instruction);\n            }\n            else if (instruction.component) {\n                const viewportComponent = instruction;\n                const newInstruction = router.createViewportInstruction(viewportComponent.component, viewportComponent.viewport, viewportComponent.parameters);\n                if (viewportComponent.children !== void 0 && viewportComponent.children !== null) {\n                    newInstruction.nextScopeInstructions = NavigationInstructionResolver.toViewportInstructions(router, viewportComponent.children);\n                }\n                instructions.push(newInstruction);\n            }\n            else {\n                instructions.push(router.createViewportInstruction(instruction));\n            }\n        }\n        return instructions;\n    },\n};\n//# sourceMappingURL=type-resolvers.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { ComponentAppellationResolver } from './type-resolvers';\n/**\n * @internal - Shouldn't be used directly\n */\nexport var ParametersType;\n(function (ParametersType) {\n    ParametersType[\"none\"] = \"none\";\n    ParametersType[\"string\"] = \"string\";\n    ParametersType[\"array\"] = \"array\";\n    ParametersType[\"object\"] = \"object\";\n})(ParametersType || (ParametersType = {}));\n/**\n * Public API - The viewport instructions are the core of the router's navigations\n */\nexport class ViewportInstruction {\n    constructor(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        this.ownsScope = ownsScope;\n        this.nextScopeInstructions = nextScopeInstructions;\n        this.componentName = null;\n        this.componentType = null;\n        this.componentInstance = null;\n        this.viewportName = null;\n        this.viewport = null;\n        this.parametersString = null;\n        this.parametersRecord = null;\n        this.parametersList = null;\n        this.parametersType = \"none\" /* none */;\n        this.scope = null;\n        this.context = '';\n        this.viewportScope = null;\n        this.needsViewportDescribed = false;\n        this.route = null;\n        this.default = false;\n        this.instructionResolver = null;\n        this.setComponent(component);\n        this.setViewport(viewport);\n        this.setParameters(parameters);\n    }\n    get owner() {\n        return this.viewport || this.viewportScope || null;\n    }\n    get typedParameters() {\n        switch (this.parametersType) {\n            case \"string\" /* string */:\n                return this.parametersString;\n            case \"array\" /* array */:\n                return this.parametersList;\n            case \"object\" /* object */:\n                return this.parametersRecord;\n            default:\n                return null;\n        }\n    }\n    get parameters() {\n        if (this.instructionResolver !== null) {\n            return this.instructionResolver.parseComponentParameters(this.typedParameters);\n        }\n        return [];\n    }\n    get normalizedParameters() {\n        if (this.instructionResolver !== null && this.typedParameters !== null) {\n            return this.instructionResolver.stringifyComponentParameters(this.parameters);\n        }\n        return '';\n    }\n    setComponent(component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = null;\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isInstance(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = ComponentAppellationResolver.getInstance(component);\n        }\n    }\n    setViewport(viewport) {\n        if (viewport === undefined || viewport === '') {\n            viewport = null;\n        }\n        if (typeof viewport === 'string') {\n            this.viewportName = viewport;\n            this.viewport = null;\n        }\n        else {\n            this.viewport = viewport;\n            if (viewport !== null) {\n                this.viewportName = viewport.name;\n                this.scope = viewport.owningScope;\n            }\n        }\n    }\n    setParameters(parameters) {\n        if (parameters === undefined || parameters === null || parameters === '') {\n            this.parametersType = \"none\" /* none */;\n            parameters = null;\n        }\n        else if (typeof parameters === 'string') {\n            this.parametersType = \"string\" /* string */;\n            this.parametersString = parameters;\n        }\n        else if (Array.isArray(parameters)) {\n            this.parametersType = \"array\" /* array */;\n            this.parametersList = parameters;\n        }\n        else {\n            this.parametersType = \"object\" /* object */;\n            this.parametersRecord = parameters;\n        }\n    }\n    // This only works with objects added to objects!\n    addParameters(parameters) {\n        if (this.parametersType === \"none\" /* none */) {\n            return this.setParameters(parameters);\n        }\n        if (this.parametersType !== \"object\" /* object */) {\n            throw new Error('Can\\'t add object parameters to existing non-object parameters!');\n        }\n        this.setParameters({ ...this.parametersRecord, ...parameters });\n    }\n    setInstructionResolver(instructionResolver) {\n        this.instructionResolver = instructionResolver;\n    }\n    isEmpty() {\n        return !this.isComponentName() && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentName() {\n        return !!this.componentName && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentType() {\n        return this.componentType !== null && !this.isComponentInstance();\n    }\n    isComponentInstance() {\n        return this.componentInstance !== null;\n    }\n    toComponentType(container) {\n        if (this.componentType !== null) {\n            return this.componentType;\n        }\n        if (this.componentName !== null\n            && typeof this.componentName === 'string'\n            && container !== null\n            && container.has(CustomElement.keyFrom(this.componentName), true)) {\n            const resolver = container.getResolver(CustomElement.keyFrom(this.componentName));\n            if (resolver !== null && resolver.getFactory !== void 0) {\n                const factory = resolver.getFactory(container);\n                if (factory) {\n                    return factory.Type;\n                }\n            }\n        }\n        return null;\n    }\n    toComponentInstance(container) {\n        if (this.componentInstance !== null) {\n            return this.componentInstance;\n        }\n        if (container !== void 0 && container !== null) {\n            if (this.isComponentType()) {\n                return container.get(this.componentType);\n            }\n            else {\n                return container.get(CustomElement.keyFrom(this.componentName));\n            }\n        }\n        return null;\n    }\n    toViewportInstance(router) {\n        if (this.viewport !== null) {\n            return this.viewport;\n        }\n        return router.getViewport(this.viewportName);\n    }\n    toSpecifiedParameters(specifications) {\n        specifications = specifications || [];\n        const parameters = this.parameters;\n        const specified = {};\n        for (const spec of specifications) {\n            // First get named if it exists\n            let index = parameters.findIndex(param => param.key === spec);\n            if (index >= 0) {\n                const [parameter] = parameters.splice(index, 1);\n                specified[spec] = parameter.value;\n            }\n            else {\n                // Otherwise get first unnamed\n                index = parameters.findIndex(param => param.key === void 0);\n                if (index >= 0) {\n                    const [parameter] = parameters.splice(index, 1);\n                    specified[spec] = parameter.value;\n                }\n            }\n        }\n        // Add all remaining named\n        for (const parameter of parameters.filter(param => param.key !== void 0)) {\n            specified[parameter.key] = parameter.value;\n        }\n        let index = specifications.length;\n        // Add all remaining unnamed...\n        for (const parameter of parameters.filter(param => param.key === void 0)) {\n            // ..with an index\n            specified[index++] = parameter.value;\n        }\n        return specified;\n    }\n    toSortedParameters(specifications) {\n        specifications = specifications || [];\n        const parameters = this.parameters;\n        const sorted = [];\n        for (const spec of specifications) {\n            // First get named if it exists\n            let index = parameters.findIndex(param => param.key === spec);\n            if (index >= 0) {\n                const parameter = { ...parameters.splice(index, 1)[0] };\n                parameter.key = void 0;\n                sorted.push(parameter);\n            }\n            else {\n                // Otherwise get first unnamed\n                index = parameters.findIndex(param => param.key === void 0);\n                if (index >= 0) {\n                    const parameter = { ...parameters.splice(index, 1)[0] };\n                    sorted.push(parameter);\n                }\n                else {\n                    // Or an empty\n                    sorted.push({ value: void 0 });\n                }\n            }\n        }\n        // Add all remaining named\n        const params = parameters.filter(param => param.key !== void 0);\n        params.sort((a, b) => (a.key || '') < (b.key || '') ? 1 : (b.key || '') < (a.key || '') ? -1 : 0);\n        sorted.push(...params);\n        // Add all remaining unnamed...\n        sorted.push(...parameters.filter(param => param.key === void 0));\n        return sorted;\n    }\n    sameComponent(other, compareParameters = false, compareType = false) {\n        if (compareParameters && !this.sameParameters(other, compareType)) {\n            return false;\n        }\n        return compareType ? this.componentType === other.componentType : this.componentName === other.componentName;\n    }\n    // TODO: Somewhere we need to check for format such as spaces etc\n    sameParameters(other, compareType = false) {\n        if (!this.sameComponent(other, false, compareType)) {\n            return false;\n        }\n        const typeParameters = this.componentType ? this.componentType.parameters : [];\n        const mine = this.toSpecifiedParameters(typeParameters);\n        const others = other.toSpecifiedParameters(typeParameters);\n        return Object.keys(mine).every(key => mine[key] === others[key])\n            && Object.keys(others).every(key => others[key] === mine[key]);\n    }\n    sameViewport(other) {\n        if (this.viewport !== null && other.viewport !== null) {\n            return this.viewport === other.viewport;\n        }\n        return this.scope === other.scope &&\n            (this.viewport ? this.viewport.name : this.viewportName) === (other.viewport ? other.viewport.name : other.viewportName);\n    }\n}\n//# sourceMappingURL=viewport-instruction.js.map","export var ReentryBehavior;\n(function (ReentryBehavior) {\n    ReentryBehavior[\"default\"] = \"default\";\n    ReentryBehavior[\"disallow\"] = \"disallow\";\n    ReentryBehavior[\"enter\"] = \"enter\";\n    ReentryBehavior[\"refresh\"] = \"refresh\";\n})(ReentryBehavior || (ReentryBehavior = {}));\n//# sourceMappingURL=interfaces.js.map","import { Hook } from './hook';\n/**\n * Public API\n */\nexport var HookTypes;\n(function (HookTypes) {\n    HookTypes[\"BeforeNavigation\"] = \"beforeNavigation\";\n    HookTypes[\"TransformFromUrl\"] = \"transformFromUrl\";\n    HookTypes[\"TransformToUrl\"] = \"transformToUrl\";\n})(HookTypes || (HookTypes = {}));\n/**\n * @internal - Shouldn't be used directly\n */\nexport class HookManager {\n    constructor() {\n        this.hooks = {\n            beforeNavigation: [],\n            transformFromUrl: [],\n            transformToUrl: [],\n        };\n        this.lastIdentity = 0;\n    }\n    addHook(hookFunction, options) {\n        const hook = new Hook(hookFunction, options || {}, ++this.lastIdentity);\n        this.hooks[hook.type].push(hook);\n        return this.lastIdentity;\n    }\n    removeHook(id) {\n        for (const type in this.hooks) {\n            if (Object.prototype.hasOwnProperty.call(this.hooks, type)) {\n                const index = this.hooks[type].findIndex(hook => hook.id === id);\n                if (index >= 0) {\n                    this.hooks[type].splice(index, 1);\n                }\n            }\n        }\n    }\n    invokeBeforeNavigation(viewportInstructions, navigationInstruction) {\n        return this.invoke(\"beforeNavigation\" /* BeforeNavigation */, navigationInstruction, viewportInstructions);\n    }\n    invokeTransformFromUrl(url, navigationInstruction) {\n        return this.invoke(\"transformFromUrl\" /* TransformFromUrl */, navigationInstruction, url);\n    }\n    invokeTransformToUrl(state, navigationInstruction) {\n        return this.invoke(\"transformToUrl\" /* TransformToUrl */, navigationInstruction, state);\n    }\n    async invoke(type, navigationInstruction, arg) {\n        for (const hook of this.hooks[type]) {\n            if (!hook.wantsMatch || hook.matches(arg)) {\n                const outcome = await hook.invoke(navigationInstruction, arg);\n                if (typeof outcome === 'boolean') {\n                    if (!outcome) {\n                        return false;\n                    }\n                }\n                else {\n                    arg = outcome;\n                }\n            }\n        }\n        return arg;\n    }\n}\n//# sourceMappingURL=hook-manager.js.map","import { ComponentAppellationResolver, ViewportHandleResolver } from './type-resolvers';\nimport { ViewportInstruction } from './viewport-instruction';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Hook {\n    constructor(hook, options, id) {\n        this.hook = hook;\n        this.id = id;\n        this.type = \"beforeNavigation\" /* BeforeNavigation */;\n        this.includeTargets = [];\n        this.excludeTargets = [];\n        if (options.type !== void 0) {\n            this.type = options.type;\n        }\n        for (const target of options.include || []) {\n            this.includeTargets.push(new Target(target));\n        }\n        for (const target of options.exclude || []) {\n            this.excludeTargets.push(new Target(target));\n        }\n    }\n    get wantsMatch() {\n        return this.includeTargets.length > 0 || this.excludeTargets.length > 0;\n    }\n    matches(viewportInstructions) {\n        if (this.includeTargets.length && !this.includeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        if (this.excludeTargets.length && this.excludeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        return true;\n    }\n    invoke(navigationInstruction, arg) {\n        // TODO: Fix the type here\n        return this.hook(arg, navigationInstruction);\n    }\n}\nclass Target {\n    constructor(target) {\n        this.componentType = null;\n        this.componentName = null;\n        this.viewport = null;\n        this.viewportName = null;\n        if (typeof target === 'string') {\n            this.componentName = target;\n        }\n        else if (ComponentAppellationResolver.isType(target)) {\n            this.componentType = target;\n            this.componentName = ComponentAppellationResolver.getName(target);\n        }\n        else {\n            const cvTarget = target;\n            if (cvTarget.component) {\n                this.componentType = ComponentAppellationResolver.isType(cvTarget.component)\n                    ? ComponentAppellationResolver.getType(cvTarget.component)\n                    : null;\n                this.componentName = ComponentAppellationResolver.getName(cvTarget.component);\n            }\n            if (cvTarget.viewport) {\n                this.viewport = ViewportHandleResolver.isInstance(cvTarget.viewport) ? cvTarget.viewport : null;\n                this.viewportName = ViewportHandleResolver.getName(cvTarget.viewport);\n            }\n        }\n    }\n    matches(viewportInstructions) {\n        const instructions = viewportInstructions.slice();\n        if (!instructions.length) {\n            instructions.push(new ViewportInstruction(''));\n        }\n        for (const instruction of instructions) {\n            if ((this.componentName !== null && this.componentName === instruction.componentName) ||\n                (this.componentType !== null && this.componentType === instruction.componentType) ||\n                (this.viewportName !== null && this.viewportName === instruction.viewportName) ||\n                (this.viewport !== null && this.viewport === instruction.viewport)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=hook.js.map","import { ComponentAppellationResolver, NavigationInstructionResolver } from './type-resolvers';\n/**\n * @internal - Used by au-nav\n */\nexport class NavRoute {\n    constructor(nav, route) {\n        this.nav = nav;\n        this.instructions = [];\n        this.link = null;\n        this.linkVisible = null;\n        this.linkActive = null;\n        this.compareParameters = false;\n        this.children = null;\n        this.visible = true;\n        this.active = '';\n        this.title = route.title;\n        this.meta = route.meta;\n        if (route.route) {\n            this.instructions = this.parseRoute(route.route);\n            this.link = this.computeLink(this.instructions);\n        }\n        this.linkActive = route.consideredActive !== null && route.consideredActive !== void 0 ? route.consideredActive : this.link;\n        if (this.linkActive !== null && (!(this.linkActive instanceof Function) || ComponentAppellationResolver.isType(this.linkActive))) {\n            this.linkActive = NavigationInstructionResolver.toViewportInstructions(this.nav.router, this.linkActive);\n        }\n        this.execute = route.execute;\n        this.compareParameters = !!route.compareParameters;\n        this.linkVisible = route.condition === undefined ? true : route.condition;\n        this.update();\n    }\n    get hasChildren() {\n        return (this.children && this.children.length ? 'nav-has-children' : '');\n    }\n    update() {\n        this.visible = this.computeVisible();\n        if ((this.link && this.link.length) || this.execute) {\n            this.active = this.computeActive();\n        }\n        else {\n            this.active = (this.active === 'nav-active' ? 'nav-active' : (this.activeChild() ? 'nav-active-child' : ''));\n        }\n    }\n    executeAction(event) {\n        if (this.execute) {\n            this.execute(this);\n        }\n        event.stopPropagation();\n    }\n    toggleActive() {\n        this.active = (this.active.startsWith('nav-active') ? '' : 'nav-active');\n    }\n    parseRoute(routes) {\n        return NavigationInstructionResolver.toViewportInstructions(this.nav.router, routes);\n    }\n    computeVisible() {\n        if (this.linkVisible instanceof Function) {\n            return this.linkVisible(this);\n        }\n        return !!this.linkVisible;\n    }\n    computeActive() {\n        if (!Array.isArray(this.linkActive)) {\n            return this.linkActive(this) ? 'nav-active' : '';\n        }\n        const components = this.linkActive;\n        const activeComponents = this.nav.router.instructionResolver.flattenViewportInstructions(this.nav.router.activeComponents);\n        for (const component of components) {\n            if (activeComponents.every((active) => !active.sameComponent(component, this.compareParameters && component.typedParameters !== null))) {\n                return '';\n            }\n        }\n        return 'nav-active';\n    }\n    computeLink(instructions) {\n        return this.nav.router.instructionResolver.stringifyViewportInstructions(instructions);\n    }\n    activeChild() {\n        if (this.children) {\n            for (const child of this.children) {\n                if (child.active.startsWith('nav-active') || child.activeChild()) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=nav-route.js.map","import { NavRoute } from './nav-route';\n/**\n * Public API - Used by au-nav and Router add/setNav\n */\nexport class Nav {\n    constructor(router, name, routes = [], classes = {}) {\n        this.router = router;\n        this.name = name;\n        this.routes = routes;\n        this.classes = classes;\n        this.update();\n    }\n    addRoutes(routes) {\n        for (const route of routes) {\n            this.addRoute(this.routes, route);\n        }\n        this.update();\n    }\n    update() {\n        this.updateRoutes(this.routes);\n        this.routes = this.routes.slice();\n    }\n    addRoute(routes, route) {\n        const newRoute = new NavRoute(this, route);\n        routes.push(newRoute);\n        if (route.children) {\n            newRoute.children = [];\n            for (const child of route.children) {\n                this.addRoute(newRoute.children, child);\n            }\n        }\n    }\n    updateRoutes(routes) {\n        for (const route of routes) {\n            route.update();\n            if (route.children && route.children.length) {\n                this.updateRoutes(route.children);\n            }\n        }\n    }\n}\n//# sourceMappingURL=nav.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bound } from '@aurelia/kernel';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class QueueTask {\n    constructor(taskQueue, item, cost = 0) {\n        this.taskQueue = taskQueue;\n        this.item = item;\n        this.cost = cost;\n        this.done = false;\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve = () => {\n                this.taskQueue.resolve(this, resolve);\n            };\n            this.reject = (reason) => {\n                this.taskQueue.reject(this, reject, reason);\n            };\n        });\n    }\n    async execute() {\n        if ('execute' in this.item) {\n            await this.item.execute(this);\n        }\n        else {\n            await this.item(this);\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() { return; }\n}\n/**\n * A first-in-first-out task queue that only processes the next queued item\n * when the current one has been resolved or rejected. If a callback function\n * is specified, it receives the queued items as tasks one at a time. If no\n * callback is specified, the tasks themselves are either executed (if a\n * function) or the execute method in them are run. The executed function\n * should resolve or reject the task when processing is done.\n * Enqueued items' tasks can be awaited. Enqueued items can specify an\n * (arbitrary) execution cost and the queue can be set up (activated) to\n * only process a specific amount of execution cost per RAF/tick.\n *\n * @internal - Shouldn't be used directly.\n */\nexport class TaskQueue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('TaskQueue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('TaskQueue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = (list ? itemOrItems : [itemOrItems]);\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map((value) => value !== undefined ? value : 1);\n        const tasks = [];\n        for (const item of items) {\n            tasks.push(item instanceof QueueTask\n                ? item\n                : this.createQueueTask(item, costs.shift())); // TODO: Get cancellable in as well\n        }\n        this.pending.push(...tasks);\n        this.dequeue();\n        return list ? tasks : tasks[0];\n    }\n    createQueueTask(item, cost) {\n        return new QueueTask(this, item, cost);\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            if (this.callback !== void 0) {\n                this.callback(this.processing);\n            }\n            else {\n                // Don't need to await this since next task won't be dequeued until\n                // executed function is resolved\n                this.processing.execute().catch(error => { throw error; });\n            }\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n    resolve(task, resolve) {\n        resolve();\n        this.processing = null;\n        this.dequeue();\n    }\n    reject(task, reject, reason) {\n        reject(reason);\n        this.processing = null;\n        this.dequeue();\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", void 0)\n], TaskQueue.prototype, \"dequeue\", null);\n//# sourceMappingURL=task-queue.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { TaskQueue } from './task-queue';\n/**\n * @internal - Shouldn't be used directly\n */\nlet BrowserViewerStore = class BrowserViewerStore {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { return; },\n        };\n        this.forwardedState = { eventTask: null, suppressPopstate: false };\n        this.handlePopstate = (event) => {\n            const { eventTask, suppressPopstate } = this.forwardedState;\n            this.forwardedState = { eventTask: null, suppressPopstate: false };\n            return this.pendingCalls.enqueue(async (task) => {\n                const store = this;\n                const ev = event;\n                const evTask = eventTask;\n                const suppressPopstateEvent = suppressPopstate;\n                await store.popstate(ev, evTask, suppressPopstateEvent);\n                task.resolve();\n            }, 1).wait();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new TaskQueue();\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstateEvent = false) {\n        const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n        this.pendingCalls.enqueue([\n            (task) => {\n                const store = this;\n                const eventTask = doneTask;\n                const suppressPopstate = suppressPopstateEvent;\n                store.forwardState({ eventTask, suppressPopstate });\n                task.resolve();\n            },\n            (task) => {\n                const history = this.history;\n                const steps = delta;\n                history.go(steps);\n                task.resolve();\n            },\n        ], [0, 1]);\n        return doneTask.wait();\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.pendingCalls.enqueue((task) => {\n            const history = this.history;\n            const data = state;\n            const titleOrEmpty = title || '';\n            const url = `${fragment}${path}`;\n            history.pushState(data, titleOrEmpty, url);\n            task.resolve();\n        }, 1).wait();\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.pendingCalls.enqueue((task) => {\n            const history = this.history;\n            const data = state;\n            const titleOrEmpty = title || '';\n            const url = `${fragment}${path}`;\n            history.replaceState(data, titleOrEmpty, url);\n            task.resolve();\n        }, 1).wait();\n    }\n    popNavigatorState() {\n        const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n        this.pendingCalls.enqueue(async (task) => {\n            const store = this;\n            const eventTask = doneTask;\n            await store.popState(eventTask);\n            task.resolve();\n        }, 1);\n        return doneTask.wait();\n    }\n    async popState(doneTask) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            await this.pushNavigatorState(state);\n        }\n        await doneTask.execute();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    async popstate(ev, eventTask, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (eventTask !== null) {\n            await eventTask.execute();\n        }\n    }\n};\nBrowserViewerStore = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserViewerStore);\nexport { BrowserViewerStore };\n//# sourceMappingURL=browser-viewer-store.js.map","/* eslint-disable max-lines-per-function */\nimport { DI, IContainer, Reporter, Registration, Metadata } from '@aurelia/kernel';\nimport { Aurelia, CustomElement, DOM, isRenderContext } from '@aurelia/runtime';\nimport { InstructionResolver } from './instruction-resolver';\nimport { LinkHandler } from './link-handler';\nimport { Nav } from './nav';\nimport { Navigator } from './navigator';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { arrayRemove } from './utils';\nimport { Viewport } from './viewport';\nimport { FoundRoute } from './found-route';\nimport { HookManager } from './hook-manager';\nimport { Scope } from './scope';\nimport { ViewportScope } from './viewport-scope';\nimport { BrowserViewerStore } from './browser-viewer-store';\nclass ClosestViewportCustomElement {\n}\n/**\n * @internal\n */\nclass ClosestScope {\n}\nexport const IRouter = DI.createInterface('IRouter').withDefault(x => x.singleton(Router));\nexport class Router {\n    constructor(\n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    container, \n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    navigator, \n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    navigation, \n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    linkHandler, \n    /**\n     * @internal - Shouldn't be used directly. Probably.\n     */\n    instructionResolver) {\n        this.container = container;\n        this.navigator = navigator;\n        this.navigation = navigation;\n        this.linkHandler = linkHandler;\n        this.instructionResolver = instructionResolver;\n        this.rootScope = null;\n        /**\n         * @internal\n         */\n        this.navs = {};\n        /**\n         * Public API\n         */\n        this.activeComponents = [];\n        /**\n         * @internal\n         */\n        this.appendedInstructions = [];\n        /**\n         * @internal\n         */\n        this.options = {\n            useHref: true,\n            statefulHistoryLength: 0,\n            useDirectRoutes: true,\n            useConfiguredRoutes: true,\n        };\n        this.isActive = false;\n        this.loadedFirst = false;\n        this.processingNavigation = null;\n        this.lastNavigation = null;\n        this.staleChecks = {};\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.linkCallback = (info) => {\n            let instruction = info.instruction || '';\n            if (typeof instruction === 'string' && instruction.startsWith('#')) {\n                instruction = instruction.slice(1);\n                // '#' === '/' === '#/'\n                if (!instruction.startsWith('/')) {\n                    instruction = `/${instruction}`;\n                }\n            }\n            // Adds to Navigator's Queue, which makes sure it's serial\n            this.goto(instruction, { origin: info.anchor }).catch(error => { throw error; });\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.navigatorCallback = (instruction) => {\n            // Instructions extracted from queue, one at a time\n            this.processNavigations(instruction).catch(error => { throw error; });\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.navigatorSerializeCallback = async (entry, preservedEntries) => {\n            let excludeComponents = [];\n            for (const preservedEntry of preservedEntries) {\n                if (typeof preservedEntry.instruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.instruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n                if (typeof preservedEntry.fullStateInstruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.fullStateInstruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n            }\n            excludeComponents = excludeComponents.filter((component, i, arr) => component !== null && arr.indexOf(component) === i);\n            const serialized = { ...entry };\n            let instructions = [];\n            if (serialized.fullStateInstruction && typeof serialized.fullStateInstruction !== 'string') {\n                instructions.push(...serialized.fullStateInstruction);\n                serialized.fullStateInstruction = this.instructionResolver.stringifyViewportInstructions(serialized.fullStateInstruction);\n            }\n            if (serialized.instruction && typeof serialized.instruction !== 'string') {\n                instructions.push(...serialized.instruction);\n                serialized.instruction = this.instructionResolver.stringifyViewportInstructions(serialized.instruction);\n            }\n            instructions = instructions.filter((instruction, i, arr) => instruction !== null\n                && instruction.componentInstance !== null\n                && arr.indexOf(instruction) === i);\n            const alreadyDone = [];\n            for (const instruction of instructions) {\n                await this.freeComponents(instruction, excludeComponents, alreadyDone);\n            }\n            return serialized;\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.browserNavigatorCallback = (browserNavigationEvent) => {\n            const entry = (browserNavigationEvent.state && browserNavigationEvent.state.currentEntry\n                ? browserNavigationEvent.state.currentEntry\n                : { instruction: '', fullStateInstruction: '' });\n            entry.instruction = browserNavigationEvent.instruction;\n            entry.fromBrowser = true;\n            this.navigator.navigate(entry).catch(error => { throw error; });\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.processNavigations = async (qInstruction) => {\n            const instruction = this.processingNavigation = qInstruction;\n            if (this.options.reportCallback) {\n                this.options.reportCallback(instruction);\n            }\n            let fullStateInstruction = false;\n            const instructionNavigation = instruction.navigation;\n            if ((instructionNavigation.back || instructionNavigation.forward) && instruction.fullStateInstruction) {\n                fullStateInstruction = true;\n                // if (!confirm('Perform history navigation?')) { this.navigator.cancel(instruction); this.processingNavigation = null; return Promise.resolve(); }\n            }\n            let configuredRoute = await this.findInstructions(this.rootScope.scope, instruction.instruction, instruction.scope || this.rootScope.scope, !fullStateInstruction);\n            let instructions = configuredRoute.instructions;\n            let configuredRoutePath = null;\n            if (instruction.instruction.length > 0 && !configuredRoute.foundConfiguration && !configuredRoute.foundInstructions) {\n                // TODO: Do something here!\n                this.unknownRoute(configuredRoute.remaining);\n            }\n            if (configuredRoute.foundConfiguration) {\n                instruction.path = instruction.instruction.startsWith('/')\n                    ? instruction.instruction.slice(1) : instruction.instruction;\n                configuredRoutePath = `${configuredRoutePath || ''}${configuredRoute.matching}`;\n                this.rootScope.path = configuredRoutePath;\n            }\n            // TODO: Used to have an early exit if no instructions. Restore it?\n            const clearScopeOwners = [];\n            let clearViewportScopes = [];\n            for (const clearInstruction of instructions.filter(instr => this.instructionResolver.isClearAllViewportsInstruction(instr))) {\n                const scope = clearInstruction.scope || this.rootScope.scope;\n                clearScopeOwners.push(...scope.children.filter(scope => !scope.owner.isEmpty).map(scope => scope.owner));\n                if (scope.viewportScope !== null) {\n                    clearViewportScopes.push(scope.viewportScope);\n                }\n            }\n            instructions = instructions.filter(instr => !this.instructionResolver.isClearAllViewportsInstruction(instr));\n            for (const addInstruction of instructions.filter(instr => this.instructionResolver.isAddAllViewportsInstruction(instr))) {\n                addInstruction.setViewport((addInstruction.scope || this.rootScope.scope).viewportScope.name);\n                addInstruction.scope = addInstruction.scope.owningScope;\n            }\n            const updatedScopeOwners = [];\n            const alreadyFoundInstructions = [];\n            // TODO: Take care of cancellations down in subsets/iterations\n            let { found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(instructions, alreadyFoundInstructions);\n            let guard = 100;\n            do {\n                if (!guard--) { // Guard against endless loop\n                    console.log('remainingInstructions', remainingInstructions);\n                    throw Reporter.error(2002);\n                }\n                const changedScopeOwners = [];\n                const hooked = await this.hookManager.invokeBeforeNavigation(viewportInstructions, instruction);\n                if (hooked === false) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                }\n                else {\n                    viewportInstructions = hooked;\n                }\n                for (const viewportInstruction of viewportInstructions) {\n                    const scopeOwner = viewportInstruction.owner;\n                    if (scopeOwner !== null) {\n                        scopeOwner.path = configuredRoutePath;\n                        if (scopeOwner.setNextContent(viewportInstruction, instruction)) {\n                            changedScopeOwners.push(scopeOwner);\n                        }\n                        arrayRemove(clearScopeOwners, value => value === scopeOwner);\n                        if (!this.instructionResolver.isClearViewportInstruction(viewportInstruction)\n                            && viewportInstruction.scope !== null\n                            && viewportInstruction.scope.parent !== null\n                            && viewportInstruction.scope.parent.isViewportScope) {\n                            arrayRemove(clearViewportScopes, value => value === viewportInstruction.scope.parent.viewportScope);\n                        }\n                    }\n                }\n                let results = await Promise.all(changedScopeOwners.map((value) => value.canLeave()));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                }\n                results = await Promise.all(changedScopeOwners.map(async (value) => {\n                    const canEnter = await value.canEnter();\n                    if (typeof canEnter === 'boolean') {\n                        if (canEnter) {\n                            return value.enter();\n                        }\n                        else {\n                            return false;\n                        }\n                    }\n                    await this.goto(canEnter, { append: true });\n                    await value.abortContentChange();\n                    // TODO: Abort content change in the viewports\n                    return true;\n                }));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], qInstruction);\n                }\n                for (const viewport of changedScopeOwners) {\n                    if (updatedScopeOwners.every(value => value !== viewport)) {\n                        updatedScopeOwners.push(viewport);\n                    }\n                }\n                // TODO: Fix multi level recursiveness!\n                alreadyFoundInstructions.push(...viewportInstructions);\n                ({ found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(remainingInstructions, alreadyFoundInstructions));\n                // Look for configured child routes (once we've loaded everything so far?)\n                if (configuredRoute.hasRemaining &&\n                    viewportInstructions.length === 0 &&\n                    remainingInstructions.length === 0) {\n                    let configured = new FoundRoute();\n                    const routeScopeOwners = alreadyFoundInstructions\n                        .filter(instr => instr.owner !== null && instr.owner.path === configuredRoutePath)\n                        .map(instr => instr.owner)\n                        .filter((value, index, arr) => arr.indexOf(value) === index);\n                    for (const owner of routeScopeOwners) {\n                        configured = await this.findInstructions(owner.scope, configuredRoute.remaining, owner.scope);\n                        if (configured.foundConfiguration) {\n                            break;\n                        }\n                    }\n                    if (configured.foundInstructions) {\n                        configuredRoute = configured;\n                        configuredRoutePath = `${configuredRoutePath || ''}/${configuredRoute.matching}`;\n                    }\n                    else {\n                        // TODO: Do something here!\n                        this.unknownRoute(configured.remaining);\n                    }\n                    this.appendInstructions(configured.instructions);\n                }\n                // Don't use defaults when it's a full state navigation\n                if (fullStateInstruction) {\n                    this.appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                }\n                // Process non-defaults first\n                let appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                this.appendedInstructions = this.appendedInstructions.filter(instruction => instruction.default);\n                if (appendedInstructions.length === 0) {\n                    const index = this.appendedInstructions.findIndex(instruction => instruction.default);\n                    if (index >= 0) {\n                        appendedInstructions = this.appendedInstructions.splice(index, 1);\n                    }\n                }\n                while (appendedInstructions.length > 0) {\n                    const appendedInstruction = appendedInstructions.shift();\n                    const existingAlreadyFound = alreadyFoundInstructions.some(instruction => instruction.sameViewport(appendedInstruction));\n                    const existingFound = viewportInstructions.find(value => value.sameViewport(appendedInstruction));\n                    const existingRemaining = remainingInstructions.find(value => value.sameViewport(appendedInstruction));\n                    if (appendedInstruction.default &&\n                        (existingAlreadyFound ||\n                            (existingFound !== void 0 && !existingFound.default) ||\n                            (existingRemaining !== void 0 && !existingRemaining.default))) {\n                        continue;\n                    }\n                    if (existingFound !== void 0) {\n                        arrayRemove(viewportInstructions, value => value === existingFound);\n                    }\n                    if (existingRemaining !== void 0) {\n                        arrayRemove(remainingInstructions, value => value === existingRemaining);\n                    }\n                    if (appendedInstruction.viewport !== null) {\n                        viewportInstructions.push(appendedInstruction);\n                    }\n                    else {\n                        remainingInstructions.push(appendedInstruction);\n                    }\n                }\n                if (viewportInstructions.length === 0 && remainingInstructions.length === 0) {\n                    viewportInstructions = clearScopeOwners.map(owner => {\n                        const instruction = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction, owner.isViewport ? owner : void 0);\n                        if (owner.isViewportScope) {\n                            instruction.viewportScope = owner;\n                        }\n                        return instruction;\n                    });\n                    viewportInstructions.push(...clearViewportScopes.map(viewportScope => {\n                        const instr = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction);\n                        instr.viewportScope = viewportScope;\n                        return instr;\n                    }));\n                    clearViewportScopes = [];\n                }\n            } while (viewportInstructions.length > 0 || remainingInstructions.length > 0);\n            await Promise.all(updatedScopeOwners.map((value) => value.loadContent()));\n            await this.replacePaths(instruction);\n            // this.updateNav();\n            // Remove history entry if no history viewports updated\n            if (instructionNavigation.new && !instructionNavigation.first && !instruction.repeating && updatedScopeOwners.every(viewport => viewport.options.noHistory)) {\n                instruction.untracked = true;\n            }\n            updatedScopeOwners.forEach((viewport) => {\n                viewport.finalizeContentChange();\n            });\n            this.lastNavigation = this.processingNavigation;\n            if (this.lastNavigation.repeating) {\n                this.lastNavigation.repeating = false;\n            }\n            this.processingNavigation = null;\n            await this.navigator.finalize(instruction);\n        };\n        this.hookManager = new HookManager();\n    }\n    /**\n     * Public API\n     */\n    get isNavigating() {\n        return this.processingNavigation !== null;\n    }\n    /**\n     * @internal\n     */\n    get statefulHistory() {\n        return this.options.statefulHistoryLength !== void 0 && this.options.statefulHistoryLength > 0;\n    }\n    /**\n     * Public API\n     */\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Router has already been activated');\n        }\n        this.isActive = true;\n        this.options = {\n            ...this.options,\n            ...options\n        };\n        if (this.options.hooks !== void 0) {\n            this.addHooks(this.options.hooks);\n        }\n        this.instructionResolver.activate({ separators: this.options.separators });\n        this.navigator.activate(this, {\n            callback: this.navigatorCallback,\n            store: this.navigation,\n            statefulHistoryLength: this.options.statefulHistoryLength,\n            serializeCallback: this.statefulHistory ? this.navigatorSerializeCallback : void 0,\n        });\n        this.linkHandler.activate({ callback: this.linkCallback, useHref: this.options.useHref });\n        this.navigation.activate({\n            callback: this.browserNavigatorCallback,\n            useUrlFragmentHash: this.options.useUrlFragmentHash\n        });\n        this.ensureRootScope();\n    }\n    /**\n     * Public API\n     */\n    async loadUrl() {\n        const entry = {\n            ...this.navigation.viewerState,\n            ...{\n                fullStateInstruction: '',\n                replacing: true,\n                fromBrowser: false,\n            }\n        };\n        const result = this.navigator.navigate(entry);\n        this.loadedFirst = true;\n        return result;\n    }\n    /**\n     * Public API\n     */\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Router has not been activated');\n        }\n        this.linkHandler.deactivate();\n        this.navigator.deactivate();\n        this.navigation.deactivate();\n    }\n    /**\n     * @internal\n     */\n    findScope(origin) {\n        // this.ensureRootScope();\n        if (origin === void 0 || origin === null) {\n            return this.rootScope.scope;\n        }\n        if (origin instanceof Scope || origin instanceof Viewport) {\n            return origin.scope;\n        }\n        return this.getClosestScope(origin) || this.rootScope.scope;\n    }\n    /**\n     * @internal\n     */\n    findParentScope(container) {\n        if (container === null) {\n            return this.rootScope.scope;\n        }\n        // Already (prematurely) set on this view model so get it from container's parent instead\n        if (container.has(ClosestScope, false)) {\n            container = container.parent;\n            if (container === null) {\n                return this.rootScope.scope;\n            }\n        }\n        if (container.has(ClosestScope, true)) {\n            return container.get(ClosestScope);\n        }\n        return this.rootScope.scope;\n    }\n    /**\n     * Public API - Get viewport by name\n     */\n    getViewport(name) {\n        return this.allViewports().find(viewport => viewport.name === name) || null;\n    }\n    /**\n     * Public API (not yet implemented)\n     */\n    addViewport(...args) {\n        throw new Error('Not implemented');\n    }\n    /**\n     * Public API (not yet implemented)\n     */\n    findViewportScope(...args) {\n        throw new Error('Not implemented');\n    }\n    /**\n     * Public API (not yet implemented)\n     */\n    addViewportScope(...args) {\n        throw new Error('Not implemented');\n    }\n    /**\n     * @internal - Called from the viewport scope custom element in created()\n     */\n    setClosestScope(viewModelOrContainer, scope) {\n        const container = this.getContainer(viewModelOrContainer);\n        Registration.instance(ClosestScope, scope).register(container);\n    }\n    /**\n     * @internal\n     */\n    getClosestScope(viewModelOrElement) {\n        const container = 'resourceResolvers' in viewModelOrElement\n            ? viewModelOrElement\n            : this.getClosestContainer(viewModelOrElement);\n        if (container === null) {\n            return null;\n        }\n        if (!container.has(ClosestScope, true)) {\n            return null;\n        }\n        return container.get(ClosestScope) || null;\n    }\n    /**\n     * @internal\n     */\n    unsetClosestScope(viewModelOrContainer) {\n        const container = this.getContainer(viewModelOrContainer);\n        // TODO: Get an 'unregister' on container\n        container.resolvers.delete(ClosestScope);\n    }\n    /**\n     * @internal - Called from the viewport custom element\n     */\n    connectViewport(viewport, container, name, element, options) {\n        const parentScope = this.findParentScope(container);\n        if (viewport === null) {\n            viewport = parentScope.addViewport(name, element, container, options);\n            this.setClosestScope(container, viewport.connectedScope);\n        }\n        return viewport;\n    }\n    /**\n     * @internal - Called from the viewport custom element\n     */\n    disconnectViewport(viewport, container, element) {\n        if (!viewport.connectedScope.parent.removeViewport(viewport, element, container)) {\n            throw new Error(`Failed to remove viewport: ${viewport.name}`);\n        }\n        this.unsetClosestScope(container);\n    }\n    /**\n     * @internal - Called from the viewport scope custom element\n     */\n    connectViewportScope(viewportScope, name, container, element, options) {\n        const parentScope = this.findParentScope(container);\n        if (viewportScope === null) {\n            viewportScope = parentScope.addViewportScope(name, element, options);\n            this.setClosestScope(container, viewportScope.connectedScope);\n        }\n        return viewportScope;\n    }\n    /**\n     * @internal - Called from the viewport scope custom element\n     */\n    disconnectViewportScope(viewportScope, container) {\n        if (!viewportScope.connectedScope.parent.removeViewportScope(viewportScope)) {\n            throw new Error(`Failed to remove viewport scope: ${viewportScope.path}`);\n        }\n        this.unsetClosestScope(container);\n    }\n    /**\n     * @internal\n     */\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        // this.ensureRootScope();\n        return this.rootScope.scope.allViewports(includeDisabled, includeReplaced);\n    }\n    /**\n     * Public API - THE navigation API\n     */\n    goto(instructions, options) {\n        options = options || {};\n        // TODO: Review query extraction; different pos for path and fragment!\n        if (typeof instructions === 'string' && !options.query) {\n            const [path, search] = instructions.split('?');\n            instructions = path;\n            options.query = search;\n        }\n        const toOptions = {};\n        if (options.origin) {\n            toOptions.context = options.origin;\n        }\n        let scope = null;\n        ({ instructions, scope } = NavigationInstructionResolver.createViewportInstructions(this, instructions, toOptions));\n        if (options.append && this.processingNavigation) {\n            instructions = NavigationInstructionResolver.toViewportInstructions(this, instructions);\n            this.appendInstructions(instructions, scope);\n            // Can't return current navigation promise since it can lead to deadlock in enter\n            return Promise.resolve();\n        }\n        const entry = {\n            instruction: instructions,\n            fullStateInstruction: '',\n            scope: scope,\n            title: options.title,\n            data: options.data,\n            query: options.query,\n            replacing: options.replace,\n            repeating: options.append,\n            fromBrowser: false,\n        };\n        return this.navigator.navigate(entry);\n    }\n    /**\n     * Public API\n     */\n    refresh() {\n        return this.navigator.refresh();\n    }\n    /**\n     * Public API\n     */\n    back() {\n        return this.navigator.go(-1);\n    }\n    /**\n     * Public API\n     */\n    forward() {\n        return this.navigator.go(1);\n    }\n    /**\n     * Public API\n     */\n    checkActive(instructions) {\n        for (const instruction of instructions) {\n            const scopeInstructions = this.instructionResolver.matchScope(this.activeComponents, instruction.scope);\n            const matching = scopeInstructions.filter(instr => instr.sameComponent(instruction, true));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.instructionResolver.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Public API\n     */\n    setNav(name, routes, classes) {\n        const nav = this.findNav(name);\n        if (nav !== void 0 && nav !== null) {\n            nav.routes = [];\n        }\n        this.addNav(name, routes, classes);\n    }\n    /**\n     * Public API\n     */\n    addNav(name, routes, classes) {\n        let nav = this.navs[name];\n        if (nav === void 0 || nav === null) {\n            nav = this.navs[name] = new Nav(this, name, [], classes);\n        }\n        nav.addRoutes(routes);\n        nav.update();\n    }\n    /**\n     * Public API\n     */\n    updateNav(name) {\n        const navs = name\n            ? [name]\n            : Object.keys(this.navs);\n        for (const nav of navs) {\n            if (this.navs[nav] !== void 0 && this.navs[nav] !== null) {\n                this.navs[nav].update();\n            }\n        }\n    }\n    /**\n     * Public API\n     */\n    findNav(name) {\n        return this.navs[name];\n    }\n    /**\n     * Public API\n     */\n    addRoutes(routes, context) {\n        // TODO: This should add to the context instead\n        // TODO: Add routes without context to rootScope content (which needs to be created)?\n        return [];\n        // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n        // return viewport.addRoutes(routes);\n    }\n    /**\n     * Public API\n     */\n    removeRoutes(routes, context) {\n        // TODO: This should remove from the context instead\n        // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n        // return viewport.removeRoutes(routes);\n    }\n    /**\n     * Public API\n     */\n    addHooks(hooks) {\n        return hooks.map(hook => this.addHook(hook.hook, hook.options));\n    }\n    addHook(hook, options) {\n        return this.hookManager.addHook(hook, options);\n    }\n    /**\n     * Public API\n     */\n    removeHooks(hooks) {\n        return;\n    }\n    /**\n     * Public API - The right way to create ViewportInstructions\n     */\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        return this.instructionResolver.createViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n    }\n    async findInstructions(scope, instruction, instructionScope, transformUrl = false) {\n        let route = new FoundRoute();\n        if (typeof instruction === 'string') {\n            instruction = transformUrl\n                ? await this.hookManager.invokeTransformFromUrl(instruction, this.processingNavigation)\n                : instruction;\n            if (Array.isArray(instruction)) {\n                route.instructions = instruction;\n            }\n            else {\n                // TODO: Review this\n                if (instruction === '/') {\n                    instruction = '';\n                }\n                const instructions = this.instructionResolver.parseViewportInstructions(instruction);\n                if (this.options.useConfiguredRoutes && !this.hasSiblingInstructions(instructions)) {\n                    const foundRoute = scope.findMatchingRoute(instruction);\n                    if (foundRoute !== null && foundRoute.foundConfiguration) {\n                        route = foundRoute;\n                    }\n                    else {\n                        if (this.options.useDirectRoutes) {\n                            route.instructions = instructions;\n                            if (route.instructions.length > 0) {\n                                const nextInstructions = route.instructions[0].nextScopeInstructions || [];\n                                route.remaining = this.instructionResolver.stringifyViewportInstructions(nextInstructions);\n                                route.instructions[0].nextScopeInstructions = null;\n                            }\n                        }\n                    }\n                }\n                else if (this.options.useDirectRoutes) {\n                    route.instructions = instructions;\n                }\n            }\n        }\n        else {\n            route.instructions = instruction;\n        }\n        for (const instr of route.instructions) {\n            if (instr.scope === null) {\n                instr.scope = instructionScope;\n            }\n        }\n        return route;\n    }\n    hasSiblingInstructions(instructions) {\n        if (instructions === null) {\n            return false;\n        }\n        if (instructions.length > 1) {\n            return true;\n        }\n        return instructions.some(instruction => this.hasSiblingInstructions(instruction.nextScopeInstructions));\n    }\n    appendInstructions(instructions, scope = null) {\n        if (scope === null) {\n            scope = this.rootScope.scope;\n        }\n        for (const instruction of instructions) {\n            if (instruction.scope === null) {\n                instruction.scope = scope;\n            }\n        }\n        this.appendedInstructions.push(...instructions);\n    }\n    checkStale(name, instructions) {\n        const staleCheck = this.staleChecks[name];\n        if (staleCheck === void 0) {\n            this.staleChecks[name] = instructions.slice();\n            return false;\n        }\n        if (staleCheck.length !== instructions.length) {\n            this.staleChecks[name] = instructions.slice();\n            return false;\n        }\n        for (let i = 0, ii = instructions.length; i < ii; i++) {\n            if (staleCheck[i] !== instructions[i]) {\n                this.staleChecks[name] = instructions.slice();\n                return false;\n            }\n        }\n        return true;\n    }\n    unknownRoute(route) {\n        if (typeof route !== 'string' || route.length === 0) {\n            return;\n        }\n        if (this.options.useConfiguredRoutes && this.options.useDirectRoutes) {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching configured route or component found for '${route}'`);\n        }\n        else if (this.options.useConfiguredRoutes) {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching configured route found for '${route}'`);\n        }\n        else {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching route/component found for '${route}'`);\n        }\n    }\n    findViewports(instructions, alreadyFound, withoutViewports = false) {\n        const found = [];\n        const remaining = [];\n        while (instructions.length) {\n            if (instructions[0].scope === null) {\n                instructions[0].scope = this.rootScope.scope;\n            }\n            const scope = instructions[0].scope;\n            const { foundViewports, remainingInstructions } = scope.findViewports(instructions.filter(instruction => instruction.scope === scope), alreadyFound, withoutViewports);\n            found.push(...foundViewports);\n            remaining.push(...remainingInstructions);\n            instructions = instructions.filter(instruction => instruction.scope !== scope);\n        }\n        return { found: found.slice(), remaining };\n    }\n    async cancelNavigation(updatedScopeOwners, qInstruction) {\n        // TODO: Take care of disabling viewports when cancelling and stateful!\n        updatedScopeOwners.forEach((viewport) => {\n            viewport.abortContentChange().catch(error => { throw error; });\n        });\n        await this.navigator.cancel(qInstruction);\n        this.processingNavigation = null;\n        qInstruction.resolve();\n    }\n    ensureRootScope() {\n        if (!this.rootScope) {\n            const root = this.container.get(Aurelia).root;\n            // root.config.component shouldn't be used in the end. Metadata will probably eliminate it\n            this.rootScope = new ViewportScope('rootScope', this, root.config.host, null, true, root.config.component);\n        }\n        return this.rootScope;\n    }\n    async replacePaths(instruction) {\n        this.rootScope.scope.reparentViewportInstructions();\n        let instructions = this.rootScope.scope.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && !scope.viewportInstruction.isEmpty())\n            .map(scope => scope.viewportInstruction);\n        instructions = this.instructionResolver.cloneViewportInstructions(instructions, true);\n        // The following makes sure right viewport/viewport scopes are set and update\n        // whether viewport name is necessary or not\n        const alreadyFound = [];\n        let { found, remaining } = this.findViewports(instructions, alreadyFound, true);\n        let guard = 100;\n        while (remaining.length) {\n            // Guard against endless loop\n            if (!guard--) {\n                throw new Error('Failed to find viewport when updating viewer paths.');\n            }\n            alreadyFound.push(...found);\n            ({ found, remaining } = this.findViewports(remaining, alreadyFound, true));\n        }\n        this.activeComponents = instructions;\n        this.activeRoute = instruction.route;\n        // First invoke with viewport instructions (should it perhaps get full state?)\n        let state = await this.hookManager.invokeTransformToUrl(instructions, instruction);\n        if (typeof state !== 'string') {\n            // Convert to string if necessary\n            state = this.instructionResolver.stringifyViewportInstructions(state, false, true);\n        }\n        // Invoke again with string\n        state = await this.hookManager.invokeTransformToUrl(state, instruction);\n        const query = (instruction.query && instruction.query.length ? `?${instruction.query}` : '');\n        // if (instruction.path === void 0 || instruction.path.length === 0 || instruction.path === '/') {\n        instruction.path = state + query;\n        // }\n        const fullViewportStates = [this.createViewportInstruction(this.instructionResolver.clearViewportInstruction)];\n        fullViewportStates.push(...this.instructionResolver.cloneViewportInstructions(instructions, this.statefulHistory));\n        instruction.fullStateInstruction = fullViewportStates;\n        // TODO: Fetch and update title\n        return Promise.resolve();\n    }\n    async freeComponents(instruction, excludeComponents, alreadyDone) {\n        const component = instruction.componentInstance;\n        const viewport = instruction.viewport;\n        if (component === null || viewport === null || alreadyDone.some(done => done === component)) {\n            return;\n        }\n        if (!excludeComponents.some(exclude => exclude === component)) {\n            await viewport.freeContent(component);\n            alreadyDone.push(component);\n            return;\n        }\n        if (instruction.nextScopeInstructions !== null) {\n            for (const nextInstruction of instruction.nextScopeInstructions) {\n                await this.freeComponents(nextInstruction, excludeComponents, alreadyDone);\n            }\n        }\n    }\n    getClosestContainer(viewModelOrElement) {\n        if ('context' in viewModelOrElement) {\n            return viewModelOrElement.context;\n        }\n        if ('$controller' in viewModelOrElement) {\n            return viewModelOrElement.$controller.context;\n        }\n        const controller = this.CustomElementFor(viewModelOrElement);\n        if (controller === void 0) {\n            return null;\n        }\n        return controller.context;\n    }\n    getContainer(viewModelOrContainer) {\n        if ('resourceResolvers' in viewModelOrContainer) {\n            return viewModelOrContainer;\n        }\n        if (isRenderContext(viewModelOrContainer)) {\n            return viewModelOrContainer.get(IContainer);\n        }\n        if ('$controller' in viewModelOrContainer) {\n            return viewModelOrContainer.$controller.context.get(IContainer);\n        }\n        return null;\n    }\n    // TODO: This is probably wrong since it caused test fails when in CustomElement.for\n    // Fred probably knows and will need to look at it\n    // This can most likely also be changed so that the node traversal isn't necessary\n    CustomElementFor(node) {\n        let cur = node;\n        while (cur !== null) {\n            const nodeResourceName = cur.nodeName.toLowerCase();\n            const controller = Metadata.getOwn(`${CustomElement.name}:${nodeResourceName}`, cur)\n                || Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        return (void 0);\n    }\n}\nRouter.inject = [IContainer, Navigator, BrowserViewerStore, LinkHandler, InstructionResolver];\n//# sourceMappingURL=router.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Queue } from './queue';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Navigator {\n    constructor() {\n        this.entries = [];\n        this.options = {\n            statefulHistoryLength: 0,\n        };\n        this.isActive = false;\n        this.processNavigations = (qEntry) => {\n            const entry = qEntry;\n            const navigationFlags = {};\n            if (this.currentEntry === this.uninitializedEntry) { // Refresh or first entry\n                this.loadState();\n                if (this.currentEntry !== this.uninitializedEntry) {\n                    navigationFlags.refresh = true;\n                }\n                else {\n                    navigationFlags.first = true;\n                    navigationFlags.new = true;\n                    // TODO: Should this really be created here? Shouldn't it be in the viewer?\n                    this.currentEntry = {\n                        index: 0,\n                        instruction: '',\n                        fullStateInstruction: '',\n                    };\n                    this.entries = [];\n                }\n            }\n            if (entry.index !== void 0 && !entry.replacing && !entry.refreshing) { // History navigation\n                entry.historyMovement = entry.index - (this.currentEntry.index !== void 0 ? this.currentEntry.index : 0);\n                entry.instruction = this.entries[entry.index] !== void 0 && this.entries[entry.index] !== null ? this.entries[entry.index].fullStateInstruction : entry.fullStateInstruction;\n                entry.replacing = true;\n                if (entry.historyMovement > 0) {\n                    navigationFlags.forward = true;\n                }\n                else if (entry.historyMovement < 0) {\n                    navigationFlags.back = true;\n                }\n            }\n            else if (entry.refreshing || navigationFlags.refresh) { // Refreshing\n                entry.index = this.currentEntry.index;\n            }\n            else if (entry.replacing) { // Replacing\n                navigationFlags.replace = true;\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index;\n            }\n            else { // New entry\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index !== void 0 ? this.currentEntry.index + 1 : this.entries.length;\n            }\n            this.invokeCallback(entry, navigationFlags, this.currentEntry);\n        };\n        this.uninitializedEntry = {\n            instruction: 'NAVIGATOR UNINITIALIZED',\n            fullStateInstruction: '',\n        };\n        this.currentEntry = this.uninitializedEntry;\n        this.pendingNavigations = new Queue(this.processNavigations);\n    }\n    get queued() {\n        return this.pendingNavigations.length;\n    }\n    activate(router, options) {\n        if (this.isActive) {\n            throw new Error('Navigator has already been activated');\n        }\n        this.isActive = true;\n        this.router = router;\n        this.options = { ...options };\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Navigator has not been activated');\n        }\n        this.pendingNavigations.clear();\n        this.isActive = false;\n    }\n    navigate(entry) {\n        return this.pendingNavigations.enqueue(entry);\n    }\n    refresh() {\n        const entry = this.currentEntry;\n        if (entry === this.uninitializedEntry) {\n            return Promise.reject();\n        }\n        entry.replacing = true;\n        entry.refreshing = true;\n        return this.navigate(entry);\n    }\n    go(movement) {\n        const newIndex = (this.currentEntry.index !== undefined ? this.currentEntry.index : 0) + movement;\n        if (newIndex >= this.entries.length) {\n            return Promise.reject();\n        }\n        const entry = this.entries[newIndex];\n        return this.navigate(entry);\n    }\n    setEntryTitle(title) {\n        this.currentEntry.title = title;\n        return this.saveState();\n    }\n    get titles() {\n        if (this.currentEntry == this.uninitializedEntry) {\n            return [];\n        }\n        const index = this.currentEntry.index !== void 0 ? this.currentEntry.index : 0;\n        return this.entries.slice(0, index + 1).filter((value) => !!value.title).map((value) => value.title ? value.title : '');\n    }\n    getState() {\n        const state = this.options.store ? { ...this.options.store.state } : {};\n        const entries = (state.entries || []);\n        const currentEntry = (state.currentEntry || this.uninitializedEntry);\n        return { state, entries, currentEntry };\n    }\n    loadState() {\n        const state = this.getState();\n        this.entries = state.entries;\n        this.currentEntry = state.currentEntry;\n    }\n    async saveState(push = false) {\n        if (this.currentEntry === this.uninitializedEntry) {\n            return Promise.resolve();\n        }\n        const storedEntry = this.toStoredEntry(this.currentEntry);\n        this.entries[storedEntry.index !== undefined ? storedEntry.index : 0] = storedEntry;\n        if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n            const index = this.entries.length - this.options.statefulHistoryLength;\n            for (let i = 0; i < index; i++) {\n                const entry = this.entries[i];\n                if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                    this.entries[i] = await this.options.serializeCallback(entry, this.entries.slice(index));\n                }\n            }\n        }\n        if (!this.options.store) {\n            return Promise.resolve();\n        }\n        const state = {\n            entries: [],\n            currentEntry: { ...this.toStoreableEntry(storedEntry) },\n        };\n        for (const entry of this.entries) {\n            state.entries.push(this.toStoreableEntry(entry));\n        }\n        if (push) {\n            return this.options.store.pushNavigatorState(state);\n        }\n        else {\n            return this.options.store.replaceNavigatorState(state);\n        }\n    }\n    toStoredEntry(entry) {\n        const { previous, fromBrowser, replacing, refreshing, untracked, historyMovement, navigation, scope, resolve, reject, ...storableEntry } = entry;\n        return storableEntry;\n    }\n    async finalize(instruction) {\n        this.currentEntry = instruction;\n        let index = this.currentEntry.index !== undefined ? this.currentEntry.index : 0;\n        if (this.currentEntry.untracked) {\n            if (instruction.fromBrowser && this.options.store) {\n                await this.options.store.popNavigatorState();\n            }\n            index--;\n            this.currentEntry.index = index;\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else if (this.currentEntry.replacing) {\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else { // New entry (add and discard later entries)\n            if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n                // Need to clear the instructions we discard!\n                const indexPreserve = this.entries.length - this.options.statefulHistoryLength;\n                for (const entry of this.entries.slice(index)) {\n                    if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                        await this.options.serializeCallback(entry, this.entries.slice(indexPreserve, index));\n                    }\n                }\n            }\n            this.entries = this.entries.slice(0, index);\n            this.entries.push(this.toStoredEntry(this.currentEntry));\n            await this.saveState(true);\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    async cancel(instruction) {\n        if (instruction.fromBrowser && this.options.store) {\n            if (instruction.navigation && instruction.navigation.new) {\n                await this.options.store.popNavigatorState();\n            }\n            else {\n                await this.options.store.go(-(instruction.historyMovement || 0), true);\n            }\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    invokeCallback(entry, navigationFlags, previousEntry) {\n        const instruction = { ...entry };\n        instruction.navigation = navigationFlags;\n        instruction.previous = this.toStoredEntry(previousEntry);\n        Reporter.write(10000, 'callback', instruction, instruction.previous, this.entries);\n        if (this.options.callback) {\n            this.options.callback(instruction);\n        }\n    }\n    toStoreableEntry(entry) {\n        const storeable = { ...entry };\n        if (storeable.instruction && typeof storeable.instruction !== 'string') {\n            storeable.instruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.instruction);\n        }\n        if (storeable.fullStateInstruction && typeof storeable.fullStateInstruction !== 'string') {\n            storeable.fullStateInstruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.fullStateInstruction);\n        }\n        return storeable;\n    }\n}\n//# sourceMappingURL=navigator.js.map","import { ViewportInstruction } from './viewport-instruction';\nexport class InstructionResolver {\n    constructor() {\n        this.separators = {\n            viewport: '@',\n            sibling: '+',\n            scope: '/',\n            scopeStart: '(',\n            scopeEnd: ')',\n            noScope: '!',\n            parameters: '(',\n            parametersEnd: ')',\n            parameterSeparator: ',',\n            parameterKeySeparator: '=',\n            parameter: '&',\n            add: '+',\n            clear: '-',\n            action: '.',\n        };\n    }\n    activate(options) {\n        options = options || {};\n        this.separators = { ...this.separators, ...options.separators };\n    }\n    get clearViewportInstruction() {\n        return this.separators.clear;\n    }\n    get addViewportInstruction() {\n        return this.separators.add;\n    }\n    isClearViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportName\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isAddViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction\n            : (instruction === this.addViewportInstruction\n                || instruction.startsWith(`${this.separators.add}${this.separators.viewport}`));\n    }\n    isClearViewportScopeInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportScope\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isClearAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !instruction.viewportName\n            : instruction === this.clearViewportInstruction;\n    }\n    isAddAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction && !instruction.viewportName\n            : instruction === this.addViewportInstruction;\n    }\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        const instruction = new ViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n        instruction.setInstructionResolver(this);\n        return instruction;\n    }\n    parseViewportInstructions(instructions) {\n        const match = /^[./]+/.exec(instructions);\n        let context = '';\n        if (Array.isArray(match) && match.length > 0) {\n            context = match[0];\n            instructions = instructions.slice(context.length);\n        }\n        const parsedInstructions = this.parseViewportInstructionsWorker(instructions, true).instructions;\n        for (const instruction of parsedInstructions) {\n            instruction.context = context;\n        }\n        return parsedInstructions;\n    }\n    parseViewportInstruction(instruction) {\n        const instructions = this.parseViewportInstructions(instruction);\n        if (instructions.length) {\n            return instructions[0];\n        }\n        return this.createViewportInstruction('');\n    }\n    stringifyViewportInstructions(instructions, excludeViewport = false, viewportContext = false) {\n        return instructions\n            .map(instruction => this.stringifyViewportInstruction(instruction, excludeViewport, viewportContext))\n            .filter(instruction => instruction && instruction.length)\n            .join(this.separators.sibling);\n    }\n    stringifyViewportInstruction(instruction, excludeViewport = false, viewportContext = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyAViewportInstruction(instruction, excludeViewport);\n        }\n        else {\n            let excludeCurrentViewport = excludeViewport;\n            let excludeCurrentComponent = false;\n            if (viewportContext) {\n                if (instruction.viewport && instruction.viewport.options.noLink) {\n                    return '';\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewport && !instruction.viewport.options.forceDescription) {\n                    excludeCurrentViewport = true;\n                }\n                if (instruction.viewport && instruction.viewport.options.fallback === instruction.componentName) {\n                    excludeCurrentComponent = true;\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewportScope) {\n                    excludeCurrentViewport = true;\n                }\n            }\n            const route = instruction.route;\n            const nextInstructions = instruction.nextScopeInstructions;\n            let stringified = instruction.context;\n            // It's a configured route\n            if (route !== null) {\n                // Already added as part of a configuration, skip to next scope\n                if (route === '') {\n                    return Array.isArray(nextInstructions)\n                        ? this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext)\n                        : '';\n                }\n                stringified += route.endsWith(this.separators.scope) ? route.slice(0, -this.separators.scope.length) : route;\n            }\n            else {\n                stringified += this.stringifyAViewportInstruction(instruction, excludeCurrentViewport, excludeCurrentComponent);\n            }\n            if (Array.isArray(nextInstructions) && nextInstructions.length) {\n                const nextStringified = this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext);\n                if (nextStringified.length > 0) {\n                    stringified += nextInstructions.length === 1 // TODO: This should really also check that the instructions have value\n                        ? `${this.separators.scope}${nextStringified}`\n                        : `${this.separators.scope}${this.separators.scopeStart}${nextStringified}${this.separators.scopeEnd}`;\n                }\n            }\n            return stringified;\n        }\n    }\n    stringifyScopedViewportInstructions(instructions) {\n        if (!Array.isArray(instructions)) {\n            return this.stringifyScopedViewportInstructions([instructions]);\n        }\n        return instructions.map((instruction) => this.stringifyViewportInstruction(instruction)).join(this.separators.scope);\n    }\n    encodeViewportInstructions(instructions) {\n        return encodeURIComponent(this.stringifyViewportInstructions(instructions)).replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n    }\n    decodeViewportInstructions(instructions) {\n        return this.parseViewportInstructions(decodeURIComponent(instructions));\n    }\n    buildScopedLink(scopeContext, href) {\n        if (scopeContext) {\n            href = `/${scopeContext}${this.separators.scope}${href}`;\n        }\n        return href;\n    }\n    shouldClearViewports(path) {\n        const clearViewports = (path === this.separators.clear || path.startsWith(this.separators.clear + this.separators.add));\n        const newPath = path.startsWith(this.separators.clear) ? path.slice(2) : path;\n        return { clearViewports, newPath };\n    }\n    mergeViewportInstructions(instructions) {\n        const merged = [];\n        for (let instruction of instructions) {\n            if (typeof instruction === 'string') {\n                instruction = this.parseViewportInstruction(instruction);\n            }\n            const index = merged.findIndex(merge => merge.sameViewport(instruction));\n            if (index >= 0) {\n                merged.splice(index, 1, instruction);\n            }\n            else {\n                merged.push(instruction);\n            }\n        }\n        return merged;\n    }\n    flattenViewportInstructions(instructions) {\n        const flat = [];\n        for (const instruction of instructions) {\n            flat.push(instruction);\n            if (instruction.nextScopeInstructions) {\n                flat.push(...this.flattenViewportInstructions(instruction.nextScopeInstructions));\n            }\n        }\n        return flat;\n    }\n    cloneViewportInstructions(instructions, keepInstances = false, context = false) {\n        const clones = [];\n        for (const instruction of instructions) {\n            const clone = this.createViewportInstruction((keepInstances ? instruction.componentInstance : null) || instruction.componentType || instruction.componentName, keepInstances ? instruction.viewport || instruction.viewportName : instruction.viewportName, instruction.typedParameters !== null ? instruction.typedParameters : void 0);\n            clone.needsViewportDescribed = instruction.needsViewportDescribed;\n            clone.route = instruction.route;\n            if (context) {\n                clone.context = instruction.context;\n            }\n            clone.viewportScope = keepInstances ? instruction.viewportScope : null;\n            clone.scope = keepInstances ? instruction.scope : null;\n            if (instruction.nextScopeInstructions) {\n                clone.nextScopeInstructions = this.cloneViewportInstructions(instruction.nextScopeInstructions, keepInstances, context);\n            }\n            clones.push(clone);\n        }\n        return clones;\n    }\n    // TODO: Deal with separators in data and complex types\n    parseComponentParameters(parameters, uriComponent = false) {\n        if (parameters === undefined || parameters === null || parameters.length === 0) {\n            return [];\n        }\n        if (typeof parameters === 'string') {\n            const list = [];\n            const params = parameters.split(this.separators.parameterSeparator);\n            for (const param of params) {\n                let key;\n                let value;\n                [key, value] = param.split(this.separators.parameterKeySeparator);\n                if (value === void 0) {\n                    value = uriComponent ? decodeURIComponent(key) : key;\n                    key = void 0;\n                }\n                else if (uriComponent) {\n                    key = decodeURIComponent(key);\n                    value = decodeURIComponent(value);\n                }\n                list.push({ key, value });\n            }\n            return list;\n        }\n        if (Array.isArray(parameters)) {\n            return parameters.map(param => ({ key: void 0, value: param }));\n        }\n        const keys = Object.keys(parameters);\n        keys.sort();\n        return keys.map(key => ({ key, value: parameters[key] }));\n    }\n    // TODO: Deal with separators in data and complex types\n    stringifyComponentParameters(parameters, uriComponent = false) {\n        if (!Array.isArray(parameters) || parameters.length === 0) {\n            return '';\n        }\n        const seps = this.separators;\n        return parameters\n            .map(param => {\n            const key = param.key !== void 0 && uriComponent ? encodeURIComponent(param.key) : param.key;\n            const value = uriComponent ? encodeURIComponent(param.value) : param.value;\n            return key !== void 0 && key !== value ? key + seps.parameterKeySeparator + value : value;\n        })\n            .join(seps.parameterSeparator);\n    }\n    matchScope(instructions, scope) {\n        const matching = [];\n        matching.push(...instructions.filter(instruction => instruction.scope === scope));\n        matching.push(...instructions\n            .filter(instr => instr.scope !== scope)\n            .map(instr => Array.isArray(instr.nextScopeInstructions) ? this.matchScope(instr.nextScopeInstructions, scope) : [])\n            .flat());\n        return matching;\n    }\n    matchChildren(instructions, active) {\n        for (const instruction of instructions) {\n            const matching = active.filter(instr => instr.sameComponent(instruction));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    parseViewportInstructionsWorker(instructions, grouped = false) {\n        if (!instructions) {\n            return { instructions: [], remaining: '' };\n        }\n        if (instructions.startsWith(this.separators.scopeStart)) {\n            instructions = `${this.separators.scope}${instructions}`;\n        }\n        const viewportInstructions = [];\n        let guard = 1000;\n        while (instructions.length && guard) {\n            guard--;\n            if (instructions.startsWith(this.separators.scope)) {\n                instructions = instructions.slice(this.separators.scope.length);\n                const scopeStart = instructions.startsWith(this.separators.scopeStart);\n                if (scopeStart) {\n                    instructions = instructions.slice(this.separators.scopeStart.length);\n                }\n                const { instructions: found, remaining } = this.parseViewportInstructionsWorker(instructions, scopeStart);\n                if (viewportInstructions.length) {\n                    viewportInstructions[viewportInstructions.length - 1].nextScopeInstructions = found;\n                }\n                else {\n                    viewportInstructions.push(...found);\n                }\n                instructions = remaining;\n            }\n            else if (instructions.startsWith(this.separators.scopeEnd)) {\n                if (grouped) {\n                    instructions = instructions.slice(this.separators.scopeEnd.length);\n                }\n                return { instructions: viewportInstructions, remaining: instructions };\n            }\n            else if (instructions.startsWith(this.separators.sibling) && !this.isAddViewportInstruction(instructions)) {\n                if (!grouped) {\n                    return { instructions: viewportInstructions, remaining: instructions };\n                }\n                instructions = instructions.slice(this.separators.sibling.length);\n            }\n            else {\n                const { instruction: viewportInstruction, remaining } = this.parseAViewportInstruction(instructions);\n                viewportInstructions.push(viewportInstruction);\n                instructions = remaining;\n            }\n        }\n        return { instructions: viewportInstructions, remaining: instructions };\n    }\n    findNextToken(instruction, tokens) {\n        const matches = {};\n        // Tokens can have length > 1\n        for (const token of tokens) {\n            const tokenPos = instruction.indexOf(token);\n            if (tokenPos > -1) {\n                matches[token] = instruction.indexOf(token);\n            }\n        }\n        const pos = Math.min(...Object.values(matches));\n        for (const token in matches) {\n            if (matches[token] === pos) {\n                return { token, pos };\n            }\n        }\n        return { token: '', pos: -1 };\n    }\n    parseAViewportInstruction(instruction) {\n        const seps = this.separators;\n        const tokens = [seps.parameters, seps.viewport, seps.noScope, seps.scopeEnd, seps.scope, seps.sibling];\n        let component = void 0;\n        let parametersString = void 0;\n        let viewport = void 0;\n        let scope = true;\n        let token;\n        let pos;\n        const specials = [seps.add, seps.clear];\n        for (const special of specials) {\n            if (instruction === special) {\n                component = instruction;\n                instruction = '';\n                tokens.shift(); // parameters\n                tokens.shift(); // viewport\n                token = seps.viewport;\n                break;\n            }\n        }\n        if (component === void 0) {\n            for (const special of specials) {\n                if (instruction.startsWith(`${special}${seps.viewport}`)) {\n                    component = special;\n                    instruction = instruction.slice(`${special}${seps.viewport}`.length);\n                    tokens.shift(); // parameters\n                    tokens.shift(); // viewport\n                    token = seps.viewport;\n                    break;\n                }\n            }\n        }\n        if (component === void 0) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            component = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n            tokens.shift(); // parameters\n            if (token === seps.parameters) {\n                ({ token, pos } = this.findNextToken(instruction, [seps.parametersEnd]));\n                parametersString = instruction.slice(0, pos);\n                instruction = instruction.slice(pos + token.length);\n                ({ token } = this.findNextToken(instruction, tokens));\n                instruction = instruction.slice(token.length);\n            }\n            tokens.shift(); // viewport\n        }\n        if (token === seps.viewport) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            viewport = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n        }\n        tokens.shift(); // noScope\n        if (token === seps.noScope) {\n            scope = false;\n        }\n        // Restore token that belongs to next instruction\n        if (token === seps.scopeEnd || token === seps.scope || token === seps.sibling) {\n            instruction = `${token}${instruction}`;\n        }\n        const viewportInstruction = this.createViewportInstruction(component, viewport, parametersString, scope);\n        return { instruction: viewportInstruction, remaining: instruction };\n    }\n    stringifyAViewportInstruction(instruction, excludeViewport = false, excludeComponent = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyViewportInstruction(this.parseViewportInstruction(instruction), excludeViewport, excludeComponent);\n        }\n        else {\n            let instructionString = !excludeComponent ? instruction.componentName : '';\n            const specification = instruction.componentType ? instruction.componentType.parameters : null;\n            const parameters = this.stringifyComponentParameters(instruction.toSortedParameters(specification));\n            if (parameters.length > 0) {\n                instructionString += !excludeComponent\n                    ? `${this.separators.parameters}${parameters}${this.separators.parametersEnd}`\n                    : parameters;\n            }\n            if (instruction.viewportName !== null && !excludeViewport) {\n                instructionString += this.separators.viewport + instruction.viewportName;\n            }\n            if (!instruction.ownsScope) {\n                instructionString += this.separators.noScope;\n            }\n            return instructionString || '';\n        }\n    }\n}\n//# sourceMappingURL=instruction-resolver.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { inject } from '@aurelia/kernel';\nimport { bindable, customElement, INode } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nlet NavCustomElement = class NavCustomElement {\n    constructor(router) {\n        this.router = router;\n        this.name = null;\n        this.routes = null;\n        this.level = 0;\n        this.classes = {};\n    }\n    get navRoutes() {\n        const nav = this.router.navs[this.name];\n        return (nav !== void 0 && nav !== null ? nav.routes : []);\n    }\n    get navClasses() {\n        const nav = this.router.navs[this.name];\n        const navClasses = (nav !== void 0 && nav !== null ? nav.classes : {});\n        return {\n            ...{\n                nav: '',\n                ul: '',\n                li: '',\n                a: '',\n                ulActive: '',\n                liActive: 'nav-active',\n                aActive: '',\n            }, ...navClasses\n        };\n    }\n    active(route) {\n        return 'Active';\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"routes\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Number)\n], NavCustomElement.prototype, \"level\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"classes\", void 0);\nNavCustomElement = __decorate([\n    inject(IRouter, INode),\n    customElement({\n        name: 'au-nav', template: `<template>\n  <nav if.bind=\"name\" class=\"\\${name} \\${navClasses.nav}\">\n    <au-nav routes.bind=\"navRoutes\" classes.bind=\"navClasses\" containerless></au-nav>\n  </nav>\n  <ul if.bind=\"routes\" class=\"nav-level-\\${level} \\${classes.ul}\">\n    <li repeat.for=\"route of routes\" if.bind=\"route.visible\" class=\"\\${route.active ? classes.liActive : ''} \\${route.hasChildren} \\${classes.li}\">\n      <a if.bind=\"route.link && route.link.length\" goto=\"\\${route.link}\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <a if.bind=\"route.execute\" click.trigger=\"route.executeAction($event)\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <span if.bind=\"(!route.link || !route.link.length) && !route.execute && !route.children\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.span} nav-separator\" innerhtml.bind=\"route.title\"></span>\n      <a if.bind=\"(!route.link || !route.link.length) && !route.execute && route.children\" click.delegate=\"route.toggleActive()\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <au-nav if.bind=\"route.children\" routes.bind=\"route.children\" level.bind=\"level + 1\" classes.bind=\"classes\" containerless></au-nav>\n    </li>\n  </ul>\n</template>`\n    }),\n    __metadata(\"design:paramtypes\", [Object])\n], NavCustomElement);\nexport { NavCustomElement };\n//# sourceMappingURL=nav.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContainer } from '@aurelia/kernel';\nimport { bindable, INode, customElement, CustomElement, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nexport const ParentViewport = CustomElement.createInjectable();\nlet ViewportCustomElement = class ViewportCustomElement {\n    constructor(router, element, container, parentViewport) {\n        this.router = router;\n        this.container = container;\n        this.parentViewport = parentViewport;\n        this.name = 'default';\n        this.usedBy = '';\n        this.default = '';\n        this.fallback = '';\n        this.noScope = false;\n        this.noLink = false;\n        this.noHistory = false;\n        this.stateful = false;\n        this.viewport = null;\n        this.isBound = false;\n        this.element = element;\n    }\n    afterCompile(controller) {\n        this.container = controller.context.get(IContainer);\n        // console.log('Viewport creating', this.getAttribute('name', this.name), this.container, this.parentViewport, controller, this);\n        // this.connect();\n    }\n    afterUnbind() {\n        this.isBound = false;\n    }\n    connect() {\n        if (this.router.rootScope === null) {\n            return;\n        }\n        const name = this.getAttribute('name', this.name);\n        let value = this.getAttribute('no-scope', this.noScope);\n        const options = { scope: value === void 0 || !value ? true : false };\n        value = this.getAttribute('used-by', this.usedBy);\n        if (value !== void 0) {\n            options.usedBy = value;\n        }\n        value = this.getAttribute('default', this.default);\n        if (value !== void 0) {\n            options.default = value;\n        }\n        value = this.getAttribute('fallback', this.fallback);\n        if (value !== void 0) {\n            options.fallback = value;\n        }\n        value = this.getAttribute('no-link', this.noLink, true);\n        if (value !== void 0) {\n            options.noLink = value;\n        }\n        value = this.getAttribute('no-history', this.noHistory, true);\n        if (value !== void 0) {\n            options.noHistory = value;\n        }\n        value = this.getAttribute('stateful', this.stateful, true);\n        if (value !== void 0) {\n            options.stateful = value;\n        }\n        this.viewport = this.router.connectViewport(this.viewport, this.container, name, this.element, options);\n    }\n    disconnect() {\n        if (this.viewport) {\n            this.router.disconnectViewport(this.viewport, this.container, this.element);\n        }\n        this.viewport = null;\n    }\n    beforeBind(flags) {\n        this.isBound = true;\n        this.connect();\n        if (this.viewport) {\n            this.viewport.beforeBind(flags);\n        }\n    }\n    beforeAttach(flags) {\n        if (this.viewport) {\n            return this.viewport.beforeAttach(flags);\n        }\n        return Promise.resolve();\n    }\n    beforeDetach(flags) {\n        if (this.viewport) {\n            return this.viewport.beforeDetach(flags);\n        }\n        return Promise.resolve();\n    }\n    async beforeUnbind(flags) {\n        if (this.viewport) {\n            await this.viewport.beforeUnbind(flags);\n            this.disconnect();\n        }\n    }\n    getAttribute(key, value, checkExists = false) {\n        const result = {};\n        if (this.isBound && !checkExists) {\n            return value;\n        }\n        else {\n            if (this.element.hasAttribute(key)) {\n                if (checkExists) {\n                    return true;\n                }\n                else {\n                    value = this.element.getAttribute(key);\n                    if (value.length > 0) {\n                        return value;\n                    }\n                }\n            }\n        }\n        return void 0;\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"usedBy\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"default\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"fallback\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noScope\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noLink\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noHistory\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"stateful\", void 0);\nViewportCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport',\n        injectable: ParentViewport\n    }),\n    __param(0, IRouter),\n    __param(1, INode),\n    __param(2, IContainer),\n    __param(3, ParentViewport),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportCustomElement])\n], ViewportCustomElement);\nexport { ViewportCustomElement };\n//# sourceMappingURL=viewport.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, INode, customElement, CustomElement, CustomElementDefinition, IController, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { IContainer } from '@aurelia/kernel';\nexport const ParentViewportScope = CustomElement.createInjectable();\nlet ViewportScopeCustomElement = class ViewportScopeCustomElement {\n    constructor(router, element, container, parent, parentController) {\n        this.router = router;\n        this.container = container;\n        this.parent = parent;\n        this.parentController = parentController;\n        this.name = 'default';\n        this.catches = '';\n        this.collection = false;\n        this.source = null;\n        this.viewportScope = null;\n        this.isBound = false;\n        this.element = element;\n    }\n    create(controller, parentContainer, definition, parts) {\n        // TODO(fkleuver): describe this somewhere in the docs instead\n        // Under the condition that there is no `replace` attribute on this custom element's declaration,\n        // and this custom element is containerless, its content will be placed in a part named 'default'\n        // See packages/jit-html/src/template-binder.ts line 411 (`replace = 'default';`) for the logic that governs this.\n        // We could tidy this up into a formal api in the future. For now, there are two ways to do this:\n        // 1. inject the `@ITargetedInstruction` (IHydrateElementInstruction) and grab .parts['default'] from there, manually creating a view factory from that, etc.\n        // 2. what we're doing right here: grab the 'default' part from the create hook and return it as the definition, telling the render context to use that part to compile this element instead\n        // This effectively causes this element to render its declared content as if it was its own template.\n        // We do need to set `containerless` to true on the part definition so that the correct projector is used since parts default to non-containerless.\n        // Otherwise, the controller will try to do `appendChild` on a comment node when it has to do `insertBefore`.\n        // Also, in this particular scenario (specific to viewport-scope) we need to clone the part so as to prevent the resulting compiled definition\n        // from ever being cached. That's the only reason why we're spreading the part into a new object for `getOrCreate`. If we didn't clone the object, this specific element wouldn't work correctly.\n        const part = parts['default'];\n        return CustomElementDefinition.getOrCreate({ ...part, containerless: true });\n    }\n    afterCompile(controller) {\n        this.container = controller.context.get(IContainer);\n        // console.log('ViewportScope creating', this.getAttribute('name', this.name), this.container, this.parent, controller, this);\n        // this.connect();\n    }\n    afterUnbound() {\n        this.isBound = false;\n    }\n    connect() {\n        if (this.router.rootScope === null) {\n            return;\n        }\n        const name = this.getAttribute('name', this.name);\n        const options = {};\n        let value = this.getAttribute('catches', this.catches);\n        if (value !== void 0) {\n            options.catches = value;\n        }\n        value = this.getAttribute('collection', this.collection, true);\n        if (value !== void 0) {\n            options.collection = value;\n        }\n        // TODO: Needs to be bound? How to solve?\n        options.source = this.source || null;\n        this.viewportScope = this.router.connectViewportScope(this.viewportScope, name, this.container, this.element, options);\n    }\n    disconnect() {\n        if (this.viewportScope) {\n            this.router.disconnectViewportScope(this.viewportScope, this.container);\n        }\n        this.viewportScope = null;\n    }\n    beforeBind(flags) {\n        this.isBound = true;\n        this.$controller.scope = this.parentController.scope;\n        this.connect();\n        if (this.viewportScope !== null) {\n            this.viewportScope.beforeBind();\n        }\n    }\n    async beforeUnbind(flags) {\n        if (this.viewportScope !== null) {\n            this.viewportScope.beforeUnbind();\n        }\n        this.disconnect();\n        return Promise.resolve();\n    }\n    getAttribute(key, value, checkExists = false) {\n        const result = {};\n        if (this.isBound) {\n            return value;\n        }\n        else {\n            if (this.element.hasAttribute(key)) {\n                if (checkExists) {\n                    return true;\n                }\n                else {\n                    value = this.element.getAttribute(key);\n                    if (value.length > 0) {\n                        return value;\n                    }\n                }\n            }\n        }\n        return void 0;\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportScopeCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportScopeCustomElement.prototype, \"catches\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportScopeCustomElement.prototype, \"collection\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], ViewportScopeCustomElement.prototype, \"source\", void 0);\nViewportScopeCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport-scope',\n        template: '<template></template>',\n        containerless: true,\n        injectable: ParentViewportScope\n    }),\n    __param(0, IRouter),\n    __param(1, INode),\n    __param(2, IContainer),\n    __param(3, ParentViewportScope),\n    __param(4, IController),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportScopeCustomElement, Object])\n], ViewportScopeCustomElement);\nexport { ViewportScopeCustomElement };\n//# sourceMappingURL=viewport-scope.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { NavigationInstructionResolver } from '../type-resolvers';\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy, IObserverLocator, CustomAttribute } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet GotoCustomAttribute = class GotoCustomAttribute {\n    constructor(dom, element, router, eventManager) {\n        this.dom = dom;\n        this.router = router;\n        this.eventManager = eventManager;\n        this.listener = null;\n        this.hasHref = null;\n        this.activeClass = 'goto-active';\n        this.element = element;\n    }\n    beforeBind() {\n        this.listener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n        this.updateValue();\n        const observerLocator = this.router.container.get(IObserverLocator);\n        this.observer = observerLocator.getObserver(0 /* none */, this.router, 'activeComponents');\n        this.observer.subscribe(this);\n    }\n    beforeUnbind() {\n        if (this.listener !== null) {\n            this.listener.dispose();\n        }\n        this.observer.unsubscribe(this);\n    }\n    valueChanged(newValue) {\n        this.updateValue();\n    }\n    updateValue() {\n        if (this.hasHref === null) {\n            this.hasHref = this.element.hasAttribute('href');\n        }\n        if (!this.hasHref) {\n            // TODO: Figure out a better value here for non-strings (using InstructionResolver?)\n            const value = typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n            this.element.setAttribute('href', value);\n        }\n    }\n    handleChange() {\n        const controller = CustomAttribute.for(this.element, 'goto').parent;\n        const created = NavigationInstructionResolver.createViewportInstructions(this.router, this.value, { context: controller });\n        const instructions = NavigationInstructionResolver.toViewportInstructions(this.router, created.instructions);\n        for (const instruction of instructions) {\n            if (instruction.scope === null) {\n                instruction.scope = created.scope;\n            }\n        }\n        // TODO: Use router configuration for class name and update target\n        if (this.router.checkActive(instructions)) {\n            this.element.classList.add(this.activeClass);\n        }\n        else {\n            this.element.classList.remove(this.activeClass);\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView }),\n    __metadata(\"design:type\", Object)\n], GotoCustomAttribute.prototype, \"value\", void 0);\nGotoCustomAttribute = __decorate([\n    customAttribute('goto'),\n    __param(0, IDOM),\n    __param(1, INode),\n    __param(2, IRouter),\n    __param(3, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], GotoCustomAttribute);\nexport { GotoCustomAttribute };\n//# sourceMappingURL=goto.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { GotoCustomAttribute } from '../configuration';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet HrefCustomAttribute = class HrefCustomAttribute {\n    constructor(dom, element, router, eventManager) {\n        this.dom = dom;\n        this.router = router;\n        this.eventManager = eventManager;\n        this.eventListener = null;\n        this.element = element;\n    }\n    beforeBind() {\n        if (this.router.options.useHref && !this.hasGoto()) {\n            this.eventListener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n        }\n        this.updateValue();\n    }\n    beforeUnbind() {\n        if (this.eventListener !== null) {\n            this.eventListener.dispose();\n        }\n    }\n    valueChanged() {\n        this.updateValue();\n    }\n    updateValue() {\n        this.element.setAttribute('href', this.value);\n    }\n    hasGoto() {\n        const parent = this.$controller.parent;\n        const siblings = parent.vmKind !== 1 /* customAttribute */ ? parent.controllers : void 0;\n        return siblings !== void 0\n            && siblings.some(c => c.vmKind === 1 /* customAttribute */ && c.viewModel instanceof GotoCustomAttribute);\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView }),\n    __metadata(\"design:type\", Object)\n], HrefCustomAttribute.prototype, \"value\", void 0);\nHrefCustomAttribute = __decorate([\n    customAttribute({\n        name: 'href',\n        noMultiBindings: true\n    }),\n    __param(0, IDOM),\n    __param(1, INode),\n    __param(2, IRouter),\n    __param(3, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], HrefCustomAttribute);\nexport { HrefCustomAttribute };\n//# sourceMappingURL=href.js.map","import { DI } from '@aurelia/kernel';\nimport { StartTask } from '@aurelia/runtime';\nimport { NavCustomElement } from './resources/nav';\nimport { ViewportCustomElement } from './resources/viewport';\nimport { ViewportScopeCustomElement } from './resources/viewport-scope';\nimport { GotoCustomAttribute } from './resources/goto';\nimport { HrefCustomAttribute } from './resources/href';\nimport { IRouter } from './router';\nexport const RouterRegistration = IRouter;\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IRouter`\n */\nexport const DefaultComponents = [\n    RouterRegistration,\n];\nexport { ViewportCustomElement, ViewportScopeCustomElement, NavCustomElement, GotoCustomAttribute, HrefCustomAttribute, };\nexport const ViewportCustomElementRegistration = ViewportCustomElement;\nexport const ViewportScopeCustomElementRegistration = ViewportScopeCustomElement;\nexport const NavCustomElementRegistration = NavCustomElement;\nexport const GotoCustomAttributeRegistration = GotoCustomAttribute;\nexport const HrefCustomAttributeRegistration = HrefCustomAttribute;\n/**\n * Default router resources:\n * - Custom Elements: `au-viewport`, `au-nav`\n * - Custom Attributes: `goto`, `href`\n */\nexport const DefaultResources = [\n    ViewportCustomElement,\n    ViewportScopeCustomElement,\n    NavCustomElement,\n    GotoCustomAttribute,\n    HrefCustomAttribute,\n];\nlet configurationOptions = {};\nlet configurationCall = (router) => {\n    router.activate(configurationOptions);\n};\n/**\n * A DI configuration object containing router resource registrations.\n */\nconst routerConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, StartTask.with(IRouter).beforeBind().call(configurationCall), StartTask.with(IRouter).beforeAttach().call(router => router.loadUrl()));\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport const RouterConfiguration = {\n    /**\n     * Make it possible to specify options to Router activation.\n     * Parameter is either a config object that's passed to Router's activate\n     * or a config function that's called instead of Router's activate.\n     */\n    customize(config) {\n        if (config === undefined) {\n            configurationOptions = {};\n            configurationCall = (router) => {\n                router.activate(configurationOptions);\n            };\n        }\n        else if (config instanceof Function) {\n            configurationCall = config;\n        }\n        else {\n            configurationOptions = config;\n        }\n        return { ...routerConfiguration };\n    },\n    ...routerConfiguration,\n};\n//# sourceMappingURL=configuration.js.map","<!-- <au-viewport name=\"main\" default='shiurim(daf-yomi&${currentMasechta})'></au-viewport> -->\n<au-viewport name=\"main\" default='shiurim(daf-yomi)'></au-viewport>\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport * as __au2ViewDef from './app.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nlet App = class App {\r\n    constructor() {\r\n        this.currentMasechta = 'shabbos';\r\n        // public get copyrightYears(): string {\r\n        //     const firstYear = 2020;\r\n        //     const currentYear = new Date(Date.now()).getFullYear();\r\n        //     if (currentYear === firstYear) {\r\n        //         return firstYear.toString();\r\n        //     }\r\n        //     return `${firstYear} - ${currentYear}`;\r\n        // }\r\n    }\r\n};\r\nApp = __decorate([\r\n    customElement(__au2ViewDef)\r\n], App);\r\nexport { App };\r\n","<audio autoplay durationchange.trigger=\"updateDuration($event.target)\" timeupdate.trigger=\"updateCurrentTime($event.target)\" ref=\"audioElement\">\r\n    <source src.bind=\"url\" type=\"audio/mpeg\" />\r\n</audio>\r\n\r\n\r\n<input class=\"current-time slider\" title=\"location\" type=\"range\" min=\"0\" max=\"100\" value=\"0\" step=\".001\" input.delegate=\"slideTimeUpdate($event.target.value)\" />\r\n<div class=\"duration\">${currentLocation} - ${totalLength}</div>\r\n\r\n<div class=\"controls\">\r\n    <button type=\"button\" click.delegate=\"goToBeginning()\" title=\"go to beginning\">\r\n        <i class=\"icon\">&#9614;&#9668;</i>\r\n        <span>Start</span>\r\n    </button>\r\n    <button type=\"button\" click.delegate=\"rewind()\" title=\"seek backward\">\r\n        <i class=\"icon seek\">&#9668;&#9668;</i>\r\n        <span>Rewind</span>\r\n    </button>\r\n\r\n    <button type=\"button\" class=\"play\" click.delegate=\"togglePlay()\" title=\"play\">\r\n        <i class=\"icon\" if.bind=\"audioElement.paused\">&#9658;</i>\r\n        <i class=\"icon\" if.bind=\"!audioElement.paused\">&#9614; &#9614;</i>\r\n        <span>${audioElement.paused ? 'Play' : 'Pause'}</span>\r\n    </button>\r\n\r\n    <button type=\"button\" click.delegate=\"fastForward()\" title=\"seek forward\">\r\n        <i class=\"icon seek\">&#9658;&#9658;</i>\r\n        <span>Advance</span>\r\n    </button>\r\n    <button type=\"button\" click.delegate=\"goToEnd()\" title=\"go to end\">\r\n        <i class=\"icon\">&#9658;&#9614;</i>\r\n        <span>End</span>\r\n    </button>\r\n\r\n    <div class=\"volume\">\r\n        <i class=\"icon\" if.bind=\"volume !== 0\" click.delegate=\"toggleVolume()\">&#128362;</i>\r\n        <i class=\"icon\" if.bind=\"volume === 0\" click.delegate=\"toggleVolume()\">&#10680;</i>\r\n        <input title=\"volume\" type=\"range\" min=\"0\" max=\"100\" value.bind=\"volume\" class=\"slider\" input.delegate=\"updateVolume($event.target.value)\" />\r\n    </div>\r\n</div>\r\n\r\n<div if.bind=\"isLoading\" class=\"loading-container\">\r\n    <div class=\"sk-folding-cube\">\r\n        <div class=\"sk-cube1 sk-cube\"></div>\r\n        <div class=\"sk-cube2 sk-cube\"></div>\r\n        <div class=\"sk-cube4 sk-cube\"></div>\r\n        <div class=\"sk-cube3 sk-cube\"></div>\r\n    </div>\r\n</div>\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport * as __au2ViewDef from './audio-player.html';\r\nimport { customElement } from '@aurelia/runtime';\r\n/* https://ilikekillnerds.com/category/aurelia-2/\r\n   https://stackoverflow.com/questions/12325787/setting-the-granularity-of-the-html5-audio-event-timeupdate#comment-69606299\r\n*/\r\nimport { inject, bindable } from 'aurelia';\r\nlet AudioPlayer = class AudioPlayer {\r\n    constructor(element) {\r\n        this.element = element;\r\n        this.totalLength = '00:00';\r\n        this.currentLocation = '00:00';\r\n        this.volume = 50;\r\n        this.fastForwardAmount = 15;\r\n        this.rewindAmount = 15;\r\n        this.isLoading = true;\r\n    }\r\n    get currentTimeElement() {\r\n        return this.element.querySelector('[title=\"location\"]');\r\n    }\r\n    set currentTime(currentTime) {\r\n        this.currentTimeElement.value = ((currentTime / this.audioElement.duration) * 100).toString();\r\n        this.currentLocation = this.createTimeSpan(currentTime);\r\n    }\r\n    updateDuration(audioElement) {\r\n        if (audioElement.duration) {\r\n            this.totalLength = this.createTimeSpan(audioElement.duration);\r\n            this.isLoading = false;\r\n        }\r\n    }\r\n    updateCurrentTime(audioElement) {\r\n        this.currentTime = audioElement.currentTime;\r\n    }\r\n    slideTimeUpdate(percent) {\r\n        this.currentTime = this.audioElement.duration * (percent / 100);\r\n        this.audioElement.currentTime = this.audioElement.duration * (percent / 100);\r\n    }\r\n    togglePlay() {\r\n        if (this.audioElement.paused) {\r\n            this.audioElement.play();\r\n        }\r\n        else {\r\n            this.audioElement.pause();\r\n        }\r\n    }\r\n    goToBeginning() {\r\n        this.currentTime = 0;\r\n        this.audioElement.currentTime = 0;\r\n    }\r\n    fastForward() {\r\n        const currentTime = this.audioElement.currentTime;\r\n        this.currentTime = currentTime + this.fastForwardAmount;\r\n        this.audioElement.currentTime = currentTime + this.fastForwardAmount;\r\n    }\r\n    rewind() {\r\n        const currentTime = this.audioElement.currentTime;\r\n        this.currentTime = currentTime - this.rewindAmount;\r\n        this.audioElement.currentTime = currentTime - this.rewindAmount;\r\n    }\r\n    goToEnd() {\r\n        this.currentTime = this.audioElement.duration;\r\n        this.audioElement.currentTime = this.audioElement.duration;\r\n    }\r\n    updateVolume(volume) {\r\n        this.audioElement.volume = volume / 100;\r\n        this.volume = volume;\r\n    }\r\n    toggleVolume() {\r\n        if (this.volume !== 0) {\r\n            this.previousVolume = this.volume;\r\n            this.volume = 0;\r\n        }\r\n        else {\r\n            this.volume = this.previousVolume;\r\n            this.previousVolume = 0;\r\n        }\r\n    }\r\n    createTimeSpan(timeInSeconds) {\r\n        let minutes = Math.floor(timeInSeconds / 60);\r\n        let seconds = Math.floor((timeInSeconds % 60));\r\n        if (minutes >= 60) {\r\n            let hours = Math.floor(minutes / 60);\r\n            minutes = Math.floor(minutes % 60);\r\n            return `${this.toFixedTimeString(hours)}:${this.toFixedTimeString(minutes)}:${this.toFixedTimeString(seconds)}`;\r\n        }\r\n        return `${this.toFixedTimeString(minutes)}:${this.toFixedTimeString(seconds)}`;\r\n    }\r\n    toFixedTimeString(timeUnit) {\r\n        const timeUnitString = timeUnit.toFixed(0);\r\n        return timeUnitString.length === 1 ? `0${timeUnitString}` : timeUnitString;\r\n    }\r\n};\r\n__decorate([\r\n    bindable,\r\n    __metadata(\"design:type\", String)\r\n], AudioPlayer.prototype, \"url\", void 0);\r\nAudioPlayer = __decorate([\r\n    customElement(__au2ViewDef),\r\n    inject(Element),\r\n    __metadata(\"design:paramtypes\", [Element])\r\n], AudioPlayer);\r\nexport { AudioPlayer };\r\n","<template>\r\n    <template repeat.for=\"series of v2\">\r\n        <h3 class=\"series title\" id=\"${series.title.toLowerCase()}\">${series.title}</h3>\r\n        <div class=\"series grid\">\r\n            <div class=\"card\" repeat.for=\"shiur of series.shiurim\">\r\n                <span class=\"inner-border\"></span>\r\n                <h3 class=\"title\">${shiur.series} - ${shiur.title}</h3>\r\n                <div class=\"versions-container\">\r\n                    <div class=\"version\" repeat.for=\"version of shiur.versions\">\r\n                        <a goto=\"../shiur-details(${shiur.id})\">${version.version} (${version.duration})</a>\r\n                        <button type=\"button\" title=\"Download the shiur\" click.delegate=\"downloadShiur(version.shiur)\">&#8891;</button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"author\">${shiur.author.name}</div>\r\n                <div class=\"date\">${shiur.date.toDateString()}</div>\r\n            </div>\r\n        </div>\r\n    </template>\r\n</template>","export class Shiur {\r\n    constructor({ title = '', tags = [], date, duration = '', id, previousId, nextId, author }) {\r\n        this.title = title;\r\n        this.tags = tags;\r\n        this.date = date;\r\n        this.duration = duration;\r\n        this.id = id;\r\n        this.previousId = previousId;\r\n        this.nextId = nextId;\r\n        this.author = author;\r\n    }\r\n    get series() {\r\n        return this.tags.map(tag => tag.tag);\r\n    }\r\n}\r\n","export var TagType;\r\n(function (TagType) {\r\n    TagType[TagType[\"Unknown\"] = 0] = \"Unknown\";\r\n    TagType[TagType[\"SeriesLevel1\"] = 1] = \"SeriesLevel1\";\r\n    TagType[TagType[\"SeriesLevel2\"] = 2] = \"SeriesLevel2\";\r\n    TagType[TagType[\"SeriesLevel3\"] = 3] = \"SeriesLevel3\";\r\n})(TagType || (TagType = {}));\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport { HttpClient, inject } from 'aurelia';\r\nimport { Shiur } from '../models/index';\r\nlet ShiurimService = class ShiurimService {\r\n    constructor(client) {\r\n        this.client = client;\r\n    }\r\n    async getShiur(id) {\r\n        // const response = await this.client.get(`https://torahislife.azurewebsites.net/api/ShiurInfo?id=${id}`);\r\n        const response = await this.client.get(`http://localhost:7071/api/ShiurInfo?id=${id}`);\r\n        const data = await response.json();\r\n        return new Shiur({\r\n            date: new Date(Date.parse(data.shiurim[0].date)),\r\n            duration: data.shiurim[0].duration,\r\n            tags: data.shiurim[0].tags.map(tagId => data.tags.find(tag => tag.id === tagId)),\r\n            title: data.shiurim[0].title,\r\n            id: data.shiurim[0].id,\r\n            previousId: data.shiurim[0].previousId,\r\n            nextId: data.shiurim[0].nextId,\r\n            author: data.authors.find(author => author.id === data.shiurim[0].authorId)\r\n        });\r\n    }\r\n    async getShiurim(tags) {\r\n        // const response = await this.client.get(`https://torahislife.azurewebsites.net/api/ShiurInfo?${tags.map(tag => `tags=${tag}`).join('&')}`);\r\n        const response = await this.client.get(`http://localhost:7071/api/ShiurInfo?${tags.map(tag => `tags=${tag}`).join('&')}`);\r\n        const data = await response.json();\r\n        return data.shiurim\r\n            .map((dataShiur) => new Shiur({\r\n            date: new Date(Date.parse(dataShiur.date)),\r\n            duration: dataShiur.duration,\r\n            tags: dataShiur.tags.map(tagId => data.tags.find(tag => tag.id === tagId)),\r\n            title: dataShiur.title,\r\n            id: dataShiur.id,\r\n            previousId: dataShiur.previousId,\r\n            nextId: dataShiur.nextId,\r\n            author: data.authors.find(author => author.id === dataShiur.authorId)\r\n        }));\r\n    }\r\n};\r\nShiurimService = __decorate([\r\n    inject(HttpClient),\r\n    __metadata(\"design:paramtypes\", [HttpClient])\r\n], ShiurimService);\r\nexport { ShiurimService };\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport * as __au2ViewDef from './shiurim.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nimport { ShiurimService } from '../services/shiurim.service';\r\nlet Shiurim = class Shiurim {\r\n    constructor(shiurimService) {\r\n        this.shiurimService = shiurimService;\r\n        this.shiurim = [];\r\n        this.v2 = [];\r\n    }\r\n    async enter(parameters) {\r\n        const tags = parameters.tags.split('&'); // TODO: use & and | as delimiters for more complex filtering operations?\r\n        this.shiurim = await this.shiurimService.getShiurim(tags);\r\n        // group by root series\r\n        const series = this.shiurim\r\n            .reduce((pv, cv) => {\r\n            if (pv[cv.series[1]]) {\r\n                pv[cv.series[1]].push(cv);\r\n            }\r\n            else {\r\n                pv[cv.series[1]] = [cv];\r\n            }\r\n            return pv;\r\n        }, {});\r\n        // group shiurim within series\r\n        Object.keys(series)\r\n            .forEach(key => {\r\n            series[key] = series[key].reduce((pv, cv) => {\r\n                const seriesTitle = cv.series[1];\r\n                if (pv[cv.title]) {\r\n                    pv[cv.title].versions\r\n                        .push({\r\n                        version: cv.series[2],\r\n                        duration: cv.duration,\r\n                        shiur: cv\r\n                    });\r\n                }\r\n                else {\r\n                    pv[cv.title] = {\r\n                        id: cv.id,\r\n                        series: seriesTitle,\r\n                        title: cv.title,\r\n                        author: cv.author,\r\n                        date: cv.date,\r\n                        versions: [{\r\n                                version: cv.series[2],\r\n                                duration: cv.duration,\r\n                                shiur: cv\r\n                            }]\r\n                    };\r\n                }\r\n                return pv;\r\n            }, {});\r\n            series[key] = [].concat(Object.keys(series[key])\r\n                .map(key2 => series[key][key2])).sort(this.dateDescending);\r\n        });\r\n        this.v2 = [].concat(Object.keys(series)\r\n            .map(key => ({ title: key, shiurim: series[key] }))).reverse();\r\n    }\r\n    dateDescending(s1, s2) {\r\n        return s1.date > s2.date ? -1 : s2.date > s1.date ? 1 : 0;\r\n    }\r\n    downloadShiur(shiur) {\r\n        // window.location.href = `https://torahislife.azurewebsites.net/api/ShiurRetriever?id=${shiur.id}`;\r\n        window.location.href = `http://localhost:7071/api/ShiurRetriever?id=${shiur.id}`;\r\n    }\r\n};\r\nShiurim.parameters = ['tags'];\r\nShiurim = __decorate([\r\n    customElement(__au2ViewDef),\r\n    __metadata(\"design:paramtypes\", [ShiurimService])\r\n], Shiurim);\r\nexport { Shiurim };\r\n","<div class=\"shiurim-details-outer-container\">\r\n    <div class=\"shiurim-details-inner-container\">\r\n        <h3 class=\"title\">${shiur.series[1]} - ${shiur.title}</h3>\r\n        <h4 class=\"series\">${shiur.series[2]}</h4>\r\n        <div class=\"author\">${shiur.author.name}</div>\r\n        <div class=\"date\">${shiur.date.toDateString()}</div>\r\n        \r\n        <!-- <audio-player if.bind=\"shiur.id\" url=\"https://torahislife.azurewebsites.net/api/ShiurRetriever?id=${shiur.id}\"></audio-player> -->\r\n        <audio-player if.bind=\"shiur.id\" url=\"http://localhost:7071/api/ShiurRetriever?id=${shiur.id}\"></audio-player>\r\n\r\n        <div class=\"pager\">\r\n            <button if.bind=\"shiur.previousId\" goto=\"../shiur-details(${shiur.previousId})\"><i class=\"icon\">&#8592;</i>Previous</button>\r\n            <button if.bind=\"shiur.nextId\" goto=\"../shiur-details(${shiur.nextId})\"><i>&#8594;</i>Next</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __metadata = (this && this.__metadata) || function (k, v) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n};\r\nimport * as __au2ViewDef from './shiur-details.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nimport { ShiurimService } from '../services/shiurim.service';\r\nlet ShiurDetails = class ShiurDetails {\r\n    constructor(shiurimService) {\r\n        this.shiurimService = shiurimService;\r\n    }\r\n    enter(parameters) {\r\n        this.shiurimService\r\n            .getShiur(parameters.id)\r\n            .then(shiur => this.shiur = shiur);\r\n    }\r\n};\r\nShiurDetails.parameters = ['id'];\r\nShiurDetails = __decorate([\r\n    customElement(__au2ViewDef),\r\n    __metadata(\"design:paramtypes\", [ShiurimService])\r\n], ShiurDetails);\r\nexport { ShiurDetails };\r\n","import Aurelia, { RouterConfiguration, cssModules } from 'aurelia';\r\nimport { App } from './app';\r\nimport * as components from './components/index';\r\nimport { JitHtmlBrowserConfiguration } from '@aurelia/jit-html-browser';\r\nAurelia.register(JitHtmlBrowserConfiguration, cssModules(), components, RouterConfiguration.customize())\r\n    .app(App)\r\n    .start();\r\n"],"sourceRoot":""}